2024-10-15 00:17:33,267 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+bc04488
------------------------------------------------------------

2024-10-15 00:17:34,168 - mmdet - INFO - Distributed training: False
2024-10-15 00:17:35,042 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 00:17:38,227 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 00:17:38,228 - mmdet - INFO - Use load_from_local loader
2024-10-15 00:17:38,508 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 00:17:38,514 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 00:17:38,514 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 00:19:08,663 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:03:24, time: 1.803, data_time: 0.076, memory: 18711, stage0_loss_instance_mil: 0.7232, stage0_bag_acc: 30.2181, stage0_mean_ious: 0.3650, stage0_s: 0.0000, stage0_m: 0.0526, stage0_l: 0.2662, stage0_h: 0.3708, stage1_loss_instance_mil: 0.1495, stage1_bag_acc: 24.5610, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.3276, stage1_s: 0.0000, stage1_m: 0.0500, stage1_l: 0.2399, stage1_h: 0.3334, loss: 0.8793, grad_norm: 3.2430
2024-10-15 00:20:35,071 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 1:00:36, time: 1.728, data_time: 0.028, memory: 18719, stage0_loss_instance_mil: 0.5957, stage0_bag_acc: 53.1089, stage0_mean_ious: 0.3643, stage0_s: 0.0000, stage0_m: 0.0671, stage0_l: 0.2755, stage0_h: 0.3709, stage1_loss_instance_mil: 0.1928, stage1_bag_acc: 42.5098, stage1_neg_loss: 0.0194, stage1_mean_ious: 0.3320, stage1_s: 0.0000, stage1_m: 0.0625, stage1_l: 0.2601, stage1_h: 0.3357, loss: 0.8078, grad_norm: 4.3919
2024-10-15 00:22:02,477 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:58:57, time: 1.748, data_time: 0.027, memory: 18719, stage0_loss_instance_mil: 0.2629, stage0_bag_acc: 89.5533, stage0_mean_ious: 0.3759, stage0_s: 0.0000, stage0_m: 0.0497, stage0_l: 0.2345, stage0_h: 0.3855, stage1_loss_instance_mil: 0.3049, stage1_bag_acc: 72.8096, stage1_neg_loss: 0.0657, stage1_mean_ious: 0.3517, stage1_s: 0.0000, stage1_m: 0.0415, stage1_l: 0.2286, stage1_h: 0.3619, loss: 0.6335, grad_norm: 9.5137
2024-10-15 00:22:55,171 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 00:24:25,579 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:49:14, time: 1.764, data_time: 0.075, memory: 18772, stage0_loss_instance_mil: 0.0750, stage0_bag_acc: 96.6325, stage0_mean_ious: 0.3960, stage0_s: 0.0000, stage0_m: 0.0388, stage0_l: 0.2336, stage0_h: 0.4132, stage1_loss_instance_mil: 0.3225, stage1_bag_acc: 97.2750, stage1_neg_loss: 0.0866, stage1_mean_ious: 0.3764, stage1_s: 0.0000, stage1_m: 0.0326, stage1_l: 0.2307, stage1_h: 0.3925, loss: 0.4841, grad_norm: 10.4746
2024-10-15 00:25:53,345 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:49:13, time: 1.755, data_time: 0.029, memory: 18772, stage0_loss_instance_mil: 0.0539, stage0_bag_acc: 97.1961, stage0_mean_ious: 0.3756, stage0_s: 0.0000, stage0_m: 0.0394, stage0_l: 0.2060, stage0_h: 0.3932, stage1_loss_instance_mil: 0.3141, stage1_bag_acc: 97.4489, stage1_neg_loss: 0.0848, stage1_mean_ious: 0.3519, stage1_s: 0.0000, stage1_m: 0.0300, stage1_l: 0.2088, stage1_h: 0.3666, loss: 0.4528, grad_norm: 14.0169
2024-10-15 00:27:21,290 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:48:47, time: 1.759, data_time: 0.028, memory: 18772, stage0_loss_instance_mil: 0.0599, stage0_bag_acc: 96.0981, stage0_mean_ious: 0.4104, stage0_s: 0.0000, stage0_m: 0.0750, stage0_l: 0.3055, stage0_h: 0.4277, stage1_loss_instance_mil: 0.2668, stage1_bag_acc: 98.0280, stage1_neg_loss: 0.0765, stage1_mean_ious: 0.3879, stage1_s: 0.0000, stage1_m: 0.0632, stage1_l: 0.3088, stage1_h: 0.4031, loss: 0.4032, grad_norm: 11.6274
2024-10-15 00:28:13,692 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 00:29:45,301 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:43:54, time: 1.788, data_time: 0.076, memory: 18772, stage0_loss_instance_mil: 0.0357, stage0_bag_acc: 97.8276, stage0_mean_ious: 0.4269, stage0_s: 0.0000, stage0_m: 0.0723, stage0_l: 0.2381, stage0_h: 0.4516, stage1_loss_instance_mil: 0.2635, stage1_bag_acc: 98.5859, stage1_neg_loss: 0.0803, stage1_mean_ious: 0.3959, stage1_s: 0.0000, stage1_m: 0.0495, stage1_l: 0.2345, stage1_h: 0.4198, loss: 0.3795, grad_norm: 14.7677
2024-10-15 00:31:10,759 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:43:16, time: 1.709, data_time: 0.027, memory: 18772, stage0_loss_instance_mil: 0.0324, stage0_bag_acc: 98.3575, stage0_mean_ious: 0.4338, stage0_s: 0.0000, stage0_m: 0.0607, stage0_l: 0.2322, stage0_h: 0.4661, stage1_loss_instance_mil: 0.2445, stage1_bag_acc: 98.5428, stage1_neg_loss: 0.0898, stage1_mean_ious: 0.4020, stage1_s: 0.0000, stage1_m: 0.0494, stage1_l: 0.2297, stage1_h: 0.4299, loss: 0.3667, grad_norm: 16.8543
2024-10-15 00:32:37,274 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:42:33, time: 1.730, data_time: 0.027, memory: 18772, stage0_loss_instance_mil: 0.0404, stage0_bag_acc: 97.5628, stage0_mean_ious: 0.4698, stage0_s: 0.0083, stage0_m: 0.0418, stage0_l: 0.2335, stage0_h: 0.4954, stage1_loss_instance_mil: 0.2389, stage1_bag_acc: 97.9077, stage1_neg_loss: 0.0724, stage1_mean_ious: 0.4360, stage1_s: 0.0065, stage1_m: 0.0319, stage1_l: 0.2096, stage1_h: 0.4619, loss: 0.3517, grad_norm: 15.7260
2024-10-15 00:33:28,663 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 00:35:00,153 - mmdet - INFO - Evaluating bbox...
2024-10-15 00:35:00,959 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1028
2024-10-15 00:35:00,960 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2678
2024-10-15 00:35:00,960 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1894
2024-10-15 00:35:00,960 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1046
2024-10-15 00:35:00,960 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0581
2024-10-15 00:35:00,960 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0245
2024-10-15 00:35:00,960 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 00:35:00,960 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1075
2024-10-15 00:35:00,960 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1060
2024-10-15 00:35:00,960 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1082
2024-10-15 00:35:00,961 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1599
2024-10-15 00:35:00,961 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3487
2024-10-15 00:35:00,961 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1599
2024-10-15 00:35:00,961 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1599
2024-10-15 00:35:00,961 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1249
2024-10-15 00:35:00,961 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1718
2024-10-15 00:35:00,961 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1357
2024-10-15 00:35:00,975 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 00:35:00,975 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 90, bbox_mAP: 0.1030, bbox_mAP_50: 0.2680, bbox_mAP_75: 0.1890, bbox_mAP_s: 0.1050, bbox_mAP_m: 0.0580, bbox_mAP_l: 0.0250, bbox_mAP_copypaste: 0.103 0.268 0.189 0.105 0.058 0.025
2024-10-15 00:36:28,826 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:53, time: 1.757, data_time: 0.075, memory: 18772, stage0_loss_instance_mil: 0.0244, stage0_bag_acc: 98.7842, stage0_mean_ious: 0.4728, stage0_s: 0.0000, stage0_m: 0.0457, stage0_l: 0.2102, stage0_h: 0.5083, stage1_loss_instance_mil: 0.1740, stage1_bag_acc: 99.3283, stage1_neg_loss: 0.0742, stage1_mean_ious: 0.4359, stage1_s: 0.0000, stage1_m: 0.0411, stage1_l: 0.1924, stage1_h: 0.4690, loss: 0.2725, grad_norm: 11.9138
2024-10-15 00:37:56,678 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:38:11, time: 1.757, data_time: 0.026, memory: 18772, stage0_loss_instance_mil: 0.0166, stage0_bag_acc: 99.4116, stage0_mean_ious: 0.4839, stage0_s: 0.0000, stage0_m: 0.0576, stage0_l: 0.2818, stage0_h: 0.5115, stage1_loss_instance_mil: 0.2086, stage1_bag_acc: 99.6155, stage1_neg_loss: 0.0677, stage1_mean_ious: 0.4375, stage1_s: 0.0000, stage1_m: 0.0439, stage1_l: 0.2591, stage1_h: 0.4614, loss: 0.2928, grad_norm: 13.8815
2024-10-15 00:39:23,806 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:21, time: 1.743, data_time: 0.026, memory: 18772, stage0_loss_instance_mil: 0.0125, stage0_bag_acc: 99.4364, stage0_mean_ious: 0.4878, stage0_s: 0.0000, stage0_m: 0.0593, stage0_l: 0.2199, stage0_h: 0.5225, stage1_loss_instance_mil: 0.1607, stage1_bag_acc: 99.5058, stage1_neg_loss: 0.0621, stage1_mean_ious: 0.4435, stage1_s: 0.0000, stage1_m: 0.0491, stage1_l: 0.2039, stage1_h: 0.4746, loss: 0.2353, grad_norm: 12.0100
2024-10-15 00:40:16,919 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 00:41:49,361 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:21, time: 1.803, data_time: 0.077, memory: 18772, stage0_loss_instance_mil: 0.0202, stage0_bag_acc: 98.6328, stage0_mean_ious: 0.4454, stage0_s: 0.0000, stage0_m: 0.0445, stage0_l: 0.1829, stage0_h: 0.4763, stage1_loss_instance_mil: 0.1548, stage1_bag_acc: 99.1103, stage1_neg_loss: 0.0547, stage1_mean_ious: 0.4034, stage1_s: 0.0000, stage1_m: 0.0270, stage1_l: 0.1611, stage1_h: 0.4330, loss: 0.2297, grad_norm: 10.1648
2024-10-15 00:43:16,590 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:29, time: 1.745, data_time: 0.027, memory: 18772, stage0_loss_instance_mil: 0.0203, stage0_bag_acc: 98.5914, stage0_mean_ious: 0.4466, stage0_s: 0.0000, stage0_m: 0.0650, stage0_l: 0.2482, stage0_h: 0.4714, stage1_loss_instance_mil: 0.1517, stage1_bag_acc: 99.4057, stage1_neg_loss: 0.0564, stage1_mean_ious: 0.4133, stage1_s: 0.0000, stage1_m: 0.0523, stage1_l: 0.2367, stage1_h: 0.4362, loss: 0.2283, grad_norm: 9.0324
2024-10-15 00:44:43,174 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:31, time: 1.732, data_time: 0.026, memory: 18772, stage0_loss_instance_mil: 0.0155, stage0_bag_acc: 98.8717, stage0_mean_ious: 0.4420, stage0_s: 0.0000, stage0_m: 0.0181, stage0_l: 0.1931, stage0_h: 0.4714, stage1_loss_instance_mil: 0.1447, stage1_bag_acc: 99.4323, stage1_neg_loss: 0.0539, stage1_mean_ious: 0.4027, stage1_s: 0.0000, stage1_m: 0.0132, stage1_l: 0.1794, stage1_h: 0.4290, loss: 0.2141, grad_norm: 9.5366
2024-10-15 00:45:34,405 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 00:47:06,223 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:50, time: 1.791, data_time: 0.074, memory: 18772, stage0_loss_instance_mil: 0.0199, stage0_bag_acc: 98.7635, stage0_mean_ious: 0.4733, stage0_s: 0.0000, stage0_m: 0.0307, stage0_l: 0.2776, stage0_h: 0.5045, stage1_loss_instance_mil: 0.1254, stage1_bag_acc: 99.6319, stage1_neg_loss: 0.0504, stage1_mean_ious: 0.4327, stage1_s: 0.0000, stage1_m: 0.0262, stage1_l: 0.2714, stage1_h: 0.4601, loss: 0.1957, grad_norm: 8.9481
2024-10-15 00:48:32,098 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 00:48:32,098 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:50, time: 1.718, data_time: 0.026, memory: 18772, stage0_loss_instance_mil: 0.0076, stage0_bag_acc: 99.6619, stage0_mean_ious: 0.4576, stage0_s: 0.0000, stage0_m: 0.0384, stage0_l: 0.2214, stage0_h: 0.4894, stage1_loss_instance_mil: 0.1458, stage1_bag_acc: 99.2824, stage1_neg_loss: 0.0682, stage1_mean_ious: 0.4178, stage1_s: 0.0000, stage1_m: 0.0245, stage1_l: 0.1998, stage1_h: 0.4483, loss: 0.2216, grad_norm: 12.2405
2024-10-15 00:50:01,386 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:51, time: 1.786, data_time: 0.027, memory: 18772, stage0_loss_instance_mil: 0.0094, stage0_bag_acc: 99.4598, stage0_mean_ious: 0.4508, stage0_s: 0.0077, stage0_m: 0.0528, stage0_l: 0.2064, stage0_h: 0.4833, stage1_loss_instance_mil: 0.1235, stage1_bag_acc: 99.6603, stage1_neg_loss: 0.0515, stage1_mean_ious: 0.4153, stage1_s: 0.0060, stage1_m: 0.0438, stage1_l: 0.2045, stage1_h: 0.4438, loss: 0.1844, grad_norm: 7.4893
2024-10-15 00:50:53,754 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 00:52:25,616 - mmdet - INFO - Evaluating bbox...
2024-10-15 00:52:26,488 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1143
2024-10-15 00:52:26,488 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2955
2024-10-15 00:52:26,488 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2134
2024-10-15 00:52:26,488 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1152
2024-10-15 00:52:26,488 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0651
2024-10-15 00:52:26,488 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0252
2024-10-15 00:52:26,488 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0008
2024-10-15 00:52:26,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1006
2024-10-15 00:52:26,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1205
2024-10-15 00:52:26,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1171
2024-10-15 00:52:26,489 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1764
2024-10-15 00:52:26,489 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3824
2024-10-15 00:52:26,489 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1764
2024-10-15 00:52:26,489 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1764
2024-10-15 00:52:26,489 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1418
2024-10-15 00:52:26,489 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1889
2024-10-15 00:52:26,489 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1530
2024-10-15 00:52:26,505 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 00:52:26,505 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.1140, bbox_mAP_50: 0.2960, bbox_mAP_75: 0.2130, bbox_mAP_s: 0.1150, bbox_mAP_m: 0.0650, bbox_mAP_l: 0.0250, bbox_mAP_copypaste: 0.114 0.296 0.213 0.115 0.065 0.025
2024-10-15 00:53:57,283 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:23, time: 1.815, data_time: 0.074, memory: 18772, stage0_loss_instance_mil: 0.0120, stage0_bag_acc: 99.5027, stage0_mean_ious: 0.4723, stage0_s: 0.0000, stage0_m: 0.0528, stage0_l: 0.1907, stage0_h: 0.5034, stage1_loss_instance_mil: 0.1199, stage1_bag_acc: 99.6581, stage1_neg_loss: 0.0646, stage1_mean_ious: 0.4364, stage1_s: 0.0000, stage1_m: 0.0426, stage1_l: 0.1736, stage1_h: 0.4649, loss: 0.1966, grad_norm: 12.7222
2024-10-15 00:55:24,511 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:20, time: 1.745, data_time: 0.025, memory: 18772, stage0_loss_instance_mil: 0.0133, stage0_bag_acc: 99.3561, stage0_mean_ious: 0.4838, stage0_s: 0.0000, stage0_m: 0.0376, stage0_l: 0.2548, stage0_h: 0.5122, stage1_loss_instance_mil: 0.1008, stage1_bag_acc: 99.4629, stage1_neg_loss: 0.0527, stage1_mean_ious: 0.4452, stage1_s: 0.0000, stage1_m: 0.0353, stage1_l: 0.2407, stage1_h: 0.4704, loss: 0.1668, grad_norm: 8.1757
2024-10-15 00:56:51,228 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:23:15, time: 1.734, data_time: 0.027, memory: 18772, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.7111, stage0_mean_ious: 0.5021, stage0_s: 0.0000, stage0_m: 0.0666, stage0_l: 0.2630, stage0_h: 0.5366, stage1_loss_instance_mil: 0.0999, stage1_bag_acc: 99.5106, stage1_neg_loss: 0.0413, stage1_mean_ious: 0.4563, stage1_s: 0.0000, stage1_m: 0.0588, stage1_l: 0.2395, stage1_h: 0.4874, loss: 0.1472, grad_norm: 7.1548
2024-10-15 00:57:44,201 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 00:59:15,181 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:55, time: 1.776, data_time: 0.076, memory: 18772, stage0_loss_instance_mil: 0.0051, stage0_bag_acc: 99.7556, stage0_mean_ious: 0.5155, stage0_s: 0.0000, stage0_m: 0.0536, stage0_l: 0.2504, stage0_h: 0.5528, stage1_loss_instance_mil: 0.0951, stage1_bag_acc: 99.7556, stage1_neg_loss: 0.0431, stage1_mean_ious: 0.4678, stage1_s: 0.0000, stage1_m: 0.0421, stage1_l: 0.2404, stage1_h: 0.5003, loss: 0.1433, grad_norm: 7.4431
2024-10-15 01:00:43,671 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:49, time: 1.770, data_time: 0.027, memory: 18772, stage0_loss_instance_mil: 0.0124, stage0_bag_acc: 99.2607, stage0_mean_ious: 0.5294, stage0_s: 0.0000, stage0_m: 0.0438, stage0_l: 0.3006, stage0_h: 0.5574, stage1_loss_instance_mil: 0.0833, stage1_bag_acc: 99.5714, stage1_neg_loss: 0.0410, stage1_mean_ious: 0.4848, stage1_s: 0.0000, stage1_m: 0.0428, stage1_l: 0.3074, stage1_h: 0.5058, loss: 0.1366, grad_norm: 7.2417
2024-10-15 01:02:12,207 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:42, time: 1.771, data_time: 0.026, memory: 18772, stage0_loss_instance_mil: 0.0110, stage0_bag_acc: 99.3131, stage0_mean_ious: 0.5140, stage0_s: 0.0000, stage0_m: 0.0371, stage0_l: 0.3118, stage0_h: 0.5434, stage1_loss_instance_mil: 0.0867, stage1_bag_acc: 99.5533, stage1_neg_loss: 0.0388, stage1_mean_ious: 0.4708, stage1_s: 0.0000, stage1_m: 0.0317, stage1_l: 0.3005, stage1_h: 0.4946, loss: 0.1365, grad_norm: 6.3373
2024-10-15 01:03:05,016 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 01:04:38,524 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:30, time: 1.825, data_time: 0.077, memory: 18772, stage0_loss_instance_mil: 0.0052, stage0_bag_acc: 99.8038, stage0_mean_ious: 0.5511, stage0_s: 0.0000, stage0_m: 0.0688, stage0_l: 0.3122, stage0_h: 0.5781, stage1_loss_instance_mil: 0.0770, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0344, stage1_mean_ious: 0.4978, stage1_s: 0.0000, stage1_m: 0.0660, stage1_l: 0.2911, stage1_h: 0.5212, loss: 0.1166, grad_norm: 5.1438
2024-10-15 01:06:05,885 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:21, time: 1.747, data_time: 0.027, memory: 18772, stage0_loss_instance_mil: 0.0030, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.5367, stage0_s: 0.0000, stage0_m: 0.0508, stage0_l: 0.2924, stage0_h: 0.5610, stage1_loss_instance_mil: 0.0805, stage1_bag_acc: 99.9167, stage1_neg_loss: 0.0351, stage1_mean_ious: 0.4881, stage1_s: 0.0000, stage1_m: 0.0515, stage1_l: 0.2799, stage1_h: 0.5072, loss: 0.1186, grad_norm: 5.2262
2024-10-15 01:07:32,642 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:11, time: 1.735, data_time: 0.027, memory: 18772, stage0_loss_instance_mil: 0.0019, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5490, stage0_s: 0.0000, stage0_m: 0.0533, stage0_l: 0.3175, stage0_h: 0.5765, stage1_loss_instance_mil: 0.0606, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0345, stage1_mean_ious: 0.4970, stage1_s: 0.0000, stage1_m: 0.0459, stage1_l: 0.2961, stage1_h: 0.5200, loss: 0.0970, grad_norm: 4.6618
2024-10-15 01:08:25,165 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 01:09:56,507 - mmdet - INFO - Evaluating bbox...
2024-10-15 01:09:57,397 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1260
2024-10-15 01:09:57,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3231
2024-10-15 01:09:57,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2254
2024-10-15 01:09:57,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1273
2024-10-15 01:09:57,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0793
2024-10-15 01:09:57,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0331
2024-10-15 01:09:57,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0020
2024-10-15 01:09:57,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1237
2024-10-15 01:09:57,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1361
2024-10-15 01:09:57,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1191
2024-10-15 01:09:57,398 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1970
2024-10-15 01:09:57,399 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4300
2024-10-15 01:09:57,399 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1970
2024-10-15 01:09:57,399 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1970
2024-10-15 01:09:57,399 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1477
2024-10-15 01:09:57,399 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2153
2024-10-15 01:09:57,399 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1534
2024-10-15 01:09:57,416 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 01:09:57,416 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 90, bbox_mAP: 0.1260, bbox_mAP_50: 0.3230, bbox_mAP_75: 0.2250, bbox_mAP_s: 0.1270, bbox_mAP_m: 0.0790, bbox_mAP_l: 0.0330, bbox_mAP_copypaste: 0.126 0.323 0.225 0.127 0.079 0.033
2024-10-15 01:11:27,848 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:12:03, time: 1.808, data_time: 0.083, memory: 18772, stage0_loss_instance_mil: 0.0013, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5512, stage0_s: 0.0000, stage0_m: 0.0296, stage0_l: 0.3257, stage0_h: 0.5792, stage1_loss_instance_mil: 0.0638, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0328, stage1_mean_ious: 0.5032, stage1_s: 0.0000, stage1_m: 0.0281, stage1_l: 0.3232, stage1_h: 0.5250, loss: 0.0979, grad_norm: 4.9131
2024-10-15 01:12:55,459 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:53, time: 1.752, data_time: 0.033, memory: 18772, stage0_loss_instance_mil: 0.0060, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.5285, stage0_s: 0.0000, stage0_m: 0.0372, stage0_l: 0.2867, stage0_h: 0.5629, stage1_loss_instance_mil: 0.0641, stage1_bag_acc: 99.6901, stage1_neg_loss: 0.0342, stage1_mean_ious: 0.4779, stage1_s: 0.0000, stage1_m: 0.0306, stage1_l: 0.2817, stage1_h: 0.5054, loss: 0.1043, grad_norm: 4.8362
2024-10-15 01:14:21,848 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:41, time: 1.728, data_time: 0.031, memory: 18772, stage0_loss_instance_mil: 0.0024, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5215, stage0_s: 0.0000, stage0_m: 0.0660, stage0_l: 0.3149, stage0_h: 0.5562, stage1_loss_instance_mil: 0.0708, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0378, stage1_mean_ious: 0.4635, stage1_s: 0.0000, stage1_m: 0.0592, stage1_l: 0.2899, stage1_h: 0.4917, loss: 0.1110, grad_norm: 4.9120
2024-10-15 01:15:14,961 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 01:16:45,796 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:37, time: 1.774, data_time: 0.078, memory: 18772, stage0_loss_instance_mil: 0.0033, stage0_bag_acc: 99.9167, stage0_mean_ious: 0.5191, stage0_s: 0.0000, stage0_m: 0.0862, stage0_l: 0.3001, stage0_h: 0.5595, stage1_loss_instance_mil: 0.0627, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0298, stage1_mean_ious: 0.4769, stage1_s: 0.0000, stage1_m: 0.0889, stage1_l: 0.3000, stage1_h: 0.5091, loss: 0.0959, grad_norm: 3.9901
2024-10-15 01:18:13,678 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:25, time: 1.758, data_time: 0.031, memory: 18772, stage0_loss_instance_mil: 0.0070, stage0_bag_acc: 99.7519, stage0_mean_ious: 0.5334, stage0_s: 0.0000, stage0_m: 0.0242, stage0_l: 0.3012, stage0_h: 0.5590, stage1_loss_instance_mil: 0.0645, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0354, stage1_mean_ious: 0.4839, stage1_s: 0.0000, stage1_m: 0.0183, stage1_l: 0.2834, stage1_h: 0.5063, loss: 0.1070, grad_norm: 4.4367
2024-10-15 01:19:39,416 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:12, time: 1.715, data_time: 0.029, memory: 18772, stage0_loss_instance_mil: 0.0054, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.5167, stage0_s: 0.0000, stage0_m: 0.0605, stage0_l: 0.2919, stage0_h: 0.5494, stage1_loss_instance_mil: 0.0649, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0294, stage1_mean_ious: 0.4717, stage1_s: 0.0000, stage1_m: 0.0573, stage1_l: 0.2846, stage1_h: 0.4958, loss: 0.0998, grad_norm: 4.8507
2024-10-15 01:20:32,615 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 01:22:03,353 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:11, time: 1.781, data_time: 0.074, memory: 18772, stage0_loss_instance_mil: 0.0013, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.5325, stage0_s: 0.0000, stage0_m: 0.0601, stage0_l: 0.2236, stage0_h: 0.5635, stage1_loss_instance_mil: 0.0590, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0335, stage1_mean_ious: 0.4840, stage1_s: 0.0000, stage1_m: 0.0557, stage1_l: 0.2171, stage1_h: 0.5085, loss: 0.0938, grad_norm: 5.1050
2024-10-15 01:23:31,373 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:58, time: 1.760, data_time: 0.027, memory: 18772, stage0_loss_instance_mil: 0.0046, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.5335, stage0_s: 0.0000, stage0_m: 0.0487, stage0_l: 0.2776, stage0_h: 0.5628, stage1_loss_instance_mil: 0.0591, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0327, stage1_mean_ious: 0.4814, stage1_s: 0.0000, stage1_m: 0.0392, stage1_l: 0.2651, stage1_h: 0.5060, loss: 0.0963, grad_norm: 4.5176
2024-10-15 01:25:00,012 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.773, data_time: 0.026, memory: 18772, stage0_loss_instance_mil: 0.0029, stage0_bag_acc: 99.8350, stage0_mean_ious: 0.5249, stage0_s: 0.0000, stage0_m: 0.0389, stage0_l: 0.2991, stage0_h: 0.5485, stage1_loss_instance_mil: 0.0566, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0367, stage1_mean_ious: 0.4784, stage1_s: 0.0000, stage1_m: 0.0359, stage1_l: 0.2861, stage1_h: 0.4982, loss: 0.0962, grad_norm: 5.2441
2024-10-15 01:25:50,596 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 01:27:24,470 - mmdet - INFO - Evaluating bbox...
2024-10-15 01:27:25,435 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1265
2024-10-15 01:27:25,436 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3271
2024-10-15 01:27:25,436 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2301
2024-10-15 01:27:25,436 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1278
2024-10-15 01:27:25,436 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0756
2024-10-15 01:27:25,436 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0335
2024-10-15 01:27:25,436 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0015
2024-10-15 01:27:25,436 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1278
2024-10-15 01:27:25,436 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1365
2024-10-15 01:27:25,437 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1179
2024-10-15 01:27:25,437 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1966
2024-10-15 01:27:25,437 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4296
2024-10-15 01:27:25,437 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1966
2024-10-15 01:27:25,437 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1966
2024-10-15 01:27:25,437 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1531
2024-10-15 01:27:25,437 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2151
2024-10-15 01:27:25,437 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1505
2024-10-15 01:27:25,455 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 01:27:25,455 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.1270, bbox_mAP_50: 0.3270, bbox_mAP_75: 0.2300, bbox_mAP_s: 0.1280, bbox_mAP_m: 0.0760, bbox_mAP_l: 0.0330, bbox_mAP_copypaste: 0.127 0.327 0.230 0.128 0.076 0.033
2024-10-15 01:28:57,515 - mmdet - INFO - Evaluating bbox...
2024-10-15 01:28:58,403 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1265
2024-10-15 01:28:58,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3271
2024-10-15 01:28:58,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2301
2024-10-15 01:28:58,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1278
2024-10-15 01:28:58,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0756
2024-10-15 01:28:58,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0335
2024-10-15 01:28:58,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0015
2024-10-15 01:28:58,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1278
2024-10-15 01:28:58,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1365
2024-10-15 01:28:58,405 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1179
2024-10-15 01:28:58,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1966
2024-10-15 01:28:58,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4296
2024-10-15 01:28:58,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1966
2024-10-15 01:28:58,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1966
2024-10-15 01:28:58,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1531
2024-10-15 01:28:58,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2151
2024-10-15 01:28:58,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1505
2024-10-15 01:28:59,889 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+bc04488
------------------------------------------------------------

2024-10-15 01:29:00,919 - mmdet - INFO - Distributed training: False
2024-10-15 01:29:01,799 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 01:29:02,824 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 01:29:02,824 - mmdet - INFO - Use load_from_local loader
2024-10-15 01:29:03,093 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 01:29:03,103 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 01:29:03,103 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 01:30:35,082 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:04:41, time: 1.839, data_time: 0.083, memory: 18772, stage0_loss_instance_mil: 0.7122, stage0_bag_acc: 20.4644, stage0_mean_ious: 0.2812, stage0_s: 0.0000, stage0_m: 0.0608, stage0_l: 0.2481, stage0_h: 0.2756, stage1_loss_instance_mil: 0.1633, stage1_bag_acc: 19.9261, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.2751, stage1_s: 0.0000, stage1_m: 0.0645, stage1_l: 0.2450, stage1_h: 0.2691, loss: 0.8775, grad_norm: 3.3646
2024-10-15 01:31:59,760 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 1:00:39, time: 1.694, data_time: 0.029, memory: 18772, stage0_loss_instance_mil: 0.5789, stage0_bag_acc: 58.7982, stage0_mean_ious: 0.3265, stage0_s: 0.0000, stage0_m: 0.0425, stage0_l: 0.2527, stage0_h: 0.3244, stage1_loss_instance_mil: 0.2346, stage1_bag_acc: 32.6256, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.3099, stage1_s: 0.0000, stage1_m: 0.0481, stage1_l: 0.2472, stage1_h: 0.3061, loss: 0.8194, grad_norm: 3.9049
2024-10-15 01:33:25,011 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:58:29, time: 1.705, data_time: 0.029, memory: 18772, stage0_loss_instance_mil: 0.2444, stage0_bag_acc: 93.4585, stage0_mean_ious: 0.3667, stage0_s: 0.0000, stage0_m: 0.0716, stage0_l: 0.2536, stage0_h: 0.3731, stage1_loss_instance_mil: 0.3313, stage1_bag_acc: 86.1041, stage1_neg_loss: 0.0718, stage1_mean_ious: 0.3451, stage1_s: 0.0000, stage1_m: 0.0843, stage1_l: 0.2480, stage1_h: 0.3457, loss: 0.6475, grad_norm: 9.6086
2024-10-15 01:34:17,189 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 01:35:48,922 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:49:08, time: 1.789, data_time: 0.079, memory: 18772, stage0_loss_instance_mil: 0.0781, stage0_bag_acc: 97.1273, stage0_mean_ious: 0.3554, stage0_s: 0.0000, stage0_m: 0.0455, stage0_l: 0.1921, stage0_h: 0.3645, stage1_loss_instance_mil: 0.3450, stage1_bag_acc: 97.1288, stage1_neg_loss: 0.0922, stage1_mean_ious: 0.3313, stage1_s: 0.0000, stage1_m: 0.0404, stage1_l: 0.1749, stage1_h: 0.3397, loss: 0.5152, grad_norm: 13.7367
2024-10-15 01:37:14,233 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:51, time: 1.706, data_time: 0.029, memory: 18772, stage0_loss_instance_mil: 0.0655, stage0_bag_acc: 95.7747, stage0_mean_ious: 0.3388, stage0_s: 0.0000, stage0_m: 0.0614, stage0_l: 0.2196, stage0_h: 0.3553, stage1_loss_instance_mil: 0.3289, stage1_bag_acc: 96.7736, stage1_neg_loss: 0.1004, stage1_mean_ious: 0.3162, stage1_s: 0.0000, stage1_m: 0.0645, stage1_l: 0.2184, stage1_h: 0.3293, loss: 0.4948, grad_norm: 15.4812
2024-10-15 01:38:41,027 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:48:22, time: 1.736, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0345, stage0_bag_acc: 98.1184, stage0_mean_ious: 0.3387, stage0_s: 0.0000, stage0_m: 0.0402, stage0_l: 0.1583, stage0_h: 0.3555, stage1_loss_instance_mil: 0.3131, stage1_bag_acc: 99.0494, stage1_neg_loss: 0.0858, stage1_mean_ious: 0.3060, stage1_s: 0.0000, stage1_m: 0.0420, stage1_l: 0.1409, stage1_h: 0.3230, loss: 0.4334, grad_norm: 13.3662
2024-10-15 01:39:32,513 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 01:41:03,356 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:43:32, time: 1.771, data_time: 0.083, memory: 18833, stage0_loss_instance_mil: 0.0286, stage0_bag_acc: 98.6070, stage0_mean_ious: 0.3308, stage0_s: 0.0000, stage0_m: 0.0594, stage0_l: 0.1506, stage0_h: 0.3526, stage1_loss_instance_mil: 0.2803, stage1_bag_acc: 98.9177, stage1_neg_loss: 0.0845, stage1_mean_ious: 0.3012, stage1_s: 0.0000, stage1_m: 0.0601, stage1_l: 0.1457, stage1_h: 0.3182, loss: 0.3934, grad_norm: 14.3223
2024-10-15 01:42:30,230 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:43:02, time: 1.737, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0329, stage0_bag_acc: 98.1519, stage0_mean_ious: 0.3592, stage0_s: 0.0000, stage0_m: 0.0477, stage0_l: 0.1703, stage0_h: 0.3800, stage1_loss_instance_mil: 0.2554, stage1_bag_acc: 99.0312, stage1_neg_loss: 0.0808, stage1_mean_ious: 0.3173, stage1_s: 0.0000, stage1_m: 0.0522, stage1_l: 0.1662, stage1_h: 0.3329, loss: 0.3691, grad_norm: 14.2125
2024-10-15 01:43:56,798 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:42:21, time: 1.731, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0250, stage0_bag_acc: 98.8332, stage0_mean_ious: 0.3508, stage0_s: 0.0000, stage0_m: 0.0568, stage0_l: 0.1372, stage0_h: 0.3722, stage1_loss_instance_mil: 0.2379, stage1_bag_acc: 99.3244, stage1_neg_loss: 0.0740, stage1_mean_ious: 0.3103, stage1_s: 0.0000, stage1_m: 0.0591, stage1_l: 0.1361, stage1_h: 0.3261, loss: 0.3369, grad_norm: 13.4682
2024-10-15 01:44:47,041 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 01:46:17,613 - mmdet - INFO - Evaluating bbox...
2024-10-15 01:46:18,456 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0351
2024-10-15 01:46:18,456 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1346
2024-10-15 01:46:18,456 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0613
2024-10-15 01:46:18,456 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0182
2024-10-15 01:46:18,456 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0058
2024-10-15 01:46:18,456 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0017
2024-10-15 01:46:18,456 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-15 01:46:18,456 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0060
2024-10-15 01:46:18,457 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0481
2024-10-15 01:46:18,457 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0320
2024-10-15 01:46:18,457 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0905
2024-10-15 01:46:18,457 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2609
2024-10-15 01:46:18,457 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0905
2024-10-15 01:46:18,457 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0905
2024-10-15 01:46:18,457 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0264
2024-10-15 01:46:18,457 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1141
2024-10-15 01:46:18,457 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0428
2024-10-15 01:46:18,475 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 01:46:18,475 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 90, bbox_mAP: 0.0350, bbox_mAP_50: 0.1350, bbox_mAP_75: 0.0610, bbox_mAP_s: 0.0180, bbox_mAP_m: 0.0060, bbox_mAP_l: 0.0020, bbox_mAP_copypaste: 0.035 0.135 0.061 0.018 0.006 0.002
2024-10-15 01:47:47,355 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:46, time: 1.777, data_time: 0.076, memory: 18833, stage0_loss_instance_mil: 0.0268, stage0_bag_acc: 98.2804, stage0_mean_ious: 0.3404, stage0_s: 0.0000, stage0_m: 0.0368, stage0_l: 0.1557, stage0_h: 0.3689, stage1_loss_instance_mil: 0.2353, stage1_bag_acc: 99.0513, stage1_neg_loss: 0.0717, stage1_mean_ious: 0.3025, stage1_s: 0.0000, stage1_m: 0.0430, stage1_l: 0.1539, stage1_h: 0.3249, loss: 0.3338, grad_norm: 13.9190
2024-10-15 01:49:12,019 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:57, time: 1.693, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0354, stage0_bag_acc: 98.0692, stage0_mean_ious: 0.3513, stage0_s: 0.0000, stage0_m: 0.0301, stage0_l: 0.1366, stage0_h: 0.3759, stage1_loss_instance_mil: 0.1990, stage1_bag_acc: 99.0186, stage1_neg_loss: 0.0781, stage1_mean_ious: 0.3156, stage1_s: 0.0000, stage1_m: 0.0330, stage1_l: 0.1315, stage1_h: 0.3350, loss: 0.3126, grad_norm: 15.0263
2024-10-15 01:50:39,117 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:08, time: 1.742, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0169, stage0_bag_acc: 99.1857, stage0_mean_ious: 0.3518, stage0_s: 0.0000, stage0_m: 0.0525, stage0_l: 0.1530, stage0_h: 0.3864, stage1_loss_instance_mil: 0.2119, stage1_bag_acc: 99.3947, stage1_neg_loss: 0.0660, stage1_mean_ious: 0.3213, stage1_s: 0.0000, stage1_m: 0.0585, stage1_l: 0.1552, stage1_h: 0.3497, loss: 0.2948, grad_norm: 12.2051
2024-10-15 01:51:31,896 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 01:53:04,152 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:10, time: 1.801, data_time: 0.082, memory: 18833, stage0_loss_instance_mil: 0.0148, stage0_bag_acc: 99.1591, stage0_mean_ious: 0.3784, stage0_s: 0.0000, stage0_m: 0.0374, stage0_l: 0.1143, stage0_h: 0.3995, stage1_loss_instance_mil: 0.1964, stage1_bag_acc: 99.6104, stage1_neg_loss: 0.0828, stage1_mean_ious: 0.3274, stage1_s: 0.0000, stage1_m: 0.0478, stage1_l: 0.1134, stage1_h: 0.3414, loss: 0.2940, grad_norm: 16.3017
2024-10-15 01:54:30,954 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:18, time: 1.736, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0190, stage0_bag_acc: 98.9244, stage0_mean_ious: 0.3490, stage0_s: 0.0079, stage0_m: 0.0473, stage0_l: 0.1233, stage0_h: 0.3825, stage1_loss_instance_mil: 0.1760, stage1_bag_acc: 99.5405, stage1_neg_loss: 0.0613, stage1_mean_ious: 0.3189, stage1_s: 0.0055, stage1_m: 0.0551, stage1_l: 0.1341, stage1_h: 0.3447, loss: 0.2562, grad_norm: 10.6210
2024-10-15 01:55:54,599 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:17, time: 1.673, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0161, stage0_bag_acc: 99.2801, stage0_mean_ious: 0.3471, stage0_s: 0.0000, stage0_m: 0.0356, stage0_l: 0.1285, stage0_h: 0.3769, stage1_loss_instance_mil: 0.1630, stage1_bag_acc: 99.4007, stage1_neg_loss: 0.0630, stage1_mean_ious: 0.3130, stage1_s: 0.0000, stage1_m: 0.0405, stage1_l: 0.1368, stage1_h: 0.3356, loss: 0.2421, grad_norm: 10.8686
2024-10-15 01:56:46,473 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 01:58:13,939 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:32, time: 1.704, data_time: 0.081, memory: 18833, stage0_loss_instance_mil: 0.0114, stage0_bag_acc: 99.2676, stage0_mean_ious: 0.3502, stage0_s: 0.0000, stage0_m: 0.0422, stage0_l: 0.1483, stage0_h: 0.3748, stage1_loss_instance_mil: 0.1637, stage1_bag_acc: 99.3888, stage1_neg_loss: 0.0583, stage1_mean_ious: 0.3151, stage1_s: 0.0000, stage1_m: 0.0549, stage1_l: 0.1625, stage1_h: 0.3320, loss: 0.2334, grad_norm: 10.2223
2024-10-15 01:59:41,431 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 01:59:41,432 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:35, time: 1.750, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0110, stage0_bag_acc: 99.7095, stage0_mean_ious: 0.3874, stage0_s: 0.0000, stage0_m: 0.0386, stage0_l: 0.1651, stage0_h: 0.4158, stage1_loss_instance_mil: 0.1597, stage1_bag_acc: 99.6919, stage1_neg_loss: 0.0611, stage1_mean_ious: 0.3417, stage1_s: 0.0000, stage1_m: 0.0417, stage1_l: 0.1666, stage1_h: 0.3619, loss: 0.2318, grad_norm: 10.9895
2024-10-15 02:01:07,587 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:34, time: 1.723, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0125, stage0_bag_acc: 99.0350, stage0_mean_ious: 0.3626, stage0_s: 0.0000, stage0_m: 0.0109, stage0_l: 0.1308, stage0_h: 0.3929, stage1_loss_instance_mil: 0.1333, stage1_bag_acc: 99.3565, stage1_neg_loss: 0.0510, stage1_mean_ious: 0.3314, stage1_s: 0.0000, stage1_m: 0.0123, stage1_l: 0.1411, stage1_h: 0.3548, loss: 0.1968, grad_norm: 8.9996
2024-10-15 02:01:58,225 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 02:03:30,373 - mmdet - INFO - Evaluating bbox...
2024-10-15 02:03:31,244 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0332
2024-10-15 02:03:31,244 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1242
2024-10-15 02:03:31,244 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0580
2024-10-15 02:03:31,245 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0176
2024-10-15 02:03:31,245 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0067
2024-10-15 02:03:31,245 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0017
2024-10-15 02:03:31,245 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-15 02:03:31,245 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0061
2024-10-15 02:03:31,245 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0454
2024-10-15 02:03:31,245 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1023
2024-10-15 02:03:31,245 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0835
2024-10-15 02:03:31,245 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2383
2024-10-15 02:03:31,245 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0835
2024-10-15 02:03:31,246 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0835
2024-10-15 02:03:31,246 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0230
2024-10-15 02:03:31,246 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0984
2024-10-15 02:03:31,246 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1169
2024-10-15 02:03:31,262 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 02:03:31,262 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0330, bbox_mAP_50: 0.1240, bbox_mAP_75: 0.0580, bbox_mAP_s: 0.0180, bbox_mAP_m: 0.0070, bbox_mAP_l: 0.0020, bbox_mAP_copypaste: 0.033 0.124 0.058 0.018 0.007 0.002
2024-10-15 02:04:59,075 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:06, time: 1.756, data_time: 0.079, memory: 18833, stage0_loss_instance_mil: 0.0066, stage0_bag_acc: 99.7667, stage0_mean_ious: 0.3672, stage0_s: 0.0000, stage0_m: 0.0407, stage0_l: 0.2239, stage0_h: 0.3927, stage1_loss_instance_mil: 0.1343, stage1_bag_acc: 99.6805, stage1_neg_loss: 0.0569, stage1_mean_ious: 0.3268, stage1_s: 0.0000, stage1_m: 0.0485, stage1_l: 0.2166, stage1_h: 0.3442, loss: 0.1977, grad_norm: 9.2505
2024-10-15 02:06:23,776 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:03, time: 1.694, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0085, stage0_bag_acc: 99.3773, stage0_mean_ious: 0.3580, stage0_s: 0.0000, stage0_m: 0.0370, stage0_l: 0.1175, stage0_h: 0.3869, stage1_loss_instance_mil: 0.1480, stage1_bag_acc: 99.9231, stage1_neg_loss: 0.0591, stage1_mean_ious: 0.3210, stage1_s: 0.0000, stage1_m: 0.0376, stage1_l: 0.1261, stage1_h: 0.3430, loss: 0.2155, grad_norm: 10.8619
2024-10-15 02:07:50,111 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:59, time: 1.727, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0111, stage0_bag_acc: 99.5751, stage0_mean_ious: 0.3469, stage0_s: 0.0000, stage0_m: 0.0409, stage0_l: 0.1149, stage0_h: 0.3770, stage1_loss_instance_mil: 0.1325, stage1_bag_acc: 99.2841, stage1_neg_loss: 0.0555, stage1_mean_ious: 0.3167, stage1_s: 0.0000, stage1_m: 0.0508, stage1_l: 0.1299, stage1_h: 0.3383, loss: 0.1991, grad_norm: 8.9422
2024-10-15 02:08:42,417 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 02:10:12,883 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:40, time: 1.764, data_time: 0.081, memory: 18833, stage0_loss_instance_mil: 0.0097, stage0_bag_acc: 99.2861, stage0_mean_ious: 0.3558, stage0_s: 0.0000, stage0_m: 0.0220, stage0_l: 0.1493, stage0_h: 0.3865, stage1_loss_instance_mil: 0.1184, stage1_bag_acc: 99.6636, stage1_neg_loss: 0.0511, stage1_mean_ious: 0.3178, stage1_s: 0.0000, stage1_m: 0.0269, stage1_l: 0.1439, stage1_h: 0.3430, loss: 0.1792, grad_norm: 8.4367
2024-10-15 02:11:40,634 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:36, time: 1.755, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0208, stage0_bag_acc: 99.0264, stage0_mean_ious: 0.3392, stage0_s: 0.0000, stage0_m: 0.0465, stage0_l: 0.1394, stage0_h: 0.3710, stage1_loss_instance_mil: 0.1210, stage1_bag_acc: 99.1890, stage1_neg_loss: 0.0499, stage1_mean_ious: 0.3069, stage1_s: 0.0000, stage1_m: 0.0575, stage1_l: 0.1417, stage1_h: 0.3313, loss: 0.1918, grad_norm: 7.3547
2024-10-15 02:13:07,333 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:30, time: 1.734, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.2452, stage0_mean_ious: 0.3815, stage0_s: 0.0000, stage0_m: 0.0538, stage0_l: 0.1514, stage0_h: 0.4065, stage1_loss_instance_mil: 0.1107, stage1_bag_acc: 99.6722, stage1_neg_loss: 0.0509, stage1_mean_ious: 0.3413, stage1_s: 0.0000, stage1_m: 0.0618, stage1_l: 0.1588, stage1_h: 0.3585, loss: 0.1725, grad_norm: 8.3401
2024-10-15 02:13:58,981 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 02:15:31,345 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:18, time: 1.802, data_time: 0.083, memory: 18833, stage0_loss_instance_mil: 0.0093, stage0_bag_acc: 99.4828, stage0_mean_ious: 0.3921, stage0_s: 0.0000, stage0_m: 0.0198, stage0_l: 0.1178, stage0_h: 0.4220, stage1_loss_instance_mil: 0.1163, stage1_bag_acc: 99.6095, stage1_neg_loss: 0.0411, stage1_mean_ious: 0.3580, stage1_s: 0.0000, stage1_m: 0.0250, stage1_l: 0.1272, stage1_h: 0.3814, loss: 0.1666, grad_norm: 7.4579
2024-10-15 02:16:57,633 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:11, time: 1.726, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0072, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.3513, stage0_s: 0.0000, stage0_m: 0.0265, stage0_l: 0.1375, stage0_h: 0.3825, stage1_loss_instance_mil: 0.0870, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0416, stage1_mean_ious: 0.3231, stage1_s: 0.0000, stage1_m: 0.0296, stage1_l: 0.1558, stage1_h: 0.3462, loss: 0.1357, grad_norm: 5.0148
2024-10-15 02:18:26,518 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:03, time: 1.778, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0029, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.3680, stage0_s: 0.0000, stage0_m: 0.0316, stage0_l: 0.1199, stage0_h: 0.4067, stage1_loss_instance_mil: 0.0912, stage1_bag_acc: 99.6912, stage1_neg_loss: 0.0435, stage1_mean_ious: 0.3374, stage1_s: 0.0000, stage1_m: 0.0381, stage1_l: 0.1236, stage1_h: 0.3683, loss: 0.1376, grad_norm: 6.3982
2024-10-15 02:19:17,820 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 02:20:49,983 - mmdet - INFO - Evaluating bbox...
2024-10-15 02:20:50,832 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0442
2024-10-15 02:20:50,832 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1600
2024-10-15 02:20:50,833 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0777
2024-10-15 02:20:50,833 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0262
2024-10-15 02:20:50,833 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0125
2024-10-15 02:20:50,833 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0026
2024-10-15 02:20:50,833 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-15 02:20:50,833 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0011
2024-10-15 02:20:50,833 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0626
2024-10-15 02:20:50,833 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1277
2024-10-15 02:20:50,833 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1041
2024-10-15 02:20:50,833 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2905
2024-10-15 02:20:50,834 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1041
2024-10-15 02:20:50,834 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1041
2024-10-15 02:20:50,834 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0108
2024-10-15 02:20:50,834 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1218
2024-10-15 02:20:50,834 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1463
2024-10-15 02:20:50,848 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 02:20:50,849 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 90, bbox_mAP: 0.0440, bbox_mAP_50: 0.1600, bbox_mAP_75: 0.0780, bbox_mAP_s: 0.0260, bbox_mAP_m: 0.0120, bbox_mAP_l: 0.0030, bbox_mAP_copypaste: 0.044 0.160 0.078 0.026 0.012 0.003
2024-10-15 02:22:21,936 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:56, time: 1.821, data_time: 0.085, memory: 18833, stage0_loss_instance_mil: 0.0075, stage0_bag_acc: 99.7798, stage0_mean_ious: 0.3696, stage0_s: 0.0000, stage0_m: 0.0279, stage0_l: 0.1339, stage0_h: 0.3948, stage1_loss_instance_mil: 0.0868, stage1_bag_acc: 99.6845, stage1_neg_loss: 0.0458, stage1_mean_ious: 0.3375, stage1_s: 0.0000, stage1_m: 0.0254, stage1_l: 0.1359, stage1_h: 0.3579, loss: 0.1401, grad_norm: 5.6663
2024-10-15 02:23:48,771 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:47, time: 1.737, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0043, stage0_bag_acc: 99.8000, stage0_mean_ious: 0.3543, stage0_s: 0.0000, stage0_m: 0.0357, stage0_l: 0.1488, stage0_h: 0.3802, stage1_loss_instance_mil: 0.0847, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0404, stage1_mean_ious: 0.3199, stage1_s: 0.0000, stage1_m: 0.0401, stage1_l: 0.1549, stage1_h: 0.3407, loss: 0.1295, grad_norm: 5.3708
2024-10-15 02:25:16,215 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:36, time: 1.749, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0041, stage0_bag_acc: 99.7308, stage0_mean_ious: 0.3650, stage0_s: 0.0000, stage0_m: 0.0526, stage0_l: 0.1502, stage0_h: 0.4006, stage1_loss_instance_mil: 0.0833, stage1_bag_acc: 99.6828, stage1_neg_loss: 0.0371, stage1_mean_ious: 0.3322, stage1_s: 0.0000, stage1_m: 0.0691, stage1_l: 0.1637, stage1_h: 0.3565, loss: 0.1245, grad_norm: 4.8650
2024-10-15 02:26:09,115 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 02:27:41,481 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:33, time: 1.802, data_time: 0.081, memory: 18833, stage0_loss_instance_mil: 0.0070, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.3579, stage0_s: 0.0080, stage0_m: 0.0461, stage0_l: 0.1512, stage0_h: 0.3942, stage1_loss_instance_mil: 0.0871, stage1_bag_acc: 99.8824, stage1_neg_loss: 0.0444, stage1_mean_ious: 0.3289, stage1_s: 0.0066, stage1_m: 0.0554, stage1_l: 0.1621, stage1_h: 0.3565, loss: 0.1385, grad_norm: 5.6749
2024-10-15 02:29:08,975 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:22, time: 1.750, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0017, stage0_bag_acc: 99.8571, stage0_mean_ious: 0.3640, stage0_s: 0.0000, stage0_m: 0.0419, stage0_l: 0.0997, stage0_h: 0.3947, stage1_loss_instance_mil: 0.0758, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0365, stage1_mean_ious: 0.3309, stage1_s: 0.0000, stage1_m: 0.0502, stage1_l: 0.1143, stage1_h: 0.3538, loss: 0.1140, grad_norm: 5.0739
2024-10-15 02:30:34,842 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:10, time: 1.717, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0020, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.3698, stage0_s: 0.0000, stage0_m: 0.0277, stage0_l: 0.1286, stage0_h: 0.3974, stage1_loss_instance_mil: 0.0906, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0408, stage1_mean_ious: 0.3353, stage1_s: 0.0000, stage1_m: 0.0305, stage1_l: 0.1406, stage1_h: 0.3558, loss: 0.1334, grad_norm: 5.1196
2024-10-15 02:31:25,145 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 02:32:56,822 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:10, time: 1.785, data_time: 0.084, memory: 18833, stage0_loss_instance_mil: 0.0018, stage0_bag_acc: 99.9130, stage0_mean_ious: 0.3892, stage0_s: 0.0000, stage0_m: 0.0225, stage0_l: 0.1489, stage0_h: 0.4261, stage1_loss_instance_mil: 0.0687, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0377, stage1_mean_ious: 0.3586, stage1_s: 0.0000, stage1_m: 0.0267, stage1_l: 0.1551, stage1_h: 0.3867, loss: 0.1082, grad_norm: 4.6226
2024-10-15 02:34:20,167 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:57, time: 1.667, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0029, stage0_bag_acc: 99.7222, stage0_mean_ious: 0.3593, stage0_s: 0.0000, stage0_m: 0.0339, stage0_l: 0.1425, stage0_h: 0.3885, stage1_loss_instance_mil: 0.0828, stage1_bag_acc: 99.8477, stage1_neg_loss: 0.0391, stage1_mean_ious: 0.3278, stage1_s: 0.0000, stage1_m: 0.0434, stage1_l: 0.1544, stage1_h: 0.3492, loss: 0.1249, grad_norm: 5.3250
2024-10-15 02:35:44,422 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.685, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0050, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.3407, stage0_s: 0.0000, stage0_m: 0.0373, stage0_l: 0.1568, stage0_h: 0.3648, stage1_loss_instance_mil: 0.0878, stage1_bag_acc: 99.7995, stage1_neg_loss: 0.0443, stage1_mean_ious: 0.3167, stage1_s: 0.0000, stage1_m: 0.0414, stage1_l: 0.1610, stage1_h: 0.3353, loss: 0.1372, grad_norm: 5.7695
2024-10-15 02:36:37,397 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 02:38:09,677 - mmdet - INFO - Evaluating bbox...
2024-10-15 02:38:10,515 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0417
2024-10-15 02:38:10,515 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1535
2024-10-15 02:38:10,515 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0684
2024-10-15 02:38:10,515 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0245
2024-10-15 02:38:10,515 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0127
2024-10-15 02:38:10,515 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0047
2024-10-15 02:38:10,515 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-15 02:38:10,516 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0016
2024-10-15 02:38:10,516 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0605
2024-10-15 02:38:10,516 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1184
2024-10-15 02:38:10,516 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1025
2024-10-15 02:38:10,516 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2828
2024-10-15 02:38:10,516 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1025
2024-10-15 02:38:10,516 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1025
2024-10-15 02:38:10,516 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0122
2024-10-15 02:38:10,516 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1216
2024-10-15 02:38:10,516 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1369
2024-10-15 02:38:10,531 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 02:38:10,531 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0420, bbox_mAP_50: 0.1540, bbox_mAP_75: 0.0680, bbox_mAP_s: 0.0240, bbox_mAP_m: 0.0130, bbox_mAP_l: 0.0050, bbox_mAP_copypaste: 0.042 0.154 0.068 0.024 0.013 0.005
2024-10-15 02:39:40,738 - mmdet - INFO - Evaluating bbox...
2024-10-15 02:39:41,575 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0417
2024-10-15 02:39:41,575 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1535
2024-10-15 02:39:41,576 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0684
2024-10-15 02:39:41,576 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0245
2024-10-15 02:39:41,576 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0127
2024-10-15 02:39:41,576 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0047
2024-10-15 02:39:41,576 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-15 02:39:41,576 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0016
2024-10-15 02:39:41,576 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0605
2024-10-15 02:39:41,576 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1184
2024-10-15 02:39:41,576 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1025
2024-10-15 02:39:41,577 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2828
2024-10-15 02:39:41,577 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1025
2024-10-15 02:39:41,577 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1025
2024-10-15 02:39:41,577 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0122
2024-10-15 02:39:41,577 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1216
2024-10-15 02:39:41,577 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1369
2024-10-15 02:39:43,002 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+bc04488
------------------------------------------------------------

2024-10-15 02:39:43,905 - mmdet - INFO - Distributed training: False
2024-10-15 02:39:44,858 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 02:39:45,830 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 02:39:45,830 - mmdet - INFO - Use load_from_local loader
2024-10-15 02:39:46,087 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 02:39:46,097 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 02:39:46,097 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 02:41:13,342 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:01:21, time: 1.745, data_time: 0.079, memory: 18833, stage0_loss_instance_mil: 0.6883, stage0_bag_acc: 35.1310, stage0_mean_ious: 0.2205, stage0_s: 0.0000, stage0_m: 0.0499, stage0_l: 0.2219, stage0_h: 0.2117, stage1_loss_instance_mil: 0.1828, stage1_bag_acc: 19.5037, stage1_neg_loss: 0.0012, stage1_mean_ious: 0.2281, stage1_s: 0.0000, stage1_m: 0.0496, stage1_l: 0.2340, stage1_h: 0.2189, loss: 0.8723, grad_norm: 3.2901
2024-10-15 02:42:40,623 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:55, time: 1.746, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.5685, stage0_bag_acc: 58.5784, stage0_mean_ious: 0.2675, stage0_s: 0.0000, stage0_m: 0.0712, stage0_l: 0.2733, stage0_h: 0.2526, stage1_loss_instance_mil: 0.2442, stage1_bag_acc: 38.5912, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.2807, stage1_s: 0.0000, stage1_m: 0.0541, stage1_l: 0.2766, stage1_h: 0.2684, loss: 0.8177, grad_norm: 4.9882
2024-10-15 02:44:05,226 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:57:52, time: 1.692, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.2713, stage0_bag_acc: 85.2947, stage0_mean_ious: 0.2485, stage0_s: 0.0000, stage0_m: 0.0371, stage0_l: 0.2222, stage0_h: 0.2440, stage1_loss_instance_mil: 0.3230, stage1_bag_acc: 76.1270, stage1_neg_loss: 0.0723, stage1_mean_ious: 0.2479, stage1_s: 0.0000, stage1_m: 0.0293, stage1_l: 0.2117, stage1_h: 0.2453, loss: 0.6666, grad_norm: 13.5073
2024-10-15 02:44:57,379 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 02:46:27,592 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:32, time: 1.759, data_time: 0.079, memory: 18833, stage0_loss_instance_mil: 0.0841, stage0_bag_acc: 95.6191, stage0_mean_ious: 0.2166, stage0_s: 0.0000, stage0_m: 0.0478, stage0_l: 0.1930, stage0_h: 0.2138, stage1_loss_instance_mil: 0.3257, stage1_bag_acc: 95.4304, stage1_neg_loss: 0.0897, stage1_mean_ious: 0.2136, stage1_s: 0.0000, stage1_m: 0.0542, stage1_l: 0.1835, stage1_h: 0.2116, loss: 0.4995, grad_norm: 12.7994
2024-10-15 02:47:53,872 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:29, time: 1.726, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0508, stage0_bag_acc: 97.0714, stage0_mean_ious: 0.2009, stage0_s: 0.0000, stage0_m: 0.0268, stage0_l: 0.1838, stage0_h: 0.1983, stage1_loss_instance_mil: 0.3279, stage1_bag_acc: 98.2683, stage1_neg_loss: 0.0862, stage1_mean_ious: 0.2044, stage1_s: 0.0000, stage1_m: 0.0321, stage1_l: 0.1932, stage1_h: 0.2004, loss: 0.4649, grad_norm: 13.2342
2024-10-15 02:49:19,890 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:48:00, time: 1.720, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0493, stage0_bag_acc: 96.9926, stage0_mean_ious: 0.2059, stage0_s: 0.0045, stage0_m: 0.0486, stage0_l: 0.2198, stage0_h: 0.2040, stage1_loss_instance_mil: 0.3080, stage1_bag_acc: 98.4616, stage1_neg_loss: 0.0864, stage1_mean_ious: 0.1989, stage1_s: 0.0071, stage1_m: 0.0415, stage1_l: 0.2107, stage1_h: 0.1995, loss: 0.4437, grad_norm: 13.2955
2024-10-15 02:50:12,053 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 02:51:43,705 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:43:18, time: 1.788, data_time: 0.083, memory: 18833, stage0_loss_instance_mil: 0.0409, stage0_bag_acc: 97.2889, stage0_mean_ious: 0.2781, stage0_s: 0.0000, stage0_m: 0.0447, stage0_l: 0.1701, stage0_h: 0.2887, stage1_loss_instance_mil: 0.2935, stage1_bag_acc: 98.8808, stage1_neg_loss: 0.0844, stage1_mean_ious: 0.2608, stage1_s: 0.0000, stage1_m: 0.0371, stage1_l: 0.1716, stage1_h: 0.2704, loss: 0.4187, grad_norm: 13.5480
2024-10-15 02:53:09,040 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:45, time: 1.707, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0525, stage0_bag_acc: 96.7693, stage0_mean_ious: 0.3019, stage0_s: 0.0000, stage0_m: 0.0491, stage0_l: 0.2241, stage0_h: 0.3088, stage1_loss_instance_mil: 0.2901, stage1_bag_acc: 98.7037, stage1_neg_loss: 0.0900, stage1_mean_ious: 0.2926, stage1_s: 0.0000, stage1_m: 0.0573, stage1_l: 0.2145, stage1_h: 0.2996, loss: 0.4326, grad_norm: 15.9239
2024-10-15 02:54:37,146 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:42:10, time: 1.762, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0202, stage0_bag_acc: 98.8139, stage0_mean_ious: 0.3032, stage0_s: 0.0000, stage0_m: 0.0508, stage0_l: 0.1817, stage0_h: 0.3131, stage1_loss_instance_mil: 0.2542, stage1_bag_acc: 99.1184, stage1_neg_loss: 0.0811, stage1_mean_ious: 0.2856, stage1_s: 0.0000, stage1_m: 0.0475, stage1_l: 0.1730, stage1_h: 0.2943, loss: 0.3555, grad_norm: 16.2635
2024-10-15 02:55:29,292 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 02:57:00,900 - mmdet - INFO - Evaluating bbox...
2024-10-15 02:57:01,710 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0872
2024-10-15 02:57:01,710 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2782
2024-10-15 02:57:01,710 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1555
2024-10-15 02:57:01,710 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0660
2024-10-15 02:57:01,710 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0343
2024-10-15 02:57:01,710 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0080
2024-10-15 02:57:01,710 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-15 02:57:01,711 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0658
2024-10-15 02:57:01,711 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0899
2024-10-15 02:57:01,711 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0704
2024-10-15 02:57:01,711 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1481
2024-10-15 02:57:01,711 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3673
2024-10-15 02:57:01,711 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1481
2024-10-15 02:57:01,711 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1481
2024-10-15 02:57:01,711 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1002
2024-10-15 02:57:01,711 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1568
2024-10-15 02:57:01,711 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0805
2024-10-15 02:57:01,727 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 02:57:01,727 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 90, bbox_mAP: 0.0870, bbox_mAP_50: 0.2780, bbox_mAP_75: 0.1560, bbox_mAP_s: 0.0660, bbox_mAP_m: 0.0340, bbox_mAP_l: 0.0080, bbox_mAP_copypaste: 0.087 0.278 0.156 0.066 0.034 0.008
2024-10-15 02:58:32,538 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:43, time: 1.816, data_time: 0.084, memory: 18833, stage0_loss_instance_mil: 0.0234, stage0_bag_acc: 98.8719, stage0_mean_ious: 0.3820, stage0_s: 0.0000, stage0_m: 0.0222, stage0_l: 0.2093, stage0_h: 0.4053, stage1_loss_instance_mil: 0.2166, stage1_bag_acc: 98.9924, stage1_neg_loss: 0.0685, stage1_mean_ious: 0.3560, stage1_s: 0.0000, stage1_m: 0.0225, stage1_l: 0.2150, stage1_h: 0.3730, loss: 0.3085, grad_norm: 12.4008
2024-10-15 03:00:00,110 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:38:01, time: 1.751, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0196, stage0_bag_acc: 99.0931, stage0_mean_ious: 0.5000, stage0_s: 0.0088, stage0_m: 0.0601, stage0_l: 0.2303, stage0_h: 0.5324, stage1_loss_instance_mil: 0.1818, stage1_bag_acc: 99.3336, stage1_neg_loss: 0.0626, stage1_mean_ious: 0.4660, stage1_s: 0.0098, stage1_m: 0.0729, stage1_l: 0.2397, stage1_h: 0.4900, loss: 0.2640, grad_norm: 13.0099
2024-10-15 03:01:26,359 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:10, time: 1.725, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0173, stage0_bag_acc: 98.9495, stage0_mean_ious: 0.4998, stage0_s: 0.0000, stage0_m: 0.0741, stage0_l: 0.1704, stage0_h: 0.5312, stage1_loss_instance_mil: 0.1458, stage1_bag_acc: 99.1077, stage1_neg_loss: 0.0602, stage1_mean_ious: 0.4731, stage1_s: 0.0000, stage1_m: 0.0816, stage1_l: 0.1884, stage1_h: 0.4984, loss: 0.2233, grad_norm: 12.0932
2024-10-15 03:02:17,541 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 03:03:48,729 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:10, time: 1.778, data_time: 0.082, memory: 18833, stage0_loss_instance_mil: 0.0205, stage0_bag_acc: 99.2453, stage0_mean_ious: 0.4599, stage0_s: 0.0000, stage0_m: 0.0690, stage0_l: 0.2430, stage0_h: 0.4841, stage1_loss_instance_mil: 0.1740, stage1_bag_acc: 99.3176, stage1_neg_loss: 0.0586, stage1_mean_ious: 0.4351, stage1_s: 0.0000, stage1_m: 0.0803, stage1_l: 0.2515, stage1_h: 0.4505, loss: 0.2531, grad_norm: 11.3342
2024-10-15 03:05:14,418 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:15, time: 1.714, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0140, stage0_bag_acc: 99.2507, stage0_mean_ious: 0.4817, stage0_s: 0.0088, stage0_m: 0.0573, stage0_l: 0.2712, stage0_h: 0.5003, stage1_loss_instance_mil: 0.1389, stage1_bag_acc: 99.3332, stage1_neg_loss: 0.0535, stage1_mean_ious: 0.4352, stage1_s: 0.0107, stage1_m: 0.0615, stage1_l: 0.2721, stage1_h: 0.4469, loss: 0.2064, grad_norm: 10.1675
2024-10-15 03:06:41,474 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:20, time: 1.741, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0152, stage0_bag_acc: 99.0267, stage0_mean_ious: 0.5264, stage0_s: 0.0000, stage0_m: 0.0183, stage0_l: 0.3286, stage0_h: 0.5559, stage1_loss_instance_mil: 0.1071, stage1_bag_acc: 98.8737, stage1_neg_loss: 0.0414, stage1_mean_ious: 0.4930, stage1_s: 0.0000, stage1_m: 0.0187, stage1_l: 0.3209, stage1_h: 0.5184, loss: 0.1637, grad_norm: 6.9273
2024-10-15 03:07:33,055 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 03:09:04,059 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:39, time: 1.776, data_time: 0.082, memory: 18833, stage0_loss_instance_mil: 0.0307, stage0_bag_acc: 98.0042, stage0_mean_ious: 0.4744, stage0_s: 0.0000, stage0_m: 0.0788, stage0_l: 0.3219, stage0_h: 0.4913, stage1_loss_instance_mil: 0.1332, stage1_bag_acc: 97.5012, stage1_neg_loss: 0.0526, stage1_mean_ious: 0.4503, stage1_s: 0.0000, stage1_m: 0.0726, stage1_l: 0.3435, stage1_h: 0.4604, loss: 0.2165, grad_norm: 10.5322
2024-10-15 03:10:29,690 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 03:10:29,690 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:40, time: 1.713, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0195, stage0_bag_acc: 99.0507, stage0_mean_ious: 0.5079, stage0_s: 0.0000, stage0_m: 0.0232, stage0_l: 0.3114, stage0_h: 0.5222, stage1_loss_instance_mil: 0.1122, stage1_bag_acc: 99.1683, stage1_neg_loss: 0.0426, stage1_mean_ious: 0.4727, stage1_s: 0.0000, stage1_m: 0.0224, stage1_l: 0.3061, stage1_h: 0.4837, loss: 0.1742, grad_norm: 7.2147
2024-10-15 03:11:55,972 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:38, time: 1.726, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0093, stage0_bag_acc: 99.6521, stage0_mean_ious: 0.5398, stage0_s: 0.0000, stage0_m: 0.0510, stage0_l: 0.3473, stage0_h: 0.5718, stage1_loss_instance_mil: 0.0843, stage1_bag_acc: 99.6718, stage1_neg_loss: 0.0371, stage1_mean_ious: 0.5082, stage1_s: 0.0000, stage1_m: 0.0553, stage1_l: 0.3591, stage1_h: 0.5320, loss: 0.1307, grad_norm: 5.4169
2024-10-15 03:12:49,645 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 03:14:21,392 - mmdet - INFO - Evaluating bbox...
2024-10-15 03:14:22,260 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2100
2024-10-15 03:14:22,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4836
2024-10-15 03:14:22,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3490
2024-10-15 03:14:22,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2314
2024-10-15 03:14:22,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1750
2024-10-15 03:14:22,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1041
2024-10-15 03:14:22,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0145
2024-10-15 03:14:22,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2563
2024-10-15 03:14:22,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1817
2024-10-15 03:14:22,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2651
2024-10-15 03:14:22,261 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2958
2024-10-15 03:14:22,261 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.5850
2024-10-15 03:14:22,262 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2958
2024-10-15 03:14:22,262 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2958
2024-10-15 03:14:22,262 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3188
2024-10-15 03:14:22,262 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2685
2024-10-15 03:14:22,262 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3015
2024-10-15 03:14:22,275 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 03:14:22,275 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.2100, bbox_mAP_50: 0.4840, bbox_mAP_75: 0.3490, bbox_mAP_s: 0.2310, bbox_mAP_m: 0.1750, bbox_mAP_l: 0.1040, bbox_mAP_copypaste: 0.210 0.484 0.349 0.231 0.175 0.104
2024-10-15 03:15:49,792 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:10, time: 1.750, data_time: 0.074, memory: 18833, stage0_loss_instance_mil: 0.0125, stage0_bag_acc: 99.1553, stage0_mean_ious: 0.5475, stage0_s: 0.0000, stage0_m: 0.0993, stage0_l: 0.3771, stage0_h: 0.5645, stage1_loss_instance_mil: 0.0835, stage1_bag_acc: 99.2753, stage1_neg_loss: 0.0372, stage1_mean_ious: 0.5111, stage1_s: 0.0000, stage1_m: 0.0923, stage1_l: 0.3586, stage1_h: 0.5268, loss: 0.1331, grad_norm: 6.6376
2024-10-15 03:17:17,702 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:08, time: 1.758, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.0278, stage0_mean_ious: 0.5209, stage0_s: 0.0000, stage0_m: 0.0609, stage0_l: 0.2973, stage0_h: 0.5438, stage1_loss_instance_mil: 0.0684, stage1_bag_acc: 99.2822, stage1_neg_loss: 0.0354, stage1_mean_ious: 0.4876, stage1_s: 0.0000, stage1_m: 0.0626, stage1_l: 0.3102, stage1_h: 0.5012, loss: 0.1147, grad_norm: 5.5184
2024-10-15 03:18:43,699 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:23:04, time: 1.720, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0098, stage0_bag_acc: 99.1863, stage0_mean_ious: 0.5649, stage0_s: 0.0000, stage0_m: 0.0761, stage0_l: 0.2866, stage0_h: 0.5917, stage1_loss_instance_mil: 0.0778, stage1_bag_acc: 99.3606, stage1_neg_loss: 0.0356, stage1_mean_ious: 0.5253, stage1_s: 0.0000, stage1_m: 0.0808, stage1_l: 0.2854, stage1_h: 0.5475, loss: 0.1232, grad_norm: 6.1761
2024-10-15 03:19:34,721 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 03:21:06,358 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:45, time: 1.787, data_time: 0.082, memory: 18833, stage0_loss_instance_mil: 0.0063, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.5462, stage0_s: 0.0000, stage0_m: 0.1344, stage0_l: 0.3051, stage0_h: 0.5671, stage1_loss_instance_mil: 0.0729, stage1_bag_acc: 99.0221, stage1_neg_loss: 0.0356, stage1_mean_ious: 0.5116, stage1_s: 0.0000, stage1_m: 0.1508, stage1_l: 0.3016, stage1_h: 0.5269, loss: 0.1148, grad_norm: 6.8231
2024-10-15 03:22:31,637 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:39, time: 1.706, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0093, stage0_bag_acc: 99.5718, stage0_mean_ious: 0.5335, stage0_s: 0.0000, stage0_m: 0.0263, stage0_l: 0.2761, stage0_h: 0.5627, stage1_loss_instance_mil: 0.0745, stage1_bag_acc: 99.7147, stage1_neg_loss: 0.0323, stage1_mean_ious: 0.5059, stage1_s: 0.0000, stage1_m: 0.0285, stage1_l: 0.2818, stage1_h: 0.5311, loss: 0.1161, grad_norm: 6.1887
2024-10-15 03:23:58,022 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:32, time: 1.728, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0032, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5445, stage0_s: 0.0000, stage0_m: 0.0689, stage0_l: 0.3029, stage0_h: 0.5729, stage1_loss_instance_mil: 0.0737, stage1_bag_acc: 99.7867, stage1_neg_loss: 0.0329, stage1_mean_ious: 0.5102, stage1_s: 0.0000, stage1_m: 0.0750, stage1_l: 0.2858, stage1_h: 0.5359, loss: 0.1098, grad_norm: 4.9386
2024-10-15 03:24:50,335 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 03:26:22,250 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:20, time: 1.793, data_time: 0.082, memory: 18833, stage0_loss_instance_mil: 0.0082, stage0_bag_acc: 99.6517, stage0_mean_ious: 0.5382, stage0_s: 0.0000, stage0_m: 0.0457, stage0_l: 0.3743, stage0_h: 0.5575, stage1_loss_instance_mil: 0.0694, stage1_bag_acc: 99.9167, stage1_neg_loss: 0.0341, stage1_mean_ious: 0.5109, stage1_s: 0.0000, stage1_m: 0.0517, stage1_l: 0.3773, stage1_h: 0.5238, loss: 0.1117, grad_norm: 4.8880
2024-10-15 03:27:50,084 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:13, time: 1.757, data_time: 0.033, memory: 18833, stage0_loss_instance_mil: 0.0058, stage0_bag_acc: 99.7130, stage0_mean_ious: 0.5123, stage0_s: 0.0000, stage0_m: 0.0856, stage0_l: 0.3100, stage0_h: 0.5468, stage1_loss_instance_mil: 0.0676, stage1_bag_acc: 99.4901, stage1_neg_loss: 0.0297, stage1_mean_ious: 0.4828, stage1_s: 0.0000, stage1_m: 0.0972, stage1_l: 0.3152, stage1_h: 0.5094, loss: 0.1032, grad_norm: 4.8313
2024-10-15 03:29:18,052 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:04, time: 1.759, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.5411, stage0_s: 0.0000, stage0_m: 0.0641, stage0_l: 0.2948, stage0_h: 0.5671, stage1_loss_instance_mil: 0.0603, stage1_bag_acc: 99.6836, stage1_neg_loss: 0.0321, stage1_mean_ious: 0.5061, stage1_s: 0.0000, stage1_m: 0.0670, stage1_l: 0.2862, stage1_h: 0.5259, loss: 0.0952, grad_norm: 4.3170
2024-10-15 03:30:10,706 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 03:31:42,807 - mmdet - INFO - Evaluating bbox...
2024-10-15 03:31:43,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2510
2024-10-15 03:31:43,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5650
2024-10-15 03:31:43,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4174
2024-10-15 03:31:43,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2687
2024-10-15 03:31:43,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1965
2024-10-15 03:31:43,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1247
2024-10-15 03:31:43,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0340
2024-10-15 03:31:43,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2686
2024-10-15 03:31:43,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2300
2024-10-15 03:31:43,703 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3084
2024-10-15 03:31:43,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3412
2024-10-15 03:31:43,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6516
2024-10-15 03:31:43,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3412
2024-10-15 03:31:43,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3412
2024-10-15 03:31:43,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3631
2024-10-15 03:31:43,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3135
2024-10-15 03:31:43,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3414
2024-10-15 03:31:43,717 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 03:31:43,717 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 90, bbox_mAP: 0.2510, bbox_mAP_50: 0.5650, bbox_mAP_75: 0.4170, bbox_mAP_s: 0.2690, bbox_mAP_m: 0.1960, bbox_mAP_l: 0.1250, bbox_mAP_copypaste: 0.251 0.565 0.417 0.269 0.196 0.125
2024-10-15 03:33:14,236 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:58, time: 1.810, data_time: 0.082, memory: 18833, stage0_loss_instance_mil: 0.0022, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5553, stage0_s: 0.0000, stage0_m: 0.0822, stage0_l: 0.3490, stage0_h: 0.5841, stage1_loss_instance_mil: 0.0511, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0259, stage1_mean_ious: 0.5272, stage1_s: 0.0000, stage1_m: 0.0864, stage1_l: 0.3421, stage1_h: 0.5516, loss: 0.0792, grad_norm: 3.2315
2024-10-15 03:34:40,463 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:48, time: 1.725, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0017, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5276, stage0_s: 0.0000, stage0_m: 0.0491, stage0_l: 0.2892, stage0_h: 0.5583, stage1_loss_instance_mil: 0.0568, stage1_bag_acc: 99.8038, stage1_neg_loss: 0.0336, stage1_mean_ious: 0.4985, stage1_s: 0.0000, stage1_m: 0.0593, stage1_l: 0.2976, stage1_h: 0.5226, loss: 0.0922, grad_norm: 4.5134
2024-10-15 03:36:07,869 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:37, time: 1.748, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0014, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5540, stage0_s: 0.0000, stage0_m: 0.0464, stage0_l: 0.3081, stage0_h: 0.5833, stage1_loss_instance_mil: 0.0589, stage1_bag_acc: 99.6841, stage1_neg_loss: 0.0269, stage1_mean_ious: 0.5147, stage1_s: 0.0000, stage1_m: 0.0474, stage1_l: 0.3138, stage1_h: 0.5364, loss: 0.0872, grad_norm: 4.1811
2024-10-15 03:37:00,526 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 03:38:31,454 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:34, time: 1.774, data_time: 0.079, memory: 18833, stage0_loss_instance_mil: 0.0018, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.5417, stage0_s: 0.0000, stage0_m: 0.0745, stage0_l: 0.3228, stage0_h: 0.5771, stage1_loss_instance_mil: 0.0566, stage1_bag_acc: 99.7836, stage1_neg_loss: 0.0314, stage1_mean_ious: 0.5039, stage1_s: 0.0000, stage1_m: 0.0805, stage1_l: 0.3289, stage1_h: 0.5321, loss: 0.0898, grad_norm: 4.3728
2024-10-15 03:39:58,551 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:22, time: 1.742, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.7778, stage0_mean_ious: 0.5378, stage0_s: 0.0000, stage0_m: 0.0468, stage0_l: 0.2963, stage0_h: 0.5654, stage1_loss_instance_mil: 0.0542, stage1_bag_acc: 99.7009, stage1_neg_loss: 0.0256, stage1_mean_ious: 0.5037, stage1_s: 0.0000, stage1_m: 0.0517, stage1_l: 0.2928, stage1_h: 0.5268, loss: 0.0858, grad_norm: 3.5772
2024-10-15 03:41:23,269 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:10, time: 1.694, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0019, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5686, stage0_s: 0.0000, stage0_m: 0.0699, stage0_l: 0.3376, stage0_h: 0.5962, stage1_loss_instance_mil: 0.0456, stage1_bag_acc: 99.7571, stage1_neg_loss: 0.0235, stage1_mean_ious: 0.5365, stage1_s: 0.0000, stage1_m: 0.0825, stage1_l: 0.3333, stage1_h: 0.5577, loss: 0.0710, grad_norm: 3.4577
2024-10-15 03:42:15,076 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 03:43:44,831 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:10, time: 1.739, data_time: 0.079, memory: 18833, stage0_loss_instance_mil: 0.0015, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.5509, stage0_s: 0.0000, stage0_m: 0.0578, stage0_l: 0.2666, stage0_h: 0.5847, stage1_loss_instance_mil: 0.0488, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0300, stage1_mean_ious: 0.5119, stage1_s: 0.0000, stage1_m: 0.0667, stage1_l: 0.2714, stage1_h: 0.5389, loss: 0.0803, grad_norm: 3.9409
2024-10-15 03:45:10,571 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:57, time: 1.715, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0019, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.5317, stage0_s: 0.0000, stage0_m: 0.0640, stage0_l: 0.3047, stage0_h: 0.5547, stage1_loss_instance_mil: 0.0533, stage1_bag_acc: 99.7980, stage1_neg_loss: 0.0275, stage1_mean_ious: 0.4945, stage1_s: 0.0000, stage1_m: 0.0769, stage1_l: 0.3015, stage1_h: 0.5124, loss: 0.0827, grad_norm: 3.5108
2024-10-15 03:46:36,106 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.711, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0025, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.5528, stage0_s: 0.0000, stage0_m: 0.0938, stage0_l: 0.3432, stage0_h: 0.5807, stage1_loss_instance_mil: 0.0532, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0280, stage1_mean_ious: 0.5222, stage1_s: 0.0000, stage1_m: 0.1000, stage1_l: 0.3396, stage1_h: 0.5444, loss: 0.0837, grad_norm: 3.8040
2024-10-15 03:47:28,535 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 03:49:00,692 - mmdet - INFO - Evaluating bbox...
2024-10-15 03:49:01,546 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2531
2024-10-15 03:49:01,546 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5693
2024-10-15 03:49:01,546 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4285
2024-10-15 03:49:01,546 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2623
2024-10-15 03:49:01,546 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1919
2024-10-15 03:49:01,547 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1215
2024-10-15 03:49:01,547 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0352
2024-10-15 03:49:01,547 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2671
2024-10-15 03:49:01,547 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2399
2024-10-15 03:49:01,547 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3115
2024-10-15 03:49:01,547 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3439
2024-10-15 03:49:01,547 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6559
2024-10-15 03:49:01,547 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3439
2024-10-15 03:49:01,547 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3439
2024-10-15 03:49:01,547 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3589
2024-10-15 03:49:01,548 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3214
2024-10-15 03:49:01,548 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3456
2024-10-15 03:49:01,564 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 03:49:01,564 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.2530, bbox_mAP_50: 0.5690, bbox_mAP_75: 0.4290, bbox_mAP_s: 0.2620, bbox_mAP_m: 0.1920, bbox_mAP_l: 0.1220, bbox_mAP_copypaste: 0.253 0.569 0.429 0.262 0.192 0.122
2024-10-15 03:50:31,466 - mmdet - INFO - Evaluating bbox...
2024-10-15 03:50:32,312 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2531
2024-10-15 03:50:32,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5693
2024-10-15 03:50:32,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4285
2024-10-15 03:50:32,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2623
2024-10-15 03:50:32,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1919
2024-10-15 03:50:32,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1215
2024-10-15 03:50:32,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0352
2024-10-15 03:50:32,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2671
2024-10-15 03:50:32,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2399
2024-10-15 03:50:32,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3115
2024-10-15 03:50:32,313 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3439
2024-10-15 03:50:32,314 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6559
2024-10-15 03:50:32,314 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3439
2024-10-15 03:50:32,314 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3439
2024-10-15 03:50:32,314 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3589
2024-10-15 03:50:32,314 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3214
2024-10-15 03:50:32,314 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3456
2024-10-15 03:50:33,668 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+bc04488
------------------------------------------------------------

2024-10-15 03:50:34,578 - mmdet - INFO - Distributed training: False
2024-10-15 03:50:35,456 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 03:50:36,410 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 03:50:36,410 - mmdet - INFO - Use load_from_local loader
2024-10-15 03:50:36,643 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 03:50:36,653 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 03:50:36,653 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 03:52:04,031 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:01:27, time: 1.747, data_time: 0.078, memory: 18833, stage0_loss_instance_mil: 0.6982, stage0_bag_acc: 28.1531, stage0_mean_ious: 0.3693, stage0_s: 0.0000, stage0_m: 0.0826, stage0_l: 0.2546, stage0_h: 0.3834, stage1_loss_instance_mil: 0.1759, stage1_bag_acc: 17.9605, stage1_neg_loss: 0.0011, stage1_mean_ious: 0.3725, stage1_s: 0.0000, stage1_m: 0.0880, stage1_l: 0.2787, stage1_h: 0.3821, loss: 0.8752, grad_norm: 3.2171
2024-10-15 03:53:30,345 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:37, time: 1.726, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.5584, stage0_bag_acc: 58.3812, stage0_mean_ious: 0.4572, stage0_s: 0.0000, stage0_m: 0.0644, stage0_l: 0.3204, stage0_h: 0.4694, stage1_loss_instance_mil: 0.2369, stage1_bag_acc: 42.8560, stage1_neg_loss: 0.0122, stage1_mean_ious: 0.4456, stage1_s: 0.0000, stage1_m: 0.0674, stage1_l: 0.3362, stage1_h: 0.4529, loss: 0.8074, grad_norm: 4.8330
2024-10-15 03:54:56,596 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:58:03, time: 1.725, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.2422, stage0_bag_acc: 94.0181, stage0_mean_ious: 0.4630, stage0_s: 0.0000, stage0_m: 0.1087, stage0_l: 0.2919, stage0_h: 0.4760, stage1_loss_instance_mil: 0.3272, stage1_bag_acc: 84.7703, stage1_neg_loss: 0.0652, stage1_mean_ious: 0.4412, stage1_s: 0.0000, stage1_m: 0.1201, stage1_l: 0.2833, stage1_h: 0.4519, loss: 0.6346, grad_norm: 10.5069
2024-10-15 03:55:48,770 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 03:57:19,761 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:45, time: 1.774, data_time: 0.080, memory: 18833, stage0_loss_instance_mil: 0.0844, stage0_bag_acc: 95.5210, stage0_mean_ious: 0.4248, stage0_s: 0.0000, stage0_m: 0.0622, stage0_l: 0.2492, stage0_h: 0.4428, stage1_loss_instance_mil: 0.3135, stage1_bag_acc: 96.2804, stage1_neg_loss: 0.0840, stage1_mean_ious: 0.3977, stage1_s: 0.0000, stage1_m: 0.0668, stage1_l: 0.2369, stage1_h: 0.4137, loss: 0.4819, grad_norm: 13.7495
2024-10-15 03:58:47,995 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:53, time: 1.765, data_time: 0.033, memory: 18833, stage0_loss_instance_mil: 0.0443, stage0_bag_acc: 98.0207, stage0_mean_ious: 0.4371, stage0_s: 0.0000, stage0_m: 0.0758, stage0_l: 0.2103, stage0_h: 0.4631, stage1_loss_instance_mil: 0.2813, stage1_bag_acc: 99.0226, stage1_neg_loss: 0.0770, stage1_mean_ious: 0.4135, stage1_s: 0.0000, stage1_m: 0.0877, stage1_l: 0.2122, stage1_h: 0.4357, loss: 0.4026, grad_norm: 12.9880
2024-10-15 04:00:11,082 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:48:03, time: 1.662, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0570, stage0_bag_acc: 96.8956, stage0_mean_ious: 0.4236, stage0_s: 0.0067, stage0_m: 0.0221, stage0_l: 0.1693, stage0_h: 0.4532, stage1_loss_instance_mil: 0.3002, stage1_bag_acc: 98.5740, stage1_neg_loss: 0.0809, stage1_mean_ious: 0.3882, stage1_s: 0.0094, stage1_m: 0.0220, stage1_l: 0.1545, stage1_h: 0.4151, loss: 0.4381, grad_norm: 14.6342
2024-10-15 04:01:02,907 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 04:02:32,505 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:43:12, time: 1.746, data_time: 0.080, memory: 18833, stage0_loss_instance_mil: 0.0466, stage0_bag_acc: 97.1352, stage0_mean_ious: 0.4488, stage0_s: 0.0000, stage0_m: 0.0695, stage0_l: 0.1786, stage0_h: 0.4864, stage1_loss_instance_mil: 0.2509, stage1_bag_acc: 98.3213, stage1_neg_loss: 0.0854, stage1_mean_ious: 0.4147, stage1_s: 0.0000, stage1_m: 0.0723, stage1_l: 0.1747, stage1_h: 0.4461, loss: 0.3829, grad_norm: 19.2971
2024-10-15 04:03:59,674 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:46, time: 1.743, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0478, stage0_bag_acc: 96.9517, stage0_mean_ious: 0.5186, stage0_s: 0.0000, stage0_m: 0.0776, stage0_l: 0.1784, stage0_h: 0.5557, stage1_loss_instance_mil: 0.2329, stage1_bag_acc: 97.6090, stage1_neg_loss: 0.0986, stage1_mean_ious: 0.4852, stage1_s: 0.0000, stage1_m: 0.0842, stage1_l: 0.1784, stage1_h: 0.5176, loss: 0.3793, grad_norm: 19.5609
2024-10-15 04:05:25,625 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:42:04, time: 1.719, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0306, stage0_bag_acc: 98.2952, stage0_mean_ious: 0.5433, stage0_s: 0.0000, stage0_m: 0.0748, stage0_l: 0.2215, stage0_h: 0.5871, stage1_loss_instance_mil: 0.2126, stage1_bag_acc: 99.1085, stage1_neg_loss: 0.0831, stage1_mean_ious: 0.5040, stage1_s: 0.0000, stage1_m: 0.0749, stage1_l: 0.2285, stage1_h: 0.5406, loss: 0.3264, grad_norm: 16.7818
2024-10-15 04:06:18,019 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 04:07:50,013 - mmdet - INFO - Evaluating bbox...
2024-10-15 04:07:50,843 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1278
2024-10-15 04:07:50,843 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4126
2024-10-15 04:07:50,843 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2248
2024-10-15 04:07:50,843 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0902
2024-10-15 04:07:50,843 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0497
2024-10-15 04:07:50,844 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0225
2024-10-15 04:07:50,844 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0008
2024-10-15 04:07:50,844 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1219
2024-10-15 04:07:50,844 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1535
2024-10-15 04:07:50,844 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1967
2024-10-15 04:07:50,844 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2329
2024-10-15 04:07:50,844 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.5770
2024-10-15 04:07:50,844 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2329
2024-10-15 04:07:50,845 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2329
2024-10-15 04:07:50,845 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1621
2024-10-15 04:07:50,845 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2651
2024-10-15 04:07:50,845 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2566
2024-10-15 04:07:50,857 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 04:07:50,857 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 90, bbox_mAP: 0.1280, bbox_mAP_50: 0.4130, bbox_mAP_75: 0.2250, bbox_mAP_s: 0.0900, bbox_mAP_m: 0.0500, bbox_mAP_l: 0.0220, bbox_mAP_copypaste: 0.128 0.413 0.225 0.090 0.050 0.022
2024-10-15 04:09:19,537 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:32, time: 1.773, data_time: 0.078, memory: 18833, stage0_loss_instance_mil: 0.0187, stage0_bag_acc: 98.7047, stage0_mean_ious: 0.5841, stage0_s: 0.0000, stage0_m: 0.0565, stage0_l: 0.2337, stage0_h: 0.6305, stage1_loss_instance_mil: 0.1377, stage1_bag_acc: 99.1649, stage1_neg_loss: 0.0522, stage1_mean_ious: 0.5431, stage1_s: 0.0000, stage1_m: 0.0577, stage1_l: 0.2440, stage1_h: 0.5817, loss: 0.2086, grad_norm: 9.1619
2024-10-15 04:10:47,752 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:53, time: 1.764, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0207, stage0_bag_acc: 99.0032, stage0_mean_ious: 0.5891, stage0_s: 0.0000, stage0_m: 0.0862, stage0_l: 0.2733, stage0_h: 0.6308, stage1_loss_instance_mil: 0.1195, stage1_bag_acc: 99.1519, stage1_neg_loss: 0.0517, stage1_mean_ious: 0.5569, stage1_s: 0.0000, stage1_m: 0.0953, stage1_l: 0.2709, stage1_h: 0.5921, loss: 0.1919, grad_norm: 11.4504
2024-10-15 04:12:09,845 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:54, time: 1.642, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0150, stage0_bag_acc: 99.2841, stage0_mean_ious: 0.6194, stage0_s: 0.0000, stage0_m: 0.0761, stage0_l: 0.3742, stage0_h: 0.6585, stage1_loss_instance_mil: 0.1188, stage1_bag_acc: 99.3610, stage1_neg_loss: 0.0579, stage1_mean_ious: 0.5817, stage1_s: 0.0000, stage1_m: 0.0876, stage1_l: 0.3879, stage1_h: 0.6090, loss: 0.1917, grad_norm: 14.7129
2024-10-15 04:13:01,329 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 04:14:31,514 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:54, time: 1.759, data_time: 0.076, memory: 18833, stage0_loss_instance_mil: 0.0105, stage0_bag_acc: 99.5481, stage0_mean_ious: 0.6112, stage0_s: 0.0000, stage0_m: 0.1140, stage0_l: 0.3394, stage0_h: 0.6415, stage1_loss_instance_mil: 0.1116, stage1_bag_acc: 99.5170, stage1_neg_loss: 0.0514, stage1_mean_ious: 0.5773, stage1_s: 0.0000, stage1_m: 0.1200, stage1_l: 0.3477, stage1_h: 0.5994, loss: 0.1735, grad_norm: 13.0659
2024-10-15 04:15:55,672 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:59, time: 1.683, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0084, stage0_bag_acc: 99.7395, stage0_mean_ious: 0.6585, stage0_s: 0.0000, stage0_m: 0.0564, stage0_l: 0.3631, stage0_h: 0.6910, stage1_loss_instance_mil: 0.0966, stage1_bag_acc: 99.3857, stage1_neg_loss: 0.0413, stage1_mean_ious: 0.6264, stage1_s: 0.0000, stage1_m: 0.0631, stage1_l: 0.3706, stage1_h: 0.6526, loss: 0.1464, grad_norm: 9.1413
2024-10-15 04:17:24,396 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:07, time: 1.774, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0226, stage0_bag_acc: 98.2718, stage0_mean_ious: 0.6871, stage0_s: 0.0000, stage0_m: 0.0653, stage0_l: 0.4176, stage0_h: 0.7129, stage1_loss_instance_mil: 0.0866, stage1_bag_acc: 99.0474, stage1_neg_loss: 0.0416, stage1_mean_ious: 0.6387, stage1_s: 0.0000, stage1_m: 0.0704, stage1_l: 0.4145, stage1_h: 0.6582, loss: 0.1509, grad_norm: 10.3908
2024-10-15 04:18:15,784 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 04:19:48,480 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:31, time: 1.810, data_time: 0.078, memory: 18833, stage0_loss_instance_mil: 0.0079, stage0_bag_acc: 99.6924, stage0_mean_ious: 0.6573, stage0_s: 0.0000, stage0_m: 0.0963, stage0_l: 0.3674, stage0_h: 0.6907, stage1_loss_instance_mil: 0.0827, stage1_bag_acc: 99.7146, stage1_neg_loss: 0.0403, stage1_mean_ious: 0.6245, stage1_s: 0.0000, stage1_m: 0.1086, stage1_l: 0.3786, stage1_h: 0.6493, loss: 0.1309, grad_norm: 8.6214
2024-10-15 04:21:12,894 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 04:21:12,894 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:31, time: 1.688, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0096, stage0_bag_acc: 99.3624, stage0_mean_ious: 0.6377, stage0_s: 0.0000, stage0_m: 0.0742, stage0_l: 0.3340, stage0_h: 0.6627, stage1_loss_instance_mil: 0.0851, stage1_bag_acc: 99.5955, stage1_neg_loss: 0.0432, stage1_mean_ious: 0.5946, stage1_s: 0.0000, stage1_m: 0.0796, stage1_l: 0.3383, stage1_h: 0.6124, loss: 0.1378, grad_norm: 13.0252
2024-10-15 04:22:37,925 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:29, time: 1.701, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0063, stage0_bag_acc: 99.6873, stage0_mean_ious: 0.6305, stage0_s: 0.0000, stage0_m: 0.0858, stage0_l: 0.3760, stage0_h: 0.6620, stage1_loss_instance_mil: 0.0845, stage1_bag_acc: 99.6588, stage1_neg_loss: 0.0395, stage1_mean_ious: 0.5914, stage1_s: 0.0000, stage1_m: 0.0939, stage1_l: 0.3943, stage1_h: 0.6128, loss: 0.1303, grad_norm: 7.7751
2024-10-15 04:23:30,267 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 04:24:59,763 - mmdet - INFO - Evaluating bbox...
2024-10-15 04:25:00,646 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2453
2024-10-15 04:25:00,646 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5338
2024-10-15 04:25:00,646 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4075
2024-10-15 04:25:00,646 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2666
2024-10-15 04:25:00,647 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2022
2024-10-15 04:25:00,647 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1296
2024-10-15 04:25:00,647 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0315
2024-10-15 04:25:00,647 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2294
2024-10-15 04:25:00,647 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2325
2024-10-15 04:25:00,647 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3303
2024-10-15 04:25:00,647 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3474
2024-10-15 04:25:00,647 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6598
2024-10-15 04:25:00,647 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3474
2024-10-15 04:25:00,647 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3474
2024-10-15 04:25:00,647 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2862
2024-10-15 04:25:00,648 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3126
2024-10-15 04:25:00,648 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3924
2024-10-15 04:25:00,661 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 04:25:00,661 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.2450, bbox_mAP_50: 0.5340, bbox_mAP_75: 0.4080, bbox_mAP_s: 0.2670, bbox_mAP_m: 0.2020, bbox_mAP_l: 0.1300, bbox_mAP_copypaste: 0.245 0.534 0.408 0.267 0.202 0.130
2024-10-15 04:26:27,005 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:00, time: 1.726, data_time: 0.081, memory: 18833, stage0_loss_instance_mil: 0.0065, stage0_bag_acc: 99.7321, stage0_mean_ious: 0.6548, stage0_s: 0.0000, stage0_m: 0.0454, stage0_l: 0.3549, stage0_h: 0.6854, stage1_loss_instance_mil: 0.0738, stage1_bag_acc: 99.7109, stage1_neg_loss: 0.0385, stage1_mean_ious: 0.6078, stage1_s: 0.0000, stage1_m: 0.0523, stage1_l: 0.3605, stage1_h: 0.6295, loss: 0.1188, grad_norm: 9.1208
2024-10-15 04:27:53,238 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:58, time: 1.725, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0112, stage0_bag_acc: 99.0541, stage0_mean_ious: 0.6472, stage0_s: 0.0000, stage0_m: 0.0556, stage0_l: 0.3516, stage0_h: 0.6645, stage1_loss_instance_mil: 0.0851, stage1_bag_acc: 99.3851, stage1_neg_loss: 0.0405, stage1_mean_ious: 0.6026, stage1_s: 0.0000, stage1_m: 0.0632, stage1_l: 0.3439, stage1_h: 0.6148, loss: 0.1368, grad_norm: 11.1600
2024-10-15 04:29:19,983 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:55, time: 1.735, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0124, stage0_bag_acc: 99.0816, stage0_mean_ious: 0.6447, stage0_s: 0.0000, stage0_m: 0.1009, stage0_l: 0.4048, stage0_h: 0.6709, stage1_loss_instance_mil: 0.0676, stage1_bag_acc: 99.2450, stage1_neg_loss: 0.0328, stage1_mean_ious: 0.6061, stage1_s: 0.0000, stage1_m: 0.1049, stage1_l: 0.4153, stage1_h: 0.6233, loss: 0.1127, grad_norm: 6.1031
2024-10-15 04:30:12,673 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 04:31:45,587 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:39, time: 1.814, data_time: 0.082, memory: 18833, stage0_loss_instance_mil: 0.0062, stage0_bag_acc: 99.7395, stage0_mean_ious: 0.6387, stage0_s: 0.0000, stage0_m: 0.1187, stage0_l: 0.3184, stage0_h: 0.6644, stage1_loss_instance_mil: 0.0686, stage1_bag_acc: 99.6938, stage1_neg_loss: 0.0383, stage1_mean_ious: 0.6034, stage1_s: 0.0000, stage1_m: 0.1223, stage1_l: 0.3306, stage1_h: 0.6215, loss: 0.1131, grad_norm: 7.6813
2024-10-15 04:33:13,003 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:35, time: 1.748, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0037, stage0_bag_acc: 99.9412, stage0_mean_ious: 0.6397, stage0_s: 0.0000, stage0_m: 0.0465, stage0_l: 0.3707, stage0_h: 0.6685, stage1_loss_instance_mil: 0.0707, stage1_bag_acc: 99.9412, stage1_neg_loss: 0.0276, stage1_mean_ious: 0.6015, stage1_s: 0.0000, stage1_m: 0.0450, stage1_l: 0.3818, stage1_h: 0.6222, loss: 0.1020, grad_norm: 6.2025
2024-10-15 04:34:39,615 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:28, time: 1.732, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0101, stage0_bag_acc: 99.5666, stage0_mean_ious: 0.6317, stage0_s: 0.0000, stage0_m: 0.0623, stage0_l: 0.3715, stage0_h: 0.6606, stage1_loss_instance_mil: 0.0766, stage1_bag_acc: 99.5666, stage1_neg_loss: 0.0379, stage1_mean_ious: 0.5896, stage1_s: 0.0000, stage1_m: 0.0680, stage1_l: 0.3859, stage1_h: 0.6085, loss: 0.1246, grad_norm: 8.8286
2024-10-15 04:35:32,498 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 04:37:03,559 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:17, time: 1.773, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.0068, stage0_bag_acc: 99.5956, stage0_mean_ious: 0.6622, stage0_s: 0.0000, stage0_m: 0.0864, stage0_l: 0.4431, stage0_h: 0.6765, stage1_loss_instance_mil: 0.0580, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0312, stage1_mean_ious: 0.6206, stage1_s: 0.0000, stage1_m: 0.0805, stage1_l: 0.4388, stage1_h: 0.6306, loss: 0.0960, grad_norm: 8.3106
2024-10-15 04:38:29,556 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:09, time: 1.720, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0069, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.6468, stage0_s: 0.0078, stage0_m: 0.1153, stage0_l: 0.4310, stage0_h: 0.6747, stage1_loss_instance_mil: 0.0495, stage1_bag_acc: 99.7395, stage1_neg_loss: 0.0263, stage1_mean_ious: 0.6054, stage1_s: 0.0095, stage1_m: 0.1226, stage1_l: 0.4259, stage1_h: 0.6262, loss: 0.0827, grad_norm: 4.8403
2024-10-15 04:39:54,447 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:00, time: 1.698, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0024, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.6543, stage0_s: 0.0000, stage0_m: 0.1333, stage0_l: 0.4162, stage0_h: 0.6846, stage1_loss_instance_mil: 0.0493, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0307, stage1_mean_ious: 0.6125, stage1_s: 0.0000, stage1_m: 0.1364, stage1_l: 0.4206, stage1_h: 0.6354, loss: 0.0823, grad_norm: 4.6050
2024-10-15 04:40:45,774 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 04:42:15,836 - mmdet - INFO - Evaluating bbox...
2024-10-15 04:42:16,718 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2616
2024-10-15 04:42:16,719 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5503
2024-10-15 04:42:16,719 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4277
2024-10-15 04:42:16,719 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2950
2024-10-15 04:42:16,719 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2290
2024-10-15 04:42:16,719 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1463
2024-10-15 04:42:16,719 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0334
2024-10-15 04:42:16,719 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2440
2024-10-15 04:42:16,720 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2557
2024-10-15 04:42:16,720 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3434
2024-10-15 04:42:16,720 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3666
2024-10-15 04:42:16,720 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6750
2024-10-15 04:42:16,720 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3666
2024-10-15 04:42:16,720 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3666
2024-10-15 04:42:16,720 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3115
2024-10-15 04:42:16,720 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3361
2024-10-15 04:42:16,720 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4094
2024-10-15 04:42:16,736 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 04:42:16,736 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 90, bbox_mAP: 0.2620, bbox_mAP_50: 0.5500, bbox_mAP_75: 0.4280, bbox_mAP_s: 0.2950, bbox_mAP_m: 0.2290, bbox_mAP_l: 0.1460, bbox_mAP_copypaste: 0.262 0.550 0.428 0.295 0.229 0.146
2024-10-15 04:43:43,007 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:52, time: 1.725, data_time: 0.078, memory: 18833, stage0_loss_instance_mil: 0.0024, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.6316, stage0_s: 0.0000, stage0_m: 0.0871, stage0_l: 0.4248, stage0_h: 0.6692, stage1_loss_instance_mil: 0.0479, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0278, stage1_mean_ious: 0.5886, stage1_s: 0.0000, stage1_m: 0.0945, stage1_l: 0.4282, stage1_h: 0.6162, loss: 0.0781, grad_norm: 4.4830
2024-10-15 04:45:09,294 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:43, time: 1.726, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0057, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.6573, stage0_s: 0.0000, stage0_m: 0.0921, stage0_l: 0.4192, stage0_h: 0.6816, stage1_loss_instance_mil: 0.0412, stage1_bag_acc: 99.7995, stage1_neg_loss: 0.0240, stage1_mean_ious: 0.6126, stage1_s: 0.0000, stage1_m: 0.0977, stage1_l: 0.4124, stage1_h: 0.6299, loss: 0.0709, grad_norm: 4.3042
2024-10-15 04:46:34,242 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:33, time: 1.699, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0038, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.6606, stage0_s: 0.0000, stage0_m: 0.1091, stage0_l: 0.4076, stage0_h: 0.6911, stage1_loss_instance_mil: 0.0471, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0278, stage1_mean_ious: 0.6159, stage1_s: 0.0000, stage1_m: 0.1085, stage1_l: 0.4160, stage1_h: 0.6374, loss: 0.0787, grad_norm: 5.0396
2024-10-15 04:47:26,972 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 04:48:55,992 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:30, time: 1.736, data_time: 0.079, memory: 18833, stage0_loss_instance_mil: 0.0047, stage0_bag_acc: 99.8114, stage0_mean_ious: 0.6478, stage0_s: 0.0000, stage0_m: 0.0905, stage0_l: 0.4262, stage0_h: 0.6765, stage1_loss_instance_mil: 0.0466, stage1_bag_acc: 99.9167, stage1_neg_loss: 0.0246, stage1_mean_ious: 0.6140, stage1_s: 0.0000, stage1_m: 0.1022, stage1_l: 0.4302, stage1_h: 0.6349, loss: 0.0760, grad_norm: 5.5653
2024-10-15 04:50:24,216 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:19, time: 1.764, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0042, stage0_bag_acc: 99.8038, stage0_mean_ious: 0.6581, stage0_s: 0.0000, stage0_m: 0.0766, stage0_l: 0.3655, stage0_h: 0.6798, stage1_loss_instance_mil: 0.0408, stage1_bag_acc: 99.8182, stage1_neg_loss: 0.0229, stage1_mean_ious: 0.6202, stage1_s: 0.0000, stage1_m: 0.0764, stage1_l: 0.3810, stage1_h: 0.6355, loss: 0.0679, grad_norm: 4.0816
2024-10-15 04:51:50,304 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:08, time: 1.722, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0034, stage0_bag_acc: 99.8333, stage0_mean_ious: 0.6614, stage0_s: 0.0000, stage0_m: 0.0927, stage0_l: 0.4612, stage0_h: 0.6806, stage1_loss_instance_mil: 0.0467, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0224, stage1_mean_ious: 0.6204, stage1_s: 0.0000, stage1_m: 0.1048, stage1_l: 0.4593, stage1_h: 0.6341, loss: 0.0725, grad_norm: 5.1051
2024-10-15 04:52:41,869 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 04:54:12,868 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:08, time: 1.775, data_time: 0.080, memory: 18833, stage0_loss_instance_mil: 0.0062, stage0_bag_acc: 99.7639, stage0_mean_ious: 0.6696, stage0_s: 0.0000, stage0_m: 0.0712, stage0_l: 0.4124, stage0_h: 0.6965, stage1_loss_instance_mil: 0.0473, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0179, stage1_mean_ious: 0.6209, stage1_s: 0.0000, stage1_m: 0.0716, stage1_l: 0.4033, stage1_h: 0.6406, loss: 0.0714, grad_norm: 4.1801
2024-10-15 04:55:38,921 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:56, time: 1.721, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.0010, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.6308, stage0_s: 0.0000, stage0_m: 0.1634, stage0_l: 0.4378, stage0_h: 0.6514, stage1_loss_instance_mil: 0.0457, stage1_bag_acc: 99.8947, stage1_neg_loss: 0.0251, stage1_mean_ious: 0.5911, stage1_s: 0.0000, stage1_m: 0.1728, stage1_l: 0.4295, stage1_h: 0.6054, loss: 0.0719, grad_norm: 4.5761
2024-10-15 04:57:06,582 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.753, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0030, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.6705, stage0_s: 0.0000, stage0_m: 0.0751, stage0_l: 0.4538, stage0_h: 0.6958, stage1_loss_instance_mil: 0.0445, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0175, stage1_mean_ious: 0.6277, stage1_s: 0.0000, stage1_m: 0.0830, stage1_l: 0.4582, stage1_h: 0.6447, loss: 0.0650, grad_norm: 4.9485
2024-10-15 04:57:59,098 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 04:59:28,404 - mmdet - INFO - Evaluating bbox...
2024-10-15 04:59:29,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2659
2024-10-15 04:59:29,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5545
2024-10-15 04:59:29,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4349
2024-10-15 04:59:29,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.3041
2024-10-15 04:59:29,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2282
2024-10-15 04:59:29,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1482
2024-10-15 04:59:29,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0385
2024-10-15 04:59:29,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2445
2024-10-15 04:59:29,270 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2624
2024-10-15 04:59:29,270 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3455
2024-10-15 04:59:29,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3685
2024-10-15 04:59:29,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6770
2024-10-15 04:59:29,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3685
2024-10-15 04:59:29,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3685
2024-10-15 04:59:29,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3035
2024-10-15 04:59:29,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3397
2024-10-15 04:59:29,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4170
2024-10-15 04:59:29,285 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 04:59:29,286 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.2660, bbox_mAP_50: 0.5540, bbox_mAP_75: 0.4350, bbox_mAP_s: 0.3040, bbox_mAP_m: 0.2280, bbox_mAP_l: 0.1480, bbox_mAP_copypaste: 0.266 0.554 0.435 0.304 0.228 0.148
2024-10-15 05:00:59,744 - mmdet - INFO - Evaluating bbox...
2024-10-15 05:01:00,625 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2659
2024-10-15 05:01:00,625 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5545
2024-10-15 05:01:00,625 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4349
2024-10-15 05:01:00,625 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.3041
2024-10-15 05:01:00,625 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2282
2024-10-15 05:01:00,625 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1482
2024-10-15 05:01:00,625 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0385
2024-10-15 05:01:00,626 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2445
2024-10-15 05:01:00,626 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2624
2024-10-15 05:01:00,626 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3455
2024-10-15 05:01:00,626 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3685
2024-10-15 05:01:00,626 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6770
2024-10-15 05:01:00,626 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3685
2024-10-15 05:01:00,626 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3685
2024-10-15 05:01:00,626 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3035
2024-10-15 05:01:00,626 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3397
2024-10-15 05:01:00,626 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4170
2024-10-15 05:01:02,125 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+bc04488
------------------------------------------------------------

2024-10-15 05:01:03,063 - mmdet - INFO - Distributed training: False
2024-10-15 05:01:03,951 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 05:01:04,926 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 05:01:04,926 - mmdet - INFO - Use load_from_local loader
2024-10-15 05:01:05,161 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 05:01:05,172 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 05:01:05,172 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 05:02:35,076 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:03:13, time: 1.798, data_time: 0.078, memory: 18833, stage0_loss_instance_mil: 0.7031, stage0_bag_acc: 27.6927, stage0_mean_ious: 0.3318, stage0_s: 0.0000, stage0_m: 0.0554, stage0_l: 0.2578, stage0_h: 0.3380, stage1_loss_instance_mil: 0.1643, stage1_bag_acc: 15.5523, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.3318, stage1_s: 0.0000, stage1_m: 0.0615, stage1_l: 0.2815, stage1_h: 0.3331, loss: 0.8732, grad_norm: 3.2235
2024-10-15 05:04:02,298 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 1:00:48, time: 1.744, data_time: 0.029, memory: 18833, stage0_loss_instance_mil: 0.5622, stage0_bag_acc: 61.3363, stage0_mean_ious: 0.3855, stage0_s: 0.0000, stage0_m: 0.0768, stage0_l: 0.2571, stage0_h: 0.3948, stage1_loss_instance_mil: 0.2267, stage1_bag_acc: 39.2585, stage1_neg_loss: 0.0128, stage1_mean_ious: 0.3847, stage1_s: 0.0000, stage1_m: 0.0859, stage1_l: 0.2755, stage1_h: 0.3915, loss: 0.8017, grad_norm: 4.3876
2024-10-15 05:05:30,347 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:59:13, time: 1.761, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.2722, stage0_bag_acc: 85.3333, stage0_mean_ious: 0.4329, stage0_s: 0.0000, stage0_m: 0.0370, stage0_l: 0.2432, stage0_h: 0.4490, stage1_loss_instance_mil: 0.3014, stage1_bag_acc: 84.2759, stage1_neg_loss: 0.0693, stage1_mean_ious: 0.3963, stage1_s: 0.0000, stage1_m: 0.0285, stage1_l: 0.2222, stage1_h: 0.4130, loss: 0.6429, grad_norm: 8.5278
2024-10-15 05:06:23,124 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 05:07:57,411 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:49:57, time: 1.841, data_time: 0.081, memory: 18833, stage0_loss_instance_mil: 0.0810, stage0_bag_acc: 95.2069, stage0_mean_ious: 0.3901, stage0_s: 0.0000, stage0_m: 0.0577, stage0_l: 0.1640, stage0_h: 0.4167, stage1_loss_instance_mil: 0.3168, stage1_bag_acc: 96.1034, stage1_neg_loss: 0.0882, stage1_mean_ious: 0.3589, stage1_s: 0.0000, stage1_m: 0.0506, stage1_l: 0.1457, stage1_h: 0.3830, loss: 0.4859, grad_norm: 11.3721
2024-10-15 05:09:24,775 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:49:45, time: 1.747, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0616, stage0_bag_acc: 96.3583, stage0_mean_ious: 0.3828, stage0_s: 0.0086, stage0_m: 0.0316, stage0_l: 0.1703, stage0_h: 0.4059, stage1_loss_instance_mil: 0.3099, stage1_bag_acc: 97.8127, stage1_neg_loss: 0.0901, stage1_mean_ious: 0.3474, stage1_s: 0.0068, stage1_m: 0.0325, stage1_l: 0.1481, stage1_h: 0.3705, loss: 0.4617, grad_norm: 13.4499
2024-10-15 05:10:51,876 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:49:08, time: 1.742, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0555, stage0_bag_acc: 96.6074, stage0_mean_ious: 0.3922, stage0_s: 0.0000, stage0_m: 0.0321, stage0_l: 0.1643, stage0_h: 0.4219, stage1_loss_instance_mil: 0.3058, stage1_bag_acc: 97.6699, stage1_neg_loss: 0.0815, stage1_mean_ious: 0.3561, stage1_s: 0.0000, stage1_m: 0.0183, stage1_l: 0.1424, stage1_h: 0.3856, loss: 0.4428, grad_norm: 13.5968
2024-10-15 05:11:44,604 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 05:13:17,391 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:44:15, time: 1.809, data_time: 0.085, memory: 18833, stage0_loss_instance_mil: 0.0357, stage0_bag_acc: 97.6478, stage0_mean_ious: 0.3628, stage0_s: 0.0000, stage0_m: 0.0424, stage0_l: 0.1354, stage0_h: 0.3934, stage1_loss_instance_mil: 0.2787, stage1_bag_acc: 98.3144, stage1_neg_loss: 0.0893, stage1_mean_ious: 0.3262, stage1_s: 0.0000, stage1_m: 0.0295, stage1_l: 0.1130, stage1_h: 0.3560, loss: 0.4037, grad_norm: 14.7450
2024-10-15 05:14:45,631 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:43:45, time: 1.765, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0318, stage0_bag_acc: 98.6971, stage0_mean_ious: 0.3670, stage0_s: 0.0087, stage0_m: 0.0441, stage0_l: 0.1136, stage0_h: 0.3971, stage1_loss_instance_mil: 0.2613, stage1_bag_acc: 99.0690, stage1_neg_loss: 0.0910, stage1_mean_ious: 0.3297, stage1_s: 0.0074, stage1_m: 0.0302, stage1_l: 0.1004, stage1_h: 0.3562, loss: 0.3841, grad_norm: 15.7169
2024-10-15 05:16:12,699 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:43:00, time: 1.741, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0820, stage0_bag_acc: 94.8994, stage0_mean_ious: 0.3376, stage0_s: 0.0000, stage0_m: 0.0276, stage0_l: 0.1353, stage0_h: 0.3602, stage1_loss_instance_mil: 0.2544, stage1_bag_acc: 96.7138, stage1_neg_loss: 0.0761, stage1_mean_ious: 0.3056, stage1_s: 0.0000, stage1_m: 0.0200, stage1_l: 0.1099, stage1_h: 0.3281, loss: 0.4125, grad_norm: 13.9945
2024-10-15 05:17:04,868 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 05:18:36,966 - mmdet - INFO - Evaluating bbox...
2024-10-15 05:18:37,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0358
2024-10-15 05:18:37,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1351
2024-10-15 05:18:37,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0604
2024-10-15 05:18:37,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0181
2024-10-15 05:18:37,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0067
2024-10-15 05:18:37,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0040
2024-10-15 05:18:37,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-15 05:18:37,879 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 05:18:37,879 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0428
2024-10-15 05:18:37,879 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0430
2024-10-15 05:18:37,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0834
2024-10-15 05:18:37,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2492
2024-10-15 05:18:37,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0834
2024-10-15 05:18:37,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0834
2024-10-15 05:18:37,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0014
2024-10-15 05:18:37,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1189
2024-10-15 05:18:37,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0490
2024-10-15 05:18:37,897 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 05:18:37,897 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 90, bbox_mAP: 0.0360, bbox_mAP_50: 0.1350, bbox_mAP_75: 0.0600, bbox_mAP_s: 0.0180, bbox_mAP_m: 0.0070, bbox_mAP_l: 0.0040, bbox_mAP_copypaste: 0.036 0.135 0.060 0.018 0.007 0.004
2024-10-15 05:20:07,663 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:39:20, time: 1.795, data_time: 0.074, memory: 18833, stage0_loss_instance_mil: 0.0369, stage0_bag_acc: 97.7499, stage0_mean_ious: 0.3306, stage0_s: 0.0000, stage0_m: 0.0474, stage0_l: 0.1032, stage0_h: 0.3582, stage1_loss_instance_mil: 0.2465, stage1_bag_acc: 98.1513, stage1_neg_loss: 0.0827, stage1_mean_ious: 0.2881, stage1_s: 0.0000, stage1_m: 0.0313, stage1_l: 0.0918, stage1_h: 0.3135, loss: 0.3661, grad_norm: 12.8758
2024-10-15 05:21:33,295 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:38:30, time: 1.713, data_time: 0.024, memory: 18833, stage0_loss_instance_mil: 0.0227, stage0_bag_acc: 98.8044, stage0_mean_ious: 0.3200, stage0_s: 0.0083, stage0_m: 0.0299, stage0_l: 0.1027, stage0_h: 0.3422, stage1_loss_instance_mil: 0.2476, stage1_bag_acc: 98.9003, stage1_neg_loss: 0.0790, stage1_mean_ious: 0.2803, stage1_s: 0.0071, stage1_m: 0.0211, stage1_l: 0.0838, stage1_h: 0.3019, loss: 0.3494, grad_norm: 12.0763
2024-10-15 05:23:00,027 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:37, time: 1.735, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0276, stage0_bag_acc: 98.0414, stage0_mean_ious: 0.2497, stage0_s: 0.0000, stage0_m: 0.0254, stage0_l: 0.1134, stage0_h: 0.2653, stage1_loss_instance_mil: 0.2447, stage1_bag_acc: 98.0592, stage1_neg_loss: 0.0799, stage1_mean_ious: 0.2196, stage1_s: 0.0000, stage1_m: 0.0160, stage1_l: 0.0955, stage1_h: 0.2353, loss: 0.3521, grad_norm: 11.6122
2024-10-15 05:23:52,492 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 05:25:22,887 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:32, time: 1.774, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.0105, stage0_bag_acc: 99.6240, stage0_mean_ious: 0.2473, stage0_s: 0.0000, stage0_m: 0.0331, stage0_l: 0.0920, stage0_h: 0.2644, stage1_loss_instance_mil: 0.2343, stage1_bag_acc: 99.6798, stage1_neg_loss: 0.0731, stage1_mean_ious: 0.2254, stage1_s: 0.0000, stage1_m: 0.0222, stage1_l: 0.0731, stage1_h: 0.2431, loss: 0.3179, grad_norm: 9.5576
2024-10-15 05:26:51,179 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:40, time: 1.766, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0230, stage0_bag_acc: 98.5611, stage0_mean_ious: 0.1596, stage0_s: 0.0000, stage0_m: 0.0392, stage0_l: 0.0870, stage0_h: 0.1662, stage1_loss_instance_mil: 0.2320, stage1_bag_acc: 99.2002, stage1_neg_loss: 0.0709, stage1_mean_ious: 0.1440, stage1_s: 0.0000, stage1_m: 0.0248, stage1_l: 0.0653, stage1_h: 0.1518, loss: 0.3259, grad_norm: 8.1941
2024-10-15 05:28:17,930 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:42, time: 1.735, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0175, stage0_bag_acc: 99.3558, stage0_mean_ious: 0.1395, stage0_s: 0.0000, stage0_m: 0.0427, stage0_l: 0.0945, stage0_h: 0.1433, stage1_loss_instance_mil: 0.2234, stage1_bag_acc: 99.2524, stage1_neg_loss: 0.0783, stage1_mean_ious: 0.1271, stage1_s: 0.0000, stage1_m: 0.0281, stage1_l: 0.0687, stage1_h: 0.1339, loss: 0.3192, grad_norm: 9.2848
2024-10-15 05:29:09,195 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 05:30:41,651 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:30:00, time: 1.806, data_time: 0.073, memory: 18833, stage0_loss_instance_mil: 0.0164, stage0_bag_acc: 99.4751, stage0_mean_ious: 0.1464, stage0_s: 0.0078, stage0_m: 0.0415, stage0_l: 0.1024, stage0_h: 0.1505, stage1_loss_instance_mil: 0.2085, stage1_bag_acc: 99.4600, stage1_neg_loss: 0.0681, stage1_mean_ious: 0.1338, stage1_s: 0.0066, stage1_m: 0.0287, stage1_l: 0.0769, stage1_h: 0.1415, loss: 0.2930, grad_norm: 8.8920
2024-10-15 05:32:06,126 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 05:32:06,126 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:57, time: 1.689, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0176, stage0_bag_acc: 99.2574, stage0_mean_ious: 0.1137, stage0_s: 0.0000, stage0_m: 0.0345, stage0_l: 0.0925, stage0_h: 0.1128, stage1_loss_instance_mil: 0.2301, stage1_bag_acc: 99.4884, stage1_neg_loss: 0.0768, stage1_mean_ious: 0.1071, stage1_s: 0.0000, stage1_m: 0.0202, stage1_l: 0.0751, stage1_h: 0.1087, loss: 0.3244, grad_norm: 10.3106
2024-10-15 05:33:32,019 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:54, time: 1.718, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0119, stage0_bag_acc: 99.2959, stage0_mean_ious: 0.1206, stage0_s: 0.0000, stage0_m: 0.0336, stage0_l: 0.0863, stage0_h: 0.1201, stage1_loss_instance_mil: 0.2129, stage1_bag_acc: 99.7086, stage1_neg_loss: 0.0682, stage1_mean_ious: 0.1081, stage1_s: 0.0000, stage1_m: 0.0217, stage1_l: 0.0686, stage1_h: 0.1099, loss: 0.2931, grad_norm: 9.1307
2024-10-15 05:34:24,872 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 05:35:56,651 - mmdet - INFO - Evaluating bbox...
2024-10-15 05:35:57,455 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0003
2024-10-15 05:35:57,455 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0021
2024-10-15 05:35:57,455 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0002
2024-10-15 05:35:57,455 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0001
2024-10-15 05:35:57,455 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 05:35:57,455 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 05:35:57,455 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 05:35:57,456 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 05:35:57,456 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0006
2024-10-15 05:35:57,456 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0010
2024-10-15 05:35:57,456 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0047
2024-10-15 05:35:57,456 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.0213
2024-10-15 05:35:57,456 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0047
2024-10-15 05:35:57,456 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0047
2024-10-15 05:35:57,456 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0003
2024-10-15 05:35:57,456 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0087
2024-10-15 05:35:57,456 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0017
2024-10-15 05:35:57,473 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 05:35:57,474 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0000, bbox_mAP_50: 0.0020, bbox_mAP_75: 0.0000, bbox_mAP_s: 0.0000, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.000 0.002 0.000 0.000 0.000 0.000
2024-10-15 05:37:26,850 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:25, time: 1.787, data_time: 0.076, memory: 18833, stage0_loss_instance_mil: 0.0128, stage0_bag_acc: 99.4016, stage0_mean_ious: 0.1084, stage0_s: 0.0000, stage0_m: 0.0212, stage0_l: 0.0813, stage0_h: 0.1092, stage1_loss_instance_mil: 0.1885, stage1_bag_acc: 99.7490, stage1_neg_loss: 0.0629, stage1_mean_ious: 0.1014, stage1_s: 0.0000, stage1_m: 0.0137, stage1_l: 0.0640, stage1_h: 0.1045, loss: 0.2642, grad_norm: 8.5362
2024-10-15 05:38:52,145 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:20, time: 1.706, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0087, stage0_bag_acc: 99.5281, stage0_mean_ious: 0.1031, stage0_s: 0.0000, stage0_m: 0.0262, stage0_l: 0.0885, stage0_h: 0.1017, stage1_loss_instance_mil: 0.1948, stage1_bag_acc: 99.2111, stage1_neg_loss: 0.0719, stage1_mean_ious: 0.0969, stage1_s: 0.0000, stage1_m: 0.0227, stage1_l: 0.0727, stage1_h: 0.0976, loss: 0.2754, grad_norm: 11.7111
2024-10-15 05:40:20,986 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:23:16, time: 1.777, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0130, stage0_bag_acc: 99.5833, stage0_mean_ious: 0.0943, stage0_s: 0.0000, stage0_m: 0.0382, stage0_l: 0.0985, stage0_h: 0.0918, stage1_loss_instance_mil: 0.1628, stage1_bag_acc: 99.6833, stage1_neg_loss: 0.0650, stage1_mean_ious: 0.0873, stage1_s: 0.0000, stage1_m: 0.0257, stage1_l: 0.0793, stage1_h: 0.0872, loss: 0.2408, grad_norm: 7.0971
2024-10-15 05:41:10,830 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 05:42:42,594 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:56, time: 1.792, data_time: 0.074, memory: 18833, stage0_loss_instance_mil: 0.0084, stage0_bag_acc: 99.6774, stage0_mean_ious: 0.0802, stage0_s: 0.0000, stage0_m: 0.0510, stage0_l: 0.0720, stage0_h: 0.0751, stage1_loss_instance_mil: 0.1454, stage1_bag_acc: 99.6064, stage1_neg_loss: 0.0616, stage1_mean_ious: 0.0749, stage1_s: 0.0000, stage1_m: 0.0358, stage1_l: 0.0581, stage1_h: 0.0731, loss: 0.2154, grad_norm: 6.7263
2024-10-15 05:44:08,196 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:49, time: 1.712, data_time: 0.024, memory: 18833, stage0_loss_instance_mil: 0.0169, stage0_bag_acc: 98.7036, stage0_mean_ious: 0.0963, stage0_s: 0.0000, stage0_m: 0.0379, stage0_l: 0.0804, stage0_h: 0.0943, stage1_loss_instance_mil: 0.1480, stage1_bag_acc: 99.1775, stage1_neg_loss: 0.0597, stage1_mean_ious: 0.0911, stage1_s: 0.0000, stage1_m: 0.0285, stage1_l: 0.0656, stage1_h: 0.0914, loss: 0.2246, grad_norm: 7.8082
2024-10-15 05:45:35,463 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:42, time: 1.745, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0051, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.0902, stage0_s: 0.0000, stage0_m: 0.0126, stage0_l: 0.0861, stage0_h: 0.0876, stage1_loss_instance_mil: 0.1355, stage1_bag_acc: 99.6517, stage1_neg_loss: 0.0606, stage1_mean_ious: 0.0869, stage1_s: 0.0000, stage1_m: 0.0111, stage1_l: 0.0793, stage1_h: 0.0848, loss: 0.2012, grad_norm: 6.2195
2024-10-15 05:46:27,389 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 05:47:59,216 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:29, time: 1.792, data_time: 0.074, memory: 18833, stage0_loss_instance_mil: 0.0082, stage0_bag_acc: 99.5711, stage0_mean_ious: 0.0845, stage0_s: 0.0078, stage0_m: 0.0333, stage0_l: 0.0807, stage0_h: 0.0805, stage1_loss_instance_mil: 0.1134, stage1_bag_acc: 99.6814, stage1_neg_loss: 0.0455, stage1_mean_ious: 0.0801, stage1_s: 0.0064, stage1_m: 0.0254, stage1_l: 0.0673, stage1_h: 0.0787, loss: 0.1670, grad_norm: 5.1677
2024-10-15 05:49:23,850 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:19, time: 1.693, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 99.9200, stage0_mean_ious: 0.0816, stage0_s: 0.0000, stage0_m: 0.0381, stage0_l: 0.0754, stage0_h: 0.0777, stage1_loss_instance_mil: 0.1191, stage1_bag_acc: 99.7662, stage1_neg_loss: 0.0519, stage1_mean_ious: 0.0778, stage1_s: 0.0000, stage1_m: 0.0285, stage1_l: 0.0638, stage1_h: 0.0761, loss: 0.1738, grad_norm: 5.1640
2024-10-15 05:50:52,088 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:10, time: 1.765, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0025, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.0911, stage0_s: 0.0000, stage0_m: 0.0438, stage0_l: 0.0779, stage0_h: 0.0877, stage1_loss_instance_mil: 0.1108, stage1_bag_acc: 99.8333, stage1_neg_loss: 0.0552, stage1_mean_ious: 0.0867, stage1_s: 0.0000, stage1_m: 0.0368, stage1_l: 0.0719, stage1_h: 0.0855, loss: 0.1685, grad_norm: 4.9309
2024-10-15 05:51:44,482 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 05:53:16,551 - mmdet - INFO - Evaluating bbox...
2024-10-15 05:53:17,381 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0000
2024-10-15 05:53:17,381 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0002
2024-10-15 05:53:17,381 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 05:53:17,382 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 05:53:17,382 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 05:53:17,382 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 05:53:17,382 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 05:53:17,382 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 05:53:17,382 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0002
2024-10-15 05:53:17,382 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0006
2024-10-15 05:53:17,383 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0019
2024-10-15 05:53:17,383 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.0092
2024-10-15 05:53:17,383 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0019
2024-10-15 05:53:17,383 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0019
2024-10-15 05:53:17,383 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0002
2024-10-15 05:53:17,383 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0024
2024-10-15 05:53:17,383 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0010
2024-10-15 05:53:17,400 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 05:53:17,400 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 90, bbox_mAP: 0.0000, bbox_mAP_50: 0.0000, bbox_mAP_75: 0.0000, bbox_mAP_s: 0.0000, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.000 0.000 0.000 0.000 0.000 0.000
2024-10-15 05:54:47,144 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:12:02, time: 1.794, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.0045, stage0_bag_acc: 99.6630, stage0_mean_ious: 0.0943, stage0_s: 0.0000, stage0_m: 0.0376, stage0_l: 0.0914, stage0_h: 0.0921, stage1_loss_instance_mil: 0.1075, stage1_bag_acc: 99.8947, stage1_neg_loss: 0.0503, stage1_mean_ious: 0.0876, stage1_s: 0.0000, stage1_m: 0.0302, stage1_l: 0.0711, stage1_h: 0.0879, loss: 0.1623, grad_norm: 5.1083
2024-10-15 05:56:13,336 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:51, time: 1.724, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0056, stage0_bag_acc: 99.9091, stage0_mean_ious: 0.0892, stage0_s: 0.0000, stage0_m: 0.0282, stage0_l: 0.1040, stage0_h: 0.0843, stage1_loss_instance_mil: 0.1078, stage1_bag_acc: 99.8038, stage1_neg_loss: 0.0514, stage1_mean_ious: 0.0852, stage1_s: 0.0000, stage1_m: 0.0227, stage1_l: 0.0903, stage1_h: 0.0819, loss: 0.1648, grad_norm: 4.8856
2024-10-15 05:57:40,210 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:40, time: 1.737, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 99.8248, stage0_mean_ious: 0.0869, stage0_s: 0.0000, stage0_m: 0.0385, stage0_l: 0.0682, stage0_h: 0.0836, stage1_loss_instance_mil: 0.1041, stage1_bag_acc: 99.8248, stage1_neg_loss: 0.0534, stage1_mean_ious: 0.0827, stage1_s: 0.0000, stage1_m: 0.0308, stage1_l: 0.0585, stage1_h: 0.0814, loss: 0.1603, grad_norm: 5.2953
2024-10-15 05:58:32,316 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 06:00:02,014 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:36, time: 1.751, data_time: 0.075, memory: 18833, stage0_loss_instance_mil: 0.0040, stage0_bag_acc: 99.6797, stage0_mean_ious: 0.0918, stage0_s: 0.0000, stage0_m: 0.0329, stage0_l: 0.0826, stage0_h: 0.0887, stage1_loss_instance_mil: 0.1055, stage1_bag_acc: 99.6797, stage1_neg_loss: 0.0526, stage1_mean_ious: 0.0856, stage1_s: 0.0000, stage1_m: 0.0287, stage1_l: 0.0743, stage1_h: 0.0839, loss: 0.1621, grad_norm: 5.1814
2024-10-15 06:01:29,519 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:24, time: 1.750, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0025, stage0_bag_acc: 99.8667, stage0_mean_ious: 0.0954, stage0_s: 0.0000, stage0_m: 0.0318, stage0_l: 0.0838, stage0_h: 0.0930, stage1_loss_instance_mil: 0.1044, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0512, stage1_mean_ious: 0.0888, stage1_s: 0.0000, stage1_m: 0.0223, stage1_l: 0.0696, stage1_h: 0.0886, loss: 0.1580, grad_norm: 5.0269
2024-10-15 06:02:55,501 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:11, time: 1.720, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.0895, stage0_s: 0.0078, stage0_m: 0.0414, stage0_l: 0.0791, stage0_h: 0.0862, stage1_loss_instance_mil: 0.0995, stage1_bag_acc: 99.7947, stage1_neg_loss: 0.0467, stage1_mean_ious: 0.0828, stage1_s: 0.0063, stage1_m: 0.0328, stage1_l: 0.0731, stage1_h: 0.0804, loss: 0.1521, grad_norm: 4.3330
2024-10-15 06:03:46,707 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 06:05:16,468 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:11, time: 1.750, data_time: 0.073, memory: 18833, stage0_loss_instance_mil: 0.0056, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.0912, stage0_s: 0.0000, stage0_m: 0.0315, stage0_l: 0.0803, stage0_h: 0.0882, stage1_loss_instance_mil: 0.1022, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0458, stage1_mean_ious: 0.0863, stage1_s: 0.0000, stage1_m: 0.0229, stage1_l: 0.0695, stage1_h: 0.0858, loss: 0.1535, grad_norm: 4.2794
2024-10-15 06:06:39,820 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:57, time: 1.667, data_time: 0.024, memory: 18833, stage0_loss_instance_mil: 0.0032, stage0_bag_acc: 99.8056, stage0_mean_ious: 0.0844, stage0_s: 0.0000, stage0_m: 0.0426, stage0_l: 0.0784, stage0_h: 0.0816, stage1_loss_instance_mil: 0.1007, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0520, stage1_mean_ious: 0.0804, stage1_s: 0.0000, stage1_m: 0.0327, stage1_l: 0.0749, stage1_h: 0.0786, loss: 0.1558, grad_norm: 4.6120
2024-10-15 06:08:04,502 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.694, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0017, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.0858, stage0_s: 0.0000, stage0_m: 0.0329, stage0_l: 0.0807, stage0_h: 0.0832, stage1_loss_instance_mil: 0.0933, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0477, stage1_mean_ious: 0.0823, stage1_s: 0.0000, stage1_m: 0.0281, stage1_l: 0.0695, stage1_h: 0.0810, loss: 0.1427, grad_norm: 4.3393
2024-10-15 06:08:56,799 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 06:10:28,646 - mmdet - INFO - Evaluating bbox...
2024-10-15 06:10:29,450 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0001
2024-10-15 06:10:29,450 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 06:10:29,450 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 06:10:29,450 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 06:10:29,450 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 06:10:29,451 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 06:10:29,451 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 06:10:29,451 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 06:10:29,451 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0002
2024-10-15 06:10:29,451 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0004
2024-10-15 06:10:29,451 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0017
2024-10-15 06:10:29,451 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.0079
2024-10-15 06:10:29,451 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0017
2024-10-15 06:10:29,451 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0017
2024-10-15 06:10:29,451 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0002
2024-10-15 06:10:29,452 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0038
2024-10-15 06:10:29,452 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0007
2024-10-15 06:10:29,468 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 06:10:29,468 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0000, bbox_mAP_50: 0.0000, bbox_mAP_75: 0.0000, bbox_mAP_s: 0.0000, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.000 0.000 0.000 0.000 0.000 0.000
2024-10-15 06:12:03,920 - mmdet - INFO - Evaluating bbox...
2024-10-15 06:12:04,730 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0001
2024-10-15 06:12:04,730 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 06:12:04,731 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 06:12:04,731 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 06:12:04,731 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 06:12:04,731 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 06:12:04,731 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 06:12:04,731 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 06:12:04,731 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0002
2024-10-15 06:12:04,731 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0004
2024-10-15 06:12:04,731 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0017
2024-10-15 06:12:04,732 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.0079
2024-10-15 06:12:04,732 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0017
2024-10-15 06:12:04,732 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0017
2024-10-15 06:12:04,732 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0002
2024-10-15 06:12:04,732 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0038
2024-10-15 06:12:04,732 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0007
2024-10-15 06:12:06,062 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+bc04488
------------------------------------------------------------

2024-10-15 06:12:07,137 - mmdet - INFO - Distributed training: False
2024-10-15 06:12:08,130 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 06:12:09,082 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 06:12:09,082 - mmdet - INFO - Use load_from_local loader
2024-10-15 06:12:09,360 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 06:12:09,372 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 06:12:09,372 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 06:13:36,275 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:01:07, time: 1.738, data_time: 0.071, memory: 18833, stage0_loss_instance_mil: 0.7240, stage0_bag_acc: 19.2339, stage0_mean_ious: 0.4401, stage0_s: 0.0000, stage0_m: 0.0224, stage0_l: 0.2848, stage0_h: 0.4594, stage1_loss_instance_mil: 0.1569, stage1_bag_acc: 13.0666, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.4272, stage1_s: 0.0000, stage1_m: 0.0234, stage1_l: 0.2768, stage1_h: 0.4466, loss: 0.8856, grad_norm: 3.3585
2024-10-15 06:15:01,911 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:14, time: 1.713, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.6159, stage0_bag_acc: 45.7864, stage0_mean_ious: 0.5101, stage0_s: 0.0000, stage0_m: 0.1054, stage0_l: 0.3102, stage0_h: 0.5302, stage1_loss_instance_mil: 0.2154, stage1_bag_acc: 21.4749, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.4799, stage1_s: 0.0000, stage1_m: 0.0944, stage1_l: 0.3027, stage1_h: 0.4984, loss: 0.8361, grad_norm: 3.5561
2024-10-15 06:16:27,611 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:57:40, time: 1.714, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.2711, stage0_bag_acc: 89.9103, stage0_mean_ious: 0.5025, stage0_s: 0.0000, stage0_m: 0.0528, stage0_l: 0.2398, stage0_h: 0.5253, stage1_loss_instance_mil: 0.3117, stage1_bag_acc: 74.3913, stage1_neg_loss: 0.0598, stage1_mean_ious: 0.4579, stage1_s: 0.0000, stage1_m: 0.0453, stage1_l: 0.2194, stage1_h: 0.4801, loss: 0.6426, grad_norm: 9.8527
2024-10-15 06:17:19,018 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 06:18:49,616 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:28, time: 1.768, data_time: 0.076, memory: 18833, stage0_loss_instance_mil: 0.0728, stage0_bag_acc: 96.8984, stage0_mean_ious: 0.4225, stage0_s: 0.0000, stage0_m: 0.0323, stage0_l: 0.1389, stage0_h: 0.4528, stage1_loss_instance_mil: 0.3391, stage1_bag_acc: 97.7413, stage1_neg_loss: 0.0858, stage1_mean_ious: 0.3726, stage1_s: 0.0000, stage1_m: 0.0250, stage1_l: 0.1216, stage1_h: 0.4006, loss: 0.4977, grad_norm: 12.2617
2024-10-15 06:20:16,328 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:29, time: 1.734, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0614, stage0_bag_acc: 96.2104, stage0_mean_ious: 0.4588, stage0_s: 0.0000, stage0_m: 0.0684, stage0_l: 0.1630, stage0_h: 0.4994, stage1_loss_instance_mil: 0.2925, stage1_bag_acc: 97.5582, stage1_neg_loss: 0.0881, stage1_mean_ious: 0.4095, stage1_s: 0.0000, stage1_m: 0.0447, stage1_l: 0.1382, stage1_h: 0.4489, loss: 0.4420, grad_norm: 13.7248
2024-10-15 06:21:42,471 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:48:00, time: 1.723, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0494, stage0_bag_acc: 97.3283, stage0_mean_ious: 0.4065, stage0_s: 0.0000, stage0_m: 0.0809, stage0_l: 0.1520, stage0_h: 0.4449, stage1_loss_instance_mil: 0.3254, stage1_bag_acc: 98.8474, stage1_neg_loss: 0.0800, stage1_mean_ious: 0.3652, stage1_s: 0.0000, stage1_m: 0.0537, stage1_l: 0.1183, stage1_h: 0.4047, loss: 0.4548, grad_norm: 13.2481
2024-10-15 06:22:34,582 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 06:24:05,783 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:43:17, time: 1.780, data_time: 0.075, memory: 18833, stage0_loss_instance_mil: 0.0416, stage0_bag_acc: 97.9860, stage0_mean_ious: 0.4472, stage0_s: 0.0000, stage0_m: 0.0423, stage0_l: 0.1573, stage0_h: 0.4913, stage1_loss_instance_mil: 0.2589, stage1_bag_acc: 97.9255, stage1_neg_loss: 0.0782, stage1_mean_ious: 0.3934, stage1_s: 0.0000, stage1_m: 0.0254, stage1_l: 0.1269, stage1_h: 0.4339, loss: 0.3787, grad_norm: 12.9042
2024-10-15 06:25:32,958 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:50, time: 1.744, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0421, stage0_bag_acc: 97.4724, stage0_mean_ious: 0.4645, stage0_s: 0.0085, stage0_m: 0.0269, stage0_l: 0.1511, stage0_h: 0.5038, stage1_loss_instance_mil: 0.2870, stage1_bag_acc: 97.9717, stage1_neg_loss: 0.0728, stage1_mean_ious: 0.4082, stage1_s: 0.0077, stage1_m: 0.0158, stage1_l: 0.1287, stage1_h: 0.4440, loss: 0.4020, grad_norm: 14.7800
2024-10-15 06:26:59,913 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:42:12, time: 1.739, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0262, stage0_bag_acc: 98.9641, stage0_mean_ious: 0.4583, stage0_s: 0.0000, stage0_m: 0.0606, stage0_l: 0.1423, stage0_h: 0.5042, stage1_loss_instance_mil: 0.2156, stage1_bag_acc: 99.1902, stage1_neg_loss: 0.0784, stage1_mean_ious: 0.4042, stage1_s: 0.0000, stage1_m: 0.0372, stage1_l: 0.1229, stage1_h: 0.4472, loss: 0.3202, grad_norm: 12.6103
2024-10-15 06:27:51,815 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 06:29:24,637 - mmdet - INFO - Evaluating bbox...
2024-10-15 06:29:25,513 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0498
2024-10-15 06:29:25,513 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1884
2024-10-15 06:29:25,513 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0860
2024-10-15 06:29:25,513 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0248
2024-10-15 06:29:25,513 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0109
2024-10-15 06:29:25,513 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0034
2024-10-15 06:29:25,514 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-15 06:29:25,514 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1068
2024-10-15 06:29:25,514 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0686
2024-10-15 06:29:25,514 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0426
2024-10-15 06:29:25,514 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1136
2024-10-15 06:29:25,514 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3271
2024-10-15 06:29:25,514 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1136
2024-10-15 06:29:25,514 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1136
2024-10-15 06:29:25,514 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1784
2024-10-15 06:29:25,514 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1625
2024-10-15 06:29:25,514 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0751
2024-10-15 06:29:25,529 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 06:29:25,529 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 90, bbox_mAP: 0.0500, bbox_mAP_50: 0.1880, bbox_mAP_75: 0.0860, bbox_mAP_s: 0.0250, bbox_mAP_m: 0.0110, bbox_mAP_l: 0.0030, bbox_mAP_copypaste: 0.050 0.188 0.086 0.025 0.011 0.003
2024-10-15 06:30:53,378 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:36, time: 1.757, data_time: 0.073, memory: 18833, stage0_loss_instance_mil: 0.0271, stage0_bag_acc: 98.8453, stage0_mean_ious: 0.4122, stage0_s: 0.0082, stage0_m: 0.0507, stage0_l: 0.1405, stage0_h: 0.4661, stage1_loss_instance_mil: 0.2142, stage1_bag_acc: 97.4512, stage1_neg_loss: 0.0711, stage1_mean_ious: 0.3608, stage1_s: 0.0067, stage1_m: 0.0278, stage1_l: 0.1086, stage1_h: 0.4133, loss: 0.3124, grad_norm: 14.1883
2024-10-15 06:32:20,061 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:53, time: 1.734, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0203, stage0_bag_acc: 99.0631, stage0_mean_ious: 0.4248, stage0_s: 0.0000, stage0_m: 0.0417, stage0_l: 0.1447, stage0_h: 0.4654, stage1_loss_instance_mil: 0.1764, stage1_bag_acc: 99.2094, stage1_neg_loss: 0.0716, stage1_mean_ious: 0.3726, stage1_s: 0.0000, stage1_m: 0.0311, stage1_l: 0.1125, stage1_h: 0.4108, loss: 0.2682, grad_norm: 12.8782
2024-10-15 06:33:47,705 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:05, time: 1.753, data_time: 0.030, memory: 18833, stage0_loss_instance_mil: 0.0181, stage0_bag_acc: 99.2238, stage0_mean_ious: 0.4713, stage0_s: 0.0000, stage0_m: 0.0419, stage0_l: 0.1585, stage0_h: 0.5193, stage1_loss_instance_mil: 0.1605, stage1_bag_acc: 99.1876, stage1_neg_loss: 0.0610, stage1_mean_ious: 0.4158, stage1_s: 0.0000, stage1_m: 0.0278, stage1_l: 0.1307, stage1_h: 0.4617, loss: 0.2396, grad_norm: 10.1819
2024-10-15 06:34:40,513 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 06:36:13,138 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:09, time: 1.807, data_time: 0.080, memory: 18833, stage0_loss_instance_mil: 0.0289, stage0_bag_acc: 98.0785, stage0_mean_ious: 0.4398, stage0_s: 0.0000, stage0_m: 0.0309, stage0_l: 0.1625, stage0_h: 0.4818, stage1_loss_instance_mil: 0.1874, stage1_bag_acc: 98.4683, stage1_neg_loss: 0.0595, stage1_mean_ious: 0.3825, stage1_s: 0.0000, stage1_m: 0.0199, stage1_l: 0.1329, stage1_h: 0.4220, loss: 0.2758, grad_norm: 13.2714
2024-10-15 06:37:40,239 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:17, time: 1.742, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0095, stage0_bag_acc: 99.8231, stage0_mean_ious: 0.4619, stage0_s: 0.0000, stage0_m: 0.0342, stage0_l: 0.1335, stage0_h: 0.5164, stage1_loss_instance_mil: 0.1372, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0633, stage1_mean_ious: 0.4116, stage1_s: 0.0000, stage1_m: 0.0242, stage1_l: 0.1056, stage1_h: 0.4628, loss: 0.2100, grad_norm: 10.2042
2024-10-15 06:39:05,120 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:18, time: 1.698, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0120, stage0_bag_acc: 99.6342, stage0_mean_ious: 0.4599, stage0_s: 0.0000, stage0_m: 0.0394, stage0_l: 0.1546, stage0_h: 0.5047, stage1_loss_instance_mil: 0.1592, stage1_bag_acc: 99.4697, stage1_neg_loss: 0.0643, stage1_mean_ious: 0.4002, stage1_s: 0.0000, stage1_m: 0.0268, stage1_l: 0.1222, stage1_h: 0.4410, loss: 0.2354, grad_norm: 11.9884
2024-10-15 06:39:56,379 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 06:41:27,678 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:38, time: 1.782, data_time: 0.076, memory: 18833, stage0_loss_instance_mil: 0.0166, stage0_bag_acc: 98.5117, stage0_mean_ious: 0.4785, stage0_s: 0.0000, stage0_m: 0.0486, stage0_l: 0.2142, stage0_h: 0.5206, stage1_loss_instance_mil: 0.1143, stage1_bag_acc: 98.9921, stage1_neg_loss: 0.0480, stage1_mean_ious: 0.4067, stage1_s: 0.0000, stage1_m: 0.0326, stage1_l: 0.1829, stage1_h: 0.4429, loss: 0.1790, grad_norm: 8.7948
2024-10-15 06:42:53,008 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 06:42:53,009 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:38, time: 1.707, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0248, stage0_bag_acc: 98.6983, stage0_mean_ious: 0.4930, stage0_s: 0.0000, stage0_m: 0.0657, stage0_l: 0.2114, stage0_h: 0.5371, stage1_loss_instance_mil: 0.1300, stage1_bag_acc: 99.3538, stage1_neg_loss: 0.0587, stage1_mean_ious: 0.4328, stage1_s: 0.0000, stage1_m: 0.0404, stage1_l: 0.1821, stage1_h: 0.4733, loss: 0.2136, grad_norm: 10.6268
2024-10-15 06:44:18,243 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:36, time: 1.705, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0138, stage0_bag_acc: 99.1587, stage0_mean_ious: 0.4811, stage0_s: 0.0000, stage0_m: 0.0336, stage0_l: 0.1514, stage0_h: 0.5322, stage1_loss_instance_mil: 0.1060, stage1_bag_acc: 99.3834, stage1_neg_loss: 0.0501, stage1_mean_ious: 0.4271, stage1_s: 0.0000, stage1_m: 0.0210, stage1_l: 0.1345, stage1_h: 0.4737, loss: 0.1699, grad_norm: 8.0750
2024-10-15 06:45:08,563 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 06:46:41,355 - mmdet - INFO - Evaluating bbox...
2024-10-15 06:46:42,097 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0994
2024-10-15 06:46:42,097 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2849
2024-10-15 06:46:42,097 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1757
2024-10-15 06:46:42,097 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0936
2024-10-15 06:46:42,097 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0563
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0226
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1346
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1177
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0926
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1684
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4064
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1684
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1684
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1389
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1812
2024-10-15 06:46:42,098 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1411
2024-10-15 06:46:42,113 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 06:46:42,113 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0990, bbox_mAP_50: 0.2850, bbox_mAP_75: 0.1760, bbox_mAP_s: 0.0940, bbox_mAP_m: 0.0560, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.099 0.285 0.176 0.094 0.056 0.023
2024-10-15 06:48:09,159 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:07, time: 1.741, data_time: 0.074, memory: 18833, stage0_loss_instance_mil: 0.0076, stage0_bag_acc: 99.4214, stage0_mean_ious: 0.4781, stage0_s: 0.0000, stage0_m: 0.0175, stage0_l: 0.1221, stage0_h: 0.5298, stage1_loss_instance_mil: 0.0939, stage1_bag_acc: 99.8381, stage1_neg_loss: 0.0553, stage1_mean_ious: 0.4227, stage1_s: 0.0000, stage1_m: 0.0117, stage1_l: 0.1005, stage1_h: 0.4705, loss: 0.1568, grad_norm: 9.3087
2024-10-15 06:49:34,238 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:04, time: 1.702, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0090, stage0_bag_acc: 99.8078, stage0_mean_ious: 0.4961, stage0_s: 0.0077, stage0_m: 0.0389, stage0_l: 0.1579, stage0_h: 0.5469, stage1_loss_instance_mil: 0.1020, stage1_bag_acc: 99.6843, stage1_neg_loss: 0.0451, stage1_mean_ious: 0.4375, stage1_s: 0.0062, stage1_m: 0.0234, stage1_l: 0.1276, stage1_h: 0.4846, loss: 0.1561, grad_norm: 8.6396
2024-10-15 06:51:01,560 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:23:00, time: 1.746, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0090, stage0_bag_acc: 99.3981, stage0_mean_ious: 0.5238, stage0_s: 0.0000, stage0_m: 0.0474, stage0_l: 0.1942, stage0_h: 0.5776, stage1_loss_instance_mil: 0.0960, stage1_bag_acc: 99.4433, stage1_neg_loss: 0.0463, stage1_mean_ious: 0.4586, stage1_s: 0.0000, stage1_m: 0.0290, stage1_l: 0.1738, stage1_h: 0.5070, loss: 0.1514, grad_norm: 8.5234
2024-10-15 06:51:53,244 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 06:53:24,734 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:42, time: 1.786, data_time: 0.076, memory: 18833, stage0_loss_instance_mil: 0.0047, stage0_bag_acc: 99.7836, stage0_mean_ious: 0.5143, stage0_s: 0.0000, stage0_m: 0.0500, stage0_l: 0.1767, stage0_h: 0.5694, stage1_loss_instance_mil: 0.0821, stage1_bag_acc: 99.6784, stage1_neg_loss: 0.0401, stage1_mean_ious: 0.4471, stage1_s: 0.0000, stage1_m: 0.0308, stage1_l: 0.1566, stage1_h: 0.4947, loss: 0.1269, grad_norm: 7.2353
2024-10-15 06:54:49,607 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:36, time: 1.697, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0095, stage0_bag_acc: 99.7778, stage0_mean_ious: 0.5452, stage0_s: 0.0077, stage0_m: 0.0211, stage0_l: 0.1792, stage0_h: 0.5928, stage1_loss_instance_mil: 0.0803, stage1_bag_acc: 99.4167, stage1_neg_loss: 0.0455, stage1_mean_ious: 0.4771, stage1_s: 0.0065, stage1_m: 0.0131, stage1_l: 0.1542, stage1_h: 0.5207, loss: 0.1354, grad_norm: 9.3854
2024-10-15 06:56:17,420 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:30, time: 1.756, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0099, stage0_bag_acc: 99.4128, stage0_mean_ious: 0.5417, stage0_s: 0.0000, stage0_m: 0.0264, stage0_l: 0.1660, stage0_h: 0.5761, stage1_loss_instance_mil: 0.0815, stage1_bag_acc: 99.6186, stage1_neg_loss: 0.0404, stage1_mean_ious: 0.4782, stage1_s: 0.0000, stage1_m: 0.0144, stage1_l: 0.1498, stage1_h: 0.5087, loss: 0.1318, grad_norm: 6.8124
2024-10-15 06:57:09,152 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 06:58:40,574 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:19, time: 1.784, data_time: 0.074, memory: 18833, stage0_loss_instance_mil: 0.0041, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.4943, stage0_s: 0.0000, stage0_m: 0.0190, stage0_l: 0.1588, stage0_h: 0.5324, stage1_loss_instance_mil: 0.0694, stage1_bag_acc: 99.7712, stage1_neg_loss: 0.0445, stage1_mean_ious: 0.4302, stage1_s: 0.0000, stage1_m: 0.0161, stage1_l: 0.1404, stage1_h: 0.4638, loss: 0.1179, grad_norm: 6.5447
2024-10-15 07:00:07,304 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:11, time: 1.735, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.9167, stage0_mean_ious: 0.5187, stage0_s: 0.0000, stage0_m: 0.0554, stage0_l: 0.1631, stage0_h: 0.5771, stage1_loss_instance_mil: 0.0613, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0348, stage1_mean_ious: 0.4513, stage1_s: 0.0000, stage1_m: 0.0336, stage1_l: 0.1400, stage1_h: 0.5045, loss: 0.0996, grad_norm: 5.4535
2024-10-15 07:01:35,480 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:03, time: 1.764, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.8182, stage0_mean_ious: 0.5113, stage0_s: 0.0000, stage0_m: 0.0331, stage0_l: 0.1836, stage0_h: 0.5592, stage1_loss_instance_mil: 0.0574, stage1_bag_acc: 99.7129, stage1_neg_loss: 0.0344, stage1_mean_ious: 0.4471, stage1_s: 0.0000, stage1_m: 0.0251, stage1_l: 0.1543, stage1_h: 0.4892, loss: 0.0979, grad_norm: 4.8036
2024-10-15 07:02:28,501 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 07:04:00,633 - mmdet - INFO - Evaluating bbox...
2024-10-15 07:04:01,500 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1461
2024-10-15 07:04:01,500 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3684
2024-10-15 07:04:01,500 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2586
2024-10-15 07:04:01,500 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1564
2024-10-15 07:04:01,500 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1029
2024-10-15 07:04:01,500 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0464
2024-10-15 07:04:01,500 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0021
2024-10-15 07:04:01,501 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1504
2024-10-15 07:04:01,501 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1359
2024-10-15 07:04:01,501 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1766
2024-10-15 07:04:01,501 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2195
2024-10-15 07:04:01,501 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4917
2024-10-15 07:04:01,501 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2195
2024-10-15 07:04:01,501 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2195
2024-10-15 07:04:01,501 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1745
2024-10-15 07:04:01,501 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2043
2024-10-15 07:04:01,501 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2281
2024-10-15 07:04:01,517 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 07:04:01,517 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 90, bbox_mAP: 0.1460, bbox_mAP_50: 0.3680, bbox_mAP_75: 0.2590, bbox_mAP_s: 0.1560, bbox_mAP_m: 0.1030, bbox_mAP_l: 0.0460, bbox_mAP_copypaste: 0.146 0.368 0.259 0.156 0.103 0.046
2024-10-15 07:05:30,630 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:56, time: 1.782, data_time: 0.084, memory: 18833, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.7128, stage0_mean_ious: 0.5205, stage0_s: 0.0000, stage0_m: 0.0300, stage0_l: 0.1407, stage0_h: 0.5785, stage1_loss_instance_mil: 0.0567, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0327, stage1_mean_ious: 0.4523, stage1_s: 0.0000, stage1_m: 0.0187, stage1_l: 0.1180, stage1_h: 0.5032, loss: 0.0930, grad_norm: 4.7456
2024-10-15 07:06:59,840 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:47, time: 1.784, data_time: 0.033, memory: 18833, stage0_loss_instance_mil: 0.0060, stage0_bag_acc: 99.7667, stage0_mean_ious: 0.5173, stage0_s: 0.0000, stage0_m: 0.0511, stage0_l: 0.1904, stage0_h: 0.5673, stage1_loss_instance_mil: 0.0556, stage1_bag_acc: 99.7667, stage1_neg_loss: 0.0318, stage1_mean_ious: 0.4555, stage1_s: 0.0000, stage1_m: 0.0318, stage1_l: 0.1701, stage1_h: 0.4997, loss: 0.0934, grad_norm: 5.0931
2024-10-15 07:08:25,271 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:36, time: 1.709, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0012, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5141, stage0_s: 0.0000, stage0_m: 0.0281, stage0_l: 0.2153, stage0_h: 0.5612, stage1_loss_instance_mil: 0.0577, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0327, stage1_mean_ious: 0.4553, stage1_s: 0.0000, stage1_m: 0.0171, stage1_l: 0.1946, stage1_h: 0.4974, loss: 0.0916, grad_norm: 4.7376
2024-10-15 07:09:17,560 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 07:10:49,130 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:33, time: 1.785, data_time: 0.083, memory: 18833, stage0_loss_instance_mil: 0.0023, stage0_bag_acc: 99.9130, stage0_mean_ious: 0.5232, stage0_s: 0.0000, stage0_m: 0.0268, stage0_l: 0.1415, stage0_h: 0.5696, stage1_loss_instance_mil: 0.0523, stage1_bag_acc: 99.7697, stage1_neg_loss: 0.0300, stage1_mean_ious: 0.4556, stage1_s: 0.0000, stage1_m: 0.0172, stage1_l: 0.1178, stage1_h: 0.4960, loss: 0.0846, grad_norm: 4.4042
2024-10-15 07:12:15,571 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:22, time: 1.729, data_time: 0.033, memory: 18833, stage0_loss_instance_mil: 0.0021, stage0_bag_acc: 99.9091, stage0_mean_ious: 0.5290, stage0_s: 0.0000, stage0_m: 0.0377, stage0_l: 0.1611, stage0_h: 0.5717, stage1_loss_instance_mil: 0.0515, stage1_bag_acc: 99.7662, stage1_neg_loss: 0.0319, stage1_mean_ious: 0.4653, stage1_s: 0.0000, stage1_m: 0.0275, stage1_l: 0.1368, stage1_h: 0.5037, loss: 0.0855, grad_norm: 4.9637
2024-10-15 07:13:40,871 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:09, time: 1.706, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0019, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5275, stage0_s: 0.0000, stage0_m: 0.0606, stage0_l: 0.1634, stage0_h: 0.5829, stage1_loss_instance_mil: 0.0532, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0304, stage1_mean_ious: 0.4669, stage1_s: 0.0000, stage1_m: 0.0489, stage1_l: 0.1564, stage1_h: 0.5147, loss: 0.0855, grad_norm: 4.7880
2024-10-15 07:14:34,342 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 07:16:05,106 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:09, time: 1.770, data_time: 0.082, memory: 18833, stage0_loss_instance_mil: 0.0016, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5256, stage0_s: 0.0000, stage0_m: 0.0318, stage0_l: 0.1626, stage0_h: 0.5743, stage1_loss_instance_mil: 0.0489, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0262, stage1_mean_ious: 0.4646, stage1_s: 0.0000, stage1_m: 0.0198, stage1_l: 0.1499, stage1_h: 0.5071, loss: 0.0767, grad_norm: 3.9323
2024-10-15 07:17:33,332 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:57, time: 1.765, data_time: 0.034, memory: 18833, stage0_loss_instance_mil: 0.0113, stage0_bag_acc: 99.5034, stage0_mean_ious: 0.5126, stage0_s: 0.0077, stage0_m: 0.0312, stage0_l: 0.1445, stage0_h: 0.5648, stage1_loss_instance_mil: 0.0554, stage1_bag_acc: 99.5275, stage1_neg_loss: 0.0303, stage1_mean_ious: 0.4484, stage1_s: 0.0061, stage1_m: 0.0205, stage1_l: 0.1252, stage1_h: 0.4944, loss: 0.0971, grad_norm: 4.6420
2024-10-15 07:19:01,064 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.755, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0010, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5172, stage0_s: 0.0000, stage0_m: 0.0289, stage0_l: 0.1751, stage0_h: 0.5733, stage1_loss_instance_mil: 0.0481, stage1_bag_acc: 99.8947, stage1_neg_loss: 0.0331, stage1_mean_ious: 0.4565, stage1_s: 0.0000, stage1_m: 0.0179, stage1_l: 0.1458, stage1_h: 0.5082, loss: 0.0822, grad_norm: 4.5737
2024-10-15 07:19:52,519 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 07:21:25,672 - mmdet - INFO - Evaluating bbox...
2024-10-15 07:21:26,601 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1595
2024-10-15 07:21:26,601 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3998
2024-10-15 07:21:26,601 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2787
2024-10-15 07:21:26,601 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1716
2024-10-15 07:21:26,601 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1227
2024-10-15 07:21:26,602 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0532
2024-10-15 07:21:26,602 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0021
2024-10-15 07:21:26,602 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1585
2024-10-15 07:21:26,602 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1470
2024-10-15 07:21:26,602 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1939
2024-10-15 07:21:26,602 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2357
2024-10-15 07:21:26,602 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.5196
2024-10-15 07:21:26,602 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2357
2024-10-15 07:21:26,602 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2357
2024-10-15 07:21:26,602 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1898
2024-10-15 07:21:26,602 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2198
2024-10-15 07:21:26,603 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2465
2024-10-15 07:21:26,619 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 07:21:26,619 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.1590, bbox_mAP_50: 0.4000, bbox_mAP_75: 0.2790, bbox_mAP_s: 0.1720, bbox_mAP_m: 0.1230, bbox_mAP_l: 0.0530, bbox_mAP_copypaste: 0.159 0.400 0.279 0.172 0.123 0.053
2024-10-15 07:22:58,475 - mmdet - INFO - Evaluating bbox...
2024-10-15 07:22:59,342 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1595
2024-10-15 07:22:59,342 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3998
2024-10-15 07:22:59,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2787
2024-10-15 07:22:59,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1716
2024-10-15 07:22:59,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1227
2024-10-15 07:22:59,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0532
2024-10-15 07:22:59,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0021
2024-10-15 07:22:59,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1585
2024-10-15 07:22:59,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1470
2024-10-15 07:22:59,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1939
2024-10-15 07:22:59,343 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2357
2024-10-15 07:22:59,343 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.5196
2024-10-15 07:22:59,343 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2357
2024-10-15 07:22:59,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2357
2024-10-15 07:22:59,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1898
2024-10-15 07:22:59,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2198
2024-10-15 07:22:59,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2465
2024-10-15 07:23:00,663 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+bc04488
------------------------------------------------------------

2024-10-15 07:23:01,552 - mmdet - INFO - Distributed training: False
2024-10-15 07:23:02,433 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 07:23:03,449 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 07:23:03,449 - mmdet - INFO - Use load_from_local loader
2024-10-15 07:23:03,709 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 07:23:03,722 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 07:23:03,723 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 07:24:31,754 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:01:54, time: 1.761, data_time: 0.073, memory: 18833, stage0_loss_instance_mil: 0.7152, stage0_bag_acc: 19.7490, stage0_mean_ious: 0.3496, stage0_s: 0.0000, stage0_m: 0.0500, stage0_l: 0.1827, stage0_h: 0.3557, stage1_loss_instance_mil: 0.1634, stage1_bag_acc: 13.6327, stage1_neg_loss: 0.0014, stage1_mean_ious: 0.3359, stage1_s: 0.0000, stage1_m: 0.0470, stage1_l: 0.1888, stage1_h: 0.3404, loss: 0.8799, grad_norm: 3.1831
2024-10-15 07:25:56,248 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:13, time: 1.690, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.5716, stage0_bag_acc: 65.3660, stage0_mean_ious: 0.3787, stage0_s: 0.0000, stage0_m: 0.0770, stage0_l: 0.2741, stage0_h: 0.3889, stage1_loss_instance_mil: 0.2482, stage1_bag_acc: 29.4669, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.3661, stage1_s: 0.0000, stage1_m: 0.0696, stage1_l: 0.2691, stage1_h: 0.3743, loss: 0.8265, grad_norm: 4.7684
2024-10-15 07:27:23,075 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:57:55, time: 1.737, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.2471, stage0_bag_acc: 90.7907, stage0_mean_ious: 0.3809, stage0_s: 0.0090, stage0_m: 0.0332, stage0_l: 0.1676, stage0_h: 0.4027, stage1_loss_instance_mil: 0.3374, stage1_bag_acc: 84.1249, stage1_neg_loss: 0.0723, stage1_mean_ious: 0.3595, stage1_s: 0.0075, stage1_m: 0.0279, stage1_l: 0.1812, stage1_h: 0.3774, loss: 0.6568, grad_norm: 15.0787
2024-10-15 07:28:14,114 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 07:29:43,938 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:31, time: 1.751, data_time: 0.075, memory: 18833, stage0_loss_instance_mil: 0.0884, stage0_bag_acc: 95.4624, stage0_mean_ious: 0.3556, stage0_s: 0.0000, stage0_m: 0.0711, stage0_l: 0.1800, stage0_h: 0.3910, stage1_loss_instance_mil: 0.3562, stage1_bag_acc: 96.5244, stage1_neg_loss: 0.0930, stage1_mean_ious: 0.3310, stage1_s: 0.0000, stage1_m: 0.0594, stage1_l: 0.1690, stage1_h: 0.3639, loss: 0.5376, grad_norm: 15.2348
2024-10-15 07:31:09,290 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:22, time: 1.707, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0506, stage0_bag_acc: 97.4030, stage0_mean_ious: 0.3543, stage0_s: 0.0000, stage0_m: 0.0459, stage0_l: 0.1776, stage0_h: 0.3729, stage1_loss_instance_mil: 0.3131, stage1_bag_acc: 98.6111, stage1_neg_loss: 0.0865, stage1_mean_ious: 0.3205, stage1_s: 0.0000, stage1_m: 0.0380, stage1_l: 0.1484, stage1_h: 0.3381, loss: 0.4502, grad_norm: 13.9008
2024-10-15 07:32:35,496 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:55, time: 1.724, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0450, stage0_bag_acc: 97.0016, stage0_mean_ious: 0.3795, stage0_s: 0.0000, stage0_m: 0.0118, stage0_l: 0.1636, stage0_h: 0.4012, stage1_loss_instance_mil: 0.2903, stage1_bag_acc: 98.8669, stage1_neg_loss: 0.0937, stage1_mean_ious: 0.3369, stage1_s: 0.0000, stage1_m: 0.0086, stage1_l: 0.1568, stage1_h: 0.3550, loss: 0.4291, grad_norm: 16.3030
2024-10-15 07:33:28,057 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 07:34:59,298 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:43:15, time: 1.790, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.0273, stage0_bag_acc: 98.7537, stage0_mean_ious: 0.3389, stage0_s: 0.0000, stage0_m: 0.0462, stage0_l: 0.1317, stage0_h: 0.3594, stage1_loss_instance_mil: 0.2891, stage1_bag_acc: 99.1150, stage1_neg_loss: 0.0837, stage1_mean_ious: 0.3091, stage1_s: 0.0000, stage1_m: 0.0375, stage1_l: 0.1249, stage1_h: 0.3281, loss: 0.4001, grad_norm: 15.7488
2024-10-15 07:36:26,045 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:47, time: 1.735, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0407, stage0_bag_acc: 97.2825, stage0_mean_ious: 0.3151, stage0_s: 0.0000, stage0_m: 0.0520, stage0_l: 0.1226, stage0_h: 0.3382, stage1_loss_instance_mil: 0.2443, stage1_bag_acc: 98.4146, stage1_neg_loss: 0.0783, stage1_mean_ious: 0.2820, stage1_s: 0.0000, stage1_m: 0.0422, stage1_l: 0.1058, stage1_h: 0.3045, loss: 0.3633, grad_norm: 13.5480
2024-10-15 07:37:52,526 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:42:07, time: 1.730, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0399, stage0_bag_acc: 97.7669, stage0_mean_ious: 0.3213, stage0_s: 0.0000, stage0_m: 0.0446, stage0_l: 0.1343, stage0_h: 0.3398, stage1_loss_instance_mil: 0.2513, stage1_bag_acc: 99.1708, stage1_neg_loss: 0.0796, stage1_mean_ious: 0.2829, stage1_s: 0.0000, stage1_m: 0.0286, stage1_l: 0.1099, stage1_h: 0.3012, loss: 0.3708, grad_norm: 14.7273
2024-10-15 07:38:44,741 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 07:40:16,883 - mmdet - INFO - Evaluating bbox...
2024-10-15 07:40:17,776 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0536
2024-10-15 07:40:17,776 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1908
2024-10-15 07:40:17,776 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0935
2024-10-15 07:40:17,776 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0317
2024-10-15 07:40:17,776 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0130
2024-10-15 07:40:17,776 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0054
2024-10-15 07:40:17,777 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-15 07:40:17,777 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0092
2024-10-15 07:40:17,777 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0581
2024-10-15 07:40:17,777 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0683
2024-10-15 07:40:17,777 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1043
2024-10-15 07:40:17,777 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2774
2024-10-15 07:40:17,777 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1043
2024-10-15 07:40:17,777 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1043
2024-10-15 07:40:17,777 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0125
2024-10-15 07:40:17,777 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1434
2024-10-15 07:40:17,777 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0839
2024-10-15 07:40:17,795 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 07:40:17,795 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 90, bbox_mAP: 0.0540, bbox_mAP_50: 0.1910, bbox_mAP_75: 0.0930, bbox_mAP_s: 0.0320, bbox_mAP_m: 0.0130, bbox_mAP_l: 0.0050, bbox_mAP_copypaste: 0.054 0.191 0.093 0.032 0.013 0.005
2024-10-15 07:41:48,579 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:40, time: 1.815, data_time: 0.080, memory: 18833, stage0_loss_instance_mil: 0.0546, stage0_bag_acc: 96.0832, stage0_mean_ious: 0.3109, stage0_s: 0.0000, stage0_m: 0.0432, stage0_l: 0.1008, stage0_h: 0.3395, stage1_loss_instance_mil: 0.2448, stage1_bag_acc: 97.5683, stage1_neg_loss: 0.0851, stage1_mean_ious: 0.2792, stage1_s: 0.0000, stage1_m: 0.0330, stage1_l: 0.0844, stage1_h: 0.3055, loss: 0.3845, grad_norm: 18.9694
2024-10-15 07:43:16,928 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:38:00, time: 1.767, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0200, stage0_bag_acc: 99.1820, stage0_mean_ious: 0.3359, stage0_s: 0.0000, stage0_m: 0.0230, stage0_l: 0.1125, stage0_h: 0.3675, stage1_loss_instance_mil: 0.2173, stage1_bag_acc: 99.1834, stage1_neg_loss: 0.0761, stage1_mean_ious: 0.2957, stage1_s: 0.0000, stage1_m: 0.0187, stage1_l: 0.0953, stage1_h: 0.3243, loss: 0.3133, grad_norm: 12.0238
2024-10-15 07:44:42,583 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:08, time: 1.713, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0182, stage0_bag_acc: 99.0348, stage0_mean_ious: 0.3003, stage0_s: 0.0000, stage0_m: 0.0354, stage0_l: 0.1087, stage0_h: 0.3251, stage1_loss_instance_mil: 0.2101, stage1_bag_acc: 99.2469, stage1_neg_loss: 0.0667, stage1_mean_ious: 0.2695, stage1_s: 0.0000, stage1_m: 0.0235, stage1_l: 0.0873, stage1_h: 0.2948, loss: 0.2950, grad_norm: 12.5936
2024-10-15 07:45:34,425 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 07:47:04,946 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:06, time: 1.757, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.0181, stage0_bag_acc: 98.7968, stage0_mean_ious: 0.3230, stage0_s: 0.0000, stage0_m: 0.0291, stage0_l: 0.1003, stage0_h: 0.3553, stage1_loss_instance_mil: 0.1633, stage1_bag_acc: 98.8328, stage1_neg_loss: 0.0690, stage1_mean_ious: 0.2870, stage1_s: 0.0000, stage1_m: 0.0202, stage1_l: 0.0795, stage1_h: 0.3174, loss: 0.2504, grad_norm: 10.7385
2024-10-15 07:48:31,709 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:14, time: 1.735, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0124, stage0_bag_acc: 99.1261, stage0_mean_ious: 0.2879, stage0_s: 0.0081, stage0_m: 0.0329, stage0_l: 0.1034, stage0_h: 0.3114, stage1_loss_instance_mil: 0.1835, stage1_bag_acc: 99.3625, stage1_neg_loss: 0.0768, stage1_mean_ious: 0.2596, stage1_s: 0.0056, stage1_m: 0.0199, stage1_l: 0.0829, stage1_h: 0.2830, loss: 0.2727, grad_norm: 14.5120
2024-10-15 07:49:58,818 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:18, time: 1.742, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0170, stage0_bag_acc: 99.0195, stage0_mean_ious: 0.3463, stage0_s: 0.0000, stage0_m: 0.0475, stage0_l: 0.1068, stage0_h: 0.3733, stage1_loss_instance_mil: 0.1723, stage1_bag_acc: 99.5460, stage1_neg_loss: 0.0619, stage1_mean_ious: 0.3050, stage1_s: 0.0000, stage1_m: 0.0363, stage1_l: 0.0798, stage1_h: 0.3323, loss: 0.2513, grad_norm: 10.6730
2024-10-15 07:50:51,874 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 07:52:23,078 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:38, time: 1.767, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.0147, stage0_bag_acc: 99.3438, stage0_mean_ious: 0.2966, stage0_s: 0.0000, stage0_m: 0.0453, stage0_l: 0.1054, stage0_h: 0.3258, stage1_loss_instance_mil: 0.1547, stage1_bag_acc: 99.6819, stage1_neg_loss: 0.0628, stage1_mean_ious: 0.2659, stage1_s: 0.0000, stage1_m: 0.0318, stage1_l: 0.0832, stage1_h: 0.2944, loss: 0.2322, grad_norm: 10.5753
2024-10-15 07:53:50,230 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 07:53:50,230 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:40, time: 1.743, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0060, stage0_bag_acc: 99.7871, stage0_mean_ious: 0.3064, stage0_s: 0.0000, stage0_m: 0.0270, stage0_l: 0.0894, stage0_h: 0.3315, stage1_loss_instance_mil: 0.1388, stage1_bag_acc: 99.4631, stage1_neg_loss: 0.0576, stage1_mean_ious: 0.2754, stage1_s: 0.0000, stage1_m: 0.0182, stage1_l: 0.0798, stage1_h: 0.2988, loss: 0.2024, grad_norm: 7.8014
2024-10-15 07:55:15,182 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:37, time: 1.699, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0118, stage0_bag_acc: 99.3046, stage0_mean_ious: 0.2945, stage0_s: 0.0000, stage0_m: 0.0345, stage0_l: 0.0963, stage0_h: 0.3152, stage1_loss_instance_mil: 0.1517, stage1_bag_acc: 99.6392, stage1_neg_loss: 0.0587, stage1_mean_ious: 0.2636, stage1_s: 0.0000, stage1_m: 0.0260, stage1_l: 0.0778, stage1_h: 0.2842, loss: 0.2222, grad_norm: 10.1779
2024-10-15 07:56:07,299 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 07:57:40,651 - mmdet - INFO - Evaluating bbox...
2024-10-15 07:57:41,509 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0521
2024-10-15 07:57:41,509 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1857
2024-10-15 07:57:41,509 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0948
2024-10-15 07:57:41,510 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0290
2024-10-15 07:57:41,510 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0107
2024-10-15 07:57:41,510 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0043
2024-10-15 07:57:41,510 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-15 07:57:41,510 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0197
2024-10-15 07:57:41,510 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0528
2024-10-15 07:57:41,510 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0768
2024-10-15 07:57:41,510 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0991
2024-10-15 07:57:41,510 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2711
2024-10-15 07:57:41,510 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0991
2024-10-15 07:57:41,511 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0991
2024-10-15 07:57:41,511 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0234
2024-10-15 07:57:41,511 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1243
2024-10-15 07:57:41,511 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0987
2024-10-15 07:57:41,527 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 07:57:41,527 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0520, bbox_mAP_50: 0.1860, bbox_mAP_75: 0.0950, bbox_mAP_s: 0.0290, bbox_mAP_m: 0.0110, bbox_mAP_l: 0.0040, bbox_mAP_copypaste: 0.052 0.186 0.095 0.029 0.011 0.004
2024-10-15 07:59:07,803 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:07, time: 1.725, data_time: 0.074, memory: 18833, stage0_loss_instance_mil: 0.0076, stage0_bag_acc: 99.6914, stage0_mean_ious: 0.3120, stage0_s: 0.0080, stage0_m: 0.0255, stage0_l: 0.1054, stage0_h: 0.3358, stage1_loss_instance_mil: 0.1318, stage1_bag_acc: 99.6862, stage1_neg_loss: 0.0725, stage1_mean_ious: 0.2708, stage1_s: 0.0054, stage1_m: 0.0185, stage1_l: 0.0812, stage1_h: 0.2939, loss: 0.2120, grad_norm: 11.0641
2024-10-15 08:00:34,594 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:06, time: 1.736, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0130, stage0_bag_acc: 99.3397, stage0_mean_ious: 0.3048, stage0_s: 0.0000, stage0_m: 0.0534, stage0_l: 0.0984, stage0_h: 0.3358, stage1_loss_instance_mil: 0.1240, stage1_bag_acc: 99.6185, stage1_neg_loss: 0.0592, stage1_mean_ious: 0.2741, stage1_s: 0.0000, stage1_m: 0.0366, stage1_l: 0.0815, stage1_h: 0.3044, loss: 0.1962, grad_norm: 9.2976
2024-10-15 08:02:00,502 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:23:01, time: 1.718, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0171, stage0_bag_acc: 98.9366, stage0_mean_ious: 0.3215, stage0_s: 0.0000, stage0_m: 0.0358, stage0_l: 0.1193, stage0_h: 0.3514, stage1_loss_instance_mil: 0.1310, stage1_bag_acc: 99.4765, stage1_neg_loss: 0.0517, stage1_mean_ious: 0.2864, stage1_s: 0.0000, stage1_m: 0.0254, stage1_l: 0.1089, stage1_h: 0.3137, loss: 0.1998, grad_norm: 8.9338
2024-10-15 08:02:52,388 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 08:04:22,906 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:43, time: 1.772, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.0055, stage0_bag_acc: 99.7981, stage0_mean_ious: 0.3151, stage0_s: 0.0000, stage0_m: 0.0323, stage0_l: 0.1162, stage0_h: 0.3448, stage1_loss_instance_mil: 0.1119, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0530, stage1_mean_ious: 0.2828, stage1_s: 0.0000, stage1_m: 0.0240, stage1_l: 0.0954, stage1_h: 0.3104, loss: 0.1704, grad_norm: 8.1828
2024-10-15 08:05:49,269 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:37, time: 1.727, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0077, stage0_bag_acc: 99.8200, stage0_mean_ious: 0.3032, stage0_s: 0.0000, stage0_m: 0.0453, stage0_l: 0.0923, stage0_h: 0.3289, stage1_loss_instance_mil: 0.1280, stage1_bag_acc: 99.5383, stage1_neg_loss: 0.0544, stage1_mean_ious: 0.2710, stage1_s: 0.0000, stage1_m: 0.0350, stage1_l: 0.0835, stage1_h: 0.2948, loss: 0.1901, grad_norm: 8.7062
2024-10-15 08:07:14,260 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:30, time: 1.700, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0048, stage0_bag_acc: 99.7738, stage0_mean_ious: 0.3070, stage0_s: 0.0000, stage0_m: 0.0392, stage0_l: 0.1082, stage0_h: 0.3301, stage1_loss_instance_mil: 0.1103, stage1_bag_acc: 99.9167, stage1_neg_loss: 0.0503, stage1_mean_ious: 0.2776, stage1_s: 0.0000, stage1_m: 0.0299, stage1_l: 0.0966, stage1_h: 0.2988, loss: 0.1654, grad_norm: 7.5354
2024-10-15 08:08:06,813 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 08:09:35,744 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:17, time: 1.734, data_time: 0.073, memory: 18833, stage0_loss_instance_mil: 0.0020, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3091, stage0_s: 0.0077, stage0_m: 0.0321, stage0_l: 0.0988, stage0_h: 0.3382, stage1_loss_instance_mil: 0.0936, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0462, stage1_mean_ious: 0.2746, stage1_s: 0.0054, stage1_m: 0.0231, stage1_l: 0.0820, stage1_h: 0.3017, loss: 0.1417, grad_norm: 6.5756
2024-10-15 08:11:02,592 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:10, time: 1.737, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.8462, stage0_mean_ious: 0.3100, stage0_s: 0.0000, stage0_m: 0.0488, stage0_l: 0.0981, stage0_h: 0.3342, stage1_loss_instance_mil: 0.0893, stage1_bag_acc: 99.8178, stage1_neg_loss: 0.0483, stage1_mean_ious: 0.2788, stage1_s: 0.0000, stage1_m: 0.0452, stage1_l: 0.0835, stage1_h: 0.3019, loss: 0.1411, grad_norm: 6.2849
2024-10-15 08:12:26,289 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:00, time: 1.674, data_time: 0.024, memory: 18833, stage0_loss_instance_mil: 0.0079, stage0_bag_acc: 99.7697, stage0_mean_ious: 0.3246, stage0_s: 0.0000, stage0_m: 0.0359, stage0_l: 0.0992, stage0_h: 0.3576, stage1_loss_instance_mil: 0.0945, stage1_bag_acc: 99.7639, stage1_neg_loss: 0.0431, stage1_mean_ious: 0.2987, stage1_s: 0.0000, stage1_m: 0.0319, stage1_l: 0.0823, stage1_h: 0.3296, loss: 0.1454, grad_norm: 5.6228
2024-10-15 08:13:17,979 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 08:14:49,432 - mmdet - INFO - Evaluating bbox...
2024-10-15 08:14:50,258 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0490
2024-10-15 08:14:50,258 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1667
2024-10-15 08:14:50,258 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0881
2024-10-15 08:14:50,258 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0320
2024-10-15 08:14:50,258 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0155
2024-10-15 08:14:50,258 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0033
2024-10-15 08:14:50,258 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 08:14:50,259 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0094
2024-10-15 08:14:50,259 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0500
2024-10-15 08:14:50,259 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0694
2024-10-15 08:14:50,259 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0931
2024-10-15 08:14:50,259 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2490
2024-10-15 08:14:50,259 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0931
2024-10-15 08:14:50,259 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0931
2024-10-15 08:14:50,259 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0253
2024-10-15 08:14:50,259 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1112
2024-10-15 08:14:50,259 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1057
2024-10-15 08:14:50,278 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 08:14:50,278 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 90, bbox_mAP: 0.0490, bbox_mAP_50: 0.1670, bbox_mAP_75: 0.0880, bbox_mAP_s: 0.0320, bbox_mAP_m: 0.0150, bbox_mAP_l: 0.0030, bbox_mAP_copypaste: 0.049 0.167 0.088 0.032 0.015 0.003
2024-10-15 08:16:17,743 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:53, time: 1.749, data_time: 0.078, memory: 18833, stage0_loss_instance_mil: 0.0017, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3035, stage0_s: 0.0080, stage0_m: 0.0401, stage0_l: 0.1240, stage0_h: 0.3293, stage1_loss_instance_mil: 0.0829, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0487, stage1_mean_ious: 0.2713, stage1_s: 0.0055, stage1_m: 0.0301, stage1_l: 0.1116, stage1_h: 0.2950, loss: 0.1334, grad_norm: 6.2888
2024-10-15 08:17:45,419 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:44, time: 1.754, data_time: 0.033, memory: 18833, stage0_loss_instance_mil: 0.0080, stage0_bag_acc: 99.6259, stage0_mean_ious: 0.3459, stage0_s: 0.0000, stage0_m: 0.0296, stage0_l: 0.0896, stage0_h: 0.3755, stage1_loss_instance_mil: 0.0852, stage1_bag_acc: 99.6259, stage1_neg_loss: 0.0396, stage1_mean_ious: 0.3106, stage1_s: 0.0000, stage1_m: 0.0277, stage1_l: 0.0759, stage1_h: 0.3363, loss: 0.1329, grad_norm: 4.8409
2024-10-15 08:19:13,286 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:34, time: 1.757, data_time: 0.031, memory: 18833, stage0_loss_instance_mil: 0.0060, stage0_bag_acc: 99.7080, stage0_mean_ious: 0.3034, stage0_s: 0.0000, stage0_m: 0.0348, stage0_l: 0.0952, stage0_h: 0.3292, stage1_loss_instance_mil: 0.0846, stage1_bag_acc: 99.7080, stage1_neg_loss: 0.0429, stage1_mean_ious: 0.2760, stage1_s: 0.0000, stage1_m: 0.0320, stage1_l: 0.0934, stage1_h: 0.2990, loss: 0.1335, grad_norm: 5.8062
2024-10-15 08:20:06,180 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 08:21:35,993 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:31, time: 1.752, data_time: 0.071, memory: 18833, stage0_loss_instance_mil: 0.0017, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.2966, stage0_s: 0.0000, stage0_m: 0.0220, stage0_l: 0.1080, stage0_h: 0.3193, stage1_loss_instance_mil: 0.0743, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0387, stage1_mean_ious: 0.2700, stage1_s: 0.0000, stage1_m: 0.0178, stage1_l: 0.0951, stage1_h: 0.2920, loss: 0.1146, grad_norm: 4.7556
2024-10-15 08:23:02,760 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:20, time: 1.735, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0027, stage0_bag_acc: 99.7798, stage0_mean_ious: 0.3182, stage0_s: 0.0000, stage0_m: 0.0383, stage0_l: 0.1099, stage0_h: 0.3398, stage1_loss_instance_mil: 0.0808, stage1_bag_acc: 99.7841, stage1_neg_loss: 0.0400, stage1_mean_ious: 0.2895, stage1_s: 0.0000, stage1_m: 0.0305, stage1_l: 0.0898, stage1_h: 0.3105, loss: 0.1235, grad_norm: 5.1022
2024-10-15 08:24:28,971 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:08, time: 1.724, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0012, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3097, stage0_s: 0.0000, stage0_m: 0.0231, stage0_l: 0.0963, stage0_h: 0.3419, stage1_loss_instance_mil: 0.0809, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0429, stage1_mean_ious: 0.2790, stage1_s: 0.0000, stage1_m: 0.0232, stage1_l: 0.0783, stage1_h: 0.3094, loss: 0.1249, grad_norm: 5.8115
2024-10-15 08:25:20,619 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 08:26:49,615 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:09, time: 1.736, data_time: 0.073, memory: 18833, stage0_loss_instance_mil: 0.0018, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.3037, stage0_s: 0.0000, stage0_m: 0.0346, stage0_l: 0.1014, stage0_h: 0.3358, stage1_loss_instance_mil: 0.0810, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0378, stage1_mean_ious: 0.2706, stage1_s: 0.0000, stage1_m: 0.0296, stage1_l: 0.0900, stage1_h: 0.3000, loss: 0.1205, grad_norm: 5.2932
2024-10-15 08:28:16,491 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:56, time: 1.738, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0066, stage0_bag_acc: 99.7981, stage0_mean_ious: 0.3114, stage0_s: 0.0000, stage0_m: 0.0410, stage0_l: 0.0901, stage0_h: 0.3450, stage1_loss_instance_mil: 0.0776, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0419, stage1_mean_ious: 0.2843, stage1_s: 0.0000, stage1_m: 0.0349, stage1_l: 0.0786, stage1_h: 0.3164, loss: 0.1260, grad_norm: 5.1559
2024-10-15 08:29:41,575 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.702, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0017, stage0_bag_acc: 99.9130, stage0_mean_ious: 0.3028, stage0_s: 0.0000, stage0_m: 0.0313, stage0_l: 0.0908, stage0_h: 0.3271, stage1_loss_instance_mil: 0.0728, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0341, stage1_mean_ious: 0.2734, stage1_s: 0.0000, stage1_m: 0.0249, stage1_l: 0.0829, stage1_h: 0.2959, loss: 0.1086, grad_norm: 4.5224
2024-10-15 08:30:34,266 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 08:32:05,887 - mmdet - INFO - Evaluating bbox...
2024-10-15 08:32:06,705 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0507
2024-10-15 08:32:06,706 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1695
2024-10-15 08:32:06,706 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0915
2024-10-15 08:32:06,706 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0332
2024-10-15 08:32:06,706 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0153
2024-10-15 08:32:06,706 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0036
2024-10-15 08:32:06,706 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 08:32:06,706 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0135
2024-10-15 08:32:06,706 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0511
2024-10-15 08:32:06,707 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0726
2024-10-15 08:32:06,707 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0941
2024-10-15 08:32:06,707 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2499
2024-10-15 08:32:06,707 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0941
2024-10-15 08:32:06,707 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0941
2024-10-15 08:32:06,707 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0330
2024-10-15 08:32:06,707 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1098
2024-10-15 08:32:06,707 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1062
2024-10-15 08:32:06,722 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 08:32:06,722 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0510, bbox_mAP_50: 0.1690, bbox_mAP_75: 0.0910, bbox_mAP_s: 0.0330, bbox_mAP_m: 0.0150, bbox_mAP_l: 0.0040, bbox_mAP_copypaste: 0.051 0.169 0.091 0.033 0.015 0.004
2024-10-15 08:33:37,579 - mmdet - INFO - Evaluating bbox...
2024-10-15 08:33:38,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0507
2024-10-15 08:33:38,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1695
2024-10-15 08:33:38,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0915
2024-10-15 08:33:38,398 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0332
2024-10-15 08:33:38,399 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0153
2024-10-15 08:33:38,399 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0036
2024-10-15 08:33:38,399 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 08:33:38,399 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0135
2024-10-15 08:33:38,399 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0511
2024-10-15 08:33:38,399 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0726
2024-10-15 08:33:38,399 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0941
2024-10-15 08:33:38,399 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2499
2024-10-15 08:33:38,399 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0941
2024-10-15 08:33:38,399 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0941
2024-10-15 08:33:38,399 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0330
2024-10-15 08:33:38,400 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1098
2024-10-15 08:33:38,400 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1062
2024-10-15 08:33:39,769 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+bc04488
------------------------------------------------------------

2024-10-15 08:33:40,663 - mmdet - INFO - Distributed training: False
2024-10-15 08:33:41,563 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 08:33:42,557 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 08:33:42,557 - mmdet - INFO - Use load_from_local loader
2024-10-15 08:33:42,819 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 08:33:42,832 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 08:33:42,833 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 08:35:13,697 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:03:54, time: 1.817, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.7073, stage0_bag_acc: 18.6376, stage0_mean_ious: 0.3372, stage0_s: 0.0000, stage0_m: 0.0260, stage0_l: 0.2062, stage0_h: 0.3528, stage1_loss_instance_mil: 0.1671, stage1_bag_acc: 18.7420, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.3308, stage1_s: 0.0000, stage1_m: 0.0313, stage1_l: 0.2123, stage1_h: 0.3446, loss: 0.8761, grad_norm: 3.4168
2024-10-15 08:36:41,254 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 1:01:15, time: 1.751, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.5818, stage0_bag_acc: 55.2818, stage0_mean_ious: 0.3091, stage0_s: 0.0000, stage0_m: 0.0406, stage0_l: 0.2623, stage0_h: 0.3155, stage1_loss_instance_mil: 0.2334, stage1_bag_acc: 21.3971, stage1_neg_loss: 0.0087, stage1_mean_ious: 0.3012, stage1_s: 0.0000, stage1_m: 0.0401, stage1_l: 0.2474, stage1_h: 0.3070, loss: 0.8239, grad_norm: 4.2178
2024-10-15 08:38:06,078 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:58:47, time: 1.696, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.2841, stage0_bag_acc: 82.7984, stage0_mean_ious: 0.2745, stage0_s: 0.0000, stage0_m: 0.0456, stage0_l: 0.2482, stage0_h: 0.2771, stage1_loss_instance_mil: 0.3268, stage1_bag_acc: 78.3348, stage1_neg_loss: 0.0646, stage1_mean_ious: 0.2556, stage1_s: 0.0000, stage1_m: 0.0403, stage1_l: 0.2289, stage1_h: 0.2592, loss: 0.6756, grad_norm: 10.0588
2024-10-15 08:38:58,464 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 08:40:29,197 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:49:11, time: 1.769, data_time: 0.073, memory: 18833, stage0_loss_instance_mil: 0.0720, stage0_bag_acc: 96.6043, stage0_mean_ious: 0.2784, stage0_s: 0.0000, stage0_m: 0.0449, stage0_l: 0.1975, stage0_h: 0.2836, stage1_loss_instance_mil: 0.3483, stage1_bag_acc: 97.3463, stage1_neg_loss: 0.0920, stage1_mean_ious: 0.2503, stage1_s: 0.0000, stage1_m: 0.0354, stage1_l: 0.1617, stage1_h: 0.2580, loss: 0.5123, grad_norm: 13.1819
2024-10-15 08:41:54,691 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:55, time: 1.710, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0430, stage0_bag_acc: 97.3366, stage0_mean_ious: 0.2815, stage0_s: 0.0000, stage0_m: 0.1033, stage0_l: 0.1686, stage0_h: 0.2896, stage1_loss_instance_mil: 0.3139, stage1_bag_acc: 98.6777, stage1_neg_loss: 0.0863, stage1_mean_ious: 0.2470, stage1_s: 0.0000, stage1_m: 0.0804, stage1_l: 0.1370, stage1_h: 0.2570, loss: 0.4431, grad_norm: 10.9510
2024-10-15 08:43:20,806 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:48:21, time: 1.722, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0422, stage0_bag_acc: 97.5819, stage0_mean_ious: 0.3108, stage0_s: 0.0000, stage0_m: 0.0477, stage0_l: 0.2145, stage0_h: 0.3202, stage1_loss_instance_mil: 0.3134, stage1_bag_acc: 98.6221, stage1_neg_loss: 0.1083, stage1_mean_ious: 0.2741, stage1_s: 0.0000, stage1_m: 0.0363, stage1_l: 0.1731, stage1_h: 0.2853, loss: 0.4639, grad_norm: 24.5795
2024-10-15 08:44:11,846 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 08:45:42,063 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:43:29, time: 1.759, data_time: 0.079, memory: 18833, stage0_loss_instance_mil: 0.0484, stage0_bag_acc: 96.9345, stage0_mean_ious: 0.3716, stage0_s: 0.0000, stage0_m: 0.0516, stage0_l: 0.2249, stage0_h: 0.3888, stage1_loss_instance_mil: 0.2987, stage1_bag_acc: 98.1278, stage1_neg_loss: 0.0839, stage1_mean_ious: 0.3143, stage1_s: 0.0000, stage1_m: 0.0407, stage1_l: 0.1959, stage1_h: 0.3292, loss: 0.4310, grad_norm: 14.0922
2024-10-15 08:47:08,715 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:59, time: 1.733, data_time: 0.032, memory: 18833, stage0_loss_instance_mil: 0.0302, stage0_bag_acc: 99.0081, stage0_mean_ious: 0.3975, stage0_s: 0.0000, stage0_m: 0.0341, stage0_l: 0.2352, stage0_h: 0.4084, stage1_loss_instance_mil: 0.3074, stage1_bag_acc: 99.3308, stage1_neg_loss: 0.0938, stage1_mean_ious: 0.3355, stage1_s: 0.0000, stage1_m: 0.0288, stage1_l: 0.2015, stage1_h: 0.3433, loss: 0.4315, grad_norm: 17.8827
2024-10-15 08:48:35,541 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:42:18, time: 1.737, data_time: 0.033, memory: 18833, stage0_loss_instance_mil: 0.0249, stage0_bag_acc: 98.6325, stage0_mean_ious: 0.4254, stage0_s: 0.0000, stage0_m: 0.0437, stage0_l: 0.2297, stage0_h: 0.4412, stage1_loss_instance_mil: 0.2371, stage1_bag_acc: 99.1033, stage1_neg_loss: 0.0729, stage1_mean_ious: 0.3475, stage1_s: 0.0000, stage1_m: 0.0331, stage1_l: 0.2056, stage1_h: 0.3572, loss: 0.3348, grad_norm: 12.6329
2024-10-15 08:49:28,635 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 08:51:01,108 - mmdet - INFO - Evaluating bbox...
2024-10-15 08:51:01,943 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0130
2024-10-15 08:51:01,944 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0597
2024-10-15 08:51:01,944 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0213
2024-10-15 08:51:01,944 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0042
2024-10-15 08:51:01,944 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0011
2024-10-15 08:51:01,944 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0005
2024-10-15 08:51:01,944 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-15 08:51:01,945 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0413
2024-10-15 08:51:01,945 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0242
2024-10-15 08:51:01,945 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0274
2024-10-15 08:51:01,945 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0631
2024-10-15 08:51:01,945 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.1978
2024-10-15 08:51:01,945 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0631
2024-10-15 08:51:01,945 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0631
2024-10-15 08:51:01,945 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1292
2024-10-15 08:51:01,945 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1021
2024-10-15 08:51:01,945 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0337
2024-10-15 08:51:01,963 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 08:51:01,963 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 90, bbox_mAP: 0.0130, bbox_mAP_50: 0.0600, bbox_mAP_75: 0.0210, bbox_mAP_s: 0.0040, bbox_mAP_m: 0.0010, bbox_mAP_l: 0.0010, bbox_mAP_copypaste: 0.013 0.060 0.021 0.004 0.001 0.001
2024-10-15 08:52:30,205 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:42, time: 1.764, data_time: 0.075, memory: 18833, stage0_loss_instance_mil: 0.0354, stage0_bag_acc: 98.3458, stage0_mean_ious: 0.4277, stage0_s: 0.0000, stage0_m: 0.0584, stage0_l: 0.2477, stage0_h: 0.4514, stage1_loss_instance_mil: 0.2296, stage1_bag_acc: 98.7559, stage1_neg_loss: 0.0752, stage1_mean_ious: 0.3559, stage1_s: 0.0000, stage1_m: 0.0478, stage1_l: 0.2193, stage1_h: 0.3729, loss: 0.3402, grad_norm: 13.1920
2024-10-15 08:53:57,547 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:38:00, time: 1.747, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0172, stage0_bag_acc: 99.2082, stage0_mean_ious: 0.4698, stage0_s: 0.0000, stage0_m: 0.0283, stage0_l: 0.2896, stage0_h: 0.4910, stage1_loss_instance_mil: 0.2029, stage1_bag_acc: 99.2805, stage1_neg_loss: 0.0669, stage1_mean_ious: 0.3950, stage1_s: 0.0000, stage1_m: 0.0263, stage1_l: 0.2656, stage1_h: 0.4095, loss: 0.2870, grad_norm: 13.2200
2024-10-15 08:55:24,551 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:11, time: 1.740, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0271, stage0_bag_acc: 98.7463, stage0_mean_ious: 0.4472, stage0_s: 0.0083, stage0_m: 0.0658, stage0_l: 0.2329, stage0_h: 0.4855, stage1_loss_instance_mil: 0.1871, stage1_bag_acc: 98.5470, stage1_neg_loss: 0.0677, stage1_mean_ious: 0.3829, stage1_s: 0.0081, stage1_m: 0.0593, stage1_l: 0.2209, stage1_h: 0.4104, loss: 0.2819, grad_norm: 11.9364
2024-10-15 08:56:15,788 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 08:57:49,163 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:15, time: 1.822, data_time: 0.078, memory: 18833, stage0_loss_instance_mil: 0.0115, stage0_bag_acc: 99.1111, stage0_mean_ious: 0.5052, stage0_s: 0.0000, stage0_m: 0.0246, stage0_l: 0.2630, stage0_h: 0.5359, stage1_loss_instance_mil: 0.1558, stage1_bag_acc: 99.5019, stage1_neg_loss: 0.0601, stage1_mean_ious: 0.4258, stage1_s: 0.0000, stage1_m: 0.0260, stage1_l: 0.2469, stage1_h: 0.4467, loss: 0.2274, grad_norm: 11.6278
2024-10-15 08:59:16,106 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:22, time: 1.739, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0180, stage0_bag_acc: 98.6558, stage0_mean_ious: 0.4753, stage0_s: 0.0000, stage0_m: 0.0592, stage0_l: 0.2547, stage0_h: 0.5068, stage1_loss_instance_mil: 0.1484, stage1_bag_acc: 99.5417, stage1_neg_loss: 0.0609, stage1_mean_ious: 0.4065, stage1_s: 0.0000, stage1_m: 0.0633, stage1_l: 0.2486, stage1_h: 0.4255, loss: 0.2273, grad_norm: 12.5586
2024-10-15 09:00:42,325 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:24, time: 1.724, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0183, stage0_bag_acc: 99.2282, stage0_mean_ious: 0.4766, stage0_s: 0.0000, stage0_m: 0.0421, stage0_l: 0.1942, stage0_h: 0.5111, stage1_loss_instance_mil: 0.1542, stage1_bag_acc: 99.6376, stage1_neg_loss: 0.0582, stage1_mean_ious: 0.4135, stage1_s: 0.0000, stage1_m: 0.0398, stage1_l: 0.1900, stage1_h: 0.4386, loss: 0.2307, grad_norm: 11.5004
2024-10-15 09:01:35,799 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 09:03:08,166 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:44, time: 1.795, data_time: 0.079, memory: 18833, stage0_loss_instance_mil: 0.0200, stage0_bag_acc: 98.7751, stage0_mean_ious: 0.4749, stage0_s: 0.0000, stage0_m: 0.0195, stage0_l: 0.2254, stage0_h: 0.5073, stage1_loss_instance_mil: 0.1353, stage1_bag_acc: 98.4936, stage1_neg_loss: 0.0557, stage1_mean_ious: 0.4129, stage1_s: 0.0000, stage1_m: 0.0166, stage1_l: 0.2301, stage1_h: 0.4349, loss: 0.2110, grad_norm: 10.8627
2024-10-15 09:04:34,471 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 09:04:34,472 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:45, time: 1.726, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0254, stage0_bag_acc: 99.1075, stage0_mean_ious: 0.4896, stage0_s: 0.0000, stage0_m: 0.0289, stage0_l: 0.2150, stage0_h: 0.5153, stage1_loss_instance_mil: 0.1424, stage1_bag_acc: 99.0123, stage1_neg_loss: 0.0520, stage1_mean_ious: 0.4396, stage1_s: 0.0000, stage1_m: 0.0317, stage1_l: 0.2225, stage1_h: 0.4569, loss: 0.2199, grad_norm: 10.2353
2024-10-15 09:06:01,114 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:44, time: 1.733, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0145, stage0_bag_acc: 99.2096, stage0_mean_ious: 0.5356, stage0_s: 0.0000, stage0_m: 0.1250, stage0_l: 0.3027, stage0_h: 0.5681, stage1_loss_instance_mil: 0.1115, stage1_bag_acc: 99.0549, stage1_neg_loss: 0.0452, stage1_mean_ious: 0.4625, stage1_s: 0.0000, stage1_m: 0.1219, stage1_l: 0.2864, stage1_h: 0.4853, loss: 0.1712, grad_norm: 7.4708
2024-10-15 09:06:53,084 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 09:08:25,393 - mmdet - INFO - Evaluating bbox...
2024-10-15 09:08:26,239 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0893
2024-10-15 09:08:26,239 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3017
2024-10-15 09:08:26,239 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1603
2024-10-15 09:08:26,239 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0577
2024-10-15 09:08:26,239 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0275
2024-10-15 09:08:26,239 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0108
2024-10-15 09:08:26,239 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 09:08:26,239 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0604
2024-10-15 09:08:26,239 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1082
2024-10-15 09:08:26,240 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1550
2024-10-15 09:08:26,240 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1679
2024-10-15 09:08:26,240 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4417
2024-10-15 09:08:26,240 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1679
2024-10-15 09:08:26,240 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1679
2024-10-15 09:08:26,240 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1316
2024-10-15 09:08:26,240 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2146
2024-10-15 09:08:26,240 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1769
2024-10-15 09:08:26,254 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 09:08:26,254 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0890, bbox_mAP_50: 0.3020, bbox_mAP_75: 0.1600, bbox_mAP_s: 0.0580, bbox_mAP_m: 0.0270, bbox_mAP_l: 0.0110, bbox_mAP_copypaste: 0.089 0.302 0.160 0.058 0.027 0.011
2024-10-15 09:09:54,554 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:15, time: 1.766, data_time: 0.074, memory: 18833, stage0_loss_instance_mil: 0.0086, stage0_bag_acc: 99.5912, stage0_mean_ious: 0.5500, stage0_s: 0.0079, stage0_m: 0.0590, stage0_l: 0.2645, stage0_h: 0.5783, stage1_loss_instance_mil: 0.1214, stage1_bag_acc: 99.5847, stage1_neg_loss: 0.0558, stage1_mean_ious: 0.4879, stage1_s: 0.0088, stage1_m: 0.0572, stage1_l: 0.2415, stage1_h: 0.5110, loss: 0.1857, grad_norm: 9.8609
2024-10-15 09:11:21,690 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:13, time: 1.743, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0093, stage0_bag_acc: 99.7038, stage0_mean_ious: 0.5431, stage0_s: 0.0000, stage0_m: 0.0688, stage0_l: 0.3319, stage0_h: 0.5624, stage1_loss_instance_mil: 0.1354, stage1_bag_acc: 99.6758, stage1_neg_loss: 0.0475, stage1_mean_ious: 0.4832, stage1_s: 0.0000, stage1_m: 0.0627, stage1_l: 0.3194, stage1_h: 0.4971, loss: 0.1922, grad_norm: 11.1345
2024-10-15 09:12:46,731 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:23:07, time: 1.701, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0074, stage0_bag_acc: 99.4946, stage0_mean_ious: 0.5403, stage0_s: 0.0000, stage0_m: 0.0862, stage0_l: 0.3560, stage0_h: 0.5690, stage1_loss_instance_mil: 0.1034, stage1_bag_acc: 99.7109, stage1_neg_loss: 0.0459, stage1_mean_ious: 0.4883, stage1_s: 0.0000, stage1_m: 0.0869, stage1_l: 0.3550, stage1_h: 0.5074, loss: 0.1567, grad_norm: 8.4363
2024-10-15 09:13:37,789 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 09:15:09,272 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:48, time: 1.786, data_time: 0.078, memory: 18833, stage0_loss_instance_mil: 0.0034, stage0_bag_acc: 99.8667, stage0_mean_ious: 0.5414, stage0_s: 0.0000, stage0_m: 0.0926, stage0_l: 0.2932, stage0_h: 0.5741, stage1_loss_instance_mil: 0.0880, stage1_bag_acc: 99.9091, stage1_neg_loss: 0.0411, stage1_mean_ious: 0.4906, stage1_s: 0.0000, stage1_m: 0.0947, stage1_l: 0.2931, stage1_h: 0.5146, loss: 0.1325, grad_norm: 7.4655
2024-10-15 09:16:32,588 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:40, time: 1.666, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0091, stage0_bag_acc: 99.4935, stage0_mean_ious: 0.5149, stage0_s: 0.0000, stage0_m: 0.0539, stage0_l: 0.2952, stage0_h: 0.5365, stage1_loss_instance_mil: 0.1180, stage1_bag_acc: 99.7238, stage1_neg_loss: 0.0544, stage1_mean_ious: 0.4678, stage1_s: 0.0000, stage1_m: 0.0582, stage1_l: 0.3006, stage1_h: 0.4807, loss: 0.1816, grad_norm: 11.6997
2024-10-15 09:18:00,220 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:34, time: 1.753, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0480, stage0_bag_acc: 97.0577, stage0_mean_ious: 0.5432, stage0_s: 0.0000, stage0_m: 0.1043, stage0_l: 0.3473, stage0_h: 0.5626, stage1_loss_instance_mil: 0.1217, stage1_bag_acc: 97.3604, stage1_neg_loss: 0.0460, stage1_mean_ious: 0.4909, stage1_s: 0.0000, stage1_m: 0.1058, stage1_l: 0.3481, stage1_h: 0.5018, loss: 0.2157, grad_norm: 10.0987
2024-10-15 09:18:52,710 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 09:20:25,609 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:22, time: 1.813, data_time: 0.084, memory: 18833, stage0_loss_instance_mil: 0.0094, stage0_bag_acc: 99.6103, stage0_mean_ious: 0.5615, stage0_s: 0.0000, stage0_m: 0.0492, stage0_l: 0.2954, stage0_h: 0.5965, stage1_loss_instance_mil: 0.0881, stage1_bag_acc: 99.6146, stage1_neg_loss: 0.0292, stage1_mean_ious: 0.4993, stage1_s: 0.0000, stage1_m: 0.0541, stage1_l: 0.2896, stage1_h: 0.5255, loss: 0.1267, grad_norm: 4.7857
2024-10-15 09:21:54,287 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:15, time: 1.774, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0096, stage0_bag_acc: 99.3530, stage0_mean_ious: 0.5304, stage0_s: 0.0000, stage0_m: 0.0863, stage0_l: 0.3472, stage0_h: 0.5616, stage1_loss_instance_mil: 0.0856, stage1_bag_acc: 99.2530, stage1_neg_loss: 0.0435, stage1_mean_ious: 0.4818, stage1_s: 0.0000, stage1_m: 0.0922, stage1_l: 0.3518, stage1_h: 0.5026, loss: 0.1388, grad_norm: 6.2630
2024-10-15 09:23:20,787 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:06, time: 1.730, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0048, stage0_bag_acc: 99.7841, stage0_mean_ious: 0.5421, stage0_s: 0.0077, stage0_m: 0.0679, stage0_l: 0.3107, stage0_h: 0.5651, stage1_loss_instance_mil: 0.0873, stage1_bag_acc: 99.9091, stage1_neg_loss: 0.0404, stage1_mean_ious: 0.4919, stage1_s: 0.0096, stage1_m: 0.0784, stage1_l: 0.3049, stage1_h: 0.5081, loss: 0.1325, grad_norm: 6.2130
2024-10-15 09:24:12,215 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 09:25:46,528 - mmdet - INFO - Evaluating bbox...
2024-10-15 09:25:47,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1144
2024-10-15 09:25:47,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3255
2024-10-15 09:25:47,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2029
2024-10-15 09:25:47,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1034
2024-10-15 09:25:47,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0612
2024-10-15 09:25:47,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0266
2024-10-15 09:25:47,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0021
2024-10-15 09:25:47,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0808
2024-10-15 09:25:47,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1355
2024-10-15 09:25:47,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2045
2024-10-15 09:25:47,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1924
2024-10-15 09:25:47,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4571
2024-10-15 09:25:47,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1924
2024-10-15 09:25:47,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1924
2024-10-15 09:25:47,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1759
2024-10-15 09:25:47,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2343
2024-10-15 09:25:47,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2300
2024-10-15 09:25:47,387 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 09:25:47,387 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 90, bbox_mAP: 0.1140, bbox_mAP_50: 0.3260, bbox_mAP_75: 0.2030, bbox_mAP_s: 0.1030, bbox_mAP_m: 0.0610, bbox_mAP_l: 0.0270, bbox_mAP_copypaste: 0.114 0.326 0.203 0.103 0.061 0.027
2024-10-15 09:27:16,954 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:58, time: 1.791, data_time: 0.076, memory: 18833, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.5523, stage0_s: 0.0000, stage0_m: 0.0590, stage0_l: 0.2766, stage0_h: 0.5775, stage1_loss_instance_mil: 0.0769, stage1_bag_acc: 99.6758, stage1_neg_loss: 0.0395, stage1_mean_ious: 0.5000, stage1_s: 0.0000, stage1_m: 0.0632, stage1_l: 0.2801, stage1_h: 0.5174, loss: 0.1223, grad_norm: 5.6555
2024-10-15 09:28:43,334 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:48, time: 1.728, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0080, stage0_bag_acc: 99.6819, stage0_mean_ious: 0.5472, stage0_s: 0.0000, stage0_m: 0.0527, stage0_l: 0.3072, stage0_h: 0.5865, stage1_loss_instance_mil: 0.0708, stage1_bag_acc: 99.4280, stage1_neg_loss: 0.0342, stage1_mean_ious: 0.4991, stage1_s: 0.0000, stage1_m: 0.0604, stage1_l: 0.3111, stage1_h: 0.5276, loss: 0.1131, grad_norm: 4.8173
2024-10-15 09:30:07,865 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:37, time: 1.691, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0032, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.5501, stage0_s: 0.0000, stage0_m: 0.0367, stage0_l: 0.2960, stage0_h: 0.5794, stage1_loss_instance_mil: 0.0769, stage1_bag_acc: 99.6170, stage1_neg_loss: 0.0386, stage1_mean_ious: 0.4912, stage1_s: 0.0000, stage1_m: 0.0420, stage1_l: 0.2958, stage1_h: 0.5122, loss: 0.1186, grad_norm: 4.9598
2024-10-15 09:30:58,487 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 09:32:30,257 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:34, time: 1.791, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.0041, stage0_bag_acc: 99.8089, stage0_mean_ious: 0.5482, stage0_s: 0.0000, stage0_m: 0.0583, stage0_l: 0.3132, stage0_h: 0.5724, stage1_loss_instance_mil: 0.0720, stage1_bag_acc: 99.5977, stage1_neg_loss: 0.0385, stage1_mean_ious: 0.4924, stage1_s: 0.0000, stage1_m: 0.0648, stage1_l: 0.2986, stage1_h: 0.5093, loss: 0.1146, grad_norm: 5.7095
2024-10-15 09:33:54,959 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:22, time: 1.694, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0062, stage0_bag_acc: 99.7841, stage0_mean_ious: 0.5470, stage0_s: 0.0000, stage0_m: 0.0500, stage0_l: 0.2628, stage0_h: 0.5807, stage1_loss_instance_mil: 0.0730, stage1_bag_acc: 99.3821, stage1_neg_loss: 0.0306, stage1_mean_ious: 0.5020, stage1_s: 0.0000, stage1_m: 0.0613, stage1_l: 0.2825, stage1_h: 0.5228, loss: 0.1097, grad_norm: 4.7485
2024-10-15 09:35:21,095 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:10, time: 1.723, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0019, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5548, stage0_s: 0.0000, stage0_m: 0.0566, stage0_l: 0.3406, stage0_h: 0.5757, stage1_loss_instance_mil: 0.0686, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0365, stage1_mean_ious: 0.4981, stage1_s: 0.0000, stage1_m: 0.0584, stage1_l: 0.3364, stage1_h: 0.5109, loss: 0.1069, grad_norm: 5.5449
2024-10-15 09:36:12,680 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 09:37:44,224 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:10, time: 1.785, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.0027, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.5413, stage0_s: 0.0000, stage0_m: 0.0456, stage0_l: 0.3770, stage0_h: 0.5613, stage1_loss_instance_mil: 0.0745, stage1_bag_acc: 99.8824, stage1_neg_loss: 0.0325, stage1_mean_ious: 0.4908, stage1_s: 0.0000, stage1_m: 0.0537, stage1_l: 0.3636, stage1_h: 0.5041, loss: 0.1097, grad_norm: 5.3439
2024-10-15 09:39:09,736 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:57, time: 1.710, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0041, stage0_bag_acc: 99.7046, stage0_mean_ious: 0.5462, stage0_s: 0.0000, stage0_m: 0.0753, stage0_l: 0.2917, stage0_h: 0.5867, stage1_loss_instance_mil: 0.0644, stage1_bag_acc: 99.6248, stage1_neg_loss: 0.0339, stage1_mean_ious: 0.4994, stage1_s: 0.0000, stage1_m: 0.0839, stage1_l: 0.3112, stage1_h: 0.5270, loss: 0.1024, grad_norm: 4.8896
2024-10-15 09:40:35,225 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.710, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0082, stage0_bag_acc: 99.6926, stage0_mean_ious: 0.5564, stage0_s: 0.0000, stage0_m: 0.0557, stage0_l: 0.2529, stage0_h: 0.5896, stage1_loss_instance_mil: 0.0626, stage1_bag_acc: 99.6926, stage1_neg_loss: 0.0406, stage1_mean_ious: 0.5066, stage1_s: 0.0000, stage1_m: 0.0647, stage1_l: 0.2620, stage1_h: 0.5320, loss: 0.1114, grad_norm: 5.9128
2024-10-15 09:41:26,282 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 09:42:58,441 - mmdet - INFO - Evaluating bbox...
2024-10-15 09:42:59,315 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1197
2024-10-15 09:42:59,315 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3396
2024-10-15 09:42:59,315 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2112
2024-10-15 09:42:59,315 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1120
2024-10-15 09:42:59,315 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0634
2024-10-15 09:42:59,315 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0280
2024-10-15 09:42:59,315 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0032
2024-10-15 09:42:59,315 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0702
2024-10-15 09:42:59,316 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1412
2024-10-15 09:42:59,316 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2050
2024-10-15 09:42:59,316 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1955
2024-10-15 09:42:59,316 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4662
2024-10-15 09:42:59,316 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1955
2024-10-15 09:42:59,316 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1955
2024-10-15 09:42:59,316 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1706
2024-10-15 09:42:59,316 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2335
2024-10-15 09:42:59,316 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2312
2024-10-15 09:42:59,331 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 09:42:59,331 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.1200, bbox_mAP_50: 0.3400, bbox_mAP_75: 0.2110, bbox_mAP_s: 0.1120, bbox_mAP_m: 0.0630, bbox_mAP_l: 0.0280, bbox_mAP_copypaste: 0.120 0.340 0.211 0.112 0.063 0.028
2024-10-15 09:44:30,156 - mmdet - INFO - Evaluating bbox...
2024-10-15 09:44:31,001 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1197
2024-10-15 09:44:31,001 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3396
2024-10-15 09:44:31,001 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2112
2024-10-15 09:44:31,001 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1120
2024-10-15 09:44:31,001 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0634
2024-10-15 09:44:31,001 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0280
2024-10-15 09:44:31,002 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0032
2024-10-15 09:44:31,002 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0702
2024-10-15 09:44:31,002 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1412
2024-10-15 09:44:31,002 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2050
2024-10-15 09:44:31,002 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1955
2024-10-15 09:44:31,002 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4662
2024-10-15 09:44:31,002 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1955
2024-10-15 09:44:31,002 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1955
2024-10-15 09:44:31,002 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1706
2024-10-15 09:44:31,002 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2335
2024-10-15 09:44:31,002 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2312
2024-10-15 09:44:32,373 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+bc04488
------------------------------------------------------------

2024-10-15 09:44:33,260 - mmdet - INFO - Distributed training: False
2024-10-15 09:44:34,150 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 09:44:35,081 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 09:44:35,081 - mmdet - INFO - Use load_from_local loader
2024-10-15 09:44:35,341 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 09:44:35,354 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 09:44:35,355 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 09:46:03,618 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:02:04, time: 1.765, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.7253, stage0_bag_acc: 21.0329, stage0_mean_ious: 0.3575, stage0_s: 0.0000, stage0_m: 0.0668, stage0_l: 0.3630, stage0_h: 0.3521, stage1_loss_instance_mil: 0.1598, stage1_bag_acc: 11.2107, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.3529, stage1_s: 0.0000, stage1_m: 0.0745, stage1_l: 0.3580, stage1_h: 0.3467, loss: 0.8904, grad_norm: 3.1846
2024-10-15 09:47:29,081 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:38, time: 1.709, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.6126, stage0_bag_acc: 47.7968, stage0_mean_ious: 0.3642, stage0_s: 0.0000, stage0_m: 0.1351, stage0_l: 0.3100, stage0_h: 0.3540, stage1_loss_instance_mil: 0.2119, stage1_bag_acc: 22.0093, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.3453, stage1_s: 0.0000, stage1_m: 0.1302, stage1_l: 0.2867, stage1_h: 0.3370, loss: 0.8311, grad_norm: 3.2285
2024-10-15 09:48:56,898 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:58:24, time: 1.756, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.3003, stage0_bag_acc: 84.0463, stage0_mean_ious: 0.3728, stage0_s: 0.0000, stage0_m: 0.0768, stage0_l: 0.3384, stage0_h: 0.3643, stage1_loss_instance_mil: 0.2994, stage1_bag_acc: 86.8580, stage1_neg_loss: 0.0645, stage1_mean_ious: 0.3598, stage1_s: 0.0000, stage1_m: 0.0656, stage1_l: 0.3405, stage1_h: 0.3493, loss: 0.6642, grad_norm: 9.2611
2024-10-15 09:49:48,994 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 09:51:19,968 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:55, time: 1.767, data_time: 0.075, memory: 18833, stage0_loss_instance_mil: 0.0805, stage0_bag_acc: 96.6724, stage0_mean_ious: 0.4034, stage0_s: 0.0000, stage0_m: 0.0440, stage0_l: 0.2706, stage0_h: 0.4125, stage1_loss_instance_mil: 0.3519, stage1_bag_acc: 97.0226, stage1_neg_loss: 0.0839, stage1_mean_ious: 0.3858, stage1_s: 0.0000, stage1_m: 0.0456, stage1_l: 0.2619, stage1_h: 0.3949, loss: 0.5163, grad_norm: 12.9325
2024-10-15 09:52:45,597 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:44, time: 1.713, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0500, stage0_bag_acc: 97.2632, stage0_mean_ious: 0.3752, stage0_s: 0.0000, stage0_m: 0.0640, stage0_l: 0.2568, stage0_h: 0.3947, stage1_loss_instance_mil: 0.3098, stage1_bag_acc: 97.6777, stage1_neg_loss: 0.0867, stage1_mean_ious: 0.3516, stage1_s: 0.0000, stage1_m: 0.0580, stage1_l: 0.2378, stage1_h: 0.3714, loss: 0.4465, grad_norm: 11.6233
2024-10-15 09:54:12,418 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:48:16, time: 1.736, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0440, stage0_bag_acc: 96.6113, stage0_mean_ious: 0.3996, stage0_s: 0.0080, stage0_m: 0.0788, stage0_l: 0.2051, stage0_h: 0.4285, stage1_loss_instance_mil: 0.2910, stage1_bag_acc: 98.3389, stage1_neg_loss: 0.0829, stage1_mean_ious: 0.3683, stage1_s: 0.0103, stage1_m: 0.0733, stage1_l: 0.1959, stage1_h: 0.3927, loss: 0.4178, grad_norm: 14.4315
2024-10-15 09:55:04,697 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 09:56:36,445 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:43:31, time: 1.790, data_time: 0.075, memory: 18833, stage0_loss_instance_mil: 0.0414, stage0_bag_acc: 97.7576, stage0_mean_ious: 0.3431, stage0_s: 0.0000, stage0_m: 0.0651, stage0_l: 0.1923, stage0_h: 0.3696, stage1_loss_instance_mil: 0.2822, stage1_bag_acc: 97.1843, stage1_neg_loss: 0.0840, stage1_mean_ious: 0.3303, stage1_s: 0.0000, stage1_m: 0.0659, stage1_l: 0.1959, stage1_h: 0.3524, loss: 0.4077, grad_norm: 14.6133
2024-10-15 09:58:01,793 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:56, time: 1.707, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0338, stage0_bag_acc: 98.3402, stage0_mean_ious: 0.3611, stage0_s: 0.0000, stage0_m: 0.0483, stage0_l: 0.1325, stage0_h: 0.3879, stage1_loss_instance_mil: 0.3088, stage1_bag_acc: 99.1233, stage1_neg_loss: 0.0846, stage1_mean_ious: 0.3339, stage1_s: 0.0000, stage1_m: 0.0470, stage1_l: 0.1307, stage1_h: 0.3554, loss: 0.4272, grad_norm: 15.2916
2024-10-15 09:59:29,111 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:42:18, time: 1.746, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0177, stage0_bag_acc: 99.3291, stage0_mean_ious: 0.3940, stage0_s: 0.0000, stage0_m: 0.0273, stage0_l: 0.2128, stage0_h: 0.4118, stage1_loss_instance_mil: 0.2493, stage1_bag_acc: 99.1320, stage1_neg_loss: 0.0766, stage1_mean_ious: 0.3535, stage1_s: 0.0000, stage1_m: 0.0219, stage1_l: 0.1993, stage1_h: 0.3687, loss: 0.3436, grad_norm: 13.2119
2024-10-15 10:00:22,778 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 10:01:54,850 - mmdet - INFO - Evaluating bbox...
2024-10-15 10:01:55,722 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0193
2024-10-15 10:01:55,722 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0899
2024-10-15 10:01:55,722 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0270
2024-10-15 10:01:55,722 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0060
2024-10-15 10:01:55,722 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0030
2024-10-15 10:01:55,722 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0020
2024-10-15 10:01:55,722 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-15 10:01:55,723 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0283
2024-10-15 10:01:55,723 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0272
2024-10-15 10:01:55,723 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0030
2024-10-15 10:01:55,723 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0656
2024-10-15 10:01:55,723 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2235
2024-10-15 10:01:55,723 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0656
2024-10-15 10:01:55,723 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0656
2024-10-15 10:01:55,723 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0784
2024-10-15 10:01:55,723 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0877
2024-10-15 10:01:55,723 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0030
2024-10-15 10:01:55,738 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 10:01:55,738 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 90, bbox_mAP: 0.0190, bbox_mAP_50: 0.0900, bbox_mAP_75: 0.0270, bbox_mAP_s: 0.0060, bbox_mAP_m: 0.0030, bbox_mAP_l: 0.0020, bbox_mAP_copypaste: 0.019 0.090 0.027 0.006 0.003 0.002
2024-10-15 10:03:25,027 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:45, time: 1.785, data_time: 0.074, memory: 18833, stage0_loss_instance_mil: 0.0261, stage0_bag_acc: 98.8853, stage0_mean_ious: 0.4255, stage0_s: 0.0000, stage0_m: 0.0682, stage0_l: 0.2276, stage0_h: 0.4501, stage1_loss_instance_mil: 0.2201, stage1_bag_acc: 98.9138, stage1_neg_loss: 0.0676, stage1_mean_ious: 0.3836, stage1_s: 0.0000, stage1_m: 0.0638, stage1_l: 0.2453, stage1_h: 0.4005, loss: 0.3138, grad_norm: 11.9443
2024-10-15 10:04:51,130 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:59, time: 1.722, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0342, stage0_bag_acc: 97.6281, stage0_mean_ious: 0.4293, stage0_s: 0.0000, stage0_m: 0.0364, stage0_l: 0.2678, stage0_h: 0.4510, stage1_loss_instance_mil: 0.2027, stage1_bag_acc: 98.5121, stage1_neg_loss: 0.0684, stage1_mean_ious: 0.3915, stage1_s: 0.0000, stage1_m: 0.0408, stage1_l: 0.2711, stage1_h: 0.4060, loss: 0.3053, grad_norm: 10.7576
2024-10-15 10:06:16,822 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:07, time: 1.714, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0138, stage0_bag_acc: 99.4333, stage0_mean_ious: 0.4760, stage0_s: 0.0081, stage0_m: 0.0496, stage0_l: 0.2349, stage0_h: 0.5116, stage1_loss_instance_mil: 0.1953, stage1_bag_acc: 99.3743, stage1_neg_loss: 0.0712, stage1_mean_ious: 0.4209, stage1_s: 0.0091, stage1_m: 0.0487, stage1_l: 0.2416, stage1_h: 0.4464, loss: 0.2803, grad_norm: 12.7997
2024-10-15 10:07:08,779 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 10:08:37,959 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:04, time: 1.739, data_time: 0.077, memory: 18833, stage0_loss_instance_mil: 0.0077, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.5057, stage0_s: 0.0000, stage0_m: 0.0706, stage0_l: 0.2963, stage0_h: 0.5346, stage1_loss_instance_mil: 0.1483, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0516, stage1_mean_ious: 0.4570, stage1_s: 0.0000, stage1_m: 0.0701, stage1_l: 0.3063, stage1_h: 0.4763, loss: 0.2075, grad_norm: 9.3361
2024-10-15 10:10:04,118 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:11, time: 1.723, data_time: 0.025, memory: 18833, stage0_loss_instance_mil: 0.0183, stage0_bag_acc: 98.5529, stage0_mean_ious: 0.4718, stage0_s: 0.0000, stage0_m: 0.0585, stage0_l: 0.2972, stage0_h: 0.4914, stage1_loss_instance_mil: 0.1737, stage1_bag_acc: 99.3431, stage1_neg_loss: 0.0617, stage1_mean_ious: 0.4298, stage1_s: 0.0000, stage1_m: 0.0621, stage1_l: 0.2873, stage1_h: 0.4442, loss: 0.2537, grad_norm: 11.5215
2024-10-15 10:11:29,983 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:14, time: 1.717, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0147, stage0_bag_acc: 99.0923, stage0_mean_ious: 0.5093, stage0_s: 0.0000, stage0_m: 0.1079, stage0_l: 0.2918, stage0_h: 0.5426, stage1_loss_instance_mil: 0.1339, stage1_bag_acc: 99.4242, stage1_neg_loss: 0.0528, stage1_mean_ious: 0.4671, stage1_s: 0.0000, stage1_m: 0.1195, stage1_l: 0.3006, stage1_h: 0.4921, loss: 0.2014, grad_norm: 9.6019
2024-10-15 10:12:22,349 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 10:13:54,467 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:36, time: 1.806, data_time: 0.075, memory: 18833, stage0_loss_instance_mil: 0.0099, stage0_bag_acc: 99.7460, stage0_mean_ious: 0.4647, stage0_s: 0.0000, stage0_m: 0.0457, stage0_l: 0.3899, stage0_h: 0.4761, stage1_loss_instance_mil: 0.1500, stage1_bag_acc: 99.5675, stage1_neg_loss: 0.0553, stage1_mean_ious: 0.4296, stage1_s: 0.0000, stage1_m: 0.0424, stage1_l: 0.3823, stage1_h: 0.4354, loss: 0.2152, grad_norm: 10.4807
2024-10-15 10:15:20,797 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 10:15:20,798 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:38, time: 1.727, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0062, stage0_bag_acc: 99.8322, stage0_mean_ious: 0.4929, stage0_s: 0.0081, stage0_m: 0.0787, stage0_l: 0.2896, stage0_h: 0.5063, stage1_loss_instance_mil: 0.1582, stage1_bag_acc: 99.7490, stage1_neg_loss: 0.0526, stage1_mean_ious: 0.4533, stage1_s: 0.0101, stage1_m: 0.0786, stage1_l: 0.2900, stage1_h: 0.4616, loss: 0.2170, grad_norm: 9.6753
2024-10-15 10:16:46,799 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:36, time: 1.720, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0128, stage0_bag_acc: 99.0595, stage0_mean_ious: 0.4645, stage0_s: 0.0000, stage0_m: 0.0946, stage0_l: 0.2843, stage0_h: 0.4861, stage1_loss_instance_mil: 0.1596, stage1_bag_acc: 98.9620, stage1_neg_loss: 0.0562, stage1_mean_ious: 0.4284, stage1_s: 0.0000, stage1_m: 0.0919, stage1_l: 0.2826, stage1_h: 0.4427, loss: 0.2286, grad_norm: 9.7944
2024-10-15 10:17:38,260 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 10:19:10,435 - mmdet - INFO - Evaluating bbox...
2024-10-15 10:19:11,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0886
2024-10-15 10:19:11,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2508
2024-10-15 10:19:11,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1669
2024-10-15 10:19:11,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0780
2024-10-15 10:19:11,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0370
2024-10-15 10:19:11,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0157
2024-10-15 10:19:11,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0011
2024-10-15 10:19:11,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0510
2024-10-15 10:19:11,292 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1003
2024-10-15 10:19:11,292 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1035
2024-10-15 10:19:11,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1493
2024-10-15 10:19:11,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3791
2024-10-15 10:19:11,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1493
2024-10-15 10:19:11,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1493
2024-10-15 10:19:11,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1279
2024-10-15 10:19:11,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1663
2024-10-15 10:19:11,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1144
2024-10-15 10:19:11,307 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 10:19:11,307 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0890, bbox_mAP_50: 0.2510, bbox_mAP_75: 0.1670, bbox_mAP_s: 0.0780, bbox_mAP_m: 0.0370, bbox_mAP_l: 0.0160, bbox_mAP_copypaste: 0.089 0.251 0.167 0.078 0.037 0.016
2024-10-15 10:20:38,362 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:07, time: 1.741, data_time: 0.075, memory: 18833, stage0_loss_instance_mil: 0.0079, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.4884, stage0_s: 0.0000, stage0_m: 0.0599, stage0_l: 0.3304, stage0_h: 0.4989, stage1_loss_instance_mil: 0.1151, stage1_bag_acc: 99.7574, stage1_neg_loss: 0.0480, stage1_mean_ious: 0.4475, stage1_s: 0.0000, stage1_m: 0.0608, stage1_l: 0.3156, stage1_h: 0.4548, loss: 0.1710, grad_norm: 7.6389
2024-10-15 10:22:04,764 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:05, time: 1.728, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0102, stage0_bag_acc: 99.6539, stage0_mean_ious: 0.4777, stage0_s: 0.0000, stage0_m: 0.1099, stage0_l: 0.3003, stage0_h: 0.4989, stage1_loss_instance_mil: 0.1064, stage1_bag_acc: 99.6018, stage1_neg_loss: 0.0431, stage1_mean_ious: 0.4350, stage1_s: 0.0000, stage1_m: 0.1057, stage1_l: 0.2947, stage1_h: 0.4487, loss: 0.1597, grad_norm: 5.9201
2024-10-15 10:23:32,585 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:23:02, time: 1.756, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0045, stage0_bag_acc: 99.8322, stage0_mean_ious: 0.4470, stage0_s: 0.0000, stage0_m: 0.1152, stage0_l: 0.2949, stage0_h: 0.4667, stage1_loss_instance_mil: 0.1069, stage1_bag_acc: 99.8182, stage1_neg_loss: 0.0452, stage1_mean_ious: 0.4105, stage1_s: 0.0000, stage1_m: 0.1214, stage1_l: 0.3040, stage1_h: 0.4204, loss: 0.1566, grad_norm: 6.3978
2024-10-15 10:24:25,087 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 10:25:56,091 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:43, time: 1.776, data_time: 0.075, memory: 18833, stage0_loss_instance_mil: 0.0053, stage0_bag_acc: 99.7841, stage0_mean_ious: 0.3898, stage0_s: 0.0000, stage0_m: 0.0610, stage0_l: 0.2653, stage0_h: 0.4048, stage1_loss_instance_mil: 0.1230, stage1_bag_acc: 99.8036, stage1_neg_loss: 0.0556, stage1_mean_ious: 0.3649, stage1_s: 0.0000, stage1_m: 0.0642, stage1_l: 0.2774, stage1_h: 0.3731, loss: 0.1839, grad_norm: 7.5487
2024-10-15 10:27:23,231 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:39, time: 1.743, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0076, stage0_bag_acc: 99.5631, stage0_mean_ious: 0.4266, stage0_s: 0.0000, stage0_m: 0.0597, stage0_l: 0.2560, stage0_h: 0.4455, stage1_loss_instance_mil: 0.0974, stage1_bag_acc: 99.6583, stage1_neg_loss: 0.0426, stage1_mean_ious: 0.3934, stage1_s: 0.0000, stage1_m: 0.0720, stage1_l: 0.2590, stage1_h: 0.4056, loss: 0.1477, grad_norm: 5.9117
2024-10-15 10:28:50,378 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:32, time: 1.743, data_time: 0.027, memory: 18833, stage0_loss_instance_mil: 0.0029, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4705, stage0_s: 0.0000, stage0_m: 0.0688, stage0_l: 0.3465, stage0_h: 0.4856, stage1_loss_instance_mil: 0.0999, stage1_bag_acc: 99.7005, stage1_neg_loss: 0.0434, stage1_mean_ious: 0.4344, stage1_s: 0.0000, stage1_m: 0.0717, stage1_l: 0.3482, stage1_h: 0.4432, loss: 0.1462, grad_norm: 6.5944
2024-10-15 10:29:43,522 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 10:31:13,782 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:20, time: 1.761, data_time: 0.075, memory: 18833, stage0_loss_instance_mil: 0.0041, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4155, stage0_s: 0.0000, stage0_m: 0.1081, stage0_l: 0.2652, stage0_h: 0.4332, stage1_loss_instance_mil: 0.1031, stage1_bag_acc: 99.7889, stage1_neg_loss: 0.0483, stage1_mean_ious: 0.3833, stage1_s: 0.0000, stage1_m: 0.1117, stage1_l: 0.2746, stage1_h: 0.3933, loss: 0.1555, grad_norm: 5.8503
2024-10-15 10:32:41,251 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:12, time: 1.749, data_time: 0.026, memory: 18833, stage0_loss_instance_mil: 0.0022, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4740, stage0_s: 0.0000, stage0_m: 0.0698, stage0_l: 0.3137, stage0_h: 0.4929, stage1_loss_instance_mil: 0.0871, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0397, stage1_mean_ious: 0.4416, stage1_s: 0.0000, stage1_m: 0.0743, stage1_l: 0.3045, stage1_h: 0.4554, loss: 0.1290, grad_norm: 4.4656
2024-10-15 10:34:10,462 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:04, time: 1.784, data_time: 0.028, memory: 18833, stage0_loss_instance_mil: 0.0062, stage0_bag_acc: 99.7841, stage0_mean_ious: 0.4471, stage0_s: 0.0000, stage0_m: 0.0780, stage0_l: 0.2682, stage0_h: 0.4593, stage1_loss_instance_mil: 0.0855, stage1_bag_acc: 99.5396, stage1_neg_loss: 0.0372, stage1_mean_ious: 0.4153, stage1_s: 0.0000, stage1_m: 0.0801, stage1_l: 0.2745, stage1_h: 0.4227, loss: 0.1289, grad_norm: 4.2595
