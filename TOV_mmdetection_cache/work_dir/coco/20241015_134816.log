2024-10-15 13:48:16,067 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+d7eacca
------------------------------------------------------------

2024-10-15 13:48:16,962 - mmdet - INFO - Distributed training: False
2024-10-15 13:48:17,851 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 13:48:20,909 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 13:48:20,909 - mmdet - INFO - Use load_from_local loader
2024-10-15 13:48:21,197 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 13:48:21,204 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 13:48:21,204 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 13:48:50,198 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:31:59, time: 0.580, data_time: 0.057, memory: 6878, stage0_loss_instance_mil: 0.7145, stage0_bag_acc: 20.5298, stage0_mean_ious: 0.0494, stage0_s: 0.0484, stage0_m: 0.0274, stage0_l: 0.0006, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1614, stage1_bag_acc: 11.9000, stage1_neg_loss: 0.0009, stage1_mean_ious: 0.0515, stage1_s: 0.0497, stage1_m: 0.0307, stage1_l: 0.0006, stage1_h: 0.0000, loss: 0.8767, grad_norm: 6.0437
2024-10-15 13:49:14,993 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:29:13, time: 0.496, data_time: 0.008, memory: 6938, stage0_loss_instance_mil: 0.7041, stage0_bag_acc: 20.3091, stage0_mean_ious: 0.0710, stage0_s: 0.0568, stage0_m: 0.0513, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1639, stage1_bag_acc: 12.9217, stage1_neg_loss: 0.0012, stage1_mean_ious: 0.0727, stage1_s: 0.0569, stage1_m: 0.0553, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8692, grad_norm: 6.5534
2024-10-15 13:49:40,018 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:28:06, time: 0.500, data_time: 0.008, memory: 7785, stage0_loss_instance_mil: 0.6969, stage0_bag_acc: 18.4121, stage0_mean_ious: 0.0979, stage0_s: 0.0894, stage0_m: 0.0824, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1525, stage1_bag_acc: 14.7253, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.0997, stage1_s: 0.0899, stage1_m: 0.0900, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8527, grad_norm: 7.3693
2024-10-15 13:50:04,129 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:27:06, time: 0.482, data_time: 0.008, memory: 7785, stage0_loss_instance_mil: 0.6352, stage0_bag_acc: 28.9286, stage0_mean_ious: 0.1627, stage0_s: 0.1281, stage0_m: 0.1327, stage0_l: 0.0115, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1358, stage1_bag_acc: 29.9056, stage1_neg_loss: 0.0180, stage1_mean_ious: 0.1633, stage1_s: 0.1237, stage1_m: 0.1397, stage1_l: 0.0128, stage1_h: 0.0000, loss: 0.7889, grad_norm: 10.5984
2024-10-15 13:50:29,805 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:26:39, time: 0.514, data_time: 0.008, memory: 7785, stage0_loss_instance_mil: 0.6038, stage0_bag_acc: 30.7000, stage0_mean_ious: 0.1485, stage0_s: 0.1238, stage0_m: 0.1094, stage0_l: 0.0123, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1421, stage1_bag_acc: 45.1199, stage1_neg_loss: 0.0199, stage1_mean_ious: 0.1610, stage1_s: 0.1365, stage1_m: 0.1166, stage1_l: 0.0078, stage1_h: 0.0000, loss: 0.7659, grad_norm: 11.0857
2024-10-15 13:50:45,640 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 13:51:15,055 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:23:50, time: 0.544, data_time: 0.055, memory: 7785, stage0_loss_instance_mil: 0.5091, stage0_bag_acc: 42.4460, stage0_mean_ious: 0.2654, stage0_s: 0.2243, stage0_m: 0.2188, stage0_l: 0.0209, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1056, stage1_bag_acc: 50.5349, stage1_neg_loss: 0.0235, stage1_mean_ious: 0.3137, stage1_s: 0.2736, stage1_m: 0.2486, stage1_l: 0.0250, stage1_h: 0.0000, loss: 0.6382, grad_norm: 10.7382
2024-10-15 13:51:40,931 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:23:44, time: 0.518, data_time: 0.009, memory: 7785, stage0_loss_instance_mil: 0.4462, stage0_bag_acc: 55.9434, stage0_mean_ious: 0.3062, stage0_s: 0.2690, stage0_m: 0.2203, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0877, stage1_bag_acc: 52.2016, stage1_neg_loss: 0.0168, stage1_mean_ious: 0.3992, stage1_s: 0.3684, stage1_m: 0.2577, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5507, grad_norm: 11.6439
2024-10-15 13:52:06,496 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:23:31, time: 0.511, data_time: 0.008, memory: 7785, stage0_loss_instance_mil: 0.3219, stage0_bag_acc: 71.9608, stage0_mean_ious: 0.3631, stage0_s: 0.2976, stage0_m: 0.3243, stage0_l: 0.0250, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0897, stage1_bag_acc: 71.3321, stage1_neg_loss: 0.0226, stage1_mean_ious: 0.4634, stage1_s: 0.4098, stage1_m: 0.3702, stage1_l: 0.0161, stage1_h: 0.0000, loss: 0.4342, grad_norm: 12.3206
2024-10-15 13:52:33,368 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:23:24, time: 0.537, data_time: 0.008, memory: 7785, stage0_loss_instance_mil: 0.2290, stage0_bag_acc: 81.2675, stage0_mean_ious: 0.4479, stage0_s: 0.3691, stage0_m: 0.4063, stage0_l: 0.0403, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0706, stage1_bag_acc: 83.3865, stage1_neg_loss: 0.0168, stage1_mean_ious: 0.5392, stage1_s: 0.4885, stage1_m: 0.4180, stage1_l: 0.0292, stage1_h: 0.0000, loss: 0.3163, grad_norm: 10.5333
2024-10-15 13:52:57,817 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:23:00, time: 0.489, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.1721, stage0_bag_acc: 86.3848, stage0_mean_ious: 0.4629, stage0_s: 0.3889, stage0_m: 0.3444, stage0_l: 0.0199, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0503, stage1_bag_acc: 87.0227, stage1_neg_loss: 0.0186, stage1_mean_ious: 0.5339, stage1_s: 0.4989, stage1_m: 0.3218, stage1_l: 0.0145, stage1_h: 0.0000, loss: 0.2410, grad_norm: 8.4609
2024-10-15 13:53:12,910 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 13:53:42,379 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:21:30, time: 0.553, data_time: 0.057, memory: 7787, stage0_loss_instance_mil: 0.1154, stage0_bag_acc: 92.3698, stage0_mean_ious: 0.4443, stage0_s: 0.3933, stage0_m: 0.3681, stage0_l: 0.0101, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0396, stage1_bag_acc: 93.4944, stage1_neg_loss: 0.0131, stage1_mean_ious: 0.5640, stage1_s: 0.5409, stage1_m: 0.3610, stage1_l: 0.0078, stage1_h: 0.0000, loss: 0.1682, grad_norm: 7.0223
2024-10-15 13:54:07,478 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:21:13, time: 0.502, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.1160, stage0_bag_acc: 89.8278, stage0_mean_ious: 0.4794, stage0_s: 0.4400, stage0_m: 0.3763, stage0_l: 0.0202, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0334, stage1_bag_acc: 91.1278, stage1_neg_loss: 0.0114, stage1_mean_ious: 0.5557, stage1_s: 0.5497, stage1_m: 0.3559, stage1_l: 0.0153, stage1_h: 0.0000, loss: 0.1607, grad_norm: 6.9447
2024-10-15 13:54:33,830 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:21:00, time: 0.527, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.1418, stage0_bag_acc: 88.7285, stage0_mean_ious: 0.4458, stage0_s: 0.3881, stage0_m: 0.4153, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0392, stage1_bag_acc: 89.4824, stage1_neg_loss: 0.0094, stage1_mean_ious: 0.5452, stage1_s: 0.5233, stage1_m: 0.4289, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1904, grad_norm: 7.0647
2024-10-15 13:54:59,329 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:20:42, time: 0.510, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.1314, stage0_bag_acc: 88.5195, stage0_mean_ious: 0.4467, stage0_s: 0.4118, stage0_m: 0.2737, stage0_l: 0.0218, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0345, stage1_bag_acc: 90.7052, stage1_neg_loss: 0.0119, stage1_mean_ious: 0.5623, stage1_s: 0.5496, stage1_m: 0.2556, stage1_l: 0.0215, stage1_h: 0.0000, loss: 0.1778, grad_norm: 7.8300
2024-10-15 13:55:25,446 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:20:25, time: 0.522, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.1115, stage0_bag_acc: 91.9388, stage0_mean_ious: 0.4866, stage0_s: 0.4241, stage0_m: 0.3487, stage0_l: 0.0375, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0235, stage1_bag_acc: 91.9610, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.5800, stage1_s: 0.5621, stage1_m: 0.3284, stage1_l: 0.0270, stage1_h: 0.0000, loss: 0.1431, grad_norm: 5.4804
2024-10-15 13:55:41,587 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 13:57:00,017 - mmdet - INFO - Evaluating bbox...
2024-10-15 13:57:00,594 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2037
2024-10-15 13:57:00,595 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6564
2024-10-15 13:57:00,595 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3824
2024-10-15 13:57:00,595 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1333
2024-10-15 13:57:00,595 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0632
2024-10-15 13:57:00,595 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0229
2024-10-15 13:57:00,595 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 13:57:00,595 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:57:00,595 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2145
2024-10-15 13:57:00,595 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0592
2024-10-15 13:57:00,595 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3141
2024-10-15 13:57:00,596 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7763
2024-10-15 13:57:00,596 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3141
2024-10-15 13:57:00,596 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3141
2024-10-15 13:57:00,596 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:57:00,596 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3347
2024-10-15 13:57:00,596 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0732
2024-10-15 13:57:00,602 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 13:57:00,602 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2040, bbox_mAP_50: 0.6560, bbox_mAP_75: 0.3820, bbox_mAP_s: 0.1330, bbox_mAP_m: 0.0630, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.204 0.656 0.382 0.133 0.063 0.023
2024-10-15 13:57:27,980 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:19:16, time: 0.547, data_time: 0.058, memory: 7787, stage0_loss_instance_mil: 0.0691, stage0_bag_acc: 93.7115, stage0_mean_ious: 0.4869, stage0_s: 0.4440, stage0_m: 0.3789, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0198, stage1_bag_acc: 95.7100, stage1_neg_loss: 0.0170, stage1_mean_ious: 0.5702, stage1_s: 0.5790, stage1_m: 0.3320, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1060, grad_norm: 5.3754
2024-10-15 13:57:53,885 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:18:59, time: 0.518, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0817, stage0_bag_acc: 94.1197, stage0_mean_ious: 0.4634, stage0_s: 0.4093, stage0_m: 0.3780, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0246, stage1_bag_acc: 93.9864, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5839, stage1_s: 0.5701, stage1_m: 0.3885, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1152, grad_norm: 4.8589
2024-10-15 13:58:20,262 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:18:42, time: 0.528, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0521, stage0_bag_acc: 95.5833, stage0_mean_ious: 0.4887, stage0_s: 0.4379, stage0_m: 0.3884, stage0_l: 0.0073, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0187, stage1_bag_acc: 95.9833, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5874, stage1_s: 0.5786, stage1_m: 0.3598, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0776, grad_norm: 4.1987
2024-10-15 13:58:46,106 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:18:23, time: 0.517, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0723, stage0_bag_acc: 94.2333, stage0_mean_ious: 0.4856, stage0_s: 0.4332, stage0_m: 0.3972, stage0_l: 0.0070, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0242, stage1_bag_acc: 95.2667, stage1_neg_loss: 0.0123, stage1_mean_ious: 0.5777, stage1_s: 0.5697, stage1_m: 0.3689, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.1088, grad_norm: 5.8381
2024-10-15 13:59:10,877 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:18:01, time: 0.495, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0965, stage0_bag_acc: 93.5198, stage0_mean_ious: 0.4786, stage0_s: 0.4335, stage0_m: 0.3211, stage0_l: 0.0184, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0295, stage1_bag_acc: 93.1230, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5741, stage1_s: 0.5620, stage1_m: 0.3089, stage1_l: 0.0116, stage1_h: 0.0000, loss: 0.1319, grad_norm: 5.8935
2024-10-15 13:59:26,482 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 13:59:56,053 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:17:03, time: 0.547, data_time: 0.055, memory: 7787, stage0_loss_instance_mil: 0.0515, stage0_bag_acc: 95.6667, stage0_mean_ious: 0.5115, stage0_s: 0.4961, stage0_m: 0.3128, stage0_l: 0.0066, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0141, stage1_bag_acc: 97.1167, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5809, stage1_s: 0.5874, stage1_m: 0.2959, stage1_l: 0.0050, stage1_h: 0.0000, loss: 0.0729, grad_norm: 3.4940
2024-10-15 14:00:21,900 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:16:44, time: 0.517, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0485, stage0_bag_acc: 96.0667, stage0_mean_ious: 0.4898, stage0_s: 0.4154, stage0_m: 0.4246, stage0_l: 0.0134, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0155, stage1_bag_acc: 96.3167, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5904, stage1_s: 0.5749, stage1_m: 0.4109, stage1_l: 0.0111, stage1_h: 0.0000, loss: 0.0680, grad_norm: 3.2817
2024-10-15 14:00:46,275 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:16:22, time: 0.487, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0656, stage0_bag_acc: 94.6293, stage0_mean_ious: 0.4722, stage0_s: 0.4368, stage0_m: 0.3819, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0222, stage1_bag_acc: 94.3308, stage1_neg_loss: 0.0079, stage1_mean_ious: 0.5697, stage1_s: 0.5708, stage1_m: 0.3580, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.0956, grad_norm: 4.6168
2024-10-15 14:01:12,204 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:16:02, time: 0.519, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0779, stage0_bag_acc: 93.9675, stage0_mean_ious: 0.4879, stage0_s: 0.4313, stage0_m: 0.3738, stage0_l: 0.0125, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0182, stage1_bag_acc: 94.3175, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5862, stage1_s: 0.5692, stage1_m: 0.3645, stage1_l: 0.0097, stage1_h: 0.0000, loss: 0.1041, grad_norm: 5.4840
2024-10-15 14:01:38,145 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:15:42, time: 0.519, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0669, stage0_bag_acc: 95.6143, stage0_mean_ious: 0.4911, stage0_s: 0.4592, stage0_m: 0.3631, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0156, stage1_bag_acc: 97.0643, stage1_neg_loss: 0.0161, stage1_mean_ious: 0.5887, stage1_s: 0.5904, stage1_m: 0.3653, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.0986, grad_norm: 4.7398
2024-10-15 14:01:53,700 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 14:02:25,211 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:14:53, time: 0.583, data_time: 0.057, memory: 7787, stage0_loss_instance_mil: 0.0567, stage0_bag_acc: 96.1778, stage0_mean_ious: 0.4956, stage0_s: 0.4559, stage0_m: 0.4194, stage0_l: 0.0396, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0173, stage1_bag_acc: 95.3278, stage1_neg_loss: 0.0095, stage1_mean_ious: 0.5747, stage1_s: 0.5745, stage1_m: 0.4213, stage1_l: 0.0276, stage1_h: 0.0000, loss: 0.0835, grad_norm: 3.7118
2024-10-15 14:02:50,618 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:14:32, time: 0.508, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0500, stage0_bag_acc: 96.0846, stage0_mean_ious: 0.4775, stage0_s: 0.4072, stage0_m: 0.3291, stage0_l: 0.0096, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0123, stage1_bag_acc: 95.8346, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5556, stage1_s: 0.5164, stage1_m: 0.3104, stage1_l: 0.0071, stage1_h: 0.0000, loss: 0.0671, grad_norm: 3.5825
2024-10-15 14:03:16,247 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:14:11, time: 0.513, data_time: 0.010, memory: 7787, stage0_loss_instance_mil: 0.0748, stage0_bag_acc: 93.5316, stage0_mean_ious: 0.4784, stage0_s: 0.4275, stage0_m: 0.3056, stage0_l: 0.0175, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0207, stage1_bag_acc: 94.8816, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5596, stage1_s: 0.5409, stage1_m: 0.3003, stage1_l: 0.0111, stage1_h: 0.0000, loss: 0.0985, grad_norm: 4.8805
2024-10-15 14:03:41,718 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:13:50, time: 0.509, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0829, stage0_bag_acc: 92.7841, stage0_mean_ious: 0.4727, stage0_s: 0.4350, stage0_m: 0.2728, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0269, stage1_bag_acc: 93.7341, stage1_neg_loss: 0.0137, stage1_mean_ious: 0.5830, stage1_s: 0.5764, stage1_m: 0.2783, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1235, grad_norm: 5.9234
2024-10-15 14:04:06,506 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:13:27, time: 0.496, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0552, stage0_bag_acc: 95.5286, stage0_mean_ious: 0.5093, stage0_s: 0.4651, stage0_m: 0.3257, stage0_l: 0.0108, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0118, stage1_bag_acc: 96.8000, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5843, stage1_s: 0.5849, stage1_m: 0.3006, stage1_l: 0.0065, stage1_h: 0.0000, loss: 0.0724, grad_norm: 3.3586
2024-10-15 14:04:21,957 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 14:05:39,486 - mmdet - INFO - Evaluating bbox...
2024-10-15 14:05:39,988 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2051
2024-10-15 14:05:39,989 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6600
2024-10-15 14:05:39,989 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3895
2024-10-15 14:05:39,989 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1327
2024-10-15 14:05:39,989 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0592
2024-10-15 14:05:39,989 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0219
2024-10-15 14:05:39,989 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0008
2024-10-15 14:05:39,989 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:05:39,989 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2164
2024-10-15 14:05:39,989 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0712
2024-10-15 14:05:39,990 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3075
2024-10-15 14:05:39,990 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7684
2024-10-15 14:05:39,990 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3075
2024-10-15 14:05:39,990 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3075
2024-10-15 14:05:39,990 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:05:39,990 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3267
2024-10-15 14:05:39,990 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1023
2024-10-15 14:05:39,995 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 14:05:39,995 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2050, bbox_mAP_50: 0.6600, bbox_mAP_75: 0.3900, bbox_mAP_s: 0.1330, bbox_mAP_m: 0.0590, bbox_mAP_l: 0.0220, bbox_mAP_copypaste: 0.205 0.660 0.390 0.133 0.059 0.022
2024-10-15 14:06:08,117 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:12:40, time: 0.562, data_time: 0.058, memory: 7787, stage0_loss_instance_mil: 0.0412, stage0_bag_acc: 96.6491, stage0_mean_ious: 0.4616, stage0_s: 0.3950, stage0_m: 0.2799, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0147, stage1_bag_acc: 96.2649, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5517, stage1_s: 0.5140, stage1_m: 0.2664, stage1_l: 0.0080, stage1_h: 0.0000, loss: 0.0620, grad_norm: 3.4170
2024-10-15 14:06:33,595 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:12:19, time: 0.510, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0409, stage0_bag_acc: 96.6976, stage0_mean_ious: 0.4906, stage0_s: 0.4636, stage0_m: 0.3020, stage0_l: 0.0196, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0130, stage1_bag_acc: 96.8976, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5858, stage1_s: 0.5713, stage1_m: 0.3111, stage1_l: 0.0122, stage1_h: 0.0000, loss: 0.0590, grad_norm: 3.7102
2024-10-15 14:06:58,850 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:11:57, time: 0.505, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0500, stage0_bag_acc: 97.2278, stage0_mean_ious: 0.4852, stage0_s: 0.4405, stage0_m: 0.4063, stage0_l: 0.0100, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0169, stage1_bag_acc: 97.2778, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.5688, stage1_s: 0.5592, stage1_m: 0.3801, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.0749, grad_norm: 3.7847
2024-10-15 14:07:24,492 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:11:35, time: 0.513, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0323, stage0_bag_acc: 97.3786, stage0_mean_ious: 0.5169, stage0_s: 0.4663, stage0_m: 0.4136, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0128, stage1_bag_acc: 97.9429, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5851, stage1_s: 0.5772, stage1_m: 0.3966, stage1_l: 0.0047, stage1_h: 0.0000, loss: 0.0513, grad_norm: 3.0455
2024-10-15 14:07:50,134 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:11:13, time: 0.513, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0467, stage0_bag_acc: 96.9833, stage0_mean_ious: 0.4844, stage0_s: 0.4413, stage0_m: 0.3656, stage0_l: 0.0138, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0164, stage1_bag_acc: 97.0778, stage1_neg_loss: 0.0113, stage1_mean_ious: 0.5593, stage1_s: 0.5417, stage1_m: 0.3738, stage1_l: 0.0117, stage1_h: 0.0000, loss: 0.0744, grad_norm: 3.7215
2024-10-15 14:08:06,321 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 14:08:37,773 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:10:30, time: 0.584, data_time: 0.058, memory: 7787, stage0_loss_instance_mil: 0.0425, stage0_bag_acc: 96.5500, stage0_mean_ious: 0.5031, stage0_s: 0.4299, stage0_m: 0.3853, stage0_l: 0.0452, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0159, stage1_bag_acc: 97.3000, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.5845, stage1_s: 0.5405, stage1_m: 0.3748, stage1_l: 0.0267, stage1_h: 0.0000, loss: 0.0668, grad_norm: 3.5491
2024-10-15 14:09:03,949 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:10:08, time: 0.524, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0291, stage0_bag_acc: 97.3182, stage0_mean_ious: 0.5006, stage0_s: 0.4705, stage0_m: 0.3951, stage0_l: 0.0218, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0110, stage1_bag_acc: 97.3182, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5783, stage1_s: 0.5863, stage1_m: 0.3596, stage1_l: 0.0169, stage1_h: 0.0000, loss: 0.0438, grad_norm: 2.8405
2024-10-15 14:09:29,923 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:09:47, time: 0.519, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0451, stage0_bag_acc: 97.0286, stage0_mean_ious: 0.4855, stage0_s: 0.4433, stage0_m: 0.3356, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0185, stage1_bag_acc: 96.2071, stage1_neg_loss: 0.0147, stage1_mean_ious: 0.5876, stage1_s: 0.5691, stage1_m: 0.3531, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0782, grad_norm: 3.9616
2024-10-15 14:09:56,301 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:09:25, time: 0.528, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0186, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.4925, stage0_s: 0.4490, stage0_m: 0.3918, stage0_l: 0.0091, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0147, stage1_bag_acc: 98.6667, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5845, stage1_s: 0.5847, stage1_m: 0.4000, stage1_l: 0.0064, stage1_h: 0.0000, loss: 0.0388, grad_norm: 2.9357
2024-10-15 14:10:21,054 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:09:02, time: 0.495, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0632, stage0_bag_acc: 94.6182, stage0_mean_ious: 0.4742, stage0_s: 0.4259, stage0_m: 0.2950, stage0_l: 0.0165, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0111, stage1_bag_acc: 94.9500, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5726, stage1_s: 0.5421, stage1_m: 0.2957, stage1_l: 0.0114, stage1_h: 0.0000, loss: 0.0790, grad_norm: 4.1837
2024-10-15 14:10:36,603 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 14:11:05,816 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:08:19, time: 0.540, data_time: 0.055, memory: 7787, stage0_loss_instance_mil: 0.0333, stage0_bag_acc: 97.8000, stage0_mean_ious: 0.5019, stage0_s: 0.4801, stage0_m: 0.3529, stage0_l: 0.0100, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0069, stage1_bag_acc: 97.5778, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5757, stage1_s: 0.5775, stage1_m: 0.3512, stage1_l: 0.0087, stage1_h: 0.0000, loss: 0.0444, grad_norm: 2.6660
2024-10-15 14:11:31,614 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:07:57, time: 0.516, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0162, stage0_bag_acc: 98.6500, stage0_mean_ious: 0.4806, stage0_s: 0.4582, stage0_m: 0.3035, stage0_l: 0.0207, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0057, stage1_bag_acc: 98.3500, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5820, stage1_s: 0.5920, stage1_m: 0.3166, stage1_l: 0.0166, stage1_h: 0.0000, loss: 0.0273, grad_norm: 2.2289
2024-10-15 14:11:57,078 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:07:34, time: 0.509, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0161, stage0_bag_acc: 98.9167, stage0_mean_ious: 0.4981, stage0_s: 0.4549, stage0_m: 0.3646, stage0_l: 0.0156, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0080, stage1_bag_acc: 98.3167, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5907, stage1_s: 0.5772, stage1_m: 0.3598, stage1_l: 0.0143, stage1_h: 0.0000, loss: 0.0263, grad_norm: 1.9782
2024-10-15 14:12:21,363 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:07:11, time: 0.486, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0323, stage0_bag_acc: 98.2333, stage0_mean_ious: 0.4813, stage0_s: 0.4463, stage0_m: 0.3502, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0111, stage1_bag_acc: 98.3833, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5655, stage1_s: 0.5709, stage1_m: 0.3231, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0485, grad_norm: 2.7936
2024-10-15 14:12:46,981 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:06:48, time: 0.512, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.0181, stage0_bag_acc: 98.4500, stage0_mean_ious: 0.4787, stage0_s: 0.4305, stage0_m: 0.3041, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0063, stage1_bag_acc: 98.0000, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5864, stage1_s: 0.5723, stage1_m: 0.3115, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0289, grad_norm: 2.3448
2024-10-15 14:13:02,610 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 14:14:20,076 - mmdet - INFO - Evaluating bbox...
2024-10-15 14:14:20,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2050
2024-10-15 14:14:20,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6567
2024-10-15 14:14:20,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3898
2024-10-15 14:14:20,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1284
2024-10-15 14:14:20,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0542
2024-10-15 14:14:20,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0207
2024-10-15 14:14:20,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0003
2024-10-15 14:14:20,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:14:20,638 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2166
2024-10-15 14:14:20,638 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0414
2024-10-15 14:14:20,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3070
2024-10-15 14:14:20,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7737
2024-10-15 14:14:20,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3070
2024-10-15 14:14:20,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3070
2024-10-15 14:14:20,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:14:20,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3274
2024-10-15 14:14:20,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0607
2024-10-15 14:14:20,643 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 14:14:20,643 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2050, bbox_mAP_50: 0.6570, bbox_mAP_75: 0.3900, bbox_mAP_s: 0.1280, bbox_mAP_m: 0.0540, bbox_mAP_l: 0.0210, bbox_mAP_copypaste: 0.205 0.657 0.390 0.128 0.054 0.021
2024-10-15 14:14:47,645 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:06:08, time: 0.540, data_time: 0.057, memory: 7787, stage0_loss_instance_mil: 0.0239, stage0_bag_acc: 98.8167, stage0_mean_ious: 0.4900, stage0_s: 0.4205, stage0_m: 0.3333, stage0_l: 0.0268, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0136, stage1_bag_acc: 97.7833, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5531, stage1_s: 0.5105, stage1_m: 0.3258, stage1_l: 0.0177, stage1_h: 0.0000, loss: 0.0403, grad_norm: 2.5116
2024-10-15 14:15:14,271 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:05:45, time: 0.533, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0158, stage0_bag_acc: 98.9667, stage0_mean_ious: 0.4843, stage0_s: 0.4440, stage0_m: 0.3423, stage0_l: 0.0109, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0058, stage1_bag_acc: 99.4167, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5748, stage1_s: 0.5766, stage1_m: 0.3192, stage1_l: 0.0091, stage1_h: 0.0000, loss: 0.0241, grad_norm: 1.5977
2024-10-15 14:15:46,275 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:05:24, time: 0.640, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0084, stage0_bag_acc: 99.5143, stage0_mean_ious: 0.4868, stage0_s: 0.4587, stage0_m: 0.2816, stage0_l: 0.0179, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0060, stage1_bag_acc: 99.2286, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5726, stage1_s: 0.5781, stage1_m: 0.2629, stage1_l: 0.0137, stage1_h: 0.0000, loss: 0.0169, grad_norm: 1.3553
2024-10-15 14:16:30,253 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:05:05, time: 0.880, data_time: 0.010, memory: 7787, stage0_loss_instance_mil: 0.0217, stage0_bag_acc: 98.3778, stage0_mean_ious: 0.5139, stage0_s: 0.4679, stage0_m: 0.3490, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 98.6000, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.6130, stage1_s: 0.6052, stage1_m: 0.3449, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0354, grad_norm: 2.5031
2024-10-15 14:17:12,851 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:04:45, time: 0.852, data_time: 0.010, memory: 7787, stage0_loss_instance_mil: 0.0156, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.5000, stage0_s: 0.4792, stage0_m: 0.3602, stage0_l: 0.0070, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0098, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5842, stage1_s: 0.5890, stage1_m: 0.3568, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0298, grad_norm: 1.9666
2024-10-15 14:17:38,733 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 14:18:27,851 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:04:08, time: 0.939, data_time: 0.058, memory: 7787, stage0_loss_instance_mil: 0.0306, stage0_bag_acc: 97.0310, stage0_mean_ious: 0.4826, stage0_s: 0.4194, stage0_m: 0.3590, stage0_l: 0.0151, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0061, stage1_bag_acc: 97.4310, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5615, stage1_s: 0.5420, stage1_m: 0.3395, stage1_l: 0.0118, stage1_h: 0.0000, loss: 0.0397, grad_norm: 2.3542
2024-10-15 14:19:09,641 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:03:47, time: 0.836, data_time: 0.010, memory: 7787, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.5000, stage0_mean_ious: 0.4885, stage0_s: 0.4633, stage0_m: 0.2634, stage0_l: 0.0048, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 99.2500, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5769, stage1_s: 0.5750, stage1_m: 0.2536, stage1_l: 0.0035, stage1_h: 0.0000, loss: 0.0240, grad_norm: 1.6372
2024-10-15 14:19:51,752 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:03:24, time: 0.842, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0232, stage0_bag_acc: 97.5833, stage0_mean_ious: 0.5090, stage0_s: 0.4943, stage0_m: 0.3065, stage0_l: 0.0114, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0091, stage1_bag_acc: 97.6667, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5962, stage1_s: 0.6042, stage1_m: 0.3070, stage1_l: 0.0084, stage1_h: 0.0000, loss: 0.0390, grad_norm: 2.1123
2024-10-15 14:20:34,444 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 14:20:34,444 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:03:01, time: 0.854, data_time: 0.010, memory: 7787, stage0_loss_instance_mil: 0.0121, stage0_bag_acc: 99.1667, stage0_mean_ious: 0.5183, stage0_s: 0.4903, stage0_m: 0.3529, stage0_l: 0.0172, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0072, stage1_bag_acc: 99.1000, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.6088, stage1_s: 0.6079, stage1_m: 0.3477, stage1_l: 0.0138, stage1_h: 0.0000, loss: 0.0214, grad_norm: 1.6918
2024-10-15 14:21:17,679 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:02:38, time: 0.865, data_time: 0.010, memory: 7787, stage0_loss_instance_mil: 0.0308, stage0_bag_acc: 96.8325, stage0_mean_ious: 0.4734, stage0_s: 0.4121, stage0_m: 0.3104, stage0_l: 0.0105, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0062, stage1_bag_acc: 96.5110, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.5683, stage1_s: 0.5386, stage1_m: 0.3088, stage1_l: 0.0089, stage1_h: 0.0000, loss: 0.0436, grad_norm: 2.8138
2024-10-15 14:21:45,380 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 14:22:33,803 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:01:57, time: 0.929, data_time: 0.059, memory: 7787, stage0_loss_instance_mil: 0.0157, stage0_bag_acc: 99.2643, stage0_mean_ious: 0.4906, stage0_s: 0.4143, stage0_m: 0.3792, stage0_l: 0.0149, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0099, stage1_bag_acc: 98.8143, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5790, stage1_s: 0.5343, stage1_m: 0.3955, stage1_l: 0.0101, stage1_h: 0.0000, loss: 0.0291, grad_norm: 1.9894
2024-10-15 14:23:16,046 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:01:33, time: 0.845, data_time: 0.010, memory: 7787, stage0_loss_instance_mil: 0.0193, stage0_bag_acc: 98.6500, stage0_mean_ious: 0.4963, stage0_s: 0.4618, stage0_m: 0.3333, stage0_l: 0.0231, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0047, stage1_bag_acc: 98.2500, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.5990, stage1_s: 0.5937, stage1_m: 0.3336, stage1_l: 0.0185, stage1_h: 0.0000, loss: 0.0259, grad_norm: 1.5465
2024-10-15 14:24:00,315 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:08, time: 0.885, data_time: 0.010, memory: 7787, stage0_loss_instance_mil: 0.0141, stage0_bag_acc: 99.1864, stage0_mean_ious: 0.4958, stage0_s: 0.4369, stage0_m: 0.3463, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0053, stage1_bag_acc: 99.1864, stage1_neg_loss: 0.0014, stage1_mean_ious: 0.5693, stage1_s: 0.5494, stage1_m: 0.3199, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0208, grad_norm: 1.5229
2024-10-15 14:24:43,506 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:42, time: 0.864, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.0174, stage0_bag_acc: 98.8348, stage0_mean_ious: 0.5008, stage0_s: 0.4520, stage0_m: 0.3582, stage0_l: 0.0276, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.6348, stage1_neg_loss: 0.0011, stage1_mean_ious: 0.5778, stage1_s: 0.5757, stage1_m: 0.3331, stage1_l: 0.0276, stage1_h: 0.0000, loss: 0.0267, grad_norm: 1.5790
2024-10-15 14:25:27,560 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:16, time: 0.881, data_time: 0.010, memory: 7787, stage0_loss_instance_mil: 0.0198, stage0_bag_acc: 98.7167, stage0_mean_ious: 0.4840, stage0_s: 0.4440, stage0_m: 0.3279, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0070, stage1_bag_acc: 98.7167, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5763, stage1_s: 0.5628, stage1_m: 0.3475, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0293, grad_norm: 1.9567
2024-10-15 14:25:53,925 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 14:27:13,816 - mmdet - INFO - Evaluating bbox...
2024-10-15 14:27:14,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2046
2024-10-15 14:27:14,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6584
2024-10-15 14:27:14,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3899
2024-10-15 14:27:14,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1285
2024-10-15 14:27:14,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0533
2024-10-15 14:27:14,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0193
2024-10-15 14:27:14,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 14:27:14,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:27:14,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2160
2024-10-15 14:27:14,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0452
2024-10-15 14:27:14,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3062
2024-10-15 14:27:14,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7740
2024-10-15 14:27:14,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3062
2024-10-15 14:27:14,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3062
2024-10-15 14:27:14,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:27:14,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3262
2024-10-15 14:27:14,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0614
2024-10-15 14:27:14,379 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 14:27:14,379 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2050, bbox_mAP_50: 0.6580, bbox_mAP_75: 0.3900, bbox_mAP_s: 0.1280, bbox_mAP_m: 0.0530, bbox_mAP_l: 0.0190, bbox_mAP_copypaste: 0.205 0.658 0.390 0.128 0.053 0.019
2024-10-15 14:28:32,370 - mmdet - INFO - Evaluating bbox...
2024-10-15 14:28:32,849 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2046
2024-10-15 14:28:32,850 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6584
2024-10-15 14:28:32,850 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3899
2024-10-15 14:28:32,850 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1285
2024-10-15 14:28:32,850 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0533
2024-10-15 14:28:32,850 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0193
2024-10-15 14:28:32,850 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 14:28:32,850 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:28:32,850 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2160
2024-10-15 14:28:32,850 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0452
2024-10-15 14:28:32,850 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3062
2024-10-15 14:28:32,851 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7740
2024-10-15 14:28:32,851 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3062
2024-10-15 14:28:32,851 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3062
2024-10-15 14:28:32,851 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:28:32,851 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3262
2024-10-15 14:28:32,851 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0614
2024-10-15 14:28:34,153 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 14:28:35,196 - mmdet - INFO - Distributed training: False
2024-10-15 14:28:36,111 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 14:28:37,162 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 14:28:37,162 - mmdet - INFO - Use load_from_local loader
2024-10-15 14:28:37,557 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 14:28:37,574 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 14:28:37,574 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 14:29:22,869 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:49:58, time: 0.906, data_time: 0.057, memory: 7787, stage0_loss_instance_mil: 0.7145, stage0_bag_acc: 16.0843, stage0_mean_ious: 0.0506, stage0_s: 0.0472, stage0_m: 0.0394, stage0_l: 0.0005, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1616, stage1_bag_acc: 11.6667, stage1_neg_loss: 0.0008, stage1_mean_ious: 0.0541, stage1_s: 0.0495, stage1_m: 0.0411, stage1_l: 0.0007, stage1_h: 0.0000, loss: 0.8769, grad_norm: 5.7870
2024-10-15 14:30:03,661 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:46:46, time: 0.816, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.7049, stage0_bag_acc: 15.2320, stage0_mean_ious: 0.0621, stage0_s: 0.0534, stage0_m: 0.0508, stage0_l: 0.0013, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1597, stage1_bag_acc: 24.6675, stage1_neg_loss: 0.0012, stage1_mean_ious: 0.0665, stage1_s: 0.0567, stage1_m: 0.0540, stage1_l: 0.0021, stage1_h: 0.0000, loss: 0.8659, grad_norm: 6.3463
2024-10-15 14:30:38,543 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:43:08, time: 0.697, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.6935, stage0_bag_acc: 20.7561, stage0_mean_ious: 0.0752, stage0_s: 0.0634, stage0_m: 0.0673, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1516, stage1_bag_acc: 16.8770, stage1_neg_loss: 0.0045, stage1_mean_ious: 0.0746, stage1_s: 0.0612, stage1_m: 0.0721, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8496, grad_norm: 7.4935
2024-10-15 14:31:12,246 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:40:43, time: 0.674, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.6188, stage0_bag_acc: 30.1349, stage0_mean_ious: 0.1537, stage0_s: 0.1411, stage0_m: 0.1159, stage0_l: 0.0236, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1343, stage1_bag_acc: 45.6417, stage1_neg_loss: 0.0177, stage1_mean_ious: 0.1505, stage1_s: 0.1356, stage1_m: 0.1186, stage1_l: 0.0195, stage1_h: 0.0000, loss: 0.7709, grad_norm: 9.4345
2024-10-15 14:31:45,550 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:38:58, time: 0.666, data_time: 0.009, memory: 7787, stage0_loss_instance_mil: 0.5666, stage0_bag_acc: 35.8980, stage0_mean_ious: 0.1853, stage0_s: 0.1397, stage0_m: 0.1325, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1166, stage1_bag_acc: 52.8821, stage1_neg_loss: 0.0178, stage1_mean_ious: 0.1951, stage1_s: 0.1558, stage1_m: 0.1349, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.7010, grad_norm: 11.0519
2024-10-15 14:32:03,174 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 14:32:33,418 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:32:57, time: 0.549, data_time: 0.057, memory: 7787, stage0_loss_instance_mil: 0.4968, stage0_bag_acc: 44.9403, stage0_mean_ious: 0.2435, stage0_s: 0.2003, stage0_m: 0.1922, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1115, stage1_bag_acc: 60.0008, stage1_neg_loss: 0.0200, stage1_mean_ious: 0.2843, stage1_s: 0.2445, stage1_m: 0.2011, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.6283, grad_norm: 11.7095
2024-10-15 14:32:58,551 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:31:26, time: 0.503, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.4959, stage0_bag_acc: 44.3263, stage0_mean_ious: 0.2902, stage0_s: 0.2434, stage0_m: 0.3007, stage0_l: 0.0178, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1129, stage1_bag_acc: 49.0551, stage1_neg_loss: 0.0229, stage1_mean_ious: 0.3395, stage1_s: 0.2888, stage1_m: 0.3211, stage1_l: 0.0132, stage1_h: 0.0000, loss: 0.6317, grad_norm: 15.7492
2024-10-15 14:33:23,876 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:30:11, time: 0.506, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.4074, stage0_bag_acc: 56.1595, stage0_mean_ious: 0.3005, stage0_s: 0.2714, stage0_m: 0.2126, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1126, stage1_bag_acc: 60.6016, stage1_neg_loss: 0.0187, stage1_mean_ious: 0.3719, stage1_s: 0.3578, stage1_m: 0.2160, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5387, grad_norm: 11.3706
2024-10-15 14:33:48,976 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:29:05, time: 0.502, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.3104, stage0_bag_acc: 71.6579, stage0_mean_ious: 0.3583, stage0_s: 0.3134, stage0_m: 0.2493, stage0_l: 0.0153, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0736, stage1_bag_acc: 74.0071, stage1_neg_loss: 0.0172, stage1_mean_ious: 0.4720, stage1_s: 0.4424, stage1_m: 0.2746, stage1_l: 0.0131, stage1_h: 0.0000, loss: 0.4011, grad_norm: 11.6819
2024-10-15 14:34:15,113 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:28:13, time: 0.523, data_time: 0.008, memory: 7787, stage0_loss_instance_mil: 0.2377, stage0_bag_acc: 81.8750, stage0_mean_ious: 0.4263, stage0_s: 0.3870, stage0_m: 0.2935, stage0_l: 0.0239, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0671, stage1_bag_acc: 82.0557, stage1_neg_loss: 0.0205, stage1_mean_ious: 0.5075, stage1_s: 0.4961, stage1_m: 0.2953, stage1_l: 0.0179, stage1_h: 0.0000, loss: 0.3254, grad_norm: 12.2127
2024-10-15 14:34:30,696 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 14:35:01,196 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:25:56, time: 0.565, data_time: 0.058, memory: 7788, stage0_loss_instance_mil: 0.2077, stage0_bag_acc: 84.1506, stage0_mean_ious: 0.4392, stage0_s: 0.4047, stage0_m: 0.2977, stage0_l: 0.0088, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0418, stage1_bag_acc: 85.6983, stage1_neg_loss: 0.0106, stage1_mean_ious: 0.5522, stage1_s: 0.5404, stage1_m: 0.3042, stage1_l: 0.0050, stage1_h: 0.0000, loss: 0.2601, grad_norm: 9.5819
2024-10-15 14:35:26,799 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:25:17, time: 0.512, data_time: 0.008, memory: 7788, stage0_loss_instance_mil: 0.1327, stage0_bag_acc: 87.9602, stage0_mean_ious: 0.4698, stage0_s: 0.4038, stage0_m: 0.4369, stage0_l: 0.0215, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0357, stage1_bag_acc: 89.5602, stage1_neg_loss: 0.0152, stage1_mean_ious: 0.5491, stage1_s: 0.5188, stage1_m: 0.4276, stage1_l: 0.0199, stage1_h: 0.0000, loss: 0.1836, grad_norm: 8.5239
2024-10-15 14:35:51,763 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:24:37, time: 0.499, data_time: 0.008, memory: 7788, stage0_loss_instance_mil: 0.1199, stage0_bag_acc: 90.5436, stage0_mean_ious: 0.4770, stage0_s: 0.4406, stage0_m: 0.3474, stage0_l: 0.0104, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0360, stage1_bag_acc: 90.6436, stage1_neg_loss: 0.0129, stage1_mean_ious: 0.5837, stage1_s: 0.5803, stage1_m: 0.3429, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.1689, grad_norm: 8.3785
2024-10-15 14:36:24,522 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:24:26, time: 0.655, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.1032, stage0_bag_acc: 92.6333, stage0_mean_ious: 0.4725, stage0_s: 0.4217, stage0_m: 0.3599, stage0_l: 0.0142, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0339, stage1_bag_acc: 93.8944, stage1_neg_loss: 0.0106, stage1_mean_ious: 0.5816, stage1_s: 0.5553, stage1_m: 0.3657, stage1_l: 0.0087, stage1_h: 0.0000, loss: 0.1477, grad_norm: 8.1662
2024-10-15 14:37:07,280 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:24:44, time: 0.855, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0995, stage0_bag_acc: 91.2333, stage0_mean_ious: 0.4718, stage0_s: 0.4275, stage0_m: 0.3180, stage0_l: 0.0115, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0377, stage1_bag_acc: 92.5833, stage1_neg_loss: 0.0105, stage1_mean_ious: 0.5649, stage1_s: 0.5423, stage1_m: 0.3278, stage1_l: 0.0077, stage1_h: 0.0000, loss: 0.1477, grad_norm: 6.6562
2024-10-15 14:37:32,942 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 14:38:52,623 - mmdet - INFO - Evaluating bbox...
2024-10-15 14:38:53,199 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2227
2024-10-15 14:38:53,199 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6748
2024-10-15 14:38:53,199 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4357
2024-10-15 14:38:53,199 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1542
2024-10-15 14:38:53,199 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0812
2024-10-15 14:38:53,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0299
2024-10-15 14:38:53,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 14:38:53,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:38:53,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2348
2024-10-15 14:38:53,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0835
2024-10-15 14:38:53,200 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3293
2024-10-15 14:38:53,200 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7795
2024-10-15 14:38:53,200 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3293
2024-10-15 14:38:53,200 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3293
2024-10-15 14:38:53,200 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:38:53,201 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3499
2024-10-15 14:38:53,201 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0861
2024-10-15 14:38:53,207 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 14:38:53,207 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2230, bbox_mAP_50: 0.6750, bbox_mAP_75: 0.4360, bbox_mAP_s: 0.1540, bbox_mAP_m: 0.0810, bbox_mAP_l: 0.0300, bbox_mAP_copypaste: 0.223 0.675 0.436 0.154 0.081 0.030
2024-10-15 14:39:37,825 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:23:52, time: 0.892, data_time: 0.056, memory: 7788, stage0_loss_instance_mil: 0.0691, stage0_bag_acc: 95.2006, stage0_mean_ious: 0.4856, stage0_s: 0.4187, stage0_m: 0.3583, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0277, stage1_bag_acc: 95.7643, stage1_neg_loss: 0.0165, stage1_mean_ious: 0.5781, stage1_s: 0.5568, stage1_m: 0.3439, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.1134, grad_norm: 6.6672
2024-10-15 14:40:19,232 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:23:55, time: 0.828, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0665, stage0_bag_acc: 95.7000, stage0_mean_ious: 0.4864, stage0_s: 0.4249, stage0_m: 0.3734, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0328, stage1_bag_acc: 96.4333, stage1_neg_loss: 0.0093, stage1_mean_ious: 0.5719, stage1_s: 0.5571, stage1_m: 0.3688, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1087, grad_norm: 5.5661
2024-10-15 14:41:01,516 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:23:55, time: 0.846, data_time: 0.011, memory: 7788, stage0_loss_instance_mil: 0.0572, stage0_bag_acc: 96.8182, stage0_mean_ious: 0.4923, stage0_s: 0.4152, stage0_m: 0.3144, stage0_l: 0.0351, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0237, stage1_bag_acc: 96.5682, stage1_neg_loss: 0.0136, stage1_mean_ious: 0.5819, stage1_s: 0.5363, stage1_m: 0.3313, stage1_l: 0.0263, stage1_h: 0.0000, loss: 0.0945, grad_norm: 5.4579
2024-10-15 14:41:43,569 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:23:51, time: 0.841, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0470, stage0_bag_acc: 96.9167, stage0_mean_ious: 0.4916, stage0_s: 0.4632, stage0_m: 0.2822, stage0_l: 0.0177, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0220, stage1_bag_acc: 96.9667, stage1_neg_loss: 0.0088, stage1_mean_ious: 0.5907, stage1_s: 0.5813, stage1_m: 0.2762, stage1_l: 0.0152, stage1_h: 0.0000, loss: 0.0778, grad_norm: 4.3359
2024-10-15 14:42:25,239 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:23:43, time: 0.834, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0766, stage0_bag_acc: 94.1197, stage0_mean_ious: 0.5019, stage0_s: 0.4563, stage0_m: 0.3901, stage0_l: 0.0351, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0244, stage1_bag_acc: 94.2167, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5904, stage1_s: 0.5730, stage1_m: 0.3878, stage1_l: 0.0270, stage1_h: 0.0000, loss: 0.1052, grad_norm: 5.9646
2024-10-15 14:42:51,268 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 14:43:38,043 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:22:42, time: 0.891, data_time: 0.060, memory: 7788, stage0_loss_instance_mil: 0.0794, stage0_bag_acc: 93.0833, stage0_mean_ious: 0.5290, stage0_s: 0.4903, stage0_m: 0.3478, stage0_l: 0.0097, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0162, stage1_bag_acc: 94.7500, stage1_neg_loss: 0.0079, stage1_mean_ious: 0.6097, stage1_s: 0.6014, stage1_m: 0.3471, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.1035, grad_norm: 5.3201
2024-10-15 14:44:21,955 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:22:34, time: 0.878, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0552, stage0_bag_acc: 95.7808, stage0_mean_ious: 0.5042, stage0_s: 0.4623, stage0_m: 0.3409, stage0_l: 0.0212, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0209, stage1_bag_acc: 95.9530, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.5949, stage1_s: 0.5934, stage1_m: 0.3434, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.0844, grad_norm: 4.6424
2024-10-15 14:45:04,607 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:22:20, time: 0.853, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0859, stage0_bag_acc: 93.6643, stage0_mean_ious: 0.4943, stage0_s: 0.4331, stage0_m: 0.3907, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0256, stage1_bag_acc: 95.4198, stage1_neg_loss: 0.0096, stage1_mean_ious: 0.5879, stage1_s: 0.5623, stage1_m: 0.3931, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1211, grad_norm: 5.6880
2024-10-15 14:45:48,374 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:22:06, time: 0.875, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0535, stage0_bag_acc: 96.4173, stage0_mean_ious: 0.5049, stage0_s: 0.4497, stage0_m: 0.4040, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0215, stage1_bag_acc: 96.4658, stage1_neg_loss: 0.0116, stage1_mean_ious: 0.5834, stage1_s: 0.5665, stage1_m: 0.3913, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.0866, grad_norm: 5.7796
2024-10-15 14:46:28,597 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:21:45, time: 0.804, data_time: 0.009, memory: 7788, stage0_loss_instance_mil: 0.0667, stage0_bag_acc: 95.1952, stage0_mean_ious: 0.4602, stage0_s: 0.4353, stage0_m: 0.2675, stage0_l: 0.0127, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0182, stage1_bag_acc: 94.2952, stage1_neg_loss: 0.0119, stage1_mean_ious: 0.5577, stage1_s: 0.5557, stage1_m: 0.2642, stage1_l: 0.0135, stage1_h: 0.0000, loss: 0.0967, grad_norm: 5.0556
2024-10-15 14:46:52,505 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 14:47:38,688 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:20:41, time: 0.879, data_time: 0.059, memory: 7788, stage0_loss_instance_mil: 0.0386, stage0_bag_acc: 97.9460, stage0_mean_ious: 0.4911, stage0_s: 0.4563, stage0_m: 0.3327, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0123, stage1_bag_acc: 97.6602, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5987, stage1_s: 0.5886, stage1_m: 0.3443, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0557, grad_norm: 3.9070
2024-10-15 14:48:19,208 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:20:19, time: 0.811, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0528, stage0_bag_acc: 95.2000, stage0_mean_ious: 0.5069, stage0_s: 0.4618, stage0_m: 0.3503, stage0_l: 0.0071, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 95.2000, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.5776, stage1_s: 0.5796, stage1_m: 0.2948, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.0814, grad_norm: 5.4027
2024-10-15 14:49:01,003 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:19:56, time: 0.836, data_time: 0.011, memory: 7788, stage0_loss_instance_mil: 0.1086, stage0_bag_acc: 92.4015, stage0_mean_ious: 0.5002, stage0_s: 0.4619, stage0_m: 0.3128, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0267, stage1_bag_acc: 92.7015, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.5896, stage1_s: 0.5806, stage1_m: 0.3150, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.1428, grad_norm: 7.1753
2024-10-15 14:49:43,055 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:19:33, time: 0.841, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0553, stage0_bag_acc: 94.8348, stage0_mean_ious: 0.5164, stage0_s: 0.4744, stage0_m: 0.3461, stage0_l: 0.0252, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0147, stage1_bag_acc: 95.5015, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5990, stage1_s: 0.5960, stage1_m: 0.3341, stage1_l: 0.0158, stage1_h: 0.0000, loss: 0.0760, grad_norm: 3.7996
2024-10-15 14:50:26,049 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:19:10, time: 0.860, data_time: 0.011, memory: 7788, stage0_loss_instance_mil: 0.0373, stage0_bag_acc: 98.1778, stage0_mean_ious: 0.5083, stage0_s: 0.4626, stage0_m: 0.3891, stage0_l: 0.0101, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0119, stage1_bag_acc: 97.9778, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.6108, stage1_s: 0.6067, stage1_m: 0.3979, stage1_l: 0.0071, stage1_h: 0.0000, loss: 0.0544, grad_norm: 2.8010
2024-10-15 14:50:52,122 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 14:52:10,298 - mmdet - INFO - Evaluating bbox...
2024-10-15 14:52:10,862 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2357
2024-10-15 14:52:10,862 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7035
2024-10-15 14:52:10,863 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4637
2024-10-15 14:52:10,863 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1722
2024-10-15 14:52:10,863 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0822
2024-10-15 14:52:10,863 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0307
2024-10-15 14:52:10,863 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0018
2024-10-15 14:52:10,863 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:52:10,863 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2482
2024-10-15 14:52:10,863 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0769
2024-10-15 14:52:10,863 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3348
2024-10-15 14:52:10,863 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7938
2024-10-15 14:52:10,863 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3348
2024-10-15 14:52:10,864 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3348
2024-10-15 14:52:10,864 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 14:52:10,864 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3553
2024-10-15 14:52:10,864 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0897
2024-10-15 14:52:10,870 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 14:52:10,870 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2360, bbox_mAP_50: 0.7040, bbox_mAP_75: 0.4640, bbox_mAP_s: 0.1720, bbox_mAP_m: 0.0820, bbox_mAP_l: 0.0310, bbox_mAP_copypaste: 0.236 0.704 0.464 0.172 0.082 0.031
2024-10-15 14:52:46,436 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:17:59, time: 0.711, data_time: 0.057, memory: 7788, stage0_loss_instance_mil: 0.0145, stage0_bag_acc: 99.0286, stage0_mean_ious: 0.5169, stage0_s: 0.4974, stage0_m: 0.3971, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0060, stage1_bag_acc: 99.3143, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.6089, stage1_s: 0.6142, stage1_m: 0.4045, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0230, grad_norm: 1.9697
2024-10-15 14:53:19,319 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:17:25, time: 0.658, data_time: 0.009, memory: 7788, stage0_loss_instance_mil: 0.0549, stage0_bag_acc: 96.1864, stage0_mean_ious: 0.4799, stage0_s: 0.4449, stage0_m: 0.3185, stage0_l: 0.0172, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0140, stage1_bag_acc: 96.4348, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5822, stage1_s: 0.5908, stage1_m: 0.3043, stage1_l: 0.0113, stage1_h: 0.0000, loss: 0.0732, grad_norm: 4.5256
2024-10-15 14:53:59,135 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:16:58, time: 0.796, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0430, stage0_bag_acc: 97.2500, stage0_mean_ious: 0.5187, stage0_s: 0.4710, stage0_m: 0.3586, stage0_l: 0.0071, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0130, stage1_bag_acc: 98.1500, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5886, stage1_s: 0.5746, stage1_m: 0.3491, stage1_l: 0.0061, stage1_h: 0.0000, loss: 0.0603, grad_norm: 3.5002
2024-10-15 14:54:40,543 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:16:31, time: 0.828, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0541, stage0_bag_acc: 94.8167, stage0_mean_ious: 0.4980, stage0_s: 0.4631, stage0_m: 0.2727, stage0_l: 0.0062, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0147, stage1_bag_acc: 96.2667, stage1_neg_loss: 0.0133, stage1_mean_ious: 0.5937, stage1_s: 0.6042, stage1_m: 0.2468, stage1_l: 0.0050, stage1_h: 0.0000, loss: 0.0821, grad_norm: 4.1447
2024-10-15 14:55:21,434 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:16:03, time: 0.818, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0362, stage0_bag_acc: 97.5880, stage0_mean_ious: 0.5077, stage0_s: 0.4501, stage0_m: 0.3665, stage0_l: 0.0066, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0227, stage1_bag_acc: 97.8102, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.5818, stage1_s: 0.5839, stage1_m: 0.3298, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0663, grad_norm: 4.6779
2024-10-15 14:55:47,007 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 14:56:32,775 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:15:02, time: 0.870, data_time: 0.057, memory: 7788, stage0_loss_instance_mil: 0.0212, stage0_bag_acc: 98.4944, stage0_mean_ious: 0.4826, stage0_s: 0.4418, stage0_m: 0.2227, stage0_l: 0.0104, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 98.2167, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.5865, stage1_s: 0.5761, stage1_m: 0.2137, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.0379, grad_norm: 2.7982
2024-10-15 14:57:14,401 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:14:34, time: 0.832, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0323, stage0_bag_acc: 97.2626, stage0_mean_ious: 0.4984, stage0_s: 0.4700, stage0_m: 0.3414, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0197, stage1_bag_acc: 97.5000, stage1_neg_loss: 0.0117, stage1_mean_ious: 0.5925, stage1_s: 0.5928, stage1_m: 0.3408, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0638, grad_norm: 4.7624
2024-10-15 14:57:55,653 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:14:05, time: 0.825, data_time: 0.010, memory: 7788, stage0_loss_instance_mil: 0.0433, stage0_bag_acc: 96.3222, stage0_mean_ious: 0.5201, stage0_s: 0.4864, stage0_m: 0.3543, stage0_l: 0.0066, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0156, stage1_bag_acc: 96.2444, stage1_neg_loss: 0.0064, stage1_mean_ious: 0.6041, stage1_s: 0.6011, stage1_m: 0.3668, stage1_l: 0.0055, stage1_h: 0.0000, loss: 0.0653, grad_norm: 4.2531
2024-10-15 14:58:38,269 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:13:36, time: 0.852, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0371, stage0_bag_acc: 96.5167, stage0_mean_ious: 0.4908, stage0_s: 0.4565, stage0_m: 0.3580, stage0_l: 0.0071, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 97.5000, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.6019, stage1_s: 0.5918, stage1_m: 0.3502, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.0508, grad_norm: 3.3968
2024-10-15 14:59:21,436 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:13:07, time: 0.863, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0121, stage0_bag_acc: 99.0167, stage0_mean_ious: 0.5275, stage0_s: 0.4988, stage0_m: 0.3493, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0085, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.6033, stage1_s: 0.6144, stage1_m: 0.3345, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0261, grad_norm: 2.4183
2024-10-15 14:59:45,811 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 15:00:36,351 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:12:09, time: 0.966, data_time: 0.061, memory: 7790, stage0_loss_instance_mil: 0.0389, stage0_bag_acc: 97.5389, stage0_mean_ious: 0.5427, stage0_s: 0.4633, stage0_m: 0.4112, stage0_l: 0.0070, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 97.9611, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5923, stage1_s: 0.5646, stage1_m: 0.3688, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0494, grad_norm: 3.8671
2024-10-15 15:01:17,557 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:11:38, time: 0.824, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0301, stage0_bag_acc: 98.9000, stage0_mean_ious: 0.5073, stage0_s: 0.4654, stage0_m: 0.3049, stage0_l: 0.0100, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0083, stage1_bag_acc: 98.6167, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.6123, stage1_s: 0.5878, stage1_m: 0.3253, stage1_l: 0.0097, stage1_h: 0.0000, loss: 0.0419, grad_norm: 2.8178
2024-10-15 15:02:00,039 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:11:07, time: 0.850, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0086, stage0_bag_acc: 99.7500, stage0_mean_ious: 0.4970, stage0_s: 0.4449, stage0_m: 0.3416, stage0_l: 0.0087, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0060, stage1_bag_acc: 99.7500, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.6013, stage1_s: 0.5862, stage1_m: 0.3461, stage1_l: 0.0083, stage1_h: 0.0000, loss: 0.0203, grad_norm: 1.4934
2024-10-15 15:02:39,645 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:10:35, time: 0.792, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0286, stage0_bag_acc: 97.9848, stage0_mean_ious: 0.5004, stage0_s: 0.4629, stage0_m: 0.2927, stage0_l: 0.0112, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0073, stage1_bag_acc: 98.5848, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5856, stage1_s: 0.5696, stage1_m: 0.2897, stage1_l: 0.0129, stage1_h: 0.0000, loss: 0.0408, grad_norm: 3.1508
2024-10-15 15:03:22,547 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:03, time: 0.858, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0218, stage0_bag_acc: 98.5000, stage0_mean_ious: 0.4989, stage0_s: 0.4532, stage0_m: 0.3702, stage0_l: 0.0064, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0120, stage1_bag_acc: 98.1167, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5917, stage1_s: 0.5795, stage1_m: 0.3793, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.0380, grad_norm: 2.8842
2024-10-15 15:03:48,868 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 15:05:05,971 - mmdet - INFO - Evaluating bbox...
2024-10-15 15:05:06,534 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2406
2024-10-15 15:05:06,534 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7123
2024-10-15 15:05:06,534 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4740
2024-10-15 15:05:06,534 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1783
2024-10-15 15:05:06,534 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0772
2024-10-15 15:05:06,534 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0296
2024-10-15 15:05:06,535 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 15:05:06,535 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:05:06,535 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2520
2024-10-15 15:05:06,535 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0910
2024-10-15 15:05:06,535 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3419
2024-10-15 15:05:06,535 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8004
2024-10-15 15:05:06,535 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3419
2024-10-15 15:05:06,535 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3419
2024-10-15 15:05:06,535 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:05:06,535 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3603
2024-10-15 15:05:06,535 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1077
2024-10-15 15:05:06,542 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 15:05:06,542 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2410, bbox_mAP_50: 0.7120, bbox_mAP_75: 0.4740, bbox_mAP_s: 0.1780, bbox_mAP_m: 0.0770, bbox_mAP_l: 0.0300, bbox_mAP_copypaste: 0.241 0.712 0.474 0.178 0.077 0.030
2024-10-15 15:05:47,940 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:03, time: 0.828, data_time: 0.058, memory: 7790, stage0_loss_instance_mil: 0.0165, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.4800, stage0_s: 0.4519, stage0_m: 0.2521, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0080, stage1_bag_acc: 99.3278, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5702, stage1_s: 0.5692, stage1_m: 0.2447, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0301, grad_norm: 2.1613
2024-10-15 15:06:32,057 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:08:31, time: 0.882, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0241, stage0_bag_acc: 97.9667, stage0_mean_ious: 0.4980, stage0_s: 0.4033, stage0_m: 0.3784, stage0_l: 0.0152, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 98.4500, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5859, stage1_s: 0.5220, stage1_m: 0.3988, stage1_l: 0.0120, stage1_h: 0.0000, loss: 0.0411, grad_norm: 2.8711
2024-10-15 15:07:13,013 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:07:59, time: 0.819, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0127, stage0_bag_acc: 99.3000, stage0_mean_ious: 0.5031, stage0_s: 0.4391, stage0_m: 0.3637, stage0_l: 0.0064, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0070, stage1_bag_acc: 98.9000, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5753, stage1_s: 0.5547, stage1_m: 0.3236, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0255, grad_norm: 2.1043
2024-10-15 15:07:55,857 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:26, time: 0.857, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0082, stage0_bag_acc: 99.7778, stage0_mean_ious: 0.5388, stage0_s: 0.4866, stage0_m: 0.3945, stage0_l: 0.0207, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0047, stage1_bag_acc: 99.7778, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.6226, stage1_s: 0.5962, stage1_m: 0.4100, stage1_l: 0.0182, stage1_h: 0.0000, loss: 0.0158, grad_norm: 1.7843
2024-10-15 15:08:36,314 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:06:52, time: 0.809, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0271, stage0_bag_acc: 97.7778, stage0_mean_ious: 0.5068, stage0_s: 0.4542, stage0_m: 0.4088, stage0_l: 0.0282, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0087, stage1_bag_acc: 97.7778, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5768, stage1_s: 0.5545, stage1_m: 0.3983, stage1_l: 0.0283, stage1_h: 0.0000, loss: 0.0408, grad_norm: 2.7267
2024-10-15 15:08:56,244 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 15:09:33,643 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:05:52, time: 0.703, data_time: 0.055, memory: 7790, stage0_loss_instance_mil: 0.0141, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.4959, stage0_s: 0.4495, stage0_m: 0.3341, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0061, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.6083, stage1_s: 0.5891, stage1_m: 0.3469, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0240, grad_norm: 2.0639
2024-10-15 15:10:07,310 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:18, time: 0.673, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0189, stage0_bag_acc: 98.3500, stage0_mean_ious: 0.5218, stage0_s: 0.4928, stage0_m: 0.3519, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.7500, stage1_neg_loss: 0.0070, stage1_mean_ious: 0.6033, stage1_s: 0.6033, stage1_m: 0.3497, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0341, grad_norm: 2.5470
2024-10-15 15:10:38,541 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:04:43, time: 0.625, data_time: 0.008, memory: 7790, stage0_loss_instance_mil: 0.0167, stage0_bag_acc: 98.8167, stage0_mean_ious: 0.5107, stage0_s: 0.4741, stage0_m: 0.2557, stage0_l: 0.0130, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0099, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5861, stage1_s: 0.5563, stage1_m: 0.2535, stage1_l: 0.0155, stage1_h: 0.0000, loss: 0.0293, grad_norm: 2.0984
2024-10-15 15:11:17,467 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 15:11:17,468 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:09, time: 0.779, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0147, stage0_bag_acc: 98.8167, stage0_mean_ious: 0.4965, stage0_s: 0.4725, stage0_m: 0.2606, stage0_l: 0.0196, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0065, stage1_bag_acc: 98.3167, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.5808, stage1_s: 0.5869, stage1_m: 0.2529, stage1_l: 0.0187, stage1_h: 0.0000, loss: 0.0235, grad_norm: 1.9725
2024-10-15 15:11:59,499 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:35, time: 0.841, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0084, stage0_bag_acc: 99.8000, stage0_mean_ious: 0.4969, stage0_s: 0.4513, stage0_m: 0.3527, stage0_l: 0.0219, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 99.6000, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5794, stage1_s: 0.5608, stage1_m: 0.3463, stage1_l: 0.0155, stage1_h: 0.0000, loss: 0.0214, grad_norm: 1.6680
2024-10-15 15:12:25,435 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 15:13:11,890 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:38, time: 0.885, data_time: 0.058, memory: 7790, stage0_loss_instance_mil: 0.0110, stage0_bag_acc: 99.1682, stage0_mean_ious: 0.5014, stage0_s: 0.4591, stage0_m: 0.3578, stage0_l: 0.0101, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0066, stage1_bag_acc: 99.3000, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.5928, stage1_s: 0.5901, stage1_m: 0.3382, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.0248, grad_norm: 2.0541
2024-10-15 15:13:53,197 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:04, time: 0.826, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0230, stage0_bag_acc: 98.1182, stage0_mean_ious: 0.5224, stage0_s: 0.4751, stage0_m: 0.3347, stage0_l: 0.0157, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0092, stage1_bag_acc: 97.9682, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5883, stage1_s: 0.5644, stage1_m: 0.3292, stage1_l: 0.0144, stage1_h: 0.0000, loss: 0.0348, grad_norm: 2.1722
2024-10-15 15:14:33,303 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:30, time: 0.802, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0210, stage0_bag_acc: 98.0500, stage0_mean_ious: 0.5102, stage0_s: 0.4699, stage0_m: 0.3555, stage0_l: 0.0171, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0090, stage1_bag_acc: 98.3000, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5776, stage1_s: 0.5649, stage1_m: 0.3448, stage1_l: 0.0178, stage1_h: 0.0000, loss: 0.0349, grad_norm: 2.2980
2024-10-15 15:15:15,451 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:55, time: 0.843, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0226, stage0_bag_acc: 98.5182, stage0_mean_ious: 0.4916, stage0_s: 0.4475, stage0_m: 0.3359, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.7682, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5809, stage1_s: 0.5635, stage1_m: 0.3425, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0332, grad_norm: 2.3839
2024-10-15 15:15:55,947 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:20, time: 0.810, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0072, stage0_bag_acc: 99.7500, stage0_mean_ious: 0.5053, stage0_s: 0.4940, stage0_m: 0.2881, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0071, stage1_bag_acc: 99.7500, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.6004, stage1_s: 0.5970, stage1_m: 0.2853, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0164, grad_norm: 1.4689
2024-10-15 15:16:21,910 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 15:17:39,837 - mmdet - INFO - Evaluating bbox...
2024-10-15 15:17:40,333 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2422
2024-10-15 15:17:40,333 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7166
2024-10-15 15:17:40,333 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4790
2024-10-15 15:17:40,334 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1798
2024-10-15 15:17:40,334 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0779
2024-10-15 15:17:40,334 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0298
2024-10-15 15:17:40,334 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 15:17:40,334 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:17:40,334 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2531
2024-10-15 15:17:40,334 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0928
2024-10-15 15:17:40,334 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3438
2024-10-15 15:17:40,334 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8033
2024-10-15 15:17:40,334 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3438
2024-10-15 15:17:40,335 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3438
2024-10-15 15:17:40,335 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:17:40,335 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3622
2024-10-15 15:17:40,335 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1104
2024-10-15 15:17:40,341 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 15:17:40,341 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2420, bbox_mAP_50: 0.7170, bbox_mAP_75: 0.4790, bbox_mAP_s: 0.1800, bbox_mAP_m: 0.0780, bbox_mAP_l: 0.0300, bbox_mAP_copypaste: 0.242 0.717 0.479 0.180 0.078 0.030
2024-10-15 15:18:56,739 - mmdet - INFO - Evaluating bbox...
2024-10-15 15:18:57,303 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2422
2024-10-15 15:18:57,303 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7166
2024-10-15 15:18:57,304 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4790
2024-10-15 15:18:57,304 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1798
2024-10-15 15:18:57,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0779
2024-10-15 15:18:57,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0298
2024-10-15 15:18:57,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 15:18:57,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:18:57,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2531
2024-10-15 15:18:57,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0928
2024-10-15 15:18:57,305 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3438
2024-10-15 15:18:57,305 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8033
2024-10-15 15:18:57,305 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3438
2024-10-15 15:18:57,305 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3438
2024-10-15 15:18:57,305 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:18:57,306 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3622
2024-10-15 15:18:57,306 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1104
2024-10-15 15:18:58,611 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 15:18:59,527 - mmdet - INFO - Distributed training: False
2024-10-15 15:19:00,445 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 15:19:01,505 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 15:19:01,506 - mmdet - INFO - Use load_from_local loader
2024-10-15 15:19:01,819 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 15:19:01,837 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 15:19:01,837 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 15:19:47,359 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:50:13, time: 0.910, data_time: 0.057, memory: 7790, stage0_loss_instance_mil: 0.7135, stage0_bag_acc: 13.6000, stage0_mean_ious: 0.0657, stage0_s: 0.0589, stage0_m: 0.0477, stage0_l: 0.0011, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1729, stage1_bag_acc: 22.5482, stage1_neg_loss: 0.0006, stage1_mean_ious: 0.0692, stage1_s: 0.0621, stage1_m: 0.0491, stage1_l: 0.0012, stage1_h: 0.0000, loss: 0.8870, grad_norm: 5.9313
2024-10-15 15:20:29,162 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:47:26, time: 0.836, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.6944, stage0_bag_acc: 23.4176, stage0_mean_ious: 0.0830, stage0_s: 0.0727, stage0_m: 0.0706, stage0_l: 0.0026, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1743, stage1_bag_acc: 17.2660, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.0862, stage1_s: 0.0788, stage1_m: 0.0739, stage1_l: 0.0020, stage1_h: 0.0000, loss: 0.8697, grad_norm: 5.1888
2024-10-15 15:21:14,621 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:47:21, time: 0.909, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.6840, stage0_bag_acc: 19.6460, stage0_mean_ious: 0.0955, stage0_s: 0.0673, stage0_m: 0.1068, stage0_l: 0.0178, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1635, stage1_bag_acc: 29.5493, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.0951, stage1_s: 0.0662, stage1_m: 0.1140, stage1_l: 0.0117, stage1_h: 0.0000, loss: 0.8498, grad_norm: 6.4471
2024-10-15 15:21:57,811 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:46:20, time: 0.864, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.6406, stage0_bag_acc: 33.7773, stage0_mean_ious: 0.1508, stage0_s: 0.0996, stage0_m: 0.1322, stage0_l: 0.0604, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1584, stage1_bag_acc: 36.4463, stage1_neg_loss: 0.0153, stage1_mean_ious: 0.1582, stage1_s: 0.1092, stage1_m: 0.1340, stage1_l: 0.0456, stage1_h: 0.0000, loss: 0.8143, grad_norm: 10.2005
2024-10-15 15:22:39,986 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:45:13, time: 0.843, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.6154, stage0_bag_acc: 28.5500, stage0_mean_ious: 0.1505, stage0_s: 0.1176, stage0_m: 0.1463, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1432, stage1_bag_acc: 25.2333, stage1_neg_loss: 0.0185, stage1_mean_ious: 0.1710, stage1_s: 0.1310, stage1_m: 0.1715, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.7771, grad_norm: 9.0183
2024-10-15 15:23:04,440 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 15:23:52,524 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:40:24, time: 0.919, data_time: 0.057, memory: 7790, stage0_loss_instance_mil: 0.5110, stage0_bag_acc: 41.0939, stage0_mean_ious: 0.2804, stage0_s: 0.2169, stage0_m: 0.3615, stage0_l: 0.0181, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1071, stage1_bag_acc: 38.5701, stage1_neg_loss: 0.0162, stage1_mean_ious: 0.3410, stage1_s: 0.2852, stage1_m: 0.4002, stage1_l: 0.0135, stage1_h: 0.0000, loss: 0.6343, grad_norm: 10.1432
2024-10-15 15:24:34,158 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:39:57, time: 0.833, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.4038, stage0_bag_acc: 60.7865, stage0_mean_ious: 0.3235, stage0_s: 0.2842, stage0_m: 0.2396, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0981, stage1_bag_acc: 58.2000, stage1_neg_loss: 0.0222, stage1_mean_ious: 0.4026, stage1_s: 0.3739, stage1_m: 0.2608, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5242, grad_norm: 10.9596
2024-10-15 15:25:17,291 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:39:37, time: 0.863, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.3624, stage0_bag_acc: 66.0424, stage0_mean_ious: 0.3604, stage0_s: 0.3043, stage0_m: 0.2518, stage0_l: 0.0255, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1011, stage1_bag_acc: 64.7450, stage1_neg_loss: 0.0224, stage1_mean_ious: 0.4570, stage1_s: 0.4083, stage1_m: 0.2745, stage1_l: 0.0336, stage1_h: 0.0000, loss: 0.4860, grad_norm: 14.0972
2024-10-15 15:25:56,411 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:38:47, time: 0.782, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.2770, stage0_bag_acc: 76.3775, stage0_mean_ious: 0.3880, stage0_s: 0.3195, stage0_m: 0.3239, stage0_l: 0.0144, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0673, stage1_bag_acc: 76.9451, stage1_neg_loss: 0.0208, stage1_mean_ious: 0.4978, stage1_s: 0.4437, stage1_m: 0.3718, stage1_l: 0.0100, stage1_h: 0.0000, loss: 0.3651, grad_norm: 11.8404
2024-10-15 15:26:25,472 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:37:06, time: 0.581, data_time: 0.008, memory: 7790, stage0_loss_instance_mil: 0.2309, stage0_bag_acc: 79.5126, stage0_mean_ious: 0.3849, stage0_s: 0.3834, stage0_m: 0.1480, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0778, stage1_bag_acc: 81.9571, stage1_neg_loss: 0.0171, stage1_mean_ious: 0.5001, stage1_s: 0.5013, stage1_m: 0.1593, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.3259, grad_norm: 11.9832
2024-10-15 15:26:44,793 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 15:27:19,991 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:33:48, time: 0.660, data_time: 0.056, memory: 7790, stage0_loss_instance_mil: 0.1831, stage0_bag_acc: 83.3490, stage0_mean_ious: 0.4221, stage0_s: 0.4060, stage0_m: 0.1758, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0668, stage1_bag_acc: 85.1879, stage1_neg_loss: 0.0214, stage1_mean_ious: 0.5472, stage1_s: 0.5402, stage1_m: 0.1933, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2713, grad_norm: 11.7225
2024-10-15 15:27:51,417 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:32:49, time: 0.629, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.1476, stage0_bag_acc: 89.5293, stage0_mean_ious: 0.4663, stage0_s: 0.4068, stage0_m: 0.3913, stage0_l: 0.0076, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0451, stage1_bag_acc: 90.4667, stage1_neg_loss: 0.0151, stage1_mean_ious: 0.5633, stage1_s: 0.5335, stage1_m: 0.3980, stage1_l: 0.0085, stage1_h: 0.0000, loss: 0.2078, grad_norm: 9.2460
2024-10-15 15:28:29,596 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:32:19, time: 0.764, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0735, stage0_bag_acc: 94.4460, stage0_mean_ious: 0.4597, stage0_s: 0.4047, stage0_m: 0.3094, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0307, stage1_bag_acc: 94.2460, stage1_neg_loss: 0.0135, stage1_mean_ious: 0.5761, stage1_s: 0.5435, stage1_m: 0.3058, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1177, grad_norm: 6.0690
2024-10-15 15:29:14,892 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:32:12, time: 0.906, data_time: 0.011, memory: 7790, stage0_loss_instance_mil: 0.0920, stage0_bag_acc: 93.1056, stage0_mean_ious: 0.4626, stage0_s: 0.4040, stage0_m: 0.3368, stage0_l: 0.0077, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0334, stage1_bag_acc: 92.1698, stage1_neg_loss: 0.0118, stage1_mean_ious: 0.5616, stage1_s: 0.5455, stage1_m: 0.3396, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.1372, grad_norm: 7.3169
2024-10-15 15:29:56,416 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:31:49, time: 0.830, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.1158, stage0_bag_acc: 92.1310, stage0_mean_ious: 0.4657, stage0_s: 0.4225, stage0_m: 0.3436, stage0_l: 0.0159, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0352, stage1_bag_acc: 92.7452, stage1_neg_loss: 0.0097, stage1_mean_ious: 0.5613, stage1_s: 0.5477, stage1_m: 0.3373, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.1606, grad_norm: 7.5600
2024-10-15 15:30:21,009 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 15:31:39,046 - mmdet - INFO - Evaluating bbox...
2024-10-15 15:31:39,615 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1969
2024-10-15 15:31:39,615 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6652
2024-10-15 15:31:39,615 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3718
2024-10-15 15:31:39,616 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1129
2024-10-15 15:31:39,616 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0535
2024-10-15 15:31:39,616 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0171
2024-10-15 15:31:39,616 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0003
2024-10-15 15:31:39,616 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:31:39,616 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2069
2024-10-15 15:31:39,616 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0646
2024-10-15 15:31:39,616 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2985
2024-10-15 15:31:39,616 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7723
2024-10-15 15:31:39,616 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2985
2024-10-15 15:31:39,617 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2985
2024-10-15 15:31:39,617 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:31:39,617 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3149
2024-10-15 15:31:39,617 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1066
2024-10-15 15:31:39,623 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 15:31:39,623 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.1970, bbox_mAP_50: 0.6650, bbox_mAP_75: 0.3720, bbox_mAP_s: 0.1130, bbox_mAP_m: 0.0540, bbox_mAP_l: 0.0170, bbox_mAP_copypaste: 0.197 0.665 0.372 0.113 0.054 0.017
2024-10-15 15:32:23,994 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:30:06, time: 0.887, data_time: 0.059, memory: 7790, stage0_loss_instance_mil: 0.0855, stage0_bag_acc: 94.4905, stage0_mean_ious: 0.4754, stage0_s: 0.4425, stage0_m: 0.3463, stage0_l: 0.0090, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0260, stage1_bag_acc: 93.8738, stage1_neg_loss: 0.0113, stage1_mean_ious: 0.5951, stage1_s: 0.5870, stage1_m: 0.3727, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.1228, grad_norm: 5.8463
2024-10-15 15:33:04,486 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:29:39, time: 0.810, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0728, stage0_bag_acc: 95.0167, stage0_mean_ious: 0.4553, stage0_s: 0.4292, stage0_m: 0.2600, stage0_l: 0.0150, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0254, stage1_bag_acc: 94.6167, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5743, stage1_s: 0.5673, stage1_m: 0.2693, stage1_l: 0.0180, stage1_h: 0.0000, loss: 0.1040, grad_norm: 5.2813
2024-10-15 15:33:47,450 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:29:17, time: 0.859, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0663, stage0_bag_acc: 95.1434, stage0_mean_ious: 0.4972, stage0_s: 0.4529, stage0_m: 0.4221, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0199, stage1_bag_acc: 95.4473, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.5870, stage1_s: 0.5767, stage1_m: 0.4196, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0934, grad_norm: 4.9370
2024-10-15 15:34:28,733 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:28:50, time: 0.826, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0658, stage0_bag_acc: 95.0379, stage0_mean_ious: 0.4660, stage0_s: 0.4218, stage0_m: 0.2751, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0217, stage1_bag_acc: 94.6545, stage1_neg_loss: 0.0095, stage1_mean_ious: 0.5882, stage1_s: 0.5689, stage1_m: 0.2954, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0970, grad_norm: 5.3449
2024-10-15 15:35:09,758 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:28:20, time: 0.821, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0991, stage0_bag_acc: 92.3466, stage0_mean_ious: 0.4683, stage0_s: 0.4409, stage0_m: 0.3151, stage0_l: 0.0222, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0199, stage1_bag_acc: 93.8197, stage1_neg_loss: 0.0090, stage1_mean_ious: 0.5625, stage1_s: 0.5561, stage1_m: 0.3245, stage1_l: 0.0168, stage1_h: 0.0000, loss: 0.1280, grad_norm: 5.8946
2024-10-15 15:35:33,360 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 15:36:19,625 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:26:50, time: 0.881, data_time: 0.057, memory: 7790, stage0_loss_instance_mil: 0.0576, stage0_bag_acc: 96.1682, stage0_mean_ious: 0.4540, stage0_s: 0.4318, stage0_m: 0.2659, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0211, stage1_bag_acc: 97.0000, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.5794, stage1_s: 0.5792, stage1_m: 0.2759, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0862, grad_norm: 4.8618
2024-10-15 15:36:59,989 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:26:20, time: 0.807, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0566, stage0_bag_acc: 95.8293, stage0_mean_ious: 0.4701, stage0_s: 0.4331, stage0_m: 0.2672, stage0_l: 0.0218, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0200, stage1_bag_acc: 95.1960, stage1_neg_loss: 0.0087, stage1_mean_ious: 0.5642, stage1_s: 0.5484, stage1_m: 0.2827, stage1_l: 0.0224, stage1_h: 0.0000, loss: 0.0853, grad_norm: 4.7436
2024-10-15 15:37:42,098 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:25:51, time: 0.842, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0693, stage0_bag_acc: 94.8576, stage0_mean_ious: 0.5108, stage0_s: 0.4528, stage0_m: 0.3536, stage0_l: 0.0381, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0141, stage1_bag_acc: 95.4712, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5892, stage1_s: 0.5614, stage1_m: 0.3632, stage1_l: 0.0341, stage1_h: 0.0000, loss: 0.0878, grad_norm: 4.6024
2024-10-15 15:38:22,959 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:25:20, time: 0.817, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0581, stage0_bag_acc: 95.3833, stage0_mean_ious: 0.4633, stage0_s: 0.4336, stage0_m: 0.3236, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0123, stage1_bag_acc: 95.5333, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5760, stage1_s: 0.5597, stage1_m: 0.3600, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0749, grad_norm: 3.8835
2024-10-15 15:39:06,139 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:24:51, time: 0.864, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0610, stage0_bag_acc: 95.0111, stage0_mean_ious: 0.4756, stage0_s: 0.4080, stage0_m: 0.3294, stage0_l: 0.0273, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0209, stage1_bag_acc: 95.8556, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5600, stage1_s: 0.5349, stage1_m: 0.3160, stage1_l: 0.0177, stage1_h: 0.0000, loss: 0.0871, grad_norm: 4.9154
2024-10-15 15:39:31,361 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 15:40:17,176 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:23:30, time: 0.879, data_time: 0.056, memory: 7790, stage0_loss_instance_mil: 0.0332, stage0_bag_acc: 97.4976, stage0_mean_ious: 0.4965, stage0_s: 0.4445, stage0_m: 0.3514, stage0_l: 0.0099, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0130, stage1_bag_acc: 96.7833, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5865, stage1_s: 0.5560, stage1_m: 0.3424, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.0503, grad_norm: 3.4935
2024-10-15 15:40:58,756 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:22:59, time: 0.831, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0340, stage0_bag_acc: 97.7310, stage0_mean_ious: 0.4769, stage0_s: 0.4332, stage0_m: 0.3310, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0154, stage1_bag_acc: 97.5310, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.5718, stage1_s: 0.5622, stage1_m: 0.3365, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0561, grad_norm: 3.8688
2024-10-15 15:41:39,469 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:26, time: 0.814, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0478, stage0_bag_acc: 96.3348, stage0_mean_ious: 0.4717, stage0_s: 0.4099, stage0_m: 0.3141, stage0_l: 0.0341, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0230, stage1_bag_acc: 96.4848, stage1_neg_loss: 0.0109, stage1_mean_ious: 0.5734, stage1_s: 0.5357, stage1_m: 0.3300, stage1_l: 0.0305, stage1_h: 0.0000, loss: 0.0817, grad_norm: 4.9928
2024-10-15 15:42:22,584 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:21:56, time: 0.862, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0321, stage0_bag_acc: 98.1167, stage0_mean_ious: 0.4774, stage0_s: 0.4418, stage0_m: 0.2882, stage0_l: 0.0088, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0228, stage1_bag_acc: 98.0500, stage1_neg_loss: 0.0105, stage1_mean_ious: 0.5949, stage1_s: 0.5938, stage1_m: 0.2918, stage1_l: 0.0083, stage1_h: 0.0000, loss: 0.0655, grad_norm: 4.7814
2024-10-15 15:43:02,326 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:21, time: 0.795, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0590, stage0_bag_acc: 95.3643, stage0_mean_ious: 0.4759, stage0_s: 0.4336, stage0_m: 0.3909, stage0_l: 0.0249, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0135, stage1_bag_acc: 95.9810, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5739, stage1_s: 0.5614, stage1_m: 0.3975, stage1_l: 0.0172, stage1_h: 0.0000, loss: 0.0768, grad_norm: 4.1862
2024-10-15 15:43:23,386 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 15:44:40,275 - mmdet - INFO - Evaluating bbox...
2024-10-15 15:44:40,826 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1997
2024-10-15 15:44:40,827 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6805
2024-10-15 15:44:40,827 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3716
2024-10-15 15:44:40,827 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1117
2024-10-15 15:44:40,827 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0497
2024-10-15 15:44:40,827 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0146
2024-10-15 15:44:40,827 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0003
2024-10-15 15:44:40,827 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:44:40,827 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2084
2024-10-15 15:44:40,827 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0765
2024-10-15 15:44:40,827 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3047
2024-10-15 15:44:40,828 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7914
2024-10-15 15:44:40,828 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3047
2024-10-15 15:44:40,828 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3047
2024-10-15 15:44:40,828 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:44:40,828 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3196
2024-10-15 15:44:40,828 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1289
2024-10-15 15:44:40,833 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 15:44:40,833 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2000, bbox_mAP_50: 0.6800, bbox_mAP_75: 0.3720, bbox_mAP_s: 0.1120, bbox_mAP_m: 0.0500, bbox_mAP_l: 0.0150, bbox_mAP_copypaste: 0.200 0.680 0.372 0.112 0.050 0.015
2024-10-15 15:45:21,334 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:20:02, time: 0.810, data_time: 0.059, memory: 7790, stage0_loss_instance_mil: 0.0418, stage0_bag_acc: 97.3745, stage0_mean_ious: 0.4792, stage0_s: 0.4338, stage0_m: 0.3750, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0111, stage1_bag_acc: 97.3968, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5730, stage1_s: 0.5673, stage1_m: 0.3776, stage1_l: 0.0113, stage1_h: 0.0000, loss: 0.0583, grad_norm: 3.5877
2024-10-15 15:46:04,363 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:19:31, time: 0.861, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0403, stage0_bag_acc: 97.9143, stage0_mean_ious: 0.4979, stage0_s: 0.4571, stage0_m: 0.3588, stage0_l: 0.0107, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0138, stage1_bag_acc: 97.0786, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5862, stage1_s: 0.5777, stage1_m: 0.3590, stage1_l: 0.0096, stage1_h: 0.0000, loss: 0.0581, grad_norm: 3.4232
2024-10-15 15:46:46,985 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:18:59, time: 0.852, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0329, stage0_bag_acc: 97.1667, stage0_mean_ious: 0.4706, stage0_s: 0.4237, stage0_m: 0.3453, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0109, stage1_bag_acc: 97.1667, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.5885, stage1_s: 0.5666, stage1_m: 0.3476, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0462, grad_norm: 2.7293
2024-10-15 15:47:29,014 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:25, time: 0.841, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0381, stage0_bag_acc: 97.1173, stage0_mean_ious: 0.4782, stage0_s: 0.4549, stage0_m: 0.3146, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0164, stage1_bag_acc: 97.4333, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5634, stage1_s: 0.5608, stage1_m: 0.3105, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.0601, grad_norm: 3.8024
2024-10-15 15:48:11,502 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:17:52, time: 0.850, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0281, stage0_bag_acc: 98.1333, stage0_mean_ious: 0.4835, stage0_s: 0.4434, stage0_m: 0.3012, stage0_l: 0.0087, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0108, stage1_bag_acc: 98.3833, stage1_neg_loss: 0.0078, stage1_mean_ious: 0.5885, stage1_s: 0.5846, stage1_m: 0.2879, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0466, grad_norm: 3.5276
2024-10-15 15:48:36,427 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 15:49:22,555 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:41, time: 0.877, data_time: 0.059, memory: 7790, stage0_loss_instance_mil: 0.0344, stage0_bag_acc: 97.6500, stage0_mean_ious: 0.4918, stage0_s: 0.4517, stage0_m: 0.3412, stage0_l: 0.0173, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0178, stage1_bag_acc: 97.9833, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5852, stage1_s: 0.5874, stage1_m: 0.3409, stage1_l: 0.0179, stage1_h: 0.0000, loss: 0.0563, grad_norm: 3.7377
2024-10-15 15:50:05,722 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:16:07, time: 0.863, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0352, stage0_bag_acc: 97.4643, stage0_mean_ious: 0.4779, stage0_s: 0.4465, stage0_m: 0.3367, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0170, stage1_bag_acc: 97.9143, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.5708, stage1_s: 0.5679, stage1_m: 0.3459, stage1_l: 0.0066, stage1_h: 0.0000, loss: 0.0607, grad_norm: 3.6895
2024-10-15 15:50:49,150 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:34, time: 0.869, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0373, stage0_bag_acc: 96.8452, stage0_mean_ious: 0.4745, stage0_s: 0.4476, stage0_m: 0.3491, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0103, stage1_bag_acc: 96.5952, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5859, stage1_s: 0.5713, stage1_m: 0.3663, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0527, grad_norm: 3.9712
2024-10-15 15:51:31,862 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:15:00, time: 0.854, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0510, stage0_bag_acc: 96.8667, stage0_mean_ious: 0.4703, stage0_s: 0.4412, stage0_m: 0.2391, stage0_l: 0.0219, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0124, stage1_bag_acc: 97.1167, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5849, stage1_s: 0.5697, stage1_m: 0.2619, stage1_l: 0.0207, stage1_h: 0.0000, loss: 0.0673, grad_norm: 3.4304
2024-10-15 15:52:13,235 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:24, time: 0.827, data_time: 0.010, memory: 7790, stage0_loss_instance_mil: 0.0192, stage0_bag_acc: 98.9182, stage0_mean_ious: 0.4799, stage0_s: 0.4444, stage0_m: 0.3278, stage0_l: 0.0180, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 98.9182, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5740, stage1_s: 0.5827, stage1_m: 0.3052, stage1_l: 0.0152, stage1_h: 0.0000, loss: 0.0339, grad_norm: 2.4956
2024-10-15 15:52:38,101 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 15:53:23,976 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:16, time: 0.872, data_time: 0.058, memory: 7790, stage0_loss_instance_mil: 0.0268, stage0_bag_acc: 97.8278, stage0_mean_ious: 0.4914, stage0_s: 0.4515, stage0_m: 0.3210, stage0_l: 0.0104, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0118, stage1_bag_acc: 98.0500, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5708, stage1_s: 0.5728, stage1_m: 0.3008, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.0439, grad_norm: 2.8558
2024-10-15 15:54:05,061 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:41, time: 0.822, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0318, stage0_bag_acc: 98.0167, stage0_mean_ious: 0.4784, stage0_s: 0.4174, stage0_m: 0.2971, stage0_l: 0.0163, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0113, stage1_bag_acc: 98.1333, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5654, stage1_s: 0.5280, stage1_m: 0.3070, stage1_l: 0.0112, stage1_h: 0.0000, loss: 0.0467, grad_norm: 2.8660
2024-10-15 15:54:46,364 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:12:05, time: 0.826, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0187, stage0_bag_acc: 98.6404, stage0_mean_ious: 0.4822, stage0_s: 0.4507, stage0_m: 0.3017, stage0_l: 0.0065, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 98.7722, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.5746, stage1_s: 0.5669, stage1_m: 0.2976, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0349, grad_norm: 2.9103
2024-10-15 15:55:28,094 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:29, time: 0.834, data_time: 0.009, memory: 7790, stage0_loss_instance_mil: 0.0210, stage0_bag_acc: 98.2500, stage0_mean_ious: 0.4980, stage0_s: 0.4695, stage0_m: 0.3116, stage0_l: 0.0157, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0078, stage1_bag_acc: 97.6167, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5903, stage1_s: 0.5828, stage1_m: 0.2985, stage1_l: 0.0180, stage1_h: 0.0000, loss: 0.0310, grad_norm: 2.3833
2024-10-15 15:56:09,969 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:53, time: 0.838, data_time: 0.010, memory: 7791, stage0_loss_instance_mil: 0.0135, stage0_bag_acc: 99.8000, stage0_mean_ious: 0.4928, stage0_s: 0.4377, stage0_m: 0.3856, stage0_l: 0.0143, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0115, stage1_bag_acc: 98.9111, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5861, stage1_s: 0.5620, stage1_m: 0.3721, stage1_l: 0.0156, stage1_h: 0.0000, loss: 0.0287, grad_norm: 2.0364
2024-10-15 15:56:36,255 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 15:57:54,358 - mmdet - INFO - Evaluating bbox...
2024-10-15 15:57:54,842 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2009
2024-10-15 15:57:54,842 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6856
2024-10-15 15:57:54,842 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3662
2024-10-15 15:57:54,842 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1193
2024-10-15 15:57:54,842 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0506
2024-10-15 15:57:54,842 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0143
2024-10-15 15:57:54,842 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0002
2024-10-15 15:57:54,842 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:57:54,842 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2096
2024-10-15 15:57:54,843 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0718
2024-10-15 15:57:54,843 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3046
2024-10-15 15:57:54,843 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7950
2024-10-15 15:57:54,843 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3046
2024-10-15 15:57:54,843 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3046
2024-10-15 15:57:54,843 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 15:57:54,843 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3201
2024-10-15 15:57:54,843 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1100
2024-10-15 15:57:54,849 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 15:57:54,849 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2010, bbox_mAP_50: 0.6860, bbox_mAP_75: 0.3660, bbox_mAP_s: 0.1190, bbox_mAP_m: 0.0510, bbox_mAP_l: 0.0140, bbox_mAP_copypaste: 0.201 0.686 0.366 0.119 0.051 0.014
2024-10-15 15:58:39,711 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:48, time: 0.897, data_time: 0.059, memory: 7791, stage0_loss_instance_mil: 0.0222, stage0_bag_acc: 98.8500, stage0_mean_ious: 0.4749, stage0_s: 0.4022, stage0_m: 0.3321, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 98.3143, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5973, stage1_s: 0.5545, stage1_m: 0.3564, stage1_l: 0.0087, stage1_h: 0.0000, loss: 0.0343, grad_norm: 2.3295
2024-10-15 15:59:21,695 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:12, time: 0.840, data_time: 0.010, memory: 7791, stage0_loss_instance_mil: 0.0165, stage0_bag_acc: 98.8667, stage0_mean_ious: 0.5068, stage0_s: 0.4427, stage0_m: 0.3873, stage0_l: 0.0147, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.2476, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5852, stage1_s: 0.5654, stage1_m: 0.3749, stage1_l: 0.0115, stage1_h: 0.0000, loss: 0.0288, grad_norm: 1.9729
2024-10-15 16:00:04,742 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:37, time: 0.861, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0154, stage0_bag_acc: 98.8000, stage0_mean_ious: 0.4925, stage0_s: 0.4444, stage0_m: 0.4222, stage0_l: 0.0189, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0065, stage1_bag_acc: 98.8000, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5807, stage1_s: 0.5633, stage1_m: 0.4325, stage1_l: 0.0156, stage1_h: 0.0000, loss: 0.0277, grad_norm: 2.4601
2024-10-15 16:00:37,522 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:58, time: 0.656, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0204, stage0_bag_acc: 98.8682, stage0_mean_ious: 0.4858, stage0_s: 0.4233, stage0_m: 0.3078, stage0_l: 0.0130, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0103, stage1_bag_acc: 98.9182, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5725, stage1_s: 0.5390, stage1_m: 0.3018, stage1_l: 0.0145, stage1_h: 0.0000, loss: 0.0343, grad_norm: 2.3081
2024-10-15 16:01:12,060 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:20, time: 0.691, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0118, stage0_bag_acc: 99.3182, stage0_mean_ious: 0.4648, stage0_s: 0.4152, stage0_m: 0.3352, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.6325, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5759, stage1_s: 0.5482, stage1_m: 0.3674, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0230, grad_norm: 2.0829
2024-10-15 16:01:31,109 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 16:02:08,794 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:16, time: 0.710, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0150, stage0_bag_acc: 98.9310, stage0_mean_ious: 0.4834, stage0_s: 0.4247, stage0_m: 0.3322, stage0_l: 0.0265, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0083, stage1_bag_acc: 98.7310, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5701, stage1_s: 0.5409, stage1_m: 0.3300, stage1_l: 0.0211, stage1_h: 0.0000, loss: 0.0259, grad_norm: 1.7465
2024-10-15 16:02:50,677 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:40, time: 0.838, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0124, stage0_bag_acc: 99.2000, stage0_mean_ious: 0.4951, stage0_s: 0.4485, stage0_m: 0.3593, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0045, stage1_bag_acc: 99.2000, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5847, stage1_s: 0.5669, stage1_m: 0.3548, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0194, grad_norm: 1.5542
2024-10-15 16:03:31,890 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:03, time: 0.824, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0218, stage0_bag_acc: 98.5143, stage0_mean_ious: 0.4709, stage0_s: 0.4226, stage0_m: 0.2998, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.2643, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5554, stage1_s: 0.5348, stage1_m: 0.2897, stage1_l: 0.0074, stage1_h: 0.0000, loss: 0.0336, grad_norm: 2.2609
2024-10-15 16:04:13,093 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 16:04:13,094 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:27, time: 0.824, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0129, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.4978, stage0_s: 0.4643, stage0_m: 0.3767, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0061, stage1_bag_acc: 98.7500, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5912, stage1_s: 0.5974, stage1_m: 0.3667, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.0234, grad_norm: 1.9380
2024-10-15 16:04:55,943 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:50, time: 0.857, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0111, stage0_bag_acc: 99.3000, stage0_mean_ious: 0.4871, stage0_s: 0.4465, stage0_m: 0.2947, stage0_l: 0.0162, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0059, stage1_bag_acc: 99.0500, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.5980, stage1_s: 0.5879, stage1_m: 0.2859, stage1_l: 0.0123, stage1_h: 0.0000, loss: 0.0190, grad_norm: 1.5015
2024-10-15 16:05:21,651 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 16:06:10,114 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:50, time: 0.925, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0089, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.4885, stage0_s: 0.4602, stage0_m: 0.3614, stage0_l: 0.0261, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0052, stage1_bag_acc: 99.0500, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5870, stage1_s: 0.5908, stage1_m: 0.3689, stage1_l: 0.0282, stage1_h: 0.0000, loss: 0.0163, grad_norm: 1.4389
2024-10-15 16:06:52,572 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:13, time: 0.849, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0185, stage0_bag_acc: 98.6000, stage0_mean_ious: 0.4913, stage0_s: 0.4328, stage0_m: 0.3420, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0056, stage1_bag_acc: 98.8000, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5867, stage1_s: 0.5545, stage1_m: 0.3547, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0273, grad_norm: 1.8288
2024-10-15 16:07:25,127 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:36, time: 0.651, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0113, stage0_bag_acc: 99.2000, stage0_mean_ious: 0.4793, stage0_s: 0.4317, stage0_m: 0.3355, stage0_l: 0.0540, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0047, stage1_bag_acc: 99.2000, stage1_neg_loss: 0.0135, stage1_mean_ious: 0.5734, stage1_s: 0.5650, stage1_m: 0.3362, stage1_l: 0.0503, stage1_h: 0.0000, loss: 0.0296, grad_norm: 2.2391
2024-10-15 16:07:52,532 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.548, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0081, stage0_bag_acc: 99.5000, stage0_mean_ious: 0.4969, stage0_s: 0.4680, stage0_m: 0.2839, stage0_l: 0.0064, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0049, stage1_bag_acc: 99.8000, stage1_neg_loss: 0.0012, stage1_mean_ious: 0.6041, stage1_s: 0.5840, stage1_m: 0.3177, stage1_l: 0.0069, stage1_h: 0.0000, loss: 0.0142, grad_norm: 1.5258
2024-10-15 16:08:16,970 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:22, time: 0.489, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0178, stage0_bag_acc: 98.4667, stage0_mean_ious: 0.4837, stage0_s: 0.4553, stage0_m: 0.2608, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0075, stage1_bag_acc: 98.5167, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5710, stage1_s: 0.5674, stage1_m: 0.2504, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0309, grad_norm: 2.3963
2024-10-15 16:08:32,037 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 16:09:48,606 - mmdet - INFO - Evaluating bbox...
2024-10-15 16:09:49,110 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2011
2024-10-15 16:09:49,110 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6884
2024-10-15 16:09:49,110 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3626
2024-10-15 16:09:49,110 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1188
2024-10-15 16:09:49,110 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0525
2024-10-15 16:09:49,110 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0147
2024-10-15 16:09:49,110 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0002
2024-10-15 16:09:49,110 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:09:49,111 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2093
2024-10-15 16:09:49,111 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0746
2024-10-15 16:09:49,111 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3061
2024-10-15 16:09:49,111 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7955
2024-10-15 16:09:49,111 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3061
2024-10-15 16:09:49,111 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3061
2024-10-15 16:09:49,111 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:09:49,111 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3213
2024-10-15 16:09:49,111 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1098
2024-10-15 16:09:49,117 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 16:09:49,117 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2010, bbox_mAP_50: 0.6880, bbox_mAP_75: 0.3630, bbox_mAP_s: 0.1190, bbox_mAP_m: 0.0520, bbox_mAP_l: 0.0150, bbox_mAP_copypaste: 0.201 0.688 0.363 0.119 0.052 0.015
2024-10-15 16:11:04,162 - mmdet - INFO - Evaluating bbox...
2024-10-15 16:11:04,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2011
2024-10-15 16:11:04,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6884
2024-10-15 16:11:04,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3626
2024-10-15 16:11:04,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1188
2024-10-15 16:11:04,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0525
2024-10-15 16:11:04,638 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0147
2024-10-15 16:11:04,638 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0002
2024-10-15 16:11:04,638 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:11:04,638 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2093
2024-10-15 16:11:04,638 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0746
2024-10-15 16:11:04,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3061
2024-10-15 16:11:04,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7955
2024-10-15 16:11:04,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3061
2024-10-15 16:11:04,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3061
2024-10-15 16:11:04,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:11:04,638 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3213
2024-10-15 16:11:04,639 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1098
2024-10-15 16:11:05,926 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 16:11:06,829 - mmdet - INFO - Distributed training: False
2024-10-15 16:11:07,692 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 16:11:08,629 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 16:11:08,629 - mmdet - INFO - Use load_from_local loader
2024-10-15 16:11:08,907 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 16:11:08,926 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 16:11:08,927 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 16:11:37,518 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:31:32, time: 0.572, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.7148, stage0_bag_acc: 16.2172, stage0_mean_ious: 0.0462, stage0_s: 0.0350, stage0_m: 0.0536, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1670, stage1_bag_acc: 20.6524, stage1_neg_loss: 0.0006, stage1_mean_ious: 0.0500, stage1_s: 0.0392, stage1_m: 0.0557, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8824, grad_norm: 5.6080
2024-10-15 16:12:02,304 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:28:59, time: 0.496, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.6941, stage0_bag_acc: 17.7756, stage0_mean_ious: 0.0565, stage0_s: 0.0472, stage0_m: 0.0417, stage0_l: 0.0056, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1706, stage1_bag_acc: 28.6694, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.0633, stage1_s: 0.0521, stage1_m: 0.0477, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.8656, grad_norm: 6.1270
2024-10-15 16:12:26,990 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:27:50, time: 0.494, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.7037, stage0_bag_acc: 13.0242, stage0_mean_ious: 0.0855, stage0_s: 0.0718, stage0_m: 0.0690, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1593, stage1_bag_acc: 15.9879, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.0930, stage1_s: 0.0775, stage1_m: 0.0743, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8647, grad_norm: 6.7024
2024-10-15 16:12:51,360 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:26:58, time: 0.487, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.6668, stage0_bag_acc: 22.6063, stage0_mean_ious: 0.1132, stage0_s: 0.0995, stage0_m: 0.0840, stage0_l: 0.0158, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1495, stage1_bag_acc: 36.7040, stage1_neg_loss: 0.0108, stage1_mean_ious: 0.1154, stage1_s: 0.1063, stage1_m: 0.0830, stage1_l: 0.0087, stage1_h: 0.0000, loss: 0.8270, grad_norm: 8.7270
2024-10-15 16:13:15,945 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:26:20, time: 0.492, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.5805, stage0_bag_acc: 34.9683, stage0_mean_ious: 0.1757, stage0_s: 0.1475, stage0_m: 0.1245, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1403, stage1_bag_acc: 44.4761, stage1_neg_loss: 0.0270, stage1_mean_ious: 0.2041, stage1_s: 0.1750, stage1_m: 0.1455, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.7478, grad_norm: 10.4376
2024-10-15 16:13:31,193 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 16:13:59,271 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:23:23, time: 0.516, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.4997, stage0_bag_acc: 43.1551, stage0_mean_ious: 0.2691, stage0_s: 0.2329, stage0_m: 0.2000, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0980, stage1_bag_acc: 51.3481, stage1_neg_loss: 0.0262, stage1_mean_ious: 0.3609, stage1_s: 0.3224, stage1_m: 0.2366, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.6238, grad_norm: 10.9077
2024-10-15 16:14:24,284 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:23:14, time: 0.500, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.3904, stage0_bag_acc: 63.3302, stage0_mean_ious: 0.3227, stage0_s: 0.2805, stage0_m: 0.2285, stage0_l: 0.0177, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0970, stage1_bag_acc: 60.2937, stage1_neg_loss: 0.0185, stage1_mean_ious: 0.4078, stage1_s: 0.3830, stage1_m: 0.2460, stage1_l: 0.0181, stage1_h: 0.0000, loss: 0.5059, grad_norm: 10.6541
2024-10-15 16:14:50,221 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:23:08, time: 0.519, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.3017, stage0_bag_acc: 72.0880, stage0_mean_ious: 0.3748, stage0_s: 0.3278, stage0_m: 0.2938, stage0_l: 0.0133, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0847, stage1_bag_acc: 68.5951, stage1_neg_loss: 0.0160, stage1_mean_ious: 0.4775, stage1_s: 0.4545, stage1_m: 0.3332, stage1_l: 0.0122, stage1_h: 0.0000, loss: 0.4024, grad_norm: 10.0803
2024-10-15 16:15:15,274 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:22:53, time: 0.501, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.2740, stage0_bag_acc: 72.4838, stage0_mean_ious: 0.3668, stage0_s: 0.2901, stage0_m: 0.3128, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0814, stage1_bag_acc: 73.9742, stage1_neg_loss: 0.0154, stage1_mean_ious: 0.4672, stage1_s: 0.4093, stage1_m: 0.3556, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.3708, grad_norm: 11.0377
2024-10-15 16:15:39,963 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:22:33, time: 0.494, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1738, stage0_bag_acc: 86.3221, stage0_mean_ious: 0.4309, stage0_s: 0.3976, stage0_m: 0.3363, stage0_l: 0.0150, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0524, stage1_bag_acc: 86.1309, stage1_neg_loss: 0.0171, stage1_mean_ious: 0.5550, stage1_s: 0.5432, stage1_m: 0.3624, stage1_l: 0.0112, stage1_h: 0.0000, loss: 0.2433, grad_norm: 9.5281
2024-10-15 16:15:54,490 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 16:16:23,993 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:21:05, time: 0.546, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.1143, stage0_bag_acc: 91.1545, stage0_mean_ious: 0.4481, stage0_s: 0.3940, stage0_m: 0.3957, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0357, stage1_bag_acc: 93.0490, stage1_neg_loss: 0.0124, stage1_mean_ious: 0.5654, stage1_s: 0.5537, stage1_m: 0.3853, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1624, grad_norm: 7.4820
2024-10-15 16:16:48,891 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:20:50, time: 0.498, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1485, stage0_bag_acc: 87.2307, stage0_mean_ious: 0.4621, stage0_s: 0.4404, stage0_m: 0.2766, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0458, stage1_bag_acc: 88.1087, stage1_neg_loss: 0.0120, stage1_mean_ious: 0.5702, stage1_s: 0.5768, stage1_m: 0.2756, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2063, grad_norm: 8.8788
2024-10-15 16:17:13,703 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:20:33, time: 0.496, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1383, stage0_bag_acc: 90.1939, stage0_mean_ious: 0.4748, stage0_s: 0.4389, stage0_m: 0.4174, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0243, stage1_bag_acc: 92.3505, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5777, stage1_s: 0.5736, stage1_m: 0.4288, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1705, grad_norm: 6.0542
2024-10-15 16:17:39,782 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:20:19, time: 0.522, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1095, stage0_bag_acc: 90.8301, stage0_mean_ious: 0.4882, stage0_s: 0.4111, stage0_m: 0.4306, stage0_l: 0.0296, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0404, stage1_bag_acc: 92.3634, stage1_neg_loss: 0.0202, stage1_mean_ious: 0.5646, stage1_s: 0.5245, stage1_m: 0.4349, stage1_l: 0.0228, stage1_h: 0.0000, loss: 0.1701, grad_norm: 7.2253
2024-10-15 16:18:05,046 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:20:02, time: 0.505, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1012, stage0_bag_acc: 91.6500, stage0_mean_ious: 0.4418, stage0_s: 0.3717, stage0_m: 0.2891, stage0_l: 0.0268, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0342, stage1_bag_acc: 91.5643, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.5556, stage1_s: 0.5209, stage1_m: 0.2805, stage1_l: 0.0242, stage1_h: 0.0000, loss: 0.1438, grad_norm: 5.9346
2024-10-15 16:18:20,159 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 16:19:36,857 - mmdet - INFO - Evaluating bbox...
2024-10-15 16:19:37,434 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2091
2024-10-15 16:19:37,435 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6754
2024-10-15 16:19:37,435 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3989
2024-10-15 16:19:37,435 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1396
2024-10-15 16:19:37,435 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0601
2024-10-15 16:19:37,435 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0190
2024-10-15 16:19:37,435 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 16:19:37,435 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:19:37,435 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2203
2024-10-15 16:19:37,436 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0652
2024-10-15 16:19:37,436 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3164
2024-10-15 16:19:37,436 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7845
2024-10-15 16:19:37,436 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3164
2024-10-15 16:19:37,436 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3164
2024-10-15 16:19:37,436 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:19:37,436 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3362
2024-10-15 16:19:37,436 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0918
2024-10-15 16:19:37,441 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 16:19:37,441 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2090, bbox_mAP_50: 0.6750, bbox_mAP_75: 0.3990, bbox_mAP_s: 0.1400, bbox_mAP_m: 0.0600, bbox_mAP_l: 0.0190, bbox_mAP_copypaste: 0.209 0.675 0.399 0.140 0.060 0.019
2024-10-15 16:20:05,211 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:18:56, time: 0.555, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0755, stage0_bag_acc: 94.0111, stage0_mean_ious: 0.4653, stage0_s: 0.4194, stage0_m: 0.2887, stage0_l: 0.0313, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0238, stage1_bag_acc: 94.1944, stage1_neg_loss: 0.0100, stage1_mean_ious: 0.5674, stage1_s: 0.5454, stage1_m: 0.2961, stage1_l: 0.0250, stage1_h: 0.0000, loss: 0.1093, grad_norm: 4.5334
2024-10-15 16:20:31,168 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:18:41, time: 0.519, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0752, stage0_bag_acc: 93.9848, stage0_mean_ious: 0.4985, stage0_s: 0.4482, stage0_m: 0.3936, stage0_l: 0.0054, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0252, stage1_bag_acc: 94.4015, stage1_neg_loss: 0.0102, stage1_mean_ious: 0.5722, stage1_s: 0.5651, stage1_m: 0.3733, stage1_l: 0.0033, stage1_h: 0.0000, loss: 0.1106, grad_norm: 5.8406
2024-10-15 16:20:55,689 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:18:21, time: 0.490, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0632, stage0_bag_acc: 95.3087, stage0_mean_ious: 0.4981, stage0_s: 0.4515, stage0_m: 0.3769, stage0_l: 0.0191, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0215, stage1_bag_acc: 94.8397, stage1_neg_loss: 0.0123, stage1_mean_ious: 0.5852, stage1_s: 0.5834, stage1_m: 0.3324, stage1_l: 0.0115, stage1_h: 0.0000, loss: 0.0969, grad_norm: 5.2151
2024-10-15 16:21:21,185 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:18:03, time: 0.510, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0442, stage0_bag_acc: 96.1722, stage0_mean_ious: 0.4774, stage0_s: 0.4216, stage0_m: 0.2873, stage0_l: 0.0168, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0170, stage1_bag_acc: 96.3222, stage1_neg_loss: 0.0092, stage1_mean_ious: 0.5876, stage1_s: 0.5613, stage1_m: 0.3026, stage1_l: 0.0121, stage1_h: 0.0000, loss: 0.0704, grad_norm: 3.8971
2024-10-15 16:21:45,690 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:17:42, time: 0.490, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0698, stage0_bag_acc: 94.3173, stage0_mean_ious: 0.4927, stage0_s: 0.4469, stage0_m: 0.3440, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0158, stage1_bag_acc: 95.2006, stage1_neg_loss: 0.0088, stage1_mean_ious: 0.5757, stage1_s: 0.5663, stage1_m: 0.3260, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0944, grad_norm: 5.3669
2024-10-15 16:22:00,816 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 16:22:30,738 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:16:46, time: 0.554, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0683, stage0_bag_acc: 94.8143, stage0_mean_ious: 0.5025, stage0_s: 0.4506, stage0_m: 0.3476, stage0_l: 0.0352, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0166, stage1_bag_acc: 95.7643, stage1_neg_loss: 0.0065, stage1_mean_ious: 0.5729, stage1_s: 0.5691, stage1_m: 0.3117, stage1_l: 0.0276, stage1_h: 0.0000, loss: 0.0914, grad_norm: 4.5086
2024-10-15 16:22:55,635 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:16:27, time: 0.498, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0830, stage0_bag_acc: 93.9500, stage0_mean_ious: 0.4471, stage0_s: 0.4099, stage0_m: 0.2832, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0267, stage1_bag_acc: 94.1056, stage1_neg_loss: 0.0124, stage1_mean_ious: 0.5671, stage1_s: 0.5540, stage1_m: 0.3020, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1221, grad_norm: 4.8677
2024-10-15 16:23:20,878 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:16:07, time: 0.505, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0804, stage0_bag_acc: 93.7262, stage0_mean_ious: 0.4921, stage0_s: 0.4300, stage0_m: 0.2967, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0223, stage1_bag_acc: 94.3786, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5596, stage1_s: 0.5258, stage1_m: 0.2881, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1083, grad_norm: 5.1693
2024-10-15 16:23:46,207 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:15:47, time: 0.507, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0769, stage0_bag_acc: 93.7561, stage0_mean_ious: 0.4655, stage0_s: 0.3894, stage0_m: 0.3128, stage0_l: 0.0275, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0167, stage1_bag_acc: 92.7051, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5600, stage1_s: 0.5164, stage1_m: 0.3098, stage1_l: 0.0231, stage1_h: 0.0000, loss: 0.0989, grad_norm: 4.9404
2024-10-15 16:24:11,427 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:15:27, time: 0.504, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0491, stage0_bag_acc: 97.2444, stage0_mean_ious: 0.4892, stage0_s: 0.4243, stage0_m: 0.3928, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0125, stage1_bag_acc: 97.8000, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.5659, stage1_s: 0.5317, stage1_m: 0.3977, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0699, grad_norm: 4.5077
2024-10-15 16:24:26,559 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 16:24:56,967 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:14:38, time: 0.564, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0472, stage0_bag_acc: 96.7667, stage0_mean_ious: 0.4961, stage0_s: 0.4654, stage0_m: 0.3733, stage0_l: 0.0102, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0226, stage1_bag_acc: 95.0833, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.5884, stage1_s: 0.5901, stage1_m: 0.3720, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0783, grad_norm: 4.4928
2024-10-15 16:25:21,483 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:14:17, time: 0.490, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0323, stage0_bag_acc: 98.3421, stage0_mean_ious: 0.4807, stage0_s: 0.4549, stage0_m: 0.3585, stage0_l: 0.0189, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0166, stage1_bag_acc: 97.8421, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5614, stage1_s: 0.5415, stage1_m: 0.3746, stage1_l: 0.0163, stage1_h: 0.0000, loss: 0.0550, grad_norm: 3.9131
2024-10-15 16:25:46,601 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:13:56, time: 0.502, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0207, stage0_bag_acc: 98.7000, stage0_mean_ious: 0.4784, stage0_s: 0.4428, stage0_m: 0.3047, stage0_l: 0.0071, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0138, stage1_bag_acc: 98.1167, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.5722, stage1_s: 0.5607, stage1_m: 0.3073, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.0425, grad_norm: 2.8622
2024-10-15 16:26:11,415 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:13:35, time: 0.496, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0486, stage0_bag_acc: 96.0452, stage0_mean_ious: 0.4713, stage0_s: 0.4221, stage0_m: 0.3525, stage0_l: 0.0327, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0269, stage1_bag_acc: 95.9095, stage1_neg_loss: 0.0172, stage1_mean_ious: 0.5596, stage1_s: 0.5614, stage1_m: 0.3402, stage1_l: 0.0246, stage1_h: 0.0000, loss: 0.0927, grad_norm: 5.2723
2024-10-15 16:26:36,161 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:13:13, time: 0.495, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0427, stage0_bag_acc: 96.2810, stage0_mean_ious: 0.5187, stage0_s: 0.4879, stage0_m: 0.3782, stage0_l: 0.0115, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0161, stage1_bag_acc: 96.8810, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.5845, stage1_s: 0.5702, stage1_m: 0.3768, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0673, grad_norm: 3.6773
2024-10-15 16:26:51,011 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 16:28:07,746 - mmdet - INFO - Evaluating bbox...
2024-10-15 16:28:08,236 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1959
2024-10-15 16:28:08,236 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6586
2024-10-15 16:28:08,236 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3757
2024-10-15 16:28:08,236 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1087
2024-10-15 16:28:08,236 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0440
2024-10-15 16:28:08,237 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0146
2024-10-15 16:28:08,237 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-10-15 16:28:08,237 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:28:08,237 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2069
2024-10-15 16:28:08,237 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0633
2024-10-15 16:28:08,237 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3018
2024-10-15 16:28:08,237 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7787
2024-10-15 16:28:08,237 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3018
2024-10-15 16:28:08,237 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3018
2024-10-15 16:28:08,237 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:28:08,237 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3212
2024-10-15 16:28:08,238 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0865
2024-10-15 16:28:08,244 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 16:28:08,244 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.1960, bbox_mAP_50: 0.6590, bbox_mAP_75: 0.3760, bbox_mAP_s: 0.1090, bbox_mAP_m: 0.0440, bbox_mAP_l: 0.0150, bbox_mAP_copypaste: 0.196 0.659 0.376 0.109 0.044 0.015
2024-10-15 16:28:34,680 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:12:26, time: 0.529, data_time: 0.055, memory: 7795, stage0_loss_instance_mil: 0.0387, stage0_bag_acc: 96.1490, stage0_mean_ious: 0.4951, stage0_s: 0.4450, stage0_m: 0.3542, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0156, stage1_bag_acc: 96.2490, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5565, stage1_s: 0.5286, stage1_m: 0.3635, stage1_l: 0.0064, stage1_h: 0.0000, loss: 0.0596, grad_norm: 3.4565
2024-10-15 16:28:59,328 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:12:05, time: 0.493, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0447, stage0_bag_acc: 97.7825, stage0_mean_ious: 0.4826, stage0_s: 0.4353, stage0_m: 0.2996, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0191, stage1_bag_acc: 97.3500, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5629, stage1_s: 0.5476, stage1_m: 0.2965, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0707, grad_norm: 3.6022
2024-10-15 16:29:23,584 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:11:43, time: 0.485, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0318, stage0_bag_acc: 98.5667, stage0_mean_ious: 0.4772, stage0_s: 0.4276, stage0_m: 0.3377, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0113, stage1_bag_acc: 97.7333, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5724, stage1_s: 0.5510, stage1_m: 0.3320, stage1_l: 0.0045, stage1_h: 0.0000, loss: 0.0484, grad_norm: 2.8072
2024-10-15 16:29:48,858 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:11:22, time: 0.505, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0433, stage0_bag_acc: 97.0667, stage0_mean_ious: 0.4890, stage0_s: 0.4394, stage0_m: 0.4131, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0135, stage1_bag_acc: 97.0667, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.5707, stage1_s: 0.5720, stage1_m: 0.3939, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0640, grad_norm: 3.7796
2024-10-15 16:30:14,290 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:11:00, time: 0.509, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0363, stage0_bag_acc: 96.9810, stage0_mean_ious: 0.5150, stage0_s: 0.4407, stage0_m: 0.3770, stage0_l: 0.0441, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0157, stage1_bag_acc: 96.6667, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5817, stage1_s: 0.5401, stage1_m: 0.3761, stage1_l: 0.0316, stage1_h: 0.0000, loss: 0.0575, grad_norm: 3.5220
2024-10-15 16:30:29,044 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 16:30:58,263 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:10:17, time: 0.540, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0474, stage0_bag_acc: 96.3111, stage0_mean_ious: 0.4782, stage0_s: 0.4475, stage0_m: 0.2964, stage0_l: 0.0263, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0150, stage1_bag_acc: 96.5278, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5573, stage1_s: 0.5649, stage1_m: 0.2809, stage1_l: 0.0165, stage1_h: 0.0000, loss: 0.0671, grad_norm: 3.4346
2024-10-15 16:31:24,005 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:09:56, time: 0.515, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0308, stage0_bag_acc: 98.1143, stage0_mean_ious: 0.4798, stage0_s: 0.4229, stage0_m: 0.3752, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0146, stage1_bag_acc: 98.3643, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5605, stage1_s: 0.5441, stage1_m: 0.3820, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0510, grad_norm: 3.1408
2024-10-15 16:31:48,693 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:09:34, time: 0.494, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0683, stage0_bag_acc: 94.9500, stage0_mean_ious: 0.4889, stage0_s: 0.4485, stage0_m: 0.2965, stage0_l: 0.0096, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0151, stage1_bag_acc: 95.1000, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5635, stage1_s: 0.5450, stage1_m: 0.2912, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.0870, grad_norm: 5.0434
2024-10-15 16:32:14,802 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:09:13, time: 0.522, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0202, stage0_bag_acc: 98.8000, stage0_mean_ious: 0.5000, stage0_s: 0.4611, stage0_m: 0.3043, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0113, stage1_bag_acc: 98.3500, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5916, stage1_s: 0.5695, stage1_m: 0.3150, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0374, grad_norm: 2.8207
2024-10-15 16:32:39,536 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:08:50, time: 0.495, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0181, stage0_bag_acc: 98.9000, stage0_mean_ious: 0.4875, stage0_s: 0.4567, stage0_m: 0.3075, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5824, stage1_s: 0.5808, stage1_m: 0.3031, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0327, grad_norm: 2.3579
2024-10-15 16:32:54,598 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 16:33:23,739 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:08:09, time: 0.538, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.0186, stage0_bag_acc: 98.3833, stage0_mean_ious: 0.4958, stage0_s: 0.4586, stage0_m: 0.3673, stage0_l: 0.0195, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0057, stage1_bag_acc: 98.6333, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5742, stage1_s: 0.5746, stage1_m: 0.3424, stage1_l: 0.0103, stage1_h: 0.0000, loss: 0.0286, grad_norm: 2.1843
2024-10-15 16:33:48,340 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:07:47, time: 0.492, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0357, stage0_bag_acc: 96.2810, stage0_mean_ious: 0.4842, stage0_s: 0.4251, stage0_m: 0.3608, stage0_l: 0.0063, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0111, stage1_bag_acc: 96.3667, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5620, stage1_s: 0.5319, stage1_m: 0.3484, stage1_l: 0.0066, stage1_h: 0.0000, loss: 0.0499, grad_norm: 2.7202
2024-10-15 16:34:12,703 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:07:24, time: 0.487, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0329, stage0_bag_acc: 97.5000, stage0_mean_ious: 0.4892, stage0_s: 0.4710, stage0_m: 0.3209, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0121, stage1_bag_acc: 96.9643, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5702, stage1_s: 0.5723, stage1_m: 0.3198, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0481, grad_norm: 2.9387
2024-10-15 16:34:38,390 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:07:02, time: 0.514, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0111, stage0_bag_acc: 99.1682, stage0_mean_ious: 0.4989, stage0_s: 0.4571, stage0_m: 0.3203, stage0_l: 0.0272, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0085, stage1_bag_acc: 98.7182, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5774, stage1_s: 0.5620, stage1_m: 0.3248, stage1_l: 0.0197, stage1_h: 0.0000, loss: 0.0244, grad_norm: 1.9021
2024-10-15 16:35:02,358 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:06:40, time: 0.479, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0137, stage0_bag_acc: 98.9333, stage0_mean_ious: 0.4837, stage0_s: 0.4657, stage0_m: 0.2336, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0047, stage1_bag_acc: 98.7667, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5811, stage1_s: 0.5714, stage1_m: 0.2450, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0231, grad_norm: 2.1671
2024-10-15 16:35:17,098 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 16:36:33,544 - mmdet - INFO - Evaluating bbox...
2024-10-15 16:36:34,143 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1971
2024-10-15 16:36:34,144 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6684
2024-10-15 16:36:34,144 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3735
2024-10-15 16:36:34,144 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1094
2024-10-15 16:36:34,145 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0458
2024-10-15 16:36:34,145 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0152
2024-10-15 16:36:34,145 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 16:36:34,145 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:36:34,145 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2081
2024-10-15 16:36:34,146 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0697
2024-10-15 16:36:34,146 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3029
2024-10-15 16:36:34,146 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7792
2024-10-15 16:36:34,146 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3029
2024-10-15 16:36:34,146 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3029
2024-10-15 16:36:34,146 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:36:34,146 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3225
2024-10-15 16:36:34,147 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0895
2024-10-15 16:36:34,156 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 16:36:34,156 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.1970, bbox_mAP_50: 0.6680, bbox_mAP_75: 0.3740, bbox_mAP_s: 0.1090, bbox_mAP_m: 0.0460, bbox_mAP_l: 0.0150, bbox_mAP_copypaste: 0.197 0.668 0.374 0.109 0.046 0.015
2024-10-15 16:37:00,297 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:06:00, time: 0.523, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0220, stage0_bag_acc: 98.5167, stage0_mean_ious: 0.4961, stage0_s: 0.4524, stage0_m: 0.2697, stage0_l: 0.0135, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0087, stage1_bag_acc: 98.1833, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5773, stage1_s: 0.5625, stage1_m: 0.2504, stage1_l: 0.0111, stage1_h: 0.0000, loss: 0.0334, grad_norm: 1.7520
2024-10-15 16:37:24,965 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:05:37, time: 0.493, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0106, stage0_bag_acc: 99.2825, stage0_mean_ious: 0.5018, stage0_s: 0.4505, stage0_m: 0.4074, stage0_l: 0.0163, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0052, stage1_bag_acc: 99.2825, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.5726, stage1_s: 0.5656, stage1_m: 0.3792, stage1_l: 0.0116, stage1_h: 0.0000, loss: 0.0168, grad_norm: 1.4206
2024-10-15 16:37:49,712 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:05:15, time: 0.495, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0193, stage0_bag_acc: 98.5364, stage0_mean_ious: 0.4850, stage0_s: 0.4468, stage0_m: 0.2810, stage0_l: 0.0087, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 98.2682, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5710, stage1_s: 0.5592, stage1_m: 0.2864, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0327, grad_norm: 2.4020
2024-10-15 16:38:14,330 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:04:53, time: 0.492, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0268, stage0_bag_acc: 97.7237, stage0_mean_ious: 0.4992, stage0_s: 0.4541, stage0_m: 0.3273, stage0_l: 0.0110, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0104, stage1_bag_acc: 98.1278, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5704, stage1_s: 0.5526, stage1_m: 0.3309, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.0419, grad_norm: 3.0318
2024-10-15 16:38:39,856 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:04:30, time: 0.511, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.2182, stage0_mean_ious: 0.4948, stage0_s: 0.4417, stage0_m: 0.4009, stage0_l: 0.0252, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0068, stage1_bag_acc: 99.1325, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5781, stage1_s: 0.5473, stage1_m: 0.4053, stage1_l: 0.0202, stage1_h: 0.0000, loss: 0.0213, grad_norm: 1.6874
2024-10-15 16:38:55,537 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 16:39:26,365 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:03:52, time: 0.572, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.0239, stage0_bag_acc: 97.4722, stage0_mean_ious: 0.5000, stage0_s: 0.4653, stage0_m: 0.3404, stage0_l: 0.0237, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0090, stage1_bag_acc: 98.5278, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5739, stage1_s: 0.5677, stage1_m: 0.3644, stage1_l: 0.0294, stage1_h: 0.0000, loss: 0.0354, grad_norm: 3.0154
2024-10-15 16:39:51,698 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:03:30, time: 0.507, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0238, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.5075, stage0_s: 0.4625, stage0_m: 0.3170, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0116, stage1_bag_acc: 98.3000, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5827, stage1_s: 0.5598, stage1_m: 0.3022, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0370, grad_norm: 2.1189
2024-10-15 16:40:17,963 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:03:07, time: 0.525, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0121, stage0_bag_acc: 99.5778, stage0_mean_ious: 0.5068, stage0_s: 0.4305, stage0_m: 0.3835, stage0_l: 0.0157, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0039, stage1_bag_acc: 99.5778, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5888, stage1_s: 0.5491, stage1_m: 0.3943, stage1_l: 0.0142, stage1_h: 0.0000, loss: 0.0217, grad_norm: 1.9371
2024-10-15 16:40:42,539 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 16:40:42,539 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:02:45, time: 0.492, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0191, stage0_bag_acc: 98.7000, stage0_mean_ious: 0.4841, stage0_s: 0.4468, stage0_m: 0.2897, stage0_l: 0.0162, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0105, stage1_bag_acc: 98.3000, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5524, stage1_s: 0.5534, stage1_m: 0.2636, stage1_l: 0.0114, stage1_h: 0.0000, loss: 0.0313, grad_norm: 2.2017
2024-10-15 16:41:07,561 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:02:22, time: 0.500, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0303, stage0_bag_acc: 98.1182, stage0_mean_ious: 0.4786, stage0_s: 0.4440, stage0_m: 0.3116, stage0_l: 0.0161, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 98.1182, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5501, stage1_s: 0.5546, stage1_m: 0.2974, stage1_l: 0.0091, stage1_h: 0.0000, loss: 0.0418, grad_norm: 2.3535
2024-10-15 16:41:23,421 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 16:41:53,801 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:01:45, time: 0.563, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.0091, stage0_bag_acc: 99.0167, stage0_mean_ious: 0.5027, stage0_s: 0.4322, stage0_m: 0.3382, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0031, stage1_bag_acc: 99.1333, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5904, stage1_s: 0.5675, stage1_m: 0.3331, stage1_l: 0.0044, stage1_h: 0.0000, loss: 0.0157, grad_norm: 1.4739
2024-10-15 16:42:18,031 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:01:22, time: 0.485, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0200, stage0_bag_acc: 98.0500, stage0_mean_ious: 0.4591, stage0_s: 0.4150, stage0_m: 0.3085, stage0_l: 0.0090, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0084, stage1_bag_acc: 98.4000, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5508, stage1_s: 0.5266, stage1_m: 0.2963, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.0315, grad_norm: 2.2921
2024-10-15 16:42:44,684 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.533, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0143, stage0_bag_acc: 98.6126, stage0_mean_ious: 0.5174, stage0_s: 0.4502, stage0_m: 0.3787, stage0_l: 0.0175, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0058, stage1_bag_acc: 98.8348, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5761, stage1_s: 0.5578, stage1_m: 0.3606, stage1_l: 0.0152, stage1_h: 0.0000, loss: 0.0222, grad_norm: 1.8980
2024-10-15 16:43:07,957 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:36, time: 0.465, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0334, stage0_bag_acc: 97.6500, stage0_mean_ious: 0.4938, stage0_s: 0.4650, stage0_m: 0.2454, stage0_l: 0.0166, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0099, stage1_bag_acc: 97.5500, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5641, stage1_s: 0.5645, stage1_m: 0.2342, stage1_l: 0.0109, stage1_h: 0.0000, loss: 0.0470, grad_norm: 3.4651
2024-10-15 16:43:32,578 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:13, time: 0.492, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0074, stage0_bag_acc: 99.7500, stage0_mean_ious: 0.5058, stage0_s: 0.4494, stage0_m: 0.3621, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0044, stage1_bag_acc: 99.0500, stage1_neg_loss: 0.0128, stage1_mean_ious: 0.5812, stage1_s: 0.5584, stage1_m: 0.3697, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0247, grad_norm: 1.8844
2024-10-15 16:43:47,203 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 16:45:03,842 - mmdet - INFO - Evaluating bbox...
2024-10-15 16:45:04,319 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1962
2024-10-15 16:45:04,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6730
2024-10-15 16:45:04,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3724
2024-10-15 16:45:04,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1044
2024-10-15 16:45:04,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0448
2024-10-15 16:45:04,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0152
2024-10-15 16:45:04,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 16:45:04,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:45:04,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2072
2024-10-15 16:45:04,321 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0704
2024-10-15 16:45:04,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3018
2024-10-15 16:45:04,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7806
2024-10-15 16:45:04,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3018
2024-10-15 16:45:04,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3018
2024-10-15 16:45:04,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:45:04,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3212
2024-10-15 16:45:04,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0909
2024-10-15 16:45:04,327 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 16:45:04,327 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.1960, bbox_mAP_50: 0.6730, bbox_mAP_75: 0.3720, bbox_mAP_s: 0.1040, bbox_mAP_m: 0.0450, bbox_mAP_l: 0.0150, bbox_mAP_copypaste: 0.196 0.673 0.372 0.104 0.045 0.015
2024-10-15 16:46:21,049 - mmdet - INFO - Evaluating bbox...
2024-10-15 16:46:21,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1962
2024-10-15 16:46:21,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6730
2024-10-15 16:46:21,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3724
2024-10-15 16:46:21,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1044
2024-10-15 16:46:21,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0448
2024-10-15 16:46:21,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0152
2024-10-15 16:46:21,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 16:46:21,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:46:21,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2072
2024-10-15 16:46:21,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0704
2024-10-15 16:46:21,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3018
2024-10-15 16:46:21,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7806
2024-10-15 16:46:21,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3018
2024-10-15 16:46:21,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3018
2024-10-15 16:46:21,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:46:21,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3212
2024-10-15 16:46:21,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0909
2024-10-15 16:46:22,904 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 16:46:23,785 - mmdet - INFO - Distributed training: False
2024-10-15 16:46:24,667 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 16:46:25,609 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 16:46:25,609 - mmdet - INFO - Use load_from_local loader
2024-10-15 16:46:25,884 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 16:46:25,903 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 16:46:25,903 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 16:46:53,051 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:29:56, time: 0.543, data_time: 0.055, memory: 7795, stage0_loss_instance_mil: 0.7419, stage0_bag_acc: 2.0889, stage0_mean_ious: 0.0565, stage0_s: 0.0496, stage0_m: 0.0496, stage0_l: 0.0160, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1569, stage1_bag_acc: 13.8929, stage1_neg_loss: 0.0003, stage1_mean_ious: 0.0625, stage1_s: 0.0547, stage1_m: 0.0552, stage1_l: 0.0162, stage1_h: 0.0000, loss: 0.8990, grad_norm: 5.6440
2024-10-15 16:47:18,485 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:28:34, time: 0.509, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.7159, stage0_bag_acc: 13.8532, stage0_mean_ious: 0.0606, stage0_s: 0.0469, stage0_m: 0.0730, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1620, stage1_bag_acc: 16.7136, stage1_neg_loss: 0.0005, stage1_mean_ious: 0.0633, stage1_s: 0.0505, stage1_m: 0.0677, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8784, grad_norm: 4.4442
2024-10-15 16:47:44,021 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:27:51, time: 0.511, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.6901, stage0_bag_acc: 19.1857, stage0_mean_ious: 0.0770, stage0_s: 0.0616, stage0_m: 0.0755, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1632, stage1_bag_acc: 24.2596, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.0818, stage1_s: 0.0653, stage1_m: 0.0770, stage1_l: 0.0066, stage1_h: 0.0000, loss: 0.8551, grad_norm: 5.3500
2024-10-15 16:48:09,196 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:27:11, time: 0.504, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.6763, stage0_bag_acc: 19.2245, stage0_mean_ious: 0.1603, stage0_s: 0.1353, stage0_m: 0.1165, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1494, stage1_bag_acc: 15.7972, stage1_neg_loss: 0.0076, stage1_mean_ious: 0.1813, stage1_s: 0.1550, stage1_m: 0.1225, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8334, grad_norm: 7.2815
2024-10-15 16:48:34,641 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:26:41, time: 0.509, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.6443, stage0_bag_acc: 23.9242, stage0_mean_ious: 0.1473, stage0_s: 0.1375, stage0_m: 0.0839, stage0_l: 0.0002, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1295, stage1_bag_acc: 43.0543, stage1_neg_loss: 0.0156, stage1_mean_ious: 0.1762, stage1_s: 0.1646, stage1_m: 0.0984, stage1_l: 0.0002, stage1_h: 0.0000, loss: 0.7895, grad_norm: 7.8371
2024-10-15 16:48:49,126 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 16:49:18,455 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:23:50, time: 0.542, data_time: 0.055, memory: 7795, stage0_loss_instance_mil: 0.5331, stage0_bag_acc: 40.6833, stage0_mean_ious: 0.2416, stage0_s: 0.2285, stage0_m: 0.1748, stage0_l: 0.0006, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0989, stage1_bag_acc: 58.2230, stage1_neg_loss: 0.0199, stage1_mean_ious: 0.3196, stage1_s: 0.3102, stage1_m: 0.2134, stage1_l: 0.0006, stage1_h: 0.0000, loss: 0.6518, grad_norm: 7.9777
2024-10-15 16:49:42,279 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:23:28, time: 0.476, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.5224, stage0_bag_acc: 43.2175, stage0_mean_ious: 0.2825, stage0_s: 0.2637, stage0_m: 0.1997, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1034, stage1_bag_acc: 54.1213, stage1_neg_loss: 0.0199, stage1_mean_ious: 0.3606, stage1_s: 0.3547, stage1_m: 0.2427, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.6457, grad_norm: 11.1988
2024-10-15 16:50:09,303 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:23:28, time: 0.540, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.3655, stage0_bag_acc: 66.0657, stage0_mean_ious: 0.3542, stage0_s: 0.3056, stage0_m: 0.2923, stage0_l: 0.0226, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0961, stage1_bag_acc: 67.1879, stage1_neg_loss: 0.0173, stage1_mean_ious: 0.4749, stage1_s: 0.4498, stage1_m: 0.3450, stage1_l: 0.0171, stage1_h: 0.0000, loss: 0.4790, grad_norm: 13.0083
2024-10-15 16:50:34,858 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:23:13, time: 0.511, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.3546, stage0_bag_acc: 69.9677, stage0_mean_ious: 0.3702, stage0_s: 0.3445, stage0_m: 0.2485, stage0_l: 0.0465, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0804, stage1_bag_acc: 70.5790, stage1_neg_loss: 0.0171, stage1_mean_ious: 0.4907, stage1_s: 0.4709, stage1_m: 0.2999, stage1_l: 0.0376, stage1_h: 0.0000, loss: 0.4522, grad_norm: 12.0747
2024-10-15 16:51:00,533 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:22:57, time: 0.513, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.2164, stage0_bag_acc: 81.9649, stage0_mean_ious: 0.4088, stage0_s: 0.3575, stage0_m: 0.3267, stage0_l: 0.0096, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0535, stage1_bag_acc: 84.8316, stage1_neg_loss: 0.0128, stage1_mean_ious: 0.5256, stage1_s: 0.4797, stage1_m: 0.3801, stage1_l: 0.0051, stage1_h: 0.0000, loss: 0.2828, grad_norm: 9.9815
2024-10-15 16:51:15,837 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 16:51:46,287 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:21:29, time: 0.564, data_time: 0.055, memory: 7795, stage0_loss_instance_mil: 0.1778, stage0_bag_acc: 85.2556, stage0_mean_ious: 0.4354, stage0_s: 0.3956, stage0_m: 0.3148, stage0_l: 0.0239, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0417, stage1_bag_acc: 86.2722, stage1_neg_loss: 0.0104, stage1_mean_ious: 0.5515, stage1_s: 0.5474, stage1_m: 0.3317, stage1_l: 0.0190, stage1_h: 0.0000, loss: 0.2299, grad_norm: 8.2236
2024-10-15 16:52:10,914 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:21:11, time: 0.493, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1528, stage0_bag_acc: 87.7878, stage0_mean_ious: 0.4780, stage0_s: 0.4360, stage0_m: 0.3733, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0398, stage1_bag_acc: 89.9211, stage1_neg_loss: 0.0154, stage1_mean_ious: 0.5798, stage1_s: 0.5699, stage1_m: 0.3814, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2080, grad_norm: 8.3143
2024-10-15 16:52:35,504 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:20:51, time: 0.492, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1298, stage0_bag_acc: 89.5394, stage0_mean_ious: 0.4631, stage0_s: 0.4224, stage0_m: 0.3215, stage0_l: 0.0140, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0318, stage1_bag_acc: 90.8530, stage1_neg_loss: 0.0113, stage1_mean_ious: 0.5843, stage1_s: 0.5502, stage1_m: 0.3477, stage1_l: 0.0132, stage1_h: 0.0000, loss: 0.1730, grad_norm: 8.3137
2024-10-15 16:52:59,857 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:20:30, time: 0.487, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1420, stage0_bag_acc: 89.0483, stage0_mean_ious: 0.4581, stage0_s: 0.4201, stage0_m: 0.3135, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0303, stage1_bag_acc: 91.3673, stage1_neg_loss: 0.0101, stage1_mean_ious: 0.5738, stage1_s: 0.5652, stage1_m: 0.3491, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1824, grad_norm: 7.7192
2024-10-15 16:53:25,194 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:20:12, time: 0.507, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1052, stage0_bag_acc: 91.1056, stage0_mean_ious: 0.4633, stage0_s: 0.3916, stage0_m: 0.3368, stage0_l: 0.0097, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0323, stage1_bag_acc: 91.7278, stage1_neg_loss: 0.0088, stage1_mean_ious: 0.5748, stage1_s: 0.5253, stage1_m: 0.3513, stage1_l: 0.0050, stage1_h: 0.0000, loss: 0.1462, grad_norm: 5.5528
2024-10-15 16:53:39,487 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 16:54:54,895 - mmdet - INFO - Evaluating bbox...
2024-10-15 16:54:55,405 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1987
2024-10-15 16:54:55,405 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6508
2024-10-15 16:54:55,405 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3805
2024-10-15 16:54:55,405 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1226
2024-10-15 16:54:55,405 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0596
2024-10-15 16:54:55,405 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0195
2024-10-15 16:54:55,405 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 16:54:55,406 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:54:55,406 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2059
2024-10-15 16:54:55,406 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0837
2024-10-15 16:54:55,406 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3026
2024-10-15 16:54:55,406 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7684
2024-10-15 16:54:55,406 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3026
2024-10-15 16:54:55,406 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3026
2024-10-15 16:54:55,406 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 16:54:55,406 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3164
2024-10-15 16:54:55,406 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1036
2024-10-15 16:54:55,411 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 16:54:55,411 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.1990, bbox_mAP_50: 0.6510, bbox_mAP_75: 0.3810, bbox_mAP_s: 0.1230, bbox_mAP_m: 0.0600, bbox_mAP_l: 0.0190, bbox_mAP_copypaste: 0.199 0.651 0.381 0.123 0.060 0.019
2024-10-15 16:55:22,096 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:19:02, time: 0.534, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.1223, stage0_bag_acc: 89.9167, stage0_mean_ious: 0.4865, stage0_s: 0.4338, stage0_m: 0.3157, stage0_l: 0.0124, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0352, stage1_bag_acc: 89.9833, stage1_neg_loss: 0.0155, stage1_mean_ious: 0.5914, stage1_s: 0.5778, stage1_m: 0.3186, stage1_l: 0.0143, stage1_h: 0.0000, loss: 0.1729, grad_norm: 8.0594
2024-10-15 16:55:46,412 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:18:42, time: 0.486, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0975, stage0_bag_acc: 93.0159, stage0_mean_ious: 0.4475, stage0_s: 0.4025, stage0_m: 0.3527, stage0_l: 0.0138, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0312, stage1_bag_acc: 93.4357, stage1_neg_loss: 0.0114, stage1_mean_ious: 0.5594, stage1_s: 0.5507, stage1_m: 0.3572, stage1_l: 0.0156, stage1_h: 0.0000, loss: 0.1400, grad_norm: 5.7777
2024-10-15 16:56:11,980 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:18:25, time: 0.511, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0477, stage0_bag_acc: 96.8212, stage0_mean_ious: 0.4709, stage0_s: 0.4346, stage0_m: 0.3293, stage0_l: 0.0090, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0205, stage1_bag_acc: 97.0030, stage1_neg_loss: 0.0101, stage1_mean_ious: 0.5786, stage1_s: 0.5642, stage1_m: 0.3338, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0783, grad_norm: 4.6949
2024-10-15 16:56:36,149 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:18:03, time: 0.483, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0634, stage0_bag_acc: 95.2643, stage0_mean_ious: 0.4883, stage0_s: 0.4691, stage0_m: 0.3108, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0231, stage1_bag_acc: 95.9810, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5758, stage1_s: 0.5727, stage1_m: 0.3360, stage1_l: 0.0074, stage1_h: 0.0000, loss: 0.0954, grad_norm: 5.1221
2024-10-15 16:57:00,701 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:17:42, time: 0.491, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0909, stage0_bag_acc: 94.5444, stage0_mean_ious: 0.4569, stage0_s: 0.4300, stage0_m: 0.3285, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0239, stage1_bag_acc: 92.8126, stage1_neg_loss: 0.0133, stage1_mean_ious: 0.5799, stage1_s: 0.5722, stage1_m: 0.3645, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1281, grad_norm: 6.8394
2024-10-15 16:57:16,528 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 16:57:46,138 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:16:46, time: 0.548, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0790, stage0_bag_acc: 94.1076, stage0_mean_ious: 0.4689, stage0_s: 0.4255, stage0_m: 0.2894, stage0_l: 0.0212, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0245, stage1_bag_acc: 94.5734, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5607, stage1_s: 0.5435, stage1_m: 0.2803, stage1_l: 0.0192, stage1_h: 0.0000, loss: 0.1099, grad_norm: 5.4578
2024-10-15 16:58:11,785 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:16:28, time: 0.513, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0544, stage0_bag_acc: 96.1409, stage0_mean_ious: 0.4590, stage0_s: 0.4285, stage0_m: 0.3794, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0185, stage1_bag_acc: 96.8591, stage1_neg_loss: 0.0120, stage1_mean_ious: 0.5760, stage1_s: 0.5634, stage1_m: 0.4303, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.0850, grad_norm: 4.9814
2024-10-15 16:58:36,284 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:16:07, time: 0.490, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0464, stage0_bag_acc: 95.6833, stage0_mean_ious: 0.4796, stage0_s: 0.4411, stage0_m: 0.3151, stage0_l: 0.0138, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0238, stage1_bag_acc: 96.8667, stage1_neg_loss: 0.0103, stage1_mean_ious: 0.5939, stage1_s: 0.5822, stage1_m: 0.3289, stage1_l: 0.0127, stage1_h: 0.0000, loss: 0.0805, grad_norm: 5.0802
2024-10-15 16:59:01,252 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:15:47, time: 0.499, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0856, stage0_bag_acc: 93.3381, stage0_mean_ious: 0.4771, stage0_s: 0.4246, stage0_m: 0.3306, stage0_l: 0.0099, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0184, stage1_bag_acc: 92.3714, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5777, stage1_s: 0.5571, stage1_m: 0.3370, stage1_l: 0.0051, stage1_h: 0.0000, loss: 0.1080, grad_norm: 5.1662
2024-10-15 16:59:25,379 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:15:25, time: 0.483, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0567, stage0_bag_acc: 95.8167, stage0_mean_ious: 0.4734, stage0_s: 0.4461, stage0_m: 0.3520, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0204, stage1_bag_acc: 95.4333, stage1_neg_loss: 0.0116, stage1_mean_ious: 0.5566, stage1_s: 0.5671, stage1_m: 0.3460, stage1_l: 0.0059, stage1_h: 0.0000, loss: 0.0887, grad_norm: 4.8776
2024-10-15 16:59:41,094 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 17:00:10,405 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:14:34, time: 0.542, data_time: 0.055, memory: 7795, stage0_loss_instance_mil: 0.0820, stage0_bag_acc: 95.7530, stage0_mean_ious: 0.4694, stage0_s: 0.4240, stage0_m: 0.3258, stage0_l: 0.0099, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0226, stage1_bag_acc: 96.6530, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.5590, stage1_s: 0.5454, stage1_m: 0.3225, stage1_l: 0.0080, stage1_h: 0.0000, loss: 0.1121, grad_norm: 4.4360
2024-10-15 17:00:35,645 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:14:14, time: 0.505, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1007, stage0_bag_acc: 92.7048, stage0_mean_ious: 0.4713, stage0_s: 0.4413, stage0_m: 0.2854, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0203, stage1_bag_acc: 93.8381, stage1_neg_loss: 0.0079, stage1_mean_ious: 0.5750, stage1_s: 0.5692, stage1_m: 0.2904, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1289, grad_norm: 5.9504
2024-10-15 17:01:00,606 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:13:54, time: 0.499, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0384, stage0_bag_acc: 97.7727, stage0_mean_ious: 0.4743, stage0_s: 0.4440, stage0_m: 0.3365, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0126, stage1_bag_acc: 97.5227, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.5659, stage1_s: 0.5592, stage1_m: 0.3526, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0596, grad_norm: 3.4458
2024-10-15 17:01:25,925 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:13:33, time: 0.506, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0431, stage0_bag_acc: 96.5143, stage0_mean_ious: 0.4835, stage0_s: 0.4359, stage0_m: 0.3782, stage0_l: 0.0166, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0139, stage1_bag_acc: 97.1643, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5822, stage1_s: 0.5654, stage1_m: 0.3921, stage1_l: 0.0098, stage1_h: 0.0000, loss: 0.0608, grad_norm: 2.8306
2024-10-15 17:01:50,249 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:13:11, time: 0.486, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0426, stage0_bag_acc: 97.7167, stage0_mean_ious: 0.4903, stage0_s: 0.4517, stage0_m: 0.3202, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0168, stage1_bag_acc: 97.4310, stage1_neg_loss: 0.0100, stage1_mean_ious: 0.5761, stage1_s: 0.5617, stage1_m: 0.3351, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0694, grad_norm: 3.6553
2024-10-15 17:02:05,344 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 17:03:21,227 - mmdet - INFO - Evaluating bbox...
2024-10-15 17:03:21,779 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2137
2024-10-15 17:03:21,779 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6746
2024-10-15 17:03:21,779 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4168
2024-10-15 17:03:21,780 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1436
2024-10-15 17:03:21,780 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0645
2024-10-15 17:03:21,780 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0229
2024-10-15 17:03:21,780 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-15 17:03:21,780 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:03:21,780 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2233
2024-10-15 17:03:21,780 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0777
2024-10-15 17:03:21,780 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3164
2024-10-15 17:03:21,780 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7821
2024-10-15 17:03:21,781 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3164
2024-10-15 17:03:21,781 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3164
2024-10-15 17:03:21,781 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:03:21,781 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3337
2024-10-15 17:03:21,781 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0957
2024-10-15 17:03:21,786 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 17:03:21,786 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2140, bbox_mAP_50: 0.6750, bbox_mAP_75: 0.4170, bbox_mAP_s: 0.1440, bbox_mAP_m: 0.0640, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.214 0.675 0.417 0.144 0.064 0.023
2024-10-15 17:03:49,466 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:12:25, time: 0.553, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0489, stage0_bag_acc: 96.4468, stage0_mean_ious: 0.4936, stage0_s: 0.4611, stage0_m: 0.3329, stage0_l: 0.0157, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0140, stage1_bag_acc: 96.7245, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.6108, stage1_s: 0.6058, stage1_m: 0.3601, stage1_l: 0.0129, stage1_h: 0.0000, loss: 0.0692, grad_norm: 4.0532
2024-10-15 17:04:13,930 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:12:04, time: 0.489, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0635, stage0_bag_acc: 94.6833, stage0_mean_ious: 0.4730, stage0_s: 0.4398, stage0_m: 0.3685, stage0_l: 0.0055, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0172, stage1_bag_acc: 95.1333, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5815, stage1_s: 0.5802, stage1_m: 0.3856, stage1_l: 0.0042, stage1_h: 0.0000, loss: 0.0862, grad_norm: 3.9689
2024-10-15 17:04:38,513 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:11:42, time: 0.492, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0425, stage0_bag_acc: 97.1278, stage0_mean_ious: 0.4789, stage0_s: 0.4359, stage0_m: 0.2949, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0137, stage1_bag_acc: 96.5778, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5864, stage1_s: 0.5828, stage1_m: 0.2930, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0599, grad_norm: 3.3432
2024-10-15 17:05:03,728 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:11:21, time: 0.504, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0370, stage0_bag_acc: 96.6333, stage0_mean_ious: 0.4937, stage0_s: 0.4477, stage0_m: 0.3369, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0122, stage1_bag_acc: 97.3500, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5915, stage1_s: 0.5873, stage1_m: 0.3341, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0547, grad_norm: 3.9848
2024-10-15 17:05:28,390 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:10:59, time: 0.493, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0590, stage0_bag_acc: 95.3434, stage0_mean_ious: 0.5067, stage0_s: 0.4606, stage0_m: 0.3335, stage0_l: 0.0162, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0116, stage1_bag_acc: 96.6657, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5998, stage1_s: 0.5782, stage1_m: 0.3382, stage1_l: 0.0162, stage1_h: 0.0000, loss: 0.0754, grad_norm: 3.9848
2024-10-15 17:05:42,795 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 17:06:12,942 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:10:16, time: 0.559, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0281, stage0_bag_acc: 98.3278, stage0_mean_ious: 0.4882, stage0_s: 0.4528, stage0_m: 0.3160, stage0_l: 0.0165, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0112, stage1_bag_acc: 98.6778, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5819, stage1_s: 0.5788, stage1_m: 0.3177, stage1_l: 0.0123, stage1_h: 0.0000, loss: 0.0436, grad_norm: 2.5681
2024-10-15 17:06:36,633 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:09:54, time: 0.474, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0388, stage0_bag_acc: 97.4419, stage0_mean_ious: 0.4783, stage0_s: 0.4296, stage0_m: 0.2760, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0111, stage1_bag_acc: 97.8919, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5912, stage1_s: 0.5676, stage1_m: 0.2825, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0546, grad_norm: 3.3934
2024-10-15 17:07:02,021 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:09:33, time: 0.508, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0305, stage0_bag_acc: 98.6778, stage0_mean_ious: 0.4983, stage0_s: 0.4467, stage0_m: 0.3567, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0119, stage1_bag_acc: 97.5167, stage1_neg_loss: 0.0045, stage1_mean_ious: 0.5849, stage1_s: 0.5584, stage1_m: 0.3570, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0469, grad_norm: 3.0280
2024-10-15 17:07:27,638 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:09:11, time: 0.512, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0316, stage0_bag_acc: 97.3278, stage0_mean_ious: 0.5173, stage0_s: 0.4474, stage0_m: 0.4297, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 98.2500, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5915, stage1_s: 0.5837, stage1_m: 0.4160, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0487, grad_norm: 3.4590
2024-10-15 17:07:52,256 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:08:49, time: 0.492, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0296, stage0_bag_acc: 98.4476, stage0_mean_ious: 0.4695, stage0_s: 0.4284, stage0_m: 0.3447, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0125, stage1_bag_acc: 98.1500, stage1_neg_loss: 0.0136, stage1_mean_ious: 0.5672, stage1_s: 0.5593, stage1_m: 0.3267, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0558, grad_norm: 3.2322
2024-10-15 17:08:08,212 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 17:08:37,612 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:08:08, time: 0.544, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0216, stage0_bag_acc: 98.7000, stage0_mean_ious: 0.4937, stage0_s: 0.4384, stage0_m: 0.3085, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0079, stage1_bag_acc: 98.4500, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5942, stage1_s: 0.5684, stage1_m: 0.3090, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0327, grad_norm: 2.3755
2024-10-15 17:09:03,617 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:07:46, time: 0.520, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0172, stage0_bag_acc: 98.8000, stage0_mean_ious: 0.4915, stage0_s: 0.4381, stage0_m: 0.3887, stage0_l: 0.0105, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 98.7167, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5884, stage1_s: 0.5665, stage1_m: 0.4139, stage1_l: 0.0066, stage1_h: 0.0000, loss: 0.0320, grad_norm: 1.6758
2024-10-15 17:09:29,442 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:07:25, time: 0.516, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0218, stage0_bag_acc: 97.8167, stage0_mean_ious: 0.4885, stage0_s: 0.4667, stage0_m: 0.3197, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.2667, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5832, stage1_s: 0.5820, stage1_m: 0.3293, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0319, grad_norm: 2.3635
2024-10-15 17:09:54,842 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:07:03, time: 0.508, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0160, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.4928, stage0_s: 0.4536, stage0_m: 0.4039, stage0_l: 0.0268, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0092, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5878, stage1_s: 0.5910, stage1_m: 0.3963, stage1_l: 0.0224, stage1_h: 0.0000, loss: 0.0276, grad_norm: 1.9022
2024-10-15 17:10:20,188 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:06:40, time: 0.507, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0125, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.4861, stage0_s: 0.4600, stage0_m: 0.3097, stage0_l: 0.0125, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0080, stage1_bag_acc: 98.9000, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5920, stage1_s: 0.6049, stage1_m: 0.3030, stage1_l: 0.0119, stage1_h: 0.0000, loss: 0.0242, grad_norm: 2.0204
2024-10-15 17:10:35,435 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 17:11:51,113 - mmdet - INFO - Evaluating bbox...
2024-10-15 17:11:51,592 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2083
2024-10-15 17:11:51,593 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6757
2024-10-15 17:11:51,593 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3981
2024-10-15 17:11:51,593 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1236
2024-10-15 17:11:51,593 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0591
2024-10-15 17:11:51,593 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0184
2024-10-15 17:11:51,593 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0011
2024-10-15 17:11:51,593 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:11:51,593 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2188
2024-10-15 17:11:51,594 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0807
2024-10-15 17:11:51,594 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3157
2024-10-15 17:11:51,594 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7910
2024-10-15 17:11:51,594 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3157
2024-10-15 17:11:51,594 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3157
2024-10-15 17:11:51,594 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:11:51,594 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3339
2024-10-15 17:11:51,594 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1086
2024-10-15 17:11:51,600 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 17:11:51,600 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2080, bbox_mAP_50: 0.6760, bbox_mAP_75: 0.3980, bbox_mAP_s: 0.1240, bbox_mAP_m: 0.0590, bbox_mAP_l: 0.0180, bbox_mAP_copypaste: 0.208 0.676 0.398 0.124 0.059 0.018
2024-10-15 17:12:19,106 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:06:01, time: 0.550, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0241, stage0_bag_acc: 97.6833, stage0_mean_ious: 0.4868, stage0_s: 0.4339, stage0_m: 0.3383, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0083, stage1_bag_acc: 98.4167, stage1_neg_loss: 0.0096, stage1_mean_ious: 0.5855, stage1_s: 0.5661, stage1_m: 0.3507, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.0420, grad_norm: 2.6467
2024-10-15 17:12:44,326 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:05:38, time: 0.504, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0203, stage0_bag_acc: 98.4667, stage0_mean_ious: 0.4864, stage0_s: 0.4396, stage0_m: 0.2764, stage0_l: 0.0227, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0108, stage1_bag_acc: 98.1333, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5774, stage1_s: 0.5598, stage1_m: 0.2784, stage1_l: 0.0297, stage1_h: 0.0000, loss: 0.0346, grad_norm: 2.4467
2024-10-15 17:13:25,931 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:05:20, time: 0.832, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0335, stage0_bag_acc: 97.5348, stage0_mean_ious: 0.4840, stage0_s: 0.4481, stage0_m: 0.3289, stage0_l: 0.0175, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0183, stage1_bag_acc: 97.4667, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5681, stage1_s: 0.5505, stage1_m: 0.3233, stage1_l: 0.0172, stage1_h: 0.0000, loss: 0.0547, grad_norm: 3.2730
2024-10-15 17:14:07,787 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:05:02, time: 0.837, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0094, stage0_bag_acc: 99.3000, stage0_mean_ious: 0.5048, stage0_s: 0.4574, stage0_m: 0.2836, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0041, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0015, stage1_mean_ious: 0.5777, stage1_s: 0.5497, stage1_m: 0.2732, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0151, grad_norm: 1.1005
2024-10-15 17:14:51,507 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:04:42, time: 0.874, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0170, stage0_bag_acc: 99.0500, stage0_mean_ious: 0.5013, stage0_s: 0.4562, stage0_m: 0.3942, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0040, stage1_bag_acc: 99.0500, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5971, stage1_s: 0.5823, stage1_m: 0.4039, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0230, grad_norm: 1.5834
2024-10-15 17:15:18,336 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 17:16:06,248 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:04:05, time: 0.914, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0215, stage0_bag_acc: 98.5500, stage0_mean_ious: 0.5123, stage0_s: 0.4688, stage0_m: 0.3822, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0080, stage1_bag_acc: 98.5500, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5913, stage1_s: 0.5876, stage1_m: 0.3608, stage1_l: 0.0097, stage1_h: 0.0000, loss: 0.0311, grad_norm: 2.1670
2024-10-15 17:16:50,640 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:03:44, time: 0.888, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0165, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.4994, stage0_s: 0.4641, stage0_m: 0.4093, stage0_l: 0.0094, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0069, stage1_bag_acc: 98.7000, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5877, stage1_s: 0.5775, stage1_m: 0.4095, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0286, grad_norm: 2.3316
2024-10-15 17:17:31,349 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:03:22, time: 0.814, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0217, stage0_bag_acc: 98.7045, stage0_mean_ious: 0.4653, stage0_s: 0.4314, stage0_m: 0.3141, stage0_l: 0.0319, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0083, stage1_bag_acc: 98.9364, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5782, stage1_s: 0.5753, stage1_m: 0.3066, stage1_l: 0.0354, stage1_h: 0.0000, loss: 0.0336, grad_norm: 2.2351
2024-10-15 17:18:15,348 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 17:18:15,349 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:03:00, time: 0.880, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0171, stage0_bag_acc: 98.4000, stage0_mean_ious: 0.4864, stage0_s: 0.4536, stage0_m: 0.3509, stage0_l: 0.0151, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0095, stage1_bag_acc: 98.1500, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5744, stage1_s: 0.5606, stage1_m: 0.3738, stage1_l: 0.0133, stage1_h: 0.0000, loss: 0.0318, grad_norm: 2.4393
2024-10-15 17:19:01,887 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:02:37, time: 0.931, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0095, stage0_bag_acc: 99.5000, stage0_mean_ious: 0.4983, stage0_s: 0.4284, stage0_m: 0.4111, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0056, stage1_bag_acc: 99.5000, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5897, stage1_s: 0.5618, stage1_m: 0.4029, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0184, grad_norm: 1.8361
2024-10-15 17:19:28,188 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 17:20:16,922 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:01:57, time: 0.930, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0092, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.5023, stage0_s: 0.4400, stage0_m: 0.4528, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0040, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5926, stage1_s: 0.5692, stage1_m: 0.4584, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0156, grad_norm: 1.4062
2024-10-15 17:21:00,580 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:01:32, time: 0.873, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0274, stage0_bag_acc: 98.5167, stage0_mean_ious: 0.4858, stage0_s: 0.4518, stage0_m: 0.3124, stage0_l: 0.0105, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0126, stage1_bag_acc: 98.6000, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5881, stage1_s: 0.5893, stage1_m: 0.3259, stage1_l: 0.0065, stage1_h: 0.0000, loss: 0.0416, grad_norm: 2.5960
2024-10-15 17:21:42,670 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:07, time: 0.842, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0140, stage0_bag_acc: 98.7848, stage0_mean_ious: 0.5192, stage0_s: 0.4782, stage0_m: 0.3909, stage0_l: 0.0089, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 98.6348, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5936, stage1_s: 0.5696, stage1_m: 0.4112, stage1_l: 0.0045, stage1_h: 0.0000, loss: 0.0226, grad_norm: 1.9838
2024-10-15 17:22:25,551 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:42, time: 0.858, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0311, stage0_bag_acc: 97.0476, stage0_mean_ious: 0.5082, stage0_s: 0.4448, stage0_m: 0.3645, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0126, stage1_bag_acc: 97.2143, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5838, stage1_s: 0.5536, stage1_m: 0.3607, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0468, grad_norm: 3.2622
2024-10-15 17:23:06,905 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:15, time: 0.827, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0424, stage0_bag_acc: 96.3626, stage0_mean_ious: 0.4662, stage0_s: 0.4027, stage0_m: 0.3253, stage0_l: 0.0098, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0085, stage1_bag_acc: 96.1626, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5700, stage1_s: 0.5334, stage1_m: 0.3323, stage1_l: 0.0077, stage1_h: 0.0000, loss: 0.0546, grad_norm: 3.1569
2024-10-15 17:23:31,362 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 17:24:49,831 - mmdet - INFO - Evaluating bbox...
2024-10-15 17:24:50,412 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2056
2024-10-15 17:24:50,412 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6723
2024-10-15 17:24:50,412 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3900
2024-10-15 17:24:50,412 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1245
2024-10-15 17:24:50,412 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0583
2024-10-15 17:24:50,413 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0197
2024-10-15 17:24:50,413 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-10-15 17:24:50,413 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:24:50,413 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2158
2024-10-15 17:24:50,413 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0850
2024-10-15 17:24:50,413 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3118
2024-10-15 17:24:50,413 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7864
2024-10-15 17:24:50,413 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3118
2024-10-15 17:24:50,413 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3118
2024-10-15 17:24:50,413 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:24:50,414 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3294
2024-10-15 17:24:50,414 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1161
2024-10-15 17:24:50,419 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 17:24:50,419 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2060, bbox_mAP_50: 0.6720, bbox_mAP_75: 0.3900, bbox_mAP_s: 0.1250, bbox_mAP_m: 0.0580, bbox_mAP_l: 0.0200, bbox_mAP_copypaste: 0.206 0.672 0.390 0.125 0.058 0.020
2024-10-15 17:26:06,993 - mmdet - INFO - Evaluating bbox...
2024-10-15 17:26:07,493 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2056
2024-10-15 17:26:07,493 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6723
2024-10-15 17:26:07,493 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3900
2024-10-15 17:26:07,493 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1245
2024-10-15 17:26:07,493 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0583
2024-10-15 17:26:07,494 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0197
2024-10-15 17:26:07,494 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-10-15 17:26:07,494 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:26:07,494 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2158
2024-10-15 17:26:07,494 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0850
2024-10-15 17:26:07,494 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3118
2024-10-15 17:26:07,494 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7864
2024-10-15 17:26:07,494 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3118
2024-10-15 17:26:07,494 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3118
2024-10-15 17:26:07,494 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:26:07,494 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3294
2024-10-15 17:26:07,495 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1161
2024-10-15 17:26:08,761 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 17:26:09,675 - mmdet - INFO - Distributed training: False
2024-10-15 17:26:10,553 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 17:26:11,496 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 17:26:11,496 - mmdet - INFO - Use load_from_local loader
2024-10-15 17:26:11,885 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 17:26:11,903 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 17:26:11,903 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 17:26:57,426 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:50:13, time: 0.910, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.7504, stage0_bag_acc: 16.3654, stage0_mean_ious: 0.0392, stage0_s: 0.0239, stage0_m: 0.0398, stage0_l: 0.0022, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1465, stage1_bag_acc: 17.8939, stage1_neg_loss: 0.0015, stage1_mean_ious: 0.0423, stage1_s: 0.0252, stage1_m: 0.0451, stage1_l: 0.0032, stage1_h: 0.0000, loss: 0.8984, grad_norm: 5.1857
2024-10-15 17:27:38,446 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:47:01, time: 0.820, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.7149, stage0_bag_acc: 17.4500, stage0_mean_ious: 0.0752, stage0_s: 0.0683, stage0_m: 0.0575, stage0_l: 0.0021, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1599, stage1_bag_acc: 10.2913, stage1_neg_loss: 0.0015, stage1_mean_ious: 0.0792, stage1_s: 0.0727, stage1_m: 0.0577, stage1_l: 0.0034, stage1_h: 0.0000, loss: 0.8762, grad_norm: 5.0125
2024-10-15 17:28:11,745 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:42:44, time: 0.666, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.6962, stage0_bag_acc: 18.1617, stage0_mean_ious: 0.1000, stage0_s: 0.0842, stage0_m: 0.1003, stage0_l: 0.0089, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1560, stage1_bag_acc: 16.9576, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.1030, stage1_s: 0.0888, stage1_m: 0.0972, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.8549, grad_norm: 5.8360
2024-10-15 17:28:45,560 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:40:27, time: 0.676, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.6702, stage0_bag_acc: 21.5027, stage0_mean_ious: 0.1518, stage0_s: 0.1198, stage0_m: 0.1273, stage0_l: 0.0050, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1470, stage1_bag_acc: 22.7813, stage1_neg_loss: 0.0098, stage1_mean_ious: 0.1708, stage1_s: 0.1421, stage1_m: 0.1313, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.8270, grad_norm: 8.5004
2024-10-15 17:29:18,984 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:38:47, time: 0.668, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.6122, stage0_bag_acc: 31.5561, stage0_mean_ious: 0.2047, stage0_s: 0.1450, stage0_m: 0.1873, stage0_l: 0.0261, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1288, stage1_bag_acc: 30.1005, stage1_neg_loss: 0.0205, stage1_mean_ious: 0.2238, stage1_s: 0.1726, stage1_m: 0.1831, stage1_l: 0.0267, stage1_h: 0.0000, loss: 0.7615, grad_norm: 9.6572
2024-10-15 17:29:38,063 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 17:30:26,274 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:35:39, time: 0.919, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.4852, stage0_bag_acc: 51.2091, stage0_mean_ious: 0.2946, stage0_s: 0.2403, stage0_m: 0.2763, stage0_l: 0.0245, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0897, stage1_bag_acc: 51.2451, stage1_neg_loss: 0.0185, stage1_mean_ious: 0.3875, stage1_s: 0.3403, stage1_m: 0.3319, stage1_l: 0.0222, stage1_h: 0.0000, loss: 0.5935, grad_norm: 11.3019
2024-10-15 17:31:09,651 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:36:07, time: 0.868, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.4214, stage0_bag_acc: 59.7613, stage0_mean_ious: 0.3473, stage0_s: 0.2936, stage0_m: 0.2743, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0867, stage1_bag_acc: 59.1292, stage1_neg_loss: 0.0143, stage1_mean_ious: 0.4633, stage1_s: 0.4297, stage1_m: 0.3010, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5224, grad_norm: 10.6315
2024-10-15 17:31:51,462 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:36:08, time: 0.836, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.2864, stage0_bag_acc: 75.2356, stage0_mean_ious: 0.4043, stage0_s: 0.3328, stage0_m: 0.3427, stage0_l: 0.0118, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0714, stage1_bag_acc: 74.8205, stage1_neg_loss: 0.0164, stage1_mean_ious: 0.4966, stage1_s: 0.4625, stage1_m: 0.3548, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.3743, grad_norm: 9.6194
2024-10-15 17:32:33,888 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:36:03, time: 0.849, data_time: 0.011, memory: 7795, stage0_loss_instance_mil: 0.2270, stage0_bag_acc: 84.0022, stage0_mean_ious: 0.4171, stage0_s: 0.3348, stage0_m: 0.3184, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0760, stage1_bag_acc: 81.7633, stage1_neg_loss: 0.0203, stage1_mean_ious: 0.5385, stage1_s: 0.4774, stage1_m: 0.3392, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.3232, grad_norm: 10.0860
2024-10-15 17:33:16,859 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:35:55, time: 0.859, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.1758, stage0_bag_acc: 85.7444, stage0_mean_ious: 0.4321, stage0_s: 0.3798, stage0_m: 0.3921, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0560, stage1_bag_acc: 86.6506, stage1_neg_loss: 0.0211, stage1_mean_ious: 0.5358, stage1_s: 0.5249, stage1_m: 0.4075, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2529, grad_norm: 7.7966
2024-10-15 17:33:40,252 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 17:34:27,140 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:33:43, time: 0.903, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.1499, stage0_bag_acc: 87.7111, stage0_mean_ious: 0.4238, stage0_s: 0.3683, stage0_m: 0.3474, stage0_l: 0.0210, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0473, stage1_bag_acc: 89.0889, stage1_neg_loss: 0.0108, stage1_mean_ious: 0.5534, stage1_s: 0.5322, stage1_m: 0.3727, stage1_l: 0.0190, stage1_h: 0.0000, loss: 0.2080, grad_norm: 7.0301
2024-10-15 17:35:08,312 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:33:24, time: 0.824, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.1284, stage0_bag_acc: 90.4132, stage0_mean_ious: 0.4510, stage0_s: 0.4128, stage0_m: 0.3118, stage0_l: 0.0058, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0421, stage1_bag_acc: 91.4030, stage1_neg_loss: 0.0096, stage1_mean_ious: 0.5719, stage1_s: 0.5663, stage1_m: 0.2966, stage1_l: 0.0048, stage1_h: 0.0000, loss: 0.1801, grad_norm: 6.0553
2024-10-15 17:35:50,063 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:33:04, time: 0.835, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.1216, stage0_bag_acc: 91.1000, stage0_mean_ious: 0.4801, stage0_s: 0.4329, stage0_m: 0.3261, stage0_l: 0.0117, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0384, stage1_bag_acc: 92.0667, stage1_neg_loss: 0.0186, stage1_mean_ious: 0.5906, stage1_s: 0.5774, stage1_m: 0.3212, stage1_l: 0.0061, stage1_h: 0.0000, loss: 0.1786, grad_norm: 7.9894
2024-10-15 17:36:31,986 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:32:42, time: 0.838, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.1268, stage0_bag_acc: 91.3008, stage0_mean_ious: 0.4635, stage0_s: 0.4216, stage0_m: 0.3935, stage0_l: 0.0176, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0402, stage1_bag_acc: 91.3452, stage1_neg_loss: 0.0152, stage1_mean_ious: 0.5600, stage1_s: 0.5446, stage1_m: 0.4031, stage1_l: 0.0161, stage1_h: 0.0000, loss: 0.1823, grad_norm: 7.6884
2024-10-15 17:37:13,404 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:32:16, time: 0.828, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.1044, stage0_bag_acc: 92.0695, stage0_mean_ious: 0.4770, stage0_s: 0.4415, stage0_m: 0.3671, stage0_l: 0.0241, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0300, stage1_bag_acc: 93.2022, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.5879, stage1_s: 0.5884, stage1_m: 0.3438, stage1_l: 0.0179, stage1_h: 0.0000, loss: 0.1425, grad_norm: 6.0093
2024-10-15 17:37:40,126 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 17:38:57,568 - mmdet - INFO - Evaluating bbox...
2024-10-15 17:38:58,143 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2116
2024-10-15 17:38:58,143 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6715
2024-10-15 17:38:58,143 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4004
2024-10-15 17:38:58,143 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1423
2024-10-15 17:38:58,144 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0721
2024-10-15 17:38:58,144 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0229
2024-10-15 17:38:58,144 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-15 17:38:58,144 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:38:58,144 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2223
2024-10-15 17:38:58,144 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0848
2024-10-15 17:38:58,144 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3163
2024-10-15 17:38:58,144 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7720
2024-10-15 17:38:58,144 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3163
2024-10-15 17:38:58,145 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3163
2024-10-15 17:38:58,145 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:38:58,145 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3349
2024-10-15 17:38:58,145 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0909
2024-10-15 17:38:58,150 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 17:38:58,151 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2120, bbox_mAP_50: 0.6720, bbox_mAP_75: 0.4000, bbox_mAP_s: 0.1420, bbox_mAP_m: 0.0720, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.212 0.672 0.400 0.142 0.072 0.023
2024-10-15 17:39:43,605 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:30:33, time: 0.909, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0831, stage0_bag_acc: 94.0055, stage0_mean_ious: 0.4690, stage0_s: 0.4260, stage0_m: 0.3000, stage0_l: 0.0312, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0261, stage1_bag_acc: 93.8055, stage1_neg_loss: 0.0099, stage1_mean_ious: 0.5946, stage1_s: 0.5712, stage1_m: 0.3497, stage1_l: 0.0282, stage1_h: 0.0000, loss: 0.1191, grad_norm: 5.2391
2024-10-15 17:40:24,397 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:30:05, time: 0.816, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0543, stage0_bag_acc: 96.4810, stage0_mean_ious: 0.4769, stage0_s: 0.4271, stage0_m: 0.3157, stage0_l: 0.0234, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0197, stage1_bag_acc: 96.3810, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5889, stage1_s: 0.5765, stage1_m: 0.3109, stage1_l: 0.0167, stage1_h: 0.0000, loss: 0.0808, grad_norm: 4.3895
2024-10-15 17:41:07,564 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:29:42, time: 0.863, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0861, stage0_bag_acc: 92.8389, stage0_mean_ious: 0.4781, stage0_s: 0.4464, stage0_m: 0.3049, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0266, stage1_bag_acc: 93.1015, stage1_neg_loss: 0.0097, stage1_mean_ious: 0.5874, stage1_s: 0.5909, stage1_m: 0.2921, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.1225, grad_norm: 5.3526
2024-10-15 17:41:49,971 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:29:15, time: 0.848, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0740, stage0_bag_acc: 94.6698, stage0_mean_ious: 0.4688, stage0_s: 0.4164, stage0_m: 0.3737, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 93.4158, stage1_neg_loss: 0.0065, stage1_mean_ious: 0.5701, stage1_s: 0.5639, stage1_m: 0.3627, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1007, grad_norm: 4.2916
2024-10-15 17:42:31,393 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:28:44, time: 0.828, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.1053, stage0_bag_acc: 91.6402, stage0_mean_ious: 0.4652, stage0_s: 0.4093, stage0_m: 0.2845, stage0_l: 0.0269, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0333, stage1_bag_acc: 92.0863, stage1_neg_loss: 0.0110, stage1_mean_ious: 0.5608, stage1_s: 0.5316, stage1_m: 0.2667, stage1_l: 0.0209, stage1_h: 0.0000, loss: 0.1496, grad_norm: 5.3699
2024-10-15 17:42:58,671 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 17:43:46,914 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:27:16, time: 0.919, data_time: 0.060, memory: 7795, stage0_loss_instance_mil: 0.0495, stage0_bag_acc: 96.7000, stage0_mean_ious: 0.4520, stage0_s: 0.3887, stage0_m: 0.3083, stage0_l: 0.0104, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0181, stage1_bag_acc: 96.3167, stage1_neg_loss: 0.0076, stage1_mean_ious: 0.5582, stage1_s: 0.5344, stage1_m: 0.3010, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.0751, grad_norm: 3.6040
2024-10-15 17:44:25,474 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:26:41, time: 0.771, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0633, stage0_bag_acc: 93.9333, stage0_mean_ious: 0.4864, stage0_s: 0.4401, stage0_m: 0.2994, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 94.5000, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5693, stage1_s: 0.5495, stage1_m: 0.3096, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0914, grad_norm: 4.2747
2024-10-15 17:44:59,553 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:25:58, time: 0.682, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0603, stage0_bag_acc: 95.3310, stage0_mean_ious: 0.4794, stage0_s: 0.4150, stage0_m: 0.3380, stage0_l: 0.0310, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0189, stage1_bag_acc: 96.1643, stage1_neg_loss: 0.0096, stage1_mean_ious: 0.5865, stage1_s: 0.5505, stage1_m: 0.3368, stage1_l: 0.0279, stage1_h: 0.0000, loss: 0.0888, grad_norm: 4.3375
2024-10-15 17:45:31,180 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:25:12, time: 0.632, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0691, stage0_bag_acc: 95.4515, stage0_mean_ious: 0.4589, stage0_s: 0.4119, stage0_m: 0.3689, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0153, stage1_bag_acc: 95.7333, stage1_neg_loss: 0.0064, stage1_mean_ious: 0.5917, stage1_s: 0.5730, stage1_m: 0.4064, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0908, grad_norm: 3.9164
2024-10-15 17:46:04,043 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:24:29, time: 0.657, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0581, stage0_bag_acc: 95.3286, stage0_mean_ious: 0.5166, stage0_s: 0.4807, stage0_m: 0.4261, stage0_l: 0.0116, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0178, stage1_bag_acc: 96.0643, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.6092, stage1_s: 0.5986, stage1_m: 0.4179, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.0839, grad_norm: 3.8386
2024-10-15 17:46:25,303 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 17:47:11,154 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:23:09, time: 0.873, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0534, stage0_bag_acc: 95.0173, stage0_mean_ious: 0.4712, stage0_s: 0.4263, stage0_m: 0.2865, stage0_l: 0.0065, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0209, stage1_bag_acc: 95.9991, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.5807, stage1_s: 0.5688, stage1_m: 0.2741, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.0826, grad_norm: 4.1835
2024-10-15 17:47:54,041 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:22:41, time: 0.858, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0426, stage0_bag_acc: 96.3167, stage0_mean_ious: 0.4727, stage0_s: 0.4155, stage0_m: 0.3634, stage0_l: 0.0195, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0203, stage1_bag_acc: 97.3500, stage1_neg_loss: 0.0134, stage1_mean_ious: 0.5868, stage1_s: 0.5558, stage1_m: 0.3588, stage1_l: 0.0166, stage1_h: 0.0000, loss: 0.0764, grad_norm: 3.7871
2024-10-15 17:48:37,627 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:12, time: 0.872, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0199, stage0_bag_acc: 98.8643, stage0_mean_ious: 0.4932, stage0_s: 0.4568, stage0_m: 0.3968, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0132, stage1_bag_acc: 99.2848, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5939, stage1_s: 0.5989, stage1_m: 0.3830, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0373, grad_norm: 2.9131
2024-10-15 17:49:21,233 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:21:43, time: 0.872, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0585, stage0_bag_acc: 95.0222, stage0_mean_ious: 0.5155, stage0_s: 0.4838, stage0_m: 0.3661, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0164, stage1_bag_acc: 94.9722, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5936, stage1_s: 0.5883, stage1_m: 0.3588, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.0797, grad_norm: 4.2937
2024-10-15 17:50:05,148 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:13, time: 0.878, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0321, stage0_bag_acc: 97.6848, stage0_mean_ious: 0.5040, stage0_s: 0.4705, stage0_m: 0.4113, stage0_l: 0.0438, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 97.0348, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5861, stage1_s: 0.5951, stage1_m: 0.3767, stage1_l: 0.0311, stage1_h: 0.0000, loss: 0.0445, grad_norm: 2.7677
2024-10-15 17:50:30,221 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 17:51:48,881 - mmdet - INFO - Evaluating bbox...
2024-10-15 17:51:49,459 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2189
2024-10-15 17:51:49,459 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6850
2024-10-15 17:51:49,459 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4094
2024-10-15 17:51:49,459 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1552
2024-10-15 17:51:49,459 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0750
2024-10-15 17:51:49,459 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0227
2024-10-15 17:51:49,459 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0014
2024-10-15 17:51:49,459 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:51:49,460 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2300
2024-10-15 17:51:49,460 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0599
2024-10-15 17:51:49,460 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3264
2024-10-15 17:51:49,460 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7867
2024-10-15 17:51:49,460 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3264
2024-10-15 17:51:49,460 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3264
2024-10-15 17:51:49,460 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 17:51:49,460 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3464
2024-10-15 17:51:49,460 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0786
2024-10-15 17:51:49,466 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 17:51:49,466 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2190, bbox_mAP_50: 0.6850, bbox_mAP_75: 0.4090, bbox_mAP_s: 0.1550, bbox_mAP_m: 0.0750, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.219 0.685 0.409 0.155 0.075 0.023
2024-10-15 17:52:35,169 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:20:00, time: 0.914, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0308, stage0_bag_acc: 97.3015, stage0_mean_ious: 0.4882, stage0_s: 0.4522, stage0_m: 0.3353, stage0_l: 0.0263, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0148, stage1_bag_acc: 97.9682, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5934, stage1_s: 0.5927, stage1_m: 0.3308, stage1_l: 0.0232, stage1_h: 0.0000, loss: 0.0513, grad_norm: 3.3028
2024-10-15 17:53:18,056 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:19:29, time: 0.858, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0340, stage0_bag_acc: 97.4500, stage0_mean_ious: 0.4853, stage0_s: 0.4322, stage0_m: 0.3862, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0136, stage1_bag_acc: 97.2000, stage1_neg_loss: 0.0045, stage1_mean_ious: 0.5866, stage1_s: 0.5746, stage1_m: 0.3860, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.0522, grad_norm: 2.9234
2024-10-15 17:54:01,709 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:18:58, time: 0.873, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0177, stage0_bag_acc: 98.2500, stage0_mean_ious: 0.4902, stage0_s: 0.4306, stage0_m: 0.3562, stage0_l: 0.0105, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 98.6500, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5893, stage1_s: 0.5806, stage1_m: 0.3300, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.0289, grad_norm: 2.1282
2024-10-15 17:54:45,458 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:26, time: 0.875, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0261, stage0_bag_acc: 97.6833, stage0_mean_ious: 0.4991, stage0_s: 0.4220, stage0_m: 0.3733, stage0_l: 0.0175, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0154, stage1_bag_acc: 96.8833, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5866, stage1_s: 0.5527, stage1_m: 0.3456, stage1_l: 0.0145, stage1_h: 0.0000, loss: 0.0450, grad_norm: 2.5200
2024-10-15 17:55:25,842 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:17:50, time: 0.808, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0470, stage0_bag_acc: 96.4889, stage0_mean_ious: 0.5167, stage0_s: 0.4796, stage0_m: 0.3653, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0131, stage1_bag_acc: 96.7111, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5960, stage1_s: 0.5827, stage1_m: 0.3559, stage1_l: 0.0061, stage1_h: 0.0000, loss: 0.0652, grad_norm: 3.9621
2024-10-15 17:55:50,055 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 17:56:37,070 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:40, time: 0.896, data_time: 0.060, memory: 7795, stage0_loss_instance_mil: 0.0199, stage0_bag_acc: 98.2500, stage0_mean_ious: 0.5227, stage0_s: 0.4545, stage0_m: 0.3998, stage0_l: 0.0213, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0097, stage1_bag_acc: 98.4500, stage1_neg_loss: 0.0078, stage1_mean_ious: 0.5966, stage1_s: 0.5830, stage1_m: 0.3846, stage1_l: 0.0145, stage1_h: 0.0000, loss: 0.0374, grad_norm: 2.5131
2024-10-15 17:57:18,826 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:16:06, time: 0.835, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0334, stage0_bag_acc: 97.5667, stage0_mean_ious: 0.4698, stage0_s: 0.4390, stage0_m: 0.2739, stage0_l: 0.0153, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 97.3167, stage1_neg_loss: 0.0071, stage1_mean_ious: 0.5761, stage1_s: 0.5625, stage1_m: 0.2879, stage1_l: 0.0115, stage1_h: 0.0000, loss: 0.0522, grad_norm: 3.0763
2024-10-15 17:58:01,305 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:32, time: 0.849, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0159, stage0_bag_acc: 98.8643, stage0_mean_ious: 0.5111, stage0_s: 0.4435, stage0_m: 0.4483, stage0_l: 0.0274, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0131, stage1_bag_acc: 99.3143, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5806, stage1_s: 0.5664, stage1_m: 0.3965, stage1_l: 0.0276, stage1_h: 0.0000, loss: 0.0322, grad_norm: 1.7937
2024-10-15 17:58:42,589 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:14:57, time: 0.826, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0327, stage0_bag_acc: 97.3682, stage0_mean_ious: 0.5018, stage0_s: 0.4616, stage0_m: 0.3675, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0138, stage1_bag_acc: 96.7682, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5972, stage1_s: 0.6017, stage1_m: 0.3350, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0515, grad_norm: 2.7661
2024-10-15 17:59:26,905 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:23, time: 0.886, data_time: 0.011, memory: 7795, stage0_loss_instance_mil: 0.0618, stage0_bag_acc: 96.1506, stage0_mean_ious: 0.4780, stage0_s: 0.4522, stage0_m: 0.3028, stage0_l: 0.0167, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0181, stage1_bag_acc: 96.1491, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5918, stage1_s: 0.5883, stage1_m: 0.3108, stage1_l: 0.0190, stage1_h: 0.0000, loss: 0.0859, grad_norm: 4.1123
2024-10-15 17:59:51,580 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 18:00:39,032 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:16, time: 0.904, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.0201, stage0_bag_acc: 98.3167, stage0_mean_ious: 0.4701, stage0_s: 0.4005, stage0_m: 0.3389, stage0_l: 0.0138, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0138, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0070, stage1_mean_ious: 0.5772, stage1_s: 0.5382, stage1_m: 0.3477, stage1_l: 0.0122, stage1_h: 0.0000, loss: 0.0409, grad_norm: 2.9505
2024-10-15 18:01:14,135 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:38, time: 0.702, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0206, stage0_bag_acc: 98.6460, stage0_mean_ious: 0.5065, stage0_s: 0.4498, stage0_m: 0.3670, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0103, stage1_bag_acc: 98.7460, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5979, stage1_s: 0.5763, stage1_m: 0.3698, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0351, grad_norm: 2.2957
2024-10-15 18:01:47,654 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:11:59, time: 0.670, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0151, stage0_bag_acc: 98.9056, stage0_mean_ious: 0.5120, stage0_s: 0.4703, stage0_m: 0.3086, stage0_l: 0.0098, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0083, stage1_bag_acc: 98.4556, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.6114, stage1_s: 0.5940, stage1_m: 0.2977, stage1_l: 0.0085, stage1_h: 0.0000, loss: 0.0286, grad_norm: 2.0531
2024-10-15 18:02:20,624 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:21, time: 0.659, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0107, stage0_bag_acc: 99.4167, stage0_mean_ious: 0.4966, stage0_s: 0.4535, stage0_m: 0.3314, stage0_l: 0.0112, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 98.5833, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.6125, stage1_s: 0.5952, stage1_m: 0.3555, stage1_l: 0.0065, stage1_h: 0.0000, loss: 0.0217, grad_norm: 1.3345
2024-10-15 18:02:51,674 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:42, time: 0.621, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0205, stage0_bag_acc: 98.6500, stage0_mean_ious: 0.4976, stage0_s: 0.4457, stage0_m: 0.2987, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.4500, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.5599, stage1_s: 0.5413, stage1_m: 0.2635, stage1_l: 0.0043, stage1_h: 0.0000, loss: 0.0295, grad_norm: 1.8979
2024-10-15 18:03:15,309 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 18:04:33,174 - mmdet - INFO - Evaluating bbox...
2024-10-15 18:04:33,744 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2171
2024-10-15 18:04:33,745 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6844
2024-10-15 18:04:33,745 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4212
2024-10-15 18:04:33,745 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1475
2024-10-15 18:04:33,745 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0698
2024-10-15 18:04:33,745 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0231
2024-10-15 18:04:33,745 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-15 18:04:33,745 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:04:33,745 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2287
2024-10-15 18:04:33,746 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0518
2024-10-15 18:04:33,746 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3197
2024-10-15 18:04:33,746 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7857
2024-10-15 18:04:33,746 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3197
2024-10-15 18:04:33,746 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3197
2024-10-15 18:04:33,746 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:04:33,746 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3388
2024-10-15 18:04:33,746 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0868
2024-10-15 18:04:33,752 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 18:04:33,752 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2170, bbox_mAP_50: 0.6840, bbox_mAP_75: 0.4210, bbox_mAP_s: 0.1470, bbox_mAP_m: 0.0700, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.217 0.684 0.421 0.147 0.070 0.023
2024-10-15 18:05:16,497 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:38, time: 0.855, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0275, stage0_bag_acc: 97.9667, stage0_mean_ious: 0.4972, stage0_s: 0.4673, stage0_m: 0.3287, stage0_l: 0.0210, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0115, stage1_bag_acc: 97.3444, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5935, stage1_s: 0.6001, stage1_m: 0.3213, stage1_l: 0.0112, stage1_h: 0.0000, loss: 0.0433, grad_norm: 3.0207
2024-10-15 18:05:56,853 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:02, time: 0.807, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0146, stage0_bag_acc: 99.0643, stage0_mean_ious: 0.5009, stage0_s: 0.4742, stage0_m: 0.3105, stage0_l: 0.0063, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0119, stage1_bag_acc: 99.0167, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5765, stage1_s: 0.5866, stage1_m: 0.2715, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0316, grad_norm: 2.3957
2024-10-15 18:06:38,396 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:27, time: 0.831, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0318, stage0_bag_acc: 97.5444, stage0_mean_ious: 0.4607, stage0_s: 0.4315, stage0_m: 0.2558, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0094, stage1_bag_acc: 97.9944, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5796, stage1_s: 0.5750, stage1_m: 0.2664, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0468, grad_norm: 3.2598
2024-10-15 18:07:20,793 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:51, time: 0.848, data_time: 0.011, memory: 7795, stage0_loss_instance_mil: 0.0195, stage0_bag_acc: 98.2587, stage0_mean_ious: 0.5013, stage0_s: 0.4488, stage0_m: 0.3827, stage0_l: 0.0115, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 98.7167, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5894, stage1_s: 0.5720, stage1_m: 0.3686, stage1_l: 0.0124, stage1_h: 0.0000, loss: 0.0288, grad_norm: 1.7544
2024-10-15 18:08:05,434 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:16, time: 0.893, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0275, stage0_bag_acc: 97.6611, stage0_mean_ious: 0.4996, stage0_s: 0.4233, stage0_m: 0.4831, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0071, stage1_bag_acc: 97.2111, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5815, stage1_s: 0.5532, stage1_m: 0.4563, stage1_l: 0.0042, stage1_h: 0.0000, loss: 0.0383, grad_norm: 2.3181
2024-10-15 18:08:31,559 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 18:09:20,269 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:15, time: 0.929, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0094, stage0_bag_acc: 99.2500, stage0_mean_ious: 0.5076, stage0_s: 0.4469, stage0_m: 0.4318, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0061, stage1_bag_acc: 99.5000, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5807, stage1_s: 0.5588, stage1_m: 0.4249, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0195, grad_norm: 1.4833
2024-10-15 18:10:03,254 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:39, time: 0.860, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0189, stage0_bag_acc: 99.1000, stage0_mean_ious: 0.5006, stage0_s: 0.4255, stage0_m: 0.3848, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 99.1000, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5902, stage1_s: 0.5716, stage1_m: 0.3641, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.0291, grad_norm: 2.0321
2024-10-15 18:10:48,136 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:03, time: 0.898, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0168, stage0_bag_acc: 98.8000, stage0_mean_ious: 0.4935, stage0_s: 0.4203, stage0_m: 0.3992, stage0_l: 0.0139, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0068, stage1_bag_acc: 98.7500, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5853, stage1_s: 0.5645, stage1_m: 0.3931, stage1_l: 0.0100, stage1_h: 0.0000, loss: 0.0268, grad_norm: 1.9641
2024-10-15 18:11:30,398 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 18:11:30,398 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:27, time: 0.845, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0230, stage0_bag_acc: 97.9182, stage0_mean_ious: 0.4927, stage0_s: 0.4425, stage0_m: 0.3797, stage0_l: 0.0126, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0111, stage1_bag_acc: 98.3182, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5880, stage1_s: 0.5689, stage1_m: 0.3849, stage1_l: 0.0128, stage1_h: 0.0000, loss: 0.0383, grad_norm: 2.5182
2024-10-15 18:12:12,545 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:50, time: 0.843, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0231, stage0_bag_acc: 98.0476, stage0_mean_ious: 0.4853, stage0_s: 0.4629, stage0_m: 0.2743, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0059, stage1_bag_acc: 97.7143, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5937, stage1_s: 0.5854, stage1_m: 0.2923, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0310, grad_norm: 2.0187
2024-10-15 18:12:37,218 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 18:13:23,161 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:49, time: 0.874, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0173, stage0_bag_acc: 98.6682, stage0_mean_ious: 0.4742, stage0_s: 0.4453, stage0_m: 0.3116, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0079, stage1_bag_acc: 98.8500, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5651, stage1_s: 0.5655, stage1_m: 0.2856, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0294, grad_norm: 2.1532
2024-10-15 18:14:05,243 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:13, time: 0.842, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0159, stage0_bag_acc: 98.9667, stage0_mean_ious: 0.4917, stage0_s: 0.4475, stage0_m: 0.3356, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0098, stage1_bag_acc: 98.7848, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5927, stage1_s: 0.5964, stage1_m: 0.3291, stage1_l: 0.0042, stage1_h: 0.0000, loss: 0.0275, grad_norm: 1.7770
2024-10-15 18:14:47,043 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:36, time: 0.836, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0121, stage0_bag_acc: 98.6444, stage0_mean_ious: 0.4840, stage0_s: 0.4433, stage0_m: 0.3899, stage0_l: 0.0107, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0058, stage1_bag_acc: 99.4000, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5921, stage1_s: 0.5937, stage1_m: 0.3854, stage1_l: 0.0069, stage1_h: 0.0000, loss: 0.0205, grad_norm: 1.6963
2024-10-15 18:15:32,127 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.902, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0164, stage0_bag_acc: 99.0167, stage0_mean_ious: 0.4843, stage0_s: 0.4022, stage0_m: 0.4066, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 99.0167, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5659, stage1_s: 0.5296, stage1_m: 0.3955, stage1_l: 0.0102, stage1_h: 0.0000, loss: 0.0275, grad_norm: 1.8975
2024-10-15 18:16:15,872 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:22, time: 0.875, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0094, stage0_bag_acc: 99.3000, stage0_mean_ious: 0.5152, stage0_s: 0.4798, stage0_m: 0.3984, stage0_l: 0.0098, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0040, stage1_bag_acc: 99.0500, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5952, stage1_s: 0.5861, stage1_m: 0.4024, stage1_l: 0.0083, stage1_h: 0.0000, loss: 0.0158, grad_norm: 1.5010
2024-10-15 18:16:41,607 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 18:17:59,830 - mmdet - INFO - Evaluating bbox...
2024-10-15 18:18:00,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2141
2024-10-15 18:18:00,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6874
2024-10-15 18:18:00,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4045
2024-10-15 18:18:00,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1432
2024-10-15 18:18:00,320 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0680
2024-10-15 18:18:00,321 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0235
2024-10-15 18:18:00,321 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0013
2024-10-15 18:18:00,321 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:18:00,321 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2251
2024-10-15 18:18:00,321 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0518
2024-10-15 18:18:00,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3178
2024-10-15 18:18:00,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7881
2024-10-15 18:18:00,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3178
2024-10-15 18:18:00,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3178
2024-10-15 18:18:00,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:18:00,321 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3369
2024-10-15 18:18:00,322 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0811
2024-10-15 18:18:00,327 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 18:18:00,327 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2140, bbox_mAP_50: 0.6870, bbox_mAP_75: 0.4040, bbox_mAP_s: 0.1430, bbox_mAP_m: 0.0680, bbox_mAP_l: 0.0240, bbox_mAP_copypaste: 0.214 0.687 0.404 0.143 0.068 0.024
2024-10-15 18:19:15,704 - mmdet - INFO - Evaluating bbox...
2024-10-15 18:19:16,274 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2141
2024-10-15 18:19:16,275 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6874
2024-10-15 18:19:16,275 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4045
2024-10-15 18:19:16,275 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1432
2024-10-15 18:19:16,275 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0680
2024-10-15 18:19:16,275 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0235
2024-10-15 18:19:16,275 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0013
2024-10-15 18:19:16,275 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:19:16,275 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2251
2024-10-15 18:19:16,275 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0518
2024-10-15 18:19:16,275 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3178
2024-10-15 18:19:16,276 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7881
2024-10-15 18:19:16,276 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3178
2024-10-15 18:19:16,276 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3178
2024-10-15 18:19:16,276 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:19:16,276 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3369
2024-10-15 18:19:16,276 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0811
2024-10-15 18:19:17,554 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 18:19:18,435 - mmdet - INFO - Distributed training: False
2024-10-15 18:19:19,294 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 18:19:20,277 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 18:19:20,277 - mmdet - INFO - Use load_from_local loader
2024-10-15 18:19:20,576 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 18:19:20,594 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 18:19:20,594 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 18:19:58,311 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:41:36, time: 0.754, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.7072, stage0_bag_acc: 20.5867, stage0_mean_ious: 0.0839, stage0_s: 0.0584, stage0_m: 0.1083, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1762, stage1_bag_acc: 12.5749, stage1_neg_loss: 0.0006, stage1_mean_ious: 0.0896, stage1_s: 0.0629, stage1_m: 0.1133, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8840, grad_norm: 6.1173
2024-10-15 18:20:42,093 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:44:16, time: 0.876, data_time: 0.011, memory: 7795, stage0_loss_instance_mil: 0.6959, stage0_bag_acc: 17.7000, stage0_mean_ious: 0.0925, stage0_s: 0.0639, stage0_m: 0.0934, stage0_l: 0.0145, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1765, stage1_bag_acc: 16.5833, stage1_neg_loss: 0.0008, stage1_mean_ious: 0.0997, stage1_s: 0.0689, stage1_m: 0.1026, stage1_l: 0.0143, stage1_h: 0.0000, loss: 0.8732, grad_norm: 5.9486
2024-10-15 18:21:24,144 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:44:03, time: 0.841, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.6773, stage0_bag_acc: 19.3778, stage0_mean_ious: 0.1432, stage0_s: 0.1070, stage0_m: 0.1592, stage0_l: 0.0023, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1679, stage1_bag_acc: 21.3500, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.1578, stage1_s: 0.1199, stage1_m: 0.1711, stage1_l: 0.0034, stage1_h: 0.0000, loss: 0.8479, grad_norm: 7.1808
2024-10-15 18:22:05,528 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:43:25, time: 0.828, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.6445, stage0_bag_acc: 30.0000, stage0_mean_ious: 0.1514, stage0_s: 0.1311, stage0_m: 0.1147, stage0_l: 0.0002, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1465, stage1_bag_acc: 31.1646, stage1_neg_loss: 0.0135, stage1_mean_ious: 0.1782, stage1_s: 0.1504, stage1_m: 0.1350, stage1_l: 0.0003, stage1_h: 0.0000, loss: 0.8045, grad_norm: 10.0609
2024-10-15 18:22:47,892 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:42:58, time: 0.847, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.6144, stage0_bag_acc: 28.2849, stage0_mean_ious: 0.1597, stage0_s: 0.1428, stage0_m: 0.1260, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1215, stage1_bag_acc: 40.8405, stage1_neg_loss: 0.0208, stage1_mean_ious: 0.1863, stage1_s: 0.1701, stage1_m: 0.1449, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.7567, grad_norm: 10.7842
2024-10-15 18:23:13,995 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 18:24:03,673 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:38:57, time: 0.946, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.4866, stage0_bag_acc: 46.2462, stage0_mean_ious: 0.2907, stage0_s: 0.2452, stage0_m: 0.2502, stage0_l: 0.0422, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1002, stage1_bag_acc: 49.3835, stage1_neg_loss: 0.0173, stage1_mean_ious: 0.3579, stage1_s: 0.3054, stage1_m: 0.2994, stage1_l: 0.0385, stage1_h: 0.0000, loss: 0.6041, grad_norm: 11.3566
2024-10-15 18:24:45,764 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:38:46, time: 0.842, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.4234, stage0_bag_acc: 58.2458, stage0_mean_ious: 0.3318, stage0_s: 0.3098, stage0_m: 0.2150, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0876, stage1_bag_acc: 56.5602, stage1_neg_loss: 0.0187, stage1_mean_ious: 0.4350, stage1_s: 0.4088, stage1_m: 0.2579, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5297, grad_norm: 13.1224
2024-10-15 18:25:28,588 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:38:33, time: 0.856, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.2772, stage0_bag_acc: 77.9610, stage0_mean_ious: 0.4104, stage0_s: 0.3172, stage0_m: 0.3657, stage0_l: 0.0274, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0840, stage1_bag_acc: 76.6736, stage1_neg_loss: 0.0307, stage1_mean_ious: 0.4970, stage1_s: 0.4436, stage1_m: 0.3531, stage1_l: 0.0214, stage1_h: 0.0000, loss: 0.3920, grad_norm: 12.7485
2024-10-15 18:26:12,165 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:38:18, time: 0.871, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.2415, stage0_bag_acc: 79.2877, stage0_mean_ious: 0.4455, stage0_s: 0.3956, stage0_m: 0.3470, stage0_l: 0.0373, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0792, stage1_bag_acc: 78.4310, stage1_neg_loss: 0.0250, stage1_mean_ious: 0.5609, stage1_s: 0.5432, stage1_m: 0.3803, stage1_l: 0.0273, stage1_h: 0.0000, loss: 0.3457, grad_norm: 13.4878
2024-10-15 18:26:53,835 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:37:48, time: 0.833, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.2070, stage0_bag_acc: 83.0879, stage0_mean_ious: 0.4447, stage0_s: 0.3969, stage0_m: 0.3303, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0555, stage1_bag_acc: 83.7212, stage1_neg_loss: 0.0114, stage1_mean_ious: 0.5384, stage1_s: 0.5316, stage1_m: 0.3358, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.2739, grad_norm: 10.2550
2024-10-15 18:27:21,339 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 18:28:06,779 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:35:09, time: 0.865, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.1536, stage0_bag_acc: 85.8164, stage0_mean_ious: 0.4535, stage0_s: 0.4148, stage0_m: 0.3140, stage0_l: 0.0223, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0578, stage1_bag_acc: 86.3887, stage1_neg_loss: 0.0171, stage1_mean_ious: 0.5514, stage1_s: 0.5267, stage1_m: 0.3288, stage1_l: 0.0173, stage1_h: 0.0000, loss: 0.2284, grad_norm: 8.8820
2024-10-15 18:28:48,355 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:34:44, time: 0.831, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.1435, stage0_bag_acc: 89.4317, stage0_mean_ious: 0.4767, stage0_s: 0.4202, stage0_m: 0.4074, stage0_l: 0.0120, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0368, stage1_bag_acc: 90.2508, stage1_neg_loss: 0.0076, stage1_mean_ious: 0.5603, stage1_s: 0.5425, stage1_m: 0.4104, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.1880, grad_norm: 7.6071
2024-10-15 18:29:32,239 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:34:25, time: 0.878, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.1126, stage0_bag_acc: 91.3489, stage0_mean_ious: 0.4875, stage0_s: 0.4404, stage0_m: 0.3257, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0285, stage1_bag_acc: 91.8301, stage1_neg_loss: 0.0091, stage1_mean_ious: 0.5923, stage1_s: 0.5672, stage1_m: 0.3559, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1502, grad_norm: 7.3269
2024-10-15 18:30:14,189 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:33:56, time: 0.839, data_time: 0.011, memory: 7795, stage0_loss_instance_mil: 0.1182, stage0_bag_acc: 91.3714, stage0_mean_ious: 0.4359, stage0_s: 0.3854, stage0_m: 0.3374, stage0_l: 0.0087, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0333, stage1_bag_acc: 91.3436, stage1_neg_loss: 0.0106, stage1_mean_ious: 0.5401, stage1_s: 0.5193, stage1_m: 0.3339, stage1_l: 0.0050, stage1_h: 0.0000, loss: 0.1621, grad_norm: 7.1979
2024-10-15 18:30:54,138 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:33:20, time: 0.799, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.1467, stage0_bag_acc: 87.8197, stage0_mean_ious: 0.4472, stage0_s: 0.4202, stage0_m: 0.2889, stage0_l: 0.0167, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0319, stage1_bag_acc: 89.7460, stage1_neg_loss: 0.0082, stage1_mean_ious: 0.5393, stage1_s: 0.5301, stage1_m: 0.2959, stage1_l: 0.0126, stage1_h: 0.0000, loss: 0.1868, grad_norm: 7.7836
2024-10-15 18:31:19,635 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 18:32:37,092 - mmdet - INFO - Evaluating bbox...
2024-10-15 18:32:37,646 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2087
2024-10-15 18:32:37,646 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6813
2024-10-15 18:32:37,646 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3838
2024-10-15 18:32:37,646 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1366
2024-10-15 18:32:37,646 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0683
2024-10-15 18:32:37,647 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0253
2024-10-15 18:32:37,647 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-15 18:32:37,647 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:32:37,647 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2194
2024-10-15 18:32:37,647 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0610
2024-10-15 18:32:37,647 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3128
2024-10-15 18:32:37,647 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7848
2024-10-15 18:32:37,647 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3128
2024-10-15 18:32:37,647 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3128
2024-10-15 18:32:37,647 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:32:37,648 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3321
2024-10-15 18:32:37,648 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0702
2024-10-15 18:32:37,653 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 18:32:37,654 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2090, bbox_mAP_50: 0.6810, bbox_mAP_75: 0.3840, bbox_mAP_s: 0.1370, bbox_mAP_m: 0.0680, bbox_mAP_l: 0.0250, bbox_mAP_copypaste: 0.209 0.681 0.384 0.137 0.068 0.025
2024-10-15 18:33:20,879 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:31:23, time: 0.864, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0856, stage0_bag_acc: 93.9838, stage0_mean_ious: 0.4528, stage0_s: 0.4135, stage0_m: 0.3108, stage0_l: 0.0072, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0348, stage1_bag_acc: 93.1657, stage1_neg_loss: 0.0120, stage1_mean_ious: 0.5572, stage1_s: 0.5388, stage1_m: 0.3204, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.1323, grad_norm: 5.8394
2024-10-15 18:34:02,447 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:30:54, time: 0.831, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0771, stage0_bag_acc: 94.2086, stage0_mean_ious: 0.4969, stage0_s: 0.4727, stage0_m: 0.3065, stage0_l: 0.0050, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0232, stage1_bag_acc: 94.5434, stage1_neg_loss: 0.0102, stage1_mean_ious: 0.5875, stage1_s: 0.5895, stage1_m: 0.3074, stage1_l: 0.0030, stage1_h: 0.0000, loss: 0.1105, grad_norm: 6.1374
2024-10-15 18:34:41,539 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:30:17, time: 0.782, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0640, stage0_bag_acc: 94.6976, stage0_mean_ious: 0.4661, stage0_s: 0.4181, stage0_m: 0.3011, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0161, stage1_bag_acc: 94.8976, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5850, stage1_s: 0.5719, stage1_m: 0.3198, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0850, grad_norm: 4.6064
2024-10-15 18:35:17,054 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:29:32, time: 0.710, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.1105, stage0_bag_acc: 90.2111, stage0_mean_ious: 0.4632, stage0_s: 0.4017, stage0_m: 0.3939, stage0_l: 0.0101, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0248, stage1_bag_acc: 92.1167, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.6009, stage1_s: 0.5682, stage1_m: 0.4268, stage1_l: 0.0074, stage1_h: 0.0000, loss: 0.1426, grad_norm: 7.0109
2024-10-15 18:35:50,686 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:28:45, time: 0.673, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0639, stage0_bag_acc: 94.3500, stage0_mean_ious: 0.5131, stage0_s: 0.4788, stage0_m: 0.4290, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0212, stage1_bag_acc: 96.6667, stage1_neg_loss: 0.0119, stage1_mean_ious: 0.5830, stage1_s: 0.5802, stage1_m: 0.3956, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0970, grad_norm: 4.4969
2024-10-15 18:36:11,013 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 18:36:54,573 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:27:07, time: 0.826, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0549, stage0_bag_acc: 96.0864, stage0_mean_ious: 0.4700, stage0_s: 0.4313, stage0_m: 0.4258, stage0_l: 0.0072, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0163, stage1_bag_acc: 96.7864, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5744, stage1_s: 0.5733, stage1_m: 0.4414, stage1_l: 0.0065, stage1_h: 0.0000, loss: 0.0772, grad_norm: 4.4913
2024-10-15 18:37:37,515 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:26:40, time: 0.859, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0719, stage0_bag_acc: 94.6861, stage0_mean_ious: 0.4749, stage0_s: 0.4515, stage0_m: 0.2869, stage0_l: 0.0321, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0240, stage1_bag_acc: 94.2528, stage1_neg_loss: 0.0087, stage1_mean_ious: 0.5835, stage1_s: 0.5887, stage1_m: 0.2893, stage1_l: 0.0335, stage1_h: 0.0000, loss: 0.1046, grad_norm: 5.1922
2024-10-15 18:38:21,349 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:26:14, time: 0.877, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0420, stage0_bag_acc: 97.2545, stage0_mean_ious: 0.5063, stage0_s: 0.4191, stage0_m: 0.3934, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0140, stage1_bag_acc: 97.4364, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.6042, stage1_s: 0.5617, stage1_m: 0.3828, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0619, grad_norm: 3.7729
2024-10-15 18:39:04,854 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:25:45, time: 0.870, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0502, stage0_bag_acc: 95.3810, stage0_mean_ious: 0.5032, stage0_s: 0.4508, stage0_m: 0.4502, stage0_l: 0.0068, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0208, stage1_bag_acc: 95.3810, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.6028, stage1_s: 0.6011, stage1_m: 0.4417, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.0784, grad_norm: 4.7957
2024-10-15 18:39:50,362 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:25:18, time: 0.910, data_time: 0.011, memory: 7795, stage0_loss_instance_mil: 0.0409, stage0_bag_acc: 97.2143, stage0_mean_ious: 0.4914, stage0_s: 0.4306, stage0_m: 0.4166, stage0_l: 0.0092, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0202, stage1_bag_acc: 97.0810, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.5816, stage1_s: 0.5675, stage1_m: 0.4097, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.0686, grad_norm: 4.4298
2024-10-15 18:40:15,831 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 18:41:03,325 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:23:56, time: 0.905, data_time: 0.060, memory: 7795, stage0_loss_instance_mil: 0.0433, stage0_bag_acc: 96.4641, stage0_mean_ious: 0.4957, stage0_s: 0.4271, stage0_m: 0.4213, stage0_l: 0.0059, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0169, stage1_bag_acc: 96.3460, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5992, stage1_s: 0.5664, stage1_m: 0.4293, stage1_l: 0.0042, stage1_h: 0.0000, loss: 0.0649, grad_norm: 3.8453
2024-10-15 18:41:47,000 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:23:26, time: 0.874, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0407, stage0_bag_acc: 96.6778, stage0_mean_ious: 0.4768, stage0_s: 0.4093, stage0_m: 0.3580, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0152, stage1_bag_acc: 97.1500, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.5765, stage1_s: 0.5460, stage1_m: 0.3673, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0626, grad_norm: 3.7400
2024-10-15 18:42:29,152 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:53, time: 0.843, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0424, stage0_bag_acc: 96.3333, stage0_mean_ious: 0.4918, stage0_s: 0.4555, stage0_m: 0.3241, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0141, stage1_bag_acc: 96.9833, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.6002, stage1_s: 0.5940, stage1_m: 0.3364, stage1_l: 0.0044, stage1_h: 0.0000, loss: 0.0614, grad_norm: 3.9028
2024-10-15 18:43:11,183 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:22:20, time: 0.841, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0520, stage0_bag_acc: 96.3500, stage0_mean_ious: 0.5160, stage0_s: 0.4585, stage0_m: 0.3815, stage0_l: 0.0186, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0164, stage1_bag_acc: 96.9333, stage1_neg_loss: 0.0092, stage1_mean_ious: 0.6068, stage1_s: 0.5883, stage1_m: 0.3494, stage1_l: 0.0137, stage1_h: 0.0000, loss: 0.0777, grad_norm: 4.6431
2024-10-15 18:43:52,544 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:45, time: 0.827, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0579, stage0_bag_acc: 95.6333, stage0_mean_ious: 0.4805, stage0_s: 0.4418, stage0_m: 0.3280, stage0_l: 0.0134, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0188, stage1_bag_acc: 95.4348, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5808, stage1_s: 0.5685, stage1_m: 0.3296, stage1_l: 0.0106, stage1_h: 0.0000, loss: 0.0819, grad_norm: 4.3205
2024-10-15 18:44:18,131 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 18:45:37,219 - mmdet - INFO - Evaluating bbox...
2024-10-15 18:45:37,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2027
2024-10-15 18:45:37,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6671
2024-10-15 18:45:37,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3882
2024-10-15 18:45:37,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1269
2024-10-15 18:45:37,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0556
2024-10-15 18:45:37,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0171
2024-10-15 18:45:37,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-15 18:45:37,694 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:45:37,694 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2126
2024-10-15 18:45:37,694 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0773
2024-10-15 18:45:37,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3055
2024-10-15 18:45:37,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7692
2024-10-15 18:45:37,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3055
2024-10-15 18:45:37,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3055
2024-10-15 18:45:37,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:45:37,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3242
2024-10-15 18:45:37,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0811
2024-10-15 18:45:37,699 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 18:45:37,699 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2030, bbox_mAP_50: 0.6670, bbox_mAP_75: 0.3880, bbox_mAP_s: 0.1270, bbox_mAP_m: 0.0560, bbox_mAP_l: 0.0170, bbox_mAP_copypaste: 0.203 0.667 0.388 0.127 0.056 0.017
2024-10-15 18:46:21,459 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:20:28, time: 0.875, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0227, stage0_bag_acc: 98.4000, stage0_mean_ious: 0.4916, stage0_s: 0.4379, stage0_m: 0.3108, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0139, stage1_bag_acc: 97.8500, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5789, stage1_s: 0.5594, stage1_m: 0.2943, stage1_l: 0.0048, stage1_h: 0.0000, loss: 0.0427, grad_norm: 2.9854
2024-10-15 18:47:02,054 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:19:53, time: 0.812, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0387, stage0_bag_acc: 97.7810, stage0_mean_ious: 0.4745, stage0_s: 0.4255, stage0_m: 0.2798, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0108, stage1_bag_acc: 97.7810, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5766, stage1_s: 0.5590, stage1_m: 0.2671, stage1_l: 0.0048, stage1_h: 0.0000, loss: 0.0520, grad_norm: 3.6418
2024-10-15 18:47:47,850 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:19:22, time: 0.916, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0142, stage0_bag_acc: 99.4643, stage0_mean_ious: 0.5357, stage0_s: 0.4875, stage0_m: 0.4081, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0169, stage1_bag_acc: 99.4167, stage1_neg_loss: 0.0090, stage1_mean_ious: 0.6129, stage1_s: 0.6163, stage1_m: 0.3809, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0401, grad_norm: 3.2423
2024-10-15 18:48:29,605 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:47, time: 0.835, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0400, stage0_bag_acc: 97.1310, stage0_mean_ious: 0.4922, stage0_s: 0.4727, stage0_m: 0.2732, stage0_l: 0.0139, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0138, stage1_bag_acc: 97.3364, stage1_neg_loss: 0.0086, stage1_mean_ious: 0.6020, stage1_s: 0.6021, stage1_m: 0.2866, stage1_l: 0.0146, stage1_h: 0.0000, loss: 0.0624, grad_norm: 3.7086
2024-10-15 18:49:10,889 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:18:11, time: 0.826, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0485, stage0_bag_acc: 96.7944, stage0_mean_ious: 0.4913, stage0_s: 0.4529, stage0_m: 0.3031, stage0_l: 0.0516, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0185, stage1_bag_acc: 96.9444, stage1_neg_loss: 0.0086, stage1_mean_ious: 0.5691, stage1_s: 0.5566, stage1_m: 0.2879, stage1_l: 0.0355, stage1_h: 0.0000, loss: 0.0755, grad_norm: 4.2802
2024-10-15 18:49:36,753 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 18:50:21,465 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:57, time: 0.850, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.0365, stage0_bag_acc: 97.1991, stage0_mean_ious: 0.4923, stage0_s: 0.4534, stage0_m: 0.3262, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0208, stage1_bag_acc: 96.7769, stage1_neg_loss: 0.0091, stage1_mean_ious: 0.5742, stage1_s: 0.5719, stage1_m: 0.3105, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0664, grad_norm: 4.5111
2024-10-15 18:51:03,959 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:16:23, time: 0.850, data_time: 0.011, memory: 7795, stage0_loss_instance_mil: 0.0432, stage0_bag_acc: 96.9833, stage0_mean_ious: 0.4996, stage0_s: 0.4544, stage0_m: 0.3953, stage0_l: 0.0109, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0161, stage1_bag_acc: 97.0167, stage1_neg_loss: 0.0077, stage1_mean_ious: 0.5852, stage1_s: 0.5721, stage1_m: 0.3836, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.0670, grad_norm: 4.7733
2024-10-15 18:51:37,687 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:43, time: 0.675, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0469, stage0_bag_acc: 97.1729, stage0_mean_ious: 0.4979, stage0_s: 0.4563, stage0_m: 0.3320, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0126, stage1_bag_acc: 97.6904, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5837, stage1_s: 0.5707, stage1_m: 0.3016, stage1_l: 0.0059, stage1_h: 0.0000, loss: 0.0642, grad_norm: 3.6355
2024-10-15 18:52:09,747 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:15:02, time: 0.641, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0267, stage0_bag_acc: 98.4500, stage0_mean_ious: 0.4907, stage0_s: 0.4659, stage0_m: 0.2494, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0187, stage1_bag_acc: 98.2143, stage1_neg_loss: 0.0071, stage1_mean_ious: 0.6000, stage1_s: 0.6063, stage1_m: 0.2567, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0526, grad_norm: 3.1822
2024-10-15 18:52:42,405 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:22, time: 0.653, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0487, stage0_bag_acc: 96.5000, stage0_mean_ious: 0.4944, stage0_s: 0.4467, stage0_m: 0.3288, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0130, stage1_bag_acc: 96.6000, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5959, stage1_s: 0.5763, stage1_m: 0.3099, stage1_l: 0.0089, stage1_h: 0.0000, loss: 0.0657, grad_norm: 3.1918
2024-10-15 18:53:01,964 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 18:53:44,303 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:12, time: 0.802, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0298, stage0_bag_acc: 97.6833, stage0_mean_ious: 0.5223, stage0_s: 0.4663, stage0_m: 0.3352, stage0_l: 0.0128, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 98.1333, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5989, stage1_s: 0.5746, stage1_m: 0.3242, stage1_l: 0.0152, stage1_h: 0.0000, loss: 0.0441, grad_norm: 2.8470
2024-10-15 18:54:24,616 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:37, time: 0.806, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0283, stage0_bag_acc: 97.9500, stage0_mean_ious: 0.4795, stage0_s: 0.4426, stage0_m: 0.2799, stage0_l: 0.0090, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0143, stage1_bag_acc: 97.9000, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5875, stage1_s: 0.5853, stage1_m: 0.2674, stage1_l: 0.0048, stage1_h: 0.0000, loss: 0.0454, grad_norm: 2.3423
2024-10-15 18:55:07,944 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:12:02, time: 0.867, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0141, stage0_bag_acc: 99.1000, stage0_mean_ious: 0.5134, stage0_s: 0.4849, stage0_m: 0.3328, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0097, stage1_bag_acc: 98.3643, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.6159, stage1_s: 0.6166, stage1_m: 0.3271, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.0278, grad_norm: 2.1680
2024-10-15 18:55:48,262 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:26, time: 0.806, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0224, stage0_bag_acc: 98.3045, stage0_mean_ious: 0.4960, stage0_s: 0.4640, stage0_m: 0.4032, stage0_l: 0.0150, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0108, stage1_bag_acc: 98.1045, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5880, stage1_s: 0.5890, stage1_m: 0.4113, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.0363, grad_norm: 2.6687
2024-10-15 18:56:28,874 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:50, time: 0.812, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0221, stage0_bag_acc: 98.7643, stage0_mean_ious: 0.4959, stage0_s: 0.4484, stage0_m: 0.3006, stage0_l: 0.0198, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0073, stage1_bag_acc: 98.7421, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5976, stage1_s: 0.5655, stage1_m: 0.3078, stage1_l: 0.0205, stage1_h: 0.0000, loss: 0.0337, grad_norm: 1.9477
2024-10-15 18:56:54,126 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 18:58:13,183 - mmdet - INFO - Evaluating bbox...
2024-10-15 18:58:13,749 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2260
2024-10-15 18:58:13,749 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7083
2024-10-15 18:58:13,749 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4274
2024-10-15 18:58:13,750 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1499
2024-10-15 18:58:13,750 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0706
2024-10-15 18:58:13,750 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0242
2024-10-15 18:58:13,750 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0014
2024-10-15 18:58:13,750 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:58:13,750 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2374
2024-10-15 18:58:13,750 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0714
2024-10-15 18:58:13,750 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3288
2024-10-15 18:58:13,750 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8028
2024-10-15 18:58:13,750 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3288
2024-10-15 18:58:13,751 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3288
2024-10-15 18:58:13,751 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 18:58:13,751 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3485
2024-10-15 18:58:13,751 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0795
2024-10-15 18:58:13,756 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 18:58:13,756 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2260, bbox_mAP_50: 0.7080, bbox_mAP_75: 0.4270, bbox_mAP_s: 0.1500, bbox_mAP_m: 0.0710, bbox_mAP_l: 0.0240, bbox_mAP_copypaste: 0.226 0.708 0.427 0.150 0.071 0.024
2024-10-15 18:58:56,802 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:45, time: 0.861, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0235, stage0_bag_acc: 97.9611, stage0_mean_ious: 0.5077, stage0_s: 0.4770, stage0_m: 0.3038, stage0_l: 0.0130, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0109, stage1_bag_acc: 97.4889, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5940, stage1_s: 0.5931, stage1_m: 0.2769, stage1_l: 0.0150, stage1_h: 0.0000, loss: 0.0400, grad_norm: 2.3263
2024-10-15 18:59:39,067 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:09, time: 0.845, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0335, stage0_bag_acc: 98.4000, stage0_mean_ious: 0.4918, stage0_s: 0.4447, stage0_m: 0.3611, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 98.2000, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5850, stage1_s: 0.5624, stage1_m: 0.3663, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0451, grad_norm: 2.5008
2024-10-15 19:00:20,742 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:33, time: 0.834, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0210, stage0_bag_acc: 98.6000, stage0_mean_ious: 0.5084, stage0_s: 0.4777, stage0_m: 0.3354, stage0_l: 0.0051, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0112, stage1_bag_acc: 98.4000, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5950, stage1_s: 0.5824, stage1_m: 0.3529, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.0366, grad_norm: 2.2573
2024-10-15 19:01:02,206 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:57, time: 0.829, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0176, stage0_bag_acc: 98.3000, stage0_mean_ious: 0.4930, stage0_s: 0.4485, stage0_m: 0.3277, stage0_l: 0.0163, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 98.7000, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5944, stage1_s: 0.5883, stage1_m: 0.3333, stage1_l: 0.0140, stage1_h: 0.0000, loss: 0.0319, grad_norm: 2.2956
2024-10-15 19:01:44,496 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:21, time: 0.846, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0143, stage0_bag_acc: 99.0848, stage0_mean_ious: 0.4907, stage0_s: 0.4493, stage0_m: 0.3438, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 99.2182, stage1_neg_loss: 0.0070, stage1_mean_ious: 0.6031, stage1_s: 0.5882, stage1_m: 0.3700, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0300, grad_norm: 2.1869
2024-10-15 19:02:09,453 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 19:02:56,115 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:18, time: 0.894, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0185, stage0_bag_acc: 98.0667, stage0_mean_ious: 0.5087, stage0_s: 0.4603, stage0_m: 0.4197, stage0_l: 0.0063, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0070, stage1_bag_acc: 97.9500, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5993, stage1_s: 0.5874, stage1_m: 0.4081, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.0287, grad_norm: 1.7216
2024-10-15 19:03:36,810 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:42, time: 0.814, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0235, stage0_bag_acc: 98.5500, stage0_mean_ious: 0.5013, stage0_s: 0.4399, stage0_m: 0.3007, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0106, stage1_bag_acc: 98.5500, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5820, stage1_s: 0.5618, stage1_m: 0.2729, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0370, grad_norm: 2.4103
2024-10-15 19:04:18,586 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:05, time: 0.836, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0125, stage0_bag_acc: 99.4667, stage0_mean_ious: 0.5048, stage0_s: 0.4390, stage0_m: 0.3439, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0049, stage1_bag_acc: 99.4667, stage1_neg_loss: 0.0091, stage1_mean_ious: 0.6057, stage1_s: 0.5703, stage1_m: 0.3416, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0264, grad_norm: 2.0026
2024-10-15 19:05:00,458 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 19:05:00,458 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:28, time: 0.838, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0172, stage0_bag_acc: 98.4348, stage0_mean_ious: 0.4914, stage0_s: 0.4587, stage0_m: 0.3134, stage0_l: 0.0059, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0065, stage1_bag_acc: 99.0667, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.6045, stage1_s: 0.6027, stage1_m: 0.3215, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.0271, grad_norm: 1.9328
2024-10-15 19:05:44,867 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:52, time: 0.888, data_time: 0.011, memory: 7795, stage0_loss_instance_mil: 0.0139, stage0_bag_acc: 99.3000, stage0_mean_ious: 0.5066, stage0_s: 0.4434, stage0_m: 0.3826, stage0_l: 0.0127, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0094, stage1_bag_acc: 99.2643, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5953, stage1_s: 0.5618, stage1_m: 0.3906, stage1_l: 0.0154, stage1_h: 0.0000, loss: 0.0260, grad_norm: 1.9995
2024-10-15 19:06:10,828 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 19:06:57,439 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:51, time: 0.887, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0127, stage0_bag_acc: 99.0643, stage0_mean_ious: 0.5014, stage0_s: 0.4526, stage0_m: 0.3866, stage0_l: 0.0217, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0070, stage1_bag_acc: 98.4143, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5891, stage1_s: 0.5607, stage1_m: 0.3859, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.0236, grad_norm: 1.7197
2024-10-15 19:07:35,443 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:14, time: 0.760, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0127, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.4869, stage0_s: 0.4386, stage0_m: 0.2964, stage0_l: 0.0063, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0065, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.5886, stage1_s: 0.5867, stage1_m: 0.2730, stage1_l: 0.0047, stage1_h: 0.0000, loss: 0.0225, grad_norm: 1.6970
2024-10-15 19:08:13,829 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:36, time: 0.768, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0129, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.4916, stage0_s: 0.4578, stage0_m: 0.3011, stage0_l: 0.0270, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0051, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5916, stage1_s: 0.5925, stage1_m: 0.2940, stage1_l: 0.0263, stage1_h: 0.0000, loss: 0.0218, grad_norm: 1.4931
2024-10-15 19:08:55,707 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.838, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0201, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.4972, stage0_s: 0.4372, stage0_m: 0.3565, stage0_l: 0.0182, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0078, stage1_bag_acc: 99.1143, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.5971, stage1_s: 0.5755, stage1_m: 0.3400, stage1_l: 0.0100, stage1_h: 0.0000, loss: 0.0312, grad_norm: 1.8723
2024-10-15 19:09:41,998 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:22, time: 0.926, data_time: 0.011, memory: 7795, stage0_loss_instance_mil: 0.0085, stage0_bag_acc: 99.4000, stage0_mean_ious: 0.5162, stage0_s: 0.4604, stage0_m: 0.4152, stage0_l: 0.0141, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0040, stage1_bag_acc: 98.8167, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.6015, stage1_s: 0.6023, stage1_m: 0.3926, stage1_l: 0.0173, stage1_h: 0.0000, loss: 0.0141, grad_norm: 1.3850
2024-10-15 19:10:07,580 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 19:11:24,937 - mmdet - INFO - Evaluating bbox...
2024-10-15 19:11:25,522 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2244
2024-10-15 19:11:25,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7059
2024-10-15 19:11:25,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4247
2024-10-15 19:11:25,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1486
2024-10-15 19:11:25,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0684
2024-10-15 19:11:25,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0238
2024-10-15 19:11:25,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0015
2024-10-15 19:11:25,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 19:11:25,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2355
2024-10-15 19:11:25,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0732
2024-10-15 19:11:25,524 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3270
2024-10-15 19:11:25,524 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8015
2024-10-15 19:11:25,524 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3270
2024-10-15 19:11:25,524 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3270
2024-10-15 19:11:25,524 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 19:11:25,524 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3465
2024-10-15 19:11:25,524 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0820
2024-10-15 19:11:25,530 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 19:11:25,530 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2240, bbox_mAP_50: 0.7060, bbox_mAP_75: 0.4250, bbox_mAP_s: 0.1490, bbox_mAP_m: 0.0680, bbox_mAP_l: 0.0240, bbox_mAP_copypaste: 0.224 0.706 0.425 0.149 0.068 0.024
2024-10-15 19:12:42,104 - mmdet - INFO - Evaluating bbox...
2024-10-15 19:12:42,597 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2244
2024-10-15 19:12:42,597 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7059
2024-10-15 19:12:42,597 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4247
2024-10-15 19:12:42,597 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1486
2024-10-15 19:12:42,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0684
2024-10-15 19:12:42,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0238
2024-10-15 19:12:42,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0015
2024-10-15 19:12:42,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 19:12:42,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2355
2024-10-15 19:12:42,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0732
2024-10-15 19:12:42,598 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3270
2024-10-15 19:12:42,598 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8015
2024-10-15 19:12:42,598 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3270
2024-10-15 19:12:42,598 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3270
2024-10-15 19:12:42,599 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 19:12:42,599 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3465
2024-10-15 19:12:42,599 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0820
2024-10-15 19:12:43,888 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 19:12:44,894 - mmdet - INFO - Distributed training: False
2024-10-15 19:12:45,761 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 19:12:46,814 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 19:12:46,814 - mmdet - INFO - Use load_from_local loader
2024-10-15 19:12:47,180 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 19:12:47,198 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 19:12:47,199 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 19:13:32,843 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:50:21, time: 0.913, data_time: 0.060, memory: 7795, stage0_loss_instance_mil: 0.7282, stage0_bag_acc: 18.7288, stage0_mean_ious: 0.0287, stage0_s: 0.0240, stage0_m: 0.0225, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1623, stage1_bag_acc: 13.7278, stage1_neg_loss: 0.0008, stage1_mean_ious: 0.0292, stage1_s: 0.0245, stage1_m: 0.0217, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8913, grad_norm: 5.6544
2024-10-15 19:14:06,959 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:43:19, time: 0.682, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.6957, stage0_bag_acc: 25.0468, stage0_mean_ious: 0.0460, stage0_s: 0.0351, stage0_m: 0.0382, stage0_l: 0.0113, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1735, stage1_bag_acc: 19.1429, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.0483, stage1_s: 0.0378, stage1_m: 0.0392, stage1_l: 0.0108, stage1_h: 0.0000, loss: 0.8702, grad_norm: 5.5368
2024-10-15 19:14:51,647 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:44:22, time: 0.894, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.6760, stage0_bag_acc: 28.4525, stage0_mean_ious: 0.0932, stage0_s: 0.0654, stage0_m: 0.0952, stage0_l: 0.0146, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1728, stage1_bag_acc: 20.8338, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.0947, stage1_s: 0.0677, stage1_m: 0.0944, stage1_l: 0.0134, stage1_h: 0.0000, loss: 0.8508, grad_norm: 6.2089
2024-10-15 19:15:34,237 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:43:59, time: 0.852, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.6389, stage0_bag_acc: 24.8768, stage0_mean_ious: 0.1183, stage0_s: 0.0969, stage0_m: 0.1002, stage0_l: 0.0051, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1477, stage1_bag_acc: 24.6652, stage1_neg_loss: 0.0146, stage1_mean_ious: 0.1269, stage1_s: 0.1039, stage1_m: 0.1034, stage1_l: 0.0088, stage1_h: 0.0000, loss: 0.8012, grad_norm: 9.7433
2024-10-15 19:16:14,385 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:42:57, time: 0.803, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.5882, stage0_bag_acc: 35.7183, stage0_mean_ious: 0.1492, stage0_s: 0.1219, stage0_m: 0.1133, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1444, stage1_bag_acc: 38.4800, stage1_neg_loss: 0.0202, stage1_mean_ious: 0.1781, stage1_s: 0.1512, stage1_m: 0.1293, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.7528, grad_norm: 9.7934
2024-10-15 19:16:33,057 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 19:17:14,955 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:37:46, time: 0.794, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.4946, stage0_bag_acc: 41.0889, stage0_mean_ious: 0.1889, stage0_s: 0.1677, stage0_m: 0.1135, stage0_l: 0.0188, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1274, stage1_bag_acc: 51.0502, stage1_neg_loss: 0.0189, stage1_mean_ious: 0.2276, stage1_s: 0.2127, stage1_m: 0.1161, stage1_l: 0.0159, stage1_h: 0.0000, loss: 0.6409, grad_norm: 9.0962
2024-10-15 19:17:51,874 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:37:05, time: 0.738, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.5241, stage0_bag_acc: 38.1381, stage0_mean_ious: 0.1753, stage0_s: 0.1632, stage0_m: 0.1047, stage0_l: 0.0075, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1329, stage1_bag_acc: 50.1758, stage1_neg_loss: 0.0218, stage1_mean_ious: 0.2183, stage1_s: 0.2175, stage1_m: 0.1139, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.6788, grad_norm: 10.4016
2024-10-15 19:18:35,700 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:37:12, time: 0.876, data_time: 0.011, memory: 7795, stage0_loss_instance_mil: 0.4551, stage0_bag_acc: 52.2329, stage0_mean_ious: 0.2489, stage0_s: 0.2012, stage0_m: 0.2044, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1173, stage1_bag_acc: 64.4965, stage1_neg_loss: 0.0237, stage1_mean_ious: 0.2907, stage1_s: 0.2586, stage1_m: 0.2038, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5961, grad_norm: 11.0158
2024-10-15 19:19:20,086 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:37:12, time: 0.888, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.3213, stage0_bag_acc: 73.6702, stage0_mean_ious: 0.3461, stage0_s: 0.3097, stage0_m: 0.2647, stage0_l: 0.0237, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0969, stage1_bag_acc: 76.9330, stage1_neg_loss: 0.0223, stage1_mean_ious: 0.4194, stage1_s: 0.3933, stage1_m: 0.2817, stage1_l: 0.0203, stage1_h: 0.0000, loss: 0.4405, grad_norm: 10.6052
2024-10-15 19:20:00,945 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:36:44, time: 0.817, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.2573, stage0_bag_acc: 78.4556, stage0_mean_ious: 0.3897, stage0_s: 0.3433, stage0_m: 0.2923, stage0_l: 0.0117, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0822, stage1_bag_acc: 77.2556, stage1_neg_loss: 0.0173, stage1_mean_ious: 0.4603, stage1_s: 0.4382, stage1_m: 0.2834, stage1_l: 0.0061, stage1_h: 0.0000, loss: 0.3568, grad_norm: 8.7586
2024-10-15 19:20:26,157 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 19:21:12,361 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:34:19, time: 0.881, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.1604, stage0_bag_acc: 87.1007, stage0_mean_ious: 0.4631, stage0_s: 0.4293, stage0_m: 0.3704, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0580, stage1_bag_acc: 88.0364, stage1_neg_loss: 0.0271, stage1_mean_ious: 0.5404, stage1_s: 0.5159, stage1_m: 0.3798, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2455, grad_norm: 7.8611
2024-10-15 19:21:53,090 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:33:55, time: 0.814, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.1459, stage0_bag_acc: 88.6304, stage0_mean_ious: 0.4444, stage0_s: 0.3918, stage0_m: 0.3643, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0529, stage1_bag_acc: 89.3836, stage1_neg_loss: 0.0111, stage1_mean_ious: 0.5233, stage1_s: 0.5037, stage1_m: 0.3467, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2099, grad_norm: 7.4424
2024-10-15 19:22:35,933 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:33:37, time: 0.857, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.1715, stage0_bag_acc: 85.4833, stage0_mean_ious: 0.4409, stage0_s: 0.3923, stage0_m: 0.3412, stage0_l: 0.0312, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0428, stage1_bag_acc: 88.4556, stage1_neg_loss: 0.0134, stage1_mean_ious: 0.5496, stage1_s: 0.5367, stage1_m: 0.3208, stage1_l: 0.0309, stage1_h: 0.0000, loss: 0.2277, grad_norm: 7.6072
2024-10-15 19:23:17,552 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:33:11, time: 0.832, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0915, stage0_bag_acc: 93.6712, stage0_mean_ious: 0.4505, stage0_s: 0.3944, stage0_m: 0.3332, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0441, stage1_bag_acc: 93.9212, stage1_neg_loss: 0.0200, stage1_mean_ious: 0.5613, stage1_s: 0.5339, stage1_m: 0.3444, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1556, grad_norm: 6.2591
2024-10-15 19:23:59,643 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:32:44, time: 0.842, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.1123, stage0_bag_acc: 91.4816, stage0_mean_ious: 0.4681, stage0_s: 0.3925, stage0_m: 0.2762, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0384, stage1_bag_acc: 91.8825, stage1_neg_loss: 0.0146, stage1_mean_ious: 0.5656, stage1_s: 0.5213, stage1_m: 0.2618, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1653, grad_norm: 6.1666
2024-10-15 19:24:24,131 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 19:25:44,010 - mmdet - INFO - Evaluating bbox...
2024-10-15 19:25:44,533 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2079
2024-10-15 19:25:44,533 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6891
2024-10-15 19:25:44,533 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3895
2024-10-15 19:25:44,533 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1374
2024-10-15 19:25:44,533 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0635
2024-10-15 19:25:44,533 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0205
2024-10-15 19:25:44,534 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0003
2024-10-15 19:25:44,534 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 19:25:44,534 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2187
2024-10-15 19:25:44,534 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0608
2024-10-15 19:25:44,534 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3106
2024-10-15 19:25:44,534 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7873
2024-10-15 19:25:44,534 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3106
2024-10-15 19:25:44,534 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3106
2024-10-15 19:25:44,534 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 19:25:44,534 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3281
2024-10-15 19:25:44,534 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0786
2024-10-15 19:25:44,542 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 19:25:44,542 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2080, bbox_mAP_50: 0.6890, bbox_mAP_75: 0.3900, bbox_mAP_s: 0.1370, bbox_mAP_m: 0.0640, bbox_mAP_l: 0.0200, bbox_mAP_copypaste: 0.208 0.689 0.390 0.137 0.064 0.020
2024-10-15 19:26:30,410 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:30:59, time: 0.917, data_time: 0.061, memory: 7803, stage0_loss_instance_mil: 0.0806, stage0_bag_acc: 95.3000, stage0_mean_ious: 0.4825, stage0_s: 0.4022, stage0_m: 0.3703, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0269, stage1_bag_acc: 95.7722, stage1_neg_loss: 0.0104, stage1_mean_ious: 0.5837, stage1_s: 0.5370, stage1_m: 0.3845, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1179, grad_norm: 5.5387
2024-10-15 19:27:12,958 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:30:34, time: 0.851, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0768, stage0_bag_acc: 93.5968, stage0_mean_ious: 0.4677, stage0_s: 0.4231, stage0_m: 0.3059, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0320, stage1_bag_acc: 95.6468, stage1_neg_loss: 0.0110, stage1_mean_ious: 0.5618, stage1_s: 0.5431, stage1_m: 0.3174, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.1197, grad_norm: 5.7705
2024-10-15 19:27:55,376 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:30:07, time: 0.848, data_time: 0.012, memory: 7803, stage0_loss_instance_mil: 0.0841, stage0_bag_acc: 95.0944, stage0_mean_ious: 0.4720, stage0_s: 0.4366, stage0_m: 0.3088, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0273, stage1_bag_acc: 94.2015, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.5781, stage1_s: 0.5621, stage1_m: 0.2980, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1200, grad_norm: 4.7594
2024-10-15 19:28:36,850 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:29:36, time: 0.829, data_time: 0.012, memory: 7803, stage0_loss_instance_mil: 0.0583, stage0_bag_acc: 95.5111, stage0_mean_ious: 0.4491, stage0_s: 0.4181, stage0_m: 0.2735, stage0_l: 0.0155, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0220, stage1_bag_acc: 95.5111, stage1_neg_loss: 0.0132, stage1_mean_ious: 0.5656, stage1_s: 0.5558, stage1_m: 0.2873, stage1_l: 0.0145, stage1_h: 0.0000, loss: 0.0935, grad_norm: 4.3453
2024-10-15 19:29:21,602 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:29:11, time: 0.895, data_time: 0.013, memory: 7803, stage0_loss_instance_mil: 0.0798, stage0_bag_acc: 94.0968, stage0_mean_ious: 0.4980, stage0_s: 0.4376, stage0_m: 0.4454, stage0_l: 0.0127, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0221, stage1_bag_acc: 94.9468, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5713, stage1_s: 0.5385, stage1_m: 0.4323, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.1079, grad_norm: 4.8186
2024-10-15 19:29:47,053 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 19:30:34,170 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:27:39, time: 0.907, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0579, stage0_bag_acc: 95.6936, stage0_mean_ious: 0.4953, stage0_s: 0.4336, stage0_m: 0.4104, stage0_l: 0.0194, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0211, stage1_bag_acc: 95.1071, stage1_neg_loss: 0.0098, stage1_mean_ious: 0.5691, stage1_s: 0.5427, stage1_m: 0.3673, stage1_l: 0.0138, stage1_h: 0.0000, loss: 0.0889, grad_norm: 4.6639
2024-10-15 19:31:15,270 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:27:07, time: 0.822, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0680, stage0_bag_acc: 96.1278, stage0_mean_ious: 0.4689, stage0_s: 0.4010, stage0_m: 0.3462, stage0_l: 0.0419, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0214, stage1_bag_acc: 95.7944, stage1_neg_loss: 0.0090, stage1_mean_ious: 0.5613, stage1_s: 0.5288, stage1_m: 0.3346, stage1_l: 0.0334, stage1_h: 0.0000, loss: 0.0984, grad_norm: 4.8448
2024-10-15 19:31:56,424 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:26:34, time: 0.823, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0683, stage0_bag_acc: 94.0688, stage0_mean_ious: 0.4894, stage0_s: 0.4388, stage0_m: 0.3359, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0219, stage1_bag_acc: 94.8491, stage1_neg_loss: 0.0088, stage1_mean_ious: 0.5705, stage1_s: 0.5575, stage1_m: 0.3074, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.0990, grad_norm: 5.2342
2024-10-15 19:32:37,216 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:26:00, time: 0.816, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0596, stage0_bag_acc: 94.9134, stage0_mean_ious: 0.4578, stage0_s: 0.3856, stage0_m: 0.3608, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0226, stage1_bag_acc: 95.3158, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5580, stage1_s: 0.5175, stage1_m: 0.3652, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0869, grad_norm: 4.1559
2024-10-15 19:33:11,291 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:25:16, time: 0.682, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0489, stage0_bag_acc: 95.4333, stage0_mean_ious: 0.4819, stage0_s: 0.4327, stage0_m: 0.3904, stage0_l: 0.0203, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0212, stage1_bag_acc: 94.9444, stage1_neg_loss: 0.0088, stage1_mean_ious: 0.5753, stage1_s: 0.5626, stage1_m: 0.4017, stage1_l: 0.0157, stage1_h: 0.0000, loss: 0.0789, grad_norm: 3.6225
2024-10-15 19:33:32,122 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 19:34:09,930 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:23:41, time: 0.712, data_time: 0.056, memory: 7803, stage0_loss_instance_mil: 0.0407, stage0_bag_acc: 97.6102, stage0_mean_ious: 0.4822, stage0_s: 0.4195, stage0_m: 0.3909, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0196, stage1_bag_acc: 97.3269, stage1_neg_loss: 0.0070, stage1_mean_ious: 0.5675, stage1_s: 0.5517, stage1_m: 0.3653, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0673, grad_norm: 3.4800
2024-10-15 19:34:45,087 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:23:01, time: 0.703, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0324, stage0_bag_acc: 97.5667, stage0_mean_ious: 0.4908, stage0_s: 0.4265, stage0_m: 0.4487, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0154, stage1_bag_acc: 97.5667, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5708, stage1_s: 0.5676, stage1_m: 0.4236, stage1_l: 0.0050, stage1_h: 0.0000, loss: 0.0533, grad_norm: 3.2554
2024-10-15 19:35:26,694 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:29, time: 0.832, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0658, stage0_bag_acc: 94.8855, stage0_mean_ious: 0.4800, stage0_s: 0.4485, stage0_m: 0.3062, stage0_l: 0.0112, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0186, stage1_bag_acc: 95.6173, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5769, stage1_s: 0.5645, stage1_m: 0.3164, stage1_l: 0.0074, stage1_h: 0.0000, loss: 0.0924, grad_norm: 4.5404
2024-10-15 19:36:10,118 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:21:59, time: 0.869, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0491, stage0_bag_acc: 96.2340, stage0_mean_ious: 0.4754, stage0_s: 0.4337, stage0_m: 0.3712, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0166, stage1_bag_acc: 96.3047, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.5509, stage1_s: 0.5538, stage1_m: 0.3443, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0732, grad_norm: 3.7435
2024-10-15 19:36:52,179 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:26, time: 0.841, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0723, stage0_bag_acc: 94.8286, stage0_mean_ious: 0.4743, stage0_s: 0.4489, stage0_m: 0.2943, stage0_l: 0.0054, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0176, stage1_bag_acc: 95.5643, stage1_neg_loss: 0.0069, stage1_mean_ious: 0.5686, stage1_s: 0.5713, stage1_m: 0.2958, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.0968, grad_norm: 4.6561
2024-10-15 19:37:18,162 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 19:38:37,227 - mmdet - INFO - Evaluating bbox...
2024-10-15 19:38:37,805 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2004
2024-10-15 19:38:37,805 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6526
2024-10-15 19:38:37,806 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3835
2024-10-15 19:38:37,806 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1294
2024-10-15 19:38:37,806 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0632
2024-10-15 19:38:37,806 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0257
2024-10-15 19:38:37,806 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0024
2024-10-15 19:38:37,806 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 19:38:37,806 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2101
2024-10-15 19:38:37,806 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0492
2024-10-15 19:38:37,806 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3051
2024-10-15 19:38:37,807 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7617
2024-10-15 19:38:37,807 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3051
2024-10-15 19:38:37,807 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3051
2024-10-15 19:38:37,807 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 19:38:37,807 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3221
2024-10-15 19:38:37,807 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0780
2024-10-15 19:38:37,813 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 19:38:37,813 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2000, bbox_mAP_50: 0.6530, bbox_mAP_75: 0.3830, bbox_mAP_s: 0.1290, bbox_mAP_m: 0.0630, bbox_mAP_l: 0.0260, bbox_mAP_copypaste: 0.200 0.653 0.383 0.129 0.063 0.026
2024-10-15 19:39:21,701 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:20:11, time: 0.878, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0576, stage0_bag_acc: 96.3682, stage0_mean_ious: 0.4509, stage0_s: 0.3979, stage0_m: 0.3160, stage0_l: 0.0233, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0247, stage1_bag_acc: 95.0515, stage1_neg_loss: 0.0069, stage1_mean_ious: 0.5391, stage1_s: 0.5155, stage1_m: 0.2935, stage1_l: 0.0175, stage1_h: 0.0000, loss: 0.0892, grad_norm: 4.6976
2024-10-15 19:40:06,157 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:19:40, time: 0.889, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0361, stage0_bag_acc: 96.9056, stage0_mean_ious: 0.4789, stage0_s: 0.4453, stage0_m: 0.3057, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 97.8500, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5780, stage1_s: 0.5705, stage1_m: 0.3271, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0477, grad_norm: 2.6141
2024-10-15 19:40:46,552 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:19:05, time: 0.808, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0586, stage0_bag_acc: 95.9056, stage0_mean_ious: 0.5019, stage0_s: 0.4504, stage0_m: 0.3556, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0185, stage1_bag_acc: 96.5778, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5708, stage1_s: 0.5528, stage1_m: 0.3501, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0823, grad_norm: 4.0339
2024-10-15 19:41:28,295 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:31, time: 0.835, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0414, stage0_bag_acc: 97.7952, stage0_mean_ious: 0.4813, stage0_s: 0.4416, stage0_m: 0.3487, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 97.3952, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5643, stage1_s: 0.5589, stage1_m: 0.3383, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0560, grad_norm: 3.0529
2024-10-15 19:42:11,445 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:17:58, time: 0.863, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0378, stage0_bag_acc: 96.9000, stage0_mean_ious: 0.4651, stage0_s: 0.4189, stage0_m: 0.3354, stage0_l: 0.0142, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0122, stage1_bag_acc: 97.5444, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5610, stage1_s: 0.5521, stage1_m: 0.3437, stage1_l: 0.0131, stage1_h: 0.0000, loss: 0.0574, grad_norm: 3.5640
2024-10-15 19:42:36,929 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 19:43:25,619 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:48, time: 0.929, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.0409, stage0_bag_acc: 97.4182, stage0_mean_ious: 0.4775, stage0_s: 0.4241, stage0_m: 0.3303, stage0_l: 0.0115, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0099, stage1_bag_acc: 97.2182, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5759, stage1_s: 0.5580, stage1_m: 0.3360, stage1_l: 0.0096, stage1_h: 0.0000, loss: 0.0546, grad_norm: 2.9493
2024-10-15 19:44:07,842 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:16:14, time: 0.844, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0284, stage0_bag_acc: 97.8286, stage0_mean_ious: 0.4809, stage0_s: 0.4511, stage0_m: 0.2910, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0137, stage1_bag_acc: 98.0786, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.5596, stage1_s: 0.5480, stage1_m: 0.3101, stage1_l: 0.0071, stage1_h: 0.0000, loss: 0.0493, grad_norm: 2.7929
2024-10-15 19:44:48,127 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:38, time: 0.806, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0531, stage0_bag_acc: 97.4667, stage0_mean_ious: 0.4581, stage0_s: 0.4269, stage0_m: 0.3423, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0205, stage1_bag_acc: 96.5278, stage1_neg_loss: 0.0114, stage1_mean_ious: 0.5572, stage1_s: 0.5540, stage1_m: 0.3372, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0851, grad_norm: 4.3679
2024-10-15 19:45:30,613 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:15:03, time: 0.850, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0146, stage0_bag_acc: 99.1278, stage0_mean_ious: 0.4896, stage0_s: 0.4562, stage0_m: 0.3408, stage0_l: 0.0289, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5712, stage1_s: 0.5710, stage1_m: 0.3347, stage1_l: 0.0235, stage1_h: 0.0000, loss: 0.0294, grad_norm: 2.3097
2024-10-15 19:46:10,830 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:27, time: 0.804, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0468, stage0_bag_acc: 97.4952, stage0_mean_ious: 0.4831, stage0_s: 0.4594, stage0_m: 0.2654, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0141, stage1_bag_acc: 97.1952, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.5810, stage1_s: 0.5769, stage1_m: 0.2551, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0689, grad_norm: 4.0960
2024-10-15 19:46:36,004 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 19:47:22,168 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:19, time: 0.879, data_time: 0.061, memory: 7803, stage0_loss_instance_mil: 0.0206, stage0_bag_acc: 98.9587, stage0_mean_ious: 0.4632, stage0_s: 0.4309, stage0_m: 0.2741, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0213, stage1_bag_acc: 98.1801, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5636, stage1_s: 0.5458, stage1_m: 0.2901, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0446, grad_norm: 3.0683
2024-10-15 19:48:03,084 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:43, time: 0.818, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0226, stage0_bag_acc: 98.1833, stage0_mean_ious: 0.4803, stage0_s: 0.4539, stage0_m: 0.3133, stage0_l: 0.0174, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 98.1833, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5686, stage1_s: 0.5586, stage1_m: 0.3150, stage1_l: 0.0144, stage1_h: 0.0000, loss: 0.0342, grad_norm: 2.1889
2024-10-15 19:48:44,766 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:12:07, time: 0.834, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0150, stage0_bag_acc: 99.1000, stage0_mean_ious: 0.4814, stage0_s: 0.4392, stage0_m: 0.3331, stage0_l: 0.0199, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0090, stage1_bag_acc: 98.8167, stage1_neg_loss: 0.0045, stage1_mean_ious: 0.5693, stage1_s: 0.5654, stage1_m: 0.3113, stage1_l: 0.0155, stage1_h: 0.0000, loss: 0.0284, grad_norm: 2.1266
2024-10-15 19:49:26,440 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:31, time: 0.833, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0163, stage0_bag_acc: 99.2778, stage0_mean_ious: 0.4793, stage0_s: 0.4318, stage0_m: 0.2799, stage0_l: 0.0150, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0114, stage1_bag_acc: 98.7778, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5531, stage1_s: 0.5388, stage1_m: 0.2591, stage1_l: 0.0158, stage1_h: 0.0000, loss: 0.0315, grad_norm: 2.2733
2024-10-15 19:50:04,964 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:54, time: 0.771, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0500, stage0_bag_acc: 96.9587, stage0_mean_ious: 0.4776, stage0_s: 0.4343, stage0_m: 0.3318, stage0_l: 0.0117, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0095, stage1_bag_acc: 97.1008, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5611, stage1_s: 0.5512, stage1_m: 0.3263, stage1_l: 0.0071, stage1_h: 0.0000, loss: 0.0647, grad_norm: 3.2826
2024-10-15 19:50:24,391 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 19:51:42,775 - mmdet - INFO - Evaluating bbox...
2024-10-15 19:51:43,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1715
2024-10-15 19:51:43,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6170
2024-10-15 19:51:43,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3082
2024-10-15 19:51:43,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0884
2024-10-15 19:51:43,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0380
2024-10-15 19:51:43,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0122
2024-10-15 19:51:43,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-15 19:51:43,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 19:51:43,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1809
2024-10-15 19:51:43,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0359
2024-10-15 19:51:43,255 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2793
2024-10-15 19:51:43,255 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7429
2024-10-15 19:51:43,255 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2793
2024-10-15 19:51:43,255 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2793
2024-10-15 19:51:43,255 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 19:51:43,255 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2964
2024-10-15 19:51:43,255 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0639
2024-10-15 19:51:43,261 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 19:51:43,261 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.1720, bbox_mAP_50: 0.6170, bbox_mAP_75: 0.3080, bbox_mAP_s: 0.0880, bbox_mAP_m: 0.0380, bbox_mAP_l: 0.0120, bbox_mAP_copypaste: 0.172 0.617 0.308 0.088 0.038 0.012
2024-10-15 19:52:21,125 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:47, time: 0.757, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0207, stage0_bag_acc: 98.4643, stage0_mean_ious: 0.4708, stage0_s: 0.4019, stage0_m: 0.3974, stage0_l: 0.0062, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0075, stage1_bag_acc: 98.3310, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5532, stage1_s: 0.5192, stage1_m: 0.3874, stage1_l: 0.0061, stage1_h: 0.0000, loss: 0.0342, grad_norm: 2.1710
2024-10-15 19:53:01,554 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:11, time: 0.809, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0330, stage0_bag_acc: 97.0682, stage0_mean_ious: 0.4801, stage0_s: 0.4163, stage0_m: 0.2644, stage0_l: 0.0271, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0111, stage1_bag_acc: 97.3682, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.5694, stage1_s: 0.5218, stage1_m: 0.2573, stage1_l: 0.0203, stage1_h: 0.0000, loss: 0.0525, grad_norm: 3.1666
2024-10-15 19:53:43,999 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:35, time: 0.849, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0170, stage0_bag_acc: 98.8333, stage0_mean_ious: 0.4723, stage0_s: 0.4425, stage0_m: 0.2789, stage0_l: 0.0094, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0099, stage1_bag_acc: 98.5833, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5589, stage1_s: 0.5547, stage1_m: 0.2795, stage1_l: 0.0083, stage1_h: 0.0000, loss: 0.0313, grad_norm: 2.0418
2024-10-15 19:54:26,710 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:59, time: 0.854, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0211, stage0_bag_acc: 97.8286, stage0_mean_ious: 0.4727, stage0_s: 0.4329, stage0_m: 0.3621, stage0_l: 0.0119, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0116, stage1_bag_acc: 98.0786, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5484, stage1_s: 0.5336, stage1_m: 0.3485, stage1_l: 0.0088, stage1_h: 0.0000, loss: 0.0365, grad_norm: 2.3597
2024-10-15 19:55:09,014 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:22, time: 0.846, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0119, stage0_bag_acc: 99.3182, stage0_mean_ious: 0.5102, stage0_s: 0.4807, stage0_m: 0.3366, stage0_l: 0.0254, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0069, stage1_bag_acc: 99.3182, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5770, stage1_s: 0.5696, stage1_m: 0.3311, stage1_l: 0.0210, stage1_h: 0.0000, loss: 0.0225, grad_norm: 1.7162
2024-10-15 19:55:34,253 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 19:56:19,050 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:19, time: 0.851, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0268, stage0_bag_acc: 97.6673, stage0_mean_ious: 0.4854, stage0_s: 0.4328, stage0_m: 0.2996, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0092, stage1_bag_acc: 98.0673, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5671, stage1_s: 0.5421, stage1_m: 0.2826, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0406, grad_norm: 2.7227
2024-10-15 19:57:01,183 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:43, time: 0.843, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0089, stage0_bag_acc: 99.5000, stage0_mean_ious: 0.4853, stage0_s: 0.4635, stage0_m: 0.2951, stage0_l: 0.0237, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.5814, stage1_s: 0.5891, stage1_m: 0.2939, stage1_l: 0.0196, stage1_h: 0.0000, loss: 0.0236, grad_norm: 2.1578
2024-10-15 19:57:45,082 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:06, time: 0.878, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0154, stage0_bag_acc: 98.9643, stage0_mean_ious: 0.5086, stage0_s: 0.4547, stage0_m: 0.3840, stage0_l: 0.0164, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 98.4286, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5619, stage1_s: 0.5352, stage1_m: 0.3748, stage1_l: 0.0099, stage1_h: 0.0000, loss: 0.0248, grad_norm: 1.5738
2024-10-15 19:58:28,170 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 19:58:28,170 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:30, time: 0.862, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0389, stage0_bag_acc: 97.8500, stage0_mean_ious: 0.4739, stage0_s: 0.4380, stage0_m: 0.4091, stage0_l: 0.0108, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0092, stage1_bag_acc: 98.5000, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5654, stage1_s: 0.5628, stage1_m: 0.4133, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.0524, grad_norm: 2.8321
2024-10-15 19:59:09,259 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:52, time: 0.822, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0293, stage0_bag_acc: 97.8111, stage0_mean_ious: 0.4618, stage0_s: 0.4178, stage0_m: 0.2566, stage0_l: 0.0141, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0119, stage1_bag_acc: 98.2111, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.5584, stage1_s: 0.5269, stage1_m: 0.2663, stage1_l: 0.0099, stage1_h: 0.0000, loss: 0.0435, grad_norm: 2.3353
2024-10-15 19:59:32,925 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 20:00:18,231 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:51, time: 0.861, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0142, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.4804, stage0_s: 0.4503, stage0_m: 0.2599, stage0_l: 0.0107, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 98.7000, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5609, stage1_s: 0.5486, stage1_m: 0.2619, stage1_l: 0.0061, stage1_h: 0.0000, loss: 0.0265, grad_norm: 1.9572
2024-10-15 20:00:57,898 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:14, time: 0.793, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0299, stage0_bag_acc: 97.5364, stage0_mean_ious: 0.4620, stage0_s: 0.4407, stage0_m: 0.2624, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 97.4864, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5592, stage1_s: 0.5542, stage1_m: 0.2818, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0411, grad_norm: 2.4590
2024-10-15 20:01:41,089 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:37, time: 0.864, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0124, stage0_bag_acc: 99.1278, stage0_mean_ious: 0.4888, stage0_s: 0.4570, stage0_m: 0.3469, stage0_l: 0.0093, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0049, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5822, stage1_s: 0.5729, stage1_m: 0.3782, stage1_l: 0.0047, stage1_h: 0.0000, loss: 0.0230, grad_norm: 1.9453
2024-10-15 20:02:24,095 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:01:00, time: 0.860, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0138, stage0_bag_acc: 99.1030, stage0_mean_ious: 0.4824, stage0_s: 0.4366, stage0_m: 0.3542, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 99.4364, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5636, stage1_s: 0.5499, stage1_m: 0.3428, stage1_l: 0.0043, stage1_h: 0.0000, loss: 0.0255, grad_norm: 1.8776
2024-10-15 20:03:07,108 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:22, time: 0.860, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0076, stage0_bag_acc: 99.8000, stage0_mean_ious: 0.4823, stage0_s: 0.4204, stage0_m: 0.3883, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0044, stage1_bag_acc: 99.8000, stage1_neg_loss: 0.0077, stage1_mean_ious: 0.5768, stage1_s: 0.5483, stage1_m: 0.3886, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.0197, grad_norm: 1.4993
2024-10-15 20:03:32,600 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 20:04:50,201 - mmdet - INFO - Evaluating bbox...
2024-10-15 20:04:50,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1758
2024-10-15 20:04:50,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6276
2024-10-15 20:04:50,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3219
2024-10-15 20:04:50,694 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0945
2024-10-15 20:04:50,694 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0391
2024-10-15 20:04:50,694 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0123
2024-10-15 20:04:50,694 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 20:04:50,694 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:04:50,694 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1854
2024-10-15 20:04:50,694 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0389
2024-10-15 20:04:50,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2856
2024-10-15 20:04:50,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7507
2024-10-15 20:04:50,695 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2856
2024-10-15 20:04:50,695 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2856
2024-10-15 20:04:50,695 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:04:50,695 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3030
2024-10-15 20:04:50,695 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0652
2024-10-15 20:04:50,701 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 20:04:50,701 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.1760, bbox_mAP_50: 0.6280, bbox_mAP_75: 0.3220, bbox_mAP_s: 0.0950, bbox_mAP_m: 0.0390, bbox_mAP_l: 0.0120, bbox_mAP_copypaste: 0.176 0.628 0.322 0.095 0.039 0.012
2024-10-15 20:06:08,278 - mmdet - INFO - Evaluating bbox...
2024-10-15 20:06:08,836 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1758
2024-10-15 20:06:08,837 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6276
2024-10-15 20:06:08,837 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3219
2024-10-15 20:06:08,837 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0945
2024-10-15 20:06:08,837 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0391
2024-10-15 20:06:08,837 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0123
2024-10-15 20:06:08,837 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 20:06:08,837 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:06:08,837 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1854
2024-10-15 20:06:08,837 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0389
2024-10-15 20:06:08,837 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2856
2024-10-15 20:06:08,838 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7507
2024-10-15 20:06:08,838 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2856
2024-10-15 20:06:08,838 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2856
2024-10-15 20:06:08,838 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:06:08,838 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3030
2024-10-15 20:06:08,838 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0652
2024-10-15 20:06:10,123 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 20:06:11,047 - mmdet - INFO - Distributed training: False
2024-10-15 20:06:11,911 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 20:06:12,929 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 20:06:12,930 - mmdet - INFO - Use load_from_local loader
2024-10-15 20:06:13,204 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 20:06:13,223 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 20:06:13,224 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 20:07:00,527 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:52:10, time: 0.946, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.7356, stage0_bag_acc: 20.1444, stage0_mean_ious: 0.0576, stage0_s: 0.0485, stage0_m: 0.0587, stage0_l: 0.0006, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1657, stage1_bag_acc: 13.3192, stage1_neg_loss: 0.0004, stage1_mean_ious: 0.0605, stage1_s: 0.0500, stage1_m: 0.0596, stage1_l: 0.0007, stage1_h: 0.0000, loss: 0.9017, grad_norm: 5.5060
2024-10-15 20:07:37,767 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:45:55, time: 0.745, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.7100, stage0_bag_acc: 16.6444, stage0_mean_ious: 0.0909, stage0_s: 0.0523, stage0_m: 0.1030, stage0_l: 0.0031, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1711, stage1_bag_acc: 19.1889, stage1_neg_loss: 0.0006, stage1_mean_ious: 0.0880, stage1_s: 0.0516, stage1_m: 0.1001, stage1_l: 0.0044, stage1_h: 0.0000, loss: 0.8816, grad_norm: 5.2660
2024-10-15 20:08:10,287 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:41:45, time: 0.650, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.6825, stage0_bag_acc: 20.4294, stage0_mean_ious: 0.1055, stage0_s: 0.0922, stage0_m: 0.1098, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1733, stage1_bag_acc: 23.5952, stage1_neg_loss: 0.0015, stage1_mean_ious: 0.0985, stage1_s: 0.0843, stage1_m: 0.1002, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8573, grad_norm: 5.9235
2024-10-15 20:08:44,540 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:39:50, time: 0.685, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.6593, stage0_bag_acc: 22.3408, stage0_mean_ious: 0.1360, stage0_s: 0.1045, stage0_m: 0.1431, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1637, stage1_bag_acc: 19.1230, stage1_neg_loss: 0.0088, stage1_mean_ious: 0.1369, stage1_s: 0.1100, stage1_m: 0.1302, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8318, grad_norm: 8.8772
2024-10-15 20:09:17,922 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:38:17, time: 0.668, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.6011, stage0_bag_acc: 31.4847, stage0_mean_ious: 0.1618, stage0_s: 0.1416, stage0_m: 0.1354, stage0_l: 0.0094, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1544, stage1_bag_acc: 36.5260, stage1_neg_loss: 0.0208, stage1_mean_ious: 0.1900, stage1_s: 0.1697, stage1_m: 0.1574, stage1_l: 0.0112, stage1_h: 0.0000, loss: 0.7763, grad_norm: 10.1593
2024-10-15 20:09:39,189 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 20:10:26,548 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:35:05, time: 0.892, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.4954, stage0_bag_acc: 44.6563, stage0_mean_ious: 0.2509, stage0_s: 0.2062, stage0_m: 0.2212, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1061, stage1_bag_acc: 54.6063, stage1_neg_loss: 0.0233, stage1_mean_ious: 0.3290, stage1_s: 0.2815, stage1_m: 0.2756, stage1_l: 0.0088, stage1_h: 0.0000, loss: 0.6248, grad_norm: 11.3818
2024-10-15 20:11:07,234 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:35:17, time: 0.814, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.5123, stage0_bag_acc: 44.5139, stage0_mean_ious: 0.2739, stage0_s: 0.2388, stage0_m: 0.1981, stage0_l: 0.0158, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1007, stage1_bag_acc: 43.3439, stage1_neg_loss: 0.0176, stage1_mean_ious: 0.3291, stage1_s: 0.2888, stage1_m: 0.2274, stage1_l: 0.0097, stage1_h: 0.0000, loss: 0.6305, grad_norm: 12.2331
2024-10-15 20:11:50,870 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:35:36, time: 0.873, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.4415, stage0_bag_acc: 55.0004, stage0_mean_ious: 0.3327, stage0_s: 0.2860, stage0_m: 0.2782, stage0_l: 0.0123, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0972, stage1_bag_acc: 52.2314, stage1_neg_loss: 0.0193, stage1_mean_ious: 0.4303, stage1_s: 0.3794, stage1_m: 0.3498, stage1_l: 0.0103, stage1_h: 0.0000, loss: 0.5581, grad_norm: 14.3763
2024-10-15 20:12:33,702 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:35:38, time: 0.857, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.2644, stage0_bag_acc: 75.5063, stage0_mean_ious: 0.3950, stage0_s: 0.3447, stage0_m: 0.3121, stage0_l: 0.0139, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0673, stage1_bag_acc: 76.9277, stage1_neg_loss: 0.0145, stage1_mean_ious: 0.5109, stage1_s: 0.4745, stage1_m: 0.3657, stage1_l: 0.0121, stage1_h: 0.0000, loss: 0.3461, grad_norm: 11.9468
2024-10-15 20:13:16,978 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:35:34, time: 0.865, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1950, stage0_bag_acc: 82.9307, stage0_mean_ious: 0.4331, stage0_s: 0.3416, stage0_m: 0.4013, stage0_l: 0.0124, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0524, stage1_bag_acc: 86.5848, stage1_neg_loss: 0.0136, stage1_mean_ious: 0.5405, stage1_s: 0.4879, stage1_m: 0.4007, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.2611, grad_norm: 10.9029
2024-10-15 20:13:42,408 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 20:14:30,217 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:33:27, time: 0.912, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.1890, stage0_bag_acc: 85.0159, stage0_mean_ious: 0.4469, stage0_s: 0.3930, stage0_m: 0.3353, stage0_l: 0.0213, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0504, stage1_bag_acc: 85.8492, stage1_neg_loss: 0.0124, stage1_mean_ious: 0.5655, stage1_s: 0.5348, stage1_m: 0.3580, stage1_l: 0.0134, stage1_h: 0.0000, loss: 0.2518, grad_norm: 9.9041
2024-10-15 20:15:12,875 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:33:16, time: 0.853, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1249, stage0_bag_acc: 92.0563, stage0_mean_ious: 0.4366, stage0_s: 0.3958, stage0_m: 0.3118, stage0_l: 0.0159, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0368, stage1_bag_acc: 92.0897, stage1_neg_loss: 0.0123, stage1_mean_ious: 0.5679, stage1_s: 0.5520, stage1_m: 0.3547, stage1_l: 0.0157, stage1_h: 0.0000, loss: 0.1741, grad_norm: 6.9060
2024-10-15 20:15:56,423 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:33:03, time: 0.871, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1311, stage0_bag_acc: 89.0524, stage0_mean_ious: 0.4604, stage0_s: 0.3911, stage0_m: 0.3598, stage0_l: 0.0238, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0362, stage1_bag_acc: 91.2381, stage1_neg_loss: 0.0124, stage1_mean_ious: 0.5923, stage1_s: 0.5438, stage1_m: 0.4028, stage1_l: 0.0177, stage1_h: 0.0000, loss: 0.1797, grad_norm: 8.4018
2024-10-15 20:16:37,674 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:32:39, time: 0.825, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1077, stage0_bag_acc: 91.8786, stage0_mean_ious: 0.4550, stage0_s: 0.4110, stage0_m: 0.3452, stage0_l: 0.0211, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0438, stage1_bag_acc: 93.2952, stage1_neg_loss: 0.0163, stage1_mean_ious: 0.5532, stage1_s: 0.5522, stage1_m: 0.3414, stage1_l: 0.0145, stage1_h: 0.0000, loss: 0.1679, grad_norm: 6.9030
2024-10-15 20:17:20,183 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:32:16, time: 0.850, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1309, stage0_bag_acc: 90.8904, stage0_mean_ious: 0.4636, stage0_s: 0.3947, stage0_m: 0.3322, stage0_l: 0.0302, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0344, stage1_bag_acc: 91.0293, stage1_neg_loss: 0.0098, stage1_mean_ious: 0.5703, stage1_s: 0.5415, stage1_m: 0.3351, stage1_l: 0.0207, stage1_h: 0.0000, loss: 0.1751, grad_norm: 7.9693
2024-10-15 20:17:45,366 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 20:19:03,655 - mmdet - INFO - Evaluating bbox...
2024-10-15 20:19:04,249 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2121
2024-10-15 20:19:04,249 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6865
2024-10-15 20:19:04,249 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4124
2024-10-15 20:19:04,250 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1359
2024-10-15 20:19:04,250 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0626
2024-10-15 20:19:04,250 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0203
2024-10-15 20:19:04,250 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0003
2024-10-15 20:19:04,250 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:19:04,250 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2231
2024-10-15 20:19:04,250 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0524
2024-10-15 20:19:04,250 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3193
2024-10-15 20:19:04,250 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7924
2024-10-15 20:19:04,251 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3193
2024-10-15 20:19:04,251 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3193
2024-10-15 20:19:04,251 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:19:04,251 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3380
2024-10-15 20:19:04,251 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0677
2024-10-15 20:19:04,257 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 20:19:04,257 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2120, bbox_mAP_50: 0.6860, bbox_mAP_75: 0.4120, bbox_mAP_s: 0.1360, bbox_mAP_m: 0.0630, bbox_mAP_l: 0.0200, bbox_mAP_copypaste: 0.212 0.686 0.412 0.136 0.063 0.020
2024-10-15 20:19:49,450 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:30:32, time: 0.904, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0676, stage0_bag_acc: 94.9658, stage0_mean_ious: 0.4836, stage0_s: 0.4181, stage0_m: 0.3955, stage0_l: 0.0131, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0213, stage1_bag_acc: 95.1658, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.6045, stage1_s: 0.5807, stage1_m: 0.3968, stage1_l: 0.0092, stage1_h: 0.0000, loss: 0.0951, grad_norm: 4.2659
2024-10-15 20:20:30,831 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:30:06, time: 0.828, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0963, stage0_bag_acc: 92.7587, stage0_mean_ious: 0.4710, stage0_s: 0.4507, stage0_m: 0.2750, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0217, stage1_bag_acc: 94.0643, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5950, stage1_s: 0.6026, stage1_m: 0.2809, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1238, grad_norm: 5.0734
2024-10-15 20:21:13,338 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:29:41, time: 0.850, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0687, stage0_bag_acc: 95.4333, stage0_mean_ious: 0.5061, stage0_s: 0.4553, stage0_m: 0.3959, stage0_l: 0.0172, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0175, stage1_bag_acc: 95.8611, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5976, stage1_s: 0.5729, stage1_m: 0.3818, stage1_l: 0.0123, stage1_h: 0.0000, loss: 0.0952, grad_norm: 5.2721
2024-10-15 20:21:57,651 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:29:19, time: 0.886, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0612, stage0_bag_acc: 95.2158, stage0_mean_ious: 0.5064, stage0_s: 0.4663, stage0_m: 0.3789, stage0_l: 0.0096, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0238, stage1_bag_acc: 95.4658, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.6145, stage1_s: 0.5983, stage1_m: 0.3952, stage1_l: 0.0078, stage1_h: 0.0000, loss: 0.0918, grad_norm: 5.1534
2024-10-15 20:22:38,952 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:28:48, time: 0.826, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1228, stage0_bag_acc: 91.3810, stage0_mean_ious: 0.4570, stage0_s: 0.4061, stage0_m: 0.3146, stage0_l: 0.0056, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0245, stage1_bag_acc: 92.7310, stage1_neg_loss: 0.0088, stage1_mean_ious: 0.5722, stage1_s: 0.5678, stage1_m: 0.3121, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.1561, grad_norm: 5.8127
2024-10-15 20:23:04,484 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 20:23:52,084 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:27:18, time: 0.907, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0504, stage0_bag_acc: 96.7778, stage0_mean_ious: 0.4858, stage0_s: 0.4249, stage0_m: 0.3598, stage0_l: 0.0210, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0177, stage1_bag_acc: 96.8921, stage1_neg_loss: 0.0086, stage1_mean_ious: 0.5902, stage1_s: 0.5627, stage1_m: 0.3641, stage1_l: 0.0199, stage1_h: 0.0000, loss: 0.0767, grad_norm: 4.7272
2024-10-15 20:24:33,936 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:26:48, time: 0.837, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0434, stage0_bag_acc: 96.4500, stage0_mean_ious: 0.4833, stage0_s: 0.4201, stage0_m: 0.3789, stage0_l: 0.0089, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 96.3500, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.6051, stage1_s: 0.5940, stage1_m: 0.3707, stage1_l: 0.0081, stage1_h: 0.0000, loss: 0.0695, grad_norm: 3.8228
2024-10-15 20:25:10,928 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:26:10, time: 0.740, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0644, stage0_bag_acc: 95.3500, stage0_mean_ious: 0.4828, stage0_s: 0.4410, stage0_m: 0.3307, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0176, stage1_bag_acc: 95.9682, stage1_neg_loss: 0.0105, stage1_mean_ious: 0.5855, stage1_s: 0.5781, stage1_m: 0.3362, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0926, grad_norm: 4.7098
2024-10-15 20:25:43,096 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:25:24, time: 0.643, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0816, stage0_bag_acc: 94.0476, stage0_mean_ious: 0.4915, stage0_s: 0.4634, stage0_m: 0.3240, stage0_l: 0.0315, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0249, stage1_bag_acc: 93.5476, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.5837, stage1_s: 0.5810, stage1_m: 0.3208, stage1_l: 0.0260, stage1_h: 0.0000, loss: 0.1139, grad_norm: 4.6144
2024-10-15 20:26:16,765 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:24:41, time: 0.673, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0708, stage0_bag_acc: 95.3634, stage0_mean_ious: 0.4637, stage0_s: 0.4122, stage0_m: 0.3627, stage0_l: 0.0094, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0252, stage1_bag_acc: 95.4452, stage1_neg_loss: 0.0101, stage1_mean_ious: 0.5679, stage1_s: 0.5483, stage1_m: 0.3915, stage1_l: 0.0118, stage1_h: 0.0000, loss: 0.1061, grad_norm: 5.8309
2024-10-15 20:26:37,131 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 20:27:17,846 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:23:14, time: 0.769, data_time: 0.056, memory: 7803, stage0_loss_instance_mil: 0.0452, stage0_bag_acc: 96.2864, stage0_mean_ious: 0.4899, stage0_s: 0.4549, stage0_m: 0.2603, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0142, stage1_bag_acc: 95.8976, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5924, stage1_s: 0.5805, stage1_m: 0.2578, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0637, grad_norm: 3.3325
2024-10-15 20:27:59,204 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:22:43, time: 0.827, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0479, stage0_bag_acc: 96.0460, stage0_mean_ious: 0.4898, stage0_s: 0.4445, stage0_m: 0.2838, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0130, stage1_bag_acc: 95.9404, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5902, stage1_s: 0.5677, stage1_m: 0.2898, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0642, grad_norm: 3.9821
2024-10-15 20:28:42,785 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:15, time: 0.871, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0442, stage0_bag_acc: 96.6810, stage0_mean_ious: 0.5038, stage0_s: 0.4538, stage0_m: 0.4651, stage0_l: 0.0379, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0172, stage1_bag_acc: 95.0754, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5808, stage1_s: 0.5656, stage1_m: 0.4480, stage1_l: 0.0316, stage1_h: 0.0000, loss: 0.0672, grad_norm: 3.8090
2024-10-15 20:29:22,201 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:21:41, time: 0.788, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0768, stage0_bag_acc: 94.4143, stage0_mean_ious: 0.4604, stage0_s: 0.4372, stage0_m: 0.3124, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0118, stage1_bag_acc: 95.5310, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5871, stage1_s: 0.5840, stage1_m: 0.3108, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0926, grad_norm: 4.3487
2024-10-15 20:30:02,767 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:07, time: 0.811, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0411, stage0_bag_acc: 96.7491, stage0_mean_ious: 0.5114, stage0_s: 0.4377, stage0_m: 0.3906, stage0_l: 0.0106, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0303, stage1_bag_acc: 96.6667, stage1_neg_loss: 0.0157, stage1_mean_ious: 0.5816, stage1_s: 0.5438, stage1_m: 0.3695, stage1_l: 0.0073, stage1_h: 0.0000, loss: 0.0872, grad_norm: 4.9021
2024-10-15 20:30:27,529 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 20:31:46,393 - mmdet - INFO - Evaluating bbox...
2024-10-15 20:31:46,884 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2254
2024-10-15 20:31:46,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6922
2024-10-15 20:31:46,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4347
2024-10-15 20:31:46,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1595
2024-10-15 20:31:46,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0796
2024-10-15 20:31:46,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0291
2024-10-15 20:31:46,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-15 20:31:46,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:31:46,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2371
2024-10-15 20:31:46,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0712
2024-10-15 20:31:46,886 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3309
2024-10-15 20:31:46,886 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7910
2024-10-15 20:31:46,886 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3309
2024-10-15 20:31:46,886 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3309
2024-10-15 20:31:46,886 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:31:46,886 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3509
2024-10-15 20:31:46,886 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0809
2024-10-15 20:31:46,891 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 20:31:46,892 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2250, bbox_mAP_50: 0.6920, bbox_mAP_75: 0.4350, bbox_mAP_s: 0.1600, bbox_mAP_m: 0.0800, bbox_mAP_l: 0.0290, bbox_mAP_copypaste: 0.225 0.692 0.435 0.160 0.080 0.029
2024-10-15 20:32:29,555 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:19:52, time: 0.853, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0614, stage0_bag_acc: 95.8864, stage0_mean_ious: 0.4815, stage0_s: 0.4443, stage0_m: 0.2704, stage0_l: 0.0121, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0133, stage1_bag_acc: 96.7000, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.5826, stage1_s: 0.5627, stage1_m: 0.2949, stage1_l: 0.0158, stage1_h: 0.0000, loss: 0.0814, grad_norm: 3.8525
2024-10-15 20:33:08,874 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:19:18, time: 0.786, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0353, stage0_bag_acc: 97.3269, stage0_mean_ious: 0.4892, stage0_s: 0.4533, stage0_m: 0.3312, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0160, stage1_bag_acc: 97.8348, stage1_neg_loss: 0.0069, stage1_mean_ious: 0.5939, stage1_s: 0.5775, stage1_m: 0.3273, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0581, grad_norm: 2.9899
2024-10-15 20:33:50,625 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:18:46, time: 0.835, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0432, stage0_bag_acc: 96.1714, stage0_mean_ious: 0.4989, stage0_s: 0.4718, stage0_m: 0.3783, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0172, stage1_bag_acc: 98.0976, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.6007, stage1_s: 0.5969, stage1_m: 0.3911, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0654, grad_norm: 3.5544
2024-10-15 20:34:32,838 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:13, time: 0.844, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0311, stage0_bag_acc: 97.8944, stage0_mean_ious: 0.5028, stage0_s: 0.4458, stage0_m: 0.3310, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0131, stage1_bag_acc: 97.8667, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.6031, stage1_s: 0.5559, stage1_m: 0.3601, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0516, grad_norm: 4.0328
2024-10-15 20:35:15,356 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:17:40, time: 0.850, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0331, stage0_bag_acc: 97.8119, stage0_mean_ious: 0.4927, stage0_s: 0.4395, stage0_m: 0.3452, stage0_l: 0.0137, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0101, stage1_bag_acc: 98.0119, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5962, stage1_s: 0.5805, stage1_m: 0.3281, stage1_l: 0.0131, stage1_h: 0.0000, loss: 0.0473, grad_norm: 2.7039
2024-10-15 20:35:40,118 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 20:36:28,075 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:31, time: 0.902, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.0569, stage0_bag_acc: 96.9452, stage0_mean_ious: 0.4921, stage0_s: 0.4439, stage0_m: 0.3404, stage0_l: 0.0227, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0181, stage1_bag_acc: 97.2452, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.5878, stage1_s: 0.5570, stage1_m: 0.3606, stage1_l: 0.0201, stage1_h: 0.0000, loss: 0.0824, grad_norm: 4.3735
2024-10-15 20:37:10,583 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:15:58, time: 0.850, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0318, stage0_bag_acc: 97.2944, stage0_mean_ious: 0.5162, stage0_s: 0.4604, stage0_m: 0.3757, stage0_l: 0.0126, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0203, stage1_bag_acc: 97.3333, stage1_neg_loss: 0.0167, stage1_mean_ious: 0.6024, stage1_s: 0.5892, stage1_m: 0.3582, stage1_l: 0.0138, stage1_h: 0.0000, loss: 0.0689, grad_norm: 4.8211
2024-10-15 20:37:51,526 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:24, time: 0.819, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0516, stage0_bag_acc: 96.4500, stage0_mean_ious: 0.4907, stage0_s: 0.4367, stage0_m: 0.2959, stage0_l: 0.0101, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0160, stage1_bag_acc: 95.9515, stage1_neg_loss: 0.0097, stage1_mean_ious: 0.5712, stage1_s: 0.5364, stage1_m: 0.2757, stage1_l: 0.0102, stage1_h: 0.0000, loss: 0.0773, grad_norm: 4.2881
2024-10-15 20:38:32,798 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:14:49, time: 0.826, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0447, stage0_bag_acc: 97.3333, stage0_mean_ious: 0.4733, stage0_s: 0.4252, stage0_m: 0.3395, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0103, stage1_bag_acc: 97.9833, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.5741, stage1_s: 0.5482, stage1_m: 0.3500, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0583, grad_norm: 3.1290
2024-10-15 20:39:14,496 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:15, time: 0.834, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0212, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.4913, stage0_s: 0.4615, stage0_m: 0.3222, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0123, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0116, stage1_mean_ious: 0.5733, stage1_s: 0.5605, stage1_m: 0.3137, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0451, grad_norm: 2.4698
2024-10-15 20:39:40,204 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 20:40:26,301 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:08, time: 0.878, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.0241, stage0_bag_acc: 98.0278, stage0_mean_ious: 0.5106, stage0_s: 0.4832, stage0_m: 0.3642, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 98.4778, stage1_neg_loss: 0.0104, stage1_mean_ious: 0.5891, stage1_s: 0.5837, stage1_m: 0.3613, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0433, grad_norm: 2.7444
2024-10-15 20:41:09,558 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:34, time: 0.865, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0114, stage0_bag_acc: 99.0500, stage0_mean_ious: 0.5007, stage0_s: 0.4132, stage0_m: 0.3617, stage0_l: 0.0091, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0081, stage1_bag_acc: 99.5000, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5961, stage1_s: 0.5469, stage1_m: 0.3584, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.0256, grad_norm: 2.1780
2024-10-15 20:41:51,656 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:11:59, time: 0.842, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0263, stage0_bag_acc: 98.1460, stage0_mean_ious: 0.4798, stage0_s: 0.4447, stage0_m: 0.3686, stage0_l: 0.0112, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0068, stage1_bag_acc: 98.1864, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5797, stage1_s: 0.5639, stage1_m: 0.3821, stage1_l: 0.0120, stage1_h: 0.0000, loss: 0.0370, grad_norm: 2.3275
2024-10-15 20:42:30,079 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:22, time: 0.768, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0132, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.5169, stage0_s: 0.4758, stage0_m: 0.4208, stage0_l: 0.0185, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 99.1182, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.6028, stage1_s: 0.6043, stage1_m: 0.4112, stage1_l: 0.0165, stage1_h: 0.0000, loss: 0.0253, grad_norm: 1.9911
2024-10-15 20:43:02,864 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:44, time: 0.656, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0231, stage0_bag_acc: 98.5667, stage0_mean_ious: 0.4852, stage0_s: 0.4557, stage0_m: 0.2994, stage0_l: 0.0102, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0103, stage1_bag_acc: 97.0000, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5931, stage1_s: 0.5884, stage1_m: 0.2847, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.0359, grad_norm: 2.4858
2024-10-15 20:43:23,399 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 20:44:41,144 - mmdet - INFO - Evaluating bbox...
2024-10-15 20:44:41,630 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2137
2024-10-15 20:44:41,630 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7098
2024-10-15 20:44:41,630 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4032
2024-10-15 20:44:41,630 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1365
2024-10-15 20:44:41,630 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0575
2024-10-15 20:44:41,630 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0177
2024-10-15 20:44:41,630 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-15 20:44:41,630 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:44:41,631 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2235
2024-10-15 20:44:41,631 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0756
2024-10-15 20:44:41,631 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3210
2024-10-15 20:44:41,631 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8080
2024-10-15 20:44:41,631 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3210
2024-10-15 20:44:41,631 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3210
2024-10-15 20:44:41,631 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:44:41,631 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3387
2024-10-15 20:44:41,631 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0925
2024-10-15 20:44:41,637 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 20:44:41,637 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2140, bbox_mAP_50: 0.7100, bbox_mAP_75: 0.4030, bbox_mAP_s: 0.1360, bbox_mAP_m: 0.0570, bbox_mAP_l: 0.0180, bbox_mAP_copypaste: 0.214 0.710 0.403 0.136 0.057 0.018
2024-10-15 20:45:27,428 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:40, time: 0.915, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0222, stage0_bag_acc: 98.0167, stage0_mean_ious: 0.5158, stage0_s: 0.4816, stage0_m: 0.4112, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.8167, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5997, stage1_s: 0.5949, stage1_m: 0.4199, stage1_l: 0.0044, stage1_h: 0.0000, loss: 0.0334, grad_norm: 2.3169
2024-10-15 20:46:09,139 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:05, time: 0.834, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0182, stage0_bag_acc: 98.8000, stage0_mean_ious: 0.4771, stage0_s: 0.4487, stage0_m: 0.3394, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0098, stage1_bag_acc: 98.5500, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5923, stage1_s: 0.5852, stage1_m: 0.3510, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0307, grad_norm: 2.0845
2024-10-15 20:46:51,656 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:30, time: 0.850, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0233, stage0_bag_acc: 98.1000, stage0_mean_ious: 0.5051, stage0_s: 0.4631, stage0_m: 0.3077, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0080, stage1_bag_acc: 97.5833, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5988, stage1_s: 0.5789, stage1_m: 0.3106, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0366, grad_norm: 2.3044
2024-10-15 20:47:34,548 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:54, time: 0.858, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0342, stage0_bag_acc: 97.9278, stage0_mean_ious: 0.4858, stage0_s: 0.4510, stage0_m: 0.2875, stage0_l: 0.0270, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0102, stage1_bag_acc: 98.1500, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5633, stage1_s: 0.5460, stage1_m: 0.2986, stage1_l: 0.0204, stage1_h: 0.0000, loss: 0.0470, grad_norm: 2.7968
2024-10-15 20:48:16,541 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:18, time: 0.840, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0080, stage0_bag_acc: 99.6667, stage0_mean_ious: 0.5144, stage0_s: 0.4652, stage0_m: 0.3896, stage0_l: 0.0168, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 99.2667, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5924, stage1_s: 0.5702, stage1_m: 0.3783, stage1_l: 0.0175, stage1_h: 0.0000, loss: 0.0192, grad_norm: 1.6367
2024-10-15 20:48:42,150 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 20:49:29,554 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:16, time: 0.903, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.0194, stage0_bag_acc: 98.1500, stage0_mean_ious: 0.4984, stage0_s: 0.4390, stage0_m: 0.3682, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0095, stage1_bag_acc: 98.1500, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.5893, stage1_s: 0.5580, stage1_m: 0.3676, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.0357, grad_norm: 2.5171
2024-10-15 20:50:11,558 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:40, time: 0.840, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0116, stage0_bag_acc: 99.3143, stage0_mean_ious: 0.5071, stage0_s: 0.4601, stage0_m: 0.3828, stage0_l: 0.0168, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 98.8643, stage1_neg_loss: 0.0013, stage1_mean_ious: 0.5864, stage1_s: 0.5708, stage1_m: 0.3711, stage1_l: 0.0160, stage1_h: 0.0000, loss: 0.0193, grad_norm: 1.4882
2024-10-15 20:50:52,139 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:03, time: 0.811, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0209, stage0_bag_acc: 98.3000, stage0_mean_ious: 0.4806, stage0_s: 0.4397, stage0_m: 0.3516, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0063, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.5845, stage1_s: 0.5658, stage1_m: 0.3510, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0295, grad_norm: 2.0127
2024-10-15 20:51:34,725 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 20:51:34,726 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:27, time: 0.852, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0113, stage0_bag_acc: 99.0500, stage0_mean_ious: 0.4850, stage0_s: 0.4347, stage0_m: 0.3266, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0065, stage1_bag_acc: 99.0500, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5908, stage1_s: 0.5613, stage1_m: 0.3401, stage1_l: 0.0110, stage1_h: 0.0000, loss: 0.0202, grad_norm: 1.6101
2024-10-15 20:52:16,254 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:50, time: 0.831, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0132, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.5094, stage0_s: 0.4777, stage0_m: 0.3525, stage0_l: 0.0169, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0084, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.6112, stage1_s: 0.6125, stage1_m: 0.3590, stage1_l: 0.0116, stage1_h: 0.0000, loss: 0.0266, grad_norm: 1.9163
2024-10-15 20:52:41,329 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 20:53:29,230 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:50, time: 0.913, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.0219, stage0_bag_acc: 98.5667, stage0_mean_ious: 0.4826, stage0_s: 0.4437, stage0_m: 0.3337, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.9000, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5902, stage1_s: 0.5678, stage1_m: 0.3546, stage1_l: 0.0075, stage1_h: 0.0000, loss: 0.0322, grad_norm: 2.1110
2024-10-15 20:54:11,616 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:13, time: 0.848, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0139, stage0_bag_acc: 99.0143, stage0_mean_ious: 0.4910, stage0_s: 0.4507, stage0_m: 0.3612, stage0_l: 0.0107, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 98.9000, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5984, stage1_s: 0.5919, stage1_m: 0.3516, stage1_l: 0.0055, stage1_h: 0.0000, loss: 0.0219, grad_norm: 1.6874
2024-10-15 20:54:54,904 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:36, time: 0.866, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0156, stage0_bag_acc: 98.8000, stage0_mean_ious: 0.5148, stage0_s: 0.4420, stage0_m: 0.4241, stage0_l: 0.0077, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.5500, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.6182, stage1_s: 0.5779, stage1_m: 0.4495, stage1_l: 0.0061, stage1_h: 0.0000, loss: 0.0247, grad_norm: 1.7564
2024-10-15 20:55:38,808 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.878, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0118, stage0_bag_acc: 99.1182, stage0_mean_ious: 0.5041, stage0_s: 0.4665, stage0_m: 0.3758, stage0_l: 0.0283, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0046, stage1_bag_acc: 99.1000, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5882, stage1_s: 0.5774, stage1_m: 0.3873, stage1_l: 0.0242, stage1_h: 0.0000, loss: 0.0181, grad_norm: 1.4490
2024-10-15 20:56:19,559 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:22, time: 0.815, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0165, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.5109, stage0_s: 0.4608, stage0_m: 0.2988, stage0_l: 0.0091, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0033, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.6039, stage1_s: 0.5797, stage1_m: 0.3117, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.0233, grad_norm: 1.6243
2024-10-15 20:56:45,592 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 20:58:04,066 - mmdet - INFO - Evaluating bbox...
2024-10-15 20:58:04,643 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2166
2024-10-15 20:58:04,644 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7138
2024-10-15 20:58:04,644 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4113
2024-10-15 20:58:04,644 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1417
2024-10-15 20:58:04,644 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0616
2024-10-15 20:58:04,644 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0185
2024-10-15 20:58:04,644 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-15 20:58:04,644 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:58:04,644 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2265
2024-10-15 20:58:04,644 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1020
2024-10-15 20:58:04,645 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3243
2024-10-15 20:58:04,645 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8124
2024-10-15 20:58:04,645 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3243
2024-10-15 20:58:04,645 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3243
2024-10-15 20:58:04,645 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:58:04,645 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3417
2024-10-15 20:58:04,645 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1132
2024-10-15 20:58:04,650 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 20:58:04,650 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2170, bbox_mAP_50: 0.7140, bbox_mAP_75: 0.4110, bbox_mAP_s: 0.1420, bbox_mAP_m: 0.0620, bbox_mAP_l: 0.0180, bbox_mAP_copypaste: 0.217 0.714 0.411 0.142 0.062 0.018
2024-10-15 20:59:23,117 - mmdet - INFO - Evaluating bbox...
2024-10-15 20:59:23,752 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2166
2024-10-15 20:59:23,752 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7138
2024-10-15 20:59:23,752 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4113
2024-10-15 20:59:23,752 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1417
2024-10-15 20:59:23,752 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0616
2024-10-15 20:59:23,753 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0185
2024-10-15 20:59:23,753 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-15 20:59:23,753 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:59:23,753 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2265
2024-10-15 20:59:23,753 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1020
2024-10-15 20:59:23,753 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3243
2024-10-15 20:59:23,754 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8124
2024-10-15 20:59:23,754 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3243
2024-10-15 20:59:23,754 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3243
2024-10-15 20:59:23,754 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 20:59:23,754 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3417
2024-10-15 20:59:23,754 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1132
2024-10-15 20:59:25,042 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 20:59:26,003 - mmdet - INFO - Distributed training: False
2024-10-15 20:59:26,916 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 20:59:27,939 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 20:59:27,939 - mmdet - INFO - Use load_from_local loader
2024-10-15 20:59:28,246 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 20:59:28,265 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 20:59:28,265 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 21:00:06,932 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:42:39, time: 0.773, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.7085, stage0_bag_acc: 18.9139, stage0_mean_ious: 0.0420, stage0_s: 0.0350, stage0_m: 0.0281, stage0_l: 0.0053, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1677, stage1_bag_acc: 18.5335, stage1_neg_loss: 0.0006, stage1_mean_ious: 0.0449, stage1_s: 0.0403, stage1_m: 0.0268, stage1_l: 0.0038, stage1_h: 0.0000, loss: 0.8768, grad_norm: 5.7866
2024-10-15 21:00:41,440 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:39:45, time: 0.690, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.6973, stage0_bag_acc: 17.7889, stage0_mean_ious: 0.0562, stage0_s: 0.0459, stage0_m: 0.0449, stage0_l: 0.0180, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1675, stage1_bag_acc: 18.9357, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.0543, stage1_s: 0.0445, stage1_m: 0.0462, stage1_l: 0.0120, stage1_h: 0.0000, loss: 0.8658, grad_norm: 5.7850
2024-10-15 21:01:15,381 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:38:12, time: 0.679, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.6852, stage0_bag_acc: 26.9278, stage0_mean_ious: 0.1093, stage0_s: 0.0958, stage0_m: 0.0875, stage0_l: 0.0156, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1609, stage1_bag_acc: 15.5611, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.1019, stage1_s: 0.0888, stage1_m: 0.0825, stage1_l: 0.0132, stage1_h: 0.0000, loss: 0.8496, grad_norm: 6.7882
2024-10-15 21:01:48,965 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:37:02, time: 0.672, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.6555, stage0_bag_acc: 29.1063, stage0_mean_ious: 0.1417, stage0_s: 0.1237, stage0_m: 0.1212, stage0_l: 0.0123, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1444, stage1_bag_acc: 28.1426, stage1_neg_loss: 0.0112, stage1_mean_ious: 0.1451, stage1_s: 0.1274, stage1_m: 0.1244, stage1_l: 0.0107, stage1_h: 0.0000, loss: 0.8111, grad_norm: 9.4409
2024-10-15 21:02:32,248 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:38:08, time: 0.866, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.5914, stage0_bag_acc: 31.5929, stage0_mean_ious: 0.1967, stage0_s: 0.1668, stage0_m: 0.1430, stage0_l: 0.0122, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1387, stage1_bag_acc: 38.9032, stage1_neg_loss: 0.0240, stage1_mean_ious: 0.2100, stage1_s: 0.1845, stage1_m: 0.1422, stage1_l: 0.0119, stage1_h: 0.0000, loss: 0.7542, grad_norm: 10.0064
2024-10-15 21:02:59,387 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 21:03:47,318 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:35:13, time: 0.924, data_time: 0.055, memory: 7803, stage0_loss_instance_mil: 0.5411, stage0_bag_acc: 43.8885, stage0_mean_ious: 0.2736, stage0_s: 0.2256, stage0_m: 0.2324, stage0_l: 0.0122, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0902, stage1_bag_acc: 43.1346, stage1_neg_loss: 0.0224, stage1_mean_ious: 0.3307, stage1_s: 0.2852, stage1_m: 0.2729, stage1_l: 0.0084, stage1_h: 0.0000, loss: 0.6538, grad_norm: 10.5675
2024-10-15 21:04:29,619 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:35:36, time: 0.846, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.4016, stage0_bag_acc: 64.4035, stage0_mean_ious: 0.3388, stage0_s: 0.2958, stage0_m: 0.2000, stage0_l: 0.0146, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0947, stage1_bag_acc: 61.2605, stage1_neg_loss: 0.0160, stage1_mean_ious: 0.4344, stage1_s: 0.3867, stage1_m: 0.2263, stage1_l: 0.0093, stage1_h: 0.0000, loss: 0.5123, grad_norm: 11.4388
2024-10-15 21:05:12,049 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:35:45, time: 0.849, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.2825, stage0_bag_acc: 78.1182, stage0_mean_ious: 0.4114, stage0_s: 0.3452, stage0_m: 0.3182, stage0_l: 0.0089, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0657, stage1_bag_acc: 80.5848, stage1_neg_loss: 0.0219, stage1_mean_ious: 0.4930, stage1_s: 0.4549, stage1_m: 0.3035, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.3700, grad_norm: 10.9121
2024-10-15 21:05:53,774 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:35:39, time: 0.834, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.2637, stage0_bag_acc: 79.6613, stage0_mean_ious: 0.4033, stage0_s: 0.3494, stage0_m: 0.2506, stage0_l: 0.0087, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0744, stage1_bag_acc: 77.0739, stage1_neg_loss: 0.0153, stage1_mean_ious: 0.4958, stage1_s: 0.4579, stage1_m: 0.2506, stage1_l: 0.0055, stage1_h: 0.0000, loss: 0.3534, grad_norm: 11.2433
2024-10-15 21:06:37,783 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:35:39, time: 0.880, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.2022, stage0_bag_acc: 85.5538, stage0_mean_ious: 0.4338, stage0_s: 0.4019, stage0_m: 0.3586, stage0_l: 0.0369, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0611, stage1_bag_acc: 84.9751, stage1_neg_loss: 0.0185, stage1_mean_ious: 0.5333, stage1_s: 0.5143, stage1_m: 0.3869, stage1_l: 0.0281, stage1_h: 0.0000, loss: 0.2818, grad_norm: 10.0678
2024-10-15 21:07:03,592 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 21:07:51,058 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:33:30, time: 0.905, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.1384, stage0_bag_acc: 88.5397, stage0_mean_ious: 0.4670, stage0_s: 0.3784, stage0_m: 0.4187, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0421, stage1_bag_acc: 88.9730, stage1_neg_loss: 0.0140, stage1_mean_ious: 0.5488, stage1_s: 0.5053, stage1_m: 0.4014, stage1_l: 0.0090, stage1_h: 0.0000, loss: 0.1945, grad_norm: 7.1120
2024-10-15 21:08:34,040 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:33:20, time: 0.860, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0880, stage0_bag_acc: 93.8500, stage0_mean_ious: 0.4684, stage0_s: 0.4177, stage0_m: 0.3204, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0431, stage1_bag_acc: 93.0143, stage1_neg_loss: 0.0186, stage1_mean_ious: 0.5766, stage1_s: 0.5466, stage1_m: 0.3398, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1497, grad_norm: 6.2215
2024-10-15 21:09:15,611 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:32:59, time: 0.831, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.1115, stage0_bag_acc: 91.3595, stage0_mean_ious: 0.4839, stage0_s: 0.4330, stage0_m: 0.4335, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0359, stage1_bag_acc: 92.0294, stage1_neg_loss: 0.0170, stage1_mean_ious: 0.5826, stage1_s: 0.5797, stage1_m: 0.4200, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1644, grad_norm: 7.3256
2024-10-15 21:09:58,456 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:32:41, time: 0.857, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0933, stage0_bag_acc: 90.8119, stage0_mean_ious: 0.4635, stage0_s: 0.4448, stage0_m: 0.2763, stage0_l: 0.0086, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0320, stage1_bag_acc: 93.1286, stage1_neg_loss: 0.0100, stage1_mean_ious: 0.5745, stage1_s: 0.5784, stage1_m: 0.2864, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.1353, grad_norm: 6.3379
2024-10-15 21:10:40,189 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:32:16, time: 0.835, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.1070, stage0_bag_acc: 92.2071, stage0_mean_ious: 0.4509, stage0_s: 0.4007, stage0_m: 0.2886, stage0_l: 0.0146, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0479, stage1_bag_acc: 91.0214, stage1_neg_loss: 0.0144, stage1_mean_ious: 0.5517, stage1_s: 0.5250, stage1_m: 0.2791, stage1_l: 0.0122, stage1_h: 0.0000, loss: 0.1694, grad_norm: 8.1842
2024-10-15 21:11:06,471 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 21:12:24,325 - mmdet - INFO - Evaluating bbox...
2024-10-15 21:12:24,805 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1996
2024-10-15 21:12:24,805 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6467
2024-10-15 21:12:24,805 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3786
2024-10-15 21:12:24,805 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1300
2024-10-15 21:12:24,805 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0629
2024-10-15 21:12:24,805 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0237
2024-10-15 21:12:24,805 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0003
2024-10-15 21:12:24,805 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 21:12:24,806 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2099
2024-10-15 21:12:24,806 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0438
2024-10-15 21:12:24,806 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3010
2024-10-15 21:12:24,806 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7556
2024-10-15 21:12:24,806 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3010
2024-10-15 21:12:24,806 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3010
2024-10-15 21:12:24,806 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 21:12:24,806 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3193
2024-10-15 21:12:24,806 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0631
2024-10-15 21:12:24,812 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 21:12:24,812 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2000, bbox_mAP_50: 0.6470, bbox_mAP_75: 0.3790, bbox_mAP_s: 0.1300, bbox_mAP_m: 0.0630, bbox_mAP_l: 0.0240, bbox_mAP_copypaste: 0.200 0.647 0.379 0.130 0.063 0.024
2024-10-15 21:13:09,800 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:30:31, time: 0.900, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0802, stage0_bag_acc: 93.4885, stage0_mean_ious: 0.4487, stage0_s: 0.4047, stage0_m: 0.3462, stage0_l: 0.0462, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0314, stage1_bag_acc: 95.1840, stage1_neg_loss: 0.0164, stage1_mean_ious: 0.5383, stage1_s: 0.5414, stage1_m: 0.3615, stage1_l: 0.0349, stage1_h: 0.0000, loss: 0.1280, grad_norm: 6.3280
2024-10-15 21:13:50,967 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:30:05, time: 0.823, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0692, stage0_bag_acc: 94.6730, stage0_mean_ious: 0.4643, stage0_s: 0.4103, stage0_m: 0.2735, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0227, stage1_bag_acc: 94.9952, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5715, stage1_s: 0.5497, stage1_m: 0.2696, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0980, grad_norm: 4.0986
2024-10-15 21:14:33,116 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:29:39, time: 0.843, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0436, stage0_bag_acc: 96.9643, stage0_mean_ious: 0.5016, stage0_s: 0.4459, stage0_m: 0.3561, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0164, stage1_bag_acc: 96.0286, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5961, stage1_s: 0.5692, stage1_m: 0.3646, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0690, grad_norm: 4.2721
2024-10-15 21:15:13,245 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:29:07, time: 0.803, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0788, stage0_bag_acc: 93.1288, stage0_mean_ious: 0.4706, stage0_s: 0.4267, stage0_m: 0.3269, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0268, stage1_bag_acc: 94.8758, stage1_neg_loss: 0.0117, stage1_mean_ious: 0.5708, stage1_s: 0.5434, stage1_m: 0.3367, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1173, grad_norm: 5.8860
2024-10-15 21:15:54,861 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:28:38, time: 0.832, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0816, stage0_bag_acc: 93.6404, stage0_mean_ious: 0.4996, stage0_s: 0.4526, stage0_m: 0.3520, stage0_l: 0.0104, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0265, stage1_bag_acc: 93.6404, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.5982, stage1_s: 0.5786, stage1_m: 0.3647, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.1164, grad_norm: 5.6344
2024-10-15 21:16:19,300 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 21:17:02,722 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:27:01, time: 0.824, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0891, stage0_bag_acc: 93.7619, stage0_mean_ious: 0.4776, stage0_s: 0.4155, stage0_m: 0.2853, stage0_l: 0.0089, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0175, stage1_bag_acc: 93.9286, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5659, stage1_s: 0.5379, stage1_m: 0.2841, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.1119, grad_norm: 5.6128
2024-10-15 21:17:35,608 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:26:17, time: 0.658, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0566, stage0_bag_acc: 94.8086, stage0_mean_ious: 0.4911, stage0_s: 0.4574, stage0_m: 0.2882, stage0_l: 0.0192, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0199, stage1_bag_acc: 95.0737, stage1_neg_loss: 0.0076, stage1_mean_ious: 0.5788, stage1_s: 0.5698, stage1_m: 0.2890, stage1_l: 0.0162, stage1_h: 0.0000, loss: 0.0841, grad_norm: 4.3111
2024-10-15 21:18:07,869 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:25:32, time: 0.645, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0508, stage0_bag_acc: 96.8833, stage0_mean_ious: 0.4794, stage0_s: 0.4402, stage0_m: 0.3461, stage0_l: 0.0108, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0185, stage1_bag_acc: 96.6111, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5704, stage1_s: 0.5682, stage1_m: 0.3344, stage1_l: 0.0086, stage1_h: 0.0000, loss: 0.0755, grad_norm: 4.4388
2024-10-15 21:18:41,820 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:24:51, time: 0.679, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0539, stage0_bag_acc: 95.4452, stage0_mean_ious: 0.4813, stage0_s: 0.4233, stage0_m: 0.3572, stage0_l: 0.0067, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0184, stage1_bag_acc: 96.1095, stage1_neg_loss: 0.0095, stage1_mean_ious: 0.5908, stage1_s: 0.5638, stage1_m: 0.3508, stage1_l: 0.0069, stage1_h: 0.0000, loss: 0.0818, grad_norm: 4.5843
2024-10-15 21:19:18,534 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:24:15, time: 0.734, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0425, stage0_bag_acc: 97.2262, stage0_mean_ious: 0.4952, stage0_s: 0.4434, stage0_m: 0.3317, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0147, stage1_bag_acc: 98.1595, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5800, stage1_s: 0.5798, stage1_m: 0.3001, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0626, grad_norm: 3.1625
2024-10-15 21:19:43,927 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 21:20:30,540 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:22:58, time: 0.888, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0292, stage0_bag_acc: 97.6545, stage0_mean_ious: 0.4938, stage0_s: 0.4506, stage0_m: 0.3329, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0113, stage1_bag_acc: 97.5864, stage1_neg_loss: 0.0065, stage1_mean_ious: 0.5759, stage1_s: 0.5694, stage1_m: 0.3212, stage1_l: 0.0158, stage1_h: 0.0000, loss: 0.0470, grad_norm: 3.1248
2024-10-15 21:21:13,386 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:22:30, time: 0.857, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0239, stage0_bag_acc: 98.4056, stage0_mean_ious: 0.4899, stage0_s: 0.4513, stage0_m: 0.3106, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0165, stage1_bag_acc: 98.8778, stage1_neg_loss: 0.0099, stage1_mean_ious: 0.5971, stage1_s: 0.5835, stage1_m: 0.3075, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0503, grad_norm: 3.2845
2024-10-15 21:21:57,633 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:03, time: 0.885, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0427, stage0_bag_acc: 96.3333, stage0_mean_ious: 0.5123, stage0_s: 0.4685, stage0_m: 0.3857, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0140, stage1_bag_acc: 97.6167, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.6106, stage1_s: 0.6037, stage1_m: 0.3884, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.0630, grad_norm: 3.5530
2024-10-15 21:22:40,963 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:21:34, time: 0.867, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0490, stage0_bag_acc: 96.9409, stage0_mean_ious: 0.4789, stage0_s: 0.4401, stage0_m: 0.3359, stage0_l: 0.0367, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0141, stage1_bag_acc: 97.8227, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5712, stage1_s: 0.5726, stage1_m: 0.3225, stage1_l: 0.0333, stage1_h: 0.0000, loss: 0.0690, grad_norm: 3.6027
2024-10-15 21:23:21,659 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:01, time: 0.814, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0580, stage0_bag_acc: 95.1141, stage0_mean_ious: 0.4943, stage0_s: 0.4520, stage0_m: 0.2494, stage0_l: 0.0113, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0185, stage1_bag_acc: 95.4641, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5880, stage1_s: 0.5730, stage1_m: 0.2483, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0808, grad_norm: 4.2621
2024-10-15 21:23:48,067 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 21:25:07,564 - mmdet - INFO - Evaluating bbox...
2024-10-15 21:25:08,147 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2013
2024-10-15 21:25:08,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6606
2024-10-15 21:25:08,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3700
2024-10-15 21:25:08,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1350
2024-10-15 21:25:08,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0613
2024-10-15 21:25:08,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0238
2024-10-15 21:25:08,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0008
2024-10-15 21:25:08,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 21:25:08,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2104
2024-10-15 21:25:08,149 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0532
2024-10-15 21:25:08,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3070
2024-10-15 21:25:08,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7707
2024-10-15 21:25:08,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3070
2024-10-15 21:25:08,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3070
2024-10-15 21:25:08,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 21:25:08,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3243
2024-10-15 21:25:08,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0748
2024-10-15 21:25:08,156 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 21:25:08,156 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2010, bbox_mAP_50: 0.6610, bbox_mAP_75: 0.3700, bbox_mAP_s: 0.1350, bbox_mAP_m: 0.0610, bbox_mAP_l: 0.0240, bbox_mAP_copypaste: 0.201 0.661 0.370 0.135 0.061 0.024
2024-10-15 21:25:52,989 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:19:49, time: 0.896, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0302, stage0_bag_acc: 97.4000, stage0_mean_ious: 0.4902, stage0_s: 0.4365, stage0_m: 0.3553, stage0_l: 0.0070, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0145, stage1_bag_acc: 97.2556, stage1_neg_loss: 0.0071, stage1_mean_ious: 0.5742, stage1_s: 0.5619, stage1_m: 0.3300, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.0518, grad_norm: 3.8401
2024-10-15 21:26:36,441 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:19:19, time: 0.869, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0406, stage0_bag_acc: 97.0286, stage0_mean_ious: 0.4963, stage0_s: 0.4532, stage0_m: 0.3450, stage0_l: 0.0115, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0157, stage1_bag_acc: 97.6786, stage1_neg_loss: 0.0105, stage1_mean_ious: 0.5950, stage1_s: 0.5907, stage1_m: 0.3276, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.0668, grad_norm: 4.5237
2024-10-15 21:27:19,387 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:18:47, time: 0.859, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0418, stage0_bag_acc: 96.6848, stage0_mean_ious: 0.4687, stage0_s: 0.4291, stage0_m: 0.2683, stage0_l: 0.0075, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0164, stage1_bag_acc: 97.1848, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5923, stage1_s: 0.5774, stage1_m: 0.2841, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.0643, grad_norm: 3.9028
2024-10-15 21:28:02,310 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:15, time: 0.858, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0237, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.5050, stage0_s: 0.4488, stage0_m: 0.4088, stage0_l: 0.0237, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0095, stage1_bag_acc: 98.4167, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5744, stage1_s: 0.5631, stage1_m: 0.3853, stage1_l: 0.0177, stage1_h: 0.0000, loss: 0.0370, grad_norm: 2.5133
2024-10-15 21:28:44,373 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:17:42, time: 0.841, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0349, stage0_bag_acc: 97.7198, stage0_mean_ious: 0.4977, stage0_s: 0.4648, stage0_m: 0.3041, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0115, stage1_bag_acc: 97.4563, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.6087, stage1_s: 0.6080, stage1_m: 0.2971, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0507, grad_norm: 3.0346
2024-10-15 21:29:08,892 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 21:29:55,211 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:32, time: 0.882, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0418, stage0_bag_acc: 97.2333, stage0_mean_ious: 0.5169, stage0_s: 0.4928, stage0_m: 0.3617, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0097, stage1_bag_acc: 97.6167, stage1_neg_loss: 0.0045, stage1_mean_ious: 0.5950, stage1_s: 0.5936, stage1_m: 0.3499, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0560, grad_norm: 4.4971
2024-10-15 21:30:36,091 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:15:58, time: 0.818, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0390, stage0_bag_acc: 97.6325, stage0_mean_ious: 0.4858, stage0_s: 0.4523, stage0_m: 0.3467, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0160, stage1_bag_acc: 97.2143, stage1_neg_loss: 0.0107, stage1_mean_ious: 0.5881, stage1_s: 0.5798, stage1_m: 0.3353, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0657, grad_norm: 4.4149
2024-10-15 21:31:16,622 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:23, time: 0.811, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0495, stage0_bag_acc: 96.3753, stage0_mean_ious: 0.5059, stage0_s: 0.4812, stage0_m: 0.2891, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0193, stage1_bag_acc: 96.7435, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5855, stage1_s: 0.5859, stage1_m: 0.2737, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0734, grad_norm: 4.5746
2024-10-15 21:31:58,441 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:14:49, time: 0.836, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0678, stage0_bag_acc: 94.2040, stage0_mean_ious: 0.4787, stage0_s: 0.4453, stage0_m: 0.3030, stage0_l: 0.0069, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0132, stage1_bag_acc: 95.0833, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5684, stage1_s: 0.5602, stage1_m: 0.2981, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.0863, grad_norm: 4.8810
2024-10-15 21:32:41,206 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:15, time: 0.855, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0512, stage0_bag_acc: 96.8848, stage0_mean_ious: 0.4736, stage0_s: 0.4156, stage0_m: 0.3146, stage0_l: 0.0148, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0180, stage1_bag_acc: 97.0333, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.5642, stage1_s: 0.5468, stage1_m: 0.2927, stage1_l: 0.0115, stage1_h: 0.0000, loss: 0.0766, grad_norm: 3.2664
2024-10-15 21:33:05,916 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 21:33:55,288 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:10, time: 0.938, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0188, stage0_bag_acc: 98.9667, stage0_mean_ious: 0.5005, stage0_s: 0.4602, stage0_m: 0.3613, stage0_l: 0.0185, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0079, stage1_bag_acc: 98.4667, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5666, stage1_s: 0.5710, stage1_m: 0.3210, stage1_l: 0.0159, stage1_h: 0.0000, loss: 0.0321, grad_norm: 2.7903
2024-10-15 21:34:28,059 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:31, time: 0.655, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0334, stage0_bag_acc: 98.3500, stage0_mean_ious: 0.4641, stage0_s: 0.4388, stage0_m: 0.2717, stage0_l: 0.0108, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0167, stage1_bag_acc: 98.0643, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5660, stage1_s: 0.5739, stage1_m: 0.2584, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.0553, grad_norm: 2.9734
2024-10-15 21:35:01,282 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:11:53, time: 0.665, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0198, stage0_bag_acc: 98.4778, stage0_mean_ious: 0.4944, stage0_s: 0.4622, stage0_m: 0.3025, stage0_l: 0.0315, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.8778, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5892, stage1_s: 0.5920, stage1_m: 0.3062, stage1_l: 0.0208, stage1_h: 0.0000, loss: 0.0306, grad_norm: 2.1065
2024-10-15 21:35:35,420 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:15, time: 0.683, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0227, stage0_bag_acc: 98.3500, stage0_mean_ious: 0.4828, stage0_s: 0.4359, stage0_m: 0.3488, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0127, stage1_bag_acc: 97.9667, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5623, stage1_s: 0.5530, stage1_m: 0.3368, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0386, grad_norm: 2.4235
2024-10-15 21:36:07,031 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:36, time: 0.632, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0376, stage0_bag_acc: 96.5182, stage0_mean_ious: 0.4709, stage0_s: 0.4208, stage0_m: 0.3105, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0118, stage1_bag_acc: 97.2182, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.5615, stage1_s: 0.5480, stage1_m: 0.2802, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0580, grad_norm: 3.4578
2024-10-15 21:36:32,937 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 21:37:51,358 - mmdet - INFO - Evaluating bbox...
2024-10-15 21:37:51,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1927
2024-10-15 21:37:51,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6471
2024-10-15 21:37:51,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3454
2024-10-15 21:37:51,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1222
2024-10-15 21:37:51,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0572
2024-10-15 21:37:51,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0232
2024-10-15 21:37:51,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0012
2024-10-15 21:37:51,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 21:37:51,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2004
2024-10-15 21:37:51,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0573
2024-10-15 21:37:51,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2993
2024-10-15 21:37:51,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7644
2024-10-15 21:37:51,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2993
2024-10-15 21:37:51,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2993
2024-10-15 21:37:51,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 21:37:51,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3140
2024-10-15 21:37:51,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0732
2024-10-15 21:37:51,844 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 21:37:51,844 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.1930, bbox_mAP_50: 0.6470, bbox_mAP_75: 0.3450, bbox_mAP_s: 0.1220, bbox_mAP_m: 0.0570, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.193 0.647 0.345 0.122 0.057 0.023
2024-10-15 21:38:36,535 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:33, time: 0.894, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0195, stage0_bag_acc: 98.3556, stage0_mean_ious: 0.5028, stage0_s: 0.4802, stage0_m: 0.3680, stage0_l: 0.0259, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0080, stage1_bag_acc: 98.1111, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5815, stage1_s: 0.5860, stage1_m: 0.3441, stage1_l: 0.0205, stage1_h: 0.0000, loss: 0.0330, grad_norm: 2.3408
2024-10-15 21:39:19,798 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:08:59, time: 0.865, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0241, stage0_bag_acc: 98.2254, stage0_mean_ious: 0.4982, stage0_s: 0.4544, stage0_m: 0.3406, stage0_l: 0.0199, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0108, stage1_bag_acc: 98.5111, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5669, stage1_s: 0.5745, stage1_m: 0.3012, stage1_l: 0.0170, stage1_h: 0.0000, loss: 0.0369, grad_norm: 2.1841
2024-10-15 21:40:02,278 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:24, time: 0.850, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0159, stage0_bag_acc: 98.7444, stage0_mean_ious: 0.4726, stage0_s: 0.4499, stage0_m: 0.2359, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.4587, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5803, stage1_s: 0.5814, stage1_m: 0.2371, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0272, grad_norm: 1.7439
2024-10-15 21:40:45,352 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:49, time: 0.861, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0297, stage0_bag_acc: 98.0500, stage0_mean_ious: 0.5024, stage0_s: 0.4492, stage0_m: 0.3976, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0063, stage1_bag_acc: 98.3500, stage1_neg_loss: 0.0069, stage1_mean_ious: 0.5791, stage1_s: 0.5584, stage1_m: 0.3879, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0428, grad_norm: 2.6860
2024-10-15 21:41:26,925 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:14, time: 0.832, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0262, stage0_bag_acc: 97.7833, stage0_mean_ious: 0.4734, stage0_s: 0.4542, stage0_m: 0.3505, stage0_l: 0.0073, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 98.2500, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5732, stage1_s: 0.5835, stage1_m: 0.3371, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.0428, grad_norm: 2.7464
2024-10-15 21:41:52,686 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 21:42:41,877 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:13, time: 0.940, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0226, stage0_bag_acc: 98.1030, stage0_mean_ious: 0.4913, stage0_s: 0.4594, stage0_m: 0.3899, stage0_l: 0.0070, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0058, stage1_bag_acc: 98.3348, stage1_neg_loss: 0.0077, stage1_mean_ious: 0.5727, stage1_s: 0.5739, stage1_m: 0.3606, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.0360, grad_norm: 2.5754
2024-10-15 21:43:23,949 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:37, time: 0.841, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0219, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.4779, stage0_s: 0.4454, stage0_m: 0.3232, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0084, stage1_bag_acc: 98.0167, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.5719, stage1_s: 0.5720, stage1_m: 0.3331, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0320, grad_norm: 2.3382
2024-10-15 21:44:05,164 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:01, time: 0.824, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0244, stage0_bag_acc: 98.4167, stage0_mean_ious: 0.4979, stage0_s: 0.4620, stage0_m: 0.3932, stage0_l: 0.0258, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0079, stage1_bag_acc: 97.9667, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5623, stage1_s: 0.5630, stage1_m: 0.3881, stage1_l: 0.0226, stage1_h: 0.0000, loss: 0.0347, grad_norm: 2.4168
2024-10-15 21:44:46,497 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 21:44:46,497 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:25, time: 0.827, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0203, stage0_bag_acc: 98.6682, stage0_mean_ious: 0.4822, stage0_s: 0.4442, stage0_m: 0.2976, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0092, stage1_bag_acc: 97.9173, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5861, stage1_s: 0.5772, stage1_m: 0.3193, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0315, grad_norm: 2.0646
2024-10-15 21:45:29,315 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:48, time: 0.856, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0092, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.4965, stage0_s: 0.4561, stage0_m: 0.3381, stage0_l: 0.0502, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0049, stage1_bag_acc: 99.6000, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5706, stage1_s: 0.5685, stage1_m: 0.3379, stage1_l: 0.0464, stage1_h: 0.0000, loss: 0.0189, grad_norm: 1.6531
2024-10-15 21:45:54,657 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 21:46:43,054 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:48, time: 0.924, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0133, stage0_bag_acc: 98.8602, stage0_mean_ious: 0.5059, stage0_s: 0.4709, stage0_m: 0.3732, stage0_l: 0.0138, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 98.9641, stage1_neg_loss: 0.0014, stage1_mean_ious: 0.5794, stage1_s: 0.5868, stage1_m: 0.3340, stage1_l: 0.0130, stage1_h: 0.0000, loss: 0.0224, grad_norm: 1.5244
2024-10-15 21:47:25,815 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:12, time: 0.855, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0152, stage0_bag_acc: 99.0667, stage0_mean_ious: 0.4910, stage0_s: 0.4334, stage0_m: 0.3575, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.8167, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5619, stage1_s: 0.5597, stage1_m: 0.3256, stage1_l: 0.0043, stage1_h: 0.0000, loss: 0.0246, grad_norm: 1.7447
2024-10-15 21:48:10,488 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:36, time: 0.893, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0217, stage0_bag_acc: 98.7000, stage0_mean_ious: 0.5012, stage0_s: 0.4674, stage0_m: 0.4113, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0081, stage1_bag_acc: 98.6500, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5911, stage1_s: 0.5866, stage1_m: 0.3947, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0323, grad_norm: 2.0344
2024-10-15 21:48:54,427 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.879, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0196, stage0_bag_acc: 98.7667, stage0_mean_ious: 0.4701, stage0_s: 0.4335, stage0_m: 0.3481, stage0_l: 0.0393, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.3833, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5620, stage1_s: 0.5566, stage1_m: 0.3304, stage1_l: 0.0293, stage1_h: 0.0000, loss: 0.0296, grad_norm: 2.2047
2024-10-15 21:49:37,016 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:22, time: 0.852, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0217, stage0_bag_acc: 98.3167, stage0_mean_ious: 0.4911, stage0_s: 0.4503, stage0_m: 0.3482, stage0_l: 0.0077, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0070, stage1_bag_acc: 98.5667, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5653, stage1_s: 0.5507, stage1_m: 0.3293, stage1_l: 0.0047, stage1_h: 0.0000, loss: 0.0339, grad_norm: 2.3542
2024-10-15 21:50:02,486 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 21:51:20,409 - mmdet - INFO - Evaluating bbox...
2024-10-15 21:51:20,967 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1945
2024-10-15 21:51:20,967 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6488
2024-10-15 21:51:20,967 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3485
2024-10-15 21:51:20,967 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1259
2024-10-15 21:51:20,967 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0602
2024-10-15 21:51:20,967 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0230
2024-10-15 21:51:20,967 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0011
2024-10-15 21:51:20,968 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 21:51:20,968 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2020
2024-10-15 21:51:20,968 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0610
2024-10-15 21:51:20,968 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2986
2024-10-15 21:51:20,968 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7659
2024-10-15 21:51:20,968 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2986
2024-10-15 21:51:20,968 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2986
2024-10-15 21:51:20,968 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 21:51:20,968 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3131
2024-10-15 21:51:20,968 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0777
2024-10-15 21:51:20,974 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 21:51:20,974 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.1940, bbox_mAP_50: 0.6490, bbox_mAP_75: 0.3480, bbox_mAP_s: 0.1260, bbox_mAP_m: 0.0600, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.194 0.649 0.348 0.126 0.060 0.023
2024-10-15 21:52:36,804 - mmdet - INFO - Evaluating bbox...
2024-10-15 21:52:37,290 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1945
2024-10-15 21:52:37,290 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6488
2024-10-15 21:52:37,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3485
2024-10-15 21:52:37,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1259
2024-10-15 21:52:37,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0602
2024-10-15 21:52:37,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0230
2024-10-15 21:52:37,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0011
2024-10-15 21:52:37,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 21:52:37,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2020
2024-10-15 21:52:37,292 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0610
2024-10-15 21:52:37,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2986
2024-10-15 21:52:37,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7659
2024-10-15 21:52:37,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2986
2024-10-15 21:52:37,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2986
2024-10-15 21:52:37,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 21:52:37,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3131
2024-10-15 21:52:37,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0777
2024-10-15 21:52:38,560 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 21:52:39,432 - mmdet - INFO - Distributed training: False
2024-10-15 21:52:40,345 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 21:52:41,384 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 21:52:41,384 - mmdet - INFO - Use load_from_local loader
2024-10-15 21:52:41,666 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 21:52:41,683 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 21:52:41,684 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 21:53:17,364 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:39:21, time: 0.714, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.7256, stage0_bag_acc: 17.6548, stage0_mean_ious: 0.0526, stage0_s: 0.0595, stage0_m: 0.0399, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1634, stage1_bag_acc: 13.2167, stage1_neg_loss: 0.0006, stage1_mean_ious: 0.0570, stage1_s: 0.0637, stage1_m: 0.0446, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8895, grad_norm: 5.6781
2024-10-15 21:53:58,060 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:41:29, time: 0.814, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.7227, stage0_bag_acc: 16.0828, stage0_mean_ious: 0.0537, stage0_s: 0.0464, stage0_m: 0.0279, stage0_l: 0.0028, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1581, stage1_bag_acc: 18.9091, stage1_neg_loss: 0.0007, stage1_mean_ious: 0.0554, stage1_s: 0.0458, stage1_m: 0.0319, stage1_l: 0.0031, stage1_h: 0.0000, loss: 0.8815, grad_norm: 5.1919
2024-10-15 21:54:41,422 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:42:42, time: 0.867, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.6788, stage0_bag_acc: 31.9994, stage0_mean_ious: 0.1136, stage0_s: 0.0896, stage0_m: 0.0881, stage0_l: 0.0036, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1771, stage1_bag_acc: 11.5710, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.1254, stage1_s: 0.0993, stage1_m: 0.0969, stage1_l: 0.0043, stage1_h: 0.0000, loss: 0.8577, grad_norm: 6.0429
2024-10-15 21:55:24,474 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:42:51, time: 0.861, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.6480, stage0_bag_acc: 31.4738, stage0_mean_ious: 0.1201, stage0_s: 0.1029, stage0_m: 0.1088, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1543, stage1_bag_acc: 31.9603, stage1_neg_loss: 0.0139, stage1_mean_ious: 0.1342, stage1_s: 0.1145, stage1_m: 0.1322, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8162, grad_norm: 8.4313
2024-10-15 21:56:07,318 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:42:38, time: 0.857, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.5789, stage0_bag_acc: 31.2846, stage0_mean_ious: 0.1721, stage0_s: 0.1415, stage0_m: 0.1664, stage0_l: 0.0150, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1267, stage1_bag_acc: 32.5043, stage1_neg_loss: 0.0247, stage1_mean_ious: 0.2024, stage1_s: 0.1664, stage1_m: 0.1795, stage1_l: 0.0139, stage1_h: 0.0000, loss: 0.7303, grad_norm: 8.9984
2024-10-15 21:56:34,051 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 21:57:21,975 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:38:27, time: 0.914, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.5446, stage0_bag_acc: 40.3423, stage0_mean_ious: 0.2162, stage0_s: 0.1599, stage0_m: 0.1716, stage0_l: 0.0200, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1099, stage1_bag_acc: 46.3901, stage1_neg_loss: 0.0226, stage1_mean_ious: 0.2722, stage1_s: 0.2108, stage1_m: 0.2088, stage1_l: 0.0196, stage1_h: 0.0000, loss: 0.6771, grad_norm: 9.3627
2024-10-15 21:58:07,076 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:38:44, time: 0.902, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.4744, stage0_bag_acc: 52.5737, stage0_mean_ious: 0.2968, stage0_s: 0.2599, stage0_m: 0.1963, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0868, stage1_bag_acc: 45.9253, stage1_neg_loss: 0.0190, stage1_mean_ious: 0.3740, stage1_s: 0.3448, stage1_m: 0.2245, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5802, grad_norm: 11.4747
2024-10-15 21:58:49,553 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:38:29, time: 0.850, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.3158, stage0_bag_acc: 72.9343, stage0_mean_ious: 0.3765, stage0_s: 0.3393, stage0_m: 0.3037, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0766, stage1_bag_acc: 72.9298, stage1_neg_loss: 0.0181, stage1_mean_ious: 0.4771, stage1_s: 0.4432, stage1_m: 0.3418, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.4104, grad_norm: 11.1772
2024-10-15 21:59:32,284 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:38:09, time: 0.855, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.2658, stage0_bag_acc: 76.1180, stage0_mean_ious: 0.4209, stage0_s: 0.3612, stage0_m: 0.3276, stage0_l: 0.0218, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0699, stage1_bag_acc: 79.6356, stage1_neg_loss: 0.0209, stage1_mean_ious: 0.5138, stage1_s: 0.4780, stage1_m: 0.3491, stage1_l: 0.0119, stage1_h: 0.0000, loss: 0.3566, grad_norm: 11.9295
2024-10-15 22:00:15,372 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:37:47, time: 0.862, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.1974, stage0_bag_acc: 83.9032, stage0_mean_ious: 0.4476, stage0_s: 0.3898, stage0_m: 0.3657, stage0_l: 0.0394, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0576, stage1_bag_acc: 83.2491, stage1_neg_loss: 0.0190, stage1_mean_ious: 0.5276, stage1_s: 0.4913, stage1_m: 0.3802, stage1_l: 0.0258, stage1_h: 0.0000, loss: 0.2739, grad_norm: 9.0699
2024-10-15 22:00:38,480 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 22:01:25,594 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:35:17, time: 0.898, data_time: 0.056, memory: 7803, stage0_loss_instance_mil: 0.1728, stage0_bag_acc: 86.2722, stage0_mean_ious: 0.4374, stage0_s: 0.3948, stage0_m: 0.3227, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0525, stage1_bag_acc: 88.4000, stage1_neg_loss: 0.0171, stage1_mean_ious: 0.5354, stage1_s: 0.5051, stage1_m: 0.3392, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2425, grad_norm: 7.8202
2024-10-15 22:02:06,723 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:34:49, time: 0.823, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.1173, stage0_bag_acc: 90.8143, stage0_mean_ious: 0.4697, stage0_s: 0.4259, stage0_m: 0.2889, stage0_l: 0.0132, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0496, stage1_bag_acc: 92.0643, stage1_neg_loss: 0.0168, stage1_mean_ious: 0.5760, stage1_s: 0.5597, stage1_m: 0.2969, stage1_l: 0.0071, stage1_h: 0.0000, loss: 0.1836, grad_norm: 8.3293
2024-10-15 22:02:48,079 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:34:20, time: 0.827, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.1068, stage0_bag_acc: 91.4167, stage0_mean_ious: 0.4494, stage0_s: 0.4199, stage0_m: 0.3225, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0317, stage1_bag_acc: 92.2556, stage1_neg_loss: 0.0140, stage1_mean_ious: 0.5839, stage1_s: 0.5815, stage1_m: 0.3262, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1525, grad_norm: 6.5156
2024-10-15 22:03:31,536 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:33:57, time: 0.869, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0710, stage0_bag_acc: 94.7556, stage0_mean_ious: 0.4937, stage0_s: 0.4548, stage0_m: 0.3816, stage0_l: 0.0167, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0310, stage1_bag_acc: 94.1778, stage1_neg_loss: 0.0133, stage1_mean_ious: 0.5698, stage1_s: 0.5743, stage1_m: 0.3778, stage1_l: 0.0122, stage1_h: 0.0000, loss: 0.1153, grad_norm: 5.6881
2024-10-15 22:04:13,914 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:33:28, time: 0.847, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0924, stage0_bag_acc: 93.5452, stage0_mean_ious: 0.4694, stage0_s: 0.4397, stage0_m: 0.2858, stage0_l: 0.0105, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0295, stage1_bag_acc: 94.7452, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5827, stage1_s: 0.5787, stage1_m: 0.2879, stage1_l: 0.0077, stage1_h: 0.0000, loss: 0.1280, grad_norm: 5.8539
2024-10-15 22:04:38,818 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 22:05:56,924 - mmdet - INFO - Evaluating bbox...
2024-10-15 22:05:57,403 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1922
2024-10-15 22:05:57,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6357
2024-10-15 22:05:57,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3626
2024-10-15 22:05:57,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1213
2024-10-15 22:05:57,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0533
2024-10-15 22:05:57,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0161
2024-10-15 22:05:57,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0003
2024-10-15 22:05:57,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:05:57,404 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2028
2024-10-15 22:05:57,405 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0793
2024-10-15 22:05:57,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2936
2024-10-15 22:05:57,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7441
2024-10-15 22:05:57,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2936
2024-10-15 22:05:57,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2936
2024-10-15 22:05:57,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:05:57,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3124
2024-10-15 22:05:57,405 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0973
2024-10-15 22:05:57,411 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 22:05:57,411 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.1920, bbox_mAP_50: 0.6360, bbox_mAP_75: 0.3630, bbox_mAP_s: 0.1210, bbox_mAP_m: 0.0530, bbox_mAP_l: 0.0160, bbox_mAP_copypaste: 0.192 0.636 0.363 0.121 0.053 0.016
2024-10-15 22:06:44,295 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:31:40, time: 0.937, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0834, stage0_bag_acc: 93.3254, stage0_mean_ious: 0.4757, stage0_s: 0.4388, stage0_m: 0.3364, stage0_l: 0.0251, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0286, stage1_bag_acc: 93.5611, stage1_neg_loss: 0.0106, stage1_mean_ious: 0.5864, stage1_s: 0.5896, stage1_m: 0.3448, stage1_l: 0.0223, stage1_h: 0.0000, loss: 0.1227, grad_norm: 5.3285
2024-10-15 22:07:25,942 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:31:10, time: 0.833, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0878, stage0_bag_acc: 93.5737, stage0_mean_ious: 0.4746, stage0_s: 0.4441, stage0_m: 0.3569, stage0_l: 0.0129, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0272, stage1_bag_acc: 93.3737, stage1_neg_loss: 0.0113, stage1_mean_ious: 0.5747, stage1_s: 0.5922, stage1_m: 0.3304, stage1_l: 0.0107, stage1_h: 0.0000, loss: 0.1263, grad_norm: 5.4307
2024-10-15 22:08:08,880 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:30:41, time: 0.859, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0824, stage0_bag_acc: 93.4237, stage0_mean_ious: 0.4717, stage0_s: 0.4231, stage0_m: 0.3108, stage0_l: 0.0300, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0210, stage1_bag_acc: 93.0500, stage1_neg_loss: 0.0098, stage1_mean_ious: 0.5840, stage1_s: 0.5600, stage1_m: 0.3372, stage1_l: 0.0243, stage1_h: 0.0000, loss: 0.1131, grad_norm: 5.9472
2024-10-15 22:08:52,844 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:30:14, time: 0.879, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0574, stage0_bag_acc: 95.6667, stage0_mean_ious: 0.4691, stage0_s: 0.4170, stage0_m: 0.3370, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0221, stage1_bag_acc: 95.9667, stage1_neg_loss: 0.0087, stage1_mean_ious: 0.5672, stage1_s: 0.5439, stage1_m: 0.3414, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0882, grad_norm: 4.5294
2024-10-15 22:09:39,010 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:29:49, time: 0.923, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0878, stage0_bag_acc: 93.2619, stage0_mean_ious: 0.5044, stage0_s: 0.4546, stage0_m: 0.3949, stage0_l: 0.0326, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0220, stage1_bag_acc: 94.0158, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5777, stage1_s: 0.5741, stage1_m: 0.3826, stage1_l: 0.0270, stage1_h: 0.0000, loss: 0.1188, grad_norm: 5.9140
2024-10-15 22:10:03,893 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 22:10:52,600 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:28:15, time: 0.930, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.0483, stage0_bag_acc: 97.2143, stage0_mean_ious: 0.5333, stage0_s: 0.4412, stage0_m: 0.4327, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0234, stage1_bag_acc: 94.9429, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.6103, stage1_s: 0.5744, stage1_m: 0.3961, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0805, grad_norm: 4.3312
2024-10-15 22:11:39,155 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:27:50, time: 0.931, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0722, stage0_bag_acc: 94.8879, stage0_mean_ious: 0.4839, stage0_s: 0.4221, stage0_m: 0.3760, stage0_l: 0.0293, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0263, stage1_bag_acc: 94.7727, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5774, stage1_s: 0.5565, stage1_m: 0.3592, stage1_l: 0.0309, stage1_h: 0.0000, loss: 0.1058, grad_norm: 4.5770
2024-10-15 22:12:22,428 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:27:18, time: 0.865, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0425, stage0_bag_acc: 95.9944, stage0_mean_ious: 0.4858, stage0_s: 0.4181, stage0_m: 0.4194, stage0_l: 0.0202, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0162, stage1_bag_acc: 95.5944, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5956, stage1_s: 0.5649, stage1_m: 0.4201, stage1_l: 0.0218, stage1_h: 0.0000, loss: 0.0635, grad_norm: 3.4894
2024-10-15 22:13:05,885 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:26:46, time: 0.869, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0617, stage0_bag_acc: 95.8793, stage0_mean_ious: 0.4698, stage0_s: 0.4422, stage0_m: 0.3483, stage0_l: 0.0107, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0228, stage1_bag_acc: 95.3222, stage1_neg_loss: 0.0091, stage1_mean_ious: 0.5777, stage1_s: 0.5726, stage1_m: 0.3500, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.0936, grad_norm: 4.6118
2024-10-15 22:13:47,980 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:26:10, time: 0.842, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0311, stage0_bag_acc: 98.4348, stage0_mean_ious: 0.4948, stage0_s: 0.4607, stage0_m: 0.3004, stage0_l: 0.0093, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0125, stage1_bag_acc: 97.8030, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5903, stage1_s: 0.5907, stage1_m: 0.2675, stage1_l: 0.0055, stage1_h: 0.0000, loss: 0.0496, grad_norm: 3.0124
2024-10-15 22:14:13,550 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 22:14:58,898 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:24:41, time: 0.863, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0542, stage0_bag_acc: 95.7182, stage0_mean_ious: 0.5139, stage0_s: 0.4792, stage0_m: 0.3034, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0136, stage1_bag_acc: 96.4848, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5959, stage1_s: 0.5921, stage1_m: 0.2835, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0716, grad_norm: 3.8895
2024-10-15 22:15:42,546 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:24:08, time: 0.873, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0512, stage0_bag_acc: 96.1380, stage0_mean_ious: 0.4895, stage0_s: 0.4479, stage0_m: 0.3206, stage0_l: 0.0110, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0185, stage1_bag_acc: 96.1737, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5900, stage1_s: 0.5837, stage1_m: 0.2987, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0741, grad_norm: 3.8975
2024-10-15 22:16:23,602 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:23:32, time: 0.821, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0594, stage0_bag_acc: 96.7000, stage0_mean_ious: 0.4982, stage0_s: 0.4783, stage0_m: 0.3026, stage0_l: 0.0072, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0146, stage1_bag_acc: 95.5245, stage1_neg_loss: 0.0082, stage1_mean_ious: 0.5795, stage1_s: 0.5938, stage1_m: 0.2644, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.0822, grad_norm: 3.7992
2024-10-15 22:17:06,476 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:22:57, time: 0.857, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0379, stage0_bag_acc: 96.8110, stage0_mean_ious: 0.4734, stage0_s: 0.4109, stage0_m: 0.3036, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0138, stage1_bag_acc: 96.0753, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5790, stage1_s: 0.5516, stage1_m: 0.3026, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0586, grad_norm: 3.5626
2024-10-15 22:17:50,804 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:22:23, time: 0.887, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0706, stage0_bag_acc: 94.8000, stage0_mean_ious: 0.4643, stage0_s: 0.4272, stage0_m: 0.3097, stage0_l: 0.0279, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0224, stage1_bag_acc: 95.7143, stage1_neg_loss: 0.0095, stage1_mean_ious: 0.5761, stage1_s: 0.5762, stage1_m: 0.2913, stage1_l: 0.0171, stage1_h: 0.0000, loss: 0.1024, grad_norm: 4.8934
2024-10-15 22:18:16,727 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 22:19:35,067 - mmdet - INFO - Evaluating bbox...
2024-10-15 22:19:35,685 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1928
2024-10-15 22:19:35,685 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6483
2024-10-15 22:19:35,685 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3657
2024-10-15 22:19:35,685 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1103
2024-10-15 22:19:35,685 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0485
2024-10-15 22:19:35,685 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0156
2024-10-15 22:19:35,686 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 22:19:35,686 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:19:35,686 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2037
2024-10-15 22:19:35,686 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0681
2024-10-15 22:19:35,686 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2985
2024-10-15 22:19:35,686 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7690
2024-10-15 22:19:35,686 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2985
2024-10-15 22:19:35,686 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2985
2024-10-15 22:19:35,686 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:19:35,686 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3174
2024-10-15 22:19:35,686 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0830
2024-10-15 22:19:35,692 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 22:19:35,692 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.1930, bbox_mAP_50: 0.6480, bbox_mAP_75: 0.3660, bbox_mAP_s: 0.1100, bbox_mAP_m: 0.0490, bbox_mAP_l: 0.0160, bbox_mAP_copypaste: 0.193 0.648 0.366 0.110 0.049 0.016
2024-10-15 22:20:22,610 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:21:05, time: 0.938, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.0342, stage0_bag_acc: 97.5643, stage0_mean_ious: 0.5020, stage0_s: 0.4444, stage0_m: 0.3772, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0109, stage1_bag_acc: 97.7087, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5881, stage1_s: 0.5820, stage1_m: 0.3450, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.0499, grad_norm: 2.8921
2024-10-15 22:20:56,427 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:20:22, time: 0.676, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0509, stage0_bag_acc: 97.0682, stage0_mean_ious: 0.4539, stage0_s: 0.4070, stage0_m: 0.2768, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0205, stage1_bag_acc: 97.2460, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.5628, stage1_s: 0.5453, stage1_m: 0.2898, stage1_l: 0.0045, stage1_h: 0.0000, loss: 0.0780, grad_norm: 3.9223
2024-10-15 22:21:29,074 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:19:38, time: 0.653, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0311, stage0_bag_acc: 97.4682, stage0_mean_ious: 0.4664, stage0_s: 0.4226, stage0_m: 0.3242, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0110, stage1_bag_acc: 97.8500, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5809, stage1_s: 0.5622, stage1_m: 0.3340, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0459, grad_norm: 2.6982
2024-10-15 22:22:02,577 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:56, time: 0.670, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0359, stage0_bag_acc: 96.9333, stage0_mean_ious: 0.4980, stage0_s: 0.4483, stage0_m: 0.3702, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0113, stage1_bag_acc: 96.9167, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5797, stage1_s: 0.5633, stage1_m: 0.3683, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0506, grad_norm: 3.0486
2024-10-15 22:22:37,764 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:18:15, time: 0.704, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0407, stage0_bag_acc: 96.9667, stage0_mean_ious: 0.5088, stage0_s: 0.4507, stage0_m: 0.4116, stage0_l: 0.0305, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0098, stage1_bag_acc: 96.8167, stage1_neg_loss: 0.0119, stage1_mean_ious: 0.5963, stage1_s: 0.5766, stage1_m: 0.4003, stage1_l: 0.0270, stage1_h: 0.0000, loss: 0.0623, grad_norm: 4.2339
2024-10-15 22:22:58,661 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 22:23:38,553 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:58, time: 0.754, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0450, stage0_bag_acc: 97.3500, stage0_mean_ious: 0.4900, stage0_s: 0.4578, stage0_m: 0.2885, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0205, stage1_bag_acc: 96.6143, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.5857, stage1_s: 0.5901, stage1_m: 0.2804, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0738, grad_norm: 4.0196
2024-10-15 22:24:13,158 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:16:18, time: 0.692, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0360, stage0_bag_acc: 96.5000, stage0_mean_ious: 0.4806, stage0_s: 0.4111, stage0_m: 0.3878, stage0_l: 0.0114, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0133, stage1_bag_acc: 97.2833, stage1_neg_loss: 0.0099, stage1_mean_ious: 0.5807, stage1_s: 0.5383, stage1_m: 0.3992, stage1_l: 0.0135, stage1_h: 0.0000, loss: 0.0592, grad_norm: 3.8163
2024-10-15 22:24:54,539 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:43, time: 0.828, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0277, stage0_bag_acc: 97.5712, stage0_mean_ious: 0.4880, stage0_s: 0.4336, stage0_m: 0.3960, stage0_l: 0.0114, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 97.4015, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5756, stage1_s: 0.5642, stage1_m: 0.3595, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0434, grad_norm: 2.7910
2024-10-15 22:25:34,720 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:15:06, time: 0.804, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0732, stage0_bag_acc: 93.7015, stage0_mean_ious: 0.4759, stage0_s: 0.4390, stage0_m: 0.3148, stage0_l: 0.0070, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0167, stage1_bag_acc: 94.3848, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5734, stage1_s: 0.5677, stage1_m: 0.2898, stage1_l: 0.0073, stage1_h: 0.0000, loss: 0.0954, grad_norm: 4.3640
2024-10-15 22:26:16,266 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:31, time: 0.831, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0247, stage0_bag_acc: 98.4333, stage0_mean_ious: 0.4984, stage0_s: 0.4843, stage0_m: 0.3250, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0107, stage1_bag_acc: 97.4904, stage1_neg_loss: 0.0045, stage1_mean_ious: 0.5667, stage1_s: 0.5835, stage1_m: 0.2991, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0398, grad_norm: 2.3340
2024-10-15 22:26:42,442 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 22:27:27,600 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:22, time: 0.860, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0327, stage0_bag_acc: 97.6889, stage0_mean_ious: 0.4791, stage0_s: 0.4460, stage0_m: 0.3073, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0092, stage1_bag_acc: 97.8667, stage1_neg_loss: 0.0077, stage1_mean_ious: 0.5881, stage1_s: 0.5803, stage1_m: 0.3044, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0496, grad_norm: 2.9476
2024-10-15 22:28:08,227 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:46, time: 0.812, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0143, stage0_bag_acc: 99.4000, stage0_mean_ious: 0.4957, stage0_s: 0.4539, stage0_m: 0.3490, stage0_l: 0.0169, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 98.9000, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.5799, stage1_s: 0.5871, stage1_m: 0.3115, stage1_l: 0.0152, stage1_h: 0.0000, loss: 0.0265, grad_norm: 1.7225
2024-10-15 22:28:49,528 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:12:10, time: 0.826, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0214, stage0_bag_acc: 98.3500, stage0_mean_ious: 0.4983, stage0_s: 0.4502, stage0_m: 0.3125, stage0_l: 0.0458, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0054, stage1_bag_acc: 98.6500, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5727, stage1_s: 0.5486, stage1_m: 0.3035, stage1_l: 0.0332, stage1_h: 0.0000, loss: 0.0314, grad_norm: 1.8411
2024-10-15 22:29:32,102 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:34, time: 0.852, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0274, stage0_bag_acc: 98.7667, stage0_mean_ious: 0.4944, stage0_s: 0.4554, stage0_m: 0.3645, stage0_l: 0.0118, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0085, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5808, stage1_s: 0.5694, stage1_m: 0.3500, stage1_l: 0.0065, stage1_h: 0.0000, loss: 0.0401, grad_norm: 2.3375
2024-10-15 22:30:15,023 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:58, time: 0.858, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0420, stage0_bag_acc: 96.8500, stage0_mean_ious: 0.4835, stage0_s: 0.4474, stage0_m: 0.3710, stage0_l: 0.0093, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0130, stage1_bag_acc: 95.8476, stage1_neg_loss: 0.0126, stage1_mean_ious: 0.5682, stage1_s: 0.5494, stage1_m: 0.3816, stage1_l: 0.0141, stage1_h: 0.0000, loss: 0.0676, grad_norm: 3.7946
2024-10-15 22:30:38,978 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 22:31:55,877 - mmdet - INFO - Evaluating bbox...
2024-10-15 22:31:56,438 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1838
2024-10-15 22:31:56,438 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6335
2024-10-15 22:31:56,439 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3433
2024-10-15 22:31:56,439 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1084
2024-10-15 22:31:56,439 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0424
2024-10-15 22:31:56,439 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0127
2024-10-15 22:31:56,439 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-15 22:31:56,439 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:31:56,439 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1944
2024-10-15 22:31:56,439 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0568
2024-10-15 22:31:56,439 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2896
2024-10-15 22:31:56,439 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7565
2024-10-15 22:31:56,439 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2896
2024-10-15 22:31:56,440 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2896
2024-10-15 22:31:56,440 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:31:56,440 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3087
2024-10-15 22:31:56,440 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0757
2024-10-15 22:31:56,446 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 22:31:56,446 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.1840, bbox_mAP_50: 0.6330, bbox_mAP_75: 0.3430, bbox_mAP_s: 0.1080, bbox_mAP_m: 0.0420, bbox_mAP_l: 0.0130, bbox_mAP_copypaste: 0.184 0.633 0.343 0.108 0.042 0.013
2024-10-15 22:32:42,772 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:53, time: 0.926, data_time: 0.056, memory: 7803, stage0_loss_instance_mil: 0.0228, stage0_bag_acc: 98.6921, stage0_mean_ious: 0.4546, stage0_s: 0.4125, stage0_m: 0.2564, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.1722, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5708, stage1_s: 0.5392, stage1_m: 0.2661, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0334, grad_norm: 1.9770
2024-10-15 22:33:22,863 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:16, time: 0.802, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0111, stage0_bag_acc: 99.5778, stage0_mean_ious: 0.4921, stage0_s: 0.4811, stage0_m: 0.2306, stage0_l: 0.0167, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0034, stage1_bag_acc: 99.3278, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5880, stage1_s: 0.6009, stage1_m: 0.2132, stage1_l: 0.0138, stage1_h: 0.0000, loss: 0.0183, grad_norm: 1.7506
2024-10-15 22:34:03,260 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:39, time: 0.808, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0270, stage0_bag_acc: 98.1667, stage0_mean_ious: 0.5071, stage0_s: 0.4751, stage0_m: 0.3568, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0134, stage1_bag_acc: 97.8667, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5922, stage1_s: 0.5933, stage1_m: 0.3373, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0433, grad_norm: 2.4558
2024-10-15 22:34:46,276 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:08:03, time: 0.860, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0134, stage0_bag_acc: 99.0000, stage0_mean_ious: 0.4855, stage0_s: 0.4372, stage0_m: 0.3098, stage0_l: 0.0164, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5610, stage1_s: 0.5508, stage1_m: 0.2851, stage1_l: 0.0126, stage1_h: 0.0000, loss: 0.0270, grad_norm: 2.1271
2024-10-15 22:35:30,183 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:26, time: 0.878, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0162, stage0_bag_acc: 98.7325, stage0_mean_ious: 0.5007, stage0_s: 0.4533, stage0_m: 0.3817, stage0_l: 0.0152, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0066, stage1_bag_acc: 99.1325, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5834, stage1_s: 0.5555, stage1_m: 0.3847, stage1_l: 0.0105, stage1_h: 0.0000, loss: 0.0259, grad_norm: 1.9769
2024-10-15 22:35:57,894 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 22:36:44,905 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:23, time: 0.895, data_time: 0.055, memory: 7803, stage0_loss_instance_mil: 0.0176, stage0_bag_acc: 98.8500, stage0_mean_ious: 0.4821, stage0_s: 0.4406, stage0_m: 0.3143, stage0_l: 0.0192, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0080, stage1_bag_acc: 98.4000, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5742, stage1_s: 0.5611, stage1_m: 0.3182, stage1_l: 0.0159, stage1_h: 0.0000, loss: 0.0276, grad_norm: 1.6207
2024-10-15 22:37:30,528 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:47, time: 0.912, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0158, stage0_bag_acc: 98.8348, stage0_mean_ious: 0.4785, stage0_s: 0.4124, stage0_m: 0.4143, stage0_l: 0.0272, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0091, stage1_bag_acc: 98.9030, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5684, stage1_s: 0.5497, stage1_m: 0.3951, stage1_l: 0.0189, stage1_h: 0.0000, loss: 0.0277, grad_norm: 2.3336
2024-10-15 22:38:15,550 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:10, time: 0.900, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0101, stage0_bag_acc: 99.3000, stage0_mean_ious: 0.5113, stage0_s: 0.4302, stage0_m: 0.3636, stage0_l: 0.0147, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0047, stage1_bag_acc: 99.1000, stage1_neg_loss: 0.0096, stage1_mean_ious: 0.5857, stage1_s: 0.5391, stage1_m: 0.3561, stage1_l: 0.0101, stage1_h: 0.0000, loss: 0.0243, grad_norm: 1.9168
2024-10-15 22:39:00,001 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 22:39:00,001 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:33, time: 0.889, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0252, stage0_bag_acc: 97.6333, stage0_mean_ious: 0.4860, stage0_s: 0.4551, stage0_m: 0.3421, stage0_l: 0.0167, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0051, stage1_bag_acc: 98.1333, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.5747, stage1_s: 0.5789, stage1_m: 0.3290, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.0323, grad_norm: 2.0441
2024-10-15 22:39:35,622 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:55, time: 0.712, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0184, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.4892, stage0_s: 0.4687, stage0_m: 0.4118, stage0_l: 0.0154, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0061, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0014, stage1_mean_ious: 0.5783, stage1_s: 0.5832, stage1_m: 0.4055, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.0259, grad_norm: 1.4801
2024-10-15 22:39:55,541 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 22:40:35,715 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:52, time: 0.758, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.0086, stage0_bag_acc: 99.6667, stage0_mean_ious: 0.4990, stage0_s: 0.4568, stage0_m: 0.4215, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 99.4667, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.5866, stage1_s: 0.5758, stage1_m: 0.4404, stage1_l: 0.0075, stage1_h: 0.0000, loss: 0.0176, grad_norm: 1.5284
2024-10-15 22:41:10,692 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:15, time: 0.700, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0110, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.4844, stage0_s: 0.4498, stage0_m: 0.3756, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0034, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5753, stage1_s: 0.5723, stage1_m: 0.3727, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0178, grad_norm: 1.2974
2024-10-15 22:41:44,844 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:37, time: 0.683, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0093, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.4964, stage0_s: 0.4270, stage0_m: 0.3788, stage0_l: 0.0267, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0044, stage1_bag_acc: 99.2000, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5818, stage1_s: 0.5435, stage1_m: 0.3679, stage1_l: 0.0297, stage1_h: 0.0000, loss: 0.0172, grad_norm: 1.5758
2024-10-15 22:42:18,613 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.675, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0277, stage0_bag_acc: 98.1682, stage0_mean_ious: 0.5030, stage0_s: 0.4725, stage0_m: 0.3432, stage0_l: 0.0155, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 98.1000, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5739, stage1_s: 0.5879, stage1_m: 0.3267, stage1_l: 0.0100, stage1_h: 0.0000, loss: 0.0402, grad_norm: 2.4652
2024-10-15 22:42:52,705 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:22, time: 0.682, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0164, stage0_bag_acc: 98.5000, stage0_mean_ious: 0.4770, stage0_s: 0.4487, stage0_m: 0.3703, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 98.4500, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5834, stage1_s: 0.5817, stage1_m: 0.3838, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0293, grad_norm: 2.1635
2024-10-15 22:43:14,151 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 22:44:32,065 - mmdet - INFO - Evaluating bbox...
2024-10-15 22:44:32,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1822
2024-10-15 22:44:32,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6282
2024-10-15 22:44:32,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3369
2024-10-15 22:44:32,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1057
2024-10-15 22:44:32,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0418
2024-10-15 22:44:32,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0124
2024-10-15 22:44:32,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-15 22:44:32,557 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:44:32,557 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1921
2024-10-15 22:44:32,557 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0620
2024-10-15 22:44:32,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2888
2024-10-15 22:44:32,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7583
2024-10-15 22:44:32,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2888
2024-10-15 22:44:32,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2888
2024-10-15 22:44:32,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:44:32,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3076
2024-10-15 22:44:32,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0814
2024-10-15 22:44:32,562 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 22:44:32,562 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.1820, bbox_mAP_50: 0.6280, bbox_mAP_75: 0.3370, bbox_mAP_s: 0.1060, bbox_mAP_m: 0.0420, bbox_mAP_l: 0.0120, bbox_mAP_copypaste: 0.182 0.628 0.337 0.106 0.042 0.012
2024-10-15 22:45:48,778 - mmdet - INFO - Evaluating bbox...
2024-10-15 22:45:49,342 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1822
2024-10-15 22:45:49,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6282
2024-10-15 22:45:49,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3369
2024-10-15 22:45:49,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1057
2024-10-15 22:45:49,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0418
2024-10-15 22:45:49,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0124
2024-10-15 22:45:49,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-15 22:45:49,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:45:49,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1921
2024-10-15 22:45:49,344 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0620
2024-10-15 22:45:49,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2888
2024-10-15 22:45:49,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7583
2024-10-15 22:45:49,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2888
2024-10-15 22:45:49,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2888
2024-10-15 22:45:49,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:45:49,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3076
2024-10-15 22:45:49,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0814
2024-10-15 22:45:50,626 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 22:45:51,502 - mmdet - INFO - Distributed training: False
2024-10-15 22:45:52,362 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 22:45:53,425 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 22:45:53,426 - mmdet - INFO - Use load_from_local loader
2024-10-15 22:45:53,760 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 22:45:53,776 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 22:45:53,776 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 22:46:39,378 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:50:18, time: 0.912, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.7391, stage0_bag_acc: 10.4818, stage0_mean_ious: 0.0534, stage0_s: 0.0410, stage0_m: 0.0485, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1537, stage1_bag_acc: 14.1788, stage1_neg_loss: 0.0007, stage1_mean_ious: 0.0559, stage1_s: 0.0436, stage1_m: 0.0499, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8935, grad_norm: 5.5761
2024-10-15 22:47:22,483 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:48:11, time: 0.862, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.7174, stage0_bag_acc: 19.2365, stage0_mean_ious: 0.0742, stage0_s: 0.0570, stage0_m: 0.0736, stage0_l: 0.0106, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1615, stage1_bag_acc: 14.5238, stage1_neg_loss: 0.0008, stage1_mean_ious: 0.0770, stage1_s: 0.0585, stage1_m: 0.0836, stage1_l: 0.0073, stage1_h: 0.0000, loss: 0.8797, grad_norm: 5.0514
2024-10-15 22:48:05,002 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:46:47, time: 0.850, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.6934, stage0_bag_acc: 18.3873, stage0_mean_ious: 0.1052, stage0_s: 0.0868, stage0_m: 0.0864, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1674, stage1_bag_acc: 16.5904, stage1_neg_loss: 0.0013, stage1_mean_ious: 0.1061, stage1_s: 0.0877, stage1_m: 0.0834, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8622, grad_norm: 4.6443
2024-10-15 22:48:49,241 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:46:12, time: 0.885, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.6565, stage0_bag_acc: 26.4714, stage0_mean_ious: 0.1564, stage0_s: 0.1162, stage0_m: 0.1552, stage0_l: 0.0069, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1602, stage1_bag_acc: 31.5357, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.1624, stage1_s: 0.1216, stage1_m: 0.1575, stage1_l: 0.0061, stage1_h: 0.0000, loss: 0.8251, grad_norm: 7.6601
2024-10-15 22:49:33,576 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:45:34, time: 0.887, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.5998, stage0_bag_acc: 33.8057, stage0_mean_ious: 0.1814, stage0_s: 0.1501, stage0_m: 0.1548, stage0_l: 0.0273, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1392, stage1_bag_acc: 48.3769, stage1_neg_loss: 0.0203, stage1_mean_ious: 0.2015, stage1_s: 0.1717, stage1_m: 0.1617, stage1_l: 0.0259, stage1_h: 0.0000, loss: 0.7593, grad_norm: 9.7235
2024-10-15 22:50:00,162 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 22:50:49,015 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:40:45, time: 0.932, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.5247, stage0_bag_acc: 39.0068, stage0_mean_ious: 0.2202, stage0_s: 0.2033, stage0_m: 0.1827, stage0_l: 0.0247, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1258, stage1_bag_acc: 51.0150, stage1_neg_loss: 0.0210, stage1_mean_ious: 0.2684, stage1_s: 0.2525, stage1_m: 0.2138, stage1_l: 0.0220, stage1_h: 0.0000, loss: 0.6715, grad_norm: 9.5626
2024-10-15 22:51:32,521 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:40:30, time: 0.870, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.4482, stage0_bag_acc: 50.7462, stage0_mean_ious: 0.3081, stage0_s: 0.2380, stage0_m: 0.2717, stage0_l: 0.0251, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1191, stage1_bag_acc: 54.9411, stage1_neg_loss: 0.0249, stage1_mean_ious: 0.3877, stage1_s: 0.3320, stage1_m: 0.3044, stage1_l: 0.0234, stage1_h: 0.0000, loss: 0.5922, grad_norm: 9.8230
2024-10-15 22:52:16,367 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:40:10, time: 0.877, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.4634, stage0_bag_acc: 51.7802, stage0_mean_ious: 0.2856, stage0_s: 0.2344, stage0_m: 0.2285, stage0_l: 0.0138, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1108, stage1_bag_acc: 57.8143, stage1_neg_loss: 0.0149, stage1_mean_ious: 0.3553, stage1_s: 0.3189, stage1_m: 0.2538, stage1_l: 0.0092, stage1_h: 0.0000, loss: 0.5892, grad_norm: 9.7361
2024-10-15 22:52:58,984 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:39:38, time: 0.852, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.4024, stage0_bag_acc: 61.3504, stage0_mean_ious: 0.3680, stage0_s: 0.3039, stage0_m: 0.3069, stage0_l: 0.0154, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0891, stage1_bag_acc: 62.2460, stage1_neg_loss: 0.0209, stage1_mean_ious: 0.4406, stage1_s: 0.3834, stage1_m: 0.3217, stage1_l: 0.0169, stage1_h: 0.0000, loss: 0.5124, grad_norm: 10.2812
2024-10-15 22:53:40,207 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:38:56, time: 0.824, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.3050, stage0_bag_acc: 74.5556, stage0_mean_ious: 0.3820, stage0_s: 0.3331, stage0_m: 0.2210, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0709, stage1_bag_acc: 74.1556, stage1_neg_loss: 0.0174, stage1_mean_ious: 0.5078, stage1_s: 0.4680, stage1_m: 0.2477, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.3933, grad_norm: 11.5802
2024-10-15 22:54:08,946 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 22:54:57,198 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:36:20, time: 0.921, data_time: 0.056, memory: 7803, stage0_loss_instance_mil: 0.1873, stage0_bag_acc: 83.9793, stage0_mean_ious: 0.4353, stage0_s: 0.4091, stage0_m: 0.2918, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0474, stage1_bag_acc: 86.1323, stage1_neg_loss: 0.0213, stage1_mean_ious: 0.5523, stage1_s: 0.5396, stage1_m: 0.3220, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2559, grad_norm: 9.6681
2024-10-15 22:55:41,340 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:35:59, time: 0.883, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0971, stage0_bag_acc: 92.8965, stage0_mean_ious: 0.4700, stage0_s: 0.4190, stage0_m: 0.4313, stage0_l: 0.0172, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0320, stage1_bag_acc: 93.2545, stage1_neg_loss: 0.0141, stage1_mean_ious: 0.5863, stage1_s: 0.5815, stage1_m: 0.4536, stage1_l: 0.0165, stage1_h: 0.0000, loss: 0.1432, grad_norm: 6.1319
2024-10-15 22:56:23,980 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:35:29, time: 0.853, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1381, stage0_bag_acc: 90.8595, stage0_mean_ious: 0.4686, stage0_s: 0.4216, stage0_m: 0.3510, stage0_l: 0.0159, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0524, stage1_bag_acc: 90.1975, stage1_neg_loss: 0.0176, stage1_mean_ious: 0.5780, stage1_s: 0.5664, stage1_m: 0.3545, stage1_l: 0.0178, stage1_h: 0.0000, loss: 0.2081, grad_norm: 9.5068
2024-10-15 22:57:07,155 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:34:59, time: 0.864, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1221, stage0_bag_acc: 90.3048, stage0_mean_ious: 0.4709, stage0_s: 0.3829, stage0_m: 0.3596, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0347, stage1_bag_acc: 91.4738, stage1_neg_loss: 0.0109, stage1_mean_ious: 0.5617, stage1_s: 0.4980, stage1_m: 0.3698, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1678, grad_norm: 6.6690
2024-10-15 22:57:48,047 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:34:20, time: 0.818, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1075, stage0_bag_acc: 90.4119, stage0_mean_ious: 0.4874, stage0_s: 0.4303, stage0_m: 0.3841, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0332, stage1_bag_acc: 93.1119, stage1_neg_loss: 0.0121, stage1_mean_ious: 0.6042, stage1_s: 0.5635, stage1_m: 0.4256, stage1_l: 0.0081, stage1_h: 0.0000, loss: 0.1528, grad_norm: 7.8940
2024-10-15 22:58:07,088 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 22:59:23,360 - mmdet - INFO - Evaluating bbox...
2024-10-15 22:59:23,845 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2202
2024-10-15 22:59:23,845 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6916
2024-10-15 22:59:23,845 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4166
2024-10-15 22:59:23,845 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1570
2024-10-15 22:59:23,845 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0801
2024-10-15 22:59:23,845 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0270
2024-10-15 22:59:23,845 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0003
2024-10-15 22:59:23,846 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:59:23,846 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2319
2024-10-15 22:59:23,846 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0956
2024-10-15 22:59:23,846 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3195
2024-10-15 22:59:23,846 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7880
2024-10-15 22:59:23,846 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3195
2024-10-15 22:59:23,846 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3195
2024-10-15 22:59:23,846 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 22:59:23,846 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3380
2024-10-15 22:59:23,846 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1177
2024-10-15 22:59:23,852 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 22:59:23,852 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2200, bbox_mAP_50: 0.6920, bbox_mAP_75: 0.4170, bbox_mAP_s: 0.1570, bbox_mAP_m: 0.0800, bbox_mAP_l: 0.0270, bbox_mAP_copypaste: 0.220 0.692 0.417 0.157 0.080 0.027
2024-10-15 22:59:59,693 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:31:55, time: 0.717, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.1295, stage0_bag_acc: 91.6308, stage0_mean_ious: 0.4859, stage0_s: 0.4168, stage0_m: 0.3388, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0403, stage1_bag_acc: 92.1030, stage1_neg_loss: 0.0118, stage1_mean_ious: 0.5836, stage1_s: 0.5239, stage1_m: 0.3579, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1816, grad_norm: 7.7643
2024-10-15 23:00:32,084 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:31:00, time: 0.648, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0868, stage0_bag_acc: 93.6556, stage0_mean_ious: 0.4812, stage0_s: 0.4329, stage0_m: 0.3033, stage0_l: 0.0244, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0269, stage1_bag_acc: 93.7556, stage1_neg_loss: 0.0078, stage1_mean_ious: 0.5785, stage1_s: 0.5540, stage1_m: 0.3358, stage1_l: 0.0266, stage1_h: 0.0000, loss: 0.1215, grad_norm: 5.1719
2024-10-15 23:01:06,097 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:30:11, time: 0.680, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0550, stage0_bag_acc: 96.0848, stage0_mean_ious: 0.4735, stage0_s: 0.4270, stage0_m: 0.3999, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0243, stage1_bag_acc: 96.5348, stage1_neg_loss: 0.0091, stage1_mean_ious: 0.5734, stage1_s: 0.5595, stage1_m: 0.3934, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0885, grad_norm: 4.6465
2024-10-15 23:01:39,558 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:29:22, time: 0.669, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0964, stage0_bag_acc: 92.5944, stage0_mean_ious: 0.4975, stage0_s: 0.4792, stage0_m: 0.3055, stage0_l: 0.0075, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0221, stage1_bag_acc: 93.0444, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5928, stage1_s: 0.5869, stage1_m: 0.3259, stage1_l: 0.0079, stage1_h: 0.0000, loss: 0.1248, grad_norm: 6.2912
2024-10-15 23:02:20,715 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:28:51, time: 0.823, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0827, stage0_bag_acc: 92.5284, stage0_mean_ious: 0.4907, stage0_s: 0.4475, stage0_m: 0.3391, stage0_l: 0.0178, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0236, stage1_bag_acc: 94.7641, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5934, stage1_s: 0.5915, stage1_m: 0.3402, stage1_l: 0.0133, stage1_h: 0.0000, loss: 0.1116, grad_norm: 4.7551
2024-10-15 23:02:45,491 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 23:03:33,766 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:27:21, time: 0.914, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0373, stage0_bag_acc: 97.2667, stage0_mean_ious: 0.5079, stage0_s: 0.4592, stage0_m: 0.3280, stage0_l: 0.0093, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0167, stage1_bag_acc: 96.7500, stage1_neg_loss: 0.0105, stage1_mean_ious: 0.6059, stage1_s: 0.5810, stage1_m: 0.3485, stage1_l: 0.0095, stage1_h: 0.0000, loss: 0.0645, grad_norm: 4.4027
2024-10-15 23:04:16,345 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:26:53, time: 0.852, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0944, stage0_bag_acc: 92.0110, stage0_mean_ious: 0.4794, stage0_s: 0.4153, stage0_m: 0.3364, stage0_l: 0.0150, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0230, stage1_bag_acc: 92.7571, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.5775, stage1_s: 0.5303, stage1_m: 0.3594, stage1_l: 0.0167, stage1_h: 0.0000, loss: 0.1240, grad_norm: 5.8414
2024-10-15 23:05:00,374 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:26:25, time: 0.880, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0511, stage0_bag_acc: 95.9667, stage0_mean_ious: 0.4749, stage0_s: 0.4220, stage0_m: 0.3180, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0174, stage1_bag_acc: 96.9810, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.5721, stage1_s: 0.5475, stage1_m: 0.3063, stage1_l: 0.0110, stage1_h: 0.0000, loss: 0.0766, grad_norm: 4.4683
2024-10-15 23:05:43,464 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:25:55, time: 0.862, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0608, stage0_bag_acc: 96.3500, stage0_mean_ious: 0.5029, stage0_s: 0.4633, stage0_m: 0.3715, stage0_l: 0.0431, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0168, stage1_bag_acc: 96.8000, stage1_neg_loss: 0.0171, stage1_mean_ious: 0.5917, stage1_s: 0.5764, stage1_m: 0.3588, stage1_l: 0.0428, stage1_h: 0.0000, loss: 0.0946, grad_norm: 5.3738
2024-10-15 23:06:25,289 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:25:23, time: 0.837, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0445, stage0_bag_acc: 96.8269, stage0_mean_ious: 0.4752, stage0_s: 0.4580, stage0_m: 0.2326, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0169, stage1_bag_acc: 97.2087, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5872, stage1_s: 0.5843, stage1_m: 0.2417, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0673, grad_norm: 3.9649
2024-10-15 23:06:51,755 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 23:07:39,079 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:24:00, time: 0.903, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.0466, stage0_bag_acc: 97.3167, stage0_mean_ious: 0.4916, stage0_s: 0.4490, stage0_m: 0.3154, stage0_l: 0.0171, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0144, stage1_bag_acc: 97.3167, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5927, stage1_s: 0.5880, stage1_m: 0.3270, stage1_l: 0.0155, stage1_h: 0.0000, loss: 0.0662, grad_norm: 3.4742
2024-10-15 23:08:21,835 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:23:29, time: 0.855, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0225, stage0_bag_acc: 98.3667, stage0_mean_ious: 0.4841, stage0_s: 0.4442, stage0_m: 0.3425, stage0_l: 0.0215, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0202, stage1_bag_acc: 98.5167, stage1_neg_loss: 0.0113, stage1_mean_ious: 0.5805, stage1_s: 0.5698, stage1_m: 0.3501, stage1_l: 0.0214, stage1_h: 0.0000, loss: 0.0540, grad_norm: 4.0093
2024-10-15 23:09:03,705 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:56, time: 0.837, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0808, stage0_bag_acc: 96.0142, stage0_mean_ious: 0.4862, stage0_s: 0.4632, stage0_m: 0.3579, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0135, stage1_bag_acc: 95.5420, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.5889, stage1_s: 0.6026, stage1_m: 0.3535, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1019, grad_norm: 4.2176
2024-10-15 23:09:45,691 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:22:22, time: 0.840, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0378, stage0_bag_acc: 97.8278, stage0_mean_ious: 0.5078, stage0_s: 0.4706, stage0_m: 0.3916, stage0_l: 0.0181, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0120, stage1_bag_acc: 98.4778, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.6075, stage1_s: 0.6124, stage1_m: 0.3656, stage1_l: 0.0115, stage1_h: 0.0000, loss: 0.0557, grad_norm: 3.6361
2024-10-15 23:10:29,208 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:49, time: 0.870, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0493, stage0_bag_acc: 96.4030, stage0_mean_ious: 0.4815, stage0_s: 0.4300, stage0_m: 0.3536, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0129, stage1_bag_acc: 95.4197, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5787, stage1_s: 0.5653, stage1_m: 0.3650, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0678, grad_norm: 3.3810
2024-10-15 23:10:55,333 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 23:12:12,958 - mmdet - INFO - Evaluating bbox...
2024-10-15 23:12:13,561 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2222
2024-10-15 23:12:13,561 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7069
2024-10-15 23:12:13,561 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4262
2024-10-15 23:12:13,561 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1416
2024-10-15 23:12:13,561 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0691
2024-10-15 23:12:13,561 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0206
2024-10-15 23:12:13,561 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-15 23:12:13,562 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 23:12:13,562 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2338
2024-10-15 23:12:13,562 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0985
2024-10-15 23:12:13,562 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3282
2024-10-15 23:12:13,562 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8027
2024-10-15 23:12:13,562 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3282
2024-10-15 23:12:13,562 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3282
2024-10-15 23:12:13,562 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 23:12:13,562 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3468
2024-10-15 23:12:13,563 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1195
2024-10-15 23:12:13,569 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 23:12:13,569 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2220, bbox_mAP_50: 0.7070, bbox_mAP_75: 0.4260, bbox_mAP_s: 0.1420, bbox_mAP_m: 0.0690, bbox_mAP_l: 0.0210, bbox_mAP_copypaste: 0.222 0.707 0.426 0.142 0.069 0.021
2024-10-15 23:13:00,353 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:20:34, time: 0.935, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0118, stage0_bag_acc: 99.5682, stage0_mean_ious: 0.4867, stage0_s: 0.4423, stage0_m: 0.3760, stage0_l: 0.0098, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 99.3182, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5874, stage1_s: 0.5738, stage1_m: 0.3876, stage1_l: 0.0071, stage1_h: 0.0000, loss: 0.0244, grad_norm: 2.0152
2024-10-15 23:13:42,636 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:20:00, time: 0.846, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0425, stage0_bag_acc: 97.6500, stage0_mean_ious: 0.4744, stage0_s: 0.4518, stage0_m: 0.2801, stage0_l: 0.0253, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0101, stage1_bag_acc: 97.2500, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5802, stage1_s: 0.5773, stage1_m: 0.2779, stage1_l: 0.0232, stage1_h: 0.0000, loss: 0.0576, grad_norm: 3.4717
2024-10-15 23:14:27,558 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:19:28, time: 0.899, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0349, stage0_bag_acc: 96.3643, stage0_mean_ious: 0.4958, stage0_s: 0.4535, stage0_m: 0.3794, stage0_l: 0.0224, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0145, stage1_bag_acc: 96.6500, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5969, stage1_s: 0.5919, stage1_m: 0.3821, stage1_l: 0.0200, stage1_h: 0.0000, loss: 0.0524, grad_norm: 3.1351
2024-10-15 23:15:07,371 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:51, time: 0.796, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0153, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.4970, stage0_s: 0.4750, stage0_m: 0.2736, stage0_l: 0.0286, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0102, stage1_bag_acc: 98.5000, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5844, stage1_s: 0.5783, stage1_m: 0.2655, stage1_l: 0.0233, stage1_h: 0.0000, loss: 0.0306, grad_norm: 2.9286
2024-10-15 23:15:47,455 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:18:14, time: 0.802, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0356, stage0_bag_acc: 97.3143, stage0_mean_ious: 0.4854, stage0_s: 0.4654, stage0_m: 0.3002, stage0_l: 0.0112, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0114, stage1_bag_acc: 97.6500, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5840, stage1_s: 0.5873, stage1_m: 0.3017, stage1_l: 0.0153, stage1_h: 0.0000, loss: 0.0525, grad_norm: 3.2682
2024-10-15 23:16:14,133 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 23:16:54,104 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:57, time: 0.755, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0254, stage0_bag_acc: 98.2682, stage0_mean_ious: 0.4971, stage0_s: 0.4678, stage0_m: 0.2632, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0114, stage1_bag_acc: 98.2182, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.6074, stage1_s: 0.6004, stage1_m: 0.2578, stage1_l: 0.0118, stage1_h: 0.0000, loss: 0.0427, grad_norm: 3.0338
2024-10-15 23:17:28,223 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:16:17, time: 0.682, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0407, stage0_bag_acc: 97.1000, stage0_mean_ious: 0.4866, stage0_s: 0.4472, stage0_m: 0.3366, stage0_l: 0.0289, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 96.3333, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5913, stage1_s: 0.5856, stage1_m: 0.3530, stage1_l: 0.0292, stage1_h: 0.0000, loss: 0.0687, grad_norm: 4.7829
2024-10-15 23:18:01,021 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:37, time: 0.656, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0395, stage0_bag_acc: 96.9799, stage0_mean_ious: 0.4719, stage0_s: 0.4388, stage0_m: 0.3102, stage0_l: 0.0103, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0173, stage1_bag_acc: 96.8729, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5632, stage1_s: 0.5657, stage1_m: 0.2939, stage1_l: 0.0085, stage1_h: 0.0000, loss: 0.0641, grad_norm: 3.8898
2024-10-15 23:18:36,295 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:14:58, time: 0.705, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0153, stage0_bag_acc: 99.3000, stage0_mean_ious: 0.5078, stage0_s: 0.4436, stage0_m: 0.4287, stage0_l: 0.0131, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0106, stage1_bag_acc: 98.9000, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.6018, stage1_s: 0.5716, stage1_m: 0.4372, stage1_l: 0.0173, stage1_h: 0.0000, loss: 0.0323, grad_norm: 2.8574
2024-10-15 23:19:10,259 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:19, time: 0.679, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0327, stage0_bag_acc: 96.8778, stage0_mean_ious: 0.4971, stage0_s: 0.4521, stage0_m: 0.3871, stage0_l: 0.0106, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0177, stage1_bag_acc: 96.6500, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5772, stage1_s: 0.5684, stage1_m: 0.3737, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0553, grad_norm: 3.8707
2024-10-15 23:19:31,491 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 23:20:09,216 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:08, time: 0.709, data_time: 0.056, memory: 7803, stage0_loss_instance_mil: 0.0307, stage0_bag_acc: 97.7610, stage0_mean_ious: 0.5112, stage0_s: 0.4514, stage0_m: 0.2988, stage0_l: 0.0093, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0090, stage1_bag_acc: 98.1610, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5860, stage1_s: 0.5510, stage1_m: 0.2868, stage1_l: 0.0097, stage1_h: 0.0000, loss: 0.0437, grad_norm: 2.9803
2024-10-15 23:20:45,632 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:31, time: 0.728, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0243, stage0_bag_acc: 98.4778, stage0_mean_ious: 0.4735, stage0_s: 0.4254, stage0_m: 0.3365, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.4778, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5843, stage1_s: 0.5605, stage1_m: 0.3496, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0348, grad_norm: 2.5546
2024-10-15 23:21:29,694 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:11:57, time: 0.881, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.5041, stage0_s: 0.4701, stage0_m: 0.3331, stage0_l: 0.0160, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0068, stage1_bag_acc: 99.4000, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5991, stage1_s: 0.6001, stage1_m: 0.3519, stage1_l: 0.0104, stage1_h: 0.0000, loss: 0.0219, grad_norm: 1.7610
2024-10-15 23:22:14,439 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:23, time: 0.895, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0390, stage0_bag_acc: 97.0333, stage0_mean_ious: 0.5000, stage0_s: 0.4325, stage0_m: 0.3855, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 96.9111, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5867, stage1_s: 0.5546, stage1_m: 0.4010, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0510, grad_norm: 2.9857
2024-10-15 23:23:00,008 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:49, time: 0.911, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0115, stage0_bag_acc: 99.2182, stage0_mean_ious: 0.4705, stage0_s: 0.4298, stage0_m: 0.3620, stage0_l: 0.0164, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0058, stage1_bag_acc: 99.2364, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5727, stage1_s: 0.5720, stage1_m: 0.3563, stage1_l: 0.0105, stage1_h: 0.0000, loss: 0.0208, grad_norm: 1.5628
2024-10-15 23:23:24,674 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 23:24:41,888 - mmdet - INFO - Evaluating bbox...
2024-10-15 23:24:42,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2260
2024-10-15 23:24:42,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6991
2024-10-15 23:24:42,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4367
2024-10-15 23:24:42,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1503
2024-10-15 23:24:42,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0694
2024-10-15 23:24:42,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0251
2024-10-15 23:24:42,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0008
2024-10-15 23:24:42,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 23:24:42,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2370
2024-10-15 23:24:42,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0811
2024-10-15 23:24:42,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3306
2024-10-15 23:24:42,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7977
2024-10-15 23:24:42,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3306
2024-10-15 23:24:42,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3306
2024-10-15 23:24:42,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 23:24:42,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3499
2024-10-15 23:24:42,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0993
2024-10-15 23:24:42,379 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 23:24:42,379 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2260, bbox_mAP_50: 0.6990, bbox_mAP_75: 0.4370, bbox_mAP_s: 0.1500, bbox_mAP_m: 0.0690, bbox_mAP_l: 0.0250, bbox_mAP_copypaste: 0.226 0.699 0.437 0.150 0.069 0.025
2024-10-15 23:25:27,914 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:45, time: 0.910, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0197, stage0_bag_acc: 98.5167, stage0_mean_ious: 0.4990, stage0_s: 0.4513, stage0_m: 0.3881, stage0_l: 0.0051, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0105, stage1_bag_acc: 97.9333, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.6062, stage1_s: 0.5900, stage1_m: 0.3897, stage1_l: 0.0035, stage1_h: 0.0000, loss: 0.0339, grad_norm: 2.3081
2024-10-15 23:26:10,444 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:09, time: 0.850, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0236, stage0_bag_acc: 98.7182, stage0_mean_ious: 0.5110, stage0_s: 0.4551, stage0_m: 0.3755, stage0_l: 0.0205, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0099, stage1_bag_acc: 98.6143, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5764, stage1_s: 0.5656, stage1_m: 0.3279, stage1_l: 0.0214, stage1_h: 0.0000, loss: 0.0371, grad_norm: 2.1635
2024-10-15 23:26:52,911 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:33, time: 0.849, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0135, stage0_bag_acc: 98.7825, stage0_mean_ious: 0.5073, stage0_s: 0.4452, stage0_m: 0.4488, stage0_l: 0.0277, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 98.8960, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.5815, stage1_s: 0.5550, stage1_m: 0.4167, stage1_l: 0.0281, stage1_h: 0.0000, loss: 0.0243, grad_norm: 1.7757
2024-10-15 23:27:35,574 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:57, time: 0.853, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0212, stage0_bag_acc: 98.0000, stage0_mean_ious: 0.4752, stage0_s: 0.4375, stage0_m: 0.3257, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0094, stage1_bag_acc: 97.6000, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5834, stage1_s: 0.5661, stage1_m: 0.3304, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0353, grad_norm: 2.1154
2024-10-15 23:28:16,907 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:21, time: 0.827, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0230, stage0_bag_acc: 97.9143, stage0_mean_ious: 0.5057, stage0_s: 0.4762, stage0_m: 0.2993, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0094, stage1_bag_acc: 97.6643, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5937, stage1_s: 0.5878, stage1_m: 0.3022, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0351, grad_norm: 2.3155
2024-10-15 23:28:41,749 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 23:29:28,078 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:18, time: 0.882, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0175, stage0_bag_acc: 99.2167, stage0_mean_ious: 0.5099, stage0_s: 0.4794, stage0_m: 0.3464, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0101, stage1_bag_acc: 98.9667, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5931, stage1_s: 0.5847, stage1_m: 0.3575, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0310, grad_norm: 2.2858
2024-10-15 23:30:09,993 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:42, time: 0.838, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0186, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.4999, stage0_s: 0.4536, stage0_m: 0.3225, stage0_l: 0.0180, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0054, stage1_bag_acc: 98.1000, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5953, stage1_s: 0.5771, stage1_m: 0.3153, stage1_l: 0.0100, stage1_h: 0.0000, loss: 0.0271, grad_norm: 1.8596
2024-10-15 23:30:54,372 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:06, time: 0.887, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0085, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4764, stage0_s: 0.3983, stage0_m: 0.3969, stage0_l: 0.0108, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0081, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5830, stage1_s: 0.5460, stage1_m: 0.4081, stage1_l: 0.0159, stage1_h: 0.0000, loss: 0.0200, grad_norm: 1.7171
2024-10-15 23:31:39,395 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 23:31:39,396 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:29, time: 0.901, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0082, stage0_bag_acc: 99.0167, stage0_mean_ious: 0.4849, stage0_s: 0.4388, stage0_m: 0.3841, stage0_l: 0.0228, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0052, stage1_bag_acc: 98.7667, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5847, stage1_s: 0.5861, stage1_m: 0.3870, stage1_l: 0.0192, stage1_h: 0.0000, loss: 0.0185, grad_norm: 1.5338
2024-10-15 23:32:22,398 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:52, time: 0.860, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0229, stage0_bag_acc: 98.6278, stage0_mean_ious: 0.5066, stage0_s: 0.4621, stage0_m: 0.3867, stage0_l: 0.0108, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0063, stage1_bag_acc: 98.3778, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.6120, stage1_s: 0.6006, stage1_m: 0.4143, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0309, grad_norm: 1.8365
2024-10-15 23:32:50,645 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 23:33:38,823 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:51, time: 0.919, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.0115, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.5067, stage0_s: 0.4660, stage0_m: 0.3346, stage0_l: 0.0073, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0072, stage1_bag_acc: 99.8000, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5920, stage1_s: 0.5978, stage1_m: 0.3197, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.0237, grad_norm: 1.7979
2024-10-15 23:34:23,321 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:14, time: 0.890, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0133, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.5014, stage0_s: 0.4654, stage0_m: 0.3794, stage0_l: 0.0108, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0042, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5885, stage1_s: 0.5794, stage1_m: 0.3872, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0202, grad_norm: 1.6521
2024-10-15 23:35:04,631 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:37, time: 0.826, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0274, stage0_bag_acc: 99.0000, stage0_mean_ious: 0.4818, stage0_s: 0.4576, stage0_m: 0.2983, stage0_l: 0.0147, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0106, stage1_bag_acc: 99.8000, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5827, stage1_s: 0.5816, stage1_m: 0.3185, stage1_l: 0.0143, stage1_h: 0.0000, loss: 0.0431, grad_norm: 2.5694
2024-10-15 23:35:41,479 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.737, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0279, stage0_bag_acc: 98.4000, stage0_mean_ious: 0.4949, stage0_s: 0.4634, stage0_m: 0.2983, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.7000, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5803, stage1_s: 0.5820, stage1_m: 0.2980, stage1_l: 0.0099, stage1_h: 0.0000, loss: 0.0403, grad_norm: 2.4035
2024-10-15 23:36:14,539 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:22, time: 0.661, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0188, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.4858, stage0_s: 0.4535, stage0_m: 0.3414, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0061, stage1_bag_acc: 98.7500, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.6093, stage1_s: 0.5891, stage1_m: 0.3645, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0285, grad_norm: 2.0708
2024-10-15 23:36:35,309 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 23:37:54,392 - mmdet - INFO - Evaluating bbox...
2024-10-15 23:37:54,976 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2289
2024-10-15 23:37:54,976 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7094
2024-10-15 23:37:54,976 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4440
2024-10-15 23:37:54,976 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1514
2024-10-15 23:37:54,976 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0746
2024-10-15 23:37:54,976 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0270
2024-10-15 23:37:54,976 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0008
2024-10-15 23:37:54,977 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 23:37:54,977 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2397
2024-10-15 23:37:54,977 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0848
2024-10-15 23:37:54,977 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3348
2024-10-15 23:37:54,977 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8050
2024-10-15 23:37:54,977 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3348
2024-10-15 23:37:54,977 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3348
2024-10-15 23:37:54,977 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 23:37:54,977 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3542
2024-10-15 23:37:54,977 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1034
2024-10-15 23:37:54,984 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 23:37:54,984 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2290, bbox_mAP_50: 0.7090, bbox_mAP_75: 0.4440, bbox_mAP_s: 0.1510, bbox_mAP_m: 0.0750, bbox_mAP_l: 0.0270, bbox_mAP_copypaste: 0.229 0.709 0.444 0.151 0.075 0.027
2024-10-15 23:39:11,049 - mmdet - INFO - Evaluating bbox...
2024-10-15 23:39:11,583 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2289
2024-10-15 23:39:11,583 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7094
2024-10-15 23:39:11,584 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4440
2024-10-15 23:39:11,584 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1514
2024-10-15 23:39:11,584 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0746
2024-10-15 23:39:11,584 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0270
2024-10-15 23:39:11,584 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0008
2024-10-15 23:39:11,584 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 23:39:11,584 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2397
2024-10-15 23:39:11,585 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0848
2024-10-15 23:39:11,585 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3348
2024-10-15 23:39:11,585 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8050
2024-10-15 23:39:11,585 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3348
2024-10-15 23:39:11,585 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3348
2024-10-15 23:39:11,585 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 23:39:11,585 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3542
2024-10-15 23:39:11,585 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1034
2024-10-15 23:39:12,954 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+a790e82
------------------------------------------------------------

2024-10-15 23:39:14,057 - mmdet - INFO - Distributed training: False
2024-10-15 23:39:15,152 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 23:39:16,259 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 23:39:16,259 - mmdet - INFO - Use load_from_local loader
2024-10-15 23:39:16,567 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 23:39:16,597 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 23:39:16,598 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 23:39:55,462 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:42:52, time: 0.777, data_time: 0.056, memory: 7803, stage0_loss_instance_mil: 0.7064, stage0_bag_acc: 12.7778, stage0_mean_ious: 0.0390, stage0_s: 0.0336, stage0_m: 0.0323, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1729, stage1_bag_acc: 17.4778, stage1_neg_loss: 0.0009, stage1_mean_ious: 0.0384, stage1_s: 0.0328, stage1_m: 0.0313, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8802, grad_norm: 5.6441
2024-10-15 23:40:39,203 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:44:52, time: 0.875, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.6949, stage0_bag_acc: 25.1056, stage0_mean_ious: 0.0815, stage0_s: 0.0693, stage0_m: 0.0658, stage0_l: 0.0142, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1668, stage1_bag_acc: 20.3409, stage1_neg_loss: 0.0015, stage1_mean_ious: 0.0833, stage1_s: 0.0695, stage1_m: 0.0684, stage1_l: 0.0142, stage1_h: 0.0000, loss: 0.8632, grad_norm: 5.9475
2024-10-15 23:41:23,127 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:45:07, time: 0.879, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.6791, stage0_bag_acc: 23.1416, stage0_mean_ious: 0.0940, stage0_s: 0.0598, stage0_m: 0.1138, stage0_l: 0.0123, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1599, stage1_bag_acc: 12.8429, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.0899, stage1_s: 0.0598, stage1_m: 0.1054, stage1_l: 0.0104, stage1_h: 0.0000, loss: 0.8436, grad_norm: 8.2473
2024-10-15 23:42:04,974 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:44:20, time: 0.837, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.6442, stage0_bag_acc: 28.4800, stage0_mean_ious: 0.1164, stage0_s: 0.1209, stage0_m: 0.0771, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1470, stage1_bag_acc: 44.6103, stage1_neg_loss: 0.0143, stage1_mean_ious: 0.1222, stage1_s: 0.1304, stage1_m: 0.0706, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8055, grad_norm: 9.2248
2024-10-15 23:42:47,808 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:43:47, time: 0.857, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.6280, stage0_bag_acc: 26.9753, stage0_mean_ious: 0.1310, stage0_s: 0.1076, stage0_m: 0.1018, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1365, stage1_bag_acc: 46.4077, stage1_neg_loss: 0.0168, stage1_mean_ious: 0.1457, stage1_s: 0.1205, stage1_m: 0.1119, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.7813, grad_norm: 9.8215
2024-10-15 23:43:13,721 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 23:44:00,649 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:39:09, time: 0.895, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.4960, stage0_bag_acc: 43.9094, stage0_mean_ious: 0.2691, stage0_s: 0.2196, stage0_m: 0.2150, stage0_l: 0.0124, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1088, stage1_bag_acc: 45.5053, stage1_neg_loss: 0.0214, stage1_mean_ious: 0.3447, stage1_s: 0.2950, stage1_m: 0.2405, stage1_l: 0.0066, stage1_h: 0.0000, loss: 0.6261, grad_norm: 11.4043
2024-10-15 23:44:43,018 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:38:59, time: 0.847, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.4976, stage0_bag_acc: 46.8857, stage0_mean_ious: 0.2707, stage0_s: 0.2284, stage0_m: 0.1972, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0958, stage1_bag_acc: 47.7151, stage1_neg_loss: 0.0155, stage1_mean_ious: 0.3454, stage1_s: 0.2936, stage1_m: 0.2383, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.6088, grad_norm: 10.3785
2024-10-15 23:45:26,231 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:38:47, time: 0.864, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.3635, stage0_bag_acc: 62.1142, stage0_mean_ious: 0.3586, stage0_s: 0.3133, stage0_m: 0.2659, stage0_l: 0.0205, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0792, stage1_bag_acc: 57.9657, stage1_neg_loss: 0.0233, stage1_mean_ious: 0.4399, stage1_s: 0.4114, stage1_m: 0.2751, stage1_l: 0.0196, stage1_h: 0.0000, loss: 0.4660, grad_norm: 10.5455
2024-10-15 23:46:08,234 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:38:21, time: 0.840, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.2361, stage0_bag_acc: 81.0222, stage0_mean_ious: 0.4110, stage0_s: 0.3692, stage0_m: 0.3402, stage0_l: 0.0134, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0647, stage1_bag_acc: 81.4143, stage1_neg_loss: 0.0189, stage1_mean_ious: 0.4968, stage1_s: 0.4766, stage1_m: 0.3537, stage1_l: 0.0084, stage1_h: 0.0000, loss: 0.3197, grad_norm: 12.3426
2024-10-15 23:46:52,435 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:38:03, time: 0.884, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.2162, stage0_bag_acc: 82.0949, stage0_mean_ious: 0.4273, stage0_s: 0.3728, stage0_m: 0.2917, stage0_l: 0.0218, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0780, stage1_bag_acc: 82.2646, stage1_neg_loss: 0.0171, stage1_mean_ious: 0.5314, stage1_s: 0.5024, stage1_m: 0.2951, stage1_l: 0.0233, stage1_h: 0.0000, loss: 0.3114, grad_norm: 11.7754
2024-10-15 23:47:18,755 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 23:48:07,041 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:35:35, time: 0.921, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.1800, stage0_bag_acc: 84.8238, stage0_mean_ious: 0.4447, stage0_s: 0.3809, stage0_m: 0.2875, stage0_l: 0.0165, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0457, stage1_bag_acc: 87.4762, stage1_neg_loss: 0.0167, stage1_mean_ious: 0.5404, stage1_s: 0.5020, stage1_m: 0.2821, stage1_l: 0.0115, stage1_h: 0.0000, loss: 0.2424, grad_norm: 10.1791
2024-10-15 23:48:49,500 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:35:11, time: 0.849, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1358, stage0_bag_acc: 90.6310, stage0_mean_ious: 0.4454, stage0_s: 0.4029, stage0_m: 0.2833, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0353, stage1_bag_acc: 90.8158, stage1_neg_loss: 0.0127, stage1_mean_ious: 0.5556, stage1_s: 0.5247, stage1_m: 0.3005, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1838, grad_norm: 7.5116
2024-10-15 23:49:32,235 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:34:46, time: 0.855, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1143, stage0_bag_acc: 91.5063, stage0_mean_ious: 0.4160, stage0_s: 0.3820, stage0_m: 0.2684, stage0_l: 0.0105, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0241, stage1_bag_acc: 93.5286, stage1_neg_loss: 0.0114, stage1_mean_ious: 0.5572, stage1_s: 0.5437, stage1_m: 0.3168, stage1_l: 0.0090, stage1_h: 0.0000, loss: 0.1499, grad_norm: 7.0838
2024-10-15 23:50:15,530 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:34:20, time: 0.866, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0899, stage0_bag_acc: 93.5188, stage0_mean_ious: 0.5112, stage0_s: 0.4395, stage0_m: 0.4285, stage0_l: 0.0168, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0251, stage1_bag_acc: 93.8734, stage1_neg_loss: 0.0120, stage1_mean_ious: 0.6018, stage1_s: 0.5665, stage1_m: 0.4353, stage1_l: 0.0123, stage1_h: 0.0000, loss: 0.1270, grad_norm: 6.3259
2024-10-15 23:50:57,531 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:33:48, time: 0.840, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.1300, stage0_bag_acc: 89.2514, stage0_mean_ious: 0.4750, stage0_s: 0.4378, stage0_m: 0.3109, stage0_l: 0.0229, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0342, stage1_bag_acc: 91.2203, stage1_neg_loss: 0.0094, stage1_mean_ious: 0.5692, stage1_s: 0.5547, stage1_m: 0.3153, stage1_l: 0.0197, stage1_h: 0.0000, loss: 0.1736, grad_norm: 6.9208
2024-10-15 23:51:24,493 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 23:52:44,972 - mmdet - INFO - Evaluating bbox...
2024-10-15 23:52:45,467 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2189
2024-10-15 23:52:45,467 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6812
2024-10-15 23:52:45,467 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4219
2024-10-15 23:52:45,467 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1519
2024-10-15 23:52:45,468 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0707
2024-10-15 23:52:45,468 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0263
2024-10-15 23:52:45,468 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 23:52:45,468 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 23:52:45,468 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2306
2024-10-15 23:52:45,468 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1084
2024-10-15 23:52:45,468 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3213
2024-10-15 23:52:45,468 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7699
2024-10-15 23:52:45,468 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3213
2024-10-15 23:52:45,469 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3213
2024-10-15 23:52:45,469 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 23:52:45,469 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3403
2024-10-15 23:52:45,469 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1143
2024-10-15 23:52:45,474 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 23:52:45,475 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2190, bbox_mAP_50: 0.6810, bbox_mAP_75: 0.4220, bbox_mAP_s: 0.1520, bbox_mAP_m: 0.0710, bbox_mAP_l: 0.0260, bbox_mAP_copypaste: 0.219 0.681 0.422 0.152 0.071 0.026
2024-10-15 23:53:32,219 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:31:57, time: 0.935, data_time: 0.060, memory: 7803, stage0_loss_instance_mil: 0.0842, stage0_bag_acc: 92.8188, stage0_mean_ious: 0.4977, stage0_s: 0.4351, stage0_m: 0.3545, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0226, stage1_bag_acc: 93.6801, stage1_neg_loss: 0.0112, stage1_mean_ious: 0.5984, stage1_s: 0.5662, stage1_m: 0.3544, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1180, grad_norm: 6.1170
2024-10-15 23:54:14,792 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:31:28, time: 0.852, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0874, stage0_bag_acc: 92.5667, stage0_mean_ious: 0.4691, stage0_s: 0.4241, stage0_m: 0.4026, stage0_l: 0.0214, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0331, stage1_bag_acc: 92.7333, stage1_neg_loss: 0.0138, stage1_mean_ious: 0.5659, stage1_s: 0.5513, stage1_m: 0.4070, stage1_l: 0.0186, stage1_h: 0.0000, loss: 0.1343, grad_norm: 7.0153
2024-10-15 23:54:47,002 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:30:33, time: 0.644, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0976, stage0_bag_acc: 93.3587, stage0_mean_ious: 0.4915, stage0_s: 0.4587, stage0_m: 0.3176, stage0_l: 0.0362, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0247, stage1_bag_acc: 93.5595, stage1_neg_loss: 0.0088, stage1_mean_ious: 0.5938, stage1_s: 0.5896, stage1_m: 0.3145, stage1_l: 0.0310, stage1_h: 0.0000, loss: 0.1311, grad_norm: 5.8877
2024-10-15 23:55:21,351 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:29:44, time: 0.687, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0758, stage0_bag_acc: 94.0667, stage0_mean_ious: 0.4380, stage0_s: 0.3895, stage0_m: 0.2882, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0243, stage1_bag_acc: 94.2111, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5549, stage1_s: 0.5331, stage1_m: 0.2894, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1081, grad_norm: 5.4713
2024-10-15 23:55:54,557 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:28:55, time: 0.664, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0590, stage0_bag_acc: 94.9869, stage0_mean_ious: 0.4774, stage0_s: 0.4414, stage0_m: 0.3150, stage0_l: 0.0067, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0165, stage1_bag_acc: 95.0354, stage1_neg_loss: 0.0070, stage1_mean_ious: 0.5813, stage1_s: 0.5689, stage1_m: 0.3211, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.0825, grad_norm: 4.4728
2024-10-15 23:56:13,822 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 23:56:52,488 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:27:08, time: 0.729, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0568, stage0_bag_acc: 94.4730, stage0_mean_ious: 0.4657, stage0_s: 0.4276, stage0_m: 0.3755, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0168, stage1_bag_acc: 95.8286, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5756, stage1_s: 0.5731, stage1_m: 0.3566, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.0797, grad_norm: 4.0479
2024-10-15 23:57:25,145 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:26:22, time: 0.653, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0658, stage0_bag_acc: 96.0515, stage0_mean_ious: 0.4749, stage0_s: 0.4433, stage0_m: 0.2475, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0153, stage1_bag_acc: 95.9848, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.5726, stage1_s: 0.5600, stage1_m: 0.2537, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.0883, grad_norm: 5.2981
2024-10-15 23:58:00,432 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:25:43, time: 0.706, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0801, stage0_bag_acc: 93.4792, stage0_mean_ious: 0.4830, stage0_s: 0.4342, stage0_m: 0.3644, stage0_l: 0.0144, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0195, stage1_bag_acc: 95.1530, stage1_neg_loss: 0.0100, stage1_mean_ious: 0.5758, stage1_s: 0.5626, stage1_m: 0.3657, stage1_l: 0.0115, stage1_h: 0.0000, loss: 0.1096, grad_norm: 5.5583
2024-10-15 23:58:36,566 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:25:05, time: 0.723, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0615, stage0_bag_acc: 95.5030, stage0_mean_ious: 0.4976, stage0_s: 0.4427, stage0_m: 0.3031, stage0_l: 0.0173, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0222, stage1_bag_acc: 94.5697, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.5772, stage1_s: 0.5590, stage1_m: 0.2977, stage1_l: 0.0106, stage1_h: 0.0000, loss: 0.0912, grad_norm: 4.9021
2024-10-15 23:59:18,300 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:24:35, time: 0.835, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0567, stage0_bag_acc: 96.0015, stage0_mean_ious: 0.4721, stage0_s: 0.4240, stage0_m: 0.3363, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0155, stage1_bag_acc: 96.0348, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5803, stage1_s: 0.5609, stage1_m: 0.3362, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0782, grad_norm: 4.0729
2024-10-15 23:59:44,786 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 00:00:33,108 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:23:19, time: 0.933, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.0300, stage0_bag_acc: 98.2500, stage0_mean_ious: 0.4839, stage0_s: 0.4431, stage0_m: 0.3117, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0127, stage1_bag_acc: 98.2000, stage1_neg_loss: 0.0078, stage1_mean_ious: 0.5781, stage1_s: 0.5671, stage1_m: 0.3219, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0505, grad_norm: 2.7746
2024-10-16 00:01:14,895 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:22:48, time: 0.836, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0251, stage0_bag_acc: 98.1143, stage0_mean_ious: 0.4807, stage0_s: 0.4500, stage0_m: 0.3275, stage0_l: 0.0263, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0162, stage1_bag_acc: 97.9348, stage1_neg_loss: 0.0106, stage1_mean_ious: 0.5778, stage1_s: 0.5909, stage1_m: 0.3001, stage1_l: 0.0207, stage1_h: 0.0000, loss: 0.0519, grad_norm: 3.9717
2024-10-16 00:01:56,083 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:17, time: 0.824, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0366, stage0_bag_acc: 96.7722, stage0_mean_ious: 0.4875, stage0_s: 0.4448, stage0_m: 0.3337, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0136, stage1_bag_acc: 97.8944, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.5800, stage1_s: 0.5480, stage1_m: 0.3430, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0569, grad_norm: 3.8196
2024-10-16 00:02:40,549 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:21:48, time: 0.889, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0481, stage0_bag_acc: 96.4833, stage0_mean_ious: 0.4972, stage0_s: 0.4433, stage0_m: 0.3093, stage0_l: 0.0129, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0147, stage1_bag_acc: 97.0333, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5948, stage1_s: 0.5695, stage1_m: 0.3015, stage1_l: 0.0159, stage1_h: 0.0000, loss: 0.0688, grad_norm: 3.7697
2024-10-16 00:03:23,663 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:17, time: 0.862, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0642, stage0_bag_acc: 93.8429, stage0_mean_ious: 0.4696, stage0_s: 0.4194, stage0_m: 0.3306, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 94.2905, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5674, stage1_s: 0.5511, stage1_m: 0.3484, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0901, grad_norm: 4.6495
2024-10-16 00:03:48,729 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 00:05:07,788 - mmdet - INFO - Evaluating bbox...
2024-10-16 00:05:08,352 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2283
2024-10-16 00:05:08,352 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6916
2024-10-16 00:05:08,352 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4397
2024-10-16 00:05:08,352 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1652
2024-10-16 00:05:08,352 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0786
2024-10-16 00:05:08,353 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0286
2024-10-16 00:05:08,353 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0012
2024-10-16 00:05:08,353 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 00:05:08,353 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2396
2024-10-16 00:05:08,353 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0920
2024-10-16 00:05:08,353 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3331
2024-10-16 00:05:08,353 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7880
2024-10-16 00:05:08,353 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3331
2024-10-16 00:05:08,353 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3331
2024-10-16 00:05:08,353 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 00:05:08,353 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3524
2024-10-16 00:05:08,354 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1091
2024-10-16 00:05:08,359 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 00:05:08,359 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2280, bbox_mAP_50: 0.6920, bbox_mAP_75: 0.4400, bbox_mAP_s: 0.1650, bbox_mAP_m: 0.0790, bbox_mAP_l: 0.0290, bbox_mAP_copypaste: 0.228 0.692 0.440 0.165 0.079 0.029
2024-10-16 00:05:54,687 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:20:05, time: 0.926, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0453, stage0_bag_acc: 96.8643, stage0_mean_ious: 0.4887, stage0_s: 0.4220, stage0_m: 0.3492, stage0_l: 0.0113, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0153, stage1_bag_acc: 97.2500, stage1_neg_loss: 0.0108, stage1_mean_ious: 0.5936, stage1_s: 0.5516, stage1_m: 0.3878, stage1_l: 0.0147, stage1_h: 0.0000, loss: 0.0714, grad_norm: 3.7944
2024-10-16 00:06:36,757 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:19:32, time: 0.842, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0372, stage0_bag_acc: 98.0667, stage0_mean_ious: 0.5180, stage0_s: 0.4687, stage0_m: 0.3389, stage0_l: 0.0148, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0169, stage1_bag_acc: 98.3500, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5986, stage1_s: 0.5830, stage1_m: 0.3319, stage1_l: 0.0135, stage1_h: 0.0000, loss: 0.0593, grad_norm: 3.1245
2024-10-16 00:07:19,708 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:19:00, time: 0.859, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0518, stage0_bag_acc: 97.5333, stage0_mean_ious: 0.4862, stage0_s: 0.4420, stage0_m: 0.3378, stage0_l: 0.0105, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0197, stage1_bag_acc: 97.0833, stage1_neg_loss: 0.0111, stage1_mean_ious: 0.5819, stage1_s: 0.5740, stage1_m: 0.3370, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.0825, grad_norm: 4.5978
2024-10-16 00:08:01,041 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:26, time: 0.827, data_time: 0.011, memory: 7803, stage0_loss_instance_mil: 0.0493, stage0_bag_acc: 96.2500, stage0_mean_ious: 0.4628, stage0_s: 0.4308, stage0_m: 0.3363, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0101, stage1_bag_acc: 97.1500, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5667, stage1_s: 0.5561, stage1_m: 0.3427, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0638, grad_norm: 2.9446
2024-10-16 00:08:40,288 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:17:50, time: 0.785, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0360, stage0_bag_acc: 97.5626, stage0_mean_ious: 0.4749, stage0_s: 0.4330, stage0_m: 0.2680, stage0_l: 0.0197, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0155, stage1_bag_acc: 96.2460, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5573, stage1_s: 0.5512, stage1_m: 0.2545, stage1_l: 0.0133, stage1_h: 0.0000, loss: 0.0564, grad_norm: 2.9679
2024-10-16 00:09:06,482 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 00:09:51,022 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:38, time: 0.844, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0442, stage0_bag_acc: 97.4293, stage0_mean_ious: 0.4621, stage0_s: 0.4436, stage0_m: 0.2669, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 97.1793, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5657, stage1_s: 0.5638, stage1_m: 0.2603, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.0606, grad_norm: 3.5097
2024-10-16 00:10:33,957 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:16:05, time: 0.859, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0239, stage0_bag_acc: 97.9697, stage0_mean_ious: 0.5067, stage0_s: 0.4443, stage0_m: 0.3375, stage0_l: 0.0172, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 97.9697, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5826, stage1_s: 0.5520, stage1_m: 0.3147, stage1_l: 0.0095, stage1_h: 0.0000, loss: 0.0340, grad_norm: 2.0677
2024-10-16 00:11:15,299 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:30, time: 0.827, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0262, stage0_bag_acc: 97.4500, stage0_mean_ious: 0.4958, stage0_s: 0.4741, stage0_m: 0.3111, stage0_l: 0.0092, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0113, stage1_bag_acc: 98.3500, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5795, stage1_s: 0.5688, stage1_m: 0.3147, stage1_l: 0.0092, stage1_h: 0.0000, loss: 0.0410, grad_norm: 2.6944
2024-10-16 00:11:57,625 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:14:56, time: 0.846, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0324, stage0_bag_acc: 97.9833, stage0_mean_ious: 0.4861, stage0_s: 0.4356, stage0_m: 0.2702, stage0_l: 0.0115, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0142, stage1_bag_acc: 98.0333, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.5922, stage1_s: 0.5662, stage1_m: 0.2707, stage1_l: 0.0079, stage1_h: 0.0000, loss: 0.0540, grad_norm: 4.0481
2024-10-16 00:12:37,507 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:20, time: 0.798, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0572, stage0_bag_acc: 96.8419, stage0_mean_ious: 0.4979, stage0_s: 0.4669, stage0_m: 0.2897, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0154, stage1_bag_acc: 96.9323, stage1_neg_loss: 0.0109, stage1_mean_ious: 0.6028, stage1_s: 0.5952, stage1_m: 0.3006, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0834, grad_norm: 4.2503
2024-10-16 00:13:02,963 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 00:13:40,039 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:08, time: 0.697, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0343, stage0_bag_acc: 98.3182, stage0_mean_ious: 0.4797, stage0_s: 0.4364, stage0_m: 0.2965, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0174, stage1_bag_acc: 98.0182, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5730, stage1_s: 0.5423, stage1_m: 0.3230, stage1_l: 0.0083, stage1_h: 0.0000, loss: 0.0574, grad_norm: 3.5732
2024-10-16 00:14:13,807 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:30, time: 0.675, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0383, stage0_bag_acc: 97.1500, stage0_mean_ious: 0.4908, stage0_s: 0.4477, stage0_m: 0.3625, stage0_l: 0.0177, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 96.8000, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5778, stage1_s: 0.5845, stage1_m: 0.3652, stage1_l: 0.0113, stage1_h: 0.0000, loss: 0.0515, grad_norm: 2.6724
2024-10-16 00:14:47,414 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:11:52, time: 0.672, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0254, stage0_bag_acc: 97.9167, stage0_mean_ious: 0.4829, stage0_s: 0.4220, stage0_m: 0.3442, stage0_l: 0.0176, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0122, stage1_bag_acc: 98.1000, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5803, stage1_s: 0.5550, stage1_m: 0.3275, stage1_l: 0.0173, stage1_h: 0.0000, loss: 0.0421, grad_norm: 2.6955
2024-10-16 00:15:21,158 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:14, time: 0.675, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0204, stage0_bag_acc: 98.3500, stage0_mean_ious: 0.5183, stage0_s: 0.4639, stage0_m: 0.4184, stage0_l: 0.0110, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 98.8500, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5905, stage1_s: 0.5900, stage1_m: 0.4001, stage1_l: 0.0099, stage1_h: 0.0000, loss: 0.0310, grad_norm: 2.1780
