2024-10-15 10:39:25,992 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+d7eacca
------------------------------------------------------------

2024-10-15 10:39:26,946 - mmdet - INFO - Distributed training: False
2024-10-15 10:39:27,833 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 10:39:30,916 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 10:39:30,917 - mmdet - INFO - Use load_from_local loader
2024-10-15 10:39:31,220 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 10:39:31,237 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 10:39:31,237 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 10:40:00,818 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:32:37, time: 0.592, data_time: 0.057, memory: 7774, stage0_loss_instance_mil: 0.7208, stage0_bag_acc: 12.6312, stage0_mean_ious: 0.0717, stage0_s: 0.0506, stage0_m: 0.0737, stage0_l: 0.0046, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1679, stage1_bag_acc: 24.6551, stage1_neg_loss: 0.0004, stage1_mean_ious: 0.0808, stage1_s: 0.0558, stage1_m: 0.0891, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.8892, grad_norm: 5.8391
2024-10-15 10:40:25,835 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:29:39, time: 0.500, data_time: 0.008, memory: 7774, stage0_loss_instance_mil: 0.7004, stage0_bag_acc: 12.8786, stage0_mean_ious: 0.0773, stage0_s: 0.0740, stage0_m: 0.0617, stage0_l: 0.0109, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1720, stage1_bag_acc: 19.4786, stage1_neg_loss: 0.0006, stage1_mean_ious: 0.0854, stage1_s: 0.0812, stage1_m: 0.0667, stage1_l: 0.0126, stage1_h: 0.0000, loss: 0.8730, grad_norm: 5.4425
2024-10-15 10:40:51,886 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:28:45, time: 0.521, data_time: 0.008, memory: 7774, stage0_loss_instance_mil: 0.6761, stage0_bag_acc: 22.8795, stage0_mean_ious: 0.0853, stage0_s: 0.0822, stage0_m: 0.0636, stage0_l: 0.0195, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1762, stage1_bag_acc: 18.5530, stage1_neg_loss: 0.0015, stage1_mean_ious: 0.0988, stage1_s: 0.0956, stage1_m: 0.0723, stage1_l: 0.0232, stage1_h: 0.0000, loss: 0.8538, grad_norm: 6.6094
2024-10-15 10:41:17,261 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:27:55, time: 0.507, data_time: 0.009, memory: 7774, stage0_loss_instance_mil: 0.6302, stage0_bag_acc: 31.2286, stage0_mean_ious: 0.1621, stage0_s: 0.1232, stage0_m: 0.1529, stage0_l: 0.0041, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1652, stage1_bag_acc: 32.8087, stage1_neg_loss: 0.0125, stage1_mean_ious: 0.1891, stage1_s: 0.1465, stage1_m: 0.1675, stage1_l: 0.0041, stage1_h: 0.0000, loss: 0.8079, grad_norm: 8.5066
2024-10-15 10:41:43,550 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:27:25, time: 0.526, data_time: 0.008, memory: 7783, stage0_loss_instance_mil: 0.5797, stage0_bag_acc: 33.8020, stage0_mean_ious: 0.1852, stage0_s: 0.1494, stage0_m: 0.1445, stage0_l: 0.0124, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1389, stage1_bag_acc: 32.3202, stage1_neg_loss: 0.0188, stage1_mean_ious: 0.2211, stage1_s: 0.1826, stage1_m: 0.1665, stage1_l: 0.0121, stage1_h: 0.0000, loss: 0.7374, grad_norm: 9.1718
2024-10-15 10:41:58,781 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 10:42:29,192 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:24:32, time: 0.561, data_time: 0.056, memory: 7783, stage0_loss_instance_mil: 0.5540, stage0_bag_acc: 38.8579, stage0_mean_ious: 0.2798, stage0_s: 0.2137, stage0_m: 0.2715, stage0_l: 0.0116, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0922, stage1_bag_acc: 45.4589, stage1_neg_loss: 0.0189, stage1_mean_ious: 0.3499, stage1_s: 0.2766, stage1_m: 0.3294, stage1_l: 0.0061, stage1_h: 0.0000, loss: 0.6651, grad_norm: 9.9939
2024-10-15 10:42:54,324 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:24:14, time: 0.503, data_time: 0.008, memory: 7783, stage0_loss_instance_mil: 0.4499, stage0_bag_acc: 53.6317, stage0_mean_ious: 0.3283, stage0_s: 0.2685, stage0_m: 0.2279, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0832, stage1_bag_acc: 54.4016, stage1_neg_loss: 0.0177, stage1_mean_ious: 0.4332, stage1_s: 0.3923, stage1_m: 0.2564, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5507, grad_norm: 11.5520
2024-10-15 10:43:18,843 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:23:51, time: 0.490, data_time: 0.008, memory: 7783, stage0_loss_instance_mil: 0.3222, stage0_bag_acc: 72.4702, stage0_mean_ious: 0.3912, stage0_s: 0.3300, stage0_m: 0.2607, stage0_l: 0.0107, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0917, stage1_bag_acc: 71.5022, stage1_neg_loss: 0.0263, stage1_mean_ious: 0.5021, stage1_s: 0.4685, stage1_m: 0.2654, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.4402, grad_norm: 12.1734
2024-10-15 10:43:44,894 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:23:36, time: 0.521, data_time: 0.009, memory: 7783, stage0_loss_instance_mil: 0.2617, stage0_bag_acc: 79.1980, stage0_mean_ious: 0.3587, stage0_s: 0.3191, stage0_m: 0.2783, stage0_l: 0.0221, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0882, stage1_bag_acc: 78.8687, stage1_neg_loss: 0.0205, stage1_mean_ious: 0.4652, stage1_s: 0.4566, stage1_m: 0.2773, stage1_l: 0.0142, stage1_h: 0.0000, loss: 0.3705, grad_norm: 11.3972
2024-10-15 10:44:10,185 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:23:15, time: 0.506, data_time: 0.008, memory: 7783, stage0_loss_instance_mil: 0.2030, stage0_bag_acc: 81.5085, stage0_mean_ious: 0.4502, stage0_s: 0.3987, stage0_m: 0.3021, stage0_l: 0.0275, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0546, stage1_bag_acc: 82.8855, stage1_neg_loss: 0.0172, stage1_mean_ious: 0.5467, stage1_s: 0.5161, stage1_m: 0.3171, stage1_l: 0.0198, stage1_h: 0.0000, loss: 0.2747, grad_norm: 9.5933
2024-10-15 10:44:24,844 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 10:44:54,532 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:21:41, time: 0.549, data_time: 0.056, memory: 7783, stage0_loss_instance_mil: 0.1618, stage0_bag_acc: 87.6013, stage0_mean_ious: 0.4594, stage0_s: 0.4130, stage0_m: 0.3502, stage0_l: 0.0218, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0435, stage1_bag_acc: 87.4013, stage1_neg_loss: 0.0117, stage1_mean_ious: 0.5504, stage1_s: 0.5408, stage1_m: 0.3234, stage1_l: 0.0158, stage1_h: 0.0000, loss: 0.2170, grad_norm: 8.4824
2024-10-15 10:45:19,025 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:21:21, time: 0.490, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.2044, stage0_bag_acc: 84.5015, stage0_mean_ious: 0.4323, stage0_s: 0.3872, stage0_m: 0.2626, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0373, stage1_bag_acc: 86.1101, stage1_neg_loss: 0.0095, stage1_mean_ious: 0.5359, stage1_s: 0.5021, stage1_m: 0.2748, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2512, grad_norm: 8.1981
2024-10-15 10:45:45,054 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:21:06, time: 0.521, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0977, stage0_bag_acc: 91.0134, stage0_mean_ious: 0.4720, stage0_s: 0.4390, stage0_m: 0.3809, stage0_l: 0.0178, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0312, stage1_bag_acc: 93.0325, stage1_neg_loss: 0.0163, stage1_mean_ious: 0.5803, stage1_s: 0.5764, stage1_m: 0.4119, stage1_l: 0.0116, stage1_h: 0.0000, loss: 0.1452, grad_norm: 6.2721
2024-10-15 10:46:10,223 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:20:46, time: 0.503, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.1473, stage0_bag_acc: 89.2375, stage0_mean_ious: 0.4744, stage0_s: 0.4110, stage0_m: 0.3081, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0306, stage1_bag_acc: 88.3500, stage1_neg_loss: 0.0095, stage1_mean_ious: 0.5548, stage1_s: 0.5248, stage1_m: 0.2995, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1874, grad_norm: 7.1686
2024-10-15 10:46:35,022 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:20:25, time: 0.496, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0817, stage0_bag_acc: 93.2452, stage0_mean_ious: 0.4718, stage0_s: 0.4125, stage0_m: 0.3179, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0203, stage1_bag_acc: 94.2452, stage1_neg_loss: 0.0087, stage1_mean_ious: 0.5681, stage1_s: 0.5388, stage1_m: 0.3128, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1107, grad_norm: 5.6733
2024-10-15 10:46:50,346 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 10:48:07,438 - mmdet - INFO - Evaluating bbox...
2024-10-15 10:48:08,016 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2112
2024-10-15 10:48:08,016 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6509
2024-10-15 10:48:08,016 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3968
2024-10-15 10:48:08,016 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1529
2024-10-15 10:48:08,016 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0798
2024-10-15 10:48:08,016 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0318
2024-10-15 10:48:08,016 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-15 10:48:08,016 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 10:48:08,017 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2230
2024-10-15 10:48:08,017 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0577
2024-10-15 10:48:08,017 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3083
2024-10-15 10:48:08,017 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7476
2024-10-15 10:48:08,017 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3083
2024-10-15 10:48:08,017 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3083
2024-10-15 10:48:08,017 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 10:48:08,017 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3280
2024-10-15 10:48:08,017 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0811
2024-10-15 10:48:08,024 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 10:48:08,024 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2110, bbox_mAP_50: 0.6510, bbox_mAP_75: 0.3970, bbox_mAP_s: 0.1530, bbox_mAP_m: 0.0800, bbox_mAP_l: 0.0320, bbox_mAP_copypaste: 0.211 0.651 0.397 0.153 0.080 0.032
2024-10-15 10:48:35,629 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:19:16, time: 0.552, data_time: 0.056, memory: 7786, stage0_loss_instance_mil: 0.0862, stage0_bag_acc: 93.1942, stage0_mean_ious: 0.4884, stage0_s: 0.4445, stage0_m: 0.4017, stage0_l: 0.0063, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0234, stage1_bag_acc: 93.8228, stage1_neg_loss: 0.0097, stage1_mean_ious: 0.5636, stage1_s: 0.5563, stage1_m: 0.3701, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.1194, grad_norm: 5.5590
2024-10-15 10:49:00,619 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:18:57, time: 0.500, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0773, stage0_bag_acc: 94.0840, stage0_mean_ious: 0.4781, stage0_s: 0.4335, stage0_m: 0.3453, stage0_l: 0.0119, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0286, stage1_bag_acc: 93.9158, stage1_neg_loss: 0.0091, stage1_mean_ious: 0.5511, stage1_s: 0.5424, stage1_m: 0.3239, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.1149, grad_norm: 5.0661
2024-10-15 10:49:25,362 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:18:37, time: 0.495, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0771, stage0_bag_acc: 92.6188, stage0_mean_ious: 0.4798, stage0_s: 0.4332, stage0_m: 0.3317, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0193, stage1_bag_acc: 94.0506, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5750, stage1_s: 0.5637, stage1_m: 0.3286, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.1010, grad_norm: 4.6187
2024-10-15 10:49:49,740 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:18:15, time: 0.488, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0749, stage0_bag_acc: 94.6333, stage0_mean_ious: 0.4892, stage0_s: 0.4453, stage0_m: 0.3361, stage0_l: 0.0223, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0159, stage1_bag_acc: 94.0500, stage1_neg_loss: 0.0082, stage1_mean_ious: 0.5889, stage1_s: 0.5719, stage1_m: 0.3391, stage1_l: 0.0221, stage1_h: 0.0000, loss: 0.0990, grad_norm: 5.3214
2024-10-15 10:50:14,265 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:17:53, time: 0.490, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0717, stage0_bag_acc: 94.6848, stage0_mean_ious: 0.5060, stage0_s: 0.4590, stage0_m: 0.3766, stage0_l: 0.0132, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 94.7348, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5787, stage1_s: 0.5690, stage1_m: 0.3453, stage1_l: 0.0160, stage1_h: 0.0000, loss: 0.0991, grad_norm: 4.9752
2024-10-15 10:50:29,737 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 10:50:59,819 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:16:57, time: 0.558, data_time: 0.056, memory: 7786, stage0_loss_instance_mil: 0.0753, stage0_bag_acc: 94.2816, stage0_mean_ious: 0.5090, stage0_s: 0.4327, stage0_m: 0.3609, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0137, stage1_bag_acc: 94.5649, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5778, stage1_s: 0.5318, stage1_m: 0.3380, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0951, grad_norm: 5.3534
2024-10-15 10:51:24,965 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:16:37, time: 0.503, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0553, stage0_bag_acc: 96.5047, stage0_mean_ious: 0.4770, stage0_s: 0.4321, stage0_m: 0.3701, stage0_l: 0.0116, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0174, stage1_bag_acc: 96.2865, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5746, stage1_s: 0.5747, stage1_m: 0.3528, stage1_l: 0.0069, stage1_h: 0.0000, loss: 0.0786, grad_norm: 4.5582
2024-10-15 10:51:49,892 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:16:16, time: 0.499, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0614, stage0_bag_acc: 96.0643, stage0_mean_ious: 0.4948, stage0_s: 0.4551, stage0_m: 0.4072, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0144, stage1_bag_acc: 95.6619, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.5787, stage1_s: 0.5660, stage1_m: 0.4080, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0825, grad_norm: 4.0552
2024-10-15 10:52:14,462 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:15:55, time: 0.491, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0653, stage0_bag_acc: 94.8173, stage0_mean_ious: 0.4778, stage0_s: 0.4308, stage0_m: 0.3420, stage0_l: 0.0092, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0220, stage1_bag_acc: 95.0816, stage1_neg_loss: 0.0092, stage1_mean_ious: 0.5601, stage1_s: 0.5323, stage1_m: 0.3298, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.0964, grad_norm: 4.5531
2024-10-15 10:52:39,185 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:15:33, time: 0.494, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0343, stage0_bag_acc: 97.3333, stage0_mean_ious: 0.4998, stage0_s: 0.4532, stage0_m: 0.3280, stage0_l: 0.0136, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0114, stage1_bag_acc: 97.2333, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5903, stage1_s: 0.5667, stage1_m: 0.3374, stage1_l: 0.0166, stage1_h: 0.0000, loss: 0.0508, grad_norm: 3.1444
2024-10-15 10:52:54,540 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 10:53:24,598 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:14:43, time: 0.556, data_time: 0.056, memory: 7786, stage0_loss_instance_mil: 0.0407, stage0_bag_acc: 96.0786, stage0_mean_ious: 0.4916, stage0_s: 0.4229, stage0_m: 0.3600, stage0_l: 0.0096, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0155, stage1_bag_acc: 96.8929, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5772, stage1_s: 0.5426, stage1_m: 0.3354, stage1_l: 0.0069, stage1_h: 0.0000, loss: 0.0643, grad_norm: 3.2545
2024-10-15 10:53:48,377 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:14:21, time: 0.476, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0459, stage0_bag_acc: 95.9182, stage0_mean_ious: 0.5095, stage0_s: 0.4752, stage0_m: 0.3330, stage0_l: 0.0190, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0125, stage1_bag_acc: 96.4000, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5876, stage1_s: 0.5927, stage1_m: 0.3195, stage1_l: 0.0182, stage1_h: 0.0000, loss: 0.0628, grad_norm: 3.4881
2024-10-15 10:54:13,787 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:14:00, time: 0.508, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0518, stage0_bag_acc: 95.7810, stage0_mean_ious: 0.5077, stage0_s: 0.4497, stage0_m: 0.3818, stage0_l: 0.0177, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0148, stage1_bag_acc: 95.8310, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5940, stage1_s: 0.5715, stage1_m: 0.3711, stage1_l: 0.0168, stage1_h: 0.0000, loss: 0.0716, grad_norm: 4.1417
2024-10-15 10:54:39,165 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:13:39, time: 0.508, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0457, stage0_bag_acc: 96.9167, stage0_mean_ious: 0.4836, stage0_s: 0.4480, stage0_m: 0.3488, stage0_l: 0.0315, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0121, stage1_bag_acc: 96.9667, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5892, stage1_s: 0.5949, stage1_m: 0.3186, stage1_l: 0.0190, stage1_h: 0.0000, loss: 0.0631, grad_norm: 3.3443
2024-10-15 10:55:04,674 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:13:18, time: 0.510, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0252, stage0_bag_acc: 98.3556, stage0_mean_ious: 0.4905, stage0_s: 0.4544, stage0_m: 0.3719, stage0_l: 0.0064, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0157, stage1_bag_acc: 98.1056, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5634, stage1_s: 0.5638, stage1_m: 0.3751, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.0466, grad_norm: 2.9288
2024-10-15 10:55:20,598 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 10:56:37,489 - mmdet - INFO - Evaluating bbox...
2024-10-15 10:56:38,044 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2122
2024-10-15 10:56:38,044 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6606
2024-10-15 10:56:38,044 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4027
2024-10-15 10:56:38,044 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1487
2024-10-15 10:56:38,044 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0772
2024-10-15 10:56:38,044 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0293
2024-10-15 10:56:38,044 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-15 10:56:38,044 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 10:56:38,045 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2244
2024-10-15 10:56:38,045 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0511
2024-10-15 10:56:38,045 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3100
2024-10-15 10:56:38,045 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7621
2024-10-15 10:56:38,045 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3100
2024-10-15 10:56:38,045 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3100
2024-10-15 10:56:38,045 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 10:56:38,045 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3298
2024-10-15 10:56:38,045 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0797
2024-10-15 10:56:38,051 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 10:56:38,051 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2120, bbox_mAP_50: 0.6610, bbox_mAP_75: 0.4030, bbox_mAP_s: 0.1490, bbox_mAP_m: 0.0770, bbox_mAP_l: 0.0290, bbox_mAP_copypaste: 0.212 0.661 0.403 0.149 0.077 0.029
2024-10-15 10:57:05,142 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:12:31, time: 0.542, data_time: 0.056, memory: 7786, stage0_loss_instance_mil: 0.0333, stage0_bag_acc: 97.9667, stage0_mean_ious: 0.5240, stage0_s: 0.4905, stage0_m: 0.3655, stage0_l: 0.0227, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0111, stage1_bag_acc: 97.5444, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.6090, stage1_s: 0.6010, stage1_m: 0.3672, stage1_l: 0.0225, stage1_h: 0.0000, loss: 0.0506, grad_norm: 3.5702
2024-10-15 10:57:30,713 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:12:10, time: 0.511, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0382, stage0_bag_acc: 96.4762, stage0_mean_ious: 0.4773, stage0_s: 0.4246, stage0_m: 0.3597, stage0_l: 0.0291, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0123, stage1_bag_acc: 97.4619, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5771, stage1_s: 0.5474, stage1_m: 0.3626, stage1_l: 0.0223, stage1_h: 0.0000, loss: 0.0532, grad_norm: 3.1057
2024-10-15 10:57:56,613 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:11:50, time: 0.518, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0425, stage0_bag_acc: 96.2000, stage0_mean_ious: 0.4820, stage0_s: 0.4106, stage0_m: 0.3654, stage0_l: 0.0065, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0111, stage1_bag_acc: 96.4500, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5759, stage1_s: 0.5412, stage1_m: 0.3801, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.0573, grad_norm: 3.7061
2024-10-15 10:58:22,854 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:11:29, time: 0.525, data_time: 0.009, memory: 7786, stage0_loss_instance_mil: 0.0317, stage0_bag_acc: 97.7348, stage0_mean_ious: 0.5256, stage0_s: 0.4764, stage0_m: 0.3688, stage0_l: 0.0208, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0077, stage1_bag_acc: 97.4667, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5864, stage1_s: 0.5705, stage1_m: 0.3461, stage1_l: 0.0133, stage1_h: 0.0000, loss: 0.0431, grad_norm: 2.4749
2024-10-15 10:58:47,896 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:11:07, time: 0.501, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0370, stage0_bag_acc: 97.7500, stage0_mean_ious: 0.5011, stage0_s: 0.4772, stage0_m: 0.3227, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0123, stage1_bag_acc: 97.4333, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5953, stage1_s: 0.5970, stage1_m: 0.3151, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0541, grad_norm: 3.1893
2024-10-15 10:59:03,095 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 10:59:32,150 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:10:23, time: 0.547, data_time: 0.055, memory: 7786, stage0_loss_instance_mil: 0.0295, stage0_bag_acc: 98.1421, stage0_mean_ious: 0.4981, stage0_s: 0.4439, stage0_m: 0.3422, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0096, stage1_bag_acc: 97.8063, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5989, stage1_s: 0.5680, stage1_m: 0.3415, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0450, grad_norm: 2.3868
2024-10-15 10:59:57,159 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:10:01, time: 0.500, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0420, stage0_bag_acc: 97.2000, stage0_mean_ious: 0.5026, stage0_s: 0.4410, stage0_m: 0.4042, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0118, stage1_bag_acc: 96.5500, stage1_neg_loss: 0.0079, stage1_mean_ious: 0.5781, stage1_s: 0.5487, stage1_m: 0.4061, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0618, grad_norm: 3.1879
2024-10-15 11:00:22,309 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:09:39, time: 0.503, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0616, stage0_bag_acc: 97.0500, stage0_mean_ious: 0.4992, stage0_s: 0.4436, stage0_m: 0.3583, stage0_l: 0.0076, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0144, stage1_bag_acc: 96.4667, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5742, stage1_s: 0.5630, stage1_m: 0.3298, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.0795, grad_norm: 4.2839
2024-10-15 11:00:47,373 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:09:17, time: 0.501, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0364, stage0_bag_acc: 96.5611, stage0_mean_ious: 0.5157, stage0_s: 0.4621, stage0_m: 0.3379, stage0_l: 0.0220, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0135, stage1_bag_acc: 96.7111, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.6061, stage1_s: 0.5825, stage1_m: 0.3326, stage1_l: 0.0196, stage1_h: 0.0000, loss: 0.0584, grad_norm: 3.6099
2024-10-15 11:01:11,926 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:08:54, time: 0.491, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0295, stage0_bag_acc: 98.2000, stage0_mean_ious: 0.4959, stage0_s: 0.4507, stage0_m: 0.3599, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0162, stage1_bag_acc: 97.0000, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5917, stage1_s: 0.5909, stage1_m: 0.3470, stage1_l: 0.0090, stage1_h: 0.0000, loss: 0.0508, grad_norm: 2.9873
2024-10-15 11:01:27,205 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 11:01:57,316 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:08:13, time: 0.558, data_time: 0.057, memory: 7786, stage0_loss_instance_mil: 0.0164, stage0_bag_acc: 98.6000, stage0_mean_ious: 0.5203, stage0_s: 0.4760, stage0_m: 0.3769, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0056, stage1_bag_acc: 98.4000, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.6051, stage1_s: 0.5921, stage1_m: 0.3627, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0282, grad_norm: 2.0444
2024-10-15 11:02:22,059 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:07:50, time: 0.495, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0155, stage0_bag_acc: 98.9310, stage0_mean_ious: 0.4938, stage0_s: 0.4606, stage0_m: 0.3328, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0119, stage1_bag_acc: 98.8833, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5779, stage1_s: 0.5744, stage1_m: 0.3264, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0292, grad_norm: 1.9139
2024-10-15 11:02:46,441 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:07:28, time: 0.488, data_time: 0.007, memory: 7786, stage0_loss_instance_mil: 0.0176, stage0_bag_acc: 98.9278, stage0_mean_ious: 0.5026, stage0_s: 0.4680, stage0_m: 0.3156, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0062, stage1_bag_acc: 98.2278, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5925, stage1_s: 0.5805, stage1_m: 0.3070, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0264, grad_norm: 1.8485
2024-10-15 11:03:11,921 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:07:06, time: 0.510, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0090, stage0_bag_acc: 99.3682, stage0_mean_ious: 0.5429, stage0_s: 0.4944, stage0_m: 0.4309, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0055, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.6036, stage1_s: 0.5972, stage1_m: 0.4116, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0182, grad_norm: 1.6552
2024-10-15 11:03:36,709 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:06:43, time: 0.496, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0271, stage0_bag_acc: 98.1667, stage0_mean_ious: 0.4798, stage0_s: 0.4470, stage0_m: 0.3180, stage0_l: 0.0070, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 98.3667, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5624, stage1_s: 0.5503, stage1_m: 0.3193, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.0387, grad_norm: 2.5039
2024-10-15 11:03:51,999 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 11:05:08,093 - mmdet - INFO - Evaluating bbox...
2024-10-15 11:05:08,573 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2110
2024-10-15 11:05:08,574 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6665
2024-10-15 11:05:08,574 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3986
2024-10-15 11:05:08,574 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1433
2024-10-15 11:05:08,574 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0772
2024-10-15 11:05:08,574 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0271
2024-10-15 11:05:08,574 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-10-15 11:05:08,574 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:05:08,574 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2222
2024-10-15 11:05:08,574 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0565
2024-10-15 11:05:08,574 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3148
2024-10-15 11:05:08,575 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7715
2024-10-15 11:05:08,575 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3148
2024-10-15 11:05:08,575 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3148
2024-10-15 11:05:08,575 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:05:08,575 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3340
2024-10-15 11:05:08,575 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0830
2024-10-15 11:05:08,580 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 11:05:08,580 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2110, bbox_mAP_50: 0.6660, bbox_mAP_75: 0.3990, bbox_mAP_s: 0.1430, bbox_mAP_m: 0.0770, bbox_mAP_l: 0.0270, bbox_mAP_copypaste: 0.211 0.666 0.399 0.143 0.077 0.027
2024-10-15 11:05:35,443 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:06:03, time: 0.537, data_time: 0.057, memory: 7786, stage0_loss_instance_mil: 0.0216, stage0_bag_acc: 98.9182, stage0_mean_ious: 0.5239, stage0_s: 0.4912, stage0_m: 0.3343, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0099, stage1_bag_acc: 98.0325, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5842, stage1_s: 0.5777, stage1_m: 0.3130, stage1_l: 0.0047, stage1_h: 0.0000, loss: 0.0361, grad_norm: 2.2977
2024-10-15 11:06:00,348 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:05:40, time: 0.498, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0272, stage0_bag_acc: 98.0167, stage0_mean_ious: 0.4868, stage0_s: 0.4451, stage0_m: 0.3856, stage0_l: 0.0285, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0084, stage1_bag_acc: 97.7667, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5837, stage1_s: 0.5714, stage1_m: 0.3897, stage1_l: 0.0273, stage1_h: 0.0000, loss: 0.0387, grad_norm: 2.8274
2024-10-15 11:06:27,037 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:05:18, time: 0.534, data_time: 0.009, memory: 7786, stage0_loss_instance_mil: 0.0188, stage0_bag_acc: 98.1000, stage0_mean_ious: 0.5269, stage0_s: 0.4643, stage0_m: 0.4347, stage0_l: 0.0197, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0084, stage1_bag_acc: 97.9000, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5988, stage1_s: 0.5849, stage1_m: 0.4214, stage1_l: 0.0118, stage1_h: 0.0000, loss: 0.0324, grad_norm: 2.0808
2024-10-15 11:06:52,579 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:04:56, time: 0.511, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0121, stage0_bag_acc: 99.3143, stage0_mean_ious: 0.4970, stage0_s: 0.4704, stage0_m: 0.3365, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0080, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5824, stage1_s: 0.5747, stage1_m: 0.3286, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.0240, grad_norm: 1.5830
2024-10-15 11:07:16,736 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:04:33, time: 0.483, data_time: 0.007, memory: 7786, stage0_loss_instance_mil: 0.0086, stage0_bag_acc: 99.8000, stage0_mean_ious: 0.5131, stage0_s: 0.4576, stage0_m: 0.3692, stage0_l: 0.0131, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 99.6000, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5736, stage1_s: 0.5577, stage1_m: 0.3260, stage1_l: 0.0109, stage1_h: 0.0000, loss: 0.0241, grad_norm: 1.8948
2024-10-15 11:07:32,361 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 11:08:02,047 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:03:54, time: 0.548, data_time: 0.056, memory: 7786, stage0_loss_instance_mil: 0.0191, stage0_bag_acc: 98.6556, stage0_mean_ious: 0.5022, stage0_s: 0.4593, stage0_m: 0.3775, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0101, stage1_bag_acc: 98.5222, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.5743, stage1_s: 0.5642, stage1_m: 0.3607, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0325, grad_norm: 2.1497
2024-10-15 11:08:26,732 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:03:31, time: 0.494, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0194, stage0_bag_acc: 98.3491, stage0_mean_ious: 0.5002, stage0_s: 0.4448, stage0_m: 0.3475, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0049, stage1_bag_acc: 98.5491, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.5785, stage1_s: 0.5679, stage1_m: 0.3130, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0261, grad_norm: 1.9015
2024-10-15 11:08:52,057 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:03:09, time: 0.506, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0269, stage0_bag_acc: 98.1167, stage0_mean_ious: 0.4905, stage0_s: 0.4246, stage0_m: 0.3533, stage0_l: 0.0062, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0049, stage1_bag_acc: 97.8667, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.5774, stage1_s: 0.5371, stage1_m: 0.3699, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.0338, grad_norm: 2.5144
2024-10-15 11:09:17,805 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 11:09:17,806 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:02:46, time: 0.515, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0174, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.4936, stage0_s: 0.4381, stage0_m: 0.3366, stage0_l: 0.0192, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0069, stage1_bag_acc: 99.2000, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5866, stage1_s: 0.5637, stage1_m: 0.3393, stage1_l: 0.0124, stage1_h: 0.0000, loss: 0.0272, grad_norm: 1.9903
2024-10-15 11:09:42,985 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:02:23, time: 0.504, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0194, stage0_bag_acc: 98.7643, stage0_mean_ious: 0.5138, stage0_s: 0.4590, stage0_m: 0.3885, stage0_l: 0.0306, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0066, stage1_bag_acc: 98.3143, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.6029, stage1_s: 0.5838, stage1_m: 0.3852, stage1_l: 0.0271, stage1_h: 0.0000, loss: 0.0322, grad_norm: 1.9850
2024-10-15 11:09:58,450 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 11:10:28,357 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:01:45, time: 0.554, data_time: 0.057, memory: 7786, stage0_loss_instance_mil: 0.0155, stage0_bag_acc: 99.0643, stage0_mean_ious: 0.4812, stage0_s: 0.4214, stage0_m: 0.3679, stage0_l: 0.0129, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0099, stage1_bag_acc: 98.3000, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5694, stage1_s: 0.5474, stage1_m: 0.3549, stage1_l: 0.0127, stage1_h: 0.0000, loss: 0.0284, grad_norm: 2.1687
2024-10-15 11:10:54,591 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:01:22, time: 0.525, data_time: 0.009, memory: 7786, stage0_loss_instance_mil: 0.0181, stage0_bag_acc: 98.7722, stage0_mean_ious: 0.5112, stage0_s: 0.4625, stage0_m: 0.3946, stage0_l: 0.0252, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0045, stage1_bag_acc: 98.7722, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5771, stage1_s: 0.5801, stage1_m: 0.3850, stage1_l: 0.0201, stage1_h: 0.0000, loss: 0.0245, grad_norm: 1.6038
2024-10-15 11:11:18,878 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.486, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0135, stage0_bag_acc: 99.4167, stage0_mean_ious: 0.5201, stage0_s: 0.4771, stage0_m: 0.3859, stage0_l: 0.0173, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 98.6833, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5977, stage1_s: 0.5913, stage1_m: 0.3536, stage1_l: 0.0140, stage1_h: 0.0000, loss: 0.0231, grad_norm: 1.6175
2024-10-15 11:11:45,093 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:36, time: 0.524, data_time: 0.009, memory: 7786, stage0_loss_instance_mil: 0.0193, stage0_bag_acc: 98.8778, stage0_mean_ious: 0.5137, stage0_s: 0.4690, stage0_m: 0.3249, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0078, stage1_bag_acc: 98.8778, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5887, stage1_s: 0.5703, stage1_m: 0.3148, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0289, grad_norm: 1.8226
2024-10-15 11:12:10,804 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:13, time: 0.514, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0241, stage0_bag_acc: 98.9167, stage0_mean_ious: 0.5083, stage0_s: 0.4446, stage0_m: 0.3808, stage0_l: 0.0271, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0050, stage1_bag_acc: 98.5348, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5818, stage1_s: 0.5522, stage1_m: 0.3701, stage1_l: 0.0211, stage1_h: 0.0000, loss: 0.0325, grad_norm: 1.8662
2024-10-15 11:12:25,755 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 11:13:42,325 - mmdet - INFO - Evaluating bbox...
2024-10-15 11:13:42,893 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2097
2024-10-15 11:13:42,893 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6659
2024-10-15 11:13:42,893 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3938
2024-10-15 11:13:42,893 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1445
2024-10-15 11:13:42,893 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0727
2024-10-15 11:13:42,893 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0263
2024-10-15 11:13:42,893 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0013
2024-10-15 11:13:42,893 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:13:42,894 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2211
2024-10-15 11:13:42,894 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0590
2024-10-15 11:13:42,894 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3143
2024-10-15 11:13:42,894 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7712
2024-10-15 11:13:42,894 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3143
2024-10-15 11:13:42,894 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3143
2024-10-15 11:13:42,894 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:13:42,894 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3336
2024-10-15 11:13:42,894 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0832
2024-10-15 11:13:42,899 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 11:13:42,900 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2100, bbox_mAP_50: 0.6660, bbox_mAP_75: 0.3940, bbox_mAP_s: 0.1440, bbox_mAP_m: 0.0730, bbox_mAP_l: 0.0260, bbox_mAP_copypaste: 0.210 0.666 0.394 0.144 0.073 0.026
2024-10-15 11:14:57,613 - mmdet - INFO - Evaluating bbox...
2024-10-15 11:14:58,125 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2097
2024-10-15 11:14:58,125 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6659
2024-10-15 11:14:58,125 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3938
2024-10-15 11:14:58,125 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1445
2024-10-15 11:14:58,125 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0727
2024-10-15 11:14:58,125 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0263
2024-10-15 11:14:58,125 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0013
2024-10-15 11:14:58,125 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:14:58,126 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2211
2024-10-15 11:14:58,126 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0590
2024-10-15 11:14:58,126 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3143
2024-10-15 11:14:58,126 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7712
2024-10-15 11:14:58,126 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3143
2024-10-15 11:14:58,126 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3143
2024-10-15 11:14:58,126 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:14:58,126 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3336
2024-10-15 11:14:58,126 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0832
2024-10-15 11:14:59,379 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+d7eacca
------------------------------------------------------------

2024-10-15 11:15:00,247 - mmdet - INFO - Distributed training: False
2024-10-15 11:15:01,175 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 11:15:02,115 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 11:15:02,115 - mmdet - INFO - Use load_from_local loader
2024-10-15 11:15:02,383 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 11:15:02,396 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 11:15:02,396 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 11:15:29,838 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:30:16, time: 0.549, data_time: 0.056, memory: 7786, stage0_loss_instance_mil: 0.7216, stage0_bag_acc: 16.5844, stage0_mean_ious: 0.0545, stage0_s: 0.0436, stage0_m: 0.0374, stage0_l: 0.0008, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1589, stage1_bag_acc: 21.0969, stage1_neg_loss: 0.0011, stage1_mean_ious: 0.0593, stage1_s: 0.0471, stage1_m: 0.0423, stage1_l: 0.0006, stage1_h: 0.0000, loss: 0.8816, grad_norm: 5.8336
2024-10-15 11:15:55,227 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:28:42, time: 0.508, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.7100, stage0_bag_acc: 16.6861, stage0_mean_ious: 0.0630, stage0_s: 0.0471, stage0_m: 0.0565, stage0_l: 0.0015, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1630, stage1_bag_acc: 15.3504, stage1_neg_loss: 0.0015, stage1_mean_ious: 0.0699, stage1_s: 0.0517, stage1_m: 0.0651, stage1_l: 0.0014, stage1_h: 0.0000, loss: 0.8744, grad_norm: 5.6904
2024-10-15 11:16:19,314 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:27:25, time: 0.482, data_time: 0.007, memory: 7786, stage0_loss_instance_mil: 0.6857, stage0_bag_acc: 26.7865, stage0_mean_ious: 0.0895, stage0_s: 0.0753, stage0_m: 0.0751, stage0_l: 0.0134, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1694, stage1_bag_acc: 18.1286, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.0923, stage1_s: 0.0749, stage1_m: 0.0819, stage1_l: 0.0149, stage1_h: 0.0000, loss: 0.8578, grad_norm: 6.1900
2024-10-15 11:16:44,821 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:26:58, time: 0.510, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.6567, stage0_bag_acc: 26.2242, stage0_mean_ious: 0.1290, stage0_s: 0.0860, stage0_m: 0.1393, stage0_l: 0.0323, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1632, stage1_bag_acc: 18.1076, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.1369, stage1_s: 0.0962, stage1_m: 0.1446, stage1_l: 0.0301, stage1_h: 0.0000, loss: 0.8281, grad_norm: 8.4051
2024-10-15 11:17:10,342 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:26:31, time: 0.510, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.6053, stage0_bag_acc: 30.1338, stage0_mean_ious: 0.1728, stage0_s: 0.1279, stage0_m: 0.1740, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1299, stage1_bag_acc: 43.3099, stage1_neg_loss: 0.0220, stage1_mean_ious: 0.1993, stage1_s: 0.1514, stage1_m: 0.1958, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.7572, grad_norm: 9.2873
2024-10-15 11:17:25,846 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 11:17:55,172 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:23:43, time: 0.542, data_time: 0.056, memory: 7786, stage0_loss_instance_mil: 0.4890, stage0_bag_acc: 45.2413, stage0_mean_ious: 0.2895, stage0_s: 0.2521, stage0_m: 0.2461, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0982, stage1_bag_acc: 42.6184, stage1_neg_loss: 0.0195, stage1_mean_ious: 0.3543, stage1_s: 0.3188, stage1_m: 0.2870, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.6066, grad_norm: 11.0164
2024-10-15 11:18:20,980 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:23:38, time: 0.516, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.4208, stage0_bag_acc: 58.3784, stage0_mean_ious: 0.3127, stage0_s: 0.2525, stage0_m: 0.2973, stage0_l: 0.0104, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1041, stage1_bag_acc: 61.5934, stage1_neg_loss: 0.0160, stage1_mean_ious: 0.3849, stage1_s: 0.3358, stage1_m: 0.3159, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.5410, grad_norm: 10.8539
2024-10-15 11:18:44,950 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:23:15, time: 0.479, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.3103, stage0_bag_acc: 71.8091, stage0_mean_ious: 0.3821, stage0_s: 0.3430, stage0_m: 0.3087, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0805, stage1_bag_acc: 75.2061, stage1_neg_loss: 0.0219, stage1_mean_ious: 0.4751, stage1_s: 0.4541, stage1_m: 0.3593, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.4127, grad_norm: 10.5948
2024-10-15 11:19:09,685 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:22:57, time: 0.495, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.2460, stage0_bag_acc: 82.5667, stage0_mean_ious: 0.4324, stage0_s: 0.3814, stage0_m: 0.3501, stage0_l: 0.0192, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0682, stage1_bag_acc: 80.8000, stage1_neg_loss: 0.0189, stage1_mean_ious: 0.5300, stage1_s: 0.5137, stage1_m: 0.3595, stage1_l: 0.0104, stage1_h: 0.0000, loss: 0.3331, grad_norm: 11.7157
2024-10-15 11:19:35,598 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:22:44, time: 0.518, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.2060, stage0_bag_acc: 81.6643, stage0_mean_ious: 0.4315, stage0_s: 0.3489, stage0_m: 0.3454, stage0_l: 0.0235, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0696, stage1_bag_acc: 82.1357, stage1_neg_loss: 0.0165, stage1_mean_ious: 0.5301, stage1_s: 0.4914, stage1_m: 0.3481, stage1_l: 0.0168, stage1_h: 0.0000, loss: 0.2921, grad_norm: 9.5586
2024-10-15 11:19:50,059 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 11:20:20,006 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:21:16, time: 0.555, data_time: 0.057, memory: 7786, stage0_loss_instance_mil: 0.1343, stage0_bag_acc: 87.7355, stage0_mean_ious: 0.4616, stage0_s: 0.3725, stage0_m: 0.3622, stage0_l: 0.0064, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0436, stage1_bag_acc: 87.9855, stage1_neg_loss: 0.0164, stage1_mean_ious: 0.5493, stage1_s: 0.5002, stage1_m: 0.3566, stage1_l: 0.0039, stage1_h: 0.0000, loss: 0.1942, grad_norm: 8.9569
2024-10-15 11:20:45,288 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:21:02, time: 0.506, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.1263, stage0_bag_acc: 88.6323, stage0_mean_ious: 0.4505, stage0_s: 0.3714, stage0_m: 0.3608, stage0_l: 0.0353, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0382, stage1_bag_acc: 90.1530, stage1_neg_loss: 0.0130, stage1_mean_ious: 0.5598, stage1_s: 0.5285, stage1_m: 0.3531, stage1_l: 0.0277, stage1_h: 0.0000, loss: 0.1774, grad_norm: 7.3591
2024-10-15 11:21:09,867 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:20:43, time: 0.492, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.1351, stage0_bag_acc: 87.9884, stage0_mean_ious: 0.4764, stage0_s: 0.4138, stage0_m: 0.3955, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0348, stage1_bag_acc: 89.5481, stage1_neg_loss: 0.0161, stage1_mean_ious: 0.5503, stage1_s: 0.5426, stage1_m: 0.3477, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.1860, grad_norm: 6.8708
2024-10-15 11:21:33,513 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:20:20, time: 0.473, data_time: 0.007, memory: 7786, stage0_loss_instance_mil: 0.0884, stage0_bag_acc: 93.5000, stage0_mean_ious: 0.4624, stage0_s: 0.4391, stage0_m: 0.2817, stage0_l: 0.0090, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0366, stage1_bag_acc: 93.9000, stage1_neg_loss: 0.0134, stage1_mean_ious: 0.5675, stage1_s: 0.5777, stage1_m: 0.2699, stage1_l: 0.0051, stage1_h: 0.0000, loss: 0.1384, grad_norm: 6.7057
2024-10-15 11:21:57,844 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:19:59, time: 0.487, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0932, stage0_bag_acc: 92.9904, stage0_mean_ious: 0.4698, stage0_s: 0.4392, stage0_m: 0.3378, stage0_l: 0.0137, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0359, stage1_bag_acc: 92.4000, stage1_neg_loss: 0.0174, stage1_mean_ious: 0.5695, stage1_s: 0.5599, stage1_m: 0.3266, stage1_l: 0.0124, stage1_h: 0.0000, loss: 0.1465, grad_norm: 7.2378
2024-10-15 11:22:13,204 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 11:23:29,346 - mmdet - INFO - Evaluating bbox...
2024-10-15 11:23:29,828 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1940
2024-10-15 11:23:29,828 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6368
2024-10-15 11:23:29,828 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3577
2024-10-15 11:23:29,828 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1303
2024-10-15 11:23:29,828 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0583
2024-10-15 11:23:29,828 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0208
2024-10-15 11:23:29,828 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0011
2024-10-15 11:23:29,829 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:23:29,829 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2055
2024-10-15 11:23:29,829 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0580
2024-10-15 11:23:29,829 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3048
2024-10-15 11:23:29,829 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7563
2024-10-15 11:23:29,829 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3048
2024-10-15 11:23:29,829 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3048
2024-10-15 11:23:29,829 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:23:29,829 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3252
2024-10-15 11:23:29,829 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0702
2024-10-15 11:23:29,835 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 11:23:29,835 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.1940, bbox_mAP_50: 0.6370, bbox_mAP_75: 0.3580, bbox_mAP_s: 0.1300, bbox_mAP_m: 0.0580, bbox_mAP_l: 0.0210, bbox_mAP_copypaste: 0.194 0.637 0.358 0.130 0.058 0.021
2024-10-15 11:23:58,318 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:18:56, time: 0.569, data_time: 0.058, memory: 7786, stage0_loss_instance_mil: 0.0450, stage0_bag_acc: 97.1278, stage0_mean_ious: 0.4802, stage0_s: 0.4409, stage0_m: 0.3543, stage0_l: 0.0194, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0177, stage1_bag_acc: 97.4778, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5820, stage1_s: 0.5825, stage1_m: 0.3551, stage1_l: 0.0114, stage1_h: 0.0000, loss: 0.0686, grad_norm: 3.5756
2024-10-15 11:24:22,613 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:18:36, time: 0.486, data_time: 0.007, memory: 7786, stage0_loss_instance_mil: 0.0860, stage0_bag_acc: 94.1219, stage0_mean_ious: 0.4983, stage0_s: 0.4479, stage0_m: 0.2320, stage0_l: 0.0141, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0267, stage1_bag_acc: 94.2870, stage1_neg_loss: 0.0096, stage1_mean_ious: 0.5723, stage1_s: 0.5523, stage1_m: 0.2101, stage1_l: 0.0099, stage1_h: 0.0000, loss: 0.1223, grad_norm: 5.8072
2024-10-15 11:24:47,983 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:18:19, time: 0.507, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0880, stage0_bag_acc: 91.3825, stage0_mean_ious: 0.4709, stage0_s: 0.4216, stage0_m: 0.3121, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0326, stage1_bag_acc: 93.2491, stage1_neg_loss: 0.0105, stage1_mean_ious: 0.5715, stage1_s: 0.5544, stage1_m: 0.3221, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1311, grad_norm: 5.9046
2024-10-15 11:25:13,643 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:18:01, time: 0.513, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0735, stage0_bag_acc: 94.1500, stage0_mean_ious: 0.4791, stage0_s: 0.4162, stage0_m: 0.3623, stage0_l: 0.0401, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0288, stage1_bag_acc: 94.2864, stage1_neg_loss: 0.0100, stage1_mean_ious: 0.5686, stage1_s: 0.5573, stage1_m: 0.3460, stage1_l: 0.0260, stage1_h: 0.0000, loss: 0.1123, grad_norm: 5.5053
2024-10-15 11:25:38,158 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:17:40, time: 0.490, data_time: 0.008, memory: 7786, stage0_loss_instance_mil: 0.0994, stage0_bag_acc: 92.0364, stage0_mean_ious: 0.4804, stage0_s: 0.4437, stage0_m: 0.2578, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0236, stage1_bag_acc: 93.3182, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5797, stage1_s: 0.5644, stage1_m: 0.2545, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1292, grad_norm: 5.7320
2024-10-15 11:25:52,675 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 11:26:22,449 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:16:44, time: 0.551, data_time: 0.060, memory: 7786, stage0_loss_instance_mil: 0.0632, stage0_bag_acc: 95.2419, stage0_mean_ious: 0.4504, stage0_s: 0.4143, stage0_m: 0.3077, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0219, stage1_bag_acc: 94.2419, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.5486, stage1_s: 0.5350, stage1_m: 0.3219, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0926, grad_norm: 4.0322
2024-10-15 11:26:46,492 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:16:23, time: 0.481, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0902, stage0_bag_acc: 94.4730, stage0_mean_ious: 0.4868, stage0_s: 0.4460, stage0_m: 0.3107, stage0_l: 0.0210, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0257, stage1_bag_acc: 95.5730, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5460, stage1_s: 0.5323, stage1_m: 0.3067, stage1_l: 0.0137, stage1_h: 0.0000, loss: 0.1247, grad_norm: 6.3002
2024-10-15 11:27:10,321 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:16:02, time: 0.477, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0625, stage0_bag_acc: 94.7626, stage0_mean_ious: 0.4910, stage0_s: 0.4394, stage0_m: 0.2919, stage0_l: 0.0169, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0211, stage1_bag_acc: 95.0792, stage1_neg_loss: 0.0139, stage1_mean_ious: 0.5931, stage1_s: 0.5737, stage1_m: 0.2968, stage1_l: 0.0142, stage1_h: 0.0000, loss: 0.0975, grad_norm: 5.7225
2024-10-15 11:27:34,333 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:15:40, time: 0.480, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0487, stage0_bag_acc: 96.5833, stage0_mean_ious: 0.4801, stage0_s: 0.4594, stage0_m: 0.3290, stage0_l: 0.0253, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0272, stage1_bag_acc: 97.2682, stage1_neg_loss: 0.0107, stage1_mean_ious: 0.5533, stage1_s: 0.5638, stage1_m: 0.2945, stage1_l: 0.0154, stage1_h: 0.0000, loss: 0.0866, grad_norm: 4.7322
2024-10-15 11:27:59,133 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:15:20, time: 0.496, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0442, stage0_bag_acc: 96.6167, stage0_mean_ious: 0.4791, stage0_s: 0.4354, stage0_m: 0.3295, stage0_l: 0.0139, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0187, stage1_bag_acc: 96.5667, stage1_neg_loss: 0.0111, stage1_mean_ious: 0.5755, stage1_s: 0.5600, stage1_m: 0.3450, stage1_l: 0.0122, stage1_h: 0.0000, loss: 0.0740, grad_norm: 4.4130
2024-10-15 11:28:14,240 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 11:28:43,666 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:14:30, time: 0.544, data_time: 0.058, memory: 7794, stage0_loss_instance_mil: 0.0627, stage0_bag_acc: 95.2056, stage0_mean_ious: 0.4940, stage0_s: 0.4476, stage0_m: 0.3776, stage0_l: 0.0174, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0193, stage1_bag_acc: 95.8198, stage1_neg_loss: 0.0100, stage1_mean_ious: 0.5758, stage1_s: 0.5633, stage1_m: 0.3635, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.0920, grad_norm: 4.8740
2024-10-15 11:29:08,528 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:14:10, time: 0.497, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0352, stage0_bag_acc: 96.0952, stage0_mean_ious: 0.4977, stage0_s: 0.4629, stage0_m: 0.3433, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0129, stage1_bag_acc: 96.6254, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5672, stage1_s: 0.5794, stage1_m: 0.3103, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0542, grad_norm: 3.0675
2024-10-15 11:29:33,351 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:13:49, time: 0.496, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0761, stage0_bag_acc: 94.6833, stage0_mean_ious: 0.4686, stage0_s: 0.4150, stage0_m: 0.2893, stage0_l: 0.0360, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 94.7333, stage1_neg_loss: 0.0070, stage1_mean_ious: 0.5525, stage1_s: 0.5346, stage1_m: 0.2904, stage1_l: 0.0317, stage1_h: 0.0000, loss: 0.1032, grad_norm: 4.5325
2024-10-15 11:29:58,084 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:13:28, time: 0.495, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0472, stage0_bag_acc: 96.1833, stage0_mean_ious: 0.4892, stage0_s: 0.4721, stage0_m: 0.2629, stage0_l: 0.0123, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0129, stage1_bag_acc: 97.2667, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5630, stage1_s: 0.5658, stage1_m: 0.2550, stage1_l: 0.0160, stage1_h: 0.0000, loss: 0.0650, grad_norm: 3.5062
2024-10-15 11:30:23,057 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:13:07, time: 0.499, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0377, stage0_bag_acc: 97.5308, stage0_mean_ious: 0.4872, stage0_s: 0.4587, stage0_m: 0.3380, stage0_l: 0.0136, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0134, stage1_bag_acc: 98.4944, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5832, stage1_s: 0.5892, stage1_m: 0.3401, stage1_l: 0.0103, stage1_h: 0.0000, loss: 0.0572, grad_norm: 3.1841
2024-10-15 11:30:38,274 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 11:31:54,251 - mmdet - INFO - Evaluating bbox...
2024-10-15 11:31:54,727 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2066
2024-10-15 11:31:54,727 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6739
2024-10-15 11:31:54,727 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3904
2024-10-15 11:31:54,727 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1331
2024-10-15 11:31:54,727 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0604
2024-10-15 11:31:54,727 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0173
2024-10-15 11:31:54,727 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 11:31:54,727 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:31:54,728 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2188
2024-10-15 11:31:54,728 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0537
2024-10-15 11:31:54,728 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3140
2024-10-15 11:31:54,728 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7844
2024-10-15 11:31:54,728 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3140
2024-10-15 11:31:54,728 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3140
2024-10-15 11:31:54,728 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:31:54,728 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3345
2024-10-15 11:31:54,728 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0680
2024-10-15 11:31:54,733 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 11:31:54,733 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2070, bbox_mAP_50: 0.6740, bbox_mAP_75: 0.3900, bbox_mAP_s: 0.1330, bbox_mAP_m: 0.0600, bbox_mAP_l: 0.0170, bbox_mAP_copypaste: 0.207 0.674 0.390 0.133 0.060 0.017
2024-10-15 11:32:22,282 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:12:22, time: 0.551, data_time: 0.058, memory: 7794, stage0_loss_instance_mil: 0.0435, stage0_bag_acc: 96.9000, stage0_mean_ious: 0.4880, stage0_s: 0.4305, stage0_m: 0.2819, stage0_l: 0.0145, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0127, stage1_bag_acc: 96.9000, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5606, stage1_s: 0.5529, stage1_m: 0.2662, stage1_l: 0.0104, stage1_h: 0.0000, loss: 0.0610, grad_norm: 3.6334
2024-10-15 11:32:46,977 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:12:01, time: 0.494, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0451, stage0_bag_acc: 96.6000, stage0_mean_ious: 0.4678, stage0_s: 0.4332, stage0_m: 0.3150, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0125, stage1_bag_acc: 96.8000, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5808, stage1_s: 0.5879, stage1_m: 0.2901, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0618, grad_norm: 3.0035
2024-10-15 11:33:12,629 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:11:40, time: 0.513, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0237, stage0_bag_acc: 98.3167, stage0_mean_ious: 0.4975, stage0_s: 0.4526, stage0_m: 0.3813, stage0_l: 0.0187, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0149, stage1_bag_acc: 98.1500, stage1_neg_loss: 0.0093, stage1_mean_ious: 0.5804, stage1_s: 0.5845, stage1_m: 0.3575, stage1_l: 0.0140, stage1_h: 0.0000, loss: 0.0478, grad_norm: 3.1365
2024-10-15 11:33:37,511 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:11:19, time: 0.498, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0259, stage0_bag_acc: 98.3143, stage0_mean_ious: 0.5376, stage0_s: 0.4730, stage0_m: 0.4462, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0109, stage1_bag_acc: 97.3643, stage1_neg_loss: 0.0064, stage1_mean_ious: 0.5841, stage1_s: 0.5791, stage1_m: 0.3972, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.0433, grad_norm: 3.1182
2024-10-15 11:34:02,241 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:10:57, time: 0.495, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0374, stage0_bag_acc: 97.4810, stage0_mean_ious: 0.4864, stage0_s: 0.4460, stage0_m: 0.3433, stage0_l: 0.0066, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0225, stage1_bag_acc: 97.0158, stage1_neg_loss: 0.0116, stage1_mean_ious: 0.5843, stage1_s: 0.5711, stage1_m: 0.3707, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.0716, grad_norm: 3.8682
2024-10-15 11:34:16,809 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 11:34:46,305 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:10:14, time: 0.545, data_time: 0.058, memory: 7794, stage0_loss_instance_mil: 0.0441, stage0_bag_acc: 97.2056, stage0_mean_ious: 0.5011, stage0_s: 0.4662, stage0_m: 0.3059, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0110, stage1_bag_acc: 96.5833, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.6098, stage1_s: 0.5976, stage1_m: 0.3127, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0587, grad_norm: 3.5906
2024-10-15 11:35:10,580 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:09:52, time: 0.485, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0361, stage0_bag_acc: 97.8667, stage0_mean_ious: 0.4873, stage0_s: 0.4631, stage0_m: 0.3554, stage0_l: 0.0205, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 97.5810, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5763, stage1_s: 0.5843, stage1_m: 0.3364, stage1_l: 0.0150, stage1_h: 0.0000, loss: 0.0540, grad_norm: 3.5287
2024-10-15 11:35:36,474 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:09:31, time: 0.518, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0529, stage0_bag_acc: 95.6641, stage0_mean_ious: 0.4864, stage0_s: 0.4260, stage0_m: 0.3987, stage0_l: 0.0074, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0195, stage1_bag_acc: 96.2960, stage1_neg_loss: 0.0077, stage1_mean_ious: 0.5657, stage1_s: 0.5394, stage1_m: 0.3978, stage1_l: 0.0075, stage1_h: 0.0000, loss: 0.0801, grad_norm: 4.9070
2024-10-15 11:36:01,465 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:09:10, time: 0.500, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0403, stage0_bag_acc: 97.7000, stage0_mean_ious: 0.4823, stage0_s: 0.4298, stage0_m: 0.3284, stage0_l: 0.0311, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0173, stage1_bag_acc: 97.4500, stage1_neg_loss: 0.0100, stage1_mean_ious: 0.5520, stage1_s: 0.5374, stage1_m: 0.3192, stage1_l: 0.0319, stage1_h: 0.0000, loss: 0.0676, grad_norm: 3.5768
2024-10-15 11:36:27,431 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:08:48, time: 0.519, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0332, stage0_bag_acc: 96.7667, stage0_mean_ious: 0.5007, stage0_s: 0.4267, stage0_m: 0.3514, stage0_l: 0.0120, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0095, stage1_bag_acc: 97.7667, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.5790, stage1_s: 0.5547, stage1_m: 0.3354, stage1_l: 0.0123, stage1_h: 0.0000, loss: 0.0494, grad_norm: 3.4675
2024-10-15 11:36:42,527 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 11:37:11,900 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:08:07, time: 0.544, data_time: 0.058, memory: 7794, stage0_loss_instance_mil: 0.0131, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.5016, stage0_s: 0.4723, stage0_m: 0.2656, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0092, stage1_bag_acc: 99.0667, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5854, stage1_s: 0.5919, stage1_m: 0.2486, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.0239, grad_norm: 1.9370
2024-10-15 11:37:36,921 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:07:45, time: 0.500, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0136, stage0_bag_acc: 98.9667, stage0_mean_ious: 0.5084, stage0_s: 0.4502, stage0_m: 0.4260, stage0_l: 0.0223, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0053, stage1_bag_acc: 98.9667, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5867, stage1_s: 0.5699, stage1_m: 0.3857, stage1_l: 0.0172, stage1_h: 0.0000, loss: 0.0205, grad_norm: 1.4741
2024-10-15 11:38:01,578 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:07:23, time: 0.493, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0253, stage0_bag_acc: 98.3667, stage0_mean_ious: 0.4867, stage0_s: 0.4345, stage0_m: 0.3291, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0103, stage1_bag_acc: 98.2348, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5834, stage1_s: 0.5622, stage1_m: 0.3302, stage1_l: 0.0064, stage1_h: 0.0000, loss: 0.0396, grad_norm: 2.7314
2024-10-15 11:38:26,601 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:07:01, time: 0.500, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0257, stage0_bag_acc: 98.0348, stage0_mean_ious: 0.4959, stage0_s: 0.4519, stage0_m: 0.4041, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0084, stage1_bag_acc: 97.7167, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5828, stage1_s: 0.5751, stage1_m: 0.3936, stage1_l: 0.0044, stage1_h: 0.0000, loss: 0.0396, grad_norm: 2.4215
2024-10-15 11:38:52,621 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:06:39, time: 0.520, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0156, stage0_bag_acc: 99.3000, stage0_mean_ious: 0.4913, stage0_s: 0.4325, stage0_m: 0.3353, stage0_l: 0.0248, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0100, stage1_bag_acc: 99.3000, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5833, stage1_s: 0.5730, stage1_m: 0.3217, stage1_l: 0.0205, stage1_h: 0.0000, loss: 0.0296, grad_norm: 1.8909
2024-10-15 11:39:07,833 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 11:40:24,269 - mmdet - INFO - Evaluating bbox...
2024-10-15 11:40:24,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2168
2024-10-15 11:40:24,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6893
2024-10-15 11:40:24,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4045
2024-10-15 11:40:24,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1554
2024-10-15 11:40:24,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0680
2024-10-15 11:40:24,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0243
2024-10-15 11:40:24,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0011
2024-10-15 11:40:24,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:40:24,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2285
2024-10-15 11:40:24,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0606
2024-10-15 11:40:24,853 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3269
2024-10-15 11:40:24,853 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7990
2024-10-15 11:40:24,853 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3269
2024-10-15 11:40:24,853 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3269
2024-10-15 11:40:24,853 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:40:24,853 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3474
2024-10-15 11:40:24,853 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0773
2024-10-15 11:40:24,858 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 11:40:24,859 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2170, bbox_mAP_50: 0.6890, bbox_mAP_75: 0.4050, bbox_mAP_s: 0.1550, bbox_mAP_m: 0.0680, bbox_mAP_l: 0.0240, bbox_mAP_copypaste: 0.217 0.689 0.405 0.155 0.068 0.024
2024-10-15 11:40:52,444 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:06:00, time: 0.552, data_time: 0.055, memory: 7794, stage0_loss_instance_mil: 0.0261, stage0_bag_acc: 97.8643, stage0_mean_ious: 0.4727, stage0_s: 0.4300, stage0_m: 0.2584, stage0_l: 0.0241, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0101, stage1_bag_acc: 97.4786, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5773, stage1_s: 0.5636, stage1_m: 0.2447, stage1_l: 0.0269, stage1_h: 0.0000, loss: 0.0391, grad_norm: 2.5079
2024-10-15 11:41:17,443 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:05:37, time: 0.500, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0126, stage0_bag_acc: 99.2000, stage0_mean_ious: 0.4901, stage0_s: 0.4563, stage0_m: 0.3863, stage0_l: 0.0163, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0075, stage1_bag_acc: 98.7000, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5723, stage1_s: 0.5872, stage1_m: 0.3788, stage1_l: 0.0109, stage1_h: 0.0000, loss: 0.0255, grad_norm: 2.0122
2024-10-15 11:41:41,945 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:05:15, time: 0.490, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0250, stage0_bag_acc: 97.6333, stage0_mean_ious: 0.5109, stage0_s: 0.4777, stage0_m: 0.3463, stage0_l: 0.0191, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0081, stage1_bag_acc: 97.8833, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5806, stage1_s: 0.5832, stage1_m: 0.3223, stage1_l: 0.0137, stage1_h: 0.0000, loss: 0.0374, grad_norm: 2.1863
2024-10-15 11:42:04,865 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:04:52, time: 0.458, data_time: 0.007, memory: 7794, stage0_loss_instance_mil: 0.0238, stage0_bag_acc: 97.6500, stage0_mean_ious: 0.4961, stage0_s: 0.4759, stage0_m: 0.2437, stage0_l: 0.0061, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0102, stage1_bag_acc: 97.7000, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5755, stage1_s: 0.5845, stage1_m: 0.2200, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0368, grad_norm: 2.2666
2024-10-15 11:42:29,334 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:04:30, time: 0.489, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0233, stage0_bag_acc: 98.1182, stage0_mean_ious: 0.4919, stage0_s: 0.4591, stage0_m: 0.3044, stage0_l: 0.0155, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0107, stage1_bag_acc: 97.7182, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5887, stage1_s: 0.5885, stage1_m: 0.2944, stage1_l: 0.0113, stage1_h: 0.0000, loss: 0.0366, grad_norm: 2.4311
2024-10-15 11:42:44,186 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 11:43:12,937 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:03:51, time: 0.531, data_time: 0.058, memory: 7794, stage0_loss_instance_mil: 0.0294, stage0_bag_acc: 98.1556, stage0_mean_ious: 0.4655, stage0_s: 0.4400, stage0_m: 0.2871, stage0_l: 0.0216, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0049, stage1_bag_acc: 98.2944, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5655, stage1_s: 0.5555, stage1_m: 0.2873, stage1_l: 0.0171, stage1_h: 0.0000, loss: 0.0368, grad_norm: 1.7712
2024-10-15 11:43:36,957 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:03:29, time: 0.480, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0145, stage0_bag_acc: 98.4833, stage0_mean_ious: 0.5116, stage0_s: 0.4826, stage0_m: 0.3315, stage0_l: 0.0382, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0063, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5959, stage1_s: 0.6119, stage1_m: 0.2987, stage1_l: 0.0290, stage1_h: 0.0000, loss: 0.0266, grad_norm: 1.9310
2024-10-15 11:44:01,407 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:03:06, time: 0.489, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0226, stage0_bag_acc: 98.8000, stage0_mean_ious: 0.4823, stage0_s: 0.4676, stage0_m: 0.3040, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.2000, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5977, stage1_s: 0.5890, stage1_m: 0.3374, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0332, grad_norm: 2.4073
2024-10-15 11:44:27,278 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 11:44:27,278 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:02:44, time: 0.517, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0100, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.5026, stage0_s: 0.4472, stage0_m: 0.3576, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0071, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5645, stage1_s: 0.5430, stage1_m: 0.3359, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0193, grad_norm: 1.3451
2024-10-15 11:44:51,976 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:02:21, time: 0.494, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0202, stage0_bag_acc: 98.3182, stage0_mean_ious: 0.5141, stage0_s: 0.4766, stage0_m: 0.2784, stage0_l: 0.0184, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.3182, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5787, stage1_s: 0.5697, stage1_m: 0.2563, stage1_l: 0.0191, stage1_h: 0.0000, loss: 0.0307, grad_norm: 1.9744
2024-10-15 11:45:07,322 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 11:45:36,038 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:01:44, time: 0.530, data_time: 0.057, memory: 7794, stage0_loss_instance_mil: 0.0244, stage0_bag_acc: 98.1278, stage0_mean_ious: 0.4873, stage0_s: 0.4542, stage0_m: 0.3201, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0062, stage1_bag_acc: 98.1778, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5673, stage1_s: 0.5569, stage1_m: 0.3096, stage1_l: 0.0059, stage1_h: 0.0000, loss: 0.0342, grad_norm: 2.1546
2024-10-15 11:46:01,387 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:01:21, time: 0.507, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0230, stage0_bag_acc: 98.3460, stage0_mean_ious: 0.4920, stage0_s: 0.4586, stage0_m: 0.3008, stage0_l: 0.0104, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0057, stage1_bag_acc: 98.1641, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5782, stage1_s: 0.5650, stage1_m: 0.3032, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.0311, grad_norm: 2.0831
2024-10-15 11:46:27,184 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.516, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0225, stage0_bag_acc: 98.3643, stage0_mean_ious: 0.4906, stage0_s: 0.4398, stage0_m: 0.3475, stage0_l: 0.0106, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0084, stage1_bag_acc: 97.2198, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5898, stage1_s: 0.5667, stage1_m: 0.3661, stage1_l: 0.0064, stage1_h: 0.0000, loss: 0.0336, grad_norm: 2.1926
2024-10-15 11:46:52,139 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:36, time: 0.499, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0171, stage0_bag_acc: 98.7786, stage0_mean_ious: 0.5075, stage0_s: 0.4797, stage0_m: 0.3586, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0063, stage1_bag_acc: 98.5786, stage1_neg_loss: 0.0070, stage1_mean_ious: 0.5917, stage1_s: 0.5946, stage1_m: 0.3578, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0303, grad_norm: 2.1049
2024-10-15 11:47:17,386 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:13, time: 0.505, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0243, stage0_bag_acc: 98.6182, stage0_mean_ious: 0.4985, stage0_s: 0.4572, stage0_m: 0.3451, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0072, stage1_bag_acc: 98.6182, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5892, stage1_s: 0.5881, stage1_m: 0.3332, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0337, grad_norm: 2.1356
2024-10-15 11:47:33,031 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 11:48:48,450 - mmdet - INFO - Evaluating bbox...
2024-10-15 11:48:49,006 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2196
2024-10-15 11:48:49,006 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6930
2024-10-15 11:48:49,007 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4139
2024-10-15 11:48:49,007 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1550
2024-10-15 11:48:49,007 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0681
2024-10-15 11:48:49,007 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0240
2024-10-15 11:48:49,007 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 11:48:49,007 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:48:49,007 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2311
2024-10-15 11:48:49,007 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0622
2024-10-15 11:48:49,007 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3298
2024-10-15 11:48:49,007 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8018
2024-10-15 11:48:49,007 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3298
2024-10-15 11:48:49,008 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3298
2024-10-15 11:48:49,008 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:48:49,008 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3505
2024-10-15 11:48:49,008 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0759
2024-10-15 11:48:49,013 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 11:48:49,014 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2200, bbox_mAP_50: 0.6930, bbox_mAP_75: 0.4140, bbox_mAP_s: 0.1550, bbox_mAP_m: 0.0680, bbox_mAP_l: 0.0240, bbox_mAP_copypaste: 0.220 0.693 0.414 0.155 0.068 0.024
2024-10-15 11:50:03,727 - mmdet - INFO - Evaluating bbox...
2024-10-15 11:50:04,203 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2196
2024-10-15 11:50:04,203 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6930
2024-10-15 11:50:04,203 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4139
2024-10-15 11:50:04,203 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1550
2024-10-15 11:50:04,203 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0681
2024-10-15 11:50:04,203 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0240
2024-10-15 11:50:04,203 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 11:50:04,203 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:50:04,204 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2311
2024-10-15 11:50:04,204 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0622
2024-10-15 11:50:04,204 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3298
2024-10-15 11:50:04,204 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8018
2024-10-15 11:50:04,204 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3298
2024-10-15 11:50:04,204 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3298
2024-10-15 11:50:04,204 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:50:04,204 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3505
2024-10-15 11:50:04,204 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0759
2024-10-15 11:50:05,498 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+d7eacca
------------------------------------------------------------

2024-10-15 11:50:06,448 - mmdet - INFO - Distributed training: False
2024-10-15 11:50:07,322 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 11:50:08,239 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 11:50:08,239 - mmdet - INFO - Use load_from_local loader
2024-10-15 11:50:08,491 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 11:50:08,503 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 11:50:08,503 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 11:50:36,764 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:31:10, time: 0.565, data_time: 0.057, memory: 7794, stage0_loss_instance_mil: 0.7083, stage0_bag_acc: 24.7237, stage0_mean_ious: 0.0411, stage0_s: 0.0250, stage0_m: 0.0566, stage0_l: 0.0129, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1700, stage1_bag_acc: 14.2318, stage1_neg_loss: 0.0005, stage1_mean_ious: 0.0415, stage1_s: 0.0263, stage1_m: 0.0501, stage1_l: 0.0161, stage1_h: 0.0000, loss: 0.8788, grad_norm: 5.4982
2024-10-15 11:51:02,859 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:29:31, time: 0.522, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.7036, stage0_bag_acc: 23.2807, stage0_mean_ious: 0.0390, stage0_s: 0.0308, stage0_m: 0.0296, stage0_l: 0.0039, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1709, stage1_bag_acc: 19.8787, stage1_neg_loss: 0.0007, stage1_mean_ious: 0.0405, stage1_s: 0.0306, stage1_m: 0.0337, stage1_l: 0.0028, stage1_h: 0.0000, loss: 0.8752, grad_norm: 5.5121
2024-10-15 11:51:28,090 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:28:23, time: 0.505, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.6805, stage0_bag_acc: 24.0513, stage0_mean_ious: 0.0705, stage0_s: 0.0590, stage0_m: 0.0593, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1736, stage1_bag_acc: 19.1258, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.0712, stage1_s: 0.0591, stage1_m: 0.0652, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8558, grad_norm: 5.9679
2024-10-15 11:51:53,973 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:27:46, time: 0.518, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.6610, stage0_bag_acc: 18.9206, stage0_mean_ious: 0.0812, stage0_s: 0.0818, stage0_m: 0.0484, stage0_l: 0.0026, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1593, stage1_bag_acc: 28.5095, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.0881, stage1_s: 0.0895, stage1_m: 0.0500, stage1_l: 0.0018, stage1_h: 0.0000, loss: 0.8288, grad_norm: 8.9504
2024-10-15 11:52:19,660 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:27:11, time: 0.514, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.6027, stage0_bag_acc: 32.6561, stage0_mean_ious: 0.1366, stage0_s: 0.1224, stage0_m: 0.1011, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1410, stage1_bag_acc: 41.8019, stage1_neg_loss: 0.0216, stage1_mean_ious: 0.1504, stage1_s: 0.1400, stage1_m: 0.0990, stage1_l: 0.0084, stage1_h: 0.0000, loss: 0.7653, grad_norm: 9.9384
2024-10-15 11:52:34,808 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 11:53:04,858 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:24:19, time: 0.557, data_time: 0.057, memory: 7794, stage0_loss_instance_mil: 0.5057, stage0_bag_acc: 41.8786, stage0_mean_ious: 0.2516, stage0_s: 0.2247, stage0_m: 0.2288, stage0_l: 0.0089, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1139, stage1_bag_acc: 40.6620, stage1_neg_loss: 0.0195, stage1_mean_ious: 0.2814, stage1_s: 0.2656, stage1_m: 0.2337, stage1_l: 0.0089, stage1_h: 0.0000, loss: 0.6390, grad_norm: 8.9123
2024-10-15 11:53:30,429 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:24:07, time: 0.511, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.4271, stage0_bag_acc: 55.6537, stage0_mean_ious: 0.3022, stage0_s: 0.2749, stage0_m: 0.2387, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0914, stage1_bag_acc: 56.1463, stage1_neg_loss: 0.0229, stage1_mean_ious: 0.3546, stage1_s: 0.3281, stage1_m: 0.2629, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5414, grad_norm: 11.1456
2024-10-15 11:53:56,513 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:23:55, time: 0.522, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.3047, stage0_bag_acc: 74.1198, stage0_mean_ious: 0.3619, stage0_s: 0.2980, stage0_m: 0.3002, stage0_l: 0.0241, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0976, stage1_bag_acc: 76.0674, stage1_neg_loss: 0.0201, stage1_mean_ious: 0.4368, stage1_s: 0.3871, stage1_m: 0.3310, stage1_l: 0.0203, stage1_h: 0.0000, loss: 0.4224, grad_norm: 13.5321
2024-10-15 11:54:23,072 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:23:43, time: 0.531, data_time: 0.009, memory: 7794, stage0_loss_instance_mil: 0.3449, stage0_bag_acc: 66.7770, stage0_mean_ious: 0.3910, stage0_s: 0.3228, stage0_m: 0.3587, stage0_l: 0.0099, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1046, stage1_bag_acc: 72.8278, stage1_neg_loss: 0.0220, stage1_mean_ious: 0.4638, stage1_s: 0.4195, stage1_m: 0.3788, stage1_l: 0.0095, stage1_h: 0.0000, loss: 0.4714, grad_norm: 12.6423
2024-10-15 11:54:48,508 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:23:22, time: 0.509, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.1990, stage0_bag_acc: 82.8464, stage0_mean_ious: 0.4139, stage0_s: 0.3493, stage0_m: 0.3385, stage0_l: 0.0275, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0603, stage1_bag_acc: 85.4767, stage1_neg_loss: 0.0169, stage1_mean_ious: 0.4916, stage1_s: 0.4513, stage1_m: 0.3604, stage1_l: 0.0176, stage1_h: 0.0000, loss: 0.2762, grad_norm: 8.4881
2024-10-15 11:55:03,378 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 11:55:33,978 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:21:51, time: 0.568, data_time: 0.058, memory: 7794, stage0_loss_instance_mil: 0.1669, stage0_bag_acc: 87.4840, stage0_mean_ious: 0.4430, stage0_s: 0.3888, stage0_m: 0.3460, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0453, stage1_bag_acc: 88.5143, stage1_neg_loss: 0.0195, stage1_mean_ious: 0.5386, stage1_s: 0.5125, stage1_m: 0.3497, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2317, grad_norm: 9.2567
2024-10-15 11:55:58,902 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:21:32, time: 0.498, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.1276, stage0_bag_acc: 90.4133, stage0_mean_ious: 0.4748, stage0_s: 0.4000, stage0_m: 0.3383, stage0_l: 0.0167, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0382, stage1_bag_acc: 91.3991, stage1_neg_loss: 0.0160, stage1_mean_ious: 0.5338, stage1_s: 0.4831, stage1_m: 0.3099, stage1_l: 0.0102, stage1_h: 0.0000, loss: 0.1818, grad_norm: 8.3604
2024-10-15 11:56:23,378 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:21:10, time: 0.490, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.1437, stage0_bag_acc: 87.0705, stage0_mean_ious: 0.4350, stage0_s: 0.3914, stage0_m: 0.3243, stage0_l: 0.0087, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0451, stage1_bag_acc: 88.6816, stage1_neg_loss: 0.0156, stage1_mean_ious: 0.5333, stage1_s: 0.5191, stage1_m: 0.3135, stage1_l: 0.0089, stage1_h: 0.0000, loss: 0.2044, grad_norm: 8.3018
2024-10-15 11:56:48,744 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:20:51, time: 0.507, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.1011, stage0_bag_acc: 93.2056, stage0_mean_ious: 0.4567, stage0_s: 0.4069, stage0_m: 0.3106, stage0_l: 0.0117, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0297, stage1_bag_acc: 95.4333, stage1_neg_loss: 0.0097, stage1_mean_ious: 0.5640, stage1_s: 0.5310, stage1_m: 0.3028, stage1_l: 0.0084, stage1_h: 0.0000, loss: 0.1406, grad_norm: 5.9776
2024-10-15 11:57:13,068 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:20:28, time: 0.486, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0784, stage0_bag_acc: 93.7634, stage0_mean_ious: 0.4691, stage0_s: 0.4327, stage0_m: 0.3193, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0272, stage1_bag_acc: 93.4095, stage1_neg_loss: 0.0142, stage1_mean_ious: 0.5594, stage1_s: 0.5512, stage1_m: 0.3039, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1198, grad_norm: 5.9558
2024-10-15 11:57:27,625 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 11:58:43,133 - mmdet - INFO - Evaluating bbox...
2024-10-15 11:58:43,692 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1780
2024-10-15 11:58:43,692 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6364
2024-10-15 11:58:43,692 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3279
2024-10-15 11:58:43,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0906
2024-10-15 11:58:43,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0445
2024-10-15 11:58:43,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0135
2024-10-15 11:58:43,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0002
2024-10-15 11:58:43,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:58:43,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1852
2024-10-15 11:58:43,693 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0615
2024-10-15 11:58:43,693 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2764
2024-10-15 11:58:43,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7528
2024-10-15 11:58:43,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2764
2024-10-15 11:58:43,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2764
2024-10-15 11:58:43,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 11:58:43,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2902
2024-10-15 11:58:43,694 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1018
2024-10-15 11:58:43,699 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 11:58:43,700 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.1780, bbox_mAP_50: 0.6360, bbox_mAP_75: 0.3280, bbox_mAP_s: 0.0910, bbox_mAP_m: 0.0440, bbox_mAP_l: 0.0130, bbox_mAP_copypaste: 0.178 0.636 0.328 0.091 0.044 0.013
2024-10-15 11:59:10,043 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:19:15, time: 0.527, data_time: 0.055, memory: 7794, stage0_loss_instance_mil: 0.0954, stage0_bag_acc: 94.4364, stage0_mean_ious: 0.4542, stage0_s: 0.4227, stage0_m: 0.2689, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0308, stage1_bag_acc: 95.4030, stage1_neg_loss: 0.0096, stage1_mean_ious: 0.5497, stage1_s: 0.5361, stage1_m: 0.2748, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1359, grad_norm: 6.0959
2024-10-15 11:59:35,244 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:18:57, time: 0.504, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0936, stage0_bag_acc: 92.7126, stage0_mean_ious: 0.4860, stage0_s: 0.4446, stage0_m: 0.3113, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0262, stage1_bag_acc: 94.2960, stage1_neg_loss: 0.0154, stage1_mean_ious: 0.5705, stage1_s: 0.5635, stage1_m: 0.2817, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1352, grad_norm: 6.5665
2024-10-15 11:59:59,956 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:18:36, time: 0.494, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0731, stage0_bag_acc: 95.3333, stage0_mean_ious: 0.4480, stage0_s: 0.4059, stage0_m: 0.2895, stage0_l: 0.0112, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0269, stage1_bag_acc: 95.1333, stage1_neg_loss: 0.0069, stage1_mean_ious: 0.5576, stage1_s: 0.5414, stage1_m: 0.3051, stage1_l: 0.0087, stage1_h: 0.0000, loss: 0.1069, grad_norm: 4.9349
2024-10-15 12:00:24,756 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:18:15, time: 0.496, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0787, stage0_bag_acc: 93.8807, stage0_mean_ious: 0.4756, stage0_s: 0.4257, stage0_m: 0.3348, stage0_l: 0.0301, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0204, stage1_bag_acc: 94.0117, stage1_neg_loss: 0.0117, stage1_mean_ious: 0.5475, stage1_s: 0.5213, stage1_m: 0.3272, stage1_l: 0.0225, stage1_h: 0.0000, loss: 0.1108, grad_norm: 4.9258
2024-10-15 12:00:50,559 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:17:56, time: 0.516, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0685, stage0_bag_acc: 94.8602, stage0_mean_ious: 0.4870, stage0_s: 0.4154, stage0_m: 0.3766, stage0_l: 0.0122, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0214, stage1_bag_acc: 94.9412, stage1_neg_loss: 0.0076, stage1_mean_ious: 0.5632, stage1_s: 0.5319, stage1_m: 0.3599, stage1_l: 0.0074, stage1_h: 0.0000, loss: 0.0975, grad_norm: 4.7570
2024-10-15 12:01:05,986 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 12:01:35,585 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:16:58, time: 0.548, data_time: 0.059, memory: 7794, stage0_loss_instance_mil: 0.0684, stage0_bag_acc: 95.1269, stage0_mean_ious: 0.4749, stage0_s: 0.4227, stage0_m: 0.3763, stage0_l: 0.0071, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0217, stage1_bag_acc: 95.0206, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.5517, stage1_s: 0.5417, stage1_m: 0.3669, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.0968, grad_norm: 5.0926
2024-10-15 12:02:00,926 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:16:39, time: 0.507, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0737, stage0_bag_acc: 95.4753, stage0_mean_ious: 0.4519, stage0_s: 0.4093, stage0_m: 0.2988, stage0_l: 0.0087, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0143, stage1_bag_acc: 95.6722, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5584, stage1_s: 0.5368, stage1_m: 0.2911, stage1_l: 0.0087, stage1_h: 0.0000, loss: 0.0930, grad_norm: 4.3992
2024-10-15 12:02:26,847 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:16:20, time: 0.518, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0361, stage0_bag_acc: 97.3310, stage0_mean_ious: 0.4798, stage0_s: 0.4309, stage0_m: 0.3950, stage0_l: 0.0092, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0230, stage1_bag_acc: 98.0310, stage1_neg_loss: 0.0138, stage1_mean_ious: 0.5802, stage1_s: 0.5703, stage1_m: 0.3942, stage1_l: 0.0082, stage1_h: 0.0000, loss: 0.0729, grad_norm: 4.6172
2024-10-15 12:02:51,842 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:15:59, time: 0.500, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0416, stage0_bag_acc: 96.4825, stage0_mean_ious: 0.4841, stage0_s: 0.4490, stage0_m: 0.3248, stage0_l: 0.0264, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0153, stage1_bag_acc: 96.5143, stage1_neg_loss: 0.0097, stage1_mean_ious: 0.5730, stage1_s: 0.5643, stage1_m: 0.3387, stage1_l: 0.0213, stage1_h: 0.0000, loss: 0.0666, grad_norm: 4.0196
2024-10-15 12:03:17,137 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:15:38, time: 0.506, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0685, stage0_bag_acc: 96.3667, stage0_mean_ious: 0.4950, stage0_s: 0.4610, stage0_m: 0.3551, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0187, stage1_bag_acc: 96.7333, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.5627, stage1_s: 0.5625, stage1_m: 0.3423, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0939, grad_norm: 4.5570
2024-10-15 12:03:31,447 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 12:04:01,742 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:14:47, time: 0.561, data_time: 0.057, memory: 7794, stage0_loss_instance_mil: 0.0299, stage0_bag_acc: 97.3545, stage0_mean_ious: 0.4797, stage0_s: 0.4282, stage0_m: 0.3856, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0133, stage1_bag_acc: 97.8727, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.5584, stage1_s: 0.5284, stage1_m: 0.4031, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0499, grad_norm: 3.7390
2024-10-15 12:04:25,781 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:14:25, time: 0.481, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0357, stage0_bag_acc: 97.3389, stage0_mean_ious: 0.4856, stage0_s: 0.4491, stage0_m: 0.3148, stage0_l: 0.0116, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0182, stage1_bag_acc: 97.1032, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5446, stage1_s: 0.5410, stage1_m: 0.3064, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.0601, grad_norm: 3.5770
2024-10-15 12:04:51,263 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:14:04, time: 0.510, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0486, stage0_bag_acc: 96.7500, stage0_mean_ious: 0.4725, stage0_s: 0.4460, stage0_m: 0.3384, stage0_l: 0.0191, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0183, stage1_bag_acc: 96.4643, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5610, stage1_s: 0.5572, stage1_m: 0.3473, stage1_l: 0.0162, stage1_h: 0.0000, loss: 0.0730, grad_norm: 4.0411
2024-10-15 12:05:16,222 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:13:43, time: 0.499, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0645, stage0_bag_acc: 96.7643, stage0_mean_ious: 0.4708, stage0_s: 0.4427, stage0_m: 0.2817, stage0_l: 0.0255, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0147, stage1_bag_acc: 96.7643, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5516, stage1_s: 0.5438, stage1_m: 0.2797, stage1_l: 0.0239, stage1_h: 0.0000, loss: 0.0836, grad_norm: 4.8635
2024-10-15 12:05:41,640 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:13:22, time: 0.508, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0430, stage0_bag_acc: 97.0833, stage0_mean_ious: 0.4576, stage0_s: 0.3869, stage0_m: 0.2770, stage0_l: 0.0158, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0165, stage1_bag_acc: 97.2444, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5296, stage1_s: 0.4825, stage1_m: 0.2684, stage1_l: 0.0162, stage1_h: 0.0000, loss: 0.0657, grad_norm: 3.8459
2024-10-15 12:05:56,242 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 12:07:12,405 - mmdet - INFO - Evaluating bbox...
2024-10-15 12:07:12,956 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1816
2024-10-15 12:07:12,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6416
2024-10-15 12:07:12,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3294
2024-10-15 12:07:12,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0963
2024-10-15 12:07:12,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0402
2024-10-15 12:07:12,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0140
2024-10-15 12:07:12,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-15 12:07:12,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:07:12,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1865
2024-10-15 12:07:12,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0752
2024-10-15 12:07:12,957 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2817
2024-10-15 12:07:12,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7607
2024-10-15 12:07:12,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2817
2024-10-15 12:07:12,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2817
2024-10-15 12:07:12,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:07:12,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2921
2024-10-15 12:07:12,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1120
2024-10-15 12:07:12,964 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 12:07:12,964 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.1820, bbox_mAP_50: 0.6420, bbox_mAP_75: 0.3290, bbox_mAP_s: 0.0960, bbox_mAP_m: 0.0400, bbox_mAP_l: 0.0140, bbox_mAP_copypaste: 0.182 0.642 0.329 0.096 0.040 0.014
2024-10-15 12:07:40,030 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:12:34, time: 0.541, data_time: 0.057, memory: 7794, stage0_loss_instance_mil: 0.0492, stage0_bag_acc: 97.5427, stage0_mean_ious: 0.4722, stage0_s: 0.4364, stage0_m: 0.3231, stage0_l: 0.0451, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0151, stage1_bag_acc: 96.5927, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5473, stage1_s: 0.5393, stage1_m: 0.3175, stage1_l: 0.0453, stage1_h: 0.0000, loss: 0.0705, grad_norm: 3.1404
2024-10-15 12:08:05,709 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:12:13, time: 0.514, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0192, stage0_bag_acc: 98.7333, stage0_mean_ious: 0.4772, stage0_s: 0.4391, stage0_m: 0.2909, stage0_l: 0.0281, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0104, stage1_bag_acc: 98.8667, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5697, stage1_s: 0.5526, stage1_m: 0.3057, stage1_l: 0.0274, stage1_h: 0.0000, loss: 0.0354, grad_norm: 2.9827
2024-10-15 12:08:31,290 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:11:52, time: 0.512, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0509, stage0_bag_acc: 96.1500, stage0_mean_ious: 0.4724, stage0_s: 0.4443, stage0_m: 0.3439, stage0_l: 0.0067, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0161, stage1_bag_acc: 95.3833, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5467, stage1_s: 0.5354, stage1_m: 0.3506, stage1_l: 0.0095, stage1_h: 0.0000, loss: 0.0732, grad_norm: 3.9861
2024-10-15 12:08:55,924 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:11:30, time: 0.493, data_time: 0.007, memory: 7794, stage0_loss_instance_mil: 0.0525, stage0_bag_acc: 96.7348, stage0_mean_ious: 0.4519, stage0_s: 0.3786, stage0_m: 0.3154, stage0_l: 0.0194, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0152, stage1_bag_acc: 96.4673, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5152, stage1_s: 0.4676, stage1_m: 0.3004, stage1_l: 0.0149, stage1_h: 0.0000, loss: 0.0736, grad_norm: 3.6487
2024-10-15 12:09:21,674 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:11:08, time: 0.515, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0331, stage0_bag_acc: 97.8167, stage0_mean_ious: 0.4969, stage0_s: 0.4380, stage0_m: 0.3770, stage0_l: 0.0055, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0116, stage1_bag_acc: 97.4333, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.5627, stage1_s: 0.5281, stage1_m: 0.3813, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.0532, grad_norm: 3.6563
2024-10-15 12:09:36,788 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 12:10:06,825 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:10:24, time: 0.556, data_time: 0.057, memory: 7794, stage0_loss_instance_mil: 0.0359, stage0_bag_acc: 97.6310, stage0_mean_ious: 0.4773, stage0_s: 0.4272, stage0_m: 0.3493, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0111, stage1_bag_acc: 98.2143, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5467, stage1_s: 0.5321, stage1_m: 0.3377, stage1_l: 0.0094, stage1_h: 0.0000, loss: 0.0501, grad_norm: 2.7052
2024-10-15 12:10:32,317 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:10:03, time: 0.510, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0368, stage0_bag_acc: 98.6643, stage0_mean_ious: 0.4860, stage0_s: 0.4465, stage0_m: 0.3313, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0101, stage1_bag_acc: 98.8643, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5585, stage1_s: 0.5412, stage1_m: 0.3265, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0517, grad_norm: 2.9312
2024-10-15 12:10:57,960 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:09:41, time: 0.513, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0146, stage0_bag_acc: 99.2500, stage0_mean_ious: 0.4827, stage0_s: 0.4452, stage0_m: 0.3577, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0062, stage1_bag_acc: 99.2500, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5805, stage1_s: 0.5650, stage1_m: 0.3736, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0243, grad_norm: 2.3127
2024-10-15 12:11:23,789 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:09:19, time: 0.517, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0460, stage0_bag_acc: 96.3722, stage0_mean_ious: 0.4743, stage0_s: 0.4403, stage0_m: 0.2918, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0112, stage1_bag_acc: 98.0778, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5692, stage1_s: 0.5624, stage1_m: 0.3126, stage1_l: 0.0112, stage1_h: 0.0000, loss: 0.0619, grad_norm: 3.7530
2024-10-15 12:11:49,527 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:08:57, time: 0.515, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0504, stage0_bag_acc: 95.9000, stage0_mean_ious: 0.4833, stage0_s: 0.4447, stage0_m: 0.3375, stage0_l: 0.0194, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 97.0000, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5675, stage1_s: 0.5560, stage1_m: 0.3575, stage1_l: 0.0134, stage1_h: 0.0000, loss: 0.0619, grad_norm: 3.6398
2024-10-15 12:12:05,186 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 12:12:35,966 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:08:16, time: 0.571, data_time: 0.057, memory: 7794, stage0_loss_instance_mil: 0.0154, stage0_bag_acc: 99.0643, stage0_mean_ious: 0.4683, stage0_s: 0.4151, stage0_m: 0.3687, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 98.8643, stage1_neg_loss: 0.0105, stage1_mean_ious: 0.5484, stage1_s: 0.5307, stage1_m: 0.3635, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0336, grad_norm: 2.5089
2024-10-15 12:13:02,484 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:07:54, time: 0.530, data_time: 0.009, memory: 7794, stage0_loss_instance_mil: 0.0165, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.4757, stage0_s: 0.4388, stage0_m: 0.3603, stage0_l: 0.0096, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 99.0500, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5609, stage1_s: 0.5374, stage1_m: 0.3824, stage1_l: 0.0100, stage1_h: 0.0000, loss: 0.0271, grad_norm: 1.8618
2024-10-15 12:13:27,438 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:07:31, time: 0.499, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0167, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.4862, stage0_s: 0.4679, stage0_m: 0.2704, stage0_l: 0.0279, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0066, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5374, stage1_s: 0.5429, stage1_m: 0.2579, stage1_l: 0.0203, stage1_h: 0.0000, loss: 0.0261, grad_norm: 1.7724
2024-10-15 12:13:52,352 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:07:09, time: 0.498, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0112, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.4913, stage0_s: 0.4395, stage0_m: 0.3306, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 99.6000, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5633, stage1_s: 0.5282, stage1_m: 0.3352, stage1_l: 0.0084, stage1_h: 0.0000, loss: 0.0230, grad_norm: 1.5570
2024-10-15 12:14:16,812 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:06:46, time: 0.489, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0283, stage0_bag_acc: 98.1864, stage0_mean_ious: 0.4754, stage0_s: 0.4321, stage0_m: 0.3479, stage0_l: 0.0193, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0057, stage1_bag_acc: 98.1864, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5516, stage1_s: 0.5299, stage1_m: 0.3473, stage1_l: 0.0246, stage1_h: 0.0000, loss: 0.0374, grad_norm: 2.2580
2024-10-15 12:14:32,135 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 12:15:47,681 - mmdet - INFO - Evaluating bbox...
2024-10-15 12:15:48,163 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1794
2024-10-15 12:15:48,163 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6218
2024-10-15 12:15:48,163 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3361
2024-10-15 12:15:48,164 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0966
2024-10-15 12:15:48,164 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0397
2024-10-15 12:15:48,164 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0098
2024-10-15 12:15:48,164 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-15 12:15:48,164 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:15:48,164 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1834
2024-10-15 12:15:48,164 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0956
2024-10-15 12:15:48,164 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2823
2024-10-15 12:15:48,164 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7488
2024-10-15 12:15:48,165 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2823
2024-10-15 12:15:48,165 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2823
2024-10-15 12:15:48,165 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:15:48,165 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2902
2024-10-15 12:15:48,165 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1345
2024-10-15 12:15:48,170 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 12:15:48,170 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.1790, bbox_mAP_50: 0.6220, bbox_mAP_75: 0.3360, bbox_mAP_s: 0.0970, bbox_mAP_m: 0.0400, bbox_mAP_l: 0.0100, bbox_mAP_copypaste: 0.179 0.622 0.336 0.097 0.040 0.010
2024-10-15 12:16:15,602 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:06:05, time: 0.549, data_time: 0.057, memory: 7794, stage0_loss_instance_mil: 0.0152, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.4649, stage0_s: 0.4271, stage0_m: 0.2975, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 99.2667, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5547, stage1_s: 0.5450, stage1_m: 0.3025, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0244, grad_norm: 1.5639
2024-10-15 12:16:40,787 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:05:43, time: 0.504, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0101, stage0_bag_acc: 99.5278, stage0_mean_ious: 0.4882, stage0_s: 0.4458, stage0_m: 0.4027, stage0_l: 0.0238, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0046, stage1_bag_acc: 99.5000, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5557, stage1_s: 0.5338, stage1_m: 0.3995, stage1_l: 0.0300, stage1_h: 0.0000, loss: 0.0178, grad_norm: 1.6656
2024-10-15 12:17:04,901 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:05:20, time: 0.482, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0130, stage0_bag_acc: 99.3000, stage0_mean_ious: 0.5010, stage0_s: 0.4572, stage0_m: 0.2034, stage0_l: 0.0073, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0078, stage1_bag_acc: 99.5000, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5673, stage1_s: 0.5397, stage1_m: 0.2021, stage1_l: 0.0066, stage1_h: 0.0000, loss: 0.0271, grad_norm: 1.9223
2024-10-15 12:17:30,498 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:04:57, time: 0.512, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0166, stage0_bag_acc: 99.1944, stage0_mean_ious: 0.4601, stage0_s: 0.4118, stage0_m: 0.2877, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 99.1944, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5382, stage1_s: 0.5182, stage1_m: 0.2920, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.0256, grad_norm: 1.6341
2024-10-15 12:17:56,088 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:04:34, time: 0.512, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0260, stage0_bag_acc: 98.4667, stage0_mean_ious: 0.4808, stage0_s: 0.4038, stage0_m: 0.3699, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0072, stage1_bag_acc: 98.3500, stage1_neg_loss: 0.0093, stage1_mean_ious: 0.5674, stage1_s: 0.5025, stage1_m: 0.3832, stage1_l: 0.0086, stage1_h: 0.0000, loss: 0.0425, grad_norm: 2.2976
2024-10-15 12:18:11,899 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 12:18:43,562 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:03:56, time: 0.589, data_time: 0.058, memory: 7794, stage0_loss_instance_mil: 0.0153, stage0_bag_acc: 99.1278, stage0_mean_ious: 0.4937, stage0_s: 0.4471, stage0_m: 0.3868, stage0_l: 0.0519, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0071, stage1_bag_acc: 98.8278, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5637, stage1_s: 0.5366, stage1_m: 0.3944, stage1_l: 0.0541, stage1_h: 0.0000, loss: 0.0244, grad_norm: 1.9068
2024-10-15 12:19:09,179 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:03:33, time: 0.512, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0261, stage0_bag_acc: 98.0500, stage0_mean_ious: 0.4586, stage0_s: 0.4189, stage0_m: 0.3433, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 97.3643, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5479, stage1_s: 0.5392, stage1_m: 0.3447, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0361, grad_norm: 2.5410
2024-10-15 12:19:33,917 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:03:10, time: 0.495, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0144, stage0_bag_acc: 99.3278, stage0_mean_ious: 0.4831, stage0_s: 0.4403, stage0_m: 0.3042, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0049, stage1_bag_acc: 99.5778, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5520, stage1_s: 0.5183, stage1_m: 0.3333, stage1_l: 0.0111, stage1_h: 0.0000, loss: 0.0214, grad_norm: 1.4225
2024-10-15 12:19:59,505 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 12:19:59,505 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:02:47, time: 0.512, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0174, stage0_bag_acc: 99.2167, stage0_mean_ious: 0.4790, stage0_s: 0.4278, stage0_m: 0.3003, stage0_l: 0.0193, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0071, stage1_bag_acc: 98.7167, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5508, stage1_s: 0.5243, stage1_m: 0.2998, stage1_l: 0.0194, stage1_h: 0.0000, loss: 0.0280, grad_norm: 1.8909
2024-10-15 12:20:24,394 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:02:24, time: 0.498, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0127, stage0_bag_acc: 99.1667, stage0_mean_ious: 0.4741, stage0_s: 0.4378, stage0_m: 0.3158, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0095, stage1_bag_acc: 99.5000, stage1_neg_loss: 0.0095, stage1_mean_ious: 0.5513, stage1_s: 0.5335, stage1_m: 0.3026, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0318, grad_norm: 2.3199
2024-10-15 12:20:38,462 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 12:21:08,948 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:01:46, time: 0.556, data_time: 0.057, memory: 7794, stage0_loss_instance_mil: 0.0199, stage0_bag_acc: 98.4500, stage0_mean_ious: 0.4916, stage0_s: 0.4525, stage0_m: 0.3086, stage0_l: 0.0284, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0062, stage1_bag_acc: 98.7000, stage1_neg_loss: 0.0064, stage1_mean_ious: 0.5541, stage1_s: 0.5213, stage1_m: 0.3213, stage1_l: 0.0298, stage1_h: 0.0000, loss: 0.0325, grad_norm: 2.2126
2024-10-15 12:21:33,117 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:01:23, time: 0.483, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0168, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4594, stage0_s: 0.4306, stage0_m: 0.2248, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0164, stage1_bag_acc: 97.6167, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5437, stage1_s: 0.5326, stage1_m: 0.2251, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0368, grad_norm: 2.3653
2024-10-15 12:21:57,822 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:00, time: 0.494, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0130, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.4680, stage0_s: 0.4218, stage0_m: 0.3662, stage0_l: 0.0221, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0100, stage1_bag_acc: 98.6143, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5499, stage1_s: 0.5276, stage1_m: 0.3726, stage1_l: 0.0258, stage1_h: 0.0000, loss: 0.0268, grad_norm: 2.1412
2024-10-15 12:22:22,402 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:37, time: 0.492, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.0114, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.4637, stage0_s: 0.4184, stage0_m: 0.3755, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0047, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.5304, stage1_s: 0.5034, stage1_m: 0.3787, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0179, grad_norm: 1.3636
2024-10-15 12:22:46,552 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:13, time: 0.483, data_time: 0.007, memory: 7794, stage0_loss_instance_mil: 0.0158, stage0_bag_acc: 99.2167, stage0_mean_ious: 0.5046, stage0_s: 0.4766, stage0_m: 0.3516, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 98.7667, stage1_neg_loss: 0.0014, stage1_mean_ious: 0.5543, stage1_s: 0.5495, stage1_m: 0.3416, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0258, grad_norm: 1.7665
2024-10-15 12:23:02,310 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 12:24:17,695 - mmdet - INFO - Evaluating bbox...
2024-10-15 12:24:18,256 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1820
2024-10-15 12:24:18,256 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6314
2024-10-15 12:24:18,256 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3413
2024-10-15 12:24:18,257 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0994
2024-10-15 12:24:18,257 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0392
2024-10-15 12:24:18,257 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0115
2024-10-15 12:24:18,257 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-15 12:24:18,257 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:24:18,257 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1863
2024-10-15 12:24:18,257 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0878
2024-10-15 12:24:18,257 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2842
2024-10-15 12:24:18,257 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7569
2024-10-15 12:24:18,257 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2842
2024-10-15 12:24:18,258 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2842
2024-10-15 12:24:18,258 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:24:18,258 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2931
2024-10-15 12:24:18,258 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1266
2024-10-15 12:24:18,264 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 12:24:18,264 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.1820, bbox_mAP_50: 0.6310, bbox_mAP_75: 0.3410, bbox_mAP_s: 0.0990, bbox_mAP_m: 0.0390, bbox_mAP_l: 0.0110, bbox_mAP_copypaste: 0.182 0.631 0.341 0.099 0.039 0.011
2024-10-15 12:25:32,570 - mmdet - INFO - Evaluating bbox...
2024-10-15 12:25:33,045 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1820
2024-10-15 12:25:33,045 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6314
2024-10-15 12:25:33,045 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3413
2024-10-15 12:25:33,045 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0994
2024-10-15 12:25:33,045 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0392
2024-10-15 12:25:33,045 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0115
2024-10-15 12:25:33,045 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-15 12:25:33,045 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:25:33,046 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1863
2024-10-15 12:25:33,046 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0878
2024-10-15 12:25:33,046 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2842
2024-10-15 12:25:33,046 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7569
2024-10-15 12:25:33,046 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2842
2024-10-15 12:25:33,046 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2842
2024-10-15 12:25:33,046 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:25:33,046 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2931
2024-10-15 12:25:33,046 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1266
2024-10-15 12:25:34,381 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+d7eacca
------------------------------------------------------------

2024-10-15 12:25:35,341 - mmdet - INFO - Distributed training: False
2024-10-15 12:25:36,221 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 12:25:37,184 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 12:25:37,184 - mmdet - INFO - Use load_from_local loader
2024-10-15 12:25:37,474 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 12:25:37,487 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 12:25:37,487 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 12:26:04,514 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:29:48, time: 0.540, data_time: 0.058, memory: 7794, stage0_loss_instance_mil: 0.7085, stage0_bag_acc: 14.6773, stage0_mean_ious: 0.0857, stage0_s: 0.0611, stage0_m: 0.1064, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1686, stage1_bag_acc: 13.3000, stage1_neg_loss: 0.0013, stage1_mean_ious: 0.0971, stage1_s: 0.0745, stage1_m: 0.1138, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8784, grad_norm: 5.7376
2024-10-15 12:26:30,390 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:28:44, time: 0.518, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.6884, stage0_bag_acc: 22.6167, stage0_mean_ious: 0.1238, stage0_s: 0.0802, stage0_m: 0.1675, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1719, stage1_bag_acc: 18.3071, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.1405, stage1_s: 0.0936, stage1_m: 0.1882, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8624, grad_norm: 6.4830
2024-10-15 12:26:55,713 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:27:53, time: 0.506, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.6781, stage0_bag_acc: 17.4214, stage0_mean_ious: 0.1275, stage0_s: 0.0957, stage0_m: 0.1362, stage0_l: 0.0146, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1607, stage1_bag_acc: 22.1889, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.1392, stage1_s: 0.1043, stage1_m: 0.1432, stage1_l: 0.0116, stage1_h: 0.0000, loss: 0.8436, grad_norm: 8.4669
2024-10-15 12:27:21,255 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:27:19, time: 0.511, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.6347, stage0_bag_acc: 29.9735, stage0_mean_ious: 0.1366, stage0_s: 0.0809, stage0_m: 0.1328, stage0_l: 0.0292, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1523, stage1_bag_acc: 32.8755, stage1_neg_loss: 0.0142, stage1_mean_ious: 0.1547, stage1_s: 0.0970, stage1_m: 0.1430, stage1_l: 0.0282, stage1_h: 0.0000, loss: 0.8013, grad_norm: 10.6645
2024-10-15 12:27:47,301 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:26:54, time: 0.521, data_time: 0.008, memory: 7794, stage0_loss_instance_mil: 0.5437, stage0_bag_acc: 38.6120, stage0_mean_ious: 0.2067, stage0_s: 0.1581, stage0_m: 0.1807, stage0_l: 0.0201, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1203, stage1_bag_acc: 43.4286, stage1_neg_loss: 0.0228, stage1_mean_ious: 0.2526, stage1_s: 0.2024, stage1_m: 0.1988, stage1_l: 0.0173, stage1_h: 0.0000, loss: 0.6869, grad_norm: 11.8986
2024-10-15 12:28:02,877 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 12:28:32,370 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:24:02, time: 0.545, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.4409, stage0_bag_acc: 53.3164, stage0_mean_ious: 0.3071, stage0_s: 0.2225, stage0_m: 0.3015, stage0_l: 0.0206, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1128, stage1_bag_acc: 62.6232, stage1_neg_loss: 0.0276, stage1_mean_ious: 0.3558, stage1_s: 0.2794, stage1_m: 0.3100, stage1_l: 0.0185, stage1_h: 0.0000, loss: 0.5813, grad_norm: 14.4134
2024-10-15 12:28:58,343 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:23:55, time: 0.519, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.3867, stage0_bag_acc: 63.9889, stage0_mean_ious: 0.3665, stage0_s: 0.3067, stage0_m: 0.3123, stage0_l: 0.0068, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0905, stage1_bag_acc: 62.9113, stage1_neg_loss: 0.0227, stage1_mean_ious: 0.4342, stage1_s: 0.3775, stage1_m: 0.3448, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.4999, grad_norm: 14.5040
2024-10-15 12:29:23,989 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:23:41, time: 0.513, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.3271, stage0_bag_acc: 74.5157, stage0_mean_ious: 0.3934, stage0_s: 0.3147, stage0_m: 0.3506, stage0_l: 0.0235, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0987, stage1_bag_acc: 72.4086, stage1_neg_loss: 0.0223, stage1_mean_ious: 0.4657, stage1_s: 0.4139, stage1_m: 0.3431, stage1_l: 0.0164, stage1_h: 0.0000, loss: 0.4481, grad_norm: 12.8040
2024-10-15 12:29:47,107 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:23:10, time: 0.462, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.2078, stage0_bag_acc: 83.1230, stage0_mean_ious: 0.4481, stage0_s: 0.3946, stage0_m: 0.3015, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0646, stage1_bag_acc: 82.9087, stage1_neg_loss: 0.0214, stage1_mean_ious: 0.5185, stage1_s: 0.4945, stage1_m: 0.2645, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2938, grad_norm: 12.0987
2024-10-15 12:30:11,490 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:22:47, time: 0.488, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.2115, stage0_bag_acc: 82.6355, stage0_mean_ious: 0.4126, stage0_s: 0.3739, stage0_m: 0.3028, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0763, stage1_bag_acc: 82.2022, stage1_neg_loss: 0.0196, stage1_mean_ious: 0.5020, stage1_s: 0.4773, stage1_m: 0.2927, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.3074, grad_norm: 11.2014
2024-10-15 12:30:26,793 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 12:30:54,119 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:21:07, time: 0.501, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.1356, stage0_bag_acc: 90.4308, stage0_mean_ious: 0.4694, stage0_s: 0.4424, stage0_m: 0.2649, stage0_l: 0.0092, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0539, stage1_bag_acc: 90.7087, stage1_neg_loss: 0.0132, stage1_mean_ious: 0.5375, stage1_s: 0.5388, stage1_m: 0.2374, stage1_l: 0.0092, stage1_h: 0.0000, loss: 0.2027, grad_norm: 8.7875
2024-10-15 12:31:20,151 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:20:57, time: 0.521, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0820, stage0_bag_acc: 93.6968, stage0_mean_ious: 0.4517, stage0_s: 0.4329, stage0_m: 0.3221, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0312, stage1_bag_acc: 95.0119, stage1_neg_loss: 0.0145, stage1_mean_ious: 0.5794, stage1_s: 0.5643, stage1_m: 0.3577, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1277, grad_norm: 6.6996
2024-10-15 12:31:43,982 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:20:35, time: 0.477, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.1763, stage0_bag_acc: 86.7000, stage0_mean_ious: 0.4594, stage0_s: 0.4130, stage0_m: 0.2979, stage0_l: 0.0130, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0366, stage1_bag_acc: 88.2056, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5576, stage1_s: 0.5539, stage1_m: 0.2830, stage1_l: 0.0075, stage1_h: 0.0000, loss: 0.2218, grad_norm: 8.9601
2024-10-15 12:32:08,537 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:20:16, time: 0.491, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1056, stage0_bag_acc: 92.6379, stage0_mean_ious: 0.4880, stage0_s: 0.4601, stage0_m: 0.3438, stage0_l: 0.0151, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0255, stage1_bag_acc: 92.5712, stage1_neg_loss: 0.0100, stage1_mean_ious: 0.5813, stage1_s: 0.5790, stage1_m: 0.3435, stage1_l: 0.0113, stage1_h: 0.0000, loss: 0.1411, grad_norm: 6.3369
2024-10-15 12:32:33,310 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:19:57, time: 0.495, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0994, stage0_bag_acc: 92.9389, stage0_mean_ious: 0.4598, stage0_s: 0.4181, stage0_m: 0.2889, stage0_l: 0.0266, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0290, stage1_bag_acc: 91.7111, stage1_neg_loss: 0.0095, stage1_mean_ious: 0.5684, stage1_s: 0.5506, stage1_m: 0.2838, stage1_l: 0.0195, stage1_h: 0.0000, loss: 0.1379, grad_norm: 6.4628
2024-10-15 12:32:48,913 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 12:34:04,666 - mmdet - INFO - Evaluating bbox...
2024-10-15 12:34:05,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2122
2024-10-15 12:34:05,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6901
2024-10-15 12:34:05,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4049
2024-10-15 12:34:05,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1285
2024-10-15 12:34:05,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0637
2024-10-15 12:34:05,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0242
2024-10-15 12:34:05,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-15 12:34:05,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:34:05,148 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2222
2024-10-15 12:34:05,149 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0617
2024-10-15 12:34:05,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3115
2024-10-15 12:34:05,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7851
2024-10-15 12:34:05,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3115
2024-10-15 12:34:05,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3115
2024-10-15 12:34:05,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:34:05,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3299
2024-10-15 12:34:05,149 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0840
2024-10-15 12:34:05,154 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 12:34:05,154 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2120, bbox_mAP_50: 0.6900, bbox_mAP_75: 0.4050, bbox_mAP_s: 0.1290, bbox_mAP_m: 0.0640, bbox_mAP_l: 0.0240, bbox_mAP_copypaste: 0.212 0.690 0.405 0.129 0.064 0.024
2024-10-15 12:34:32,990 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:18:53, time: 0.557, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0588, stage0_bag_acc: 94.9658, stage0_mean_ious: 0.4978, stage0_s: 0.4403, stage0_m: 0.3573, stage0_l: 0.0203, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0256, stage1_bag_acc: 95.0134, stage1_neg_loss: 0.0096, stage1_mean_ious: 0.5652, stage1_s: 0.5526, stage1_m: 0.3160, stage1_l: 0.0197, stage1_h: 0.0000, loss: 0.0940, grad_norm: 5.1515
2024-10-15 12:34:56,895 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:18:32, time: 0.478, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0893, stage0_bag_acc: 93.0214, stage0_mean_ious: 0.4634, stage0_s: 0.4369, stage0_m: 0.2541, stage0_l: 0.0181, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0341, stage1_bag_acc: 94.2071, stage1_neg_loss: 0.0116, stage1_mean_ious: 0.5938, stage1_s: 0.5811, stage1_m: 0.2655, stage1_l: 0.0118, stage1_h: 0.0000, loss: 0.1349, grad_norm: 6.7926
2024-10-15 12:35:22,329 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:18:15, time: 0.509, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0811, stage0_bag_acc: 93.2864, stage0_mean_ious: 0.4903, stage0_s: 0.4498, stage0_m: 0.4081, stage0_l: 0.0182, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0262, stage1_bag_acc: 93.6182, stage1_neg_loss: 0.0107, stage1_mean_ious: 0.5814, stage1_s: 0.5777, stage1_m: 0.3928, stage1_l: 0.0127, stage1_h: 0.0000, loss: 0.1180, grad_norm: 5.7251
2024-10-15 12:35:46,617 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:17:54, time: 0.486, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0616, stage0_bag_acc: 95.4421, stage0_mean_ious: 0.4791, stage0_s: 0.4487, stage0_m: 0.3391, stage0_l: 0.0098, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 95.4421, stage1_neg_loss: 0.0065, stage1_mean_ious: 0.5810, stage1_s: 0.5812, stage1_m: 0.3118, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0883, grad_norm: 4.6404
2024-10-15 12:36:11,331 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:17:35, time: 0.494, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0697, stage0_bag_acc: 94.6571, stage0_mean_ious: 0.4842, stage0_s: 0.4481, stage0_m: 0.2665, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0213, stage1_bag_acc: 94.1714, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.5759, stage1_s: 0.5673, stage1_m: 0.2673, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0995, grad_norm: 5.3138
2024-10-15 12:36:26,417 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 12:36:55,226 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:16:37, time: 0.531, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.0618, stage0_bag_acc: 95.5825, stage0_mean_ious: 0.4785, stage0_s: 0.4296, stage0_m: 0.3335, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0170, stage1_bag_acc: 96.6825, stage1_neg_loss: 0.0092, stage1_mean_ious: 0.5844, stage1_s: 0.5711, stage1_m: 0.3407, stage1_l: 0.0066, stage1_h: 0.0000, loss: 0.0880, grad_norm: 4.8469
2024-10-15 12:37:19,113 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:16:17, time: 0.478, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0949, stage0_bag_acc: 92.2056, stage0_mean_ious: 0.5027, stage0_s: 0.4316, stage0_m: 0.3745, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0258, stage1_bag_acc: 94.6556, stage1_neg_loss: 0.0087, stage1_mean_ious: 0.5982, stage1_s: 0.5605, stage1_m: 0.4049, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1294, grad_norm: 6.5153
2024-10-15 12:37:43,914 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:15:57, time: 0.496, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0414, stage0_bag_acc: 97.0500, stage0_mean_ious: 0.4562, stage0_s: 0.4221, stage0_m: 0.3340, stage0_l: 0.0112, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0162, stage1_bag_acc: 97.5682, stage1_neg_loss: 0.0129, stage1_mean_ious: 0.5722, stage1_s: 0.5669, stage1_m: 0.3613, stage1_l: 0.0102, stage1_h: 0.0000, loss: 0.0705, grad_norm: 4.3349
2024-10-15 12:38:08,978 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:15:37, time: 0.501, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0596, stage0_bag_acc: 95.1000, stage0_mean_ious: 0.5049, stage0_s: 0.4435, stage0_m: 0.3771, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0188, stage1_bag_acc: 95.6000, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5805, stage1_s: 0.5497, stage1_m: 0.3521, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0857, grad_norm: 4.7036
2024-10-15 12:38:33,246 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:15:16, time: 0.485, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0982, stage0_bag_acc: 91.7333, stage0_mean_ious: 0.4694, stage0_s: 0.4298, stage0_m: 0.2849, stage0_l: 0.0175, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0227, stage1_bag_acc: 92.6500, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5792, stage1_s: 0.5618, stage1_m: 0.2844, stage1_l: 0.0129, stage1_h: 0.0000, loss: 0.1264, grad_norm: 5.6808
2024-10-15 12:38:48,057 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 12:39:16,653 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:14:26, time: 0.528, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0556, stage0_bag_acc: 95.3292, stage0_mean_ious: 0.4994, stage0_s: 0.4906, stage0_m: 0.2722, stage0_l: 0.0140, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0170, stage1_bag_acc: 96.0149, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.5812, stage1_s: 0.5850, stage1_m: 0.2648, stage1_l: 0.0113, stage1_h: 0.0000, loss: 0.0809, grad_norm: 4.4897
2024-10-15 12:39:41,382 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:14:06, time: 0.495, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0297, stage0_bag_acc: 97.5500, stage0_mean_ious: 0.4932, stage0_s: 0.4364, stage0_m: 0.3505, stage0_l: 0.0156, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0191, stage1_bag_acc: 98.4500, stage1_neg_loss: 0.0090, stage1_mean_ious: 0.5720, stage1_s: 0.5384, stage1_m: 0.3494, stage1_l: 0.0134, stage1_h: 0.0000, loss: 0.0578, grad_norm: 3.9352
2024-10-15 12:40:06,557 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:13:46, time: 0.503, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0432, stage0_bag_acc: 96.8030, stage0_mean_ious: 0.4890, stage0_s: 0.4540, stage0_m: 0.3741, stage0_l: 0.0122, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0155, stage1_bag_acc: 98.2348, stage1_neg_loss: 0.0078, stage1_mean_ious: 0.5985, stage1_s: 0.5993, stage1_m: 0.3852, stage1_l: 0.0150, stage1_h: 0.0000, loss: 0.0664, grad_norm: 4.4249
2024-10-15 12:40:31,798 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:13:25, time: 0.505, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0506, stage0_bag_acc: 96.9810, stage0_mean_ious: 0.4864, stage0_s: 0.4326, stage0_m: 0.3663, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0154, stage1_bag_acc: 96.2643, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5874, stage1_s: 0.5716, stage1_m: 0.3441, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0723, grad_norm: 3.8790
2024-10-15 12:40:57,374 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:13:05, time: 0.512, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0552, stage0_bag_acc: 96.0611, stage0_mean_ious: 0.4597, stage0_s: 0.4355, stage0_m: 0.3725, stage0_l: 0.0120, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0187, stage1_bag_acc: 97.0778, stage1_neg_loss: 0.0071, stage1_mean_ious: 0.5669, stage1_s: 0.5585, stage1_m: 0.3857, stage1_l: 0.0077, stage1_h: 0.0000, loss: 0.0810, grad_norm: 4.8872
2024-10-15 12:41:12,601 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 12:42:28,308 - mmdet - INFO - Evaluating bbox...
2024-10-15 12:42:28,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2096
2024-10-15 12:42:28,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6826
2024-10-15 12:42:28,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3979
2024-10-15 12:42:28,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1282
2024-10-15 12:42:28,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0587
2024-10-15 12:42:28,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0189
2024-10-15 12:42:28,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-15 12:42:28,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:42:28,870 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2218
2024-10-15 12:42:28,870 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0641
2024-10-15 12:42:28,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3136
2024-10-15 12:42:28,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7848
2024-10-15 12:42:28,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3136
2024-10-15 12:42:28,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3136
2024-10-15 12:42:28,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:42:28,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3329
2024-10-15 12:42:28,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0891
2024-10-15 12:42:28,876 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 12:42:28,876 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2100, bbox_mAP_50: 0.6830, bbox_mAP_75: 0.3980, bbox_mAP_s: 0.1280, bbox_mAP_m: 0.0590, bbox_mAP_l: 0.0190, bbox_mAP_copypaste: 0.210 0.683 0.398 0.128 0.059 0.019
2024-10-15 12:42:56,444 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:12:20, time: 0.551, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0322, stage0_bag_acc: 97.8278, stage0_mean_ious: 0.5132, stage0_s: 0.4627, stage0_m: 0.3838, stage0_l: 0.0113, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0095, stage1_bag_acc: 97.1278, stage1_neg_loss: 0.0045, stage1_mean_ious: 0.5893, stage1_s: 0.5950, stage1_m: 0.3642, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0462, grad_norm: 2.6961
2024-10-15 12:43:21,428 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:11:59, time: 0.500, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0297, stage0_bag_acc: 97.9810, stage0_mean_ious: 0.4811, stage0_s: 0.4517, stage0_m: 0.3088, stage0_l: 0.0093, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0112, stage1_bag_acc: 97.1921, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5867, stage1_s: 0.5726, stage1_m: 0.3269, stage1_l: 0.0102, stage1_h: 0.0000, loss: 0.0459, grad_norm: 2.6335
2024-10-15 12:43:46,447 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:11:38, time: 0.500, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0489, stage0_bag_acc: 96.3532, stage0_mean_ious: 0.4909, stage0_s: 0.4535, stage0_m: 0.3738, stage0_l: 0.0240, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0151, stage1_bag_acc: 97.6667, stage1_neg_loss: 0.0099, stage1_mean_ious: 0.5662, stage1_s: 0.5590, stage1_m: 0.3576, stage1_l: 0.0187, stage1_h: 0.0000, loss: 0.0740, grad_norm: 4.5856
2024-10-15 12:44:11,135 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:11:17, time: 0.494, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0224, stage0_bag_acc: 98.6778, stage0_mean_ious: 0.4795, stage0_s: 0.4110, stage0_m: 0.3714, stage0_l: 0.0236, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0083, stage1_bag_acc: 98.6960, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5871, stage1_s: 0.5472, stage1_m: 0.3935, stage1_l: 0.0150, stage1_h: 0.0000, loss: 0.0344, grad_norm: 2.4045
2024-10-15 12:44:36,138 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:10:56, time: 0.500, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0358, stage0_bag_acc: 97.4167, stage0_mean_ious: 0.4930, stage0_s: 0.4550, stage0_m: 0.3394, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0110, stage1_bag_acc: 97.6167, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5885, stage1_s: 0.5815, stage1_m: 0.3253, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0498, grad_norm: 3.2654
2024-10-15 12:44:51,865 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 12:45:22,097 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:10:13, time: 0.560, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0267, stage0_bag_acc: 97.6452, stage0_mean_ious: 0.4772, stage0_s: 0.4564, stage0_m: 0.3548, stage0_l: 0.0305, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0101, stage1_bag_acc: 98.1087, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.5740, stage1_s: 0.5801, stage1_m: 0.3511, stage1_l: 0.0226, stage1_h: 0.0000, loss: 0.0401, grad_norm: 2.8176
2024-10-15 12:45:46,870 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:09:52, time: 0.495, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0343, stage0_bag_acc: 97.7143, stage0_mean_ious: 0.4908, stage0_s: 0.4434, stage0_m: 0.2905, stage0_l: 0.0214, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 97.4643, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5833, stage1_s: 0.5705, stage1_m: 0.2966, stage1_l: 0.0123, stage1_h: 0.0000, loss: 0.0519, grad_norm: 3.6680
2024-10-15 12:46:11,469 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:09:30, time: 0.492, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0335, stage0_bag_acc: 97.3167, stage0_mean_ious: 0.4781, stage0_s: 0.4483, stage0_m: 0.3258, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0132, stage1_bag_acc: 97.8500, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5485, stage1_s: 0.5514, stage1_m: 0.3064, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0547, grad_norm: 4.7011
2024-10-15 12:46:36,495 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:09:08, time: 0.501, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0368, stage0_bag_acc: 97.9167, stage0_mean_ious: 0.4939, stage0_s: 0.4213, stage0_m: 0.3724, stage0_l: 0.0153, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0148, stage1_bag_acc: 98.0667, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5751, stage1_s: 0.5536, stage1_m: 0.3447, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.0576, grad_norm: 3.6856
2024-10-15 12:47:01,921 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:08:47, time: 0.509, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0408, stage0_bag_acc: 96.4667, stage0_mean_ious: 0.4977, stage0_s: 0.4531, stage0_m: 0.3364, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0140, stage1_bag_acc: 97.2167, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5896, stage1_s: 0.5701, stage1_m: 0.3317, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0612, grad_norm: 3.5774
2024-10-15 12:47:16,559 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 12:47:45,795 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:08:06, time: 0.540, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0346, stage0_bag_acc: 96.8500, stage0_mean_ious: 0.4925, stage0_s: 0.4728, stage0_m: 0.2739, stage0_l: 0.0193, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0111, stage1_bag_acc: 97.7500, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5851, stage1_s: 0.5855, stage1_m: 0.2580, stage1_l: 0.0133, stage1_h: 0.0000, loss: 0.0485, grad_norm: 2.8216
2024-10-15 12:48:11,273 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:07:44, time: 0.510, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0323, stage0_bag_acc: 98.0000, stage0_mean_ious: 0.4786, stage0_s: 0.4286, stage0_m: 0.4067, stage0_l: 0.0103, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0146, stage1_bag_acc: 98.5000, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5643, stage1_s: 0.5540, stage1_m: 0.4019, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.0509, grad_norm: 2.8002
2024-10-15 12:48:36,473 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:07:22, time: 0.504, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0205, stage0_bag_acc: 98.4786, stage0_mean_ious: 0.5012, stage0_s: 0.4618, stage0_m: 0.4117, stage0_l: 0.0200, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0077, stage1_bag_acc: 98.6786, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5981, stage1_s: 0.5967, stage1_m: 0.4170, stage1_l: 0.0116, stage1_h: 0.0000, loss: 0.0329, grad_norm: 2.3563
2024-10-15 12:49:02,571 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:07:01, time: 0.522, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0258, stage0_bag_acc: 98.4500, stage0_mean_ious: 0.5038, stage0_s: 0.4261, stage0_m: 0.3951, stage0_l: 0.0253, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0124, stage1_bag_acc: 98.4500, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5939, stage1_s: 0.5587, stage1_m: 0.3688, stage1_l: 0.0207, stage1_h: 0.0000, loss: 0.0408, grad_norm: 2.0136
2024-10-15 12:49:28,935 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:06:39, time: 0.527, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0195, stage0_bag_acc: 98.5667, stage0_mean_ious: 0.4959, stage0_s: 0.4605, stage0_m: 0.3830, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0068, stage1_bag_acc: 98.3310, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5928, stage1_s: 0.5922, stage1_m: 0.3863, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0297, grad_norm: 2.2756
2024-10-15 12:49:43,655 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 12:50:59,438 - mmdet - INFO - Evaluating bbox...
2024-10-15 12:50:59,995 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2077
2024-10-15 12:50:59,995 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6724
2024-10-15 12:50:59,996 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3991
2024-10-15 12:50:59,996 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1237
2024-10-15 12:50:59,996 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0607
2024-10-15 12:50:59,996 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0201
2024-10-15 12:50:59,996 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-10-15 12:50:59,996 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:50:59,996 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2192
2024-10-15 12:50:59,996 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0520
2024-10-15 12:50:59,996 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3086
2024-10-15 12:50:59,997 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7763
2024-10-15 12:50:59,997 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3086
2024-10-15 12:50:59,997 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3086
2024-10-15 12:50:59,997 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:50:59,997 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3274
2024-10-15 12:50:59,997 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0950
2024-10-15 12:51:00,002 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 12:51:00,002 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2080, bbox_mAP_50: 0.6720, bbox_mAP_75: 0.3990, bbox_mAP_s: 0.1240, bbox_mAP_m: 0.0610, bbox_mAP_l: 0.0200, bbox_mAP_copypaste: 0.208 0.672 0.399 0.124 0.061 0.020
2024-10-15 12:51:27,317 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:05:59, time: 0.546, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0170, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.4905, stage0_s: 0.4664, stage0_m: 0.3235, stage0_l: 0.0072, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0070, stage1_bag_acc: 98.5000, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5874, stage1_s: 0.5985, stage1_m: 0.3189, stage1_l: 0.0061, stage1_h: 0.0000, loss: 0.0265, grad_norm: 1.8079
2024-10-15 12:51:52,456 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:05:37, time: 0.503, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0210, stage0_bag_acc: 98.5087, stage0_mean_ious: 0.4934, stage0_s: 0.4580, stage0_m: 0.3977, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.8833, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5835, stage1_s: 0.5806, stage1_m: 0.4018, stage1_l: 0.0091, stage1_h: 0.0000, loss: 0.0303, grad_norm: 1.6955
2024-10-15 12:52:16,813 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:05:15, time: 0.487, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0185, stage0_bag_acc: 98.7667, stage0_mean_ious: 0.4900, stage0_s: 0.4481, stage0_m: 0.3954, stage0_l: 0.0245, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0072, stage1_bag_acc: 98.5167, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5676, stage1_s: 0.5656, stage1_m: 0.3513, stage1_l: 0.0168, stage1_h: 0.0000, loss: 0.0287, grad_norm: 2.1401
2024-10-15 12:52:40,890 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:04:52, time: 0.482, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0096, stage0_bag_acc: 99.8000, stage0_mean_ious: 0.4963, stage0_s: 0.4632, stage0_m: 0.3236, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0062, stage1_bag_acc: 99.6000, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5887, stage1_s: 0.5854, stage1_m: 0.3254, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0215, grad_norm: 1.7208
2024-10-15 12:53:05,832 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:04:30, time: 0.499, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0308, stage0_bag_acc: 97.9380, stage0_mean_ious: 0.4853, stage0_s: 0.4184, stage0_m: 0.3981, stage0_l: 0.0148, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 97.8421, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5645, stage1_s: 0.5271, stage1_m: 0.3785, stage1_l: 0.0104, stage1_h: 0.0000, loss: 0.0427, grad_norm: 2.3132
2024-10-15 12:53:19,563 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 12:53:49,320 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:03:52, time: 0.551, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.0189, stage0_bag_acc: 98.7364, stage0_mean_ious: 0.4708, stage0_s: 0.4316, stage0_m: 0.3352, stage0_l: 0.0091, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0078, stage1_bag_acc: 98.2864, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5784, stage1_s: 0.5731, stage1_m: 0.3374, stage1_l: 0.0123, stage1_h: 0.0000, loss: 0.0311, grad_norm: 2.1897
2024-10-15 12:54:14,225 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:03:29, time: 0.498, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0365, stage0_bag_acc: 97.2682, stage0_mean_ious: 0.4695, stage0_s: 0.4104, stage0_m: 0.3604, stage0_l: 0.0206, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 97.7126, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5446, stage1_s: 0.5220, stage1_m: 0.3315, stage1_l: 0.0132, stage1_h: 0.0000, loss: 0.0528, grad_norm: 3.2805
2024-10-15 12:54:40,006 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:03:07, time: 0.516, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0084, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.5150, stage0_s: 0.4595, stage0_m: 0.3969, stage0_l: 0.0077, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0037, stage1_bag_acc: 99.8000, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5774, stage1_s: 0.5668, stage1_m: 0.3716, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.0159, grad_norm: 1.5763
2024-10-15 12:55:04,481 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 12:55:04,481 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:02:44, time: 0.489, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0170, stage0_bag_acc: 98.9848, stage0_mean_ious: 0.5101, stage0_s: 0.4515, stage0_m: 0.3725, stage0_l: 0.0368, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0036, stage1_bag_acc: 99.1667, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.6044, stage1_s: 0.5757, stage1_m: 0.3789, stage1_l: 0.0372, stage1_h: 0.0000, loss: 0.0244, grad_norm: 1.6024
2024-10-15 12:55:29,077 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:02:21, time: 0.492, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0284, stage0_bag_acc: 97.8500, stage0_mean_ious: 0.5125, stage0_s: 0.4734, stage0_m: 0.3194, stage0_l: 0.0073, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 97.3167, stage1_neg_loss: 0.0011, stage1_mean_ious: 0.6058, stage1_s: 0.5936, stage1_m: 0.3047, stage1_l: 0.0064, stage1_h: 0.0000, loss: 0.0385, grad_norm: 2.4578
2024-10-15 12:55:43,477 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 12:56:13,749 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:01:44, time: 0.563, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.0128, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.5028, stage0_s: 0.4671, stage0_m: 0.3557, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0065, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.6058, stage1_s: 0.6063, stage1_m: 0.3436, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0221, grad_norm: 1.9026
2024-10-15 12:56:37,530 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:01:21, time: 0.476, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0088, stage0_bag_acc: 99.4667, stage0_mean_ious: 0.4951, stage0_s: 0.4517, stage0_m: 0.2952, stage0_l: 0.0049, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0033, stage1_bag_acc: 99.8000, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5829, stage1_s: 0.5685, stage1_m: 0.2836, stage1_l: 0.0039, stage1_h: 0.0000, loss: 0.0161, grad_norm: 1.6266
2024-10-15 12:57:02,354 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.496, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0179, stage0_bag_acc: 98.6500, stage0_mean_ious: 0.4857, stage0_s: 0.4628, stage0_m: 0.2777, stage0_l: 0.0070, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0041, stage1_bag_acc: 98.2786, stage1_neg_loss: 0.0090, stage1_mean_ious: 0.5771, stage1_s: 0.5849, stage1_m: 0.2716, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0311, grad_norm: 2.7136
2024-10-15 12:57:27,180 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:36, time: 0.497, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0078, stage0_bag_acc: 99.4667, stage0_mean_ious: 0.5016, stage0_s: 0.4637, stage0_m: 0.3263, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0057, stage1_bag_acc: 99.4667, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5991, stage1_s: 0.5991, stage1_m: 0.3151, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0179, grad_norm: 1.3936
2024-10-15 12:57:51,629 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:13, time: 0.489, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0301, stage0_bag_acc: 97.4833, stage0_mean_ious: 0.4886, stage0_s: 0.4546, stage0_m: 0.3274, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0099, stage1_bag_acc: 97.0333, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5716, stage1_s: 0.5724, stage1_m: 0.3091, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0418, grad_norm: 2.8254
2024-10-15 12:58:07,131 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 12:59:22,555 - mmdet - INFO - Evaluating bbox...
2024-10-15 12:59:23,106 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2092
2024-10-15 12:59:23,106 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6753
2024-10-15 12:59:23,106 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4037
2024-10-15 12:59:23,106 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1263
2024-10-15 12:59:23,106 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0618
2024-10-15 12:59:23,106 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0197
2024-10-15 12:59:23,106 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-10-15 12:59:23,107 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:59:23,107 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2202
2024-10-15 12:59:23,107 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0557
2024-10-15 12:59:23,107 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3102
2024-10-15 12:59:23,107 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7780
2024-10-15 12:59:23,107 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3102
2024-10-15 12:59:23,107 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3102
2024-10-15 12:59:23,107 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 12:59:23,107 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3288
2024-10-15 12:59:23,107 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0959
2024-10-15 12:59:23,113 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 12:59:23,113 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2090, bbox_mAP_50: 0.6750, bbox_mAP_75: 0.4040, bbox_mAP_s: 0.1260, bbox_mAP_m: 0.0620, bbox_mAP_l: 0.0200, bbox_mAP_copypaste: 0.209 0.675 0.404 0.126 0.062 0.020
2024-10-15 13:00:37,687 - mmdet - INFO - Evaluating bbox...
2024-10-15 13:00:38,174 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2092
2024-10-15 13:00:38,174 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6753
2024-10-15 13:00:38,174 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4037
2024-10-15 13:00:38,175 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1263
2024-10-15 13:00:38,175 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0618
2024-10-15 13:00:38,175 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0197
2024-10-15 13:00:38,175 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-10-15 13:00:38,175 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:00:38,175 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2202
2024-10-15 13:00:38,175 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0557
2024-10-15 13:00:38,175 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3102
2024-10-15 13:00:38,175 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7780
2024-10-15 13:00:38,175 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3102
2024-10-15 13:00:38,175 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3102
2024-10-15 13:00:38,176 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:00:38,176 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3288
2024-10-15 13:00:38,176 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0959
2024-10-15 13:00:39,491 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+d7eacca
------------------------------------------------------------

2024-10-15 13:00:40,460 - mmdet - INFO - Distributed training: False
2024-10-15 13:00:41,365 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 13:00:42,293 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 13:00:42,293 - mmdet - INFO - Use load_from_local loader
2024-10-15 13:00:42,543 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 13:00:42,549 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 13:00:42,549 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 13:01:10,236 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:30:32, time: 0.554, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.7215, stage0_bag_acc: 14.9714, stage0_mean_ious: 0.0505, stage0_s: 0.0403, stage0_m: 0.0457, stage0_l: 0.0106, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1515, stage1_bag_acc: 17.0214, stage1_neg_loss: 0.0012, stage1_mean_ious: 0.0554, stage1_s: 0.0432, stage1_m: 0.0508, stage1_l: 0.0088, stage1_h: 0.0000, loss: 0.8742, grad_norm: 6.0336
2024-10-15 13:01:35,464 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:28:44, time: 0.505, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.7091, stage0_bag_acc: 10.6684, stage0_mean_ious: 0.0600, stage0_s: 0.0493, stage0_m: 0.0451, stage0_l: 0.0093, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1563, stage1_bag_acc: 15.8497, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.0650, stage1_s: 0.0523, stage1_m: 0.0518, stage1_l: 0.0107, stage1_h: 0.0000, loss: 0.8670, grad_norm: 6.5932
2024-10-15 13:02:00,290 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:27:43, time: 0.497, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.6891, stage0_bag_acc: 16.1283, stage0_mean_ious: 0.1287, stage0_s: 0.1051, stage0_m: 0.1276, stage0_l: 0.0097, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1489, stage1_bag_acc: 27.6616, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.1233, stage1_s: 0.1018, stage1_m: 0.1186, stage1_l: 0.0091, stage1_h: 0.0000, loss: 0.8433, grad_norm: 9.0738
2024-10-15 13:02:24,236 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:26:46, time: 0.479, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.6799, stage0_bag_acc: 25.6828, stage0_mean_ious: 0.1231, stage0_s: 0.0898, stage0_m: 0.1130, stage0_l: 0.0237, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1315, stage1_bag_acc: 26.5170, stage1_neg_loss: 0.0133, stage1_mean_ious: 0.1241, stage1_s: 0.0914, stage1_m: 0.1114, stage1_l: 0.0196, stage1_h: 0.0000, loss: 0.8247, grad_norm: 12.9500
2024-10-15 13:02:50,160 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:26:27, time: 0.518, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.6083, stage0_bag_acc: 31.4516, stage0_mean_ious: 0.1471, stage0_s: 0.1144, stage0_m: 0.1213, stage0_l: 0.0089, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1254, stage1_bag_acc: 44.2063, stage1_neg_loss: 0.0233, stage1_mean_ious: 0.1702, stage1_s: 0.1328, stage1_m: 0.1351, stage1_l: 0.0108, stage1_h: 0.0000, loss: 0.7570, grad_norm: 12.1820
2024-10-15 13:03:05,002 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 13:03:34,694 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:23:44, time: 0.550, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.4921, stage0_bag_acc: 48.0293, stage0_mean_ious: 0.2706, stage0_s: 0.2207, stage0_m: 0.2374, stage0_l: 0.0139, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1143, stage1_bag_acc: 53.9854, stage1_neg_loss: 0.0219, stage1_mean_ious: 0.3226, stage1_s: 0.2883, stage1_m: 0.2560, stage1_l: 0.0104, stage1_h: 0.0000, loss: 0.6283, grad_norm: 12.9906
2024-10-15 13:03:59,714 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:23:32, time: 0.500, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.4446, stage0_bag_acc: 53.5582, stage0_mean_ious: 0.2965, stage0_s: 0.2552, stage0_m: 0.2170, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0968, stage1_bag_acc: 57.7496, stage1_neg_loss: 0.0187, stage1_mean_ious: 0.3588, stage1_s: 0.3295, stage1_m: 0.2403, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.5600, grad_norm: 11.9543
2024-10-15 13:04:24,862 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:23:18, time: 0.503, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.3557, stage0_bag_acc: 64.4895, stage0_mean_ious: 0.3702, stage0_s: 0.3261, stage0_m: 0.2846, stage0_l: 0.0227, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0840, stage1_bag_acc: 64.2775, stage1_neg_loss: 0.0177, stage1_mean_ious: 0.4424, stage1_s: 0.4149, stage1_m: 0.2843, stage1_l: 0.0190, stage1_h: 0.0000, loss: 0.4573, grad_norm: 12.9515
2024-10-15 13:04:51,496 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:23:11, time: 0.533, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.2568, stage0_bag_acc: 77.3595, stage0_mean_ious: 0.4034, stage0_s: 0.3478, stage0_m: 0.3290, stage0_l: 0.0145, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0732, stage1_bag_acc: 78.5929, stage1_neg_loss: 0.0181, stage1_mean_ious: 0.4960, stage1_s: 0.4637, stage1_m: 0.3208, stage1_l: 0.0115, stage1_h: 0.0000, loss: 0.3480, grad_norm: 11.8071
2024-10-15 13:05:15,939 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:22:48, time: 0.489, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.1729, stage0_bag_acc: 85.1714, stage0_mean_ious: 0.4483, stage0_s: 0.3995, stage0_m: 0.3791, stage0_l: 0.0192, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0700, stage1_bag_acc: 86.9714, stage1_neg_loss: 0.0203, stage1_mean_ious: 0.5025, stage1_s: 0.4777, stage1_m: 0.3637, stage1_l: 0.0144, stage1_h: 0.0000, loss: 0.2631, grad_norm: 11.1348
2024-10-15 13:05:30,950 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 13:06:00,604 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:21:19, time: 0.548, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.1923, stage0_bag_acc: 84.2245, stage0_mean_ious: 0.4568, stage0_s: 0.4297, stage0_m: 0.2990, stage0_l: 0.0304, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0436, stage1_bag_acc: 85.6134, stage1_neg_loss: 0.0134, stage1_mean_ious: 0.5232, stage1_s: 0.5173, stage1_m: 0.2875, stage1_l: 0.0206, stage1_h: 0.0000, loss: 0.2493, grad_norm: 10.7182
2024-10-15 13:06:25,572 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:21:02, time: 0.499, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1305, stage0_bag_acc: 89.4675, stage0_mean_ious: 0.4697, stage0_s: 0.4096, stage0_m: 0.3370, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0383, stage1_bag_acc: 92.0738, stage1_neg_loss: 0.0188, stage1_mean_ious: 0.5547, stage1_s: 0.5351, stage1_m: 0.3358, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1876, grad_norm: 8.6764
2024-10-15 13:06:51,210 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:20:47, time: 0.513, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1488, stage0_bag_acc: 89.1810, stage0_mean_ious: 0.4529, stage0_s: 0.3912, stage0_m: 0.3588, stage0_l: 0.0115, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0412, stage1_bag_acc: 89.0389, stage1_neg_loss: 0.0101, stage1_mean_ious: 0.5489, stage1_s: 0.5190, stage1_m: 0.3758, stage1_l: 0.0083, stage1_h: 0.0000, loss: 0.2001, grad_norm: 7.6741
2024-10-15 13:07:16,271 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:20:29, time: 0.501, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0981, stage0_bag_acc: 92.5000, stage0_mean_ious: 0.5021, stage0_s: 0.4345, stage0_m: 0.4331, stage0_l: 0.0196, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0271, stage1_bag_acc: 91.8682, stage1_neg_loss: 0.0100, stage1_mean_ious: 0.5752, stage1_s: 0.5560, stage1_m: 0.4107, stage1_l: 0.0205, stage1_h: 0.0000, loss: 0.1352, grad_norm: 7.0062
2024-10-15 13:07:41,641 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:20:11, time: 0.507, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.1177, stage0_bag_acc: 90.1738, stage0_mean_ious: 0.4447, stage0_s: 0.4067, stage0_m: 0.2985, stage0_l: 0.0075, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0299, stage1_bag_acc: 90.5317, stage1_neg_loss: 0.0111, stage1_mean_ious: 0.5473, stage1_s: 0.5370, stage1_m: 0.3228, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.1587, grad_norm: 6.9991
2024-10-15 13:07:56,085 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 13:09:11,620 - mmdet - INFO - Evaluating bbox...
2024-10-15 13:09:12,091 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1943
2024-10-15 13:09:12,092 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6557
2024-10-15 13:09:12,092 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3705
2024-10-15 13:09:12,092 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1089
2024-10-15 13:09:12,092 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0486
2024-10-15 13:09:12,092 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0191
2024-10-15 13:09:12,092 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-15 13:09:12,092 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:09:12,092 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2049
2024-10-15 13:09:12,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0556
2024-10-15 13:09:12,093 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2962
2024-10-15 13:09:12,093 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7681
2024-10-15 13:09:12,093 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2962
2024-10-15 13:09:12,093 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2962
2024-10-15 13:09:12,093 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:09:12,093 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3139
2024-10-15 13:09:12,093 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0889
2024-10-15 13:09:12,099 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 13:09:12,099 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.1940, bbox_mAP_50: 0.6560, bbox_mAP_75: 0.3700, bbox_mAP_s: 0.1090, bbox_mAP_m: 0.0490, bbox_mAP_l: 0.0190, bbox_mAP_copypaste: 0.194 0.656 0.370 0.109 0.049 0.019
2024-10-15 13:09:39,465 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:19:03, time: 0.547, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.0848, stage0_bag_acc: 93.0087, stage0_mean_ious: 0.4752, stage0_s: 0.4224, stage0_m: 0.3523, stage0_l: 0.0074, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0265, stage1_bag_acc: 93.2444, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.5652, stage1_s: 0.5476, stage1_m: 0.3365, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.1187, grad_norm: 5.5332
2024-10-15 13:10:03,565 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:18:43, time: 0.482, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0598, stage0_bag_acc: 95.6278, stage0_mean_ious: 0.4787, stage0_s: 0.4443, stage0_m: 0.3199, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0237, stage1_bag_acc: 95.9778, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5612, stage1_s: 0.5566, stage1_m: 0.3211, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0924, grad_norm: 4.4600
2024-10-15 13:10:27,029 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:18:20, time: 0.469, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0780, stage0_bag_acc: 93.6325, stage0_mean_ious: 0.4948, stage0_s: 0.4468, stage0_m: 0.2926, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0277, stage1_bag_acc: 93.5340, stage1_neg_loss: 0.0098, stage1_mean_ious: 0.5645, stage1_s: 0.5466, stage1_m: 0.2884, stage1_l: 0.0050, stage1_h: 0.0000, loss: 0.1155, grad_norm: 6.4723
2024-10-15 13:10:51,932 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:18:01, time: 0.498, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0871, stage0_bag_acc: 92.9742, stage0_mean_ious: 0.4725, stage0_s: 0.4303, stage0_m: 0.3676, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0240, stage1_bag_acc: 92.6417, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5684, stage1_s: 0.5585, stage1_m: 0.3646, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1192, grad_norm: 6.6167
2024-10-15 13:11:17,458 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:17:42, time: 0.511, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0496, stage0_bag_acc: 96.9571, stage0_mean_ious: 0.4888, stage0_s: 0.4257, stage0_m: 0.3150, stage0_l: 0.0348, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0167, stage1_bag_acc: 97.1929, stage1_neg_loss: 0.0082, stage1_mean_ious: 0.5674, stage1_s: 0.5422, stage1_m: 0.2825, stage1_l: 0.0250, stage1_h: 0.0000, loss: 0.0745, grad_norm: 4.0337
2024-10-15 13:11:31,803 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 13:12:01,521 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:16:46, time: 0.551, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0417, stage0_bag_acc: 96.8855, stage0_mean_ious: 0.4968, stage0_s: 0.4640, stage0_m: 0.3939, stage0_l: 0.0109, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0170, stage1_bag_acc: 97.8355, stage1_neg_loss: 0.0064, stage1_mean_ious: 0.5906, stage1_s: 0.5924, stage1_m: 0.3855, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0651, grad_norm: 4.1755
2024-10-15 13:12:26,320 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:16:26, time: 0.496, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0492, stage0_bag_acc: 96.0325, stage0_mean_ious: 0.4905, stage0_s: 0.4679, stage0_m: 0.3001, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0186, stage1_bag_acc: 96.7991, stage1_neg_loss: 0.0140, stage1_mean_ious: 0.5872, stage1_s: 0.5860, stage1_m: 0.2992, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0817, grad_norm: 5.4311
2024-10-15 13:12:51,803 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:16:07, time: 0.510, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0556, stage0_bag_acc: 96.1333, stage0_mean_ious: 0.5145, stage0_s: 0.4717, stage0_m: 0.3840, stage0_l: 0.0106, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0180, stage1_bag_acc: 97.2167, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5834, stage1_s: 0.5613, stage1_m: 0.3846, stage1_l: 0.0064, stage1_h: 0.0000, loss: 0.0825, grad_norm: 5.5966
2024-10-15 13:13:17,709 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:15:48, time: 0.518, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0775, stage0_bag_acc: 94.1801, stage0_mean_ious: 0.4931, stage0_s: 0.4508, stage0_m: 0.3662, stage0_l: 0.0075, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0148, stage1_bag_acc: 95.3801, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.5719, stage1_s: 0.5647, stage1_m: 0.3551, stage1_l: 0.0075, stage1_h: 0.0000, loss: 0.0997, grad_norm: 5.2249
2024-10-15 13:13:41,955 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:15:26, time: 0.485, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0590, stage0_bag_acc: 95.4111, stage0_mean_ious: 0.4716, stage0_s: 0.4172, stage0_m: 0.3010, stage0_l: 0.0130, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0218, stage1_bag_acc: 95.4778, stage1_neg_loss: 0.0121, stage1_mean_ious: 0.5740, stage1_s: 0.5445, stage1_m: 0.3026, stage1_l: 0.0130, stage1_h: 0.0000, loss: 0.0929, grad_norm: 5.8574
2024-10-15 13:13:57,429 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-15 13:14:27,042 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:14:36, time: 0.549, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0663, stage0_bag_acc: 94.3712, stage0_mean_ious: 0.4990, stage0_s: 0.4424, stage0_m: 0.3796, stage0_l: 0.0073, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0196, stage1_bag_acc: 95.7101, stage1_neg_loss: 0.0090, stage1_mean_ious: 0.5634, stage1_s: 0.5456, stage1_m: 0.3651, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.0950, grad_norm: 5.7221
2024-10-15 13:14:52,928 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:14:17, time: 0.518, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0444, stage0_bag_acc: 95.9810, stage0_mean_ious: 0.4900, stage0_s: 0.4526, stage0_m: 0.3415, stage0_l: 0.0109, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0156, stage1_bag_acc: 96.1476, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5885, stage1_s: 0.5885, stage1_m: 0.3257, stage1_l: 0.0079, stage1_h: 0.0000, loss: 0.0660, grad_norm: 4.3317
2024-10-15 13:15:17,825 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:13:56, time: 0.498, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0333, stage0_bag_acc: 96.5810, stage0_mean_ious: 0.5157, stage0_s: 0.4793, stage0_m: 0.3270, stage0_l: 0.0202, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0126, stage1_bag_acc: 96.7810, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5864, stage1_s: 0.5778, stage1_m: 0.3064, stage1_l: 0.0199, stage1_h: 0.0000, loss: 0.0500, grad_norm: 3.5559
2024-10-15 13:15:43,507 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:13:36, time: 0.514, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0675, stage0_bag_acc: 94.6167, stage0_mean_ious: 0.4782, stage0_s: 0.4375, stage0_m: 0.3451, stage0_l: 0.0067, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0169, stage1_bag_acc: 95.5667, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.5798, stage1_s: 0.5671, stage1_m: 0.3499, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0916, grad_norm: 5.3686
2024-10-15 13:16:09,263 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:13:15, time: 0.515, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0459, stage0_bag_acc: 95.8500, stage0_mean_ious: 0.4745, stage0_s: 0.4158, stage0_m: 0.3805, stage0_l: 0.0307, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0146, stage1_bag_acc: 96.0500, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5697, stage1_s: 0.5327, stage1_m: 0.3944, stage1_l: 0.0251, stage1_h: 0.0000, loss: 0.0661, grad_norm: 3.5251
2024-10-15 13:16:24,024 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-15 13:17:40,560 - mmdet - INFO - Evaluating bbox...
2024-10-15 13:17:41,037 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2045
2024-10-15 13:17:41,037 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6600
2024-10-15 13:17:41,037 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3963
2024-10-15 13:17:41,037 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1277
2024-10-15 13:17:41,037 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0555
2024-10-15 13:17:41,037 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0181
2024-10-15 13:17:41,037 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-15 13:17:41,037 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:17:41,037 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2149
2024-10-15 13:17:41,038 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0429
2024-10-15 13:17:41,038 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3054
2024-10-15 13:17:41,038 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7683
2024-10-15 13:17:41,038 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3054
2024-10-15 13:17:41,038 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3054
2024-10-15 13:17:41,038 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:17:41,038 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3235
2024-10-15 13:17:41,038 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0734
2024-10-15 13:17:41,043 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 13:17:41,044 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2040, bbox_mAP_50: 0.6600, bbox_mAP_75: 0.3960, bbox_mAP_s: 0.1280, bbox_mAP_m: 0.0550, bbox_mAP_l: 0.0180, bbox_mAP_copypaste: 0.204 0.660 0.396 0.128 0.055 0.018
2024-10-15 13:18:09,338 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:12:30, time: 0.566, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0358, stage0_bag_acc: 96.8919, stage0_mean_ious: 0.4764, stage0_s: 0.4232, stage0_m: 0.3928, stage0_l: 0.0242, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0124, stage1_bag_acc: 97.3793, stage1_neg_loss: 0.0086, stage1_mean_ious: 0.5613, stage1_s: 0.5446, stage1_m: 0.3800, stage1_l: 0.0217, stage1_h: 0.0000, loss: 0.0568, grad_norm: 3.4771
2024-10-15 13:18:33,764 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:12:08, time: 0.489, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0358, stage0_bag_acc: 96.9667, stage0_mean_ious: 0.4841, stage0_s: 0.4541, stage0_m: 0.3493, stage0_l: 0.0163, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0153, stage1_bag_acc: 96.5667, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5640, stage1_s: 0.5571, stage1_m: 0.3434, stage1_l: 0.0133, stage1_h: 0.0000, loss: 0.0567, grad_norm: 4.1160
2024-10-15 13:18:57,933 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:11:46, time: 0.483, data_time: 0.007, memory: 7795, stage0_loss_instance_mil: 0.0560, stage0_bag_acc: 94.9286, stage0_mean_ious: 0.4787, stage0_s: 0.4600, stage0_m: 0.1941, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0153, stage1_bag_acc: 95.5929, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5699, stage1_s: 0.5633, stage1_m: 0.1891, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0759, grad_norm: 4.5577
2024-10-15 13:19:23,387 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:11:24, time: 0.509, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0398, stage0_bag_acc: 95.9976, stage0_mean_ious: 0.5209, stage0_s: 0.4669, stage0_m: 0.4252, stage0_l: 0.0403, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0092, stage1_bag_acc: 97.2643, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5792, stage1_s: 0.5697, stage1_m: 0.4025, stage1_l: 0.0279, stage1_h: 0.0000, loss: 0.0523, grad_norm: 2.9458
2024-10-15 13:19:47,578 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:11:02, time: 0.484, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0364, stage0_bag_acc: 98.1476, stage0_mean_ious: 0.4878, stage0_s: 0.4639, stage0_m: 0.2345, stage0_l: 0.0172, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0109, stage1_bag_acc: 98.1476, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5868, stage1_s: 0.5826, stage1_m: 0.2520, stage1_l: 0.0126, stage1_h: 0.0000, loss: 0.0523, grad_norm: 2.9630
2024-10-15 13:20:01,980 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-15 13:20:31,412 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:10:18, time: 0.540, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0323, stage0_bag_acc: 97.1310, stage0_mean_ious: 0.4974, stage0_s: 0.4750, stage0_m: 0.2788, stage0_l: 0.0092, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0105, stage1_bag_acc: 96.9587, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5910, stage1_s: 0.5831, stage1_m: 0.2950, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.0467, grad_norm: 3.4276
2024-10-15 13:20:55,886 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:09:56, time: 0.489, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0438, stage0_bag_acc: 97.1143, stage0_mean_ious: 0.4639, stage0_s: 0.4483, stage0_m: 0.2916, stage0_l: 0.0065, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0149, stage1_bag_acc: 97.4643, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5554, stage1_s: 0.5592, stage1_m: 0.2775, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0645, grad_norm: 3.8468
2024-10-15 13:21:21,477 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:09:35, time: 0.512, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0324, stage0_bag_acc: 97.3778, stage0_mean_ious: 0.4792, stage0_s: 0.4251, stage0_m: 0.3126, stage0_l: 0.0057, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0118, stage1_bag_acc: 98.0500, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5478, stage1_s: 0.5239, stage1_m: 0.2946, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.0500, grad_norm: 3.0312
2024-10-15 13:21:46,618 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:09:13, time: 0.503, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0288, stage0_bag_acc: 97.6500, stage0_mean_ious: 0.4665, stage0_s: 0.4245, stage0_m: 0.3210, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0138, stage1_bag_acc: 98.3000, stage1_neg_loss: 0.0069, stage1_mean_ious: 0.5628, stage1_s: 0.5312, stage1_m: 0.3317, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0495, grad_norm: 3.7492
2024-10-15 13:22:11,800 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:08:51, time: 0.504, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0252, stage0_bag_acc: 98.4348, stage0_mean_ious: 0.5033, stage0_s: 0.4525, stage0_m: 0.3658, stage0_l: 0.0294, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0128, stage1_bag_acc: 98.5682, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.5692, stage1_s: 0.5473, stage1_m: 0.3707, stage1_l: 0.0240, stage1_h: 0.0000, loss: 0.0448, grad_norm: 3.1372
2024-10-15 13:22:26,478 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-15 13:22:57,068 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:08:10, time: 0.568, data_time: 0.055, memory: 7795, stage0_loss_instance_mil: 0.0284, stage0_bag_acc: 97.4444, stage0_mean_ious: 0.4796, stage0_s: 0.4432, stage0_m: 0.3759, stage0_l: 0.0088, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0073, stage1_bag_acc: 97.9421, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5723, stage1_s: 0.5568, stage1_m: 0.3816, stage1_l: 0.0048, stage1_h: 0.0000, loss: 0.0412, grad_norm: 2.9765
2024-10-15 13:23:22,186 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:07:48, time: 0.502, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0211, stage0_bag_acc: 98.6167, stage0_mean_ious: 0.4927, stage0_s: 0.4483, stage0_m: 0.3406, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0047, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5796, stage1_s: 0.5716, stage1_m: 0.3246, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0315, grad_norm: 2.7010
2024-10-15 13:23:46,472 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:07:26, time: 0.486, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0220, stage0_bag_acc: 98.2991, stage0_mean_ious: 0.4764, stage0_s: 0.4541, stage0_m: 0.2793, stage0_l: 0.0255, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0116, stage1_bag_acc: 98.1952, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5806, stage1_s: 0.5878, stage1_m: 0.2583, stage1_l: 0.0215, stage1_h: 0.0000, loss: 0.0364, grad_norm: 2.3410
2024-10-15 13:24:12,637 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:07:04, time: 0.523, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0287, stage0_bag_acc: 97.8682, stage0_mean_ious: 0.5063, stage0_s: 0.4660, stage0_m: 0.4073, stage0_l: 0.0181, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0105, stage1_bag_acc: 98.1182, stage1_neg_loss: 0.0070, stage1_mean_ious: 0.5828, stage1_s: 0.5673, stage1_m: 0.4092, stage1_l: 0.0130, stage1_h: 0.0000, loss: 0.0462, grad_norm: 3.0061
2024-10-15 13:24:38,189 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:06:42, time: 0.511, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0255, stage0_bag_acc: 97.7182, stage0_mean_ious: 0.4720, stage0_s: 0.4501, stage0_m: 0.3391, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0100, stage1_bag_acc: 97.9182, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5688, stage1_s: 0.5810, stage1_m: 0.3673, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.0377, grad_norm: 2.5292
2024-10-15 13:24:53,498 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-15 13:26:08,794 - mmdet - INFO - Evaluating bbox...
2024-10-15 13:26:09,348 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1971
2024-10-15 13:26:09,348 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6364
2024-10-15 13:26:09,348 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3700
2024-10-15 13:26:09,349 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1276
2024-10-15 13:26:09,349 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0614
2024-10-15 13:26:09,349 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0228
2024-10-15 13:26:09,349 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0008
2024-10-15 13:26:09,349 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:26:09,349 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2062
2024-10-15 13:26:09,349 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0495
2024-10-15 13:26:09,349 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3037
2024-10-15 13:26:09,349 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7633
2024-10-15 13:26:09,349 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3037
2024-10-15 13:26:09,350 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3037
2024-10-15 13:26:09,350 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:26:09,350 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3208
2024-10-15 13:26:09,350 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0718
2024-10-15 13:26:09,355 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 13:26:09,355 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.1970, bbox_mAP_50: 0.6360, bbox_mAP_75: 0.3700, bbox_mAP_s: 0.1280, bbox_mAP_m: 0.0610, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.197 0.636 0.370 0.128 0.061 0.023
2024-10-15 13:26:37,220 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:06:02, time: 0.557, data_time: 0.056, memory: 7795, stage0_loss_instance_mil: 0.0279, stage0_bag_acc: 97.7960, stage0_mean_ious: 0.4814, stage0_s: 0.4537, stage0_m: 0.3105, stage0_l: 0.0271, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0062, stage1_bag_acc: 97.9293, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5593, stage1_s: 0.5662, stage1_m: 0.3051, stage1_l: 0.0151, stage1_h: 0.0000, loss: 0.0376, grad_norm: 2.3229
2024-10-15 13:27:02,904 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:05:40, time: 0.514, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0172, stage0_bag_acc: 98.1468, stage0_mean_ious: 0.5075, stage0_s: 0.4504, stage0_m: 0.3899, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0066, stage1_bag_acc: 98.1110, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5884, stage1_s: 0.5854, stage1_m: 0.3900, stage1_l: 0.0081, stage1_h: 0.0000, loss: 0.0264, grad_norm: 2.0428
2024-10-15 13:27:28,412 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:05:17, time: 0.510, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0138, stage0_bag_acc: 99.2667, stage0_mean_ious: 0.4926, stage0_s: 0.4611, stage0_m: 0.3346, stage0_l: 0.0064, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0081, stage1_bag_acc: 98.1673, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5765, stage1_s: 0.5732, stage1_m: 0.3247, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.0255, grad_norm: 2.0557
2024-10-15 13:27:52,665 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:04:55, time: 0.485, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0314, stage0_bag_acc: 97.5000, stage0_mean_ious: 0.4929, stage0_s: 0.4720, stage0_m: 0.2721, stage0_l: 0.0222, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0130, stage1_bag_acc: 98.1000, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5705, stage1_s: 0.5782, stage1_m: 0.2520, stage1_l: 0.0197, stage1_h: 0.0000, loss: 0.0473, grad_norm: 2.8070
2024-10-15 13:28:17,689 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:04:32, time: 0.500, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0276, stage0_bag_acc: 98.7143, stage0_mean_ious: 0.4741, stage0_s: 0.4374, stage0_m: 0.3107, stage0_l: 0.0166, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 98.7143, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5666, stage1_s: 0.5466, stage1_m: 0.3189, stage1_l: 0.0159, stage1_h: 0.0000, loss: 0.0426, grad_norm: 2.7574
2024-10-15 13:28:31,702 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-15 13:29:00,656 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:03:53, time: 0.535, data_time: 0.056, memory: 7803, stage0_loss_instance_mil: 0.0199, stage0_bag_acc: 98.7786, stage0_mean_ious: 0.4644, stage0_s: 0.4351, stage0_m: 0.3155, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0135, stage1_bag_acc: 98.4643, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5450, stage1_s: 0.5393, stage1_m: 0.3157, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0373, grad_norm: 2.5555
2024-10-15 13:29:24,935 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:03:31, time: 0.486, data_time: 0.007, memory: 7803, stage0_loss_instance_mil: 0.0144, stage0_bag_acc: 99.4182, stage0_mean_ious: 0.5012, stage0_s: 0.4447, stage0_m: 0.3426, stage0_l: 0.0299, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0080, stage1_bag_acc: 97.7545, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5731, stage1_s: 0.5531, stage1_m: 0.3232, stage1_l: 0.0305, stage1_h: 0.0000, loss: 0.0247, grad_norm: 1.8317
2024-10-15 13:29:49,865 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:03:08, time: 0.499, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0210, stage0_bag_acc: 98.0310, stage0_mean_ious: 0.4727, stage0_s: 0.4172, stage0_m: 0.3146, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0066, stage1_bag_acc: 98.4810, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5685, stage1_s: 0.5413, stage1_m: 0.3188, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0308, grad_norm: 2.0369
2024-10-15 13:30:15,734 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 13:30:15,734 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:02:45, time: 0.517, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0069, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.5008, stage0_s: 0.4488, stage0_m: 0.3092, stage0_l: 0.0108, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0048, stage1_bag_acc: 99.7500, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5832, stage1_s: 0.5664, stage1_m: 0.2822, stage1_l: 0.0086, stage1_h: 0.0000, loss: 0.0166, grad_norm: 1.8001
2024-10-15 13:30:39,742 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:02:22, time: 0.480, data_time: 0.007, memory: 7803, stage0_loss_instance_mil: 0.0189, stage0_bag_acc: 98.8000, stage0_mean_ious: 0.5009, stage0_s: 0.4581, stage0_m: 0.3164, stage0_l: 0.0344, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0087, stage1_bag_acc: 98.6000, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.5840, stage1_s: 0.5636, stage1_m: 0.3095, stage1_l: 0.0290, stage1_h: 0.0000, loss: 0.0295, grad_norm: 1.6521
2024-10-15 13:30:55,056 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-15 13:31:25,634 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:01:45, time: 0.570, data_time: 0.060, memory: 7803, stage0_loss_instance_mil: 0.0129, stage0_bag_acc: 99.0833, stage0_mean_ious: 0.5205, stage0_s: 0.4582, stage0_m: 0.4019, stage0_l: 0.0228, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0073, stage1_bag_acc: 98.7667, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5841, stage1_s: 0.5844, stage1_m: 0.3702, stage1_l: 0.0166, stage1_h: 0.0000, loss: 0.0252, grad_norm: 2.0025
2024-10-15 13:31:50,033 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:01:22, time: 0.488, data_time: 0.007, memory: 7803, stage0_loss_instance_mil: 0.0063, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.5022, stage0_s: 0.4463, stage0_m: 0.3401, stage0_l: 0.0092, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0046, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5684, stage1_s: 0.5486, stage1_m: 0.3143, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.0143, grad_norm: 1.6082
2024-10-15 13:32:15,092 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.501, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0390, stage0_bag_acc: 96.8778, stage0_mean_ious: 0.4654, stage0_s: 0.4395, stage0_m: 0.3210, stage0_l: 0.0281, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0077, stage1_bag_acc: 96.6778, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5420, stage1_s: 0.5425, stage1_m: 0.2959, stage1_l: 0.0216, stage1_h: 0.0000, loss: 0.0504, grad_norm: 3.0490
2024-10-15 13:32:40,180 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:36, time: 0.502, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0166, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.4947, stage0_s: 0.4690, stage0_m: 0.3803, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0056, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5738, stage1_s: 0.5705, stage1_m: 0.3812, stage1_l: 0.0083, stage1_h: 0.0000, loss: 0.0262, grad_norm: 2.0002
2024-10-15 13:33:04,902 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:13, time: 0.494, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.4863, stage0_s: 0.4471, stage0_m: 0.3361, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0075, stage1_bag_acc: 99.0667, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5821, stage1_s: 0.5639, stage1_m: 0.3378, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0245, grad_norm: 2.0992
2024-10-15 13:33:20,489 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-15 13:34:56,737 - mmdet - INFO - Evaluating bbox...
2024-10-15 13:34:57,296 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1981
2024-10-15 13:34:57,296 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6397
2024-10-15 13:34:57,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3747
2024-10-15 13:34:57,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1269
2024-10-15 13:34:57,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0623
2024-10-15 13:34:57,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0229
2024-10-15 13:34:57,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0008
2024-10-15 13:34:57,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:34:57,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2072
2024-10-15 13:34:57,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0517
2024-10-15 13:34:57,297 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3053
2024-10-15 13:34:57,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7666
2024-10-15 13:34:57,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3053
2024-10-15 13:34:57,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3053
2024-10-15 13:34:57,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:34:57,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3222
2024-10-15 13:34:57,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0798
2024-10-15 13:34:57,304 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 13:34:57,304 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.1980, bbox_mAP_50: 0.6400, bbox_mAP_75: 0.3750, bbox_mAP_s: 0.1270, bbox_mAP_m: 0.0620, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.198 0.640 0.375 0.127 0.062 0.023
2024-10-15 13:36:12,961 - mmdet - INFO - Evaluating bbox...
2024-10-15 13:36:13,437 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1981
2024-10-15 13:36:13,437 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6397
2024-10-15 13:36:13,437 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3747
2024-10-15 13:36:13,437 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1269
2024-10-15 13:36:13,437 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0623
2024-10-15 13:36:13,437 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0229
2024-10-15 13:36:13,437 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0008
2024-10-15 13:36:13,437 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:36:13,438 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2072
2024-10-15 13:36:13,438 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0517
2024-10-15 13:36:13,438 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3053
2024-10-15 13:36:13,438 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7666
2024-10-15 13:36:13,438 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3053
2024-10-15 13:36:13,438 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3053
2024-10-15 13:36:13,438 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:36:13,438 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3222
2024-10-15 13:36:13,438 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0798
2024-10-15 13:36:14,697 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+d7eacca
------------------------------------------------------------

2024-10-15 13:36:15,637 - mmdet - INFO - Distributed training: False
2024-10-15 13:36:16,493 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-15 13:36:17,439 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-15 13:36:17,439 - mmdet - INFO - Use load_from_local loader
2024-10-15 13:36:17,686 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-15 13:36:17,697 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-15 13:36:17,697 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-15 13:36:44,774 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:29:52, time: 0.541, data_time: 0.056, memory: 7803, stage0_loss_instance_mil: 0.7344, stage0_bag_acc: 11.3519, stage0_mean_ious: 0.0532, stage0_s: 0.0413, stage0_m: 0.0394, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1506, stage1_bag_acc: 18.1883, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.0552, stage1_s: 0.0442, stage1_m: 0.0405, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8861, grad_norm: 5.7368
2024-10-15 13:37:10,135 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:28:29, time: 0.507, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.7067, stage0_bag_acc: 20.7524, stage0_mean_ious: 0.0607, stage0_s: 0.0505, stage0_m: 0.0424, stage0_l: 0.0014, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1573, stage1_bag_acc: 23.1333, stage1_neg_loss: 0.0014, stage1_mean_ious: 0.0649, stage1_s: 0.0545, stage1_m: 0.0448, stage1_l: 0.0012, stage1_h: 0.0000, loss: 0.8654, grad_norm: 5.7052
2024-10-15 13:37:34,694 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:27:27, time: 0.491, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.6840, stage0_bag_acc: 19.4409, stage0_mean_ious: 0.0893, stage0_s: 0.0714, stage0_m: 0.0947, stage0_l: 0.0131, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1604, stage1_bag_acc: 13.7980, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.0868, stage1_s: 0.0702, stage1_m: 0.0874, stage1_l: 0.0129, stage1_h: 0.0000, loss: 0.8479, grad_norm: 8.3545
2024-10-15 13:37:59,402 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:26:46, time: 0.494, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.6788, stage0_bag_acc: 22.1786, stage0_mean_ious: 0.1179, stage0_s: 0.0953, stage0_m: 0.1091, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1382, stage1_bag_acc: 22.8619, stage1_neg_loss: 0.0118, stage1_mean_ious: 0.1258, stage1_s: 0.1014, stage1_m: 0.1117, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8288, grad_norm: 9.5674
2024-10-15 13:38:23,611 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:26:06, time: 0.484, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.5961, stage0_bag_acc: 26.4786, stage0_mean_ious: 0.1708, stage0_s: 0.1507, stage0_m: 0.1381, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1252, stage1_bag_acc: 33.3489, stage1_neg_loss: 0.0200, stage1_mean_ious: 0.2001, stage1_s: 0.1834, stage1_m: 0.1432, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.7413, grad_norm: 8.8197
2024-10-15 13:38:39,242 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-15 13:39:07,993 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:23:19, time: 0.531, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.5392, stage0_bag_acc: 39.9000, stage0_mean_ious: 0.2405, stage0_s: 0.1909, stage0_m: 0.2106, stage0_l: 0.0142, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1127, stage1_bag_acc: 40.4611, stage1_neg_loss: 0.0177, stage1_mean_ious: 0.2769, stage1_s: 0.2348, stage1_m: 0.2201, stage1_l: 0.0157, stage1_h: 0.0000, loss: 0.6696, grad_norm: 9.8963
2024-10-15 13:39:33,104 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:23:12, time: 0.502, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.4423, stage0_bag_acc: 58.1273, stage0_mean_ious: 0.3417, stage0_s: 0.2879, stage0_m: 0.2687, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0834, stage1_bag_acc: 55.1369, stage1_neg_loss: 0.0211, stage1_mean_ious: 0.4096, stage1_s: 0.3521, stage1_m: 0.3221, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5469, grad_norm: 14.2778
2024-10-15 13:39:58,097 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:23:00, time: 0.500, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.3991, stage0_bag_acc: 58.3753, stage0_mean_ious: 0.3682, stage0_s: 0.3219, stage0_m: 0.2860, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0825, stage1_bag_acc: 61.8101, stage1_neg_loss: 0.0166, stage1_mean_ious: 0.4531, stage1_s: 0.4205, stage1_m: 0.3137, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.4983, grad_norm: 13.5630
2024-10-15 13:40:23,149 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:22:45, time: 0.501, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.2951, stage0_bag_acc: 73.8174, stage0_mean_ious: 0.3773, stage0_s: 0.3208, stage0_m: 0.2931, stage0_l: 0.0178, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0780, stage1_bag_acc: 73.5867, stage1_neg_loss: 0.0162, stage1_mean_ious: 0.4700, stage1_s: 0.4290, stage1_m: 0.3108, stage1_l: 0.0137, stage1_h: 0.0000, loss: 0.3893, grad_norm: 12.7810
2024-10-15 13:40:49,848 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:22:37, time: 0.534, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.1930, stage0_bag_acc: 84.3101, stage0_mean_ious: 0.4600, stage0_s: 0.3859, stage0_m: 0.4015, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0671, stage1_bag_acc: 83.4101, stage1_neg_loss: 0.0165, stage1_mean_ious: 0.5237, stage1_s: 0.4921, stage1_m: 0.3924, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2765, grad_norm: 11.0781
2024-10-15 13:41:04,928 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-15 13:41:34,727 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:21:10, time: 0.552, data_time: 0.056, memory: 7803, stage0_loss_instance_mil: 0.1293, stage0_bag_acc: 89.4294, stage0_mean_ious: 0.4749, stage0_s: 0.4297, stage0_m: 0.3937, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0330, stage1_bag_acc: 91.2738, stage1_neg_loss: 0.0140, stage1_mean_ious: 0.5536, stage1_s: 0.5411, stage1_m: 0.3985, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1763, grad_norm: 8.4863
2024-10-15 13:41:59,584 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:20:54, time: 0.497, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.1257, stage0_bag_acc: 89.8900, stage0_mean_ious: 0.4454, stage0_s: 0.4000, stage0_m: 0.3632, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0382, stage1_bag_acc: 92.3830, stage1_neg_loss: 0.0121, stage1_mean_ious: 0.5364, stage1_s: 0.5289, stage1_m: 0.3518, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1760, grad_norm: 8.7353
2024-10-15 13:42:25,016 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:20:39, time: 0.509, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.1633, stage0_bag_acc: 86.8508, stage0_mean_ious: 0.4336, stage0_s: 0.3542, stage0_m: 0.2912, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0363, stage1_bag_acc: 86.7737, stage1_neg_loss: 0.0120, stage1_mean_ious: 0.5258, stage1_s: 0.4755, stage1_m: 0.2915, stage1_l: 0.0088, stage1_h: 0.0000, loss: 0.2116, grad_norm: 9.2389
2024-10-15 13:42:50,592 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:20:23, time: 0.512, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.1304, stage0_bag_acc: 89.4864, stage0_mean_ious: 0.4446, stage0_s: 0.3954, stage0_m: 0.3205, stage0_l: 0.0103, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0329, stage1_bag_acc: 91.4864, stage1_neg_loss: 0.0093, stage1_mean_ious: 0.5367, stage1_s: 0.5100, stage1_m: 0.3119, stage1_l: 0.0082, stage1_h: 0.0000, loss: 0.1725, grad_norm: 7.1007
2024-10-15 13:43:16,106 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:20:06, time: 0.510, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0749, stage0_bag_acc: 93.6911, stage0_mean_ious: 0.4885, stage0_s: 0.3968, stage0_m: 0.4416, stage0_l: 0.0086, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0284, stage1_bag_acc: 95.1419, stage1_neg_loss: 0.0154, stage1_mean_ious: 0.5635, stage1_s: 0.5050, stage1_m: 0.4316, stage1_l: 0.0047, stage1_h: 0.0000, loss: 0.1186, grad_norm: 6.4855
2024-10-15 13:43:31,004 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-15 13:44:47,378 - mmdet - INFO - Evaluating bbox...
2024-10-15 13:44:47,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2092
2024-10-15 13:44:47,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6485
2024-10-15 13:44:47,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4049
2024-10-15 13:44:47,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1426
2024-10-15 13:44:47,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0668
2024-10-15 13:44:47,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0219
2024-10-15 13:44:47,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-15 13:44:47,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:44:47,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2210
2024-10-15 13:44:47,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0574
2024-10-15 13:44:47,852 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3126
2024-10-15 13:44:47,852 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7643
2024-10-15 13:44:47,852 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3126
2024-10-15 13:44:47,852 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3126
2024-10-15 13:44:47,852 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-15 13:44:47,852 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3327
2024-10-15 13:44:47,852 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0757
2024-10-15 13:44:47,858 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-15 13:44:47,858 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2090, bbox_mAP_50: 0.6480, bbox_mAP_75: 0.4050, bbox_mAP_s: 0.1430, bbox_mAP_m: 0.0670, bbox_mAP_l: 0.0220, bbox_mAP_copypaste: 0.209 0.648 0.405 0.143 0.067 0.022
2024-10-15 13:45:15,950 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:19:01, time: 0.562, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.0854, stage0_bag_acc: 92.9643, stage0_mean_ious: 0.4771, stage0_s: 0.4129, stage0_m: 0.3709, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0244, stage1_bag_acc: 92.7976, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.5528, stage1_s: 0.5223, stage1_m: 0.3610, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1173, grad_norm: 6.9252
2024-10-15 13:45:41,653 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:18:45, time: 0.514, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0802, stage0_bag_acc: 93.8682, stage0_mean_ious: 0.4699, stage0_s: 0.4168, stage0_m: 0.3697, stage0_l: 0.0223, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0230, stage1_bag_acc: 95.4667, stage1_neg_loss: 0.0103, stage1_mean_ious: 0.5411, stage1_s: 0.5123, stage1_m: 0.3655, stage1_l: 0.0184, stage1_h: 0.0000, loss: 0.1134, grad_norm: 6.7769
2024-10-15 13:46:07,014 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:18:26, time: 0.507, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0833, stage0_bag_acc: 94.2381, stage0_mean_ious: 0.4888, stage0_s: 0.4518, stage0_m: 0.3758, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0278, stage1_bag_acc: 93.4302, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5658, stage1_s: 0.5579, stage1_m: 0.3725, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1171, grad_norm: 5.7590
2024-10-15 13:46:31,369 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:18:05, time: 0.487, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0631, stage0_bag_acc: 94.4801, stage0_mean_ious: 0.4574, stage0_s: 0.4317, stage0_m: 0.3465, stage0_l: 0.0076, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0232, stage1_bag_acc: 95.0658, stage1_neg_loss: 0.0078, stage1_mean_ious: 0.5599, stage1_s: 0.5529, stage1_m: 0.3739, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.0941, grad_norm: 5.2739
2024-10-15 13:46:56,214 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:17:45, time: 0.497, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0699, stage0_bag_acc: 94.4084, stage0_mean_ious: 0.4842, stage0_s: 0.4414, stage0_m: 0.2887, stage0_l: 0.0110, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0220, stage1_bag_acc: 95.1577, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5698, stage1_s: 0.5544, stage1_m: 0.2897, stage1_l: 0.0093, stage1_h: 0.0000, loss: 0.0987, grad_norm: 5.1957
2024-10-15 13:47:10,715 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-15 13:47:40,571 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:16:49, time: 0.553, data_time: 0.056, memory: 7803, stage0_loss_instance_mil: 0.0592, stage0_bag_acc: 95.6310, stage0_mean_ious: 0.4714, stage0_s: 0.4368, stage0_m: 0.2722, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0145, stage1_bag_acc: 95.0119, stage1_neg_loss: 0.0042, stage1_mean_ious: 0.5709, stage1_s: 0.5751, stage1_m: 0.2656, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0778, grad_norm: 4.6095
2024-10-15 13:48:05,509 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:16:29, time: 0.499, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.0518, stage0_bag_acc: 96.1530, stage0_mean_ious: 0.4998, stage0_s: 0.4744, stage0_m: 0.3128, stage0_l: 0.0108, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0132, stage1_bag_acc: 95.8712, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5773, stage1_s: 0.5762, stage1_m: 0.3088, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0698, grad_norm: 4.4355
