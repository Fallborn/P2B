2024-10-16 10:11:53,633 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+e282583
------------------------------------------------------------

2024-10-16 10:11:54,484 - mmdet - INFO - Distributed training: False
2024-10-16 10:11:55,321 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [2]

2024-10-16 10:11:58,525 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 10:11:58,525 - mmdet - INFO - Use load_from_local loader
2024-10-16 10:11:58,797 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 10:11:58,803 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 10:11:58,803 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 10:13:34,229 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:07:06, time: 1.908, data_time: 0.078, memory: 18722, stage0_loss_instance_mil: 0.6949, stage0_bag_acc: 24.8839, stage0_mean_ious: 0.3278, stage0_s: 0.0000, stage0_m: 0.0747, stage0_l: 0.2399, stage0_h: 0.3298, stage1_loss_instance_mil: 0.1841, stage1_bag_acc: 16.2203, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.3132, stage1_s: 0.0000, stage1_m: 0.0663, stage1_l: 0.2366, stage1_h: 0.3158, loss: 0.8812, grad_norm: 3.5020
2024-10-16 10:15:08,841 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 1:05:14, time: 1.892, data_time: 0.028, memory: 18722, stage0_loss_instance_mil: 0.5596, stage0_bag_acc: 57.4835, stage0_mean_ious: 0.3188, stage0_s: 0.0000, stage0_m: 0.0603, stage0_l: 0.1924, stage0_h: 0.3306, stage1_loss_instance_mil: 0.2686, stage1_bag_acc: 28.8655, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.3172, stage1_s: 0.0000, stage1_m: 0.0615, stage1_l: 0.1930, stage1_h: 0.3285, loss: 0.8320, grad_norm: 4.7124
2024-10-16 10:16:44,136 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 1:03:43, time: 1.906, data_time: 0.028, memory: 18722, stage0_loss_instance_mil: 0.2198, stage0_bag_acc: 90.1981, stage0_mean_ious: 0.3179, stage0_s: 0.0000, stage0_m: 0.0455, stage0_l: 0.2190, stage0_h: 0.3339, stage1_loss_instance_mil: 0.3442, stage1_bag_acc: 87.5470, stage1_neg_loss: 0.0720, stage1_mean_ious: 0.3062, stage1_s: 0.0000, stage1_m: 0.0454, stage1_l: 0.1995, stage1_h: 0.3234, loss: 0.6360, grad_norm: 11.2079
2024-10-16 10:17:41,392 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 10:19:22,808 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:53:46, time: 1.984, data_time: 0.080, memory: 18724, stage0_loss_instance_mil: 0.0669, stage0_bag_acc: 96.8018, stage0_mean_ious: 0.2811, stage0_s: 0.0000, stage0_m: 0.0618, stage0_l: 0.1277, stage0_h: 0.2916, stage1_loss_instance_mil: 0.3336, stage1_bag_acc: 97.3661, stage1_neg_loss: 0.0974, stage1_mean_ious: 0.2615, stage1_s: 0.0000, stage1_m: 0.0409, stage1_l: 0.1069, stage1_h: 0.2746, loss: 0.4980, grad_norm: 13.3630
2024-10-16 10:20:59,403 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:53:50, time: 1.932, data_time: 0.032, memory: 18724, stage0_loss_instance_mil: 0.0476, stage0_bag_acc: 97.4428, stage0_mean_ious: 0.2765, stage0_s: 0.0000, stage0_m: 0.0467, stage0_l: 0.1132, stage0_h: 0.2943, stage1_loss_instance_mil: 0.3069, stage1_bag_acc: 98.3385, stage1_neg_loss: 0.0833, stage1_mean_ious: 0.2458, stage1_s: 0.0000, stage1_m: 0.0310, stage1_l: 0.0822, stage1_h: 0.2650, loss: 0.4379, grad_norm: 10.6252
2024-10-16 10:22:37,012 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:53:29, time: 1.952, data_time: 0.031, memory: 18724, stage0_loss_instance_mil: 0.0558, stage0_bag_acc: 96.1464, stage0_mean_ious: 0.2442, stage0_s: 0.0085, stage0_m: 0.0503, stage0_l: 0.0897, stage0_h: 0.2515, stage1_loss_instance_mil: 0.3164, stage1_bag_acc: 96.6891, stage1_neg_loss: 0.0905, stage1_mean_ious: 0.2137, stage1_s: 0.0068, stage1_m: 0.0312, stage1_l: 0.0682, stage1_h: 0.2234, loss: 0.4627, grad_norm: 14.2203
2024-10-16 10:23:34,606 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 10:25:16,878 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:48:16, time: 1.999, data_time: 0.078, memory: 18724, stage0_loss_instance_mil: 0.0272, stage0_bag_acc: 98.4090, stage0_mean_ious: 0.2296, stage0_s: 0.0000, stage0_m: 0.0375, stage0_l: 0.1084, stage0_h: 0.2435, stage1_loss_instance_mil: 0.2722, stage1_bag_acc: 99.1491, stage1_neg_loss: 0.0881, stage1_mean_ious: 0.2015, stage1_s: 0.0000, stage1_m: 0.0220, stage1_l: 0.0797, stage1_h: 0.2165, loss: 0.3875, grad_norm: 11.1367
2024-10-16 10:26:51,389 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:47:37, time: 1.890, data_time: 0.028, memory: 18750, stage0_loss_instance_mil: 0.0414, stage0_bag_acc: 96.8501, stage0_mean_ious: 0.2475, stage0_s: 0.0000, stage0_m: 0.0492, stage0_l: 0.1073, stage0_h: 0.2614, stage1_loss_instance_mil: 0.3040, stage1_bag_acc: 98.2183, stage1_neg_loss: 0.0913, stage1_mean_ious: 0.2178, stage1_s: 0.0000, stage1_m: 0.0278, stage1_l: 0.0908, stage1_h: 0.2319, loss: 0.4367, grad_norm: 16.1603
2024-10-16 10:28:23,200 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:46:38, time: 1.836, data_time: 0.027, memory: 18750, stage0_loss_instance_mil: 0.0310, stage0_bag_acc: 98.3908, stage0_mean_ious: 0.2628, stage0_s: 0.0000, stage0_m: 0.0436, stage0_l: 0.1065, stage0_h: 0.2822, stage1_loss_instance_mil: 0.2689, stage1_bag_acc: 98.6947, stage1_neg_loss: 0.0838, stage1_mean_ious: 0.2285, stage1_s: 0.0000, stage1_m: 0.0252, stage1_l: 0.0808, stage1_h: 0.2480, loss: 0.3836, grad_norm: 12.9593
2024-10-16 10:29:14,868 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 10:30:46,712 - mmdet - INFO - Evaluating bbox...
2024-10-16 10:30:47,512 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0052
2024-10-16 10:30:47,512 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0252
2024-10-16 10:30:47,512 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0080
2024-10-16 10:30:47,512 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 10:30:47,512 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0004
2024-10-16 10:30:47,512 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0001
2024-10-16 10:30:47,512 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 10:30:47,512 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0088
2024-10-16 10:30:47,513 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0107
2024-10-16 10:30:47,513 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0041
2024-10-16 10:30:47,513 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0286
2024-10-16 10:30:47,513 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.0988
2024-10-16 10:30:47,513 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0286
2024-10-16 10:30:47,513 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0286
2024-10-16 10:30:47,513 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0700
2024-10-16 10:30:47,513 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0743
2024-10-16 10:30:47,513 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0080
2024-10-16 10:30:47,527 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 10:30:47,527 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 180, bbox_mAP: 0.0050, bbox_mAP_50: 0.0250, bbox_mAP_75: 0.0080, bbox_mAP_s: 0.0010, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.005 0.025 0.008 0.001 0.000 0.000
2024-10-16 10:32:16,307 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:42:17, time: 1.775, data_time: 0.074, memory: 18750, stage0_loss_instance_mil: 0.0233, stage0_bag_acc: 98.5988, stage0_mean_ious: 0.2435, stage0_s: 0.0000, stage0_m: 0.0383, stage0_l: 0.1131, stage0_h: 0.2662, stage1_loss_instance_mil: 0.2362, stage1_bag_acc: 99.1387, stage1_neg_loss: 0.0836, stage1_mean_ious: 0.2096, stage1_s: 0.0000, stage1_m: 0.0215, stage1_l: 0.0903, stage1_h: 0.2321, loss: 0.3430, grad_norm: 14.6379
2024-10-16 10:33:41,797 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:41:08, time: 1.710, data_time: 0.025, memory: 18750, stage0_loss_instance_mil: 0.0140, stage0_bag_acc: 99.4406, stage0_mean_ious: 0.2595, stage0_s: 0.0000, stage0_m: 0.0421, stage0_l: 0.0931, stage0_h: 0.2785, stage1_loss_instance_mil: 0.2028, stage1_bag_acc: 99.4949, stage1_neg_loss: 0.0733, stage1_mean_ious: 0.2249, stage1_s: 0.0000, stage1_m: 0.0248, stage1_l: 0.0636, stage1_h: 0.2435, loss: 0.2901, grad_norm: 10.3579
2024-10-16 10:35:07,275 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:39:56, time: 1.710, data_time: 0.026, memory: 18750, stage0_loss_instance_mil: 0.0156, stage0_bag_acc: 99.0187, stage0_mean_ious: 0.2336, stage0_s: 0.0000, stage0_m: 0.0413, stage0_l: 0.0949, stage0_h: 0.2489, stage1_loss_instance_mil: 0.1992, stage1_bag_acc: 99.5621, stage1_neg_loss: 0.0665, stage1_mean_ious: 0.2035, stage1_s: 0.0000, stage1_m: 0.0251, stage1_l: 0.0689, stage1_h: 0.2202, loss: 0.2813, grad_norm: 10.0338
2024-10-16 10:35:59,479 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 10:37:30,064 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:36:29, time: 1.768, data_time: 0.078, memory: 18750, stage0_loss_instance_mil: 0.0106, stage0_bag_acc: 99.1359, stage0_mean_ious: 0.2656, stage0_s: 0.0000, stage0_m: 0.0338, stage0_l: 0.0990, stage0_h: 0.2856, stage1_loss_instance_mil: 0.1620, stage1_bag_acc: 99.4981, stage1_neg_loss: 0.0622, stage1_mean_ious: 0.2255, stage1_s: 0.0000, stage1_m: 0.0193, stage1_l: 0.0784, stage1_h: 0.2446, loss: 0.2348, grad_norm: 8.4659
2024-10-16 10:38:55,671 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:35:22, time: 1.712, data_time: 0.026, memory: 18750, stage0_loss_instance_mil: 0.0136, stage0_bag_acc: 99.3564, stage0_mean_ious: 0.2834, stage0_s: 0.0079, stage0_m: 0.0209, stage0_l: 0.0998, stage0_h: 0.3102, stage1_loss_instance_mil: 0.1715, stage1_bag_acc: 99.1564, stage1_neg_loss: 0.0673, stage1_mean_ious: 0.2436, stage1_s: 0.0062, stage1_m: 0.0164, stage1_l: 0.0745, stage1_h: 0.2685, loss: 0.2525, grad_norm: 11.8620
2024-10-16 10:40:19,011 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:34:09, time: 1.667, data_time: 0.025, memory: 18750, stage0_loss_instance_mil: 0.0115, stage0_bag_acc: 99.2502, stage0_mean_ious: 0.2407, stage0_s: 0.0000, stage0_m: 0.0383, stage0_l: 0.0996, stage0_h: 0.2612, stage1_loss_instance_mil: 0.1478, stage1_bag_acc: 99.7130, stage1_neg_loss: 0.0634, stage1_mean_ious: 0.2050, stage1_s: 0.0000, stage1_m: 0.0223, stage1_l: 0.0732, stage1_h: 0.2255, loss: 0.2227, grad_norm: 10.4521
2024-10-16 10:41:09,005 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 10:42:36,606 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:31:09, time: 1.709, data_time: 0.074, memory: 18757, stage0_loss_instance_mil: 0.0050, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.2813, stage0_s: 0.0000, stage0_m: 0.0394, stage0_l: 0.0892, stage0_h: 0.3078, stage1_loss_instance_mil: 0.1320, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0584, stage1_mean_ious: 0.2418, stage1_s: 0.0000, stage1_m: 0.0253, stage1_l: 0.0680, stage1_h: 0.2675, loss: 0.1955, grad_norm: 8.4808
2024-10-16 10:44:02,130 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 10:44:02,130 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:30:01, time: 1.710, data_time: 0.025, memory: 18757, stage0_loss_instance_mil: 0.0125, stage0_bag_acc: 99.5046, stage0_mean_ious: 0.2860, stage0_s: 0.0000, stage0_m: 0.0161, stage0_l: 0.1037, stage0_h: 0.3087, stage1_loss_instance_mil: 0.1587, stage1_bag_acc: 99.1965, stage1_neg_loss: 0.0565, stage1_mean_ious: 0.2469, stage1_s: 0.0000, stage1_m: 0.0091, stage1_l: 0.0851, stage1_h: 0.2681, loss: 0.2277, grad_norm: 9.6775
2024-10-16 10:45:27,786 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:28:52, time: 1.713, data_time: 0.025, memory: 18757, stage0_loss_instance_mil: 0.0296, stage0_bag_acc: 98.6356, stage0_mean_ious: 0.3088, stage0_s: 0.0000, stage0_m: 0.0486, stage0_l: 0.0958, stage0_h: 0.3303, stage1_loss_instance_mil: 0.1334, stage1_bag_acc: 98.9293, stage1_neg_loss: 0.0526, stage1_mean_ious: 0.2637, stage1_s: 0.0000, stage1_m: 0.0421, stage1_l: 0.0730, stage1_h: 0.2840, loss: 0.2156, grad_norm: 8.3335
2024-10-16 10:46:18,211 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 10:47:49,828 - mmdet - INFO - Evaluating bbox...
2024-10-16 10:47:50,602 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0048
2024-10-16 10:47:50,603 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0297
2024-10-16 10:47:50,603 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0050
2024-10-16 10:47:50,603 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0003
2024-10-16 10:47:50,603 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0001
2024-10-16 10:47:50,603 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 10:47:50,603 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 10:47:50,603 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0001
2024-10-16 10:47:50,603 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0083
2024-10-16 10:47:50,603 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0030
2024-10-16 10:47:50,603 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0277
2024-10-16 10:47:50,604 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.1198
2024-10-16 10:47:50,604 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0277
2024-10-16 10:47:50,604 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0277
2024-10-16 10:47:50,604 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0083
2024-10-16 10:47:50,604 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0529
2024-10-16 10:47:50,604 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0070
2024-10-16 10:47:50,618 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 10:47:50,618 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 180, bbox_mAP: 0.0050, bbox_mAP_50: 0.0300, bbox_mAP_75: 0.0050, bbox_mAP_s: 0.0000, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.005 0.030 0.005 0.000 0.000 0.000
2024-10-16 10:49:18,717 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:26:13, time: 1.762, data_time: 0.075, memory: 18757, stage0_loss_instance_mil: 0.0086, stage0_bag_acc: 99.6928, stage0_mean_ious: 0.3458, stage0_s: 0.0000, stage0_m: 0.0238, stage0_l: 0.1251, stage0_h: 0.3740, stage1_loss_instance_mil: 0.1269, stage1_bag_acc: 99.2264, stage1_neg_loss: 0.0486, stage1_mean_ious: 0.2962, stage1_s: 0.0000, stage1_m: 0.0148, stage1_l: 0.1012, stage1_h: 0.3220, loss: 0.1840, grad_norm: 7.8890
2024-10-16 10:50:45,204 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:25:05, time: 1.730, data_time: 0.025, memory: 18757, stage0_loss_instance_mil: 0.0187, stage0_bag_acc: 98.9386, stage0_mean_ious: 0.3512, stage0_s: 0.0079, stage0_m: 0.0469, stage0_l: 0.0905, stage0_h: 0.3794, stage1_loss_instance_mil: 0.1316, stage1_bag_acc: 99.3748, stage1_neg_loss: 0.0704, stage1_mean_ious: 0.3007, stage1_s: 0.0065, stage1_m: 0.0314, stage1_l: 0.0757, stage1_h: 0.3254, loss: 0.2207, grad_norm: 12.8916
2024-10-16 10:52:10,817 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:23:55, time: 1.712, data_time: 0.025, memory: 18757, stage0_loss_instance_mil: 0.0224, stage0_bag_acc: 98.3741, stage0_mean_ious: 0.3644, stage0_s: 0.0000, stage0_m: 0.0346, stage0_l: 0.1173, stage0_h: 0.4050, stage1_loss_instance_mil: 0.1317, stage1_bag_acc: 99.3347, stage1_neg_loss: 0.0529, stage1_mean_ious: 0.3219, stage1_s: 0.0000, stage1_m: 0.0270, stage1_l: 0.0966, stage1_h: 0.3597, loss: 0.2070, grad_norm: 9.2406
2024-10-16 10:53:01,476 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 10:54:32,291 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:21:29, time: 1.773, data_time: 0.075, memory: 18757, stage0_loss_instance_mil: 0.0120, stage0_bag_acc: 99.4401, stage0_mean_ious: 0.3417, stage0_s: 0.0000, stage0_m: 0.0406, stage0_l: 0.1229, stage0_h: 0.3760, stage1_loss_instance_mil: 0.1053, stage1_bag_acc: 99.4835, stage1_neg_loss: 0.0507, stage1_mean_ious: 0.2993, stage1_s: 0.0000, stage1_m: 0.0313, stage1_l: 0.1009, stage1_h: 0.3308, loss: 0.1680, grad_norm: 6.7204
2024-10-16 10:55:56,207 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:20:18, time: 1.678, data_time: 0.026, memory: 18757, stage0_loss_instance_mil: 0.0072, stage0_bag_acc: 99.7333, stage0_mean_ious: 0.3392, stage0_s: 0.0000, stage0_m: 0.0421, stage0_l: 0.1191, stage0_h: 0.3661, stage1_loss_instance_mil: 0.1162, stage1_bag_acc: 99.7048, stage1_neg_loss: 0.0522, stage1_mean_ious: 0.2975, stage1_s: 0.0000, stage1_m: 0.0338, stage1_l: 0.1096, stage1_h: 0.3213, loss: 0.1756, grad_norm: 7.9287
2024-10-16 10:57:23,563 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:19:08, time: 1.747, data_time: 0.028, memory: 18757, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.3633, stage0_mean_ious: 0.3027, stage0_s: 0.0000, stage0_m: 0.0489, stage0_l: 0.1043, stage0_h: 0.3305, stage1_loss_instance_mil: 0.1155, stage1_bag_acc: 99.5591, stage1_neg_loss: 0.0519, stage1_mean_ious: 0.2660, stage1_s: 0.0000, stage1_m: 0.0366, stage1_l: 0.0892, stage1_h: 0.2920, loss: 0.1783, grad_norm: 8.0698
2024-10-16 10:58:14,949 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 10:59:45,795 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:50, time: 1.773, data_time: 0.077, memory: 18757, stage0_loss_instance_mil: 0.0026, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3176, stage0_s: 0.0000, stage0_m: 0.0214, stage0_l: 0.0937, stage0_h: 0.3372, stage1_loss_instance_mil: 0.0893, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0469, stage1_mean_ious: 0.2787, stage1_s: 0.0000, stage1_m: 0.0175, stage1_l: 0.0845, stage1_h: 0.2958, loss: 0.1387, grad_norm: 6.0806
2024-10-16 11:01:11,650 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:39, time: 1.717, data_time: 0.027, memory: 18757, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.2947, stage0_s: 0.0076, stage0_m: 0.0428, stage0_l: 0.1025, stage0_h: 0.3224, stage1_loss_instance_mil: 0.0871, stage1_bag_acc: 99.8139, stage1_neg_loss: 0.0444, stage1_mean_ious: 0.2577, stage1_s: 0.0063, stage1_m: 0.0375, stage1_l: 0.0888, stage1_h: 0.2817, loss: 0.1374, grad_norm: 5.1791
2024-10-16 11:02:37,065 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:27, time: 1.708, data_time: 0.027, memory: 18757, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 99.9231, stage0_mean_ious: 0.3161, stage0_s: 0.0000, stage0_m: 0.0420, stage0_l: 0.1071, stage0_h: 0.3447, stage1_loss_instance_mil: 0.0849, stage1_bag_acc: 99.7914, stage1_neg_loss: 0.0410, stage1_mean_ious: 0.2803, stage1_s: 0.0000, stage1_m: 0.0316, stage1_l: 0.0966, stage1_h: 0.3064, loss: 0.1287, grad_norm: 5.2467
2024-10-16 11:03:28,026 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 11:04:59,650 - mmdet - INFO - Evaluating bbox...
2024-10-16 11:05:00,448 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0095
2024-10-16 11:05:00,448 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0512
2024-10-16 11:05:00,448 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0116
2024-10-16 11:05:00,448 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0013
2024-10-16 11:05:00,448 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0002
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0001
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0001
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0156
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0024
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0325
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.1306
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0325
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0325
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0059
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0597
2024-10-16 11:05:00,449 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0046
2024-10-16 11:05:00,465 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 11:05:00,465 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 180, bbox_mAP: 0.0090, bbox_mAP_50: 0.0510, bbox_mAP_75: 0.0120, bbox_mAP_s: 0.0010, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.009 0.051 0.012 0.001 0.000 0.000
2024-10-16 11:06:28,530 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:12:15, time: 1.761, data_time: 0.075, memory: 18757, stage0_loss_instance_mil: 0.0029, stage0_bag_acc: 99.9167, stage0_mean_ious: 0.3294, stage0_s: 0.0000, stage0_m: 0.0264, stage0_l: 0.1110, stage0_h: 0.3580, stage1_loss_instance_mil: 0.0763, stage1_bag_acc: 99.9200, stage1_neg_loss: 0.0401, stage1_mean_ious: 0.2916, stage1_s: 0.0000, stage1_m: 0.0217, stage1_l: 0.0968, stage1_h: 0.3182, loss: 0.1193, grad_norm: 4.7290
2024-10-16 11:07:52,574 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:11:02, time: 1.681, data_time: 0.025, memory: 18757, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.7771, stage0_mean_ious: 0.3013, stage0_s: 0.0000, stage0_m: 0.0466, stage0_l: 0.0886, stage0_h: 0.3268, stage1_loss_instance_mil: 0.0809, stage1_bag_acc: 99.7574, stage1_neg_loss: 0.0472, stage1_mean_ious: 0.2615, stage1_s: 0.0000, stage1_m: 0.0321, stage1_l: 0.0695, stage1_h: 0.2867, loss: 0.1317, grad_norm: 5.4374
2024-10-16 11:09:17,203 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:49, time: 1.693, data_time: 0.025, memory: 18757, stage0_loss_instance_mil: 0.0060, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.3267, stage0_s: 0.0000, stage0_m: 0.0342, stage0_l: 0.0959, stage0_h: 0.3572, stage1_loss_instance_mil: 0.0845, stage1_bag_acc: 99.6784, stage1_neg_loss: 0.0446, stage1_mean_ious: 0.2844, stage1_s: 0.0000, stage1_m: 0.0290, stage1_l: 0.0888, stage1_h: 0.3104, loss: 0.1351, grad_norm: 5.1309
2024-10-16 11:10:08,960 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 11:11:37,284 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:42, time: 1.723, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0017, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3196, stage0_s: 0.0000, stage0_m: 0.0296, stage0_l: 0.1044, stage0_h: 0.3465, stage1_loss_instance_mil: 0.0733, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0398, stage1_mean_ious: 0.2828, stage1_s: 0.0000, stage1_m: 0.0241, stage1_l: 0.0879, stage1_h: 0.3074, loss: 0.1149, grad_norm: 4.8247
2024-10-16 11:13:03,167 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:29, time: 1.718, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.3369, stage0_s: 0.0000, stage0_m: 0.0281, stage0_l: 0.1126, stage0_h: 0.3658, stage1_loss_instance_mil: 0.0865, stage1_bag_acc: 99.7771, stage1_neg_loss: 0.0443, stage1_mean_ious: 0.2904, stage1_s: 0.0000, stage1_m: 0.0230, stage1_l: 0.0950, stage1_h: 0.3156, loss: 0.1369, grad_norm: 5.4468
2024-10-16 11:14:28,227 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:15, time: 1.701, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0015, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.2956, stage0_s: 0.0000, stage0_m: 0.0300, stage0_l: 0.1106, stage0_h: 0.3205, stage1_loss_instance_mil: 0.0767, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0382, stage1_mean_ious: 0.2575, stage1_s: 0.0000, stage1_m: 0.0222, stage1_l: 0.0981, stage1_h: 0.2793, loss: 0.1163, grad_norm: 4.8650
2024-10-16 11:15:19,714 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 11:16:49,182 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:13, time: 1.746, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0055, stage0_bag_acc: 99.9091, stage0_mean_ious: 0.3153, stage0_s: 0.0000, stage0_m: 0.0304, stage0_l: 0.1021, stage0_h: 0.3364, stage1_loss_instance_mil: 0.0725, stage1_bag_acc: 99.5831, stage1_neg_loss: 0.0446, stage1_mean_ious: 0.2731, stage1_s: 0.0000, stage1_m: 0.0272, stage1_l: 0.0935, stage1_h: 0.2915, loss: 0.1226, grad_norm: 5.3687
2024-10-16 11:18:13,321 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:59, time: 1.683, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0017, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3394, stage0_s: 0.0000, stage0_m: 0.0295, stage0_l: 0.0986, stage0_h: 0.3642, stage1_loss_instance_mil: 0.0781, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0458, stage1_mean_ious: 0.2988, stage1_s: 0.0000, stage1_m: 0.0195, stage1_l: 0.0860, stage1_h: 0.3214, loss: 0.1256, grad_norm: 6.3678
2024-10-16 11:19:40,943 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.752, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0017, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3036, stage0_s: 0.0000, stage0_m: 0.0584, stage0_l: 0.0869, stage0_h: 0.3231, stage1_loss_instance_mil: 0.0743, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0365, stage1_mean_ious: 0.2607, stage1_s: 0.0000, stage1_m: 0.0477, stage1_l: 0.0745, stage1_h: 0.2774, loss: 0.1125, grad_norm: 4.8127
2024-10-16 11:20:30,856 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 11:22:02,372 - mmdet - INFO - Evaluating bbox...
2024-10-16 11:22:03,167 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0082
2024-10-16 11:22:03,167 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0449
2024-10-16 11:22:03,167 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0093
2024-10-16 11:22:03,168 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 11:22:03,168 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0002
2024-10-16 11:22:03,168 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 11:22:03,168 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 11:22:03,168 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 11:22:03,168 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0131
2024-10-16 11:22:03,168 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0023
2024-10-16 11:22:03,168 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0310
2024-10-16 11:22:03,168 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.1242
2024-10-16 11:22:03,168 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0310
2024-10-16 11:22:03,169 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0310
2024-10-16 11:22:03,169 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0020
2024-10-16 11:22:03,169 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0551
2024-10-16 11:22:03,169 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0044
2024-10-16 11:22:03,182 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 11:22:03,182 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 180, bbox_mAP: 0.0080, bbox_mAP_50: 0.0450, bbox_mAP_75: 0.0090, bbox_mAP_s: 0.0010, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.008 0.045 0.009 0.001 0.000 0.000
2024-10-16 11:23:33,619 - mmdet - INFO - Evaluating bbox...
2024-10-16 11:23:34,391 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0082
2024-10-16 11:23:34,391 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0449
2024-10-16 11:23:34,391 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0093
2024-10-16 11:23:34,391 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 11:23:34,391 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0002
2024-10-16 11:23:34,391 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 11:23:34,391 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 11:23:34,392 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 11:23:34,392 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0131
2024-10-16 11:23:34,392 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0023
2024-10-16 11:23:34,392 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0310
2024-10-16 11:23:34,392 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.1242
2024-10-16 11:23:34,392 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0310
2024-10-16 11:23:34,392 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0310
2024-10-16 11:23:34,392 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0020
2024-10-16 11:23:34,392 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0551
2024-10-16 11:23:34,392 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0044
2024-10-16 11:23:35,626 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+e282583
------------------------------------------------------------

2024-10-16 11:23:36,547 - mmdet - INFO - Distributed training: False
2024-10-16 11:23:37,401 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [2]

2024-10-16 11:23:38,345 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 11:23:38,345 - mmdet - INFO - Use load_from_local loader
2024-10-16 11:23:38,601 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 11:23:38,618 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 11:23:38,619 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 11:25:07,514 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:02:31, time: 1.778, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.6993, stage0_bag_acc: 22.8078, stage0_mean_ious: 0.3742, stage0_s: 0.0000, stage0_m: 0.0682, stage0_l: 0.2546, stage0_h: 0.3856, stage1_loss_instance_mil: 0.1894, stage1_bag_acc: 20.6075, stage1_neg_loss: 0.0006, stage1_mean_ious: 0.3694, stage1_s: 0.0000, stage1_m: 0.0732, stage1_l: 0.2620, stage1_h: 0.3775, loss: 0.8893, grad_norm: 3.1891
2024-10-16 11:26:33,246 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:57, time: 1.715, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.5741, stage0_bag_acc: 54.1593, stage0_mean_ious: 0.4492, stage0_s: 0.0000, stage0_m: 0.0446, stage0_l: 0.2344, stage0_h: 0.4697, stage1_loss_instance_mil: 0.2725, stage1_bag_acc: 35.9748, stage1_neg_loss: 0.0015, stage1_mean_ious: 0.4351, stage1_s: 0.0000, stage1_m: 0.0515, stage1_l: 0.2409, stage1_h: 0.4506, loss: 0.8481, grad_norm: 3.8665
2024-10-16 11:27:58,555 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:58:03, time: 1.706, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.2085, stage0_bag_acc: 91.8832, stage0_mean_ious: 0.4116, stage0_s: 0.0000, stage0_m: 0.0590, stage0_l: 0.2379, stage0_h: 0.4281, stage1_loss_instance_mil: 0.3560, stage1_bag_acc: 83.9229, stage1_neg_loss: 0.0596, stage1_mean_ious: 0.3998, stage1_s: 0.0000, stage1_m: 0.0617, stage1_l: 0.2577, stage1_h: 0.4112, loss: 0.6242, grad_norm: 9.8635
2024-10-16 11:28:49,204 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 11:30:18,893 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:35, time: 1.750, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0673, stage0_bag_acc: 96.4203, stage0_mean_ious: 0.4501, stage0_s: 0.0000, stage0_m: 0.0412, stage0_l: 0.2256, stage0_h: 0.4754, stage1_loss_instance_mil: 0.2953, stage1_bag_acc: 97.4801, stage1_neg_loss: 0.0764, stage1_mean_ious: 0.4273, stage1_s: 0.0000, stage1_m: 0.0402, stage1_l: 0.2369, stage1_h: 0.4488, loss: 0.4390, grad_norm: 11.3724
2024-10-16 11:31:45,526 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:34, time: 1.733, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0413, stage0_bag_acc: 97.8922, stage0_mean_ious: 0.4369, stage0_s: 0.0000, stage0_m: 0.0544, stage0_l: 0.2325, stage0_h: 0.4600, stage1_loss_instance_mil: 0.2706, stage1_bag_acc: 98.9884, stage1_neg_loss: 0.0824, stage1_mean_ious: 0.4089, stage1_s: 0.0000, stage1_m: 0.0546, stage1_l: 0.2226, stage1_h: 0.4291, loss: 0.3943, grad_norm: 13.6026
2024-10-16 11:33:10,390 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:57, time: 1.697, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0473, stage0_bag_acc: 96.9077, stage0_mean_ious: 0.4718, stage0_s: 0.0000, stage0_m: 0.0301, stage0_l: 0.2211, stage0_h: 0.5040, stage1_loss_instance_mil: 0.2657, stage1_bag_acc: 98.4283, stage1_neg_loss: 0.1250, stage1_mean_ious: 0.4450, stage1_s: 0.0000, stage1_m: 0.0299, stage1_l: 0.2300, stage1_h: 0.4713, loss: 0.4381, grad_norm: 22.3898
2024-10-16 11:34:02,104 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 11:35:32,559 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:43:11, time: 1.765, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0349, stage0_bag_acc: 98.0170, stage0_mean_ious: 0.4964, stage0_s: 0.0000, stage0_m: 0.0509, stage0_l: 0.2322, stage0_h: 0.5264, stage1_loss_instance_mil: 0.1701, stage1_bag_acc: 98.4560, stage1_neg_loss: 0.0627, stage1_mean_ious: 0.4752, stage1_s: 0.0000, stage1_m: 0.0428, stage1_l: 0.2448, stage1_h: 0.5013, loss: 0.2677, grad_norm: 11.6377
2024-10-16 11:36:57,494 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:37, time: 1.699, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0385, stage0_bag_acc: 97.6105, stage0_mean_ious: 0.4856, stage0_s: 0.0000, stage0_m: 0.0705, stage0_l: 0.2517, stage0_h: 0.5126, stage1_loss_instance_mil: 0.1647, stage1_bag_acc: 98.4660, stage1_neg_loss: 0.0555, stage1_mean_ious: 0.4648, stage1_s: 0.0000, stage1_m: 0.0738, stage1_l: 0.2568, stage1_h: 0.4888, loss: 0.2587, grad_norm: 9.2727
2024-10-16 11:38:22,073 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:52, time: 1.692, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0136, stage0_bag_acc: 99.5480, stage0_mean_ious: 0.4567, stage0_s: 0.0000, stage0_m: 0.0958, stage0_l: 0.2827, stage0_h: 0.4911, stage1_loss_instance_mil: 0.1278, stage1_bag_acc: 99.6424, stage1_neg_loss: 0.0528, stage1_mean_ious: 0.4386, stage1_s: 0.0000, stage1_m: 0.0944, stage1_l: 0.2927, stage1_h: 0.4694, loss: 0.1942, grad_norm: 8.7762
2024-10-16 11:39:12,617 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 11:40:44,829 - mmdet - INFO - Evaluating bbox...
2024-10-16 11:40:45,669 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2518
2024-10-16 11:40:45,669 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4999
2024-10-16 11:40:45,669 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4087
2024-10-16 11:40:45,669 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2959
2024-10-16 11:40:45,669 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2268
2024-10-16 11:40:45,669 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1525
2024-10-16 11:40:45,670 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0312
2024-10-16 11:40:45,670 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2598
2024-10-16 11:40:45,670 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2086
2024-10-16 11:40:45,670 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2917
2024-10-16 11:40:45,670 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3237
2024-10-16 11:40:45,670 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.5566
2024-10-16 11:40:45,670 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3237
2024-10-16 11:40:45,670 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3237
2024-10-16 11:40:45,670 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2916
2024-10-16 11:40:45,670 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2708
2024-10-16 11:40:45,670 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3722
2024-10-16 11:40:45,685 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 11:40:45,685 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 180, bbox_mAP: 0.2520, bbox_mAP_50: 0.5000, bbox_mAP_75: 0.4090, bbox_mAP_s: 0.2960, bbox_mAP_m: 0.2270, bbox_mAP_l: 0.1530, bbox_mAP_copypaste: 0.252 0.500 0.409 0.296 0.227 0.153
2024-10-16 11:42:13,288 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:19, time: 1.752, data_time: 0.076, memory: 18840, stage0_loss_instance_mil: 0.0108, stage0_bag_acc: 99.7667, stage0_mean_ious: 0.4638, stage0_s: 0.0000, stage0_m: 0.0554, stage0_l: 0.1689, stage0_h: 0.4989, stage1_loss_instance_mil: 0.1499, stage1_bag_acc: 99.5444, stage1_neg_loss: 0.0473, stage1_mean_ious: 0.4495, stage1_s: 0.0000, stage1_m: 0.0580, stage1_l: 0.1751, stage1_h: 0.4811, loss: 0.2079, grad_norm: 9.3700
2024-10-16 11:43:37,018 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:31, time: 1.675, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0142, stage0_bag_acc: 99.2085, stage0_mean_ious: 0.4980, stage0_s: 0.0000, stage0_m: 0.0609, stage0_l: 0.2504, stage0_h: 0.5282, stage1_loss_instance_mil: 0.1011, stage1_bag_acc: 99.3302, stage1_neg_loss: 0.0425, stage1_mean_ious: 0.4758, stage1_s: 0.0000, stage1_m: 0.0651, stage1_l: 0.2529, stage1_h: 0.5020, loss: 0.1578, grad_norm: 6.6623
2024-10-16 11:45:02,101 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:40, time: 1.702, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0311, stage0_bag_acc: 98.4438, stage0_mean_ious: 0.4833, stage0_s: 0.0000, stage0_m: 0.0389, stage0_l: 0.2340, stage0_h: 0.5182, stage1_loss_instance_mil: 0.1152, stage1_bag_acc: 98.1244, stage1_neg_loss: 0.0491, stage1_mean_ious: 0.4652, stage1_s: 0.0000, stage1_m: 0.0401, stage1_l: 0.2423, stage1_h: 0.4954, loss: 0.1954, grad_norm: 7.9765
2024-10-16 11:45:53,568 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 11:47:22,314 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:41, time: 1.730, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0267, stage0_bag_acc: 98.8899, stage0_mean_ious: 0.4815, stage0_s: 0.0000, stage0_m: 0.0512, stage0_l: 0.2175, stage0_h: 0.5094, stage1_loss_instance_mil: 0.1090, stage1_bag_acc: 98.8380, stage1_neg_loss: 0.0497, stage1_mean_ious: 0.4655, stage1_s: 0.0000, stage1_m: 0.0585, stage1_l: 0.2272, stage1_h: 0.4900, loss: 0.1854, grad_norm: 9.4161
2024-10-16 11:48:48,405 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:50, time: 1.722, data_time: 0.028, memory: 18840, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.4639, stage0_mean_ious: 0.4695, stage0_s: 0.0000, stage0_m: 0.0567, stage0_l: 0.2327, stage0_h: 0.5022, stage1_loss_instance_mil: 0.0824, stage1_bag_acc: 99.5788, stage1_neg_loss: 0.0393, stage1_mean_ious: 0.4510, stage1_s: 0.0000, stage1_m: 0.0639, stage1_l: 0.2364, stage1_h: 0.4795, loss: 0.1325, grad_norm: 5.4815
2024-10-16 11:50:14,331 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:55, time: 1.719, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0077, stage0_bag_acc: 99.7460, stage0_mean_ious: 0.5160, stage0_s: 0.0000, stage0_m: 0.0401, stage0_l: 0.2467, stage0_h: 0.5385, stage1_loss_instance_mil: 0.0725, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0401, stage1_mean_ious: 0.4955, stage1_s: 0.0000, stage1_m: 0.0448, stage1_l: 0.2465, stage1_h: 0.5154, loss: 0.1202, grad_norm: 5.6249
2024-10-16 11:51:06,004 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 11:52:35,234 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:15, time: 1.741, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0047, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.4996, stage0_s: 0.0000, stage0_m: 0.0509, stage0_l: 0.2886, stage0_h: 0.5374, stage1_loss_instance_mil: 0.0649, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0318, stage1_mean_ious: 0.4757, stage1_s: 0.0000, stage1_m: 0.0536, stage1_l: 0.2746, stage1_h: 0.5108, loss: 0.1014, grad_norm: 5.1676
2024-10-16 11:54:00,258 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 11:54:00,258 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:17, time: 1.700, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.0148, stage0_bag_acc: 99.4910, stage0_mean_ious: 0.5220, stage0_s: 0.0000, stage0_m: 0.0700, stage0_l: 0.2616, stage0_h: 0.5681, stage1_loss_instance_mil: 0.0670, stage1_bag_acc: 99.5331, stage1_neg_loss: 0.0365, stage1_mean_ious: 0.4957, stage1_s: 0.0000, stage1_m: 0.0788, stage1_l: 0.2683, stage1_h: 0.5353, loss: 0.1182, grad_norm: 6.0918
2024-10-16 11:55:26,230 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:18, time: 1.719, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.8091, stage0_mean_ious: 0.5017, stage0_s: 0.0000, stage0_m: 0.0444, stage0_l: 0.2543, stage0_h: 0.5393, stage1_loss_instance_mil: 0.0840, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0398, stage1_mean_ious: 0.4821, stage1_s: 0.0000, stage1_m: 0.0537, stage1_l: 0.2760, stage1_h: 0.5123, loss: 0.1297, grad_norm: 6.8439
2024-10-16 11:56:18,871 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 11:57:51,434 - mmdet - INFO - Evaluating bbox...
2024-10-16 11:57:52,293 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2495
2024-10-16 11:57:52,293 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5089
2024-10-16 11:57:52,293 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4073
2024-10-16 11:57:52,293 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2895
2024-10-16 11:57:52,293 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2162
2024-10-16 11:57:52,293 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1413
2024-10-16 11:57:52,293 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0359
2024-10-16 11:57:52,294 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2538
2024-10-16 11:57:52,294 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2229
2024-10-16 11:57:52,294 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3384
2024-10-16 11:57:52,294 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3368
2024-10-16 11:57:52,294 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6029
2024-10-16 11:57:52,294 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3368
2024-10-16 11:57:52,294 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3368
2024-10-16 11:57:52,294 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2897
2024-10-16 11:57:52,294 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2891
2024-10-16 11:57:52,294 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4343
2024-10-16 11:57:52,308 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 11:57:52,308 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 180, bbox_mAP: 0.2500, bbox_mAP_50: 0.5090, bbox_mAP_75: 0.4070, bbox_mAP_s: 0.2890, bbox_mAP_m: 0.2160, bbox_mAP_l: 0.1410, bbox_mAP_copypaste: 0.250 0.509 0.407 0.289 0.216 0.141
2024-10-16 11:59:21,005 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:53, time: 1.773, data_time: 0.080, memory: 18840, stage0_loss_instance_mil: 0.0134, stage0_bag_acc: 99.1310, stage0_mean_ious: 0.5308, stage0_s: 0.0000, stage0_m: 0.0640, stage0_l: 0.2048, stage0_h: 0.5730, stage1_loss_instance_mil: 0.0611, stage1_bag_acc: 99.5133, stage1_neg_loss: 0.0297, stage1_mean_ious: 0.5095, stage1_s: 0.0000, stage1_m: 0.0781, stage1_l: 0.2233, stage1_h: 0.5455, loss: 0.1041, grad_norm: 5.1475
2024-10-16 12:00:47,574 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:52, time: 1.731, data_time: 0.032, memory: 18840, stage0_loss_instance_mil: 0.0211, stage0_bag_acc: 98.5022, stage0_mean_ious: 0.5170, stage0_s: 0.0000, stage0_m: 0.0748, stage0_l: 0.2858, stage0_h: 0.5543, stage1_loss_instance_mil: 0.0645, stage1_bag_acc: 98.8740, stage1_neg_loss: 0.0330, stage1_mean_ious: 0.4919, stage1_s: 0.0000, stage1_m: 0.0869, stage1_l: 0.3034, stage1_h: 0.5213, loss: 0.1186, grad_norm: 5.6869
2024-10-16 12:02:14,516 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:49, time: 1.739, data_time: 0.032, memory: 18840, stage0_loss_instance_mil: 0.0115, stage0_bag_acc: 99.5836, stage0_mean_ious: 0.5494, stage0_s: 0.0000, stage0_m: 0.0357, stage0_l: 0.2409, stage0_h: 0.5809, stage1_loss_instance_mil: 0.0673, stage1_bag_acc: 99.5197, stage1_neg_loss: 0.0301, stage1_mean_ious: 0.5259, stage1_s: 0.0000, stage1_m: 0.0451, stage1_l: 0.2728, stage1_h: 0.5483, loss: 0.1089, grad_norm: 5.1842
2024-10-16 12:03:07,036 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 12:04:39,007 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:33, time: 1.794, data_time: 0.079, memory: 18840, stage0_loss_instance_mil: 0.0089, stage0_bag_acc: 99.4740, stage0_mean_ious: 0.5395, stage0_s: 0.0000, stage0_m: 0.0547, stage0_l: 0.2822, stage0_h: 0.5730, stage1_loss_instance_mil: 0.0556, stage1_bag_acc: 99.4795, stage1_neg_loss: 0.0310, stage1_mean_ious: 0.5202, stage1_s: 0.0000, stage1_m: 0.0609, stage1_l: 0.2865, stage1_h: 0.5496, loss: 0.0955, grad_norm: 4.6907
2024-10-16 12:06:06,243 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:29, time: 1.745, data_time: 0.033, memory: 18840, stage0_loss_instance_mil: 0.0062, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.5700, stage0_s: 0.0000, stage0_m: 0.0391, stage0_l: 0.2146, stage0_h: 0.6107, stage1_loss_instance_mil: 0.0556, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0306, stage1_mean_ious: 0.5462, stage1_s: 0.0000, stage1_m: 0.0427, stage1_l: 0.2245, stage1_h: 0.5815, loss: 0.0924, grad_norm: 4.7626
2024-10-16 12:07:31,632 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:23, time: 1.708, data_time: 0.033, memory: 18840, stage0_loss_instance_mil: 0.0079, stage0_bag_acc: 99.5361, stage0_mean_ious: 0.5494, stage0_s: 0.0000, stage0_m: 0.0737, stage0_l: 0.2575, stage0_h: 0.5903, stage1_loss_instance_mil: 0.0575, stage1_bag_acc: 99.6905, stage1_neg_loss: 0.0311, stage1_mean_ious: 0.5208, stage1_s: 0.0000, stage1_m: 0.0840, stage1_l: 0.2694, stage1_h: 0.5533, loss: 0.0965, grad_norm: 5.2836
2024-10-16 12:08:23,029 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 12:09:52,021 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:11, time: 1.735, data_time: 0.076, memory: 18840, stage0_loss_instance_mil: 0.0031, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.5640, stage0_s: 0.0000, stage0_m: 0.0201, stage0_l: 0.3247, stage0_h: 0.5859, stage1_loss_instance_mil: 0.0431, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0265, stage1_mean_ious: 0.5305, stage1_s: 0.0000, stage1_m: 0.0194, stage1_l: 0.3220, stage1_h: 0.5489, loss: 0.0727, grad_norm: 3.9045
2024-10-16 12:11:17,515 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:04, time: 1.710, data_time: 0.030, memory: 18840, stage0_loss_instance_mil: 0.0064, stage0_bag_acc: 99.8056, stage0_mean_ious: 0.5511, stage0_s: 0.0000, stage0_m: 0.0605, stage0_l: 0.2729, stage0_h: 0.5917, stage1_loss_instance_mil: 0.0398, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0237, stage1_mean_ious: 0.5255, stage1_s: 0.0000, stage1_m: 0.0771, stage1_l: 0.2781, stage1_h: 0.5594, loss: 0.0699, grad_norm: 3.3706
2024-10-16 12:12:41,744 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:55, time: 1.685, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0030, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.5548, stage0_s: 0.0000, stage0_m: 0.0498, stage0_l: 0.3058, stage0_h: 0.5958, stage1_loss_instance_mil: 0.0395, stage1_bag_acc: 99.8078, stage1_neg_loss: 0.0221, stage1_mean_ious: 0.5228, stage1_s: 0.0000, stage1_m: 0.0517, stage1_l: 0.3182, stage1_h: 0.5551, loss: 0.0646, grad_norm: 3.2066
2024-10-16 12:13:33,476 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 12:15:05,057 - mmdet - INFO - Evaluating bbox...
2024-10-16 12:15:05,884 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2466
2024-10-16 12:15:05,884 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5123
2024-10-16 12:15:05,884 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4072
2024-10-16 12:15:05,884 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2890
2024-10-16 12:15:05,884 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2120
2024-10-16 12:15:05,884 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1252
2024-10-16 12:15:05,884 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0321
2024-10-16 12:15:05,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2619
2024-10-16 12:15:05,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2333
2024-10-16 12:15:05,885 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3581
2024-10-16 12:15:05,885 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3396
2024-10-16 12:15:05,885 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6091
2024-10-16 12:15:05,885 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3396
2024-10-16 12:15:05,885 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3396
2024-10-16 12:15:05,885 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2926
2024-10-16 12:15:05,885 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2997
2024-10-16 12:15:05,885 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4548
2024-10-16 12:15:05,900 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 12:15:05,900 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 180, bbox_mAP: 0.2470, bbox_mAP_50: 0.5120, bbox_mAP_75: 0.4070, bbox_mAP_s: 0.2890, bbox_mAP_m: 0.2120, bbox_mAP_l: 0.1250, bbox_mAP_copypaste: 0.247 0.512 0.407 0.289 0.212 0.125
2024-10-16 12:16:33,426 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:49, time: 1.750, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0046, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.5474, stage0_s: 0.0000, stage0_m: 0.0305, stage0_l: 0.2868, stage0_h: 0.5927, stage1_loss_instance_mil: 0.0400, stage1_bag_acc: 99.8130, stage1_neg_loss: 0.0254, stage1_mean_ious: 0.5218, stage1_s: 0.0000, stage1_m: 0.0326, stage1_l: 0.2907, stage1_h: 0.5619, loss: 0.0701, grad_norm: 3.9213
2024-10-16 12:17:59,699 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:40, time: 1.725, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.7212, stage0_mean_ious: 0.5703, stage0_s: 0.0080, stage0_m: 0.0441, stage0_l: 0.2618, stage0_h: 0.6062, stage1_loss_instance_mil: 0.0383, stage1_bag_acc: 99.8462, stage1_neg_loss: 0.0214, stage1_mean_ious: 0.5333, stage1_s: 0.0060, stage1_m: 0.0534, stage1_l: 0.2647, stage1_h: 0.5633, loss: 0.0656, grad_norm: 3.1853
2024-10-16 12:19:26,042 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:30, time: 1.727, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0016, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5520, stage0_s: 0.0000, stage0_m: 0.0461, stage0_l: 0.2772, stage0_h: 0.5914, stage1_loss_instance_mil: 0.0347, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0208, stage1_mean_ious: 0.5255, stage1_s: 0.0000, stage1_m: 0.0581, stage1_l: 0.2790, stage1_h: 0.5582, loss: 0.0571, grad_norm: 3.2311
2024-10-16 12:20:18,390 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 12:21:48,431 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:28, time: 1.757, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0009, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5378, stage0_s: 0.0000, stage0_m: 0.0477, stage0_l: 0.2393, stage0_h: 0.5783, stage1_loss_instance_mil: 0.0339, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0233, stage1_mean_ious: 0.5063, stage1_s: 0.0000, stage1_m: 0.0540, stage1_l: 0.2562, stage1_h: 0.5373, loss: 0.0582, grad_norm: 3.3029
2024-10-16 12:23:15,871 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:18, time: 1.749, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0011, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5765, stage0_s: 0.0000, stage0_m: 0.0721, stage0_l: 0.3448, stage0_h: 0.6068, stage1_loss_instance_mil: 0.0356, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0208, stage1_mean_ious: 0.5515, stage1_s: 0.0000, stage1_m: 0.0770, stage1_l: 0.3611, stage1_h: 0.5755, loss: 0.0574, grad_norm: 3.1397
2024-10-16 12:24:40,118 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:06, time: 1.685, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0054, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.5420, stage0_s: 0.0080, stage0_m: 0.0630, stage0_l: 0.2446, stage0_h: 0.5858, stage1_loss_instance_mil: 0.0422, stage1_bag_acc: 99.8048, stage1_neg_loss: 0.0232, stage1_mean_ious: 0.5144, stage1_s: 0.0060, stage1_m: 0.0852, stage1_l: 0.2506, stage1_h: 0.5496, loss: 0.0708, grad_norm: 3.7876
2024-10-16 12:25:30,681 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 12:27:00,984 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:08, time: 1.763, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0009, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5496, stage0_s: 0.0000, stage0_m: 0.0676, stage0_l: 0.3354, stage0_h: 0.5875, stage1_loss_instance_mil: 0.0354, stage1_bag_acc: 99.7614, stage1_neg_loss: 0.0194, stage1_mean_ious: 0.5263, stage1_s: 0.0000, stage1_m: 0.0805, stage1_l: 0.3437, stage1_h: 0.5589, loss: 0.0557, grad_norm: 3.1608
2024-10-16 12:28:25,713 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:56, time: 1.695, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0040, stage0_bag_acc: 99.9167, stage0_mean_ious: 0.5649, stage0_s: 0.0000, stage0_m: 0.0486, stage0_l: 0.2595, stage0_h: 0.5971, stage1_loss_instance_mil: 0.0392, stage1_bag_acc: 99.9167, stage1_neg_loss: 0.0173, stage1_mean_ious: 0.5365, stage1_s: 0.0000, stage1_m: 0.0581, stage1_l: 0.2595, stage1_h: 0.5630, loss: 0.0606, grad_norm: 3.1156
2024-10-16 12:29:50,886 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:43, time: 1.703, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0011, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5493, stage0_s: 0.0080, stage0_m: 0.0497, stage0_l: 0.3281, stage0_h: 0.5871, stage1_loss_instance_mil: 0.0373, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0202, stage1_mean_ious: 0.5184, stage1_s: 0.0053, stage1_m: 0.0598, stage1_l: 0.3317, stage1_h: 0.5500, loss: 0.0586, grad_norm: 3.9001
2024-10-16 12:30:42,169 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 12:32:13,952 - mmdet - INFO - Evaluating bbox...
2024-10-16 12:32:14,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2504
2024-10-16 12:32:14,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5192
2024-10-16 12:32:14,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4115
2024-10-16 12:32:14,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2971
2024-10-16 12:32:14,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2160
2024-10-16 12:32:14,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1287
2024-10-16 12:32:14,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0318
2024-10-16 12:32:14,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2620
2024-10-16 12:32:14,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2386
2024-10-16 12:32:14,774 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3596
2024-10-16 12:32:14,774 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3434
2024-10-16 12:32:14,774 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6170
2024-10-16 12:32:14,774 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3434
2024-10-16 12:32:14,774 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3434
2024-10-16 12:32:14,774 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2955
2024-10-16 12:32:14,774 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3045
2024-10-16 12:32:14,774 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4552
2024-10-16 12:32:14,790 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 12:32:14,790 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 180, bbox_mAP: 0.2500, bbox_mAP_50: 0.5190, bbox_mAP_75: 0.4120, bbox_mAP_s: 0.2970, bbox_mAP_m: 0.2160, bbox_mAP_l: 0.1290, bbox_mAP_copypaste: 0.250 0.519 0.412 0.297 0.216 0.129
2024-10-16 12:33:44,884 - mmdet - INFO - Evaluating bbox...
2024-10-16 12:33:45,701 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2504
2024-10-16 12:33:45,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5192
2024-10-16 12:33:45,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4115
2024-10-16 12:33:45,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2971
2024-10-16 12:33:45,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2160
2024-10-16 12:33:45,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1287
2024-10-16 12:33:45,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0318
2024-10-16 12:33:45,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2620
2024-10-16 12:33:45,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2386
2024-10-16 12:33:45,702 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3596
2024-10-16 12:33:45,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3434
2024-10-16 12:33:45,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6170
2024-10-16 12:33:45,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3434
2024-10-16 12:33:45,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3434
2024-10-16 12:33:45,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2955
2024-10-16 12:33:45,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3045
2024-10-16 12:33:45,703 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4552
2024-10-16 12:33:46,932 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+e282583
------------------------------------------------------------

2024-10-16 12:33:47,762 - mmdet - INFO - Distributed training: False
2024-10-16 12:33:48,652 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [2]

2024-10-16 12:33:49,570 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 12:33:49,570 - mmdet - INFO - Use load_from_local loader
2024-10-16 12:33:49,823 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 12:33:49,839 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 12:33:49,839 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 12:35:18,067 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:02:03, time: 1.764, data_time: 0.076, memory: 18840, stage0_loss_instance_mil: 0.6906, stage0_bag_acc: 23.5209, stage0_mean_ious: 0.2750, stage0_s: 0.0000, stage0_m: 0.0227, stage0_l: 0.1810, stage0_h: 0.2816, stage1_loss_instance_mil: 0.1934, stage1_bag_acc: 12.8287, stage1_neg_loss: 0.0008, stage1_mean_ious: 0.2691, stage1_s: 0.0000, stage1_m: 0.0231, stage1_l: 0.2024, stage1_h: 0.2717, loss: 0.8848, grad_norm: 3.3665
2024-10-16 12:36:42,564 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:18, time: 1.690, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.5854, stage0_bag_acc: 54.5758, stage0_mean_ious: 0.2782, stage0_s: 0.0000, stage0_m: 0.0319, stage0_l: 0.2235, stage0_h: 0.2806, stage1_loss_instance_mil: 0.2528, stage1_bag_acc: 18.6929, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.2586, stage1_s: 0.0000, stage1_m: 0.0357, stage1_l: 0.2302, stage1_h: 0.2559, loss: 0.8416, grad_norm: 4.8925
2024-10-16 12:38:07,903 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:57:37, time: 1.707, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.2807, stage0_bag_acc: 85.8570, stage0_mean_ious: 0.3082, stage0_s: 0.0000, stage0_m: 0.0571, stage0_l: 0.1761, stage0_h: 0.3210, stage1_loss_instance_mil: 0.3154, stage1_bag_acc: 78.7545, stage1_neg_loss: 0.0673, stage1_mean_ious: 0.2841, stage1_s: 0.0000, stage1_m: 0.0532, stage1_l: 0.1611, stage1_h: 0.2964, loss: 0.6634, grad_norm: 13.5918
2024-10-16 12:38:57,862 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 12:40:26,766 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:13, time: 1.735, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0689, stage0_bag_acc: 96.4571, stage0_mean_ious: 0.2976, stage0_s: 0.0000, stage0_m: 0.0880, stage0_l: 0.1364, stage0_h: 0.3147, stage1_loss_instance_mil: 0.3278, stage1_bag_acc: 98.2564, stage1_neg_loss: 0.0880, stage1_mean_ious: 0.2709, stage1_s: 0.0000, stage1_m: 0.0639, stage1_l: 0.1205, stage1_h: 0.2895, loss: 0.4848, grad_norm: 16.1410
2024-10-16 12:41:52,649 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:11, time: 1.718, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0819, stage0_bag_acc: 95.1993, stage0_mean_ious: 0.3421, stage0_s: 0.0000, stage0_m: 0.0557, stage0_l: 0.1549, stage0_h: 0.3586, stage1_loss_instance_mil: 0.3092, stage1_bag_acc: 96.2078, stage1_neg_loss: 0.0881, stage1_mean_ious: 0.3091, stage1_s: 0.0000, stage1_m: 0.0373, stage1_l: 0.1397, stage1_h: 0.3249, loss: 0.4792, grad_norm: 15.9148
2024-10-16 12:43:17,855 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:40, time: 1.704, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0580, stage0_bag_acc: 96.8560, stage0_mean_ious: 0.3782, stage0_s: 0.0000, stage0_m: 0.0298, stage0_l: 0.1679, stage0_h: 0.3983, stage1_loss_instance_mil: 0.2748, stage1_bag_acc: 97.8518, stage1_neg_loss: 0.0925, stage1_mean_ious: 0.3508, stage1_s: 0.0000, stage1_m: 0.0302, stage1_l: 0.1614, stage1_h: 0.3681, loss: 0.4253, grad_norm: 18.7934
2024-10-16 12:44:09,493 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 12:45:40,923 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:43:02, time: 1.784, data_time: 0.076, memory: 18840, stage0_loss_instance_mil: 0.0341, stage0_bag_acc: 98.5072, stage0_mean_ious: 0.3812, stage0_s: 0.0000, stage0_m: 0.0604, stage0_l: 0.1388, stage0_h: 0.4074, stage1_loss_instance_mil: 0.2785, stage1_bag_acc: 97.9008, stage1_neg_loss: 0.0818, stage1_mean_ious: 0.3527, stage1_s: 0.0000, stage1_m: 0.0399, stage1_l: 0.1264, stage1_h: 0.3782, loss: 0.3944, grad_norm: 18.4541
2024-10-16 12:47:07,005 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:34, time: 1.722, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0180, stage0_bag_acc: 99.1708, stage0_mean_ious: 0.3991, stage0_s: 0.0000, stage0_m: 0.0464, stage0_l: 0.1224, stage0_h: 0.4367, stage1_loss_instance_mil: 0.2404, stage1_bag_acc: 99.5685, stage1_neg_loss: 0.0912, stage1_mean_ious: 0.3688, stage1_s: 0.0000, stage1_m: 0.0303, stage1_l: 0.1016, stage1_h: 0.4059, loss: 0.3495, grad_norm: 20.0114
2024-10-16 12:48:32,799 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:53, time: 1.716, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0235, stage0_bag_acc: 99.3045, stage0_mean_ious: 0.3563, stage0_s: 0.0000, stage0_m: 0.0481, stage0_l: 0.1218, stage0_h: 0.3869, stage1_loss_instance_mil: 0.2300, stage1_bag_acc: 99.4289, stage1_neg_loss: 0.0824, stage1_mean_ious: 0.3265, stage1_s: 0.0000, stage1_m: 0.0265, stage1_l: 0.1096, stage1_h: 0.3581, loss: 0.3359, grad_norm: 18.0032
2024-10-16 12:49:23,036 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 12:50:54,675 - mmdet - INFO - Evaluating bbox...
2024-10-16 12:50:55,464 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0675
2024-10-16 12:50:55,464 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2538
2024-10-16 12:50:55,464 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1149
2024-10-16 12:50:55,464 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0351
2024-10-16 12:50:55,464 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0158
2024-10-16 12:50:55,464 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0052
2024-10-16 12:50:55,464 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-16 12:50:55,465 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0318
2024-10-16 12:50:55,465 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0760
2024-10-16 12:50:55,465 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0612
2024-10-16 12:50:55,465 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1343
2024-10-16 12:50:55,465 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3796
2024-10-16 12:50:55,465 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1343
2024-10-16 12:50:55,465 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1343
2024-10-16 12:50:55,465 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0646
2024-10-16 12:50:55,465 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1790
2024-10-16 12:50:55,465 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0809
2024-10-16 12:50:55,482 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 12:50:55,482 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 180, bbox_mAP: 0.0670, bbox_mAP_50: 0.2540, bbox_mAP_75: 0.1150, bbox_mAP_s: 0.0350, bbox_mAP_m: 0.0160, bbox_mAP_l: 0.0050, bbox_mAP_copypaste: 0.067 0.254 0.115 0.035 0.016 0.005
2024-10-16 12:52:23,078 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:20, time: 1.752, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0721, stage0_bag_acc: 94.6190, stage0_mean_ious: 0.4015, stage0_s: 0.0000, stage0_m: 0.0151, stage0_l: 0.1423, stage0_h: 0.4309, stage1_loss_instance_mil: 0.2208, stage1_bag_acc: 96.3092, stage1_neg_loss: 0.0762, stage1_mean_ious: 0.3638, stage1_s: 0.0000, stage1_m: 0.0104, stage1_l: 0.1206, stage1_h: 0.3918, loss: 0.3690, grad_norm: 16.4536
2024-10-16 12:53:47,679 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:34, time: 1.692, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0226, stage0_bag_acc: 98.9871, stage0_mean_ious: 0.3759, stage0_s: 0.0084, stage0_m: 0.0244, stage0_l: 0.1732, stage0_h: 0.4069, stage1_loss_instance_mil: 0.1995, stage1_bag_acc: 99.3892, stage1_neg_loss: 0.0710, stage1_mean_ious: 0.3451, stage1_s: 0.0087, stage1_m: 0.0140, stage1_l: 0.1517, stage1_h: 0.3755, loss: 0.2931, grad_norm: 13.2358
2024-10-16 12:55:14,682 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:47, time: 1.740, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0164, stage0_bag_acc: 99.4158, stage0_mean_ious: 0.3938, stage0_s: 0.0000, stage0_m: 0.0426, stage0_l: 0.0945, stage0_h: 0.4255, stage1_loss_instance_mil: 0.1706, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0804, stage1_mean_ious: 0.3600, stage1_s: 0.0000, stage1_m: 0.0277, stage1_l: 0.0722, stage1_h: 0.3929, loss: 0.2673, grad_norm: 19.7635
2024-10-16 12:56:05,325 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 12:57:35,766 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:49, time: 1.766, data_time: 0.072, memory: 18840, stage0_loss_instance_mil: 0.0147, stage0_bag_acc: 99.2776, stage0_mean_ious: 0.3688, stage0_s: 0.0000, stage0_m: 0.0282, stage0_l: 0.1369, stage0_h: 0.4040, stage1_loss_instance_mil: 0.1626, stage1_bag_acc: 99.2912, stage1_neg_loss: 0.0631, stage1_mean_ious: 0.3383, stage1_s: 0.0000, stage1_m: 0.0182, stage1_l: 0.1100, stage1_h: 0.3735, loss: 0.2404, grad_norm: 14.0300
2024-10-16 12:58:59,851 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:54, time: 1.682, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0135, stage0_bag_acc: 99.2432, stage0_mean_ious: 0.3665, stage0_s: 0.0000, stage0_m: 0.0305, stage0_l: 0.1100, stage0_h: 0.4019, stage1_loss_instance_mil: 0.1752, stage1_bag_acc: 99.4140, stage1_neg_loss: 0.0667, stage1_mean_ious: 0.3330, stage1_s: 0.0000, stage1_m: 0.0173, stage1_l: 0.0983, stage1_h: 0.3671, loss: 0.2553, grad_norm: 14.0501
2024-10-16 13:00:28,038 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:02, time: 1.764, data_time: 0.028, memory: 18840, stage0_loss_instance_mil: 0.0174, stage0_bag_acc: 98.9176, stage0_mean_ious: 0.3829, stage0_s: 0.0000, stage0_m: 0.0609, stage0_l: 0.1420, stage0_h: 0.4168, stage1_loss_instance_mil: 0.1444, stage1_bag_acc: 98.9672, stage1_neg_loss: 0.0540, stage1_mean_ious: 0.3560, stage1_s: 0.0000, stage1_m: 0.0536, stage1_l: 0.1279, stage1_h: 0.3888, loss: 0.2159, grad_norm: 10.2704
2024-10-16 13:01:19,921 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 13:02:50,087 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:23, time: 1.760, data_time: 0.073, memory: 18840, stage0_loss_instance_mil: 0.0086, stage0_bag_acc: 99.7019, stage0_mean_ious: 0.4192, stage0_s: 0.0000, stage0_m: 0.0462, stage0_l: 0.1278, stage0_h: 0.4575, stage1_loss_instance_mil: 0.1326, stage1_bag_acc: 99.6880, stage1_neg_loss: 0.0649, stage1_mean_ious: 0.3826, stage1_s: 0.0000, stage1_m: 0.0327, stage1_l: 0.1139, stage1_h: 0.4199, loss: 0.2061, grad_norm: 12.7316
2024-10-16 13:04:17,287 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 13:04:17,287 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:27, time: 1.744, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0121, stage0_bag_acc: 99.3079, stage0_mean_ious: 0.3820, stage0_s: 0.0000, stage0_m: 0.0559, stage0_l: 0.1485, stage0_h: 0.4249, stage1_loss_instance_mil: 0.1460, stage1_bag_acc: 99.3889, stage1_neg_loss: 0.0665, stage1_mean_ious: 0.3553, stage1_s: 0.0000, stage1_m: 0.0404, stage1_l: 0.1363, stage1_h: 0.3974, loss: 0.2246, grad_norm: 15.4431
2024-10-16 13:05:44,179 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:27, time: 1.738, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0228, stage0_bag_acc: 98.8738, stage0_mean_ious: 0.4155, stage0_s: 0.0000, stage0_m: 0.0451, stage0_l: 0.1573, stage0_h: 0.4552, stage1_loss_instance_mil: 0.1198, stage1_bag_acc: 98.9149, stage1_neg_loss: 0.0500, stage1_mean_ious: 0.3861, stage1_s: 0.0000, stage1_m: 0.0344, stage1_l: 0.1500, stage1_h: 0.4245, loss: 0.1926, grad_norm: 9.0025
2024-10-16 13:06:37,676 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 13:08:11,198 - mmdet - INFO - Evaluating bbox...
2024-10-16 13:08:12,012 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0884
2024-10-16 13:08:12,012 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3075
2024-10-16 13:08:12,012 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1574
2024-10-16 13:08:12,012 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0504
2024-10-16 13:08:12,012 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0270
2024-10-16 13:08:12,012 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0092
2024-10-16 13:08:12,012 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-10-16 13:08:12,013 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0556
2024-10-16 13:08:12,013 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0998
2024-10-16 13:08:12,013 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0773
2024-10-16 13:08:12,013 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1659
2024-10-16 13:08:12,013 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4416
2024-10-16 13:08:12,013 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1659
2024-10-16 13:08:12,013 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1659
2024-10-16 13:08:12,013 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0791
2024-10-16 13:08:12,013 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2013
2024-10-16 13:08:12,013 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1347
2024-10-16 13:08:12,029 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 13:08:12,029 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 180, bbox_mAP: 0.0880, bbox_mAP_50: 0.3070, bbox_mAP_75: 0.1570, bbox_mAP_s: 0.0500, bbox_mAP_m: 0.0270, bbox_mAP_l: 0.0090, bbox_mAP_copypaste: 0.088 0.307 0.157 0.050 0.027 0.009
2024-10-16 13:09:41,478 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:02, time: 1.788, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0107, stage0_bag_acc: 99.3248, stage0_mean_ious: 0.3835, stage0_s: 0.0000, stage0_m: 0.0423, stage0_l: 0.1029, stage0_h: 0.4228, stage1_loss_instance_mil: 0.1016, stage1_bag_acc: 99.8214, stage1_neg_loss: 0.0487, stage1_mean_ious: 0.3539, stage1_s: 0.0000, stage1_m: 0.0311, stage1_l: 0.0886, stage1_h: 0.3914, loss: 0.1610, grad_norm: 7.9484
2024-10-16 13:11:09,048 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:01, time: 1.751, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.0138, stage0_bag_acc: 99.3596, stage0_mean_ious: 0.4102, stage0_s: 0.0000, stage0_m: 0.0336, stage0_l: 0.1434, stage0_h: 0.4387, stage1_loss_instance_mil: 0.1184, stage1_bag_acc: 99.1013, stage1_neg_loss: 0.0499, stage1_mean_ious: 0.3888, stage1_s: 0.0000, stage1_m: 0.0249, stage1_l: 0.1313, stage1_h: 0.4162, loss: 0.1821, grad_norm: 9.1910
2024-10-16 13:12:36,213 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:58, time: 1.743, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0150, stage0_bag_acc: 99.0682, stage0_mean_ious: 0.3939, stage0_s: 0.0081, stage0_m: 0.0301, stage0_l: 0.1290, stage0_h: 0.4283, stage1_loss_instance_mil: 0.1002, stage1_bag_acc: 99.4686, stage1_neg_loss: 0.0465, stage1_mean_ious: 0.3676, stage1_s: 0.0093, stage1_m: 0.0220, stage1_l: 0.1106, stage1_h: 0.4027, loss: 0.1616, grad_norm: 8.5820
2024-10-16 13:13:29,526 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 13:15:02,396 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:41, time: 1.813, data_time: 0.081, memory: 18840, stage0_loss_instance_mil: 0.0175, stage0_bag_acc: 98.7789, stage0_mean_ious: 0.3858, stage0_s: 0.0000, stage0_m: 0.0228, stage0_l: 0.1627, stage0_h: 0.4130, stage1_loss_instance_mil: 0.1034, stage1_bag_acc: 99.2225, stage1_neg_loss: 0.0447, stage1_mean_ious: 0.3650, stage1_s: 0.0000, stage1_m: 0.0144, stage1_l: 0.1510, stage1_h: 0.3913, loss: 0.1656, grad_norm: 8.6207
2024-10-16 13:16:31,702 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:38, time: 1.786, data_time: 0.029, memory: 18840, stage0_loss_instance_mil: 0.0118, stage0_bag_acc: 99.4053, stage0_mean_ious: 0.4077, stage0_s: 0.0000, stage0_m: 0.0221, stage0_l: 0.1502, stage0_h: 0.4438, stage1_loss_instance_mil: 0.1101, stage1_bag_acc: 99.1192, stage1_neg_loss: 0.0470, stage1_mean_ious: 0.3910, stage1_s: 0.0000, stage1_m: 0.0135, stage1_l: 0.1430, stage1_h: 0.4261, loss: 0.1689, grad_norm: 9.3033
2024-10-16 13:17:58,288 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:31, time: 1.732, data_time: 0.029, memory: 18840, stage0_loss_instance_mil: 0.0088, stage0_bag_acc: 99.3321, stage0_mean_ious: 0.3878, stage0_s: 0.0000, stage0_m: 0.0481, stage0_l: 0.1001, stage0_h: 0.4224, stage1_loss_instance_mil: 0.0944, stage1_bag_acc: 99.8207, stage1_neg_loss: 0.0438, stage1_mean_ious: 0.3625, stage1_s: 0.0000, stage1_m: 0.0342, stage1_l: 0.0799, stage1_h: 0.3984, loss: 0.1470, grad_norm: 7.3359
2024-10-16 13:18:50,040 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 13:20:22,924 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:20, time: 1.812, data_time: 0.077, memory: 18840, stage0_loss_instance_mil: 0.0076, stage0_bag_acc: 99.5351, stage0_mean_ious: 0.3919, stage0_s: 0.0000, stage0_m: 0.0455, stage0_l: 0.1455, stage0_h: 0.4302, stage1_loss_instance_mil: 0.0724, stage1_bag_acc: 99.7639, stage1_neg_loss: 0.0344, stage1_mean_ious: 0.3686, stage1_s: 0.0000, stage1_m: 0.0340, stage1_l: 0.1208, stage1_h: 0.4070, loss: 0.1143, grad_norm: 5.1628
2024-10-16 13:21:49,286 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:12, time: 1.727, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.3774, stage0_s: 0.0000, stage0_m: 0.0257, stage0_l: 0.1135, stage0_h: 0.4196, stage1_loss_instance_mil: 0.0700, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0380, stage1_mean_ious: 0.3571, stage1_s: 0.0000, stage1_m: 0.0218, stage1_l: 0.0963, stage1_h: 0.3983, loss: 0.1108, grad_norm: 5.7513
2024-10-16 13:23:16,153 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:03, time: 1.737, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0019, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3961, stage0_s: 0.0000, stage0_m: 0.0283, stage0_l: 0.1618, stage0_h: 0.4287, stage1_loss_instance_mil: 0.0788, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0391, stage1_mean_ious: 0.3719, stage1_s: 0.0000, stage1_m: 0.0179, stage1_l: 0.1512, stage1_h: 0.4038, loss: 0.1198, grad_norm: 5.7138
2024-10-16 13:24:06,593 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 13:25:39,338 - mmdet - INFO - Evaluating bbox...
2024-10-16 13:25:40,165 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1016
2024-10-16 13:25:40,166 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3305
2024-10-16 13:25:40,166 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1798
2024-10-16 13:25:40,166 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0746
2024-10-16 13:25:40,166 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0414
2024-10-16 13:25:40,166 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0154
2024-10-16 13:25:40,166 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0019
2024-10-16 13:25:40,166 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0820
2024-10-16 13:25:40,166 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1210
2024-10-16 13:25:40,167 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0733
2024-10-16 13:25:40,167 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1762
2024-10-16 13:25:40,167 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4462
2024-10-16 13:25:40,167 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1762
2024-10-16 13:25:40,167 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1762
2024-10-16 13:25:40,167 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1332
2024-10-16 13:25:40,167 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2108
2024-10-16 13:25:40,167 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1341
2024-10-16 13:25:40,182 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 13:25:40,182 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 180, bbox_mAP: 0.1020, bbox_mAP_50: 0.3300, bbox_mAP_75: 0.1800, bbox_mAP_s: 0.0750, bbox_mAP_m: 0.0410, bbox_mAP_l: 0.0150, bbox_mAP_copypaste: 0.102 0.330 0.180 0.075 0.041 0.015
2024-10-16 13:27:08,376 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:56, time: 1.764, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0055, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.3872, stage0_s: 0.0000, stage0_m: 0.0232, stage0_l: 0.1382, stage0_h: 0.4286, stage1_loss_instance_mil: 0.0686, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0399, stage1_mean_ious: 0.3659, stage1_s: 0.0000, stage1_m: 0.0155, stage1_l: 0.1265, stage1_h: 0.4050, loss: 0.1140, grad_norm: 5.6467
2024-10-16 13:28:35,655 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:46, time: 1.746, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0081, stage0_bag_acc: 99.8667, stage0_mean_ious: 0.3831, stage0_s: 0.0080, stage0_m: 0.0383, stage0_l: 0.1698, stage0_h: 0.4168, stage1_loss_instance_mil: 0.0744, stage1_bag_acc: 99.8667, stage1_neg_loss: 0.0398, stage1_mean_ious: 0.3613, stage1_s: 0.0090, stage1_m: 0.0295, stage1_l: 0.1610, stage1_h: 0.3952, loss: 0.1223, grad_norm: 6.0949
2024-10-16 13:30:03,394 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:36, time: 1.755, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0030, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.3943, stage0_s: 0.0000, stage0_m: 0.0145, stage0_l: 0.1290, stage0_h: 0.4286, stage1_loss_instance_mil: 0.0645, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0371, stage1_mean_ious: 0.3817, stage1_s: 0.0000, stage1_m: 0.0105, stage1_l: 0.1237, stage1_h: 0.4151, loss: 0.1045, grad_norm: 5.7874
2024-10-16 13:30:55,982 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 13:32:27,699 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:33, time: 1.791, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0015, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3924, stage0_s: 0.0000, stage0_m: 0.0491, stage0_l: 0.1168, stage0_h: 0.4343, stage1_loss_instance_mil: 0.0681, stage1_bag_acc: 99.8667, stage1_neg_loss: 0.0371, stage1_mean_ious: 0.3668, stage1_s: 0.0000, stage1_m: 0.0365, stage1_l: 0.1043, stage1_h: 0.4083, loss: 0.1067, grad_norm: 5.4011
2024-10-16 13:33:56,184 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:22, time: 1.770, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.0014, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3913, stage0_s: 0.0000, stage0_m: 0.0196, stage0_l: 0.1483, stage0_h: 0.4230, stage1_loss_instance_mil: 0.0634, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0330, stage1_mean_ious: 0.3690, stage1_s: 0.0000, stage1_m: 0.0119, stage1_l: 0.1350, stage1_h: 0.3998, loss: 0.0978, grad_norm: 4.8932
2024-10-16 13:35:22,615 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:10, time: 1.729, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0020, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3997, stage0_s: 0.0000, stage0_m: 0.0358, stage0_l: 0.1092, stage0_h: 0.4442, stage1_loss_instance_mil: 0.0675, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0378, stage1_mean_ious: 0.3753, stage1_s: 0.0000, stage1_m: 0.0230, stage1_l: 0.0954, stage1_h: 0.4194, loss: 0.1073, grad_norm: 5.6224
2024-10-16 13:36:15,446 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 13:37:46,805 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:10, time: 1.783, data_time: 0.073, memory: 18840, stage0_loss_instance_mil: 0.0038, stage0_bag_acc: 99.9091, stage0_mean_ious: 0.3757, stage0_s: 0.0000, stage0_m: 0.0467, stage0_l: 0.1292, stage0_h: 0.4075, stage1_loss_instance_mil: 0.0607, stage1_bag_acc: 99.9091, stage1_neg_loss: 0.0407, stage1_mean_ious: 0.3549, stage1_s: 0.0000, stage1_m: 0.0373, stage1_l: 0.1140, stage1_h: 0.3879, loss: 0.1053, grad_norm: 5.5666
2024-10-16 13:39:14,245 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:57, time: 1.749, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0036, stage0_bag_acc: 99.7914, stage0_mean_ious: 0.4032, stage0_s: 0.0000, stage0_m: 0.0304, stage0_l: 0.1409, stage0_h: 0.4337, stage1_loss_instance_mil: 0.0690, stage1_bag_acc: 99.8824, stage1_neg_loss: 0.0387, stage1_mean_ious: 0.3792, stage1_s: 0.0000, stage1_m: 0.0180, stage1_l: 0.1304, stage1_h: 0.4089, loss: 0.1113, grad_norm: 4.9869
2024-10-16 13:40:42,669 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.768, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0021, stage0_bag_acc: 99.9167, stage0_mean_ious: 0.3949, stage0_s: 0.0000, stage0_m: 0.0092, stage0_l: 0.1292, stage0_h: 0.4255, stage1_loss_instance_mil: 0.0619, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0346, stage1_mean_ious: 0.3757, stage1_s: 0.0000, stage1_m: 0.0060, stage1_l: 0.1185, stage1_h: 0.4064, loss: 0.0986, grad_norm: 5.4107
2024-10-16 13:41:34,475 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 13:43:07,347 - mmdet - INFO - Evaluating bbox...
2024-10-16 13:43:08,151 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1028
2024-10-16 13:43:08,151 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3369
2024-10-16 13:43:08,151 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1836
2024-10-16 13:43:08,151 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0750
2024-10-16 13:43:08,151 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0391
2024-10-16 13:43:08,152 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0140
2024-10-16 13:43:08,152 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0019
2024-10-16 13:43:08,152 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0778
2024-10-16 13:43:08,152 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1212
2024-10-16 13:43:08,152 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0725
2024-10-16 13:43:08,152 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1765
2024-10-16 13:43:08,152 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4499
2024-10-16 13:43:08,152 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1765
2024-10-16 13:43:08,152 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1765
2024-10-16 13:43:08,152 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1226
2024-10-16 13:43:08,152 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2089
2024-10-16 13:43:08,153 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1344
2024-10-16 13:43:08,168 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 13:43:08,168 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 180, bbox_mAP: 0.1030, bbox_mAP_50: 0.3370, bbox_mAP_75: 0.1840, bbox_mAP_s: 0.0750, bbox_mAP_m: 0.0390, bbox_mAP_l: 0.0140, bbox_mAP_copypaste: 0.103 0.337 0.184 0.075 0.039 0.014
2024-10-16 13:44:39,563 - mmdet - INFO - Evaluating bbox...
2024-10-16 13:44:40,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1028
2024-10-16 13:44:40,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3369
2024-10-16 13:44:40,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1836
2024-10-16 13:44:40,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0750
2024-10-16 13:44:40,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0391
2024-10-16 13:44:40,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0140
2024-10-16 13:44:40,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0019
2024-10-16 13:44:40,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0778
2024-10-16 13:44:40,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1212
2024-10-16 13:44:40,373 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0725
2024-10-16 13:44:40,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1765
2024-10-16 13:44:40,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4499
2024-10-16 13:44:40,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1765
2024-10-16 13:44:40,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1765
2024-10-16 13:44:40,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1226
2024-10-16 13:44:40,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2089
2024-10-16 13:44:40,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1344
2024-10-16 13:44:41,685 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+e282583
------------------------------------------------------------

2024-10-16 13:44:42,568 - mmdet - INFO - Distributed training: False
2024-10-16 13:44:43,425 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [2]

2024-10-16 13:44:44,372 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 13:44:44,372 - mmdet - INFO - Use load_from_local loader
2024-10-16 13:44:44,627 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 13:44:44,643 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 13:44:44,644 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 13:46:15,328 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:03:46, time: 1.814, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.6976, stage0_bag_acc: 25.0734, stage0_mean_ious: 0.2334, stage0_s: 0.0000, stage0_m: 0.0506, stage0_l: 0.1786, stage0_h: 0.2355, stage1_loss_instance_mil: 0.1759, stage1_bag_acc: 11.4349, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.2209, stage1_s: 0.0000, stage1_m: 0.0446, stage1_l: 0.1653, stage1_h: 0.2241, loss: 0.8761, grad_norm: 3.4838
2024-10-16 13:47:43,056 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 1:01:15, time: 1.755, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.5704, stage0_bag_acc: 57.0912, stage0_mean_ious: 0.2918, stage0_s: 0.0000, stage0_m: 0.0614, stage0_l: 0.2376, stage0_h: 0.3011, stage1_loss_instance_mil: 0.2415, stage1_bag_acc: 25.2591, stage1_neg_loss: 0.0123, stage1_mean_ious: 0.2742, stage1_s: 0.0000, stage1_m: 0.0508, stage1_l: 0.2226, stage1_h: 0.2841, loss: 0.8242, grad_norm: 5.6993
2024-10-16 13:49:11,513 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:59:35, time: 1.769, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.2694, stage0_bag_acc: 86.5087, stage0_mean_ious: 0.4143, stage0_s: 0.0000, stage0_m: 0.0535, stage0_l: 0.1912, stage0_h: 0.4362, stage1_loss_instance_mil: 0.3157, stage1_bag_acc: 81.1269, stage1_neg_loss: 0.0681, stage1_mean_ious: 0.3828, stage1_s: 0.0000, stage1_m: 0.0471, stage1_l: 0.1754, stage1_h: 0.4024, loss: 0.6532, grad_norm: 13.4047
2024-10-16 13:50:04,609 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 13:51:36,345 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:49:50, time: 1.790, data_time: 0.073, memory: 18840, stage0_loss_instance_mil: 0.0704, stage0_bag_acc: 96.4300, stage0_mean_ious: 0.3501, stage0_s: 0.0000, stage0_m: 0.0420, stage0_l: 0.1485, stage0_h: 0.3712, stage1_loss_instance_mil: 0.3316, stage1_bag_acc: 97.9384, stage1_neg_loss: 0.0851, stage1_mean_ious: 0.3156, stage1_s: 0.0000, stage1_m: 0.0258, stage1_l: 0.1217, stage1_h: 0.3383, loss: 0.4871, grad_norm: 15.8604
2024-10-16 13:53:04,496 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:49:44, time: 1.763, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0664, stage0_bag_acc: 96.6980, stage0_mean_ious: 0.3397, stage0_s: 0.0000, stage0_m: 0.0393, stage0_l: 0.1573, stage0_h: 0.3647, stage1_loss_instance_mil: 0.2810, stage1_bag_acc: 97.2145, stage1_neg_loss: 0.0912, stage1_mean_ious: 0.3081, stage1_s: 0.0000, stage1_m: 0.0272, stage1_l: 0.1320, stage1_h: 0.3340, loss: 0.4385, grad_norm: 17.7870
2024-10-16 13:54:30,107 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:48:59, time: 1.712, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0461, stage0_bag_acc: 97.8124, stage0_mean_ious: 0.3469, stage0_s: 0.0000, stage0_m: 0.0595, stage0_l: 0.1363, stage0_h: 0.3738, stage1_loss_instance_mil: 0.2737, stage1_bag_acc: 98.3186, stage1_neg_loss: 0.0952, stage1_mean_ious: 0.3054, stage1_s: 0.0000, stage1_m: 0.0409, stage1_l: 0.1022, stage1_h: 0.3326, loss: 0.4149, grad_norm: 20.0430
2024-10-16 13:55:21,624 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 13:56:52,872 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:44:02, time: 1.780, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0229, stage0_bag_acc: 99.1426, stage0_mean_ious: 0.3564, stage0_s: 0.0000, stage0_m: 0.0550, stage0_l: 0.0955, stage0_h: 0.3878, stage1_loss_instance_mil: 0.2366, stage1_bag_acc: 99.5497, stage1_neg_loss: 0.0913, stage1_mean_ious: 0.3144, stage1_s: 0.0000, stage1_m: 0.0348, stage1_l: 0.0789, stage1_h: 0.3468, loss: 0.3508, grad_norm: 18.0354
2024-10-16 13:58:20,315 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:43:31, time: 1.749, data_time: 0.029, memory: 18840, stage0_loss_instance_mil: 0.0423, stage0_bag_acc: 97.2575, stage0_mean_ious: 0.3177, stage0_s: 0.0000, stage0_m: 0.0394, stage0_l: 0.1203, stage0_h: 0.3407, stage1_loss_instance_mil: 0.2702, stage1_bag_acc: 98.1112, stage1_neg_loss: 0.1029, stage1_mean_ious: 0.2871, stage1_s: 0.0000, stage1_m: 0.0228, stage1_l: 0.0870, stage1_h: 0.3124, loss: 0.4155, grad_norm: 25.0909
2024-10-16 13:59:47,285 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:42:47, time: 1.739, data_time: 0.029, memory: 18840, stage0_loss_instance_mil: 0.0360, stage0_bag_acc: 98.6913, stage0_mean_ious: 0.3224, stage0_s: 0.0084, stage0_m: 0.0430, stage0_l: 0.1331, stage0_h: 0.3521, stage1_loss_instance_mil: 0.2240, stage1_bag_acc: 98.5701, stage1_neg_loss: 0.0810, stage1_mean_ious: 0.2807, stage1_s: 0.0073, stage1_m: 0.0234, stage1_l: 0.0967, stage1_h: 0.3106, loss: 0.3410, grad_norm: 18.1861
2024-10-16 14:00:38,056 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 14:02:11,000 - mmdet - INFO - Evaluating bbox...
2024-10-16 14:02:11,788 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0462
2024-10-16 14:02:11,788 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1621
2024-10-16 14:02:11,788 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0805
2024-10-16 14:02:11,788 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0296
2024-10-16 14:02:11,788 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0140
2024-10-16 14:02:11,788 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0052
2024-10-16 14:02:11,789 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 14:02:11,789 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0614
2024-10-16 14:02:11,789 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0514
2024-10-16 14:02:11,789 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0506
2024-10-16 14:02:11,789 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0968
2024-10-16 14:02:11,789 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2600
2024-10-16 14:02:11,789 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0968
2024-10-16 14:02:11,789 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0968
2024-10-16 14:02:11,789 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0667
2024-10-16 14:02:11,789 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1357
2024-10-16 14:02:11,789 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0758
2024-10-16 14:02:11,803 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 14:02:11,803 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 180, bbox_mAP: 0.0460, bbox_mAP_50: 0.1620, bbox_mAP_75: 0.0810, bbox_mAP_s: 0.0300, bbox_mAP_m: 0.0140, bbox_mAP_l: 0.0050, bbox_mAP_copypaste: 0.046 0.162 0.081 0.030 0.014 0.005
2024-10-16 14:03:40,030 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:39:06, time: 1.764, data_time: 0.076, memory: 18840, stage0_loss_instance_mil: 0.0192, stage0_bag_acc: 99.3425, stage0_mean_ious: 0.3316, stage0_s: 0.0082, stage0_m: 0.0351, stage0_l: 0.1274, stage0_h: 0.3623, stage1_loss_instance_mil: 0.1926, stage1_bag_acc: 99.0981, stage1_neg_loss: 0.0718, stage1_mean_ious: 0.2854, stage1_s: 0.0070, stage1_m: 0.0192, stage1_l: 0.0978, stage1_h: 0.3154, loss: 0.2837, grad_norm: 13.6677
2024-10-16 14:05:03,538 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:38:12, time: 1.670, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0315, stage0_bag_acc: 97.6880, stage0_mean_ious: 0.3230, stage0_s: 0.0000, stage0_m: 0.0099, stage0_l: 0.1126, stage0_h: 0.3440, stage1_loss_instance_mil: 0.1722, stage1_bag_acc: 98.2590, stage1_neg_loss: 0.0680, stage1_mean_ious: 0.2820, stage1_s: 0.0000, stage1_m: 0.0060, stage1_l: 0.0825, stage1_h: 0.3027, loss: 0.2717, grad_norm: 13.3182
2024-10-16 14:06:29,761 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:20, time: 1.724, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0335, stage0_bag_acc: 97.7506, stage0_mean_ious: 0.3275, stage0_s: 0.0000, stage0_m: 0.0385, stage0_l: 0.1115, stage0_h: 0.3544, stage1_loss_instance_mil: 0.1953, stage1_bag_acc: 98.5524, stage1_neg_loss: 0.0823, stage1_mean_ious: 0.2848, stage1_s: 0.0000, stage1_m: 0.0238, stage1_l: 0.0818, stage1_h: 0.3112, loss: 0.3111, grad_norm: 18.8167
2024-10-16 14:07:21,731 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 14:08:53,749 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:20, time: 1.796, data_time: 0.079, memory: 18840, stage0_loss_instance_mil: 0.0182, stage0_bag_acc: 98.8625, stage0_mean_ious: 0.3396, stage0_s: 0.0000, stage0_m: 0.0256, stage0_l: 0.1112, stage0_h: 0.3745, stage1_loss_instance_mil: 0.1698, stage1_bag_acc: 99.2320, stage1_neg_loss: 0.0686, stage1_mean_ious: 0.2943, stage1_s: 0.0000, stage1_m: 0.0141, stage1_l: 0.0801, stage1_h: 0.3274, loss: 0.2566, grad_norm: 13.2915
2024-10-16 14:10:21,378 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:28, time: 1.753, data_time: 0.031, memory: 18840, stage0_loss_instance_mil: 0.0257, stage0_bag_acc: 98.3596, stage0_mean_ious: 0.3114, stage0_s: 0.0000, stage0_m: 0.0469, stage0_l: 0.1096, stage0_h: 0.3458, stage1_loss_instance_mil: 0.1555, stage1_bag_acc: 99.0025, stage1_neg_loss: 0.0603, stage1_mean_ious: 0.2681, stage1_s: 0.0000, stage1_m: 0.0270, stage1_l: 0.0806, stage1_h: 0.3014, loss: 0.2415, grad_norm: 10.7534
2024-10-16 14:11:49,172 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:32, time: 1.756, data_time: 0.030, memory: 18840, stage0_loss_instance_mil: 0.0149, stage0_bag_acc: 99.1158, stage0_mean_ious: 0.3357, stage0_s: 0.0000, stage0_m: 0.0325, stage0_l: 0.1309, stage0_h: 0.3625, stage1_loss_instance_mil: 0.1777, stage1_bag_acc: 99.0804, stage1_neg_loss: 0.0708, stage1_mean_ious: 0.2960, stage1_s: 0.0000, stage1_m: 0.0226, stage1_l: 0.1091, stage1_h: 0.3218, loss: 0.2634, grad_norm: 16.1542
2024-10-16 14:12:41,040 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 14:14:11,599 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:49, time: 1.768, data_time: 0.077, memory: 18840, stage0_loss_instance_mil: 0.0088, stage0_bag_acc: 99.5890, stage0_mean_ious: 0.3378, stage0_s: 0.0079, stage0_m: 0.0310, stage0_l: 0.1148, stage0_h: 0.3656, stage1_loss_instance_mil: 0.1609, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0644, stage1_mean_ious: 0.2969, stage1_s: 0.0052, stage1_m: 0.0172, stage1_l: 0.0933, stage1_h: 0.3240, loss: 0.2341, grad_norm: 13.2344
2024-10-16 14:15:37,738 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 14:15:37,738 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:49, time: 1.723, data_time: 0.029, memory: 18840, stage0_loss_instance_mil: 0.0116, stage0_bag_acc: 99.2740, stage0_mean_ious: 0.3386, stage0_s: 0.0000, stage0_m: 0.0417, stage0_l: 0.0781, stage0_h: 0.3638, stage1_loss_instance_mil: 0.1673, stage1_bag_acc: 99.2486, stage1_neg_loss: 0.0733, stage1_mean_ious: 0.2969, stage1_s: 0.0000, stage1_m: 0.0256, stage1_l: 0.0591, stage1_h: 0.3210, loss: 0.2522, grad_norm: 14.8240
2024-10-16 14:17:04,857 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:48, time: 1.742, data_time: 0.031, memory: 18840, stage0_loss_instance_mil: 0.0127, stage0_bag_acc: 99.5036, stage0_mean_ious: 0.3003, stage0_s: 0.0000, stage0_m: 0.0442, stage0_l: 0.0927, stage0_h: 0.3285, stage1_loss_instance_mil: 0.1355, stage1_bag_acc: 99.8147, stage1_neg_loss: 0.0659, stage1_mean_ious: 0.2640, stage1_s: 0.0000, stage1_m: 0.0263, stage1_l: 0.0682, stage1_h: 0.2924, loss: 0.2141, grad_norm: 11.3475
2024-10-16 14:17:57,277 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 14:19:30,883 - mmdet - INFO - Evaluating bbox...
2024-10-16 14:19:31,687 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0407
2024-10-16 14:19:31,687 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1484
2024-10-16 14:19:31,687 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0722
2024-10-16 14:19:31,687 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0209
2024-10-16 14:19:31,687 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0091
2024-10-16 14:19:31,687 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0029
2024-10-16 14:19:31,687 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 14:19:31,687 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0285
2024-10-16 14:19:31,688 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0452
2024-10-16 14:19:31,688 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0580
2024-10-16 14:19:31,688 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0867
2024-10-16 14:19:31,688 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2470
2024-10-16 14:19:31,688 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0867
2024-10-16 14:19:31,688 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0867
2024-10-16 14:19:31,688 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0484
2024-10-16 14:19:31,688 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1254
2024-10-16 14:19:31,688 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0845
2024-10-16 14:19:31,702 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 14:19:31,702 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 180, bbox_mAP: 0.0410, bbox_mAP_50: 0.1480, bbox_mAP_75: 0.0720, bbox_mAP_s: 0.0210, bbox_mAP_m: 0.0090, bbox_mAP_l: 0.0030, bbox_mAP_copypaste: 0.041 0.148 0.072 0.021 0.009 0.003
2024-10-16 14:21:00,461 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:19, time: 1.775, data_time: 0.076, memory: 18840, stage0_loss_instance_mil: 0.0105, stage0_bag_acc: 99.3439, stage0_mean_ious: 0.3263, stage0_s: 0.0000, stage0_m: 0.0234, stage0_l: 0.1166, stage0_h: 0.3523, stage1_loss_instance_mil: 0.1148, stage1_bag_acc: 99.4233, stage1_neg_loss: 0.0496, stage1_mean_ious: 0.2897, stage1_s: 0.0000, stage1_m: 0.0141, stage1_l: 0.0933, stage1_h: 0.3156, loss: 0.1749, grad_norm: 7.9313
2024-10-16 14:22:28,133 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:17, time: 1.753, data_time: 0.028, memory: 18840, stage0_loss_instance_mil: 0.0090, stage0_bag_acc: 99.4445, stage0_mean_ious: 0.3134, stage0_s: 0.0000, stage0_m: 0.0350, stage0_l: 0.1050, stage0_h: 0.3504, stage1_loss_instance_mil: 0.1202, stage1_bag_acc: 99.6914, stage1_neg_loss: 0.0568, stage1_mean_ious: 0.2811, stage1_s: 0.0000, stage1_m: 0.0253, stage1_l: 0.0825, stage1_h: 0.3170, loss: 0.1859, grad_norm: 10.9881
2024-10-16 14:23:56,478 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:23:13, time: 1.767, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.0064, stage0_bag_acc: 99.6591, stage0_mean_ious: 0.3551, stage0_s: 0.0000, stage0_m: 0.0394, stage0_l: 0.0795, stage0_h: 0.3870, stage1_loss_instance_mil: 0.1167, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0509, stage1_mean_ious: 0.3169, stage1_s: 0.0000, stage1_m: 0.0250, stage1_l: 0.0644, stage1_h: 0.3475, loss: 0.1740, grad_norm: 9.7446
2024-10-16 14:24:49,200 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 14:26:22,019 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:54, time: 1.813, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0133, stage0_bag_acc: 99.2648, stage0_mean_ious: 0.2991, stage0_s: 0.0000, stage0_m: 0.0352, stage0_l: 0.1151, stage0_h: 0.3228, stage1_loss_instance_mil: 0.1221, stage1_bag_acc: 99.6110, stage1_neg_loss: 0.0521, stage1_mean_ious: 0.2661, stage1_s: 0.0000, stage1_m: 0.0235, stage1_l: 0.0924, stage1_h: 0.2900, loss: 0.1875, grad_norm: 9.3707
2024-10-16 14:27:48,852 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:48, time: 1.737, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0126, stage0_bag_acc: 99.2538, stage0_mean_ious: 0.3395, stage0_s: 0.0079, stage0_m: 0.0386, stage0_l: 0.0988, stage0_h: 0.3725, stage1_loss_instance_mil: 0.1184, stage1_bag_acc: 99.5441, stage1_neg_loss: 0.0534, stage1_mean_ious: 0.3044, stage1_s: 0.0053, stage1_m: 0.0237, stage1_l: 0.0831, stage1_h: 0.3363, loss: 0.1845, grad_norm: 9.1295
2024-10-16 14:29:16,855 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:41, time: 1.760, data_time: 0.028, memory: 18840, stage0_loss_instance_mil: 0.0082, stage0_bag_acc: 99.5714, stage0_mean_ious: 0.3418, stage0_s: 0.0000, stage0_m: 0.0329, stage0_l: 0.0894, stage0_h: 0.3755, stage1_loss_instance_mil: 0.1094, stage1_bag_acc: 99.6536, stage1_neg_loss: 0.0507, stage1_mean_ious: 0.3064, stage1_s: 0.0000, stage1_m: 0.0216, stage1_l: 0.0670, stage1_h: 0.3399, loss: 0.1683, grad_norm: 10.4494
2024-10-16 14:30:09,962 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 14:31:43,435 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:29, time: 1.825, data_time: 0.077, memory: 18840, stage0_loss_instance_mil: 0.0043, stage0_bag_acc: 99.6995, stage0_mean_ious: 0.3381, stage0_s: 0.0079, stage0_m: 0.0353, stage0_l: 0.1072, stage0_h: 0.3726, stage1_loss_instance_mil: 0.0965, stage1_bag_acc: 99.8947, stage1_neg_loss: 0.0522, stage1_mean_ious: 0.3023, stage1_s: 0.0056, stage1_m: 0.0222, stage1_l: 0.0800, stage1_h: 0.3375, loss: 0.1530, grad_norm: 7.4516
2024-10-16 14:33:12,375 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:21, time: 1.779, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.0101, stage0_bag_acc: 99.6586, stage0_mean_ious: 0.3268, stage0_s: 0.0000, stage0_m: 0.0514, stage0_l: 0.1155, stage0_h: 0.3540, stage1_loss_instance_mil: 0.0831, stage1_bag_acc: 99.4768, stage1_neg_loss: 0.0425, stage1_mean_ious: 0.3019, stage1_s: 0.0000, stage1_m: 0.0342, stage1_l: 0.0982, stage1_h: 0.3308, loss: 0.1357, grad_norm: 6.3409
2024-10-16 14:34:40,441 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:12, time: 1.761, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.3068, stage0_s: 0.0000, stage0_m: 0.0176, stage0_l: 0.1120, stage0_h: 0.3260, stage1_loss_instance_mil: 0.0852, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0379, stage1_mean_ious: 0.2866, stage1_s: 0.0000, stage1_m: 0.0104, stage1_l: 0.0902, stage1_h: 0.3071, loss: 0.1258, grad_norm: 4.9616
2024-10-16 14:35:33,634 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 14:37:06,702 - mmdet - INFO - Evaluating bbox...
2024-10-16 14:37:07,488 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0574
2024-10-16 14:37:07,488 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2243
2024-10-16 14:37:07,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0953
2024-10-16 14:37:07,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0297
2024-10-16 14:37:07,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0116
2024-10-16 14:37:07,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0029
2024-10-16 14:37:07,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 14:37:07,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0219
2024-10-16 14:37:07,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0612
2024-10-16 14:37:07,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0741
2024-10-16 14:37:07,489 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1110
2024-10-16 14:37:07,489 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3217
2024-10-16 14:37:07,490 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1110
2024-10-16 14:37:07,490 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1110
2024-10-16 14:37:07,490 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0283
2024-10-16 14:37:07,490 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1289
2024-10-16 14:37:07,490 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1234
2024-10-16 14:37:07,506 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 14:37:07,507 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 180, bbox_mAP: 0.0570, bbox_mAP_50: 0.2240, bbox_mAP_75: 0.0950, bbox_mAP_s: 0.0300, bbox_mAP_m: 0.0120, bbox_mAP_l: 0.0030, bbox_mAP_copypaste: 0.057 0.224 0.095 0.030 0.012 0.003
2024-10-16 14:38:37,623 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:12:03, time: 1.802, data_time: 0.076, memory: 18840, stage0_loss_instance_mil: 0.0034, stage0_bag_acc: 99.8490, stage0_mean_ious: 0.3203, stage0_s: 0.0000, stage0_m: 0.0296, stage0_l: 0.0896, stage0_h: 0.3435, stage1_loss_instance_mil: 0.0800, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0414, stage1_mean_ious: 0.2904, stage1_s: 0.0000, stage1_m: 0.0176, stage1_l: 0.0705, stage1_h: 0.3139, loss: 0.1248, grad_norm: 5.4550
2024-10-16 14:40:05,919 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:53, time: 1.766, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0044, stage0_bag_acc: 99.9286, stage0_mean_ious: 0.3265, stage0_s: 0.0000, stage0_m: 0.0459, stage0_l: 0.1186, stage0_h: 0.3555, stage1_loss_instance_mil: 0.0851, stage1_bag_acc: 99.9286, stage1_neg_loss: 0.0418, stage1_mean_ious: 0.2956, stage1_s: 0.0000, stage1_m: 0.0283, stage1_l: 0.0925, stage1_h: 0.3262, loss: 0.1313, grad_norm: 5.7131
2024-10-16 14:41:33,781 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:42, time: 1.757, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0050, stage0_bag_acc: 99.7321, stage0_mean_ious: 0.3282, stage0_s: 0.0000, stage0_m: 0.0313, stage0_l: 0.0953, stage0_h: 0.3686, stage1_loss_instance_mil: 0.0736, stage1_bag_acc: 99.8571, stage1_neg_loss: 0.0365, stage1_mean_ious: 0.2998, stage1_s: 0.0000, stage1_m: 0.0219, stage1_l: 0.0715, stage1_h: 0.3396, loss: 0.1151, grad_norm: 5.7183
2024-10-16 14:42:25,480 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 14:43:57,431 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:37, time: 1.796, data_time: 0.076, memory: 18840, stage0_loss_instance_mil: 0.0072, stage0_bag_acc: 99.6805, stage0_mean_ious: 0.3283, stage0_s: 0.0000, stage0_m: 0.0492, stage0_l: 0.1147, stage0_h: 0.3551, stage1_loss_instance_mil: 0.0702, stage1_bag_acc: 99.7519, stage1_neg_loss: 0.0391, stage1_mean_ious: 0.2973, stage1_s: 0.0000, stage1_m: 0.0288, stage1_l: 0.0937, stage1_h: 0.3237, loss: 0.1164, grad_norm: 5.6184
2024-10-16 14:45:24,906 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:25, time: 1.750, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0031, stage0_bag_acc: 99.8248, stage0_mean_ious: 0.3297, stage0_s: 0.0000, stage0_m: 0.0370, stage0_l: 0.1329, stage0_h: 0.3535, stage1_loss_instance_mil: 0.0738, stage1_bag_acc: 99.8400, stage1_neg_loss: 0.0381, stage1_mean_ious: 0.2995, stage1_s: 0.0000, stage1_m: 0.0285, stage1_l: 0.1054, stage1_h: 0.3238, loss: 0.1149, grad_norm: 5.3323
2024-10-16 14:46:53,783 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:13, time: 1.778, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0030, stage0_bag_acc: 99.8667, stage0_mean_ious: 0.3264, stage0_s: 0.0000, stage0_m: 0.0211, stage0_l: 0.1058, stage0_h: 0.3473, stage1_loss_instance_mil: 0.0743, stage1_bag_acc: 99.8667, stage1_neg_loss: 0.0418, stage1_mean_ious: 0.2975, stage1_s: 0.0000, stage1_m: 0.0136, stage1_l: 0.0919, stage1_h: 0.3183, loss: 0.1190, grad_norm: 6.5361
2024-10-16 14:47:47,220 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 14:49:20,335 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:12, time: 1.819, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0045, stage0_bag_acc: 99.9200, stage0_mean_ious: 0.3321, stage0_s: 0.0000, stage0_m: 0.0366, stage0_l: 0.1079, stage0_h: 0.3613, stage1_loss_instance_mil: 0.0753, stage1_bag_acc: 99.9200, stage1_neg_loss: 0.0398, stage1_mean_ious: 0.2996, stage1_s: 0.0000, stage1_m: 0.0225, stage1_l: 0.0906, stage1_h: 0.3285, loss: 0.1197, grad_norm: 5.4710
2024-10-16 14:50:47,471 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:58, time: 1.743, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3332, stage0_s: 0.0000, stage0_m: 0.0339, stage0_l: 0.1168, stage0_h: 0.3723, stage1_loss_instance_mil: 0.0687, stage1_bag_acc: 99.9200, stage1_neg_loss: 0.0367, stage1_mean_ious: 0.3060, stage1_s: 0.0000, stage1_m: 0.0224, stage1_l: 0.0974, stage1_h: 0.3450, loss: 0.1082, grad_norm: 5.1666
2024-10-16 14:52:14,326 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.737, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0022, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3072, stage0_s: 0.0000, stage0_m: 0.0279, stage0_l: 0.1308, stage0_h: 0.3280, stage1_loss_instance_mil: 0.0692, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0352, stage1_mean_ious: 0.2757, stage1_s: 0.0000, stage1_m: 0.0187, stage1_l: 0.1142, stage1_h: 0.2961, loss: 0.1066, grad_norm: 4.7733
2024-10-16 14:53:06,116 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 14:54:38,628 - mmdet - INFO - Evaluating bbox...
2024-10-16 14:54:39,416 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0551
2024-10-16 14:54:39,416 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2083
2024-10-16 14:54:39,416 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0959
2024-10-16 14:54:39,416 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0289
2024-10-16 14:54:39,416 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0106
2024-10-16 14:54:39,416 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0021
2024-10-16 14:54:39,416 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 14:54:39,416 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0164
2024-10-16 14:54:39,416 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0590
2024-10-16 14:54:39,417 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0736
2024-10-16 14:54:39,417 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1073
2024-10-16 14:54:39,417 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3102
2024-10-16 14:54:39,417 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1073
2024-10-16 14:54:39,417 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1073
2024-10-16 14:54:39,417 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0217
2024-10-16 14:54:39,417 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1269
2024-10-16 14:54:39,417 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1175
2024-10-16 14:54:39,434 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 14:54:39,434 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 180, bbox_mAP: 0.0550, bbox_mAP_50: 0.2080, bbox_mAP_75: 0.0960, bbox_mAP_s: 0.0290, bbox_mAP_m: 0.0110, bbox_mAP_l: 0.0020, bbox_mAP_copypaste: 0.055 0.208 0.096 0.029 0.011 0.002
2024-10-16 14:56:10,669 - mmdet - INFO - Evaluating bbox...
2024-10-16 14:56:11,386 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0551
2024-10-16 14:56:11,386 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2083
2024-10-16 14:56:11,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0959
2024-10-16 14:56:11,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0289
2024-10-16 14:56:11,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0106
2024-10-16 14:56:11,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0021
2024-10-16 14:56:11,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-10-16 14:56:11,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0164
2024-10-16 14:56:11,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0590
2024-10-16 14:56:11,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0736
2024-10-16 14:56:11,387 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1073
2024-10-16 14:56:11,387 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3102
2024-10-16 14:56:11,387 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1073
2024-10-16 14:56:11,388 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1073
2024-10-16 14:56:11,388 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0217
2024-10-16 14:56:11,388 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1269
2024-10-16 14:56:11,388 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1175
2024-10-16 14:56:12,684 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+e282583
------------------------------------------------------------

2024-10-16 14:56:13,573 - mmdet - INFO - Distributed training: False
2024-10-16 14:56:14,414 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [2]

2024-10-16 14:56:15,461 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 14:56:15,461 - mmdet - INFO - Use load_from_local loader
2024-10-16 14:56:15,741 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 14:56:15,762 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 14:56:15,762 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 14:57:44,031 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:02:04, time: 1.765, data_time: 0.072, memory: 18840, stage0_loss_instance_mil: 0.7088, stage0_bag_acc: 20.7941, stage0_mean_ious: 0.3840, stage0_s: 0.0000, stage0_m: 0.0664, stage0_l: 0.3025, stage0_h: 0.3892, stage1_loss_instance_mil: 0.1776, stage1_bag_acc: 12.2103, stage1_neg_loss: 0.0008, stage1_mean_ious: 0.3802, stage1_s: 0.0000, stage1_m: 0.0708, stage1_l: 0.3122, stage1_h: 0.3820, loss: 0.8872, grad_norm: 3.1458
2024-10-16 14:59:11,389 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 1:00:17, time: 1.747, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.5891, stage0_bag_acc: 51.5348, stage0_mean_ious: 0.3797, stage0_s: 0.0000, stage0_m: 0.0609, stage0_l: 0.2422, stage0_h: 0.3866, stage1_loss_instance_mil: 0.2396, stage1_bag_acc: 36.2665, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.3656, stage1_s: 0.0000, stage1_m: 0.0606, stage1_l: 0.2420, stage1_h: 0.3716, loss: 0.8324, grad_norm: 4.0635
2024-10-16 15:00:38,040 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:58:34, time: 1.733, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.2868, stage0_bag_acc: 85.0288, stage0_mean_ious: 0.3960, stage0_s: 0.0000, stage0_m: 0.0363, stage0_l: 0.2190, stage0_h: 0.4146, stage1_loss_instance_mil: 0.3250, stage1_bag_acc: 72.6679, stage1_neg_loss: 0.0642, stage1_mean_ious: 0.3691, stage1_s: 0.0000, stage1_m: 0.0307, stage1_l: 0.2018, stage1_h: 0.3873, loss: 0.6761, grad_norm: 10.7676
2024-10-16 15:01:29,415 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 15:03:00,687 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:49:08, time: 1.782, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0739, stage0_bag_acc: 96.3181, stage0_mean_ious: 0.2954, stage0_s: 0.0000, stage0_m: 0.0217, stage0_l: 0.1369, stage0_h: 0.3101, stage1_loss_instance_mil: 0.3413, stage1_bag_acc: 97.8444, stage1_neg_loss: 0.0873, stage1_mean_ious: 0.2863, stage1_s: 0.0000, stage1_m: 0.0175, stage1_l: 0.1164, stage1_h: 0.3027, loss: 0.5025, grad_norm: 11.2276
2024-10-16 15:04:27,761 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:49:03, time: 1.741, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0461, stage0_bag_acc: 98.0832, stage0_mean_ious: 0.2735, stage0_s: 0.0000, stage0_m: 0.0591, stage0_l: 0.1414, stage0_h: 0.2848, stage1_loss_instance_mil: 0.3344, stage1_bag_acc: 98.3825, stage1_neg_loss: 0.0915, stage1_mean_ious: 0.2551, stage1_s: 0.0000, stage1_m: 0.0522, stage1_l: 0.1255, stage1_h: 0.2678, loss: 0.4720, grad_norm: 11.6993
2024-10-16 15:05:54,789 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:48:33, time: 1.741, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0422, stage0_bag_acc: 97.5120, stage0_mean_ious: 0.2736, stage0_s: 0.0000, stage0_m: 0.0759, stage0_l: 0.1265, stage0_h: 0.2872, stage1_loss_instance_mil: 0.3476, stage1_bag_acc: 98.3729, stage1_neg_loss: 0.0820, stage1_mean_ious: 0.2502, stage1_s: 0.0000, stage1_m: 0.0644, stage1_l: 0.1136, stage1_h: 0.2636, loss: 0.4717, grad_norm: 11.5707
2024-10-16 15:06:48,251 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 15:08:19,334 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:43:42, time: 1.778, data_time: 0.073, memory: 18840, stage0_loss_instance_mil: 0.0236, stage0_bag_acc: 98.8169, stage0_mean_ious: 0.2861, stage0_s: 0.0000, stage0_m: 0.0690, stage0_l: 0.1533, stage0_h: 0.3019, stage1_loss_instance_mil: 0.2818, stage1_bag_acc: 99.4383, stage1_neg_loss: 0.0964, stage1_mean_ious: 0.2616, stage1_s: 0.0000, stage1_m: 0.0507, stage1_l: 0.1460, stage1_h: 0.2757, loss: 0.4017, grad_norm: 13.4561
2024-10-16 15:09:47,451 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:43:16, time: 1.762, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0532, stage0_bag_acc: 97.1082, stage0_mean_ious: 0.3015, stage0_s: 0.0000, stage0_m: 0.0720, stage0_l: 0.1817, stage0_h: 0.3165, stage1_loss_instance_mil: 0.3124, stage1_bag_acc: 97.5910, stage1_neg_loss: 0.0773, stage1_mean_ious: 0.2753, stage1_s: 0.0000, stage1_m: 0.0620, stage1_l: 0.1721, stage1_h: 0.2879, loss: 0.4428, grad_norm: 12.5623
2024-10-16 15:11:14,875 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:42:35, time: 1.748, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0557, stage0_bag_acc: 96.2375, stage0_mean_ious: 0.4334, stage0_s: 0.0000, stage0_m: 0.0329, stage0_l: 0.1414, stage0_h: 0.4583, stage1_loss_instance_mil: 0.2714, stage1_bag_acc: 97.3672, stage1_neg_loss: 0.0779, stage1_mean_ious: 0.4041, stage1_s: 0.0000, stage1_m: 0.0311, stage1_l: 0.1412, stage1_h: 0.4258, loss: 0.4051, grad_norm: 13.0324
2024-10-16 15:12:07,790 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 15:13:40,660 - mmdet - INFO - Evaluating bbox...
2024-10-16 15:13:41,484 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1280
2024-10-16 15:13:41,484 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2764
2024-10-16 15:13:41,484 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1997
2024-10-16 15:13:41,484 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1468
2024-10-16 15:13:41,484 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1246
2024-10-16 15:13:41,484 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0928
2024-10-16 15:13:41,484 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0069
2024-10-16 15:13:41,484 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1506
2024-10-16 15:13:41,485 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0904
2024-10-16 15:13:41,485 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1655
2024-10-16 15:13:41,485 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1961
2024-10-16 15:13:41,485 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4100
2024-10-16 15:13:41,485 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1961
2024-10-16 15:13:41,485 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1961
2024-10-16 15:13:41,485 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2084
2024-10-16 15:13:41,485 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1655
2024-10-16 15:13:41,485 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1853
2024-10-16 15:13:41,499 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 15:13:41,499 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 180, bbox_mAP: 0.1280, bbox_mAP_50: 0.2760, bbox_mAP_75: 0.2000, bbox_mAP_s: 0.1470, bbox_mAP_m: 0.1250, bbox_mAP_l: 0.0930, bbox_mAP_copypaste: 0.128 0.276 0.200 0.147 0.125 0.093
2024-10-16 15:15:11,841 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:39:02, time: 1.806, data_time: 0.076, memory: 18840, stage0_loss_instance_mil: 0.0429, stage0_bag_acc: 97.4444, stage0_mean_ious: 0.5057, stage0_s: 0.0000, stage0_m: 0.0694, stage0_l: 0.2074, stage0_h: 0.5399, stage1_loss_instance_mil: 0.1691, stage1_bag_acc: 97.8239, stage1_neg_loss: 0.0612, stage1_mean_ious: 0.4735, stage1_s: 0.0000, stage1_m: 0.0607, stage1_l: 0.2007, stage1_h: 0.5052, loss: 0.2732, grad_norm: 10.1140
2024-10-16 15:16:40,049 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:38:20, time: 1.764, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.0170, stage0_bag_acc: 99.2132, stage0_mean_ious: 0.5016, stage0_s: 0.0000, stage0_m: 0.0496, stage0_l: 0.2383, stage0_h: 0.5373, stage1_loss_instance_mil: 0.1346, stage1_bag_acc: 98.3491, stage1_neg_loss: 0.0577, stage1_mean_ious: 0.4754, stage1_s: 0.0000, stage1_m: 0.0540, stage1_l: 0.2462, stage1_h: 0.5061, loss: 0.2093, grad_norm: 7.5388
2024-10-16 15:18:08,301 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:31, time: 1.765, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0095, stage0_bag_acc: 99.6409, stage0_mean_ious: 0.5057, stage0_s: 0.0000, stage0_m: 0.0459, stage0_l: 0.2434, stage0_h: 0.5323, stage1_loss_instance_mil: 0.1187, stage1_bag_acc: 99.5389, stage1_neg_loss: 0.0472, stage1_mean_ious: 0.4798, stage1_s: 0.0000, stage1_m: 0.0491, stage1_l: 0.2487, stage1_h: 0.5030, loss: 0.1754, grad_norm: 6.0274
2024-10-16 15:18:59,964 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 15:20:33,378 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:32, time: 1.824, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0229, stage0_bag_acc: 98.5405, stage0_mean_ious: 0.4997, stage0_s: 0.0000, stage0_m: 0.0532, stage0_l: 0.2270, stage0_h: 0.5331, stage1_loss_instance_mil: 0.0924, stage1_bag_acc: 99.1780, stage1_neg_loss: 0.0453, stage1_mean_ious: 0.4772, stage1_s: 0.0000, stage1_m: 0.0575, stage1_l: 0.2342, stage1_h: 0.5058, loss: 0.1606, grad_norm: 5.9009
2024-10-16 15:21:59,079 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:35, time: 1.714, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0100, stage0_bag_acc: 99.6825, stage0_mean_ious: 0.5152, stage0_s: 0.0084, stage0_m: 0.0572, stage0_l: 0.2578, stage0_h: 0.5583, stage1_loss_instance_mil: 0.0963, stage1_bag_acc: 99.7167, stage1_neg_loss: 0.0533, stage1_mean_ious: 0.4955, stage1_s: 0.0099, stage1_m: 0.0596, stage1_l: 0.2633, stage1_h: 0.5345, loss: 0.1596, grad_norm: 8.1082
2024-10-16 15:23:27,251 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:39, time: 1.763, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0119, stage0_bag_acc: 99.5864, stage0_mean_ious: 0.5404, stage0_s: 0.0000, stage0_m: 0.0611, stage0_l: 0.2184, stage0_h: 0.5759, stage1_loss_instance_mil: 0.1066, stage1_bag_acc: 99.5150, stage1_neg_loss: 0.0476, stage1_mean_ious: 0.5190, stage1_s: 0.0000, stage1_m: 0.0670, stage1_l: 0.2274, stage1_h: 0.5501, loss: 0.1661, grad_norm: 7.3822
2024-10-16 15:24:18,607 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 15:25:49,105 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:56, time: 1.766, data_time: 0.077, memory: 18840, stage0_loss_instance_mil: 0.0124, stage0_bag_acc: 99.1386, stage0_mean_ious: 0.5231, stage0_s: 0.0000, stage0_m: 0.0421, stage0_l: 0.2474, stage0_h: 0.5683, stage1_loss_instance_mil: 0.0899, stage1_bag_acc: 99.4875, stage1_neg_loss: 0.0391, stage1_mean_ious: 0.4942, stage1_s: 0.0000, stage1_m: 0.0412, stage1_l: 0.2533, stage1_h: 0.5331, loss: 0.1415, grad_norm: 5.7245
2024-10-16 15:27:16,552 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 15:27:16,552 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:57, time: 1.749, data_time: 0.028, memory: 18840, stage0_loss_instance_mil: 0.0229, stage0_bag_acc: 98.4654, stage0_mean_ious: 0.5830, stage0_s: 0.0000, stage0_m: 0.0436, stage0_l: 0.2278, stage0_h: 0.6145, stage1_loss_instance_mil: 0.0705, stage1_bag_acc: 98.4518, stage1_neg_loss: 0.0395, stage1_mean_ious: 0.5558, stage1_s: 0.0000, stage1_m: 0.0535, stage1_l: 0.2291, stage1_h: 0.5822, loss: 0.1329, grad_norm: 6.0593
2024-10-16 15:28:44,766 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:56, time: 1.764, data_time: 0.029, memory: 18840, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.4463, stage0_mean_ious: 0.5741, stage0_s: 0.0000, stage0_m: 0.0933, stage0_l: 0.3147, stage0_h: 0.6102, stage1_loss_instance_mil: 0.0768, stage1_bag_acc: 99.3546, stage1_neg_loss: 0.0382, stage1_mean_ious: 0.5460, stage1_s: 0.0000, stage1_m: 0.1019, stage1_l: 0.3329, stage1_h: 0.5742, loss: 0.1259, grad_norm: 6.2537
2024-10-16 15:29:37,839 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 15:31:10,507 - mmdet - INFO - Evaluating bbox...
2024-10-16 15:31:11,337 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2273
2024-10-16 15:31:11,337 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5046
2024-10-16 15:31:11,338 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3772
2024-10-16 15:31:11,338 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2417
2024-10-16 15:31:11,338 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1804
2024-10-16 15:31:11,338 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1134
2024-10-16 15:31:11,338 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0323
2024-10-16 15:31:11,338 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2096
2024-10-16 15:31:11,338 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2106
2024-10-16 15:31:11,338 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3406
2024-10-16 15:31:11,338 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3315
2024-10-16 15:31:11,338 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6313
2024-10-16 15:31:11,338 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3315
2024-10-16 15:31:11,339 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3315
2024-10-16 15:31:11,339 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2701
2024-10-16 15:31:11,339 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2816
2024-10-16 15:31:11,339 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4397
2024-10-16 15:31:11,354 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 15:31:11,354 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 180, bbox_mAP: 0.2270, bbox_mAP_50: 0.5050, bbox_mAP_75: 0.3770, bbox_mAP_s: 0.2420, bbox_mAP_m: 0.1800, bbox_mAP_l: 0.1130, bbox_mAP_copypaste: 0.227 0.505 0.377 0.242 0.180 0.113
2024-10-16 15:32:42,703 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:28, time: 1.827, data_time: 0.073, memory: 18840, stage0_loss_instance_mil: 0.0057, stage0_bag_acc: 99.7005, stage0_mean_ious: 0.5946, stage0_s: 0.0084, stage0_m: 0.0870, stage0_l: 0.2409, stage0_h: 0.6406, stage1_loss_instance_mil: 0.0577, stage1_bag_acc: 99.7914, stage1_neg_loss: 0.0301, stage1_mean_ious: 0.5650, stage1_s: 0.0105, stage1_m: 0.0877, stage1_l: 0.2473, stage1_h: 0.6050, loss: 0.0935, grad_norm: 4.2538
2024-10-16 15:34:10,384 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:25, time: 1.754, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0083, stage0_bag_acc: 99.8114, stage0_mean_ious: 0.5860, stage0_s: 0.0000, stage0_m: 0.0416, stage0_l: 0.3085, stage0_h: 0.6239, stage1_loss_instance_mil: 0.0472, stage1_bag_acc: 99.7314, stage1_neg_loss: 0.0265, stage1_mean_ious: 0.5500, stage1_s: 0.0000, stage1_m: 0.0432, stage1_l: 0.3127, stage1_h: 0.5805, loss: 0.0820, grad_norm: 3.5319
2024-10-16 15:35:36,990 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:23:19, time: 1.732, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0064, stage0_bag_acc: 99.7897, stage0_mean_ious: 0.5803, stage0_s: 0.0000, stage0_m: 0.0255, stage0_l: 0.2639, stage0_h: 0.6172, stage1_loss_instance_mil: 0.0627, stage1_bag_acc: 99.5669, stage1_neg_loss: 0.0295, stage1_mean_ious: 0.5436, stage1_s: 0.0000, stage1_m: 0.0282, stage1_l: 0.2572, stage1_h: 0.5752, loss: 0.0986, grad_norm: 4.6853
2024-10-16 15:36:29,235 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 15:38:01,500 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:59, time: 1.801, data_time: 0.073, memory: 18840, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.5856, stage0_s: 0.0000, stage0_m: 0.0828, stage0_l: 0.2710, stage0_h: 0.6198, stage1_loss_instance_mil: 0.0448, stage1_bag_acc: 99.8048, stage1_neg_loss: 0.0235, stage1_mean_ious: 0.5532, stage1_s: 0.0000, stage1_m: 0.0839, stage1_l: 0.2803, stage1_h: 0.5795, loss: 0.0744, grad_norm: 3.1739
2024-10-16 15:39:29,076 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:53, time: 1.752, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0016, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.6050, stage0_s: 0.0000, stage0_m: 0.0553, stage0_l: 0.2668, stage0_h: 0.6461, stage1_loss_instance_mil: 0.0397, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0242, stage1_mean_ious: 0.5690, stage1_s: 0.0000, stage1_m: 0.0643, stage1_l: 0.2696, stage1_h: 0.6030, loss: 0.0655, grad_norm: 3.1162
2024-10-16 15:40:55,868 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:45, time: 1.736, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0034, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.5803, stage0_s: 0.0000, stage0_m: 0.0977, stage0_l: 0.2560, stage0_h: 0.6124, stage1_loss_instance_mil: 0.0649, stage1_bag_acc: 99.8824, stage1_neg_loss: 0.0356, stage1_mean_ious: 0.5504, stage1_s: 0.0000, stage1_m: 0.0977, stage1_l: 0.2569, stage1_h: 0.5790, loss: 0.1039, grad_norm: 4.9377
2024-10-16 15:41:49,714 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 15:43:22,254 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:32, time: 1.807, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0062, stage0_bag_acc: 99.9130, stage0_mean_ious: 0.5838, stage0_s: 0.0000, stage0_m: 0.0818, stage0_l: 0.2558, stage0_h: 0.6182, stage1_loss_instance_mil: 0.0407, stage1_bag_acc: 99.7337, stage1_neg_loss: 0.0235, stage1_mean_ious: 0.5487, stage1_s: 0.0000, stage1_m: 0.0833, stage1_l: 0.2601, stage1_h: 0.5770, loss: 0.0704, grad_norm: 3.3283
2024-10-16 15:44:50,926 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:23, time: 1.773, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 99.7895, stage0_mean_ious: 0.5903, stage0_s: 0.0000, stage0_m: 0.0595, stage0_l: 0.2648, stage0_h: 0.6283, stage1_loss_instance_mil: 0.0413, stage1_bag_acc: 99.7895, stage1_neg_loss: 0.0222, stage1_mean_ious: 0.5639, stage1_s: 0.0000, stage1_m: 0.0652, stage1_l: 0.2660, stage1_h: 0.5981, loss: 0.0663, grad_norm: 3.1957
2024-10-16 15:46:16,735 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:13, time: 1.716, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0016, stage0_bag_acc: 99.9130, stage0_mean_ious: 0.5687, stage0_s: 0.0000, stage0_m: 0.0652, stage0_l: 0.2606, stage0_h: 0.6001, stage1_loss_instance_mil: 0.0422, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0213, stage1_mean_ious: 0.5399, stage1_s: 0.0000, stage1_m: 0.0722, stage1_l: 0.2572, stage1_h: 0.5670, loss: 0.0650, grad_norm: 3.2282
2024-10-16 15:47:10,603 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 15:48:43,803 - mmdet - INFO - Evaluating bbox...
2024-10-16 15:48:44,636 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2273
2024-10-16 15:48:44,636 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5009
2024-10-16 15:48:44,636 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3776
2024-10-16 15:48:44,636 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2477
2024-10-16 15:48:44,636 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1803
2024-10-16 15:48:44,636 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1088
2024-10-16 15:48:44,636 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0295
2024-10-16 15:48:44,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2290
2024-10-16 15:48:44,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2287
2024-10-16 15:48:44,637 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3155
2024-10-16 15:48:44,637 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3345
2024-10-16 15:48:44,637 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6312
2024-10-16 15:48:44,637 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3345
2024-10-16 15:48:44,637 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3345
2024-10-16 15:48:44,637 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2690
2024-10-16 15:48:44,637 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3000
2024-10-16 15:48:44,637 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4138
2024-10-16 15:48:44,651 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 15:48:44,651 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 180, bbox_mAP: 0.2270, bbox_mAP_50: 0.5010, bbox_mAP_75: 0.3780, bbox_mAP_s: 0.2480, bbox_mAP_m: 0.1800, bbox_mAP_l: 0.1090, bbox_mAP_copypaste: 0.227 0.501 0.378 0.248 0.180 0.109
2024-10-16 15:50:14,973 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:12:04, time: 1.806, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0009, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5934, stage0_s: 0.0000, stage0_m: 0.0892, stage0_l: 0.3083, stage0_h: 0.6332, stage1_loss_instance_mil: 0.0370, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0233, stage1_mean_ious: 0.5613, stage1_s: 0.0000, stage1_m: 0.0995, stage1_l: 0.3114, stage1_h: 0.5949, loss: 0.0612, grad_norm: 3.2634
2024-10-16 15:51:43,192 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:54, time: 1.764, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.5838, stage0_s: 0.0000, stage0_m: 0.0631, stage0_l: 0.2485, stage0_h: 0.6228, stage1_loss_instance_mil: 0.0362, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0188, stage1_mean_ious: 0.5518, stage1_s: 0.0000, stage1_m: 0.0719, stage1_l: 0.2463, stage1_h: 0.5857, loss: 0.0612, grad_norm: 2.7399
2024-10-16 15:53:09,320 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:42, time: 1.723, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0009, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5698, stage0_s: 0.0084, stage0_m: 0.0644, stage0_l: 0.2432, stage0_h: 0.6157, stage1_loss_instance_mil: 0.0417, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0272, stage1_mean_ious: 0.5403, stage1_s: 0.0098, stage1_m: 0.0722, stage1_l: 0.2414, stage1_h: 0.5796, loss: 0.0698, grad_norm: 3.6299
2024-10-16 15:54:00,865 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 15:55:32,965 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:38, time: 1.799, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.7639, stage0_mean_ious: 0.6004, stage0_s: 0.0000, stage0_m: 0.1095, stage0_l: 0.3073, stage0_h: 0.6376, stage1_loss_instance_mil: 0.0385, stage1_bag_acc: 99.7639, stage1_neg_loss: 0.0263, stage1_mean_ious: 0.5720, stage1_s: 0.0000, stage1_m: 0.1201, stage1_l: 0.3218, stage1_h: 0.6035, loss: 0.0709, grad_norm: 3.3413
2024-10-16 15:56:59,093 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:26, time: 1.723, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0010, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5776, stage0_s: 0.0000, stage0_m: 0.0817, stage0_l: 0.2870, stage0_h: 0.6160, stage1_loss_instance_mil: 0.0343, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0210, stage1_mean_ious: 0.5468, stage1_s: 0.0000, stage1_m: 0.0829, stage1_l: 0.2817, stage1_h: 0.5800, loss: 0.0564, grad_norm: 2.6963
2024-10-16 15:58:27,430 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:13, time: 1.767, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.0015, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.5743, stage0_s: 0.0000, stage0_m: 0.0478, stage0_l: 0.2911, stage0_h: 0.6142, stage1_loss_instance_mil: 0.0290, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0165, stage1_mean_ious: 0.5429, stage1_s: 0.0000, stage1_m: 0.0566, stage1_l: 0.2966, stage1_h: 0.5749, loss: 0.0470, grad_norm: 2.5802
2024-10-16 15:59:20,774 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 16:00:53,042 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:12, time: 1.802, data_time: 0.073, memory: 18840, stage0_loss_instance_mil: 0.0013, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.5893, stage0_s: 0.0000, stage0_m: 0.0612, stage0_l: 0.2966, stage0_h: 0.6271, stage1_loss_instance_mil: 0.0386, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0187, stage1_mean_ious: 0.5545, stage1_s: 0.0000, stage1_m: 0.0664, stage1_l: 0.3073, stage1_h: 0.5850, loss: 0.0586, grad_norm: 2.8575
2024-10-16 16:02:21,428 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:58, time: 1.768, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0048, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.5930, stage0_s: 0.0000, stage0_m: 0.0558, stage0_l: 0.2923, stage0_h: 0.6310, stage1_loss_instance_mil: 0.0337, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0237, stage1_mean_ious: 0.5667, stage1_s: 0.0000, stage1_m: 0.0628, stage1_l: 0.2974, stage1_h: 0.5990, loss: 0.0622, grad_norm: 3.3719
2024-10-16 16:03:50,043 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.772, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0015, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.5779, stage0_s: 0.0000, stage0_m: 0.0614, stage0_l: 0.3030, stage0_h: 0.6129, stage1_loss_instance_mil: 0.0330, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0147, stage1_mean_ious: 0.5503, stage1_s: 0.0000, stage1_m: 0.0698, stage1_l: 0.3082, stage1_h: 0.5790, loss: 0.0492, grad_norm: 2.4442
2024-10-16 16:04:42,595 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 16:06:15,468 - mmdet - INFO - Evaluating bbox...
2024-10-16 16:06:16,304 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2344
2024-10-16 16:06:16,304 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5092
2024-10-16 16:06:16,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3909
2024-10-16 16:06:16,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2569
2024-10-16 16:06:16,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1888
2024-10-16 16:06:16,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1178
2024-10-16 16:06:16,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0316
2024-10-16 16:06:16,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2310
2024-10-16 16:06:16,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2323
2024-10-16 16:06:16,305 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3264
2024-10-16 16:06:16,305 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3415
2024-10-16 16:06:16,305 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6386
2024-10-16 16:06:16,306 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3415
2024-10-16 16:06:16,306 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3415
2024-10-16 16:06:16,306 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2708
2024-10-16 16:06:16,306 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3062
2024-10-16 16:06:16,306 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4246
2024-10-16 16:06:16,320 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 16:06:16,320 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 180, bbox_mAP: 0.2340, bbox_mAP_50: 0.5090, bbox_mAP_75: 0.3910, bbox_mAP_s: 0.2570, bbox_mAP_m: 0.1890, bbox_mAP_l: 0.1180, bbox_mAP_copypaste: 0.234 0.509 0.391 0.257 0.189 0.118
2024-10-16 16:07:47,869 - mmdet - INFO - Evaluating bbox...
2024-10-16 16:07:48,689 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2344
2024-10-16 16:07:48,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5092
2024-10-16 16:07:48,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3909
2024-10-16 16:07:48,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2569
2024-10-16 16:07:48,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1888
2024-10-16 16:07:48,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1178
2024-10-16 16:07:48,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0316
2024-10-16 16:07:48,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2310
2024-10-16 16:07:48,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2323
2024-10-16 16:07:48,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3264
2024-10-16 16:07:48,690 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3415
2024-10-16 16:07:48,691 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.6386
2024-10-16 16:07:48,691 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3415
2024-10-16 16:07:48,691 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3415
2024-10-16 16:07:48,691 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2708
2024-10-16 16:07:48,691 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3062
2024-10-16 16:07:48,691 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4246
2024-10-16 16:07:49,993 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+e282583
------------------------------------------------------------

2024-10-16 16:07:50,848 - mmdet - INFO - Distributed training: False
2024-10-16 16:07:51,689 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [2]

2024-10-16 16:07:52,677 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 16:07:52,678 - mmdet - INFO - Use load_from_local loader
2024-10-16 16:07:52,941 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 16:07:52,955 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 16:07:52,955 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 16:09:22,303 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:02:50, time: 1.787, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.7139, stage0_bag_acc: 16.2953, stage0_mean_ious: 0.2275, stage0_s: 0.0000, stage0_m: 0.0449, stage0_l: 0.2224, stage0_h: 0.2229, stage1_loss_instance_mil: 0.1674, stage1_bag_acc: 17.1608, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.2109, stage1_s: 0.0000, stage1_m: 0.0378, stage1_l: 0.2043, stage1_h: 0.2074, loss: 0.8838, grad_norm: 3.4464
2024-10-16 16:10:50,208 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 1:00:51, time: 1.758, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.6111, stage0_bag_acc: 61.4694, stage0_mean_ious: 0.2954, stage0_s: 0.0000, stage0_m: 0.0506, stage0_l: 0.2383, stage0_h: 0.2960, stage1_loss_instance_mil: 0.2270, stage1_bag_acc: 22.8471, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.2766, stage1_s: 0.0000, stage1_m: 0.0499, stage1_l: 0.2334, stage1_h: 0.2761, loss: 0.8428, grad_norm: 3.7874
2024-10-16 16:12:20,312 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:59:42, time: 1.802, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.2528, stage0_bag_acc: 91.0066, stage0_mean_ious: 0.4126, stage0_s: 0.0000, stage0_m: 0.0553, stage0_l: 0.2903, stage0_h: 0.4263, stage1_loss_instance_mil: 0.3481, stage1_bag_acc: 82.0798, stage1_neg_loss: 0.0647, stage1_mean_ious: 0.3833, stage1_s: 0.0000, stage1_m: 0.0521, stage1_l: 0.2947, stage1_h: 0.3942, loss: 0.6656, grad_norm: 11.3769
2024-10-16 16:13:12,987 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 16:14:47,845 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:50:21, time: 1.853, data_time: 0.077, memory: 18840, stage0_loss_instance_mil: 0.0787, stage0_bag_acc: 96.3158, stage0_mean_ious: 0.4254, stage0_s: 0.0086, stage0_m: 0.0611, stage0_l: 0.2338, stage0_h: 0.4487, stage1_loss_instance_mil: 0.3259, stage1_bag_acc: 97.2616, stage1_neg_loss: 0.0857, stage1_mean_ious: 0.3908, stage1_s: 0.0106, stage1_m: 0.0523, stage1_l: 0.2185, stage1_h: 0.4110, loss: 0.4902, grad_norm: 12.5820
2024-10-16 16:16:14,738 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:50:00, time: 1.738, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0667, stage0_bag_acc: 96.5871, stage0_mean_ious: 0.4113, stage0_s: 0.0000, stage0_m: 0.0463, stage0_l: 0.2019, stage0_h: 0.4317, stage1_loss_instance_mil: 0.2920, stage1_bag_acc: 96.9474, stage1_neg_loss: 0.0836, stage1_mean_ious: 0.3781, stage1_s: 0.0000, stage1_m: 0.0300, stage1_l: 0.1991, stage1_h: 0.3965, loss: 0.4422, grad_norm: 15.7796
2024-10-16 16:17:40,234 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:49:12, time: 1.710, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0455, stage0_bag_acc: 97.7191, stage0_mean_ious: 0.4319, stage0_s: 0.0000, stage0_m: 0.0497, stage0_l: 0.2402, stage0_h: 0.4503, stage1_loss_instance_mil: 0.2912, stage1_bag_acc: 97.4955, stage1_neg_loss: 0.0817, stage1_mean_ious: 0.4011, stage1_s: 0.0000, stage1_m: 0.0411, stage1_l: 0.2286, stage1_h: 0.4174, loss: 0.4184, grad_norm: 14.5471
2024-10-16 16:18:32,372 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 16:20:04,157 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:44:14, time: 1.792, data_time: 0.079, memory: 18840, stage0_loss_instance_mil: 0.0478, stage0_bag_acc: 97.0443, stage0_mean_ious: 0.3895, stage0_s: 0.0087, stage0_m: 0.0453, stage0_l: 0.1967, stage0_h: 0.4070, stage1_loss_instance_mil: 0.2733, stage1_bag_acc: 96.6892, stage1_neg_loss: 0.0732, stage1_mean_ious: 0.3631, stage1_s: 0.0101, stage1_m: 0.0318, stage1_l: 0.1822, stage1_h: 0.3804, loss: 0.3944, grad_norm: 14.6281
2024-10-16 16:21:28,850 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:43:31, time: 1.694, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0483, stage0_bag_acc: 96.6802, stage0_mean_ious: 0.4177, stage0_s: 0.0000, stage0_m: 0.0669, stage0_l: 0.1882, stage0_h: 0.4536, stage1_loss_instance_mil: 0.2541, stage1_bag_acc: 97.7301, stage1_neg_loss: 0.0769, stage1_mean_ious: 0.3882, stage1_s: 0.0000, stage1_m: 0.0475, stage1_l: 0.1772, stage1_h: 0.4243, loss: 0.3793, grad_norm: 16.5858
2024-10-16 16:22:54,841 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:42:44, time: 1.720, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0357, stage0_bag_acc: 98.0418, stage0_mean_ious: 0.4047, stage0_s: 0.0000, stage0_m: 0.0334, stage0_l: 0.2058, stage0_h: 0.4306, stage1_loss_instance_mil: 0.2534, stage1_bag_acc: 98.3738, stage1_neg_loss: 0.0785, stage1_mean_ious: 0.3783, stage1_s: 0.0000, stage1_m: 0.0320, stage1_l: 0.1985, stage1_h: 0.4023, loss: 0.3677, grad_norm: 14.3615
2024-10-16 16:23:46,295 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 16:25:17,762 - mmdet - INFO - Evaluating bbox...
2024-10-16 16:25:18,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0879
2024-10-16 16:25:18,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2459
2024-10-16 16:25:18,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1657
2024-10-16 16:25:18,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0765
2024-10-16 16:25:18,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0421
2024-10-16 16:25:18,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0149
2024-10-16 16:25:18,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 16:25:18,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0979
2024-10-16 16:25:18,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0904
2024-10-16 16:25:18,565 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0915
2024-10-16 16:25:18,565 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1351
2024-10-16 16:25:18,565 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3143
2024-10-16 16:25:18,565 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1351
2024-10-16 16:25:18,565 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1351
2024-10-16 16:25:18,565 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1315
2024-10-16 16:25:18,565 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1501
2024-10-16 16:25:18,565 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0969
2024-10-16 16:25:18,579 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 16:25:18,579 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 180, bbox_mAP: 0.0880, bbox_mAP_50: 0.2460, bbox_mAP_75: 0.1660, bbox_mAP_s: 0.0770, bbox_mAP_m: 0.0420, bbox_mAP_l: 0.0150, bbox_mAP_copypaste: 0.088 0.246 0.166 0.077 0.042 0.015
2024-10-16 16:26:46,350 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:39:02, time: 1.755, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0451, stage0_bag_acc: 97.9548, stage0_mean_ious: 0.4181, stage0_s: 0.0000, stage0_m: 0.0566, stage0_l: 0.2596, stage0_h: 0.4461, stage1_loss_instance_mil: 0.2226, stage1_bag_acc: 98.1755, stage1_neg_loss: 0.0751, stage1_mean_ious: 0.3896, stage1_s: 0.0000, stage1_m: 0.0448, stage1_l: 0.2353, stage1_h: 0.4165, loss: 0.3428, grad_norm: 15.1882
2024-10-16 16:28:10,634 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:38:11, time: 1.686, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0277, stage0_bag_acc: 98.6572, stage0_mean_ious: 0.3875, stage0_s: 0.0085, stage0_m: 0.0308, stage0_l: 0.1848, stage0_h: 0.4124, stage1_loss_instance_mil: 0.2248, stage1_bag_acc: 98.5462, stage1_neg_loss: 0.0635, stage1_mean_ious: 0.3662, stage1_s: 0.0092, stage1_m: 0.0169, stage1_l: 0.1704, stage1_h: 0.3906, loss: 0.3161, grad_norm: 11.3791
2024-10-16 16:29:36,707 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:18, time: 1.721, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0204, stage0_bag_acc: 98.5830, stage0_mean_ious: 0.3479, stage0_s: 0.0000, stage0_m: 0.0592, stage0_l: 0.1951, stage0_h: 0.3630, stage1_loss_instance_mil: 0.2445, stage1_bag_acc: 99.0530, stage1_neg_loss: 0.0761, stage1_mean_ious: 0.3206, stage1_s: 0.0000, stage1_m: 0.0453, stage1_l: 0.1779, stage1_h: 0.3361, loss: 0.3411, grad_norm: 13.9847
2024-10-16 16:30:27,211 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 16:31:58,289 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:17, time: 1.778, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0164, stage0_bag_acc: 98.9020, stage0_mean_ious: 0.3791, stage0_s: 0.0000, stage0_m: 0.0402, stage0_l: 0.1724, stage0_h: 0.4035, stage1_loss_instance_mil: 0.1965, stage1_bag_acc: 99.4235, stage1_neg_loss: 0.0623, stage1_mean_ious: 0.3506, stage1_s: 0.0000, stage1_m: 0.0271, stage1_l: 0.1568, stage1_h: 0.3741, loss: 0.2752, grad_norm: 10.2731
2024-10-16 16:33:23,768 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:22, time: 1.710, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0101, stage0_bag_acc: 99.4347, stage0_mean_ious: 0.3175, stage0_s: 0.0000, stage0_m: 0.0394, stage0_l: 0.2241, stage0_h: 0.3300, stage1_loss_instance_mil: 0.1784, stage1_bag_acc: 99.6256, stage1_neg_loss: 0.0573, stage1_mean_ious: 0.2921, stage1_s: 0.0000, stage1_m: 0.0305, stage1_l: 0.2107, stage1_h: 0.3039, loss: 0.2458, grad_norm: 9.1682
2024-10-16 16:34:48,575 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:22, time: 1.696, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.0435, stage0_bag_acc: 97.5907, stage0_mean_ious: 0.3048, stage0_s: 0.0000, stage0_m: 0.0275, stage0_l: 0.1621, stage0_h: 0.3203, stage1_loss_instance_mil: 0.2213, stage1_bag_acc: 98.1314, stage1_neg_loss: 0.0739, stage1_mean_ious: 0.2824, stage1_s: 0.0000, stage1_m: 0.0175, stage1_l: 0.1498, stage1_h: 0.2968, loss: 0.3387, grad_norm: 17.1956
2024-10-16 16:35:40,386 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 16:37:10,191 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:40, time: 1.752, data_time: 0.077, memory: 18840, stage0_loss_instance_mil: 0.0300, stage0_bag_acc: 98.2694, stage0_mean_ious: 0.3149, stage0_s: 0.0081, stage0_m: 0.0285, stage0_l: 0.1586, stage0_h: 0.3257, stage1_loss_instance_mil: 0.1685, stage1_bag_acc: 99.0121, stage1_neg_loss: 0.0595, stage1_mean_ious: 0.2998, stage1_s: 0.0100, stage1_m: 0.0209, stage1_l: 0.1418, stage1_h: 0.3123, loss: 0.2580, grad_norm: 9.1089
2024-10-16 16:38:36,912 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 16:38:36,912 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:41, time: 1.734, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0158, stage0_bag_acc: 99.0224, stage0_mean_ious: 0.3127, stage0_s: 0.0000, stage0_m: 0.0351, stage0_l: 0.1868, stage0_h: 0.3263, stage1_loss_instance_mil: 0.1573, stage1_bag_acc: 99.0992, stage1_neg_loss: 0.0596, stage1_mean_ious: 0.2939, stage1_s: 0.0000, stage1_m: 0.0253, stage1_l: 0.1842, stage1_h: 0.3068, loss: 0.2328, grad_norm: 8.1684
2024-10-16 16:40:04,817 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:42, time: 1.758, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.0112, stage0_bag_acc: 99.3472, stage0_mean_ious: 0.3275, stage0_s: 0.0000, stage0_m: 0.0350, stage0_l: 0.2203, stage0_h: 0.3430, stage1_loss_instance_mil: 0.1372, stage1_bag_acc: 99.2966, stage1_neg_loss: 0.0558, stage1_mean_ious: 0.3089, stage1_s: 0.0000, stage1_m: 0.0246, stage1_l: 0.2128, stage1_h: 0.3251, loss: 0.2043, grad_norm: 9.5349
2024-10-16 16:40:56,913 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 16:42:29,743 - mmdet - INFO - Evaluating bbox...
2024-10-16 16:42:30,535 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1020
2024-10-16 16:42:30,535 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2549
2024-10-16 16:42:30,536 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1822
2024-10-16 16:42:30,536 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1096
2024-10-16 16:42:30,536 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0712
2024-10-16 16:42:30,536 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0273
2024-10-16 16:42:30,536 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0015
2024-10-16 16:42:30,536 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1074
2024-10-16 16:42:30,536 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1012
2024-10-16 16:42:30,536 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1271
2024-10-16 16:42:30,536 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1404
2024-10-16 16:42:30,536 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2917
2024-10-16 16:42:30,537 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1404
2024-10-16 16:42:30,537 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1404
2024-10-16 16:42:30,537 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1343
2024-10-16 16:42:30,537 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1453
2024-10-16 16:42:30,537 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1390
2024-10-16 16:42:30,550 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 16:42:30,551 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 180, bbox_mAP: 0.1020, bbox_mAP_50: 0.2550, bbox_mAP_75: 0.1820, bbox_mAP_s: 0.1100, bbox_mAP_m: 0.0710, bbox_mAP_l: 0.0270, bbox_mAP_copypaste: 0.102 0.255 0.182 0.110 0.071 0.027
2024-10-16 16:43:58,984 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:25:13, time: 1.768, data_time: 0.072, memory: 18840, stage0_loss_instance_mil: 0.0077, stage0_bag_acc: 99.7614, stage0_mean_ious: 0.3415, stage0_s: 0.0000, stage0_m: 0.0465, stage0_l: 0.2722, stage0_h: 0.3487, stage1_loss_instance_mil: 0.1248, stage1_bag_acc: 99.8667, stage1_neg_loss: 0.0499, stage1_mean_ious: 0.3194, stage1_s: 0.0000, stage1_m: 0.0360, stage1_l: 0.2663, stage1_h: 0.3253, loss: 0.1824, grad_norm: 8.1128
2024-10-16 16:45:26,641 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:24:11, time: 1.753, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0152, stage0_bag_acc: 99.1892, stage0_mean_ious: 0.2914, stage0_s: 0.0000, stage0_m: 0.0364, stage0_l: 0.2263, stage0_h: 0.2998, stage1_loss_instance_mil: 0.1299, stage1_bag_acc: 99.3613, stage1_neg_loss: 0.0549, stage1_mean_ious: 0.2764, stage1_s: 0.0000, stage1_m: 0.0239, stage1_l: 0.2156, stage1_h: 0.2855, loss: 0.2000, grad_norm: 8.3056
2024-10-16 16:46:54,602 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:23:08, time: 1.759, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0149, stage0_bag_acc: 99.4747, stage0_mean_ious: 0.3331, stage0_s: 0.0000, stage0_m: 0.0567, stage0_l: 0.1979, stage0_h: 0.3484, stage1_loss_instance_mil: 0.1235, stage1_bag_acc: 99.0292, stage1_neg_loss: 0.0524, stage1_mean_ious: 0.3129, stage1_s: 0.0000, stage1_m: 0.0418, stage1_l: 0.1891, stage1_h: 0.3282, loss: 0.1908, grad_norm: 6.8580
2024-10-16 16:47:48,645 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 16:49:20,422 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:49, time: 1.790, data_time: 0.073, memory: 18840, stage0_loss_instance_mil: 0.0098, stage0_bag_acc: 99.6232, stage0_mean_ious: 0.3407, stage0_s: 0.0000, stage0_m: 0.0096, stage0_l: 0.1810, stage0_h: 0.3571, stage1_loss_instance_mil: 0.1070, stage1_bag_acc: 99.3252, stage1_neg_loss: 0.0495, stage1_mean_ious: 0.3190, stage1_s: 0.0000, stage1_m: 0.0070, stage1_l: 0.1720, stage1_h: 0.3348, loss: 0.1662, grad_norm: 7.9182
2024-10-16 16:50:49,134 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:44, time: 1.774, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0100, stage0_bag_acc: 99.5317, stage0_mean_ious: 0.3161, stage0_s: 0.0000, stage0_m: 0.0413, stage0_l: 0.1531, stage0_h: 0.3370, stage1_loss_instance_mil: 0.1128, stage1_bag_acc: 99.3901, stage1_neg_loss: 0.0487, stage1_mean_ious: 0.3003, stage1_s: 0.0000, stage1_m: 0.0315, stage1_l: 0.1449, stage1_h: 0.3202, loss: 0.1716, grad_norm: 6.4421
2024-10-16 16:52:16,832 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:38, time: 1.754, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0267, stage0_bag_acc: 98.5041, stage0_mean_ious: 0.2896, stage0_s: 0.0000, stage0_m: 0.0621, stage0_l: 0.1669, stage0_h: 0.3027, stage1_loss_instance_mil: 0.1195, stage1_bag_acc: 98.7584, stage1_neg_loss: 0.0544, stage1_mean_ious: 0.2752, stage1_s: 0.0000, stage1_m: 0.0445, stage1_l: 0.1553, stage1_h: 0.2900, loss: 0.2006, grad_norm: 9.1769
2024-10-16 16:53:10,142 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 16:54:42,805 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:25, time: 1.809, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0095, stage0_bag_acc: 99.3216, stage0_mean_ious: 0.3151, stage0_s: 0.0000, stage0_m: 0.0518, stage0_l: 0.1762, stage0_h: 0.3310, stage1_loss_instance_mil: 0.1012, stage1_bag_acc: 99.6032, stage1_neg_loss: 0.0416, stage1_mean_ious: 0.3037, stage1_s: 0.0000, stage1_m: 0.0357, stage1_l: 0.1725, stage1_h: 0.3193, loss: 0.1523, grad_norm: 5.5167
2024-10-16 16:56:11,048 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:15:18, time: 1.765, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0039, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.2781, stage0_s: 0.0000, stage0_m: 0.0477, stage0_l: 0.1482, stage0_h: 0.2893, stage1_loss_instance_mil: 0.1011, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0483, stage1_mean_ious: 0.2702, stage1_s: 0.0000, stage1_m: 0.0359, stage1_l: 0.1493, stage1_h: 0.2813, loss: 0.1532, grad_norm: 5.4202
2024-10-16 16:57:38,487 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:14:09, time: 1.749, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0064, stage0_bag_acc: 99.8078, stage0_mean_ious: 0.2768, stage0_s: 0.0000, stage0_m: 0.0498, stage0_l: 0.1588, stage0_h: 0.2983, stage1_loss_instance_mil: 0.0965, stage1_bag_acc: 99.8078, stage1_neg_loss: 0.0431, stage1_mean_ious: 0.2658, stage1_s: 0.0000, stage1_m: 0.0414, stage1_l: 0.1538, stage1_h: 0.2878, loss: 0.1459, grad_norm: 4.8996
2024-10-16 16:58:32,193 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 17:00:05,252 - mmdet - INFO - Evaluating bbox...
2024-10-16 17:00:06,089 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0901
2024-10-16 17:00:06,089 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2259
2024-10-16 17:00:06,090 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1657
2024-10-16 17:00:06,090 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0930
2024-10-16 17:00:06,090 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0509
2024-10-16 17:00:06,090 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0218
2024-10-16 17:00:06,090 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0034
2024-10-16 17:00:06,090 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0864
2024-10-16 17:00:06,090 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0912
2024-10-16 17:00:06,090 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1026
2024-10-16 17:00:06,090 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1241
2024-10-16 17:00:06,090 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2634
2024-10-16 17:00:06,090 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1241
2024-10-16 17:00:06,091 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1241
2024-10-16 17:00:06,091 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1310
2024-10-16 17:00:06,091 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1295
2024-10-16 17:00:06,091 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1137
2024-10-16 17:00:06,107 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 17:00:06,107 - mmdet - INFO - Epoch(val) [9][180]	eval_iter_num: 180, bbox_mAP: 0.0900, bbox_mAP_50: 0.2260, bbox_mAP_75: 0.1660, bbox_mAP_s: 0.0930, bbox_mAP_m: 0.0510, bbox_mAP_l: 0.0220, bbox_mAP_copypaste: 0.090 0.226 0.166 0.093 0.051 0.022
2024-10-16 17:01:37,148 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:12:01, time: 1.820, data_time: 0.079, memory: 18840, stage0_loss_instance_mil: 0.0047, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.2860, stage0_s: 0.0000, stage0_m: 0.0464, stage0_l: 0.1896, stage0_h: 0.3012, stage1_loss_instance_mil: 0.0910, stage1_bag_acc: 99.5517, stage1_neg_loss: 0.0415, stage1_mean_ious: 0.2792, stage1_s: 0.0000, stage1_m: 0.0395, stage1_l: 0.1935, stage1_h: 0.2946, loss: 0.1372, grad_norm: 5.0634
2024-10-16 17:03:04,623 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:51, time: 1.749, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0054, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.2892, stage0_s: 0.0000, stage0_m: 0.0234, stage0_l: 0.2005, stage0_h: 0.3047, stage1_loss_instance_mil: 0.0895, stage1_bag_acc: 99.8947, stage1_neg_loss: 0.0440, stage1_mean_ious: 0.2776, stage1_s: 0.0000, stage1_m: 0.0186, stage1_l: 0.1913, stage1_h: 0.2927, loss: 0.1389, grad_norm: 4.8034
2024-10-16 17:04:34,444 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:40, time: 1.796, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.0049, stage0_bag_acc: 99.7186, stage0_mean_ious: 0.2820, stage0_s: 0.0000, stage0_m: 0.0256, stage0_l: 0.1786, stage0_h: 0.2940, stage1_loss_instance_mil: 0.0968, stage1_bag_acc: 99.7139, stage1_neg_loss: 0.0471, stage1_mean_ious: 0.2711, stage1_s: 0.0000, stage1_m: 0.0192, stage1_l: 0.1736, stage1_h: 0.2826, loss: 0.1488, grad_norm: 5.4506
2024-10-16 17:05:27,502 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 17:06:59,678 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:36, time: 1.800, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.0046, stage0_bag_acc: 99.9167, stage0_mean_ious: 0.3172, stage0_s: 0.0000, stage0_m: 0.0538, stage0_l: 0.1762, stage0_h: 0.3326, stage1_loss_instance_mil: 0.0858, stage1_bag_acc: 99.7833, stage1_neg_loss: 0.0407, stage1_mean_ious: 0.3122, stage1_s: 0.0000, stage1_m: 0.0448, stage1_l: 0.1673, stage1_h: 0.3282, loss: 0.1311, grad_norm: 5.1229
2024-10-16 17:08:27,617 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:25, time: 1.759, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0039, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.2885, stage0_s: 0.0000, stage0_m: 0.0405, stage0_l: 0.1711, stage0_h: 0.3084, stage1_loss_instance_mil: 0.0909, stage1_bag_acc: 99.5747, stage1_neg_loss: 0.0439, stage1_mean_ious: 0.2734, stage1_s: 0.0000, stage1_m: 0.0325, stage1_l: 0.1588, stage1_h: 0.2944, loss: 0.1387, grad_norm: 4.5559
2024-10-16 17:09:56,967 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:12, time: 1.787, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0022, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.2921, stage0_s: 0.0000, stage0_m: 0.0238, stage0_l: 0.1852, stage0_h: 0.2996, stage1_loss_instance_mil: 0.0904, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0411, stage1_mean_ious: 0.2784, stage1_s: 0.0000, stage1_m: 0.0193, stage1_l: 0.1837, stage1_h: 0.2850, loss: 0.1337, grad_norm: 4.3676
2024-10-16 17:10:50,109 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 17:12:20,974 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:11, time: 1.773, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0025, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.2744, stage0_s: 0.0000, stage0_m: 0.0290, stage0_l: 0.1558, stage0_h: 0.2837, stage1_loss_instance_mil: 0.0984, stage1_bag_acc: 99.6100, stage1_neg_loss: 0.0451, stage1_mean_ious: 0.2614, stage1_s: 0.0000, stage1_m: 0.0234, stage1_l: 0.1592, stage1_h: 0.2691, loss: 0.1461, grad_norm: 4.7412
2024-10-16 17:13:50,840 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:58, time: 1.797, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0050, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.3086, stage0_s: 0.0000, stage0_m: 0.0300, stage0_l: 0.1693, stage0_h: 0.3234, stage1_loss_instance_mil: 0.0837, stage1_bag_acc: 99.8214, stage1_neg_loss: 0.0414, stage1_mean_ious: 0.2888, stage1_s: 0.0000, stage1_m: 0.0261, stage1_l: 0.1635, stage1_h: 0.3029, loss: 0.1301, grad_norm: 4.4983
2024-10-16 17:15:20,656 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:44, time: 1.796, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0032, stage0_bag_acc: 99.7662, stage0_mean_ious: 0.3150, stage0_s: 0.0000, stage0_m: 0.0545, stage0_l: 0.2016, stage0_h: 0.3317, stage1_loss_instance_mil: 0.0825, stage1_bag_acc: 99.7914, stage1_neg_loss: 0.0400, stage1_mean_ious: 0.2976, stage1_s: 0.0000, stage1_m: 0.0403, stage1_l: 0.1984, stage1_h: 0.3134, loss: 0.1257, grad_norm: 5.2712
2024-10-16 17:16:13,507 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 17:17:46,830 - mmdet - INFO - Evaluating bbox...
2024-10-16 17:17:47,631 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0969
2024-10-16 17:17:47,631 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2488
2024-10-16 17:17:47,631 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1764
2024-10-16 17:17:47,631 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0964
2024-10-16 17:17:47,631 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0561
2024-10-16 17:17:47,631 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0220
2024-10-16 17:17:47,631 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0027
2024-10-16 17:17:47,631 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0925
2024-10-16 17:17:47,632 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0974
2024-10-16 17:17:47,632 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1098
2024-10-16 17:17:47,632 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1315
2024-10-16 17:17:47,632 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2815
2024-10-16 17:17:47,632 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1315
2024-10-16 17:17:47,632 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1315
2024-10-16 17:17:47,632 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1291
2024-10-16 17:17:47,632 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1373
2024-10-16 17:17:47,632 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1233
2024-10-16 17:17:47,645 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 17:17:47,645 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 180, bbox_mAP: 0.0970, bbox_mAP_50: 0.2490, bbox_mAP_75: 0.1760, bbox_mAP_s: 0.0960, bbox_mAP_m: 0.0560, bbox_mAP_l: 0.0220, bbox_mAP_copypaste: 0.097 0.249 0.176 0.096 0.056 0.022
2024-10-16 17:19:19,430 - mmdet - INFO - Evaluating bbox...
2024-10-16 17:19:20,234 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0969
2024-10-16 17:19:20,234 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2488
2024-10-16 17:19:20,234 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1764
2024-10-16 17:19:20,234 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0964
2024-10-16 17:19:20,234 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0561
2024-10-16 17:19:20,234 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0220
2024-10-16 17:19:20,234 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0027
2024-10-16 17:19:20,234 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0925
2024-10-16 17:19:20,235 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0974
2024-10-16 17:19:20,235 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1098
2024-10-16 17:19:20,235 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1315
2024-10-16 17:19:20,235 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.2815
2024-10-16 17:19:20,235 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1315
2024-10-16 17:19:20,235 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1315
2024-10-16 17:19:20,235 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1291
2024-10-16 17:19:20,235 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1373
2024-10-16 17:19:20,235 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1233
2024-10-16 17:19:21,499 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+e282583
------------------------------------------------------------

2024-10-16 17:19:22,347 - mmdet - INFO - Distributed training: False
2024-10-16 17:19:23,192 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=8,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [2]

2024-10-16 17:19:24,205 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 17:19:24,206 - mmdet - INFO - Use load_from_local loader
2024-10-16 17:19:24,453 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 17:19:24,463 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 17:19:24,464 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 17:20:56,842 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:04:58, time: 1.847, data_time: 0.074, memory: 18840, stage0_loss_instance_mil: 0.7121, stage0_bag_acc: 20.4353, stage0_mean_ious: 0.2894, stage0_s: 0.0000, stage0_m: 0.0453, stage0_l: 0.2074, stage0_h: 0.2891, stage1_loss_instance_mil: 0.1759, stage1_bag_acc: 20.0290, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.2857, stage1_s: 0.0000, stage1_m: 0.0554, stage1_l: 0.2287, stage1_h: 0.2806, loss: 0.8891, grad_norm: 3.2999
2024-10-16 17:22:26,288 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 1:02:25, time: 1.789, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.5712, stage0_bag_acc: 63.5430, stage0_mean_ious: 0.3572, stage0_s: 0.0000, stage0_m: 0.0989, stage0_l: 0.2620, stage0_h: 0.3621, stage1_loss_instance_mil: 0.2497, stage1_bag_acc: 25.2121, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.3542, stage1_s: 0.0000, stage1_m: 0.0991, stage1_l: 0.2678, stage1_h: 0.3562, loss: 0.8264, grad_norm: 3.7019
2024-10-16 17:23:56,152 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 1:00:40, time: 1.797, data_time: 0.027, memory: 18840, stage0_loss_instance_mil: 0.2492, stage0_bag_acc: 89.0353, stage0_mean_ious: 0.3502, stage0_s: 0.0000, stage0_m: 0.0649, stage0_l: 0.2025, stage0_h: 0.3539, stage1_loss_instance_mil: 0.3555, stage1_bag_acc: 76.6520, stage1_neg_loss: 0.0555, stage1_mean_ious: 0.3428, stage1_s: 0.0000, stage1_m: 0.0677, stage1_l: 0.1922, stage1_h: 0.3474, loss: 0.6602, grad_norm: 7.9479
2024-10-16 17:24:49,061 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 17:26:23,223 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:50:51, time: 1.839, data_time: 0.081, memory: 18840, stage0_loss_instance_mil: 0.0773, stage0_bag_acc: 95.0226, stage0_mean_ious: 0.3781, stage0_s: 0.0000, stage0_m: 0.0438, stage0_l: 0.1980, stage0_h: 0.3953, stage1_loss_instance_mil: 0.3359, stage1_bag_acc: 97.1719, stage1_neg_loss: 0.0816, stage1_mean_ious: 0.3609, stage1_s: 0.0000, stage1_m: 0.0469, stage1_l: 0.2051, stage1_h: 0.3742, loss: 0.4948, grad_norm: 12.5316
2024-10-16 17:27:51,678 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:50:35, time: 1.769, data_time: 0.030, memory: 18840, stage0_loss_instance_mil: 0.0582, stage0_bag_acc: 96.9457, stage0_mean_ious: 0.3564, stage0_s: 0.0000, stage0_m: 0.0528, stage0_l: 0.1828, stage0_h: 0.3776, stage1_loss_instance_mil: 0.3067, stage1_bag_acc: 98.1689, stage1_neg_loss: 0.0854, stage1_mean_ious: 0.3421, stage1_s: 0.0000, stage1_m: 0.0466, stage1_l: 0.1784, stage1_h: 0.3622, loss: 0.4503, grad_norm: 13.0145
2024-10-16 17:29:20,472 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:49:59, time: 1.776, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0341, stage0_bag_acc: 98.2664, stage0_mean_ious: 0.3804, stage0_s: 0.0000, stage0_m: 0.0365, stage0_l: 0.1286, stage0_h: 0.4035, stage1_loss_instance_mil: 0.2835, stage1_bag_acc: 99.2872, stage1_neg_loss: 0.0816, stage1_mean_ious: 0.3574, stage1_s: 0.0000, stage1_m: 0.0324, stage1_l: 0.1252, stage1_h: 0.3786, loss: 0.3991, grad_norm: 11.5572
2024-10-16 17:30:11,016 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 17:31:42,311 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:44:49, time: 1.782, data_time: 0.073, memory: 18840, stage0_loss_instance_mil: 0.0354, stage0_bag_acc: 97.5845, stage0_mean_ious: 0.4085, stage0_s: 0.0029, stage0_m: 0.0180, stage0_l: 0.1460, stage0_h: 0.4399, stage1_loss_instance_mil: 0.2591, stage1_bag_acc: 98.7767, stage1_neg_loss: 0.0770, stage1_mean_ious: 0.3730, stage1_s: 0.0036, stage1_m: 0.0176, stage1_l: 0.1469, stage1_h: 0.3999, loss: 0.3715, grad_norm: 14.1504
2024-10-16 17:33:08,599 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:44:07, time: 1.726, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0253, stage0_bag_acc: 99.0131, stage0_mean_ious: 0.3850, stage0_s: 0.0000, stage0_m: 0.0624, stage0_l: 0.1647, stage0_h: 0.4136, stage1_loss_instance_mil: 0.2403, stage1_bag_acc: 98.7928, stage1_neg_loss: 0.0853, stage1_mean_ious: 0.3531, stage1_s: 0.0000, stage1_m: 0.0623, stage1_l: 0.1602, stage1_h: 0.3785, loss: 0.3509, grad_norm: 16.3595
2024-10-16 17:34:34,868 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:43:16, time: 1.725, data_time: 0.023, memory: 18840, stage0_loss_instance_mil: 0.0560, stage0_bag_acc: 96.0020, stage0_mean_ious: 0.3994, stage0_s: 0.0000, stage0_m: 0.0648, stage0_l: 0.1576, stage0_h: 0.4360, stage1_loss_instance_mil: 0.2167, stage1_bag_acc: 97.2347, stage1_neg_loss: 0.0755, stage1_mean_ious: 0.3774, stage1_s: 0.0000, stage1_m: 0.0538, stage1_l: 0.1569, stage1_h: 0.4112, loss: 0.3481, grad_norm: 13.0494
2024-10-16 17:35:27,570 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 17:37:01,627 - mmdet - INFO - Evaluating bbox...
2024-10-16 17:37:02,457 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0766
2024-10-16 17:37:02,457 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2443
2024-10-16 17:37:02,457 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1369
2024-10-16 17:37:02,457 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0605
2024-10-16 17:37:02,457 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0323
2024-10-16 17:37:02,457 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0132
2024-10-16 17:37:02,457 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-16 17:37:02,458 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0146
2024-10-16 17:37:02,458 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0801
2024-10-16 17:37:02,458 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1336
2024-10-16 17:37:02,458 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1596
2024-10-16 17:37:02,458 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3959
2024-10-16 17:37:02,458 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1596
2024-10-16 17:37:02,458 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1596
2024-10-16 17:37:02,458 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0499
2024-10-16 17:37:02,458 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1753
2024-10-16 17:37:02,458 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2094
2024-10-16 17:37:02,473 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 17:37:02,473 - mmdet - INFO - Epoch(val) [3][180]	eval_iter_num: 180, bbox_mAP: 0.0770, bbox_mAP_50: 0.2440, bbox_mAP_75: 0.1370, bbox_mAP_s: 0.0600, bbox_mAP_m: 0.0320, bbox_mAP_l: 0.0130, bbox_mAP_copypaste: 0.077 0.244 0.137 0.060 0.032 0.013
2024-10-16 17:38:31,949 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:39:33, time: 1.789, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0144, stage0_bag_acc: 99.4631, stage0_mean_ious: 0.3734, stage0_s: 0.0000, stage0_m: 0.0588, stage0_l: 0.1340, stage0_h: 0.4033, stage1_loss_instance_mil: 0.1978, stage1_bag_acc: 99.3179, stage1_neg_loss: 0.0665, stage1_mean_ious: 0.3465, stage1_s: 0.0000, stage1_m: 0.0652, stage1_l: 0.1352, stage1_h: 0.3718, loss: 0.2786, grad_norm: 12.1622
2024-10-16 17:39:59,025 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:38:45, time: 1.742, data_time: 0.024, memory: 18840, stage0_loss_instance_mil: 0.0292, stage0_bag_acc: 98.5112, stage0_mean_ious: 0.4276, stage0_s: 0.0000, stage0_m: 0.0322, stage0_l: 0.1455, stage0_h: 0.4580, stage1_loss_instance_mil: 0.1887, stage1_bag_acc: 98.0768, stage1_neg_loss: 0.0623, stage1_mean_ious: 0.3970, stage1_s: 0.0000, stage1_m: 0.0307, stage1_l: 0.1440, stage1_h: 0.4240, loss: 0.2802, grad_norm: 11.4547
2024-10-16 17:41:26,183 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:37:51, time: 1.743, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0187, stage0_bag_acc: 98.9835, stage0_mean_ious: 0.3591, stage0_s: 0.0000, stage0_m: 0.0497, stage0_l: 0.1751, stage0_h: 0.3887, stage1_loss_instance_mil: 0.1534, stage1_bag_acc: 99.0381, stage1_neg_loss: 0.0530, stage1_mean_ious: 0.3376, stage1_s: 0.0000, stage1_m: 0.0592, stage1_l: 0.1803, stage1_h: 0.3609, loss: 0.2251, grad_norm: 7.7337
2024-10-16 17:42:19,214 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 17:43:50,267 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:34:45, time: 1.776, data_time: 0.075, memory: 18840, stage0_loss_instance_mil: 0.0179, stage0_bag_acc: 98.6735, stage0_mean_ious: 0.3765, stage0_s: 0.0000, stage0_m: 0.0538, stage0_l: 0.1832, stage0_h: 0.4027, stage1_loss_instance_mil: 0.1583, stage1_bag_acc: 99.1830, stage1_neg_loss: 0.0564, stage1_mean_ious: 0.3545, stage1_s: 0.0000, stage1_m: 0.0592, stage1_l: 0.1847, stage1_h: 0.3757, loss: 0.2326, grad_norm: 9.1141
2024-10-16 17:45:18,734 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:33:52, time: 1.769, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0208, stage0_bag_acc: 99.0960, stage0_mean_ious: 0.4212, stage0_s: 0.0000, stage0_m: 0.0339, stage0_l: 0.1547, stage0_h: 0.4520, stage1_loss_instance_mil: 0.1331, stage1_bag_acc: 99.1550, stage1_neg_loss: 0.0506, stage1_mean_ious: 0.3850, stage1_s: 0.0000, stage1_m: 0.0356, stage1_l: 0.1735, stage1_h: 0.4074, loss: 0.2045, grad_norm: 7.7887
2024-10-16 17:46:47,574 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:32:55, time: 1.777, data_time: 0.026, memory: 18840, stage0_loss_instance_mil: 0.0156, stage0_bag_acc: 98.6276, stage0_mean_ious: 0.4268, stage0_s: 0.0000, stage0_m: 0.0791, stage0_l: 0.1903, stage0_h: 0.4716, stage1_loss_instance_mil: 0.1212, stage1_bag_acc: 99.3478, stage1_neg_loss: 0.0437, stage1_mean_ious: 0.3999, stage1_s: 0.0000, stage1_m: 0.0994, stage1_l: 0.1962, stage1_h: 0.4337, loss: 0.1805, grad_norm: 7.0666
2024-10-16 17:47:40,933 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 17:49:13,222 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:30:11, time: 1.802, data_time: 0.072, memory: 18840, stage0_loss_instance_mil: 0.0106, stage0_bag_acc: 99.7038, stage0_mean_ious: 0.4394, stage0_s: 0.0000, stage0_m: 0.0678, stage0_l: 0.1417, stage0_h: 0.4725, stage1_loss_instance_mil: 0.1368, stage1_bag_acc: 99.4677, stage1_neg_loss: 0.0565, stage1_mean_ious: 0.4064, stage1_s: 0.0000, stage1_m: 0.0703, stage1_l: 0.1574, stage1_h: 0.4322, loss: 0.2039, grad_norm: 9.8996
2024-10-16 17:50:41,718 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 17:50:41,718 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:29:12, time: 1.770, data_time: 0.025, memory: 18840, stage0_loss_instance_mil: 0.0143, stage0_bag_acc: 99.0778, stage0_mean_ious: 0.4582, stage0_s: 0.0000, stage0_m: 0.0489, stage0_l: 0.1807, stage0_h: 0.4882, stage1_loss_instance_mil: 0.1101, stage1_bag_acc: 98.9468, stage1_neg_loss: 0.0416, stage1_mean_ious: 0.4176, stage1_s: 0.0000, stage1_m: 0.0541, stage1_l: 0.1885, stage1_h: 0.4400, loss: 0.1660, grad_norm: 5.7678
