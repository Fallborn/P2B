2024-04-19 01:36:56,919 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 01:36:59,001 - mmdet - INFO - Distributed training: False
2024-04-19 01:37:01,012 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 01:37:06,989 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 01:37:06,990 - mmdet - INFO - Use load_from_local loader
2024-04-19 01:37:07,371 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 01:37:07,393 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 01:37:07,393 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 01:38:33,040 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:00:13, time: 1.713, data_time: 0.089, memory: 17769, stage0_loss_instance_mil: 0.6932, stage0_bag_acc: 29.9580, stage0_mean_ious: 0.2959, stage0_s: 0.0000, stage0_m: 0.0342, stage0_l: 0.2307, stage0_h: 0.2996, stage1_loss_instance_mil: 0.1811, stage1_bag_acc: 18.2955, stage1_neg_loss: 0.0014, stage1_mean_ious: 0.2821, stage1_s: 0.0000, stage1_m: 0.0332, stage1_l: 0.2340, stage1_h: 0.2829, loss: 0.8757, grad_norm: 3.1865
2024-04-19 01:39:55,203 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:57:36, time: 1.643, data_time: 0.038, memory: 17769, stage0_loss_instance_mil: 0.5437, stage0_bag_acc: 61.6194, stage0_mean_ious: 0.3209, stage0_s: 0.0000, stage0_m: 0.0616, stage0_l: 0.2054, stage0_h: 0.3285, stage1_loss_instance_mil: 0.2438, stage1_bag_acc: 36.1181, stage1_neg_loss: 0.0112, stage1_mean_ious: 0.3116, stage1_s: 0.0000, stage1_m: 0.0608, stage1_l: 0.1978, stage1_h: 0.3182, loss: 0.7986, grad_norm: 4.8918
2024-04-19 01:41:18,352 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:56:02, time: 1.663, data_time: 0.038, memory: 17769, stage0_loss_instance_mil: 0.2365, stage0_bag_acc: 92.5393, stage0_mean_ious: 0.3446, stage0_s: 0.0017, stage0_m: 0.0970, stage0_l: 0.2015, stage0_h: 0.3595, stage1_loss_instance_mil: 0.3554, stage1_bag_acc: 82.9631, stage1_neg_loss: 0.0689, stage1_mean_ious: 0.3269, stage1_s: 0.0013, stage1_m: 0.0882, stage1_l: 0.1946, stage1_h: 0.3398, loss: 0.6609, grad_norm: 10.0814
2024-04-19 01:42:09,227 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 01:43:37,210 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:46:59, time: 1.701, data_time: 0.095, memory: 17783, stage0_loss_instance_mil: 0.0852, stage0_bag_acc: 95.8149, stage0_mean_ious: 0.3097, stage0_s: 0.0000, stage0_m: 0.0395, stage0_l: 0.1681, stage0_h: 0.3242, stage1_loss_instance_mil: 0.3368, stage1_bag_acc: 97.3517, stage1_neg_loss: 0.0901, stage1_mean_ious: 0.2731, stage1_s: 0.0000, stage1_m: 0.0365, stage1_l: 0.1416, stage1_h: 0.2862, loss: 0.5121, grad_norm: 12.8441
2024-04-19 01:44:59,900 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:46:51, time: 1.654, data_time: 0.042, memory: 17783, stage0_loss_instance_mil: 0.0600, stage0_bag_acc: 96.3868, stage0_mean_ious: 0.2929, stage0_s: 0.0000, stage0_m: 0.0583, stage0_l: 0.1460, stage0_h: 0.3130, stage1_loss_instance_mil: 0.3261, stage1_bag_acc: 97.7422, stage1_neg_loss: 0.0893, stage1_mean_ious: 0.2631, stage1_s: 0.0000, stage1_m: 0.0449, stage1_l: 0.1309, stage1_h: 0.2810, loss: 0.4755, grad_norm: 14.7398
2024-04-19 01:46:24,744 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:46:32, time: 1.697, data_time: 0.044, memory: 17783, stage0_loss_instance_mil: 0.0534, stage0_bag_acc: 97.2056, stage0_mean_ious: 0.3102, stage0_s: 0.0000, stage0_m: 0.0275, stage0_l: 0.1328, stage0_h: 0.3257, stage1_loss_instance_mil: 0.3422, stage1_bag_acc: 97.8352, stage1_neg_loss: 0.0982, stage1_mean_ious: 0.2697, stage1_s: 0.0000, stage1_m: 0.0195, stage1_l: 0.1155, stage1_h: 0.2838, loss: 0.4937, grad_norm: 18.5791
2024-04-19 01:47:15,694 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 01:48:44,253 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:41:56, time: 1.721, data_time: 0.093, memory: 17783, stage0_loss_instance_mil: 0.0439, stage0_bag_acc: 97.9391, stage0_mean_ious: 0.3383, stage0_s: 0.0000, stage0_m: 0.0270, stage0_l: 0.1109, stage0_h: 0.3646, stage1_loss_instance_mil: 0.3019, stage1_bag_acc: 98.6777, stage1_neg_loss: 0.0902, stage1_mean_ious: 0.2953, stage1_s: 0.0000, stage1_m: 0.0165, stage1_l: 0.0936, stage1_h: 0.3200, loss: 0.4360, grad_norm: 16.6624
2024-04-19 01:50:08,737 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:41:31, time: 1.690, data_time: 0.041, memory: 17783, stage0_loss_instance_mil: 0.0269, stage0_bag_acc: 98.2368, stage0_mean_ious: 0.3537, stage0_s: 0.0000, stage0_m: 0.0498, stage0_l: 0.1373, stage0_h: 0.3784, stage1_loss_instance_mil: 0.2935, stage1_bag_acc: 99.3620, stage1_neg_loss: 0.1008, stage1_mean_ious: 0.3098, stage1_s: 0.0000, stage1_m: 0.0474, stage1_l: 0.1153, stage1_h: 0.3330, loss: 0.4213, grad_norm: 20.1556
2024-04-19 01:51:32,828 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:40:52, time: 1.682, data_time: 0.042, memory: 17783, stage0_loss_instance_mil: 0.0270, stage0_bag_acc: 98.9099, stage0_mean_ious: 0.3518, stage0_s: 0.0000, stage0_m: 0.0362, stage0_l: 0.1384, stage0_h: 0.3843, stage1_loss_instance_mil: 0.2654, stage1_bag_acc: 98.5332, stage1_neg_loss: 0.0948, stage1_mean_ious: 0.3040, stage1_s: 0.0000, stage1_m: 0.0262, stage1_l: 0.1143, stage1_h: 0.3341, loss: 0.3872, grad_norm: 19.2194
2024-04-19 01:52:24,038 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 01:53:53,186 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:26, time: 1.724, data_time: 0.092, memory: 17792, stage0_loss_instance_mil: 0.0353, stage0_bag_acc: 97.8589, stage0_mean_ious: 0.3304, stage0_s: 0.0015, stage0_m: 0.0425, stage0_l: 0.1295, stage0_h: 0.3563, stage1_loss_instance_mil: 0.2482, stage1_bag_acc: 98.2842, stage1_neg_loss: 0.0829, stage1_mean_ious: 0.2807, stage1_s: 0.0016, stage1_m: 0.0304, stage1_l: 0.1103, stage1_h: 0.3048, loss: 0.3664, grad_norm: 15.7384
2024-04-19 01:55:18,005 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:36:46, time: 1.696, data_time: 0.042, memory: 17792, stage0_loss_instance_mil: 0.0449, stage0_bag_acc: 97.0705, stage0_mean_ious: 0.2959, stage0_s: 0.0000, stage0_m: 0.0190, stage0_l: 0.1255, stage0_h: 0.3149, stage1_loss_instance_mil: 0.2417, stage1_bag_acc: 98.6150, stage1_neg_loss: 0.0714, stage1_mean_ious: 0.2454, stage1_s: 0.0000, stage1_m: 0.0136, stage1_l: 0.1136, stage1_h: 0.2603, loss: 0.3580, grad_norm: 12.7687
2024-04-19 01:56:42,305 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:35:59, time: 1.686, data_time: 0.042, memory: 17792, stage0_loss_instance_mil: 0.0308, stage0_bag_acc: 98.1111, stage0_mean_ious: 0.2330, stage0_s: 0.0000, stage0_m: 0.0351, stage0_l: 0.1156, stage0_h: 0.2534, stage1_loss_instance_mil: 0.2680, stage1_bag_acc: 99.1594, stage1_neg_loss: 0.0800, stage1_mean_ious: 0.2050, stage1_s: 0.0000, stage1_m: 0.0231, stage1_l: 0.0965, stage1_h: 0.2246, loss: 0.3787, grad_norm: 14.5912
2024-04-19 01:57:33,494 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 01:59:02,004 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:04, time: 1.712, data_time: 0.098, memory: 17792, stage0_loss_instance_mil: 0.0276, stage0_bag_acc: 98.5468, stage0_mean_ious: 0.2448, stage0_s: 0.0000, stage0_m: 0.0430, stage0_l: 0.0832, stage0_h: 0.2628, stage1_loss_instance_mil: 0.2115, stage1_bag_acc: 99.3756, stage1_neg_loss: 0.0749, stage1_mean_ious: 0.2162, stage1_s: 0.0000, stage1_m: 0.0355, stage1_l: 0.0679, stage1_h: 0.2335, loss: 0.3140, grad_norm: 11.7939
2024-04-19 02:00:26,942 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:14, time: 1.699, data_time: 0.042, memory: 17792, stage0_loss_instance_mil: 0.0168, stage0_bag_acc: 98.9196, stage0_mean_ious: 0.1975, stage0_s: 0.0000, stage0_m: 0.0185, stage0_l: 0.0906, stage0_h: 0.2093, stage1_loss_instance_mil: 0.2062, stage1_bag_acc: 99.1216, stage1_neg_loss: 0.0757, stage1_mean_ious: 0.1761, stage1_s: 0.0000, stage1_m: 0.0124, stage1_l: 0.0743, stage1_h: 0.1886, loss: 0.2988, grad_norm: 12.4139
2024-04-19 02:01:51,610 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:21, time: 1.693, data_time: 0.045, memory: 17792, stage0_loss_instance_mil: 0.0337, stage0_bag_acc: 97.2781, stage0_mean_ious: 0.1899, stage0_s: 0.0000, stage0_m: 0.0170, stage0_l: 0.0920, stage0_h: 0.1985, stage1_loss_instance_mil: 0.1997, stage1_bag_acc: 98.1647, stage1_neg_loss: 0.0689, stage1_mean_ious: 0.1725, stage1_s: 0.0000, stage1_m: 0.0158, stage1_l: 0.0765, stage1_h: 0.1820, loss: 0.3023, grad_norm: 9.6991
2024-04-19 02:02:43,946 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 02:04:12,218 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:44, time: 1.708, data_time: 0.093, memory: 17792, stage0_loss_instance_mil: 0.0142, stage0_bag_acc: 98.9638, stage0_mean_ious: 0.1557, stage0_s: 0.0000, stage0_m: 0.0355, stage0_l: 0.0915, stage0_h: 0.1621, stage1_loss_instance_mil: 0.1915, stage1_bag_acc: 99.4794, stage1_neg_loss: 0.0733, stage1_mean_ious: 0.1403, stage1_s: 0.0000, stage1_m: 0.0285, stage1_l: 0.0717, stage1_h: 0.1482, loss: 0.2789, grad_norm: 11.4410
2024-04-19 02:05:37,739 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 02:05:37,740 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:27:50, time: 1.710, data_time: 0.045, memory: 17792, stage0_loss_instance_mil: 0.0185, stage0_bag_acc: 99.0008, stage0_mean_ious: 0.1704, stage0_s: 0.0000, stage0_m: 0.0182, stage0_l: 0.1031, stage0_h: 0.1767, stage1_loss_instance_mil: 0.1710, stage1_bag_acc: 99.2708, stage1_neg_loss: 0.0639, stage1_mean_ious: 0.1533, stage1_s: 0.0000, stage1_m: 0.0118, stage1_l: 0.0904, stage1_h: 0.1608, loss: 0.2534, grad_norm: 8.9912
2024-04-19 02:07:02,214 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:26:51, time: 1.689, data_time: 0.046, memory: 17792, stage0_loss_instance_mil: 0.0248, stage0_bag_acc: 98.2307, stage0_mean_ious: 0.1555, stage0_s: 0.0018, stage0_m: 0.0201, stage0_l: 0.0966, stage0_h: 0.1588, stage1_loss_instance_mil: 0.1885, stage1_bag_acc: 98.6960, stage1_neg_loss: 0.0698, stage1_mean_ious: 0.1388, stage1_s: 0.0014, stage1_m: 0.0135, stage1_l: 0.0811, stage1_h: 0.1433, loss: 0.2831, grad_norm: 10.8897
2024-04-19 02:07:52,716 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 02:09:49,864 - mmdet - INFO - Evaluating bbox...
2024-04-19 02:09:51,890 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0013
2024-04-19 02:09:51,891 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0069
2024-04-19 02:09:51,891 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0014
2024-04-19 02:09:51,891 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0006
2024-04-19 02:09:51,892 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0006
2024-04-19 02:09:51,892 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 02:09:51,892 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 02:09:51,892 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0011
2024-04-19 02:09:51,893 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0019
2024-04-19 02:09:51,893 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0017
2024-04-19 02:09:51,893 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0107
2024-04-19 02:09:51,893 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0107
2024-04-19 02:09:51,893 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0107
2024-04-19 02:09:51,894 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0222
2024-04-19 02:09:51,894 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0211
2024-04-19 02:09:51,894 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0034
2024-04-19 02:09:51,942 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 02:09:51,942 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0010, bbox_mAP_50: 0.0070, bbox_mAP_75: 0.0010, bbox_mAP_s: 0.0010, bbox_mAP_m: 0.0010, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.001 0.007 0.001 0.001 0.001 0.000
2024-04-19 02:11:18,274 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:27, time: 1.726, data_time: 0.095, memory: 17792, stage0_loss_instance_mil: 0.0118, stage0_bag_acc: 99.5148, stage0_mean_ious: 0.1654, stage0_s: 0.0013, stage0_m: 0.0271, stage0_l: 0.1041, stage0_h: 0.1706, stage1_loss_instance_mil: 0.1545, stage1_bag_acc: 99.2538, stage1_neg_loss: 0.0618, stage1_mean_ious: 0.1482, stage1_s: 0.0022, stage1_m: 0.0192, stage1_l: 0.0905, stage1_h: 0.1542, loss: 0.2281, grad_norm: 9.3592
2024-04-19 02:12:41,119 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:26, time: 1.657, data_time: 0.043, memory: 17792, stage0_loss_instance_mil: 0.0212, stage0_bag_acc: 98.6751, stage0_mean_ious: 0.1735, stage0_s: 0.0000, stage0_m: 0.0397, stage0_l: 0.1009, stage0_h: 0.1796, stage1_loss_instance_mil: 0.1438, stage1_bag_acc: 99.1441, stage1_neg_loss: 0.0608, stage1_mean_ious: 0.1574, stage1_s: 0.0000, stage1_m: 0.0330, stage1_l: 0.0960, stage1_h: 0.1626, loss: 0.2258, grad_norm: 8.8956
2024-04-19 02:14:04,644 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:23, time: 1.670, data_time: 0.042, memory: 17792, stage0_loss_instance_mil: 0.0230, stage0_bag_acc: 98.5091, stage0_mean_ious: 0.1893, stage0_s: 0.0000, stage0_m: 0.0330, stage0_l: 0.0883, stage0_h: 0.1979, stage1_loss_instance_mil: 0.1566, stage1_bag_acc: 98.7755, stage1_neg_loss: 0.0593, stage1_mean_ious: 0.1689, stage1_s: 0.0000, stage1_m: 0.0251, stage1_l: 0.0788, stage1_h: 0.1766, loss: 0.2388, grad_norm: 9.4048
2024-04-19 02:14:56,834 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 02:16:24,818 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:08, time: 1.703, data_time: 0.090, memory: 17792, stage0_loss_instance_mil: 0.0140, stage0_bag_acc: 99.5871, stage0_mean_ious: 0.1441, stage0_s: 0.0000, stage0_m: 0.0468, stage0_l: 0.0901, stage0_h: 0.1522, stage1_loss_instance_mil: 0.1494, stage1_bag_acc: 98.8852, stage1_neg_loss: 0.0585, stage1_mean_ious: 0.1313, stage1_s: 0.0000, stage1_m: 0.0345, stage1_l: 0.0813, stage1_h: 0.1404, loss: 0.2218, grad_norm: 9.8568
2024-04-19 02:17:50,185 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:05, time: 1.707, data_time: 0.044, memory: 17792, stage0_loss_instance_mil: 0.0173, stage0_bag_acc: 99.0400, stage0_mean_ious: 0.1533, stage0_s: 0.0000, stage0_m: 0.0162, stage0_l: 0.0908, stage0_h: 0.1593, stage1_loss_instance_mil: 0.1361, stage1_bag_acc: 98.9033, stage1_neg_loss: 0.0616, stage1_mean_ious: 0.1389, stage1_s: 0.0000, stage1_m: 0.0143, stage1_l: 0.0815, stage1_h: 0.1450, loss: 0.2149, grad_norm: 8.3495
2024-04-19 02:19:13,929 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:00, time: 1.675, data_time: 0.045, memory: 17792, stage0_loss_instance_mil: 0.0158, stage0_bag_acc: 99.0558, stage0_mean_ious: 0.1478, stage0_s: 0.0000, stage0_m: 0.0358, stage0_l: 0.0946, stage0_h: 0.1487, stage1_loss_instance_mil: 0.1365, stage1_bag_acc: 99.5490, stage1_neg_loss: 0.0561, stage1_mean_ious: 0.1349, stage1_s: 0.0000, stage1_m: 0.0332, stage1_l: 0.0834, stage1_h: 0.1358, loss: 0.2083, grad_norm: 7.4915
2024-04-19 02:20:03,408 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 02:21:33,281 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:52, time: 1.741, data_time: 0.097, memory: 17792, stage0_loss_instance_mil: 0.0084, stage0_bag_acc: 99.3814, stage0_mean_ious: 0.1650, stage0_s: 0.0000, stage0_m: 0.0285, stage0_l: 0.0867, stage0_h: 0.1725, stage1_loss_instance_mil: 0.1079, stage1_bag_acc: 99.7038, stage1_neg_loss: 0.0482, stage1_mean_ious: 0.1449, stage1_s: 0.0000, stage1_m: 0.0217, stage1_l: 0.0824, stage1_h: 0.1512, loss: 0.1646, grad_norm: 5.7278
2024-04-19 02:22:56,639 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:46, time: 1.667, data_time: 0.041, memory: 17792, stage0_loss_instance_mil: 0.0094, stage0_bag_acc: 99.3790, stage0_mean_ious: 0.1661, stage0_s: 0.0017, stage0_m: 0.0314, stage0_l: 0.0848, stage0_h: 0.1737, stage1_loss_instance_mil: 0.1138, stage1_bag_acc: 99.4621, stage1_neg_loss: 0.0541, stage1_mean_ious: 0.1473, stage1_s: 0.0024, stage1_m: 0.0306, stage1_l: 0.0787, stage1_h: 0.1536, loss: 0.1774, grad_norm: 6.2929
2024-04-19 02:24:19,501 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:38, time: 1.657, data_time: 0.041, memory: 17792, stage0_loss_instance_mil: 0.0029, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.1635, stage0_s: 0.0000, stage0_m: 0.0314, stage0_l: 0.0914, stage0_h: 0.1712, stage1_loss_instance_mil: 0.1066, stage1_bag_acc: 99.9091, stage1_neg_loss: 0.0551, stage1_mean_ious: 0.1468, stage1_s: 0.0000, stage1_m: 0.0253, stage1_l: 0.0780, stage1_h: 0.1543, loss: 0.1646, grad_norm: 6.0052
2024-04-19 02:25:09,969 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 02:26:38,840 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:35, time: 1.719, data_time: 0.088, memory: 17795, stage0_loss_instance_mil: 0.0029, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.1677, stage0_s: 0.0009, stage0_m: 0.0287, stage0_l: 0.0871, stage0_h: 0.1745, stage1_loss_instance_mil: 0.1130, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0528, stage1_mean_ious: 0.1494, stage1_s: 0.0001, stage1_m: 0.0240, stage1_l: 0.0760, stage1_h: 0.1557, loss: 0.1687, grad_norm: 6.4373
2024-04-19 02:28:03,257 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:27, time: 1.688, data_time: 0.040, memory: 17795, stage0_loss_instance_mil: 0.0071, stage0_bag_acc: 99.8182, stage0_mean_ious: 0.1801, stage0_s: 0.0000, stage0_m: 0.0154, stage0_l: 0.0981, stage0_h: 0.1904, stage1_loss_instance_mil: 0.1033, stage1_bag_acc: 99.8182, stage1_neg_loss: 0.0527, stage1_mean_ious: 0.1608, stage1_s: 0.0000, stage1_m: 0.0107, stage1_l: 0.0900, stage1_h: 0.1700, loss: 0.1630, grad_norm: 6.0835
2024-04-19 02:29:27,862 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:19, time: 1.692, data_time: 0.042, memory: 17795, stage0_loss_instance_mil: 0.0060, stage0_bag_acc: 99.6712, stage0_mean_ious: 0.1794, stage0_s: 0.0000, stage0_m: 0.0441, stage0_l: 0.0894, stage0_h: 0.1893, stage1_loss_instance_mil: 0.1041, stage1_bag_acc: 99.6980, stage1_neg_loss: 0.0498, stage1_mean_ious: 0.1569, stage1_s: 0.0000, stage1_m: 0.0350, stage1_l: 0.0788, stage1_h: 0.1657, loss: 0.1600, grad_norm: 5.6718
2024-04-19 02:30:19,008 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 02:31:50,309 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:20, time: 1.769, data_time: 0.093, memory: 17795, stage0_loss_instance_mil: 0.0051, stage0_bag_acc: 99.6224, stage0_mean_ious: 0.1936, stage0_s: 0.0000, stage0_m: 0.0347, stage0_l: 0.1045, stage0_h: 0.2034, stage1_loss_instance_mil: 0.1031, stage1_bag_acc: 99.7400, stage1_neg_loss: 0.0469, stage1_mean_ious: 0.1696, stage1_s: 0.0000, stage1_m: 0.0279, stage1_l: 0.0945, stage1_h: 0.1779, loss: 0.1551, grad_norm: 5.1688
2024-04-19 02:33:14,178 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:11, time: 1.677, data_time: 0.040, memory: 17795, stage0_loss_instance_mil: 0.0054, stage0_bag_acc: 99.7273, stage0_mean_ious: 0.1884, stage0_s: 0.0000, stage0_m: 0.0247, stage0_l: 0.0837, stage0_h: 0.1972, stage1_loss_instance_mil: 0.0958, stage1_bag_acc: 99.9091, stage1_neg_loss: 0.0499, stage1_mean_ious: 0.1672, stage1_s: 0.0000, stage1_m: 0.0205, stage1_l: 0.0749, stage1_h: 0.1745, loss: 0.1510, grad_norm: 5.7976
2024-04-19 02:34:34,593 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:00, time: 1.608, data_time: 0.040, memory: 17795, stage0_loss_instance_mil: 0.0027, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.1974, stage0_s: 0.0000, stage0_m: 0.0232, stage0_l: 0.0870, stage0_h: 0.2097, stage1_loss_instance_mil: 0.1042, stage1_bag_acc: 99.8130, stage1_neg_loss: 0.0512, stage1_mean_ious: 0.1726, stage1_s: 0.0000, stage1_m: 0.0164, stage1_l: 0.0778, stage1_h: 0.1836, loss: 0.1581, grad_norm: 5.9808
2024-04-19 02:35:24,673 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 02:36:52,433 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:04, time: 1.699, data_time: 0.091, memory: 17795, stage0_loss_instance_mil: 0.0076, stage0_bag_acc: 99.7246, stage0_mean_ious: 0.1890, stage0_s: 0.0000, stage0_m: 0.0208, stage0_l: 0.0823, stage0_h: 0.1982, stage1_loss_instance_mil: 0.0946, stage1_bag_acc: 99.5284, stage1_neg_loss: 0.0467, stage1_mean_ious: 0.1624, stage1_s: 0.0000, stage1_m: 0.0190, stage1_l: 0.0728, stage1_h: 0.1694, loss: 0.1489, grad_norm: 5.4984
2024-04-19 02:38:15,219 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:53, time: 1.656, data_time: 0.041, memory: 17795, stage0_loss_instance_mil: 0.0023, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.1840, stage0_s: 0.0000, stage0_m: 0.0351, stage0_l: 0.0901, stage0_h: 0.1954, stage1_loss_instance_mil: 0.0957, stage1_bag_acc: 99.7995, stage1_neg_loss: 0.0469, stage1_mean_ious: 0.1650, stage1_s: 0.0000, stage1_m: 0.0255, stage1_l: 0.0816, stage1_h: 0.1756, loss: 0.1449, grad_norm: 5.5412
2024-04-19 02:39:37,951 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:42, time: 1.655, data_time: 0.041, memory: 17795, stage0_loss_instance_mil: 0.0020, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.1873, stage0_s: 0.0000, stage0_m: 0.0219, stage0_l: 0.1009, stage0_h: 0.1978, stage1_loss_instance_mil: 0.0933, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0463, stage1_mean_ious: 0.1642, stage1_s: 0.0000, stage1_m: 0.0178, stage1_l: 0.0895, stage1_h: 0.1737, loss: 0.1416, grad_norm: 5.3084
2024-04-19 02:40:28,101 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 02:42:33,365 - mmdet - INFO - Evaluating bbox...
2024-04-19 02:42:35,218 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0015
2024-04-19 02:42:35,218 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0093
2024-04-19 02:42:35,219 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0014
2024-04-19 02:42:35,219 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0004
2024-04-19 02:42:35,219 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0001
2024-04-19 02:42:35,219 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 02:42:35,219 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 02:42:35,220 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0001
2024-04-19 02:42:35,220 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0026
2024-04-19 02:42:35,220 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0012
2024-04-19 02:42:35,220 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0119
2024-04-19 02:42:35,221 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0119
2024-04-19 02:42:35,221 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0119
2024-04-19 02:42:35,221 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0104
2024-04-19 02:42:35,221 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0221
2024-04-19 02:42:35,221 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0022
2024-04-19 02:42:35,269 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 02:42:35,270 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0020, bbox_mAP_50: 0.0090, bbox_mAP_75: 0.0010, bbox_mAP_s: 0.0000, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.002 0.009 0.001 0.000 0.000 0.000
2024-04-19 02:44:38,397 - mmdet - INFO - Evaluating bbox...
2024-04-19 02:44:40,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0015
2024-04-19 02:44:40,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0093
2024-04-19 02:44:40,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0014
2024-04-19 02:44:40,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0004
2024-04-19 02:44:40,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0001
2024-04-19 02:44:40,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 02:44:40,256 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 02:44:40,256 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0001
2024-04-19 02:44:40,256 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0026
2024-04-19 02:44:40,256 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0012
2024-04-19 02:44:40,256 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0119
2024-04-19 02:44:40,257 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0119
2024-04-19 02:44:40,257 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0119
2024-04-19 02:44:40,257 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0104
2024-04-19 02:44:40,257 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0221
2024-04-19 02:44:40,257 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0022
2024-04-19 02:44:42,868 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 02:44:44,951 - mmdet - INFO - Distributed training: False
2024-04-19 02:44:47,028 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 02:44:49,349 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 02:44:49,349 - mmdet - INFO - Use load_from_local loader
2024-04-19 02:44:49,718 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 02:44:49,738 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 02:44:49,739 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 02:46:15,662 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:00:25, time: 1.718, data_time: 0.092, memory: 17795, stage0_loss_instance_mil: 0.7105, stage0_bag_acc: 27.1536, stage0_mean_ious: 0.2868, stage0_s: 0.0000, stage0_m: 0.0221, stage0_l: 0.1891, stage0_h: 0.2958, stage1_loss_instance_mil: 0.1769, stage1_bag_acc: 11.5629, stage1_neg_loss: 0.0009, stage1_mean_ious: 0.2891, stage1_s: 0.0000, stage1_m: 0.0220, stage1_l: 0.1943, stage1_h: 0.2970, loss: 0.8883, grad_norm: 3.1873
2024-04-19 02:47:37,354 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:57:32, time: 1.634, data_time: 0.040, memory: 17795, stage0_loss_instance_mil: 0.6052, stage0_bag_acc: 51.2088, stage0_mean_ious: 0.3188, stage0_s: 0.0000, stage0_m: 0.0384, stage0_l: 0.2202, stage0_h: 0.3263, stage1_loss_instance_mil: 0.2303, stage1_bag_acc: 25.6509, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.3202, stage1_s: 0.0000, stage1_m: 0.0424, stage1_l: 0.2257, stage1_h: 0.3270, loss: 0.8393, grad_norm: 3.9010
2024-04-19 02:49:02,080 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:56:21, time: 1.694, data_time: 0.042, memory: 17795, stage0_loss_instance_mil: 0.2958, stage0_bag_acc: 82.2504, stage0_mean_ious: 0.3419, stage0_s: 0.0000, stage0_m: 0.0536, stage0_l: 0.2056, stage0_h: 0.3640, stage1_loss_instance_mil: 0.3022, stage1_bag_acc: 70.5859, stage1_neg_loss: 0.0593, stage1_mean_ious: 0.3442, stage1_s: 0.0000, stage1_m: 0.0532, stage1_l: 0.2060, stage1_h: 0.3664, loss: 0.6573, grad_norm: 9.1618
2024-04-19 02:49:52,012 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 02:51:20,144 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:47:12, time: 1.705, data_time: 0.093, memory: 17795, stage0_loss_instance_mil: 0.0918, stage0_bag_acc: 95.3410, stage0_mean_ious: 0.3312, stage0_s: 0.0000, stage0_m: 0.0486, stage0_l: 0.1328, stage0_h: 0.3528, stage1_loss_instance_mil: 0.3509, stage1_bag_acc: 97.2904, stage1_neg_loss: 0.0917, stage1_mean_ious: 0.3189, stage1_s: 0.0000, stage1_m: 0.0480, stage1_l: 0.1370, stage1_h: 0.3383, loss: 0.5344, grad_norm: 11.1180
2024-04-19 02:52:44,148 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:10, time: 1.680, data_time: 0.041, memory: 17795, stage0_loss_instance_mil: 0.0729, stage0_bag_acc: 96.1045, stage0_mean_ious: 0.3636, stage0_s: 0.0000, stage0_m: 0.0626, stage0_l: 0.1429, stage0_h: 0.3954, stage1_loss_instance_mil: 0.3186, stage1_bag_acc: 96.9834, stage1_neg_loss: 0.0968, stage1_mean_ious: 0.3426, stage1_s: 0.0000, stage1_m: 0.0571, stage1_l: 0.1326, stage1_h: 0.3733, loss: 0.4883, grad_norm: 15.0327
2024-04-19 02:54:09,949 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:46:53, time: 1.716, data_time: 0.042, memory: 17795, stage0_loss_instance_mil: 0.0448, stage0_bag_acc: 97.4262, stage0_mean_ious: 0.3742, stage0_s: 0.0000, stage0_m: 0.0438, stage0_l: 0.1158, stage0_h: 0.4016, stage1_loss_instance_mil: 0.3109, stage1_bag_acc: 98.4658, stage1_neg_loss: 0.0888, stage1_mean_ious: 0.3368, stage1_s: 0.0000, stage1_m: 0.0382, stage1_l: 0.1025, stage1_h: 0.3621, loss: 0.4445, grad_norm: 14.0693
2024-04-19 02:55:00,735 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 02:56:30,541 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:18, time: 1.747, data_time: 0.094, memory: 17795, stage0_loss_instance_mil: 0.0315, stage0_bag_acc: 98.5812, stage0_mean_ious: 0.3399, stage0_s: 0.0000, stage0_m: 0.0346, stage0_l: 0.1266, stage0_h: 0.3674, stage1_loss_instance_mil: 0.2675, stage1_bag_acc: 99.0160, stage1_neg_loss: 0.0899, stage1_mean_ious: 0.3112, stage1_s: 0.0000, stage1_m: 0.0264, stage1_l: 0.1141, stage1_h: 0.3385, loss: 0.3889, grad_norm: 15.7672
2024-04-19 02:57:52,840 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:41:42, time: 1.646, data_time: 0.040, memory: 17795, stage0_loss_instance_mil: 0.0315, stage0_bag_acc: 98.1078, stage0_mean_ious: 0.3444, stage0_s: 0.0019, stage0_m: 0.0174, stage0_l: 0.1177, stage0_h: 0.3704, stage1_loss_instance_mil: 0.2493, stage1_bag_acc: 99.5995, stage1_neg_loss: 0.0825, stage1_mean_ious: 0.3047, stage1_s: 0.0014, stage1_m: 0.0127, stage1_l: 0.1029, stage1_h: 0.3287, loss: 0.3634, grad_norm: 12.0384
2024-04-19 02:59:16,190 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:00, time: 1.667, data_time: 0.039, memory: 17795, stage0_loss_instance_mil: 0.0527, stage0_bag_acc: 96.7428, stage0_mean_ious: 0.3171, stage0_s: 0.0000, stage0_m: 0.0468, stage0_l: 0.1090, stage0_h: 0.3445, stage1_loss_instance_mil: 0.2679, stage1_bag_acc: 97.0133, stage1_neg_loss: 0.0839, stage1_mean_ious: 0.2799, stage1_s: 0.0000, stage1_m: 0.0349, stage1_l: 0.0824, stage1_h: 0.3070, loss: 0.4045, grad_norm: 14.9570
2024-04-19 03:00:06,052 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 03:01:34,927 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:32, time: 1.719, data_time: 0.091, memory: 17795, stage0_loss_instance_mil: 0.0260, stage0_bag_acc: 98.5313, stage0_mean_ious: 0.3138, stage0_s: 0.0000, stage0_m: 0.0493, stage0_l: 0.1056, stage0_h: 0.3401, stage1_loss_instance_mil: 0.2183, stage1_bag_acc: 99.4147, stage1_neg_loss: 0.0700, stage1_mean_ious: 0.2721, stage1_s: 0.0000, stage1_m: 0.0322, stage1_l: 0.0850, stage1_h: 0.2967, loss: 0.3144, grad_norm: 11.7948
2024-04-19 03:02:57,385 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:36:45, time: 1.649, data_time: 0.040, memory: 17795, stage0_loss_instance_mil: 0.0299, stage0_bag_acc: 98.7382, stage0_mean_ious: 0.3510, stage0_s: 0.0000, stage0_m: 0.0128, stage0_l: 0.1149, stage0_h: 0.3863, stage1_loss_instance_mil: 0.2159, stage1_bag_acc: 98.7200, stage1_neg_loss: 0.0772, stage1_mean_ious: 0.3134, stage1_s: 0.0000, stage1_m: 0.0107, stage1_l: 0.0903, stage1_h: 0.3471, loss: 0.3231, grad_norm: 11.4989
2024-04-19 03:04:20,828 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:35:56, time: 1.669, data_time: 0.040, memory: 17795, stage0_loss_instance_mil: 0.0218, stage0_bag_acc: 98.7535, stage0_mean_ious: 0.3295, stage0_s: 0.0000, stage0_m: 0.0170, stage0_l: 0.1153, stage0_h: 0.3686, stage1_loss_instance_mil: 0.2146, stage1_bag_acc: 98.8101, stage1_neg_loss: 0.0748, stage1_mean_ious: 0.2875, stage1_s: 0.0000, stage1_m: 0.0134, stage1_l: 0.0903, stage1_h: 0.3237, loss: 0.3111, grad_norm: 12.3886
2024-04-19 03:05:13,230 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 03:06:42,023 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:02, time: 1.716, data_time: 0.093, memory: 17795, stage0_loss_instance_mil: 0.0317, stage0_bag_acc: 98.3166, stage0_mean_ious: 0.3036, stage0_s: 0.0000, stage0_m: 0.0318, stage0_l: 0.1002, stage0_h: 0.3362, stage1_loss_instance_mil: 0.2123, stage1_bag_acc: 98.6236, stage1_neg_loss: 0.0724, stage1_mean_ious: 0.2714, stage1_s: 0.0000, stage1_m: 0.0233, stage1_l: 0.0819, stage1_h: 0.3028, loss: 0.3164, grad_norm: 12.9209
2024-04-19 03:08:06,059 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:11, time: 1.681, data_time: 0.041, memory: 17795, stage0_loss_instance_mil: 0.0212, stage0_bag_acc: 99.0776, stage0_mean_ious: 0.3187, stage0_s: 0.0000, stage0_m: 0.0357, stage0_l: 0.0942, stage0_h: 0.3490, stage1_loss_instance_mil: 0.2056, stage1_bag_acc: 99.2031, stage1_neg_loss: 0.0798, stage1_mean_ious: 0.2854, stage1_s: 0.0000, stage1_m: 0.0247, stage1_l: 0.0817, stage1_h: 0.3144, loss: 0.3066, grad_norm: 15.1284
2024-04-19 03:09:26,686 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:12, time: 1.613, data_time: 0.039, memory: 17795, stage0_loss_instance_mil: 0.0190, stage0_bag_acc: 98.9173, stage0_mean_ious: 0.2835, stage0_s: 0.0000, stage0_m: 0.0225, stage0_l: 0.0852, stage0_h: 0.3049, stage1_loss_instance_mil: 0.2046, stage1_bag_acc: 99.3238, stage1_neg_loss: 0.0717, stage1_mean_ious: 0.2649, stage1_s: 0.0000, stage1_m: 0.0190, stage1_l: 0.0710, stage1_h: 0.2868, loss: 0.2953, grad_norm: 9.8925
2024-04-19 03:10:16,043 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 03:11:43,275 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:35, time: 1.685, data_time: 0.091, memory: 17795, stage0_loss_instance_mil: 0.0108, stage0_bag_acc: 99.2619, stage0_mean_ious: 0.2399, stage0_s: 0.0000, stage0_m: 0.0324, stage0_l: 0.0885, stage0_h: 0.2578, stage1_loss_instance_mil: 0.2033, stage1_bag_acc: 99.2970, stage1_neg_loss: 0.0709, stage1_mean_ious: 0.2331, stage1_s: 0.0000, stage1_m: 0.0304, stage1_l: 0.0732, stage1_h: 0.2528, loss: 0.2850, grad_norm: 10.3229
2024-04-19 03:13:04,659 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 03:13:04,659 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:27:36, time: 1.628, data_time: 0.040, memory: 17795, stage0_loss_instance_mil: 0.0138, stage0_bag_acc: 99.4070, stage0_mean_ious: 0.2254, stage0_s: 0.0000, stage0_m: 0.0269, stage0_l: 0.1073, stage0_h: 0.2396, stage1_loss_instance_mil: 0.1891, stage1_bag_acc: 99.3972, stage1_neg_loss: 0.0658, stage1_mean_ious: 0.2123, stage1_s: 0.0000, stage1_m: 0.0205, stage1_l: 0.0902, stage1_h: 0.2279, loss: 0.2687, grad_norm: 9.0737
2024-04-19 03:14:26,591 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:26:36, time: 1.639, data_time: 0.041, memory: 17795, stage0_loss_instance_mil: 0.0157, stage0_bag_acc: 98.9821, stage0_mean_ious: 0.2663, stage0_s: 0.0000, stage0_m: 0.0309, stage0_l: 0.0849, stage0_h: 0.2906, stage1_loss_instance_mil: 0.1479, stage1_bag_acc: 99.3071, stage1_neg_loss: 0.0541, stage1_mean_ious: 0.2536, stage1_s: 0.0000, stage1_m: 0.0227, stage1_l: 0.0689, stage1_h: 0.2795, loss: 0.2177, grad_norm: 7.3889
2024-04-19 03:15:16,607 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 03:17:13,080 - mmdet - INFO - Evaluating bbox...
2024-04-19 03:17:14,950 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0237
2024-04-19 03:17:14,950 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0832
2024-04-19 03:17:14,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0428
2024-04-19 03:17:14,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0143
2024-04-19 03:17:14,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0071
2024-04-19 03:17:14,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0019
2024-04-19 03:17:14,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 03:17:14,952 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0015
2024-04-19 03:17:14,952 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0243
2024-04-19 03:17:14,952 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0386
2024-04-19 03:17:14,952 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0504
2024-04-19 03:17:14,952 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0504
2024-04-19 03:17:14,953 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0504
2024-04-19 03:17:14,953 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0462
2024-04-19 03:17:14,953 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0562
2024-04-19 03:17:14,953 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0481
2024-04-19 03:17:15,003 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 03:17:15,003 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0240, bbox_mAP_50: 0.0830, bbox_mAP_75: 0.0430, bbox_mAP_s: 0.0140, bbox_mAP_m: 0.0070, bbox_mAP_l: 0.0020, bbox_mAP_copypaste: 0.024 0.083 0.043 0.014 0.007 0.002
2024-04-19 03:18:41,867 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:15, time: 1.736, data_time: 0.103, memory: 17795, stage0_loss_instance_mil: 0.0195, stage0_bag_acc: 98.9907, stage0_mean_ious: 0.1493, stage0_s: 0.0015, stage0_m: 0.0296, stage0_l: 0.0990, stage0_h: 0.1533, stage1_loss_instance_mil: 0.1857, stage1_bag_acc: 98.8500, stage1_neg_loss: 0.0664, stage1_mean_ious: 0.1415, stage1_s: 0.0015, stage1_m: 0.0244, stage1_l: 0.0869, stage1_h: 0.1471, loss: 0.2716, grad_norm: 8.3046
2024-04-19 03:20:05,717 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:16, time: 1.677, data_time: 0.048, memory: 17795, stage0_loss_instance_mil: 0.0100, stage0_bag_acc: 99.4128, stage0_mean_ious: 0.1757, stage0_s: 0.0000, stage0_m: 0.0339, stage0_l: 0.0988, stage0_h: 0.1881, stage1_loss_instance_mil: 0.1606, stage1_bag_acc: 99.9231, stage1_neg_loss: 0.0696, stage1_mean_ious: 0.1692, stage1_s: 0.0000, stage1_m: 0.0254, stage1_l: 0.0864, stage1_h: 0.1830, loss: 0.2402, grad_norm: 8.9644
2024-04-19 03:21:29,775 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:14, time: 1.681, data_time: 0.048, memory: 17795, stage0_loss_instance_mil: 0.0135, stage0_bag_acc: 99.4563, stage0_mean_ious: 0.1595, stage0_s: 0.0000, stage0_m: 0.0460, stage0_l: 0.0848, stage0_h: 0.1666, stage1_loss_instance_mil: 0.1548, stage1_bag_acc: 99.4419, stage1_neg_loss: 0.0606, stage1_mean_ious: 0.1524, stage1_s: 0.0000, stage1_m: 0.0360, stage1_l: 0.0736, stage1_h: 0.1614, loss: 0.2289, grad_norm: 8.3022
2024-04-19 03:22:19,867 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 03:23:49,968 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:01, time: 1.741, data_time: 0.100, memory: 17795, stage0_loss_instance_mil: 0.0839, stage0_bag_acc: 95.0284, stage0_mean_ious: 0.1577, stage0_s: 0.0000, stage0_m: 0.0217, stage0_l: 0.0913, stage0_h: 0.1648, stage1_loss_instance_mil: 0.1454, stage1_bag_acc: 96.2882, stage1_neg_loss: 0.0606, stage1_mean_ious: 0.1512, stage1_s: 0.0000, stage1_m: 0.0181, stage1_l: 0.0788, stage1_h: 0.1601, loss: 0.2900, grad_norm: 10.1188
2024-04-19 03:25:14,902 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:18:59, time: 1.699, data_time: 0.043, memory: 17795, stage0_loss_instance_mil: 0.0199, stage0_bag_acc: 98.9525, stage0_mean_ious: 0.2515, stage0_s: 0.0000, stage0_m: 0.0396, stage0_l: 0.1094, stage0_h: 0.2683, stage1_loss_instance_mil: 0.1401, stage1_bag_acc: 99.6186, stage1_neg_loss: 0.0601, stage1_mean_ious: 0.2358, stage1_s: 0.0000, stage1_m: 0.0351, stage1_l: 0.1013, stage1_h: 0.2517, loss: 0.2201, grad_norm: 7.0668
2024-04-19 03:26:39,043 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:17:55, time: 1.683, data_time: 0.042, memory: 17795, stage0_loss_instance_mil: 0.0224, stage0_bag_acc: 99.1388, stage0_mean_ious: 0.2474, stage0_s: 0.0000, stage0_m: 0.0409, stage0_l: 0.1001, stage0_h: 0.2640, stage1_loss_instance_mil: 0.1229, stage1_bag_acc: 99.2274, stage1_neg_loss: 0.0532, stage1_mean_ious: 0.2352, stage1_s: 0.0000, stage1_m: 0.0356, stage1_l: 0.0919, stage1_h: 0.2513, loss: 0.1985, grad_norm: 6.6832
2024-04-19 03:27:26,895 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 03:28:58,167 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:48, time: 1.767, data_time: 0.098, memory: 17795, stage0_loss_instance_mil: 0.0072, stage0_bag_acc: 99.7571, stage0_mean_ious: 0.2498, stage0_s: 0.0000, stage0_m: 0.0597, stage0_l: 0.0967, stage0_h: 0.2670, stage1_loss_instance_mil: 0.1034, stage1_bag_acc: 99.7824, stage1_neg_loss: 0.0519, stage1_mean_ious: 0.2384, stage1_s: 0.0000, stage1_m: 0.0555, stage1_l: 0.0830, stage1_h: 0.2560, loss: 0.1626, grad_norm: 6.0511
2024-04-19 03:30:20,963 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:42, time: 1.656, data_time: 0.042, memory: 17795, stage0_loss_instance_mil: 0.0096, stage0_bag_acc: 99.5884, stage0_mean_ious: 0.2555, stage0_s: 0.0000, stage0_m: 0.0293, stage0_l: 0.1036, stage0_h: 0.2729, stage1_loss_instance_mil: 0.1092, stage1_bag_acc: 99.7836, stage1_neg_loss: 0.0490, stage1_mean_ious: 0.2436, stage1_s: 0.0000, stage1_m: 0.0307, stage1_l: 0.0932, stage1_h: 0.2609, loss: 0.1678, grad_norm: 5.6816
2024-04-19 03:31:42,752 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:35, time: 1.636, data_time: 0.041, memory: 17795, stage0_loss_instance_mil: 0.0095, stage0_bag_acc: 99.5549, stage0_mean_ious: 0.2635, stage0_s: 0.0000, stage0_m: 0.0349, stage0_l: 0.1138, stage0_h: 0.2797, stage1_loss_instance_mil: 0.0983, stage1_bag_acc: 99.5475, stage1_neg_loss: 0.0481, stage1_mean_ious: 0.2543, stage1_s: 0.0000, stage1_m: 0.0290, stage1_l: 0.1095, stage1_h: 0.2698, loss: 0.1560, grad_norm: 4.3686
2024-04-19 03:32:34,213 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 03:34:03,598 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:32, time: 1.729, data_time: 0.094, memory: 17795, stage0_loss_instance_mil: 0.0031, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.2368, stage0_s: 0.0016, stage0_m: 0.0324, stage0_l: 0.0905, stage0_h: 0.2614, stage1_loss_instance_mil: 0.1001, stage1_bag_acc: 99.9259, stage1_neg_loss: 0.0457, stage1_mean_ious: 0.2267, stage1_s: 0.0019, stage1_m: 0.0277, stage1_l: 0.0831, stage1_h: 0.2510, loss: 0.1489, grad_norm: 4.6135
2024-04-19 03:35:28,877 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:25, time: 1.706, data_time: 0.043, memory: 17795, stage0_loss_instance_mil: 0.0047, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.2361, stage0_s: 0.0000, stage0_m: 0.0342, stage0_l: 0.0982, stage0_h: 0.2526, stage1_loss_instance_mil: 0.0935, stage1_bag_acc: 99.6408, stage1_neg_loss: 0.0480, stage1_mean_ious: 0.2252, stage1_s: 0.0000, stage1_m: 0.0355, stage1_l: 0.0869, stage1_h: 0.2417, loss: 0.1462, grad_norm: 5.0914
2024-04-19 03:36:51,905 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:17, time: 1.661, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0057, stage0_bag_acc: 99.6329, stage0_mean_ious: 0.2459, stage0_s: 0.0000, stage0_m: 0.0306, stage0_l: 0.0886, stage0_h: 0.2631, stage1_loss_instance_mil: 0.1025, stage1_bag_acc: 99.8571, stage1_neg_loss: 0.0455, stage1_mean_ious: 0.2354, stage1_s: 0.0000, stage1_m: 0.0228, stage1_l: 0.0783, stage1_h: 0.2540, loss: 0.1537, grad_norm: 4.6766
2024-04-19 03:37:43,408 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 03:39:11,452 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:18, time: 1.712, data_time: 0.093, memory: 17809, stage0_loss_instance_mil: 0.0068, stage0_bag_acc: 99.6129, stage0_mean_ious: 0.2463, stage0_s: 0.0000, stage0_m: 0.0188, stage0_l: 0.0894, stage0_h: 0.2587, stage1_loss_instance_mil: 0.0971, stage1_bag_acc: 99.6464, stage1_neg_loss: 0.0465, stage1_mean_ious: 0.2341, stage1_s: 0.0000, stage1_m: 0.0198, stage1_l: 0.0817, stage1_h: 0.2458, loss: 0.1504, grad_norm: 4.7593
2024-04-19 03:40:37,623 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:09, time: 1.723, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0026, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.2353, stage0_s: 0.0013, stage0_m: 0.0422, stage0_l: 0.0930, stage0_h: 0.2529, stage1_loss_instance_mil: 0.0945, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0438, stage1_mean_ious: 0.2236, stage1_s: 0.0019, stage1_m: 0.0317, stage1_l: 0.0849, stage1_h: 0.2407, loss: 0.1409, grad_norm: 4.5088
2024-04-19 03:42:01,588 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:04:59, time: 1.679, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.8038, stage0_mean_ious: 0.2406, stage0_s: 0.0000, stage0_m: 0.0412, stage0_l: 0.0865, stage0_h: 0.2569, stage1_loss_instance_mil: 0.0964, stage1_bag_acc: 99.8038, stage1_neg_loss: 0.0472, stage1_mean_ious: 0.2286, stage1_s: 0.0000, stage1_m: 0.0405, stage1_l: 0.0791, stage1_h: 0.2439, loss: 0.1471, grad_norm: 4.8226
2024-04-19 03:42:52,390 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 03:44:22,072 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:03, time: 1.736, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0027, stage0_bag_acc: 99.9333, stage0_mean_ious: 0.2281, stage0_s: 0.0000, stage0_m: 0.0364, stage0_l: 0.0982, stage0_h: 0.2496, stage1_loss_instance_mil: 0.1033, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0409, stage1_mean_ious: 0.2201, stage1_s: 0.0000, stage1_m: 0.0333, stage1_l: 0.0917, stage1_h: 0.2417, loss: 0.1468, grad_norm: 4.6638
2024-04-19 03:45:45,644 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:53, time: 1.671, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0039, stage0_bag_acc: 99.7571, stage0_mean_ious: 0.2391, stage0_s: 0.0000, stage0_m: 0.0304, stage0_l: 0.0988, stage0_h: 0.2536, stage1_loss_instance_mil: 0.0989, stage1_bag_acc: 99.6738, stage1_neg_loss: 0.0457, stage1_mean_ious: 0.2275, stage1_s: 0.0000, stage1_m: 0.0240, stage1_l: 0.0890, stage1_h: 0.2422, loss: 0.1485, grad_norm: 5.1032
2024-04-19 03:47:12,332 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:42, time: 1.734, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0030, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.2242, stage0_s: 0.0000, stage0_m: 0.0465, stage0_l: 0.0919, stage0_h: 0.2383, stage1_loss_instance_mil: 0.1010, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0428, stage1_mean_ious: 0.2120, stage1_s: 0.0000, stage1_m: 0.0448, stage1_l: 0.0795, stage1_h: 0.2272, loss: 0.1468, grad_norm: 4.6286
2024-04-19 03:48:03,700 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 03:50:02,615 - mmdet - INFO - Evaluating bbox...
2024-04-19 03:50:04,516 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0468
2024-04-19 03:50:04,517 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1551
2024-04-19 03:50:04,517 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0863
2024-04-19 03:50:04,517 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0275
2024-04-19 03:50:04,518 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0145
2024-04-19 03:50:04,518 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0037
2024-04-19 03:50:04,518 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-04-19 03:50:04,518 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0020
2024-04-19 03:50:04,519 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0402
2024-04-19 03:50:04,519 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0941
2024-04-19 03:50:04,519 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0850
2024-04-19 03:50:04,519 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0850
2024-04-19 03:50:04,519 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0850
2024-04-19 03:50:04,519 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0434
2024-04-19 03:50:04,519 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0772
2024-04-19 03:50:04,520 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1168
2024-04-19 03:50:04,567 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 03:50:04,567 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0470, bbox_mAP_50: 0.1550, bbox_mAP_75: 0.0860, bbox_mAP_s: 0.0280, bbox_mAP_m: 0.0140, bbox_mAP_l: 0.0040, bbox_mAP_copypaste: 0.047 0.155 0.086 0.028 0.014 0.004
2024-04-19 03:51:58,115 - mmdet - INFO - Evaluating bbox...
2024-04-19 03:51:59,983 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0468
2024-04-19 03:51:59,984 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1551
2024-04-19 03:51:59,984 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0863
2024-04-19 03:51:59,984 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0275
2024-04-19 03:51:59,985 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0145
2024-04-19 03:51:59,985 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0037
2024-04-19 03:51:59,985 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-04-19 03:51:59,985 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0020
2024-04-19 03:51:59,985 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0402
2024-04-19 03:51:59,986 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0941
2024-04-19 03:51:59,986 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0850
2024-04-19 03:51:59,986 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0850
2024-04-19 03:51:59,986 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0850
2024-04-19 03:51:59,986 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0434
2024-04-19 03:51:59,986 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0772
2024-04-19 03:51:59,987 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1168
2024-04-19 03:52:02,572 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 03:52:04,796 - mmdet - INFO - Distributed training: False
2024-04-19 03:52:06,868 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 03:52:09,341 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 03:52:09,341 - mmdet - INFO - Use load_from_local loader
2024-04-19 03:52:09,707 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 03:52:09,724 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 03:52:09,725 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 03:53:37,128 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:01:28, time: 1.748, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.7222, stage0_bag_acc: 10.4092, stage0_mean_ious: 0.3588, stage0_s: 0.0000, stage0_m: 0.0582, stage0_l: 0.2027, stage0_h: 0.3700, stage1_loss_instance_mil: 0.1639, stage1_bag_acc: 16.4877, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.3536, stage1_s: 0.0000, stage1_m: 0.0621, stage1_l: 0.2068, stage1_h: 0.3631, loss: 0.8871, grad_norm: 3.3357
2024-04-19 03:55:01,588 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:00, time: 1.689, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.5857, stage0_bag_acc: 57.0633, stage0_mean_ious: 0.3246, stage0_s: 0.0000, stage0_m: 0.0521, stage0_l: 0.2065, stage0_h: 0.3397, stage1_loss_instance_mil: 0.2427, stage1_bag_acc: 28.8086, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.3216, stage1_s: 0.0000, stage1_m: 0.0542, stage1_l: 0.2140, stage1_h: 0.3351, loss: 0.8320, grad_norm: 4.0324
2024-04-19 03:56:26,822 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:57:24, time: 1.705, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.2874, stage0_bag_acc: 84.5847, stage0_mean_ious: 0.3645, stage0_s: 0.0000, stage0_m: 0.0496, stage0_l: 0.2026, stage0_h: 0.3879, stage1_loss_instance_mil: 0.2879, stage1_bag_acc: 76.9104, stage1_neg_loss: 0.0663, stage1_mean_ious: 0.3358, stage1_s: 0.0000, stage1_m: 0.0465, stage1_l: 0.1994, stage1_h: 0.3545, loss: 0.6415, grad_norm: 11.2603
2024-04-19 03:57:17,233 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 03:58:46,614 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:03, time: 1.731, data_time: 0.092, memory: 17809, stage0_loss_instance_mil: 0.0836, stage0_bag_acc: 95.2494, stage0_mean_ious: 0.3521, stage0_s: 0.0000, stage0_m: 0.0331, stage0_l: 0.1945, stage0_h: 0.3704, stage1_loss_instance_mil: 0.3124, stage1_bag_acc: 96.6552, stage1_neg_loss: 0.0824, stage1_mean_ious: 0.3278, stage1_s: 0.0000, stage1_m: 0.0274, stage1_l: 0.1778, stage1_h: 0.3443, loss: 0.4785, grad_norm: 12.5241
2024-04-19 04:00:12,074 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:01, time: 1.709, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0520, stage0_bag_acc: 97.3820, stage0_mean_ious: 0.3398, stage0_s: 0.0000, stage0_m: 0.0531, stage0_l: 0.1894, stage0_h: 0.3597, stage1_loss_instance_mil: 0.2907, stage1_bag_acc: 98.4903, stage1_neg_loss: 0.0882, stage1_mean_ious: 0.3213, stage1_s: 0.0000, stage1_m: 0.0427, stage1_l: 0.1783, stage1_h: 0.3414, loss: 0.4310, grad_norm: 13.4311
2024-04-19 04:01:35,064 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:19, time: 1.660, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0644, stage0_bag_acc: 95.6575, stage0_mean_ious: 0.3825, stage0_s: 0.0000, stage0_m: 0.0410, stage0_l: 0.1661, stage0_h: 0.4041, stage1_loss_instance_mil: 0.2646, stage1_bag_acc: 97.3958, stage1_neg_loss: 0.0782, stage1_mean_ious: 0.3663, stage1_s: 0.0000, stage1_m: 0.0298, stage1_l: 0.1559, stage1_h: 0.3879, loss: 0.4072, grad_norm: 12.8841
2024-04-19 04:02:25,771 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 04:03:54,842 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:35, time: 1.733, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0487, stage0_bag_acc: 97.3082, stage0_mean_ious: 0.3736, stage0_s: 0.0000, stage0_m: 0.0334, stage0_l: 0.1799, stage0_h: 0.3982, stage1_loss_instance_mil: 0.2381, stage1_bag_acc: 97.4293, stage1_neg_loss: 0.0808, stage1_mean_ious: 0.3609, stage1_s: 0.0000, stage1_m: 0.0212, stage1_l: 0.1635, stage1_h: 0.3879, loss: 0.3676, grad_norm: 14.4409
2024-04-19 04:05:18,441 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:01, time: 1.672, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0357, stage0_bag_acc: 98.2939, stage0_mean_ious: 0.3648, stage0_s: 0.0009, stage0_m: 0.0308, stage0_l: 0.1773, stage0_h: 0.3862, stage1_loss_instance_mil: 0.2940, stage1_bag_acc: 98.3515, stage1_neg_loss: 0.0823, stage1_mean_ious: 0.3525, stage1_s: 0.0009, stage1_m: 0.0195, stage1_l: 0.1742, stage1_h: 0.3737, loss: 0.4119, grad_norm: 15.5948
2024-04-19 04:06:42,513 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:19, time: 1.681, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0324, stage0_bag_acc: 97.8320, stage0_mean_ious: 0.3706, stage0_s: 0.0000, stage0_m: 0.0442, stage0_l: 0.2044, stage0_h: 0.3933, stage1_loss_instance_mil: 0.2480, stage1_bag_acc: 98.8911, stage1_neg_loss: 0.0819, stage1_mean_ious: 0.3434, stage1_s: 0.0000, stage1_m: 0.0388, stage1_l: 0.2036, stage1_h: 0.3629, loss: 0.3622, grad_norm: 14.1686
2024-04-19 04:07:33,508 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 04:09:00,859 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:45, time: 1.697, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0390, stage0_bag_acc: 97.8981, stage0_mean_ious: 0.3975, stage0_s: 0.0000, stage0_m: 0.0351, stage0_l: 0.1499, stage0_h: 0.4301, stage1_loss_instance_mil: 0.2078, stage1_bag_acc: 98.5334, stage1_neg_loss: 0.0648, stage1_mean_ious: 0.3762, stage1_s: 0.0000, stage1_m: 0.0209, stage1_l: 0.1447, stage1_h: 0.4074, loss: 0.3116, grad_norm: 11.3516
2024-04-19 04:10:26,937 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:06, time: 1.722, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0461, stage0_bag_acc: 97.0618, stage0_mean_ious: 0.3838, stage0_s: 0.0000, stage0_m: 0.0354, stage0_l: 0.1548, stage0_h: 0.4083, stage1_loss_instance_mil: 0.1838, stage1_bag_acc: 98.1319, stage1_neg_loss: 0.0693, stage1_mean_ious: 0.3659, stage1_s: 0.0000, stage1_m: 0.0242, stage1_l: 0.1497, stage1_h: 0.3907, loss: 0.2992, grad_norm: 12.3385
2024-04-19 04:11:52,343 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:18, time: 1.708, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0472, stage0_bag_acc: 96.8385, stage0_mean_ious: 0.3983, stage0_s: 0.0000, stage0_m: 0.0423, stage0_l: 0.1512, stage0_h: 0.4283, stage1_loss_instance_mil: 0.1705, stage1_bag_acc: 98.6319, stage1_neg_loss: 0.0564, stage1_mean_ious: 0.3814, stage1_s: 0.0000, stage1_m: 0.0312, stage1_l: 0.1395, stage1_h: 0.4111, loss: 0.2741, grad_norm: 9.6472
2024-04-19 04:12:43,855 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 04:14:13,617 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:22, time: 1.733, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0113, stage0_bag_acc: 99.3554, stage0_mean_ious: 0.3916, stage0_s: 0.0000, stage0_m: 0.0429, stage0_l: 0.1784, stage0_h: 0.4228, stage1_loss_instance_mil: 0.1752, stage1_bag_acc: 99.7221, stage1_neg_loss: 0.0628, stage1_mean_ious: 0.3690, stage1_s: 0.0000, stage1_m: 0.0282, stage1_l: 0.1720, stage1_h: 0.3992, loss: 0.2493, grad_norm: 11.0936
2024-04-19 04:15:38,315 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:31, time: 1.694, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0205, stage0_bag_acc: 98.6547, stage0_mean_ious: 0.3837, stage0_s: 0.0000, stage0_m: 0.0156, stage0_l: 0.2131, stage0_h: 0.4026, stage1_loss_instance_mil: 0.1651, stage1_bag_acc: 98.8786, stage1_neg_loss: 0.0600, stage1_mean_ious: 0.3637, stage1_s: 0.0000, stage1_m: 0.0121, stage1_l: 0.2101, stage1_h: 0.3805, loss: 0.2457, grad_norm: 9.9007
2024-04-19 04:17:02,809 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:35, time: 1.690, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0145, stage0_bag_acc: 99.4237, stage0_mean_ious: 0.3925, stage0_s: 0.0018, stage0_m: 0.0219, stage0_l: 0.1514, stage0_h: 0.4270, stage1_loss_instance_mil: 0.1738, stage1_bag_acc: 99.1586, stage1_neg_loss: 0.0601, stage1_mean_ious: 0.3758, stage1_s: 0.0016, stage1_m: 0.0138, stage1_l: 0.1482, stage1_h: 0.4080, loss: 0.2484, grad_norm: 10.8834
2024-04-19 04:17:53,682 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 04:19:23,441 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:59, time: 1.745, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0147, stage0_bag_acc: 98.9646, stage0_mean_ious: 0.3811, stage0_s: 0.0015, stage0_m: 0.0343, stage0_l: 0.1676, stage0_h: 0.4052, stage1_loss_instance_mil: 0.1421, stage1_bag_acc: 99.2010, stage1_neg_loss: 0.0594, stage1_mean_ious: 0.3614, stage1_s: 0.0015, stage1_m: 0.0214, stage1_l: 0.1591, stage1_h: 0.3846, loss: 0.2162, grad_norm: 8.9040
2024-04-19 04:20:47,101 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 04:20:47,101 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:01, time: 1.673, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0175, stage0_bag_acc: 98.7619, stage0_mean_ious: 0.3918, stage0_s: 0.0000, stage0_m: 0.0313, stage0_l: 0.1751, stage0_h: 0.4246, stage1_loss_instance_mil: 0.1397, stage1_bag_acc: 99.0707, stage1_neg_loss: 0.0573, stage1_mean_ious: 0.3720, stage1_s: 0.0000, stage1_m: 0.0195, stage1_l: 0.1662, stage1_h: 0.4037, loss: 0.2145, grad_norm: 9.5673
2024-04-19 04:22:10,697 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:00, time: 1.672, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0100, stage0_bag_acc: 99.5269, stage0_mean_ious: 0.4277, stage0_s: 0.0000, stage0_m: 0.0156, stage0_l: 0.1843, stage0_h: 0.4546, stage1_loss_instance_mil: 0.1317, stage1_bag_acc: 99.7180, stage1_neg_loss: 0.0599, stage1_mean_ious: 0.4117, stage1_s: 0.0000, stage1_m: 0.0106, stage1_l: 0.1814, stage1_h: 0.4372, loss: 0.2016, grad_norm: 9.0974
2024-04-19 04:23:00,437 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 04:24:57,886 - mmdet - INFO - Evaluating bbox...
2024-04-19 04:24:59,849 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1181
2024-04-19 04:24:59,850 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3147
2024-04-19 04:24:59,850 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2126
2024-04-19 04:24:59,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1124
2024-04-19 04:24:59,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0674
2024-04-19 04:24:59,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0315
2024-04-19 04:24:59,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0027
2024-04-19 04:24:59,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0987
2024-04-19 04:24:59,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1190
2024-04-19 04:24:59,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1428
2024-04-19 04:24:59,852 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1751
2024-04-19 04:24:59,852 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1751
2024-04-19 04:24:59,852 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1751
2024-04-19 04:24:59,853 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2484
2024-04-19 04:24:59,853 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1742
2024-04-19 04:24:59,853 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2066
2024-04-19 04:24:59,898 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 04:24:59,898 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.1180, bbox_mAP_50: 0.3150, bbox_mAP_75: 0.2130, bbox_mAP_s: 0.1120, bbox_mAP_m: 0.0670, bbox_mAP_l: 0.0320, bbox_mAP_copypaste: 0.118 0.315 0.213 0.112 0.067 0.032
2024-04-19 04:26:26,128 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:35, time: 1.724, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0078, stage0_bag_acc: 99.6944, stage0_mean_ious: 0.3895, stage0_s: 0.0000, stage0_m: 0.0218, stage0_l: 0.1782, stage0_h: 0.4194, stage1_loss_instance_mil: 0.1291, stage1_bag_acc: 99.1766, stage1_neg_loss: 0.0601, stage1_mean_ious: 0.3704, stage1_s: 0.0000, stage1_m: 0.0140, stage1_l: 0.1742, stage1_h: 0.3987, loss: 0.1969, grad_norm: 8.9744
2024-04-19 04:27:49,286 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:33, time: 1.663, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0228, stage0_bag_acc: 98.6414, stage0_mean_ious: 0.4112, stage0_s: 0.0018, stage0_m: 0.0221, stage0_l: 0.1426, stage0_h: 0.4389, stage1_loss_instance_mil: 0.1223, stage1_bag_acc: 99.2581, stage1_neg_loss: 0.0497, stage1_mean_ious: 0.3899, stage1_s: 0.0016, stage1_m: 0.0149, stage1_l: 0.1310, stage1_h: 0.4175, loss: 0.1948, grad_norm: 8.0394
2024-04-19 04:29:11,685 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:29, time: 1.648, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0104, stage0_bag_acc: 99.1910, stage0_mean_ious: 0.4283, stage0_s: 0.0000, stage0_m: 0.0481, stage0_l: 0.2038, stage0_h: 0.4565, stage1_loss_instance_mil: 0.1026, stage1_bag_acc: 99.1468, stage1_neg_loss: 0.0467, stage1_mean_ious: 0.4087, stage1_s: 0.0000, stage1_m: 0.0381, stage1_l: 0.1976, stage1_h: 0.4363, loss: 0.1597, grad_norm: 6.9741
2024-04-19 04:30:03,312 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 04:31:33,774 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:14, time: 1.749, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0068, stage0_bag_acc: 99.4744, stage0_mean_ious: 0.4124, stage0_s: 0.0000, stage0_m: 0.0215, stage0_l: 0.1539, stage0_h: 0.4401, stage1_loss_instance_mil: 0.0996, stage1_bag_acc: 99.6552, stage1_neg_loss: 0.0456, stage1_mean_ious: 0.3969, stage1_s: 0.0000, stage1_m: 0.0144, stage1_l: 0.1483, stage1_h: 0.4242, loss: 0.1520, grad_norm: 7.2204
2024-04-19 04:32:58,610 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:11, time: 1.697, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0081, stage0_bag_acc: 99.3490, stage0_mean_ious: 0.3880, stage0_s: 0.0000, stage0_m: 0.0351, stage0_l: 0.1546, stage0_h: 0.4143, stage1_loss_instance_mil: 0.1142, stage1_bag_acc: 99.3216, stage1_neg_loss: 0.0511, stage1_mean_ious: 0.3645, stage1_s: 0.0000, stage1_m: 0.0226, stage1_l: 0.1363, stage1_h: 0.3921, loss: 0.1733, grad_norm: 8.2994
2024-04-19 04:34:22,951 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:05, time: 1.687, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0140, stage0_bag_acc: 99.3921, stage0_mean_ious: 0.4177, stage0_s: 0.0019, stage0_m: 0.0322, stage0_l: 0.2461, stage0_h: 0.4359, stage1_loss_instance_mil: 0.1063, stage1_bag_acc: 99.3223, stage1_neg_loss: 0.0428, stage1_mean_ious: 0.4037, stage1_s: 0.0016, stage1_m: 0.0234, stage1_l: 0.2312, stage1_h: 0.4229, loss: 0.1630, grad_norm: 6.6171
2024-04-19 04:35:11,243 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 04:36:41,980 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:57, time: 1.754, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0113, stage0_bag_acc: 99.5692, stage0_mean_ious: 0.4049, stage0_s: 0.0000, stage0_m: 0.0356, stage0_l: 0.1999, stage0_h: 0.4242, stage1_loss_instance_mil: 0.0918, stage1_bag_acc: 99.6248, stage1_neg_loss: 0.0299, stage1_mean_ious: 0.3878, stage1_s: 0.0000, stage1_m: 0.0271, stage1_l: 0.1928, stage1_h: 0.4070, loss: 0.1330, grad_norm: 4.9047
2024-04-19 04:38:03,644 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:50, time: 1.633, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0075, stage0_bag_acc: 99.7178, stage0_mean_ious: 0.3969, stage0_s: 0.0000, stage0_m: 0.0328, stage0_l: 0.1857, stage0_h: 0.4368, stage1_loss_instance_mil: 0.0767, stage1_bag_acc: 99.7345, stage1_neg_loss: 0.0386, stage1_mean_ious: 0.3814, stage1_s: 0.0000, stage1_m: 0.0246, stage1_l: 0.1815, stage1_h: 0.4205, loss: 0.1228, grad_norm: 5.0275
2024-04-19 04:39:25,929 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:42, time: 1.646, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0033, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.4025, stage0_s: 0.0000, stage0_m: 0.0219, stage0_l: 0.1797, stage0_h: 0.4196, stage1_loss_instance_mil: 0.0893, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0388, stage1_mean_ious: 0.3878, stage1_s: 0.0000, stage1_m: 0.0155, stage1_l: 0.1755, stage1_h: 0.4044, loss: 0.1314, grad_norm: 4.9403
2024-04-19 04:40:15,930 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 04:41:43,672 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:37, time: 1.703, data_time: 0.092, memory: 17809, stage0_loss_instance_mil: 0.0074, stage0_bag_acc: 99.7574, stage0_mean_ious: 0.4042, stage0_s: 0.0000, stage0_m: 0.0288, stage0_l: 0.1748, stage0_h: 0.4349, stage1_loss_instance_mil: 0.0742, stage1_bag_acc: 99.7574, stage1_neg_loss: 0.0410, stage1_mean_ious: 0.3949, stage1_s: 0.0000, stage1_m: 0.0209, stage1_l: 0.1756, stage1_h: 0.4254, loss: 0.1226, grad_norm: 4.9532
2024-04-19 04:43:06,201 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:29, time: 1.651, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0031, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.3917, stage0_s: 0.0000, stage0_m: 0.0343, stage0_l: 0.2284, stage0_h: 0.4176, stage1_loss_instance_mil: 0.0809, stage1_bag_acc: 99.9259, stage1_neg_loss: 0.0381, stage1_mean_ious: 0.3716, stage1_s: 0.0000, stage1_m: 0.0250, stage1_l: 0.2299, stage1_h: 0.3964, loss: 0.1220, grad_norm: 5.6774
2024-04-19 04:44:31,740 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:21, time: 1.711, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.3855, stage0_s: 0.0000, stage0_m: 0.0285, stage0_l: 0.1593, stage0_h: 0.4163, stage1_loss_instance_mil: 0.0799, stage1_bag_acc: 99.7867, stage1_neg_loss: 0.0413, stage1_mean_ious: 0.3672, stage1_s: 0.0000, stage1_m: 0.0193, stage1_l: 0.1427, stage1_h: 0.3986, loss: 0.1247, grad_norm: 5.0767
2024-04-19 04:45:22,898 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 04:46:53,968 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:21, time: 1.761, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0029, stage0_bag_acc: 99.9130, stage0_mean_ious: 0.4009, stage0_s: 0.0000, stage0_m: 0.0335, stage0_l: 0.2328, stage0_h: 0.4248, stage1_loss_instance_mil: 0.0830, stage1_bag_acc: 99.8667, stage1_neg_loss: 0.0394, stage1_mean_ious: 0.3850, stage1_s: 0.0000, stage1_m: 0.0201, stage1_l: 0.2427, stage1_h: 0.4065, loss: 0.1253, grad_norm: 5.0500
2024-04-19 04:48:19,879 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:12, time: 1.718, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0044, stage0_bag_acc: 99.8095, stage0_mean_ious: 0.3865, stage0_s: 0.0000, stage0_m: 0.0266, stage0_l: 0.1932, stage0_h: 0.4148, stage1_loss_instance_mil: 0.0867, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0402, stage1_mean_ious: 0.3666, stage1_s: 0.0000, stage1_m: 0.0162, stage1_l: 0.1832, stage1_h: 0.3944, loss: 0.1313, grad_norm: 5.2646
2024-04-19 04:49:43,061 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:01, time: 1.664, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0027, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4050, stage0_s: 0.0000, stage0_m: 0.0166, stage0_l: 0.2226, stage0_h: 0.4250, stage1_loss_instance_mil: 0.0789, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0346, stage1_mean_ious: 0.3937, stage1_s: 0.0000, stage1_m: 0.0096, stage1_l: 0.2234, stage1_h: 0.4111, loss: 0.1162, grad_norm: 4.8508
2024-04-19 04:50:33,648 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 04:52:03,022 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:05, time: 1.726, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0057, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.3994, stage0_s: 0.0000, stage0_m: 0.0308, stage0_l: 0.2098, stage0_h: 0.4195, stage1_loss_instance_mil: 0.0815, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0343, stage1_mean_ious: 0.3895, stage1_s: 0.0000, stage1_m: 0.0196, stage1_l: 0.2199, stage1_h: 0.4088, loss: 0.1216, grad_norm: 4.7839
2024-04-19 04:53:27,470 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:54, time: 1.689, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0036, stage0_bag_acc: 99.7836, stage0_mean_ious: 0.3884, stage0_s: 0.0000, stage0_m: 0.0449, stage0_l: 0.1709, stage0_h: 0.4170, stage1_loss_instance_mil: 0.0826, stage1_bag_acc: 99.7175, stage1_neg_loss: 0.0390, stage1_mean_ious: 0.3788, stage1_s: 0.0000, stage1_m: 0.0317, stage1_l: 0.1523, stage1_h: 0.4108, loss: 0.1253, grad_norm: 5.1401
2024-04-19 04:54:52,364 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:43, time: 1.698, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0022, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3896, stage0_s: 0.0000, stage0_m: 0.0431, stage0_l: 0.1867, stage0_h: 0.4221, stage1_loss_instance_mil: 0.0757, stage1_bag_acc: 99.8947, stage1_neg_loss: 0.0346, stage1_mean_ious: 0.3741, stage1_s: 0.0000, stage1_m: 0.0331, stage1_l: 0.1767, stage1_h: 0.4061, loss: 0.1125, grad_norm: 4.3815
2024-04-19 04:55:43,415 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 04:57:44,790 - mmdet - INFO - Evaluating bbox...
2024-04-19 04:57:46,934 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1266
2024-04-19 04:57:46,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3328
2024-04-19 04:57:46,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2283
2024-04-19 04:57:46,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1289
2024-04-19 04:57:46,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0743
2024-04-19 04:57:46,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0323
2024-04-19 04:57:46,936 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0027
2024-04-19 04:57:46,936 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0887
2024-04-19 04:57:46,936 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1279
2024-04-19 04:57:46,936 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1463
2024-04-19 04:57:46,937 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1794
2024-04-19 04:57:46,937 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1794
2024-04-19 04:57:46,937 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1794
2024-04-19 04:57:46,937 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1513
2024-04-19 04:57:46,937 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1767
2024-04-19 04:57:46,937 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2026
2024-04-19 04:57:46,992 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 04:57:46,993 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.1270, bbox_mAP_50: 0.3330, bbox_mAP_75: 0.2280, bbox_mAP_s: 0.1290, bbox_mAP_m: 0.0740, bbox_mAP_l: 0.0320, bbox_mAP_copypaste: 0.127 0.333 0.228 0.129 0.074 0.032
2024-04-19 04:59:48,057 - mmdet - INFO - Evaluating bbox...
2024-04-19 04:59:49,829 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1266
2024-04-19 04:59:49,829 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3328
2024-04-19 04:59:49,829 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2283
2024-04-19 04:59:49,830 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1289
2024-04-19 04:59:49,830 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0743
2024-04-19 04:59:49,830 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0323
2024-04-19 04:59:49,831 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0027
2024-04-19 04:59:49,831 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0887
2024-04-19 04:59:49,831 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1279
2024-04-19 04:59:49,831 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1463
2024-04-19 04:59:49,832 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1794
2024-04-19 04:59:49,832 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1794
2024-04-19 04:59:49,832 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1794
2024-04-19 04:59:49,832 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1513
2024-04-19 04:59:49,832 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1767
2024-04-19 04:59:49,832 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2026
2024-04-19 04:59:52,650 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 04:59:54,781 - mmdet - INFO - Distributed training: False
2024-04-19 04:59:56,898 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 04:59:59,337 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 04:59:59,337 - mmdet - INFO - Use load_from_local loader
2024-04-19 04:59:59,718 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 04:59:59,737 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 04:59:59,737 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 05:01:26,886 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:01:17, time: 1.743, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.7339, stage0_bag_acc: 12.6871, stage0_mean_ious: 0.3226, stage0_s: 0.0000, stage0_m: 0.0603, stage0_l: 0.2997, stage0_h: 0.3200, stage1_loss_instance_mil: 0.1554, stage1_bag_acc: 20.2636, stage1_neg_loss: 0.0012, stage1_mean_ious: 0.3043, stage1_s: 0.0000, stage1_m: 0.0615, stage1_l: 0.2814, stage1_h: 0.3014, loss: 0.8905, grad_norm: 3.0714
2024-04-19 05:02:50,404 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:58:35, time: 1.670, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.6083, stage0_bag_acc: 45.3881, stage0_mean_ious: 0.3494, stage0_s: 0.0000, stage0_m: 0.0904, stage0_l: 0.2586, stage0_h: 0.3472, stage1_loss_instance_mil: 0.2046, stage1_bag_acc: 29.3488, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.3318, stage1_s: 0.0000, stage1_m: 0.0754, stage1_l: 0.2470, stage1_h: 0.3304, loss: 0.8187, grad_norm: 3.3872
2024-04-19 05:04:15,220 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:57:03, time: 1.696, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.2770, stage0_bag_acc: 89.5877, stage0_mean_ious: 0.4154, stage0_s: 0.0000, stage0_m: 0.0452, stage0_l: 0.2255, stage0_h: 0.4354, stage1_loss_instance_mil: 0.2969, stage1_bag_acc: 84.6285, stage1_neg_loss: 0.0669, stage1_mean_ious: 0.3797, stage1_s: 0.0000, stage1_m: 0.0342, stage1_l: 0.1903, stage1_h: 0.4001, loss: 0.6408, grad_norm: 10.5738
2024-04-19 05:05:05,244 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 05:06:35,620 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:47:57, time: 1.749, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0721, stage0_bag_acc: 96.8378, stage0_mean_ious: 0.4019, stage0_s: 0.0000, stage0_m: 0.0178, stage0_l: 0.1863, stage0_h: 0.4213, stage1_loss_instance_mil: 0.3469, stage1_bag_acc: 97.4253, stage1_neg_loss: 0.0999, stage1_mean_ious: 0.3808, stage1_s: 0.0000, stage1_m: 0.0131, stage1_l: 0.1648, stage1_h: 0.4021, loss: 0.5189, grad_norm: 16.4565
2024-04-19 05:08:00,427 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:51, time: 1.696, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0624, stage0_bag_acc: 96.1065, stage0_mean_ious: 0.3522, stage0_s: 0.0018, stage0_m: 0.0543, stage0_l: 0.1855, stage0_h: 0.3681, stage1_loss_instance_mil: 0.3456, stage1_bag_acc: 96.5549, stage1_neg_loss: 0.0996, stage1_mean_ious: 0.3351, stage1_s: 0.0016, stage1_m: 0.0401, stage1_l: 0.1740, stage1_h: 0.3531, loss: 0.5076, grad_norm: 17.0940
2024-04-19 05:09:25,439 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:23, time: 1.700, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0495, stage0_bag_acc: 97.2647, stage0_mean_ious: 0.3149, stage0_s: 0.0000, stage0_m: 0.0519, stage0_l: 0.1307, stage0_h: 0.3314, stage1_loss_instance_mil: 0.3332, stage1_bag_acc: 97.5948, stage1_neg_loss: 0.1147, stage1_mean_ious: 0.2931, stage1_s: 0.0000, stage1_m: 0.0489, stage1_l: 0.1253, stage1_h: 0.3091, loss: 0.4974, grad_norm: 21.7977
2024-04-19 05:10:17,023 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 05:11:48,425 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:45, time: 1.769, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0309, stage0_bag_acc: 98.4210, stage0_mean_ious: 0.3454, stage0_s: 0.0000, stage0_m: 0.0287, stage0_l: 0.1504, stage0_h: 0.3666, stage1_loss_instance_mil: 0.2967, stage1_bag_acc: 99.1247, stage1_neg_loss: 0.0916, stage1_mean_ious: 0.3022, stage1_s: 0.0000, stage1_m: 0.0244, stage1_l: 0.1390, stage1_h: 0.3204, loss: 0.4192, grad_norm: 16.4707
2024-04-19 05:13:12,573 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:12, time: 1.683, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0481, stage0_bag_acc: 97.2465, stage0_mean_ious: 0.3521, stage0_s: 0.0000, stage0_m: 0.0374, stage0_l: 0.1546, stage0_h: 0.3756, stage1_loss_instance_mil: 0.2820, stage1_bag_acc: 98.2356, stage1_neg_loss: 0.0886, stage1_mean_ious: 0.3057, stage1_s: 0.0000, stage1_m: 0.0229, stage1_l: 0.1253, stage1_h: 0.3279, loss: 0.4187, grad_norm: 15.7582
2024-04-19 05:14:37,339 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:31, time: 1.695, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0328, stage0_bag_acc: 97.4494, stage0_mean_ious: 0.3541, stage0_s: 0.0015, stage0_m: 0.0268, stage0_l: 0.1458, stage0_h: 0.3847, stage1_loss_instance_mil: 0.2358, stage1_bag_acc: 98.6566, stage1_neg_loss: 0.0924, stage1_mean_ious: 0.3110, stage1_s: 0.0015, stage1_m: 0.0201, stage1_l: 0.1214, stage1_h: 0.3399, loss: 0.3611, grad_norm: 17.1076
2024-04-19 05:15:27,591 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 05:16:57,818 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:02, time: 1.755, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0265, stage0_bag_acc: 98.2763, stage0_mean_ious: 0.3464, stage0_s: 0.0000, stage0_m: 0.0209, stage0_l: 0.1254, stage0_h: 0.3697, stage1_loss_instance_mil: 0.2469, stage1_bag_acc: 99.5012, stage1_neg_loss: 0.0784, stage1_mean_ious: 0.3029, stage1_s: 0.0000, stage1_m: 0.0134, stage1_l: 0.1117, stage1_h: 0.3230, loss: 0.3518, grad_norm: 13.9907
2024-04-19 05:18:22,850 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:19, time: 1.701, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0250, stage0_bag_acc: 98.4031, stage0_mean_ious: 0.3172, stage0_s: 0.0000, stage0_m: 0.0193, stage0_l: 0.1247, stage0_h: 0.3430, stage1_loss_instance_mil: 0.2155, stage1_bag_acc: 99.3962, stage1_neg_loss: 0.0801, stage1_mean_ious: 0.2771, stage1_s: 0.0000, stage1_m: 0.0130, stage1_l: 0.1092, stage1_h: 0.3002, loss: 0.3206, grad_norm: 14.6075
2024-04-19 05:19:49,064 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:32, time: 1.724, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0262, stage0_bag_acc: 98.8054, stage0_mean_ious: 0.3604, stage0_s: 0.0000, stage0_m: 0.0415, stage0_l: 0.1387, stage0_h: 0.3924, stage1_loss_instance_mil: 0.2014, stage1_bag_acc: 99.0650, stage1_neg_loss: 0.0756, stage1_mean_ious: 0.3124, stage1_s: 0.0000, stage1_m: 0.0350, stage1_l: 0.1229, stage1_h: 0.3405, loss: 0.3031, grad_norm: 12.8752
2024-04-19 05:20:38,235 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 05:22:10,563 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:38, time: 1.787, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0120, stage0_bag_acc: 99.5981, stage0_mean_ious: 0.3123, stage0_s: 0.0016, stage0_m: 0.0420, stage0_l: 0.0863, stage0_h: 0.3372, stage1_loss_instance_mil: 0.1793, stage1_bag_acc: 99.3639, stage1_neg_loss: 0.0726, stage1_mean_ious: 0.2698, stage1_s: 0.0016, stage1_m: 0.0266, stage1_l: 0.0695, stage1_h: 0.2934, loss: 0.2640, grad_norm: 11.7140
2024-04-19 05:23:33,118 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:42, time: 1.651, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0184, stage0_bag_acc: 98.9445, stage0_mean_ious: 0.3129, stage0_s: 0.0000, stage0_m: 0.0395, stage0_l: 0.0978, stage0_h: 0.3372, stage1_loss_instance_mil: 0.1726, stage1_bag_acc: 99.7291, stage1_neg_loss: 0.0706, stage1_mean_ious: 0.2733, stage1_s: 0.0000, stage1_m: 0.0269, stage1_l: 0.0807, stage1_h: 0.2962, loss: 0.2615, grad_norm: 11.1378
2024-04-19 05:24:58,142 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:46, time: 1.700, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0199, stage0_bag_acc: 99.1745, stage0_mean_ious: 0.3395, stage0_s: 0.0000, stage0_m: 0.0256, stage0_l: 0.1115, stage0_h: 0.3664, stage1_loss_instance_mil: 0.1800, stage1_bag_acc: 99.1096, stage1_neg_loss: 0.0661, stage1_mean_ious: 0.3003, stage1_s: 0.0000, stage1_m: 0.0173, stage1_l: 0.0897, stage1_h: 0.3264, loss: 0.2661, grad_norm: 11.0497
2024-04-19 05:25:48,987 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 05:27:18,788 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:08, time: 1.737, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0202, stage0_bag_acc: 98.7507, stage0_mean_ious: 0.3003, stage0_s: 0.0000, stage0_m: 0.0468, stage0_l: 0.1106, stage0_h: 0.3283, stage1_loss_instance_mil: 0.1673, stage1_bag_acc: 98.9356, stage1_neg_loss: 0.0610, stage1_mean_ious: 0.2635, stage1_s: 0.0000, stage1_m: 0.0323, stage1_l: 0.0882, stage1_h: 0.2900, loss: 0.2485, grad_norm: 9.7822
2024-04-19 05:28:41,889 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 05:28:41,890 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:08, time: 1.662, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0144, stage0_bag_acc: 99.0885, stage0_mean_ious: 0.3395, stage0_s: 0.0000, stage0_m: 0.0381, stage0_l: 0.1186, stage0_h: 0.3693, stage1_loss_instance_mil: 0.1890, stage1_bag_acc: 99.5892, stage1_neg_loss: 0.0695, stage1_mean_ious: 0.3053, stage1_s: 0.0000, stage1_m: 0.0258, stage1_l: 0.0970, stage1_h: 0.3345, loss: 0.2728, grad_norm: 13.0391
2024-04-19 05:30:06,851 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:08, time: 1.699, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0227, stage0_bag_acc: 98.9380, stage0_mean_ious: 0.3538, stage0_s: 0.0000, stage0_m: 0.0318, stage0_l: 0.1027, stage0_h: 0.3833, stage1_loss_instance_mil: 0.1432, stage1_bag_acc: 98.9249, stage1_neg_loss: 0.0579, stage1_mean_ious: 0.3152, stage1_s: 0.0000, stage1_m: 0.0218, stage1_l: 0.0959, stage1_h: 0.3427, loss: 0.2238, grad_norm: 8.3029
2024-04-19 05:30:55,827 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 05:32:55,892 - mmdet - INFO - Evaluating bbox...
2024-04-19 05:32:57,740 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0312
2024-04-19 05:32:57,740 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1296
2024-04-19 05:32:57,740 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0535
2024-04-19 05:32:57,740 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0103
2024-04-19 05:32:57,740 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0033
2024-04-19 05:32:57,741 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0006
2024-04-19 05:32:57,741 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-04-19 05:32:57,741 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0005
2024-04-19 05:32:57,741 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0353
2024-04-19 05:32:57,742 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0437
2024-04-19 05:32:57,742 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0792
2024-04-19 05:32:57,742 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0792
2024-04-19 05:32:57,742 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0792
2024-04-19 05:32:57,742 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0057
2024-04-19 05:32:57,742 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1035
2024-04-19 05:32:57,742 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0650
2024-04-19 05:32:57,785 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 05:32:57,785 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0310, bbox_mAP_50: 0.1300, bbox_mAP_75: 0.0530, bbox_mAP_s: 0.0100, bbox_mAP_m: 0.0030, bbox_mAP_l: 0.0010, bbox_mAP_copypaste: 0.031 0.130 0.053 0.010 0.003 0.001
2024-04-19 05:34:23,934 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:43, time: 1.722, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0166, stage0_bag_acc: 99.3062, stage0_mean_ious: 0.3209, stage0_s: 0.0000, stage0_m: 0.0184, stage0_l: 0.0939, stage0_h: 0.3517, stage1_loss_instance_mil: 0.1607, stage1_bag_acc: 99.0315, stage1_neg_loss: 0.0687, stage1_mean_ious: 0.2860, stage1_s: 0.0000, stage1_m: 0.0106, stage1_l: 0.0759, stage1_h: 0.3142, loss: 0.2460, grad_norm: 11.5959
2024-04-19 05:35:45,803 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:39, time: 1.637, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0113, stage0_bag_acc: 99.2035, stage0_mean_ious: 0.3139, stage0_s: 0.0000, stage0_m: 0.0361, stage0_l: 0.0994, stage0_h: 0.3445, stage1_loss_instance_mil: 0.1243, stage1_bag_acc: 99.3840, stage1_neg_loss: 0.0553, stage1_mean_ious: 0.2805, stage1_s: 0.0000, stage1_m: 0.0293, stage1_l: 0.0782, stage1_h: 0.3104, loss: 0.1909, grad_norm: 7.6926
2024-04-19 05:37:10,724 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:36, time: 1.698, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0187, stage0_bag_acc: 98.9708, stage0_mean_ious: 0.3512, stage0_s: 0.0000, stage0_m: 0.0286, stage0_l: 0.0833, stage0_h: 0.3779, stage1_loss_instance_mil: 0.1422, stage1_bag_acc: 99.0702, stage1_neg_loss: 0.0616, stage1_mean_ious: 0.3166, stage1_s: 0.0000, stage1_m: 0.0188, stage1_l: 0.0676, stage1_h: 0.3421, loss: 0.2225, grad_norm: 10.8484
2024-04-19 05:38:00,984 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 05:39:29,961 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:20, time: 1.729, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0163, stage0_bag_acc: 98.9992, stage0_mean_ious: 0.3455, stage0_s: 0.0000, stage0_m: 0.0313, stage0_l: 0.0938, stage0_h: 0.3696, stage1_loss_instance_mil: 0.1335, stage1_bag_acc: 99.2173, stage1_neg_loss: 0.0585, stage1_mean_ious: 0.3106, stage1_s: 0.0000, stage1_m: 0.0204, stage1_l: 0.0813, stage1_h: 0.3341, loss: 0.2083, grad_norm: 8.7978
2024-04-19 05:40:53,012 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:14, time: 1.661, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0113, stage0_bag_acc: 99.4614, stage0_mean_ious: 0.3320, stage0_s: 0.0000, stage0_m: 0.0236, stage0_l: 0.1049, stage0_h: 0.3607, stage1_loss_instance_mil: 0.1362, stage1_bag_acc: 99.7889, stage1_neg_loss: 0.0579, stage1_mean_ious: 0.2951, stage1_s: 0.0000, stage1_m: 0.0128, stage1_l: 0.0852, stage1_h: 0.3226, loss: 0.2055, grad_norm: 9.5393
2024-04-19 05:42:17,628 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:09, time: 1.692, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0160, stage0_bag_acc: 99.1995, stage0_mean_ious: 0.3101, stage0_s: 0.0000, stage0_m: 0.0267, stage0_l: 0.0913, stage0_h: 0.3344, stage1_loss_instance_mil: 0.1318, stage1_bag_acc: 99.3081, stage1_neg_loss: 0.0543, stage1_mean_ious: 0.2818, stage1_s: 0.0000, stage1_m: 0.0197, stage1_l: 0.0727, stage1_h: 0.3058, loss: 0.2021, grad_norm: 8.7658
2024-04-19 05:43:08,560 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 05:44:38,244 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:00, time: 1.745, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0070, stage0_bag_acc: 99.5282, stage0_mean_ious: 0.3162, stage0_s: 0.0000, stage0_m: 0.0144, stage0_l: 0.1059, stage0_h: 0.3447, stage1_loss_instance_mil: 0.1087, stage1_bag_acc: 99.8259, stage1_neg_loss: 0.0512, stage1_mean_ious: 0.2986, stage1_s: 0.0000, stage1_m: 0.0094, stage1_l: 0.0940, stage1_h: 0.3272, loss: 0.1669, grad_norm: 5.7053
2024-04-19 05:46:01,626 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:53, time: 1.668, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0063, stage0_bag_acc: 99.6725, stage0_mean_ious: 0.3026, stage0_s: 0.0000, stage0_m: 0.0261, stage0_l: 0.0990, stage0_h: 0.3356, stage1_loss_instance_mil: 0.1008, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0479, stage1_mean_ious: 0.2845, stage1_s: 0.0000, stage1_m: 0.0165, stage1_l: 0.0767, stage1_h: 0.3196, loss: 0.1550, grad_norm: 5.0913
2024-04-19 05:47:23,385 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:44, time: 1.635, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0131, stage0_bag_acc: 99.4424, stage0_mean_ious: 0.3226, stage0_s: 0.0000, stage0_m: 0.0283, stage0_l: 0.0972, stage0_h: 0.3531, stage1_loss_instance_mil: 0.1031, stage1_bag_acc: 99.6424, stage1_neg_loss: 0.0507, stage1_mean_ious: 0.3021, stage1_s: 0.0000, stage1_m: 0.0191, stage1_l: 0.0803, stage1_h: 0.3329, loss: 0.1669, grad_norm: 6.1039
2024-04-19 05:48:14,831 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 05:49:41,856 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:39, time: 1.682, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0021, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3183, stage0_s: 0.0000, stage0_m: 0.0288, stage0_l: 0.0970, stage0_h: 0.3446, stage1_loss_instance_mil: 0.1025, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0461, stage1_mean_ious: 0.2966, stage1_s: 0.0000, stage1_m: 0.0214, stage1_l: 0.0830, stage1_h: 0.3234, loss: 0.1507, grad_norm: 5.3397
2024-04-19 05:51:06,299 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:31, time: 1.689, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0050, stage0_bag_acc: 99.7043, stage0_mean_ious: 0.3033, stage0_s: 0.0000, stage0_m: 0.0197, stage0_l: 0.0821, stage0_h: 0.3302, stage1_loss_instance_mil: 0.0977, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0485, stage1_mean_ious: 0.2811, stage1_s: 0.0000, stage1_m: 0.0150, stage1_l: 0.0722, stage1_h: 0.3070, loss: 0.1512, grad_norm: 5.0897
2024-04-19 05:52:31,397 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:22, time: 1.702, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0053, stage0_bag_acc: 99.6298, stage0_mean_ious: 0.2995, stage0_s: 0.0000, stage0_m: 0.0173, stage0_l: 0.0844, stage0_h: 0.3333, stage1_loss_instance_mil: 0.0935, stage1_bag_acc: 99.7350, stage1_neg_loss: 0.0468, stage1_mean_ious: 0.2754, stage1_s: 0.0000, stage1_m: 0.0148, stage1_l: 0.0705, stage1_h: 0.3077, loss: 0.1456, grad_norm: 5.3542
2024-04-19 05:53:21,472 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 05:54:52,159 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:22, time: 1.753, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0049, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.3252, stage0_s: 0.0000, stage0_m: 0.0230, stage0_l: 0.0722, stage0_h: 0.3458, stage1_loss_instance_mil: 0.0971, stage1_bag_acc: 99.8824, stage1_neg_loss: 0.0468, stage1_mean_ious: 0.3029, stage1_s: 0.0000, stage1_m: 0.0144, stage1_l: 0.0613, stage1_h: 0.3238, loss: 0.1488, grad_norm: 5.3204
2024-04-19 05:56:15,619 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:12, time: 1.669, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 99.7750, stage0_mean_ious: 0.3169, stage0_s: 0.0000, stage0_m: 0.0140, stage0_l: 0.0720, stage0_h: 0.3458, stage1_loss_instance_mil: 0.0933, stage1_bag_acc: 99.7120, stage1_neg_loss: 0.0456, stage1_mean_ious: 0.2933, stage1_s: 0.0000, stage1_m: 0.0087, stage1_l: 0.0638, stage1_h: 0.3210, loss: 0.1417, grad_norm: 4.6735
2024-04-19 05:57:37,679 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:02, time: 1.641, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0052, stage0_bag_acc: 99.6871, stage0_mean_ious: 0.2657, stage0_s: 0.0000, stage0_m: 0.0415, stage0_l: 0.1072, stage0_h: 0.2973, stage1_loss_instance_mil: 0.1038, stage1_bag_acc: 99.9167, stage1_neg_loss: 0.0488, stage1_mean_ious: 0.2469, stage1_s: 0.0000, stage1_m: 0.0329, stage1_l: 0.0892, stage1_h: 0.2786, loss: 0.1578, grad_norm: 5.6048
2024-04-19 05:58:27,163 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 05:59:54,523 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:05, time: 1.688, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0037, stage0_bag_acc: 99.7980, stage0_mean_ious: 0.3019, stage0_s: 0.0000, stage0_m: 0.0419, stage0_l: 0.0946, stage0_h: 0.3337, stage1_loss_instance_mil: 0.0973, stage1_bag_acc: 99.7980, stage1_neg_loss: 0.0457, stage1_mean_ious: 0.2795, stage1_s: 0.0000, stage1_m: 0.0319, stage1_l: 0.0753, stage1_h: 0.3118, loss: 0.1467, grad_norm: 5.2166
2024-04-19 06:01:16,246 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:54, time: 1.634, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0052, stage0_bag_acc: 99.7083, stage0_mean_ious: 0.2884, stage0_s: 0.0000, stage0_m: 0.0231, stage0_l: 0.0933, stage0_h: 0.3137, stage1_loss_instance_mil: 0.0914, stage1_bag_acc: 99.9167, stage1_neg_loss: 0.0480, stage1_mean_ious: 0.2710, stage1_s: 0.0000, stage1_m: 0.0157, stage1_l: 0.0835, stage1_h: 0.2960, loss: 0.1446, grad_norm: 5.1840
2024-04-19 06:02:39,837 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:43, time: 1.672, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0073, stage0_bag_acc: 99.7738, stage0_mean_ious: 0.2743, stage0_s: 0.0000, stage0_m: 0.0302, stage0_l: 0.0880, stage0_h: 0.2935, stage1_loss_instance_mil: 0.1031, stage1_bag_acc: 99.8571, stage1_neg_loss: 0.0502, stage1_mean_ious: 0.2591, stage1_s: 0.0000, stage1_m: 0.0207, stage1_l: 0.0722, stage1_h: 0.2797, loss: 0.1606, grad_norm: 5.9967
2024-04-19 06:03:29,839 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 06:05:28,641 - mmdet - INFO - Evaluating bbox...
2024-04-19 06:05:30,546 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0307
2024-04-19 06:05:30,546 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1278
2024-04-19 06:05:30,546 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0492
2024-04-19 06:05:30,547 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0112
2024-04-19 06:05:30,547 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0044
2024-04-19 06:05:30,547 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0006
2024-04-19 06:05:30,547 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 06:05:30,547 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-04-19 06:05:30,548 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0310
2024-04-19 06:05:30,548 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0716
2024-04-19 06:05:30,548 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0770
2024-04-19 06:05:30,548 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0770
2024-04-19 06:05:30,548 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0770
2024-04-19 06:05:30,549 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0028
2024-04-19 06:05:30,549 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0870
2024-04-19 06:05:30,549 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0954
2024-04-19 06:05:30,595 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 06:05:30,595 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0310, bbox_mAP_50: 0.1280, bbox_mAP_75: 0.0490, bbox_mAP_s: 0.0110, bbox_mAP_m: 0.0040, bbox_mAP_l: 0.0010, bbox_mAP_copypaste: 0.031 0.128 0.049 0.011 0.004 0.001
2024-04-19 06:07:31,949 - mmdet - INFO - Evaluating bbox...
2024-04-19 06:07:33,822 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0307
2024-04-19 06:07:33,822 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1278
2024-04-19 06:07:33,823 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0492
2024-04-19 06:07:33,823 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0112
2024-04-19 06:07:33,823 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0044
2024-04-19 06:07:33,823 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0006
2024-04-19 06:07:33,823 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 06:07:33,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-04-19 06:07:33,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0310
2024-04-19 06:07:33,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0716
2024-04-19 06:07:33,824 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0770
2024-04-19 06:07:33,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0770
2024-04-19 06:07:33,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0770
2024-04-19 06:07:33,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0028
2024-04-19 06:07:33,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0870
2024-04-19 06:07:33,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0954
2024-04-19 06:07:36,487 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 06:07:38,610 - mmdet - INFO - Distributed training: False
2024-04-19 06:07:40,793 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 06:07:43,257 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 06:07:43,257 - mmdet - INFO - Use load_from_local loader
2024-04-19 06:07:43,625 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 06:07:43,642 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 06:07:43,643 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 06:09:07,933 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 0:59:16, time: 1.686, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.6932, stage0_bag_acc: 23.6956, stage0_mean_ious: 0.2927, stage0_s: 0.0000, stage0_m: 0.0201, stage0_l: 0.1853, stage0_h: 0.3025, stage1_loss_instance_mil: 0.1770, stage1_bag_acc: 28.6903, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.2859, stage1_s: 0.0000, stage1_m: 0.0207, stage1_l: 0.1867, stage1_h: 0.2943, loss: 0.8721, grad_norm: 3.4477
2024-04-19 06:10:32,206 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:57:52, time: 1.685, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.5671, stage0_bag_acc: 67.3415, stage0_mean_ious: 0.3694, stage0_s: 0.0000, stage0_m: 0.0224, stage0_l: 0.2388, stage0_h: 0.3895, stage1_loss_instance_mil: 0.2382, stage1_bag_acc: 27.1287, stage1_neg_loss: 0.0095, stage1_mean_ious: 0.3471, stage1_s: 0.0000, stage1_m: 0.0265, stage1_l: 0.2351, stage1_h: 0.3641, loss: 0.8148, grad_norm: 4.6487
2024-04-19 06:11:57,760 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:56:45, time: 1.711, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.2274, stage0_bag_acc: 92.5388, stage0_mean_ious: 0.4223, stage0_s: 0.0000, stage0_m: 0.0548, stage0_l: 0.2608, stage0_h: 0.4429, stage1_loss_instance_mil: 0.3693, stage1_bag_acc: 79.3782, stage1_neg_loss: 0.0896, stage1_mean_ious: 0.3981, stage1_s: 0.0000, stage1_m: 0.0496, stage1_l: 0.2582, stage1_h: 0.4167, loss: 0.6863, grad_norm: 13.7700
2024-04-19 06:12:47,071 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 06:14:18,858 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:47:58, time: 1.777, data_time: 0.093, memory: 17809, stage0_loss_instance_mil: 0.0764, stage0_bag_acc: 96.5585, stage0_mean_ious: 0.4257, stage0_s: 0.0000, stage0_m: 0.0485, stage0_l: 0.2167, stage0_h: 0.4490, stage1_loss_instance_mil: 0.3281, stage1_bag_acc: 97.6581, stage1_neg_loss: 0.0859, stage1_mean_ious: 0.4062, stage1_s: 0.0000, stage1_m: 0.0408, stage1_l: 0.1929, stage1_h: 0.4305, loss: 0.4903, grad_norm: 13.5076
2024-04-19 06:15:41,504 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:37, time: 1.653, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0656, stage0_bag_acc: 95.8455, stage0_mean_ious: 0.4357, stage0_s: 0.0000, stage0_m: 0.0653, stage0_l: 0.1802, stage0_h: 0.4738, stage1_loss_instance_mil: 0.3164, stage1_bag_acc: 97.5395, stage1_neg_loss: 0.0862, stage1_mean_ious: 0.4063, stage1_s: 0.0000, stage1_m: 0.0539, stage1_l: 0.1661, stage1_h: 0.4432, loss: 0.4682, grad_norm: 16.2078
2024-04-19 06:17:04,546 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:00, time: 1.661, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0533, stage0_bag_acc: 96.6197, stage0_mean_ious: 0.4640, stage0_s: 0.0000, stage0_m: 0.0226, stage0_l: 0.2053, stage0_h: 0.4960, stage1_loss_instance_mil: 0.2684, stage1_bag_acc: 97.7692, stage1_neg_loss: 0.0886, stage1_mean_ious: 0.4399, stage1_s: 0.0000, stage1_m: 0.0221, stage1_l: 0.2056, stage1_h: 0.4675, loss: 0.4103, grad_norm: 15.6328
2024-04-19 06:17:53,707 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 06:19:21,815 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:14, time: 1.703, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0441, stage0_bag_acc: 97.2110, stage0_mean_ious: 0.4749, stage0_s: 0.0000, stage0_m: 0.0243, stage0_l: 0.1908, stage0_h: 0.5148, stage1_loss_instance_mil: 0.2708, stage1_bag_acc: 98.6309, stage1_neg_loss: 0.0836, stage1_mean_ious: 0.4446, stage1_s: 0.0000, stage1_m: 0.0184, stage1_l: 0.1831, stage1_h: 0.4816, loss: 0.3985, grad_norm: 18.1263
2024-04-19 06:20:42,549 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:41:32, time: 1.615, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0484, stage0_bag_acc: 97.4213, stage0_mean_ious: 0.4954, stage0_s: 0.0000, stage0_m: 0.0297, stage0_l: 0.2073, stage0_h: 0.5371, stage1_loss_instance_mil: 0.2028, stage1_bag_acc: 98.3441, stage1_neg_loss: 0.0833, stage1_mean_ious: 0.4543, stage1_s: 0.0000, stage1_m: 0.0205, stage1_l: 0.1942, stage1_h: 0.4933, loss: 0.3345, grad_norm: 17.9341
2024-04-19 06:22:05,066 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:40:49, time: 1.650, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0359, stage0_bag_acc: 97.7685, stage0_mean_ious: 0.5158, stage0_s: 0.0000, stage0_m: 0.0277, stage0_l: 0.1981, stage0_h: 0.5538, stage1_loss_instance_mil: 0.2058, stage1_bag_acc: 98.4684, stage1_neg_loss: 0.0778, stage1_mean_ious: 0.4810, stage1_s: 0.0000, stage1_m: 0.0307, stage1_l: 0.1887, stage1_h: 0.5167, loss: 0.3195, grad_norm: 17.6085
2024-04-19 06:22:56,495 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 06:24:24,294 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:20, time: 1.697, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0311, stage0_bag_acc: 98.1733, stage0_mean_ious: 0.5033, stage0_s: 0.0000, stage0_m: 0.0593, stage0_l: 0.1149, stage0_h: 0.5490, stage1_loss_instance_mil: 0.2038, stage1_bag_acc: 98.3715, stage1_neg_loss: 0.0887, stage1_mean_ious: 0.4646, stage1_s: 0.0000, stage1_m: 0.0509, stage1_l: 0.1017, stage1_h: 0.5086, loss: 0.3236, grad_norm: 19.2117
2024-04-19 06:25:49,323 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:36:41, time: 1.701, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0179, stage0_bag_acc: 98.8444, stage0_mean_ious: 0.4702, stage0_s: 0.0000, stage0_m: 0.0269, stage0_l: 0.1601, stage0_h: 0.5123, stage1_loss_instance_mil: 0.1904, stage1_bag_acc: 99.0994, stage1_neg_loss: 0.0717, stage1_mean_ious: 0.4326, stage1_s: 0.0000, stage1_m: 0.0204, stage1_l: 0.1478, stage1_h: 0.4715, loss: 0.2800, grad_norm: 13.9569
2024-04-19 06:27:12,742 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:35:52, time: 1.668, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0261, stage0_bag_acc: 98.2184, stage0_mean_ious: 0.5294, stage0_s: 0.0012, stage0_m: 0.0437, stage0_l: 0.1875, stage0_h: 0.5768, stage1_loss_instance_mil: 0.1474, stage1_bag_acc: 99.0725, stage1_neg_loss: 0.0530, stage1_mean_ious: 0.4876, stage1_s: 0.0011, stage1_m: 0.0334, stage1_l: 0.1763, stage1_h: 0.5308, loss: 0.2265, grad_norm: 11.1734
2024-04-19 06:28:03,828 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 06:29:34,130 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:01, time: 1.748, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0207, stage0_bag_acc: 98.8141, stage0_mean_ious: 0.4942, stage0_s: 0.0000, stage0_m: 0.0514, stage0_l: 0.1959, stage0_h: 0.5525, stage1_loss_instance_mil: 0.1573, stage1_bag_acc: 99.1594, stage1_neg_loss: 0.0602, stage1_mean_ious: 0.4548, stage1_s: 0.0000, stage1_m: 0.0351, stage1_l: 0.1888, stage1_h: 0.5083, loss: 0.2382, grad_norm: 11.5805
2024-04-19 06:30:58,568 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:11, time: 1.689, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0178, stage0_bag_acc: 99.4506, stage0_mean_ious: 0.5358, stage0_s: 0.0000, stage0_m: 0.0152, stage0_l: 0.1856, stage0_h: 0.5786, stage1_loss_instance_mil: 0.1406, stage1_bag_acc: 99.5912, stage1_neg_loss: 0.0541, stage1_mean_ious: 0.4961, stage1_s: 0.0000, stage1_m: 0.0103, stage1_l: 0.1778, stage1_h: 0.5344, loss: 0.2125, grad_norm: 9.8254
2024-04-19 06:32:23,135 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:18, time: 1.691, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0187, stage0_bag_acc: 98.6142, stage0_mean_ious: 0.5078, stage0_s: 0.0000, stage0_m: 0.0330, stage0_l: 0.1564, stage0_h: 0.5591, stage1_loss_instance_mil: 0.1511, stage1_bag_acc: 99.6236, stage1_neg_loss: 0.0633, stage1_mean_ious: 0.4683, stage1_s: 0.0000, stage1_m: 0.0222, stage1_l: 0.1500, stage1_h: 0.5143, loss: 0.2331, grad_norm: 13.0041
2024-04-19 06:33:14,383 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 06:34:45,321 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:45, time: 1.759, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0255, stage0_bag_acc: 98.5886, stage0_mean_ious: 0.5492, stage0_s: 0.0000, stage0_m: 0.0514, stage0_l: 0.1603, stage0_h: 0.5935, stage1_loss_instance_mil: 0.1237, stage1_bag_acc: 98.5153, stage1_neg_loss: 0.0542, stage1_mean_ious: 0.5040, stage1_s: 0.0000, stage1_m: 0.0514, stage1_l: 0.1538, stage1_h: 0.5431, loss: 0.2033, grad_norm: 10.1490
2024-04-19 06:36:09,688 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 06:36:09,688 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:27:49, time: 1.687, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0113, stage0_bag_acc: 99.4721, stage0_mean_ious: 0.5454, stage0_s: 0.0000, stage0_m: 0.0334, stage0_l: 0.1836, stage0_h: 0.5972, stage1_loss_instance_mil: 0.0973, stage1_bag_acc: 99.4821, stage1_neg_loss: 0.0435, stage1_mean_ious: 0.5119, stage1_s: 0.0000, stage1_m: 0.0240, stage1_l: 0.1800, stage1_h: 0.5596, loss: 0.1520, grad_norm: 8.1502
2024-04-19 06:37:33,198 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:26:49, time: 1.670, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0291, stage0_bag_acc: 98.3345, stage0_mean_ious: 0.5669, stage0_s: 0.0000, stage0_m: 0.0396, stage0_l: 0.2096, stage0_h: 0.6149, stage1_loss_instance_mil: 0.1149, stage1_bag_acc: 98.9875, stage1_neg_loss: 0.0433, stage1_mean_ious: 0.5296, stage1_s: 0.0000, stage1_m: 0.0301, stage1_l: 0.2113, stage1_h: 0.5729, loss: 0.1873, grad_norm: 9.3693
2024-04-19 06:38:23,939 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 06:40:25,355 - mmdet - INFO - Evaluating bbox...
2024-04-19 06:40:27,316 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1914
2024-04-19 06:40:27,316 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4894
2024-04-19 06:40:27,316 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3383
2024-04-19 06:40:27,317 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1946
2024-04-19 06:40:27,317 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1196
2024-04-19 06:40:27,317 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0591
2024-04-19 06:40:27,317 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0041
2024-04-19 06:40:27,317 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0876
2024-04-19 06:40:27,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1675
2024-04-19 06:40:27,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2330
2024-04-19 06:40:27,318 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2755
2024-04-19 06:40:27,318 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2755
2024-04-19 06:40:27,318 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2755
2024-04-19 06:40:27,319 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1847
2024-04-19 06:40:27,319 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2495
2024-04-19 06:40:27,319 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2788
2024-04-19 06:40:27,366 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 06:40:27,366 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.1910, bbox_mAP_50: 0.4890, bbox_mAP_75: 0.3380, bbox_mAP_s: 0.1950, bbox_mAP_m: 0.1200, bbox_mAP_l: 0.0590, bbox_mAP_copypaste: 0.191 0.489 0.338 0.195 0.120 0.059
2024-04-19 06:41:54,057 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:26, time: 1.733, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0085, stage0_bag_acc: 99.4676, stage0_mean_ious: 0.5790, stage0_s: 0.0000, stage0_m: 0.0329, stage0_l: 0.2184, stage0_h: 0.6247, stage1_loss_instance_mil: 0.0940, stage1_bag_acc: 99.4906, stage1_neg_loss: 0.0430, stage1_mean_ious: 0.5452, stage1_s: 0.0000, stage1_m: 0.0305, stage1_l: 0.2044, stage1_h: 0.5882, loss: 0.1455, grad_norm: 8.8103
2024-04-19 06:43:18,149 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:26, time: 1.682, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0149, stage0_bag_acc: 98.7267, stage0_mean_ious: 0.5831, stage0_s: 0.0000, stage0_m: 0.0355, stage0_l: 0.2199, stage0_h: 0.6301, stage1_loss_instance_mil: 0.0909, stage1_bag_acc: 99.1110, stage1_neg_loss: 0.0407, stage1_mean_ious: 0.5553, stage1_s: 0.0000, stage1_m: 0.0341, stage1_l: 0.2249, stage1_h: 0.5965, loss: 0.1465, grad_norm: 8.3818
2024-04-19 06:44:42,101 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:23, time: 1.679, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0215, stage0_bag_acc: 98.6615, stage0_mean_ious: 0.5602, stage0_s: 0.0000, stage0_m: 0.0239, stage0_l: 0.2172, stage0_h: 0.6077, stage1_loss_instance_mil: 0.0929, stage1_bag_acc: 99.4279, stage1_neg_loss: 0.0452, stage1_mean_ious: 0.5297, stage1_s: 0.0000, stage1_m: 0.0178, stage1_l: 0.2184, stage1_h: 0.5724, loss: 0.1595, grad_norm: 8.7495
2024-04-19 06:45:33,237 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 06:47:02,704 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:09, time: 1.737, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0188, stage0_bag_acc: 98.9630, stage0_mean_ious: 0.5562, stage0_s: 0.0000, stage0_m: 0.0465, stage0_l: 0.2206, stage0_h: 0.6068, stage1_loss_instance_mil: 0.0997, stage1_bag_acc: 99.4469, stage1_neg_loss: 0.0428, stage1_mean_ious: 0.5341, stage1_s: 0.0000, stage1_m: 0.0343, stage1_l: 0.2159, stage1_h: 0.5835, loss: 0.1613, grad_norm: 8.3865
2024-04-19 06:48:26,774 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:05, time: 1.681, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0065, stage0_bag_acc: 99.6508, stage0_mean_ious: 0.5552, stage0_s: 0.0000, stage0_m: 0.0300, stage0_l: 0.2333, stage0_h: 0.6134, stage1_loss_instance_mil: 0.0910, stage1_bag_acc: 99.2194, stage1_neg_loss: 0.0373, stage1_mean_ious: 0.5273, stage1_s: 0.0000, stage1_m: 0.0266, stage1_l: 0.2276, stage1_h: 0.5821, loss: 0.1348, grad_norm: 6.4461
2024-04-19 06:49:52,896 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:02, time: 1.722, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0056, stage0_bag_acc: 99.7897, stage0_mean_ious: 0.5780, stage0_s: 0.0000, stage0_m: 0.0136, stage0_l: 0.2086, stage0_h: 0.6218, stage1_loss_instance_mil: 0.0805, stage1_bag_acc: 99.7897, stage1_neg_loss: 0.0388, stage1_mean_ious: 0.5413, stage1_s: 0.0000, stage1_m: 0.0125, stage1_l: 0.2003, stage1_h: 0.5806, loss: 0.1249, grad_norm: 6.5601
2024-04-19 06:50:44,567 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 06:52:15,246 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:54, time: 1.752, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0063, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.5824, stage0_s: 0.0000, stage0_m: 0.0235, stage0_l: 0.2177, stage0_h: 0.6297, stage1_loss_instance_mil: 0.0799, stage1_bag_acc: 99.5609, stage1_neg_loss: 0.0347, stage1_mean_ious: 0.5581, stage1_s: 0.0000, stage1_m: 0.0192, stage1_l: 0.2240, stage1_h: 0.6009, loss: 0.1209, grad_norm: 5.5363
2024-04-19 06:53:40,280 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:48, time: 1.701, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0045, stage0_bag_acc: 99.6995, stage0_mean_ious: 0.5631, stage0_s: 0.0000, stage0_m: 0.0260, stage0_l: 0.1922, stage0_h: 0.6073, stage1_loss_instance_mil: 0.0730, stage1_bag_acc: 99.7995, stage1_neg_loss: 0.0295, stage1_mean_ious: 0.5372, stage1_s: 0.0000, stage1_m: 0.0227, stage1_l: 0.1922, stage1_h: 0.5784, loss: 0.1069, grad_norm: 4.5952
2024-04-19 06:55:03,629 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:41, time: 1.667, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0056, stage0_bag_acc: 99.9130, stage0_mean_ious: 0.5499, stage0_s: 0.0012, stage0_m: 0.0509, stage0_l: 0.2213, stage0_h: 0.6130, stage1_loss_instance_mil: 0.0711, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0366, stage1_mean_ious: 0.5245, stage1_s: 0.0012, stage1_m: 0.0477, stage1_l: 0.2234, stage1_h: 0.5820, loss: 0.1133, grad_norm: 5.3818
2024-04-19 06:55:53,401 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 06:57:22,760 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:37, time: 1.732, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0053, stage0_bag_acc: 99.7281, stage0_mean_ious: 0.5669, stage0_s: 0.0000, stage0_m: 0.0456, stage0_l: 0.2217, stage0_h: 0.6165, stage1_loss_instance_mil: 0.0652, stage1_bag_acc: 99.7222, stage1_neg_loss: 0.0332, stage1_mean_ious: 0.5432, stage1_s: 0.0000, stage1_m: 0.0478, stage1_l: 0.2202, stage1_h: 0.5890, loss: 0.1036, grad_norm: 4.8438
2024-04-19 06:58:47,272 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:29, time: 1.690, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0047, stage0_bag_acc: 99.6803, stage0_mean_ious: 0.5732, stage0_s: 0.0000, stage0_m: 0.0278, stage0_l: 0.1727, stage0_h: 0.6160, stage1_loss_instance_mil: 0.0702, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0337, stage1_mean_ious: 0.5473, stage1_s: 0.0000, stage1_m: 0.0222, stage1_l: 0.1814, stage1_h: 0.5854, loss: 0.1086, grad_norm: 5.2980
2024-04-19 07:00:12,774 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:21, time: 1.710, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0051, stage0_bag_acc: 99.9130, stage0_mean_ious: 0.5788, stage0_s: 0.0000, stage0_m: 0.0351, stage0_l: 0.1999, stage0_h: 0.6338, stage1_loss_instance_mil: 0.0620, stage1_bag_acc: 99.8330, stage1_neg_loss: 0.0277, stage1_mean_ious: 0.5490, stage1_s: 0.0000, stage1_m: 0.0276, stage1_l: 0.1967, stage1_h: 0.5994, loss: 0.0948, grad_norm: 4.3006
2024-04-19 07:01:02,820 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 07:02:33,420 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:21, time: 1.752, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0073, stage0_bag_acc: 99.5992, stage0_mean_ious: 0.5593, stage0_s: 0.0000, stage0_m: 0.0256, stage0_l: 0.2289, stage0_h: 0.6046, stage1_loss_instance_mil: 0.0692, stage1_bag_acc: 99.6797, stage1_neg_loss: 0.0298, stage1_mean_ious: 0.5344, stage1_s: 0.0000, stage1_m: 0.0228, stage1_l: 0.2359, stage1_h: 0.5746, loss: 0.1063, grad_norm: 4.4192
2024-04-19 07:03:58,628 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:12, time: 1.704, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0037, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.5685, stage0_s: 0.0000, stage0_m: 0.0214, stage0_l: 0.1754, stage0_h: 0.6240, stage1_loss_instance_mil: 0.0630, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0320, stage1_mean_ious: 0.5392, stage1_s: 0.0000, stage1_m: 0.0175, stage1_l: 0.1827, stage1_h: 0.5884, loss: 0.0987, grad_norm: 4.9525
2024-04-19 07:05:23,032 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:01, time: 1.688, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0031, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.5537, stage0_s: 0.0000, stage0_m: 0.0253, stage0_l: 0.1996, stage0_h: 0.6112, stage1_loss_instance_mil: 0.0659, stage1_bag_acc: 99.8000, stage1_neg_loss: 0.0285, stage1_mean_ious: 0.5247, stage1_s: 0.0000, stage1_m: 0.0167, stage1_l: 0.2023, stage1_h: 0.5779, loss: 0.0975, grad_norm: 4.7391
2024-04-19 07:06:14,461 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 07:07:45,364 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:05, time: 1.759, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0029, stage0_bag_acc: 99.8095, stage0_mean_ious: 0.5691, stage0_s: 0.0000, stage0_m: 0.0323, stage0_l: 0.2078, stage0_h: 0.6169, stage1_loss_instance_mil: 0.0686, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0255, stage1_mean_ious: 0.5493, stage1_s: 0.0000, stage1_m: 0.0306, stage1_l: 0.2121, stage1_h: 0.5941, loss: 0.0970, grad_norm: 4.5510
2024-04-19 07:09:08,839 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:54, time: 1.669, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0040, stage0_bag_acc: 99.7895, stage0_mean_ious: 0.5564, stage0_s: 0.0000, stage0_m: 0.0411, stage0_l: 0.1986, stage0_h: 0.6141, stage1_loss_instance_mil: 0.0650, stage1_bag_acc: 99.7895, stage1_neg_loss: 0.0264, stage1_mean_ious: 0.5277, stage1_s: 0.0000, stage1_m: 0.0336, stage1_l: 0.2021, stage1_h: 0.5810, loss: 0.0954, grad_norm: 4.3336
2024-04-19 07:10:32,502 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:43, time: 1.673, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0031, stage0_bag_acc: 99.7947, stage0_mean_ious: 0.5671, stage0_s: 0.0012, stage0_m: 0.0203, stage0_l: 0.2010, stage0_h: 0.6358, stage1_loss_instance_mil: 0.0635, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0277, stage1_mean_ious: 0.5387, stage1_s: 0.0012, stage1_m: 0.0146, stage1_l: 0.2012, stage1_h: 0.6016, loss: 0.0944, grad_norm: 4.4188
2024-04-19 07:11:24,217 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 07:13:21,708 - mmdet - INFO - Evaluating bbox...
2024-04-19 07:13:23,491 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2339
2024-04-19 07:13:23,491 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5181
2024-04-19 07:13:23,492 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3880
2024-04-19 07:13:23,492 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2582
2024-04-19 07:13:23,492 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1874
2024-04-19 07:13:23,492 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1171
2024-04-19 07:13:23,492 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0280
2024-04-19 07:13:23,493 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1138
2024-04-19 07:13:23,493 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2035
2024-04-19 07:13:23,493 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3282
2024-04-19 07:13:23,493 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3289
2024-04-19 07:13:23,493 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3289
2024-04-19 07:13:23,494 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3289
2024-04-19 07:13:23,494 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1698
2024-04-19 07:13:23,494 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2918
2024-04-19 07:13:23,494 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3904
2024-04-19 07:13:23,538 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 07:13:23,538 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.2340, bbox_mAP_50: 0.5180, bbox_mAP_75: 0.3880, bbox_mAP_s: 0.2580, bbox_mAP_m: 0.1870, bbox_mAP_l: 0.1170, bbox_mAP_copypaste: 0.234 0.518 0.388 0.258 0.187 0.117
2024-04-19 07:15:22,835 - mmdet - INFO - Evaluating bbox...
2024-04-19 07:15:24,800 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2339
2024-04-19 07:15:24,800 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5181
2024-04-19 07:15:24,801 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3880
2024-04-19 07:15:24,801 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2582
2024-04-19 07:15:24,801 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1874
2024-04-19 07:15:24,801 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1171
2024-04-19 07:15:24,802 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0280
2024-04-19 07:15:24,802 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1138
2024-04-19 07:15:24,802 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2035
2024-04-19 07:15:24,802 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3282
2024-04-19 07:15:24,802 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3289
2024-04-19 07:15:24,803 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3289
2024-04-19 07:15:24,803 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3289
2024-04-19 07:15:24,803 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1698
2024-04-19 07:15:24,803 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2918
2024-04-19 07:15:24,803 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3904
2024-04-19 07:15:27,499 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 07:15:29,629 - mmdet - INFO - Distributed training: False
2024-04-19 07:15:31,737 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 07:15:34,256 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 07:15:34,256 - mmdet - INFO - Use load_from_local loader
2024-04-19 07:15:34,634 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 07:15:34,663 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 07:15:34,663 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 07:16:58,844 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 0:59:12, time: 1.683, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.7210, stage0_bag_acc: 17.3295, stage0_mean_ious: 0.3744, stage0_s: 0.0000, stage0_m: 0.0715, stage0_l: 0.2416, stage0_h: 0.3812, stage1_loss_instance_mil: 0.1690, stage1_bag_acc: 12.0988, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.3679, stage1_s: 0.0000, stage1_m: 0.0790, stage1_l: 0.2503, stage1_h: 0.3711, loss: 0.8923, grad_norm: 3.0372
2024-04-19 07:18:23,541 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:57:58, time: 1.694, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.5665, stage0_bag_acc: 57.7360, stage0_mean_ious: 0.4051, stage0_s: 0.0000, stage0_m: 0.0208, stage0_l: 0.2202, stage0_h: 0.4329, stage1_loss_instance_mil: 0.2559, stage1_bag_acc: 20.6186, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.3956, stage1_s: 0.0000, stage1_m: 0.0198, stage1_l: 0.2341, stage1_h: 0.4199, loss: 0.8272, grad_norm: 3.5401
2024-04-19 07:19:46,998 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:56:21, time: 1.669, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.2220, stage0_bag_acc: 88.8323, stage0_mean_ious: 0.4506, stage0_s: 0.0000, stage0_m: 0.0216, stage0_l: 0.2315, stage0_h: 0.4682, stage1_loss_instance_mil: 0.3280, stage1_bag_acc: 84.0268, stage1_neg_loss: 0.0680, stage1_mean_ious: 0.4312, stage1_s: 0.0000, stage1_m: 0.0204, stage1_l: 0.2290, stage1_h: 0.4462, loss: 0.6180, grad_norm: 9.2257
2024-04-19 07:20:36,722 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 07:22:05,955 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:47:21, time: 1.726, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0644, stage0_bag_acc: 97.5410, stage0_mean_ious: 0.4549, stage0_s: 0.0000, stage0_m: 0.0177, stage0_l: 0.3023, stage0_h: 0.4690, stage1_loss_instance_mil: 0.3069, stage1_bag_acc: 98.1836, stage1_neg_loss: 0.0854, stage1_mean_ious: 0.4418, stage1_s: 0.0000, stage1_m: 0.0176, stage1_l: 0.3155, stage1_h: 0.4526, loss: 0.4567, grad_norm: 13.3711
2024-04-19 07:23:28,619 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:08, time: 1.653, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0564, stage0_bag_acc: 96.6490, stage0_mean_ious: 0.4232, stage0_s: 0.0000, stage0_m: 0.0514, stage0_l: 0.1998, stage0_h: 0.4431, stage1_loss_instance_mil: 0.3013, stage1_bag_acc: 97.6244, stage1_neg_loss: 0.0946, stage1_mean_ious: 0.4101, stage1_s: 0.0000, stage1_m: 0.0507, stage1_l: 0.2111, stage1_h: 0.4261, loss: 0.4523, grad_norm: 15.5947
2024-04-19 07:24:54,103 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:46:50, time: 1.710, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0668, stage0_bag_acc: 95.6779, stage0_mean_ious: 0.4316, stage0_s: 0.0000, stage0_m: 0.0794, stage0_l: 0.2830, stage0_h: 0.4527, stage1_loss_instance_mil: 0.2797, stage1_bag_acc: 97.0811, stage1_neg_loss: 0.0687, stage1_mean_ious: 0.4187, stage1_s: 0.0000, stage1_m: 0.0839, stage1_l: 0.3013, stage1_h: 0.4353, loss: 0.4152, grad_norm: 12.3681
2024-04-19 07:25:43,423 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 07:27:14,083 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:16, time: 1.752, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0375, stage0_bag_acc: 98.2629, stage0_mean_ious: 0.4471, stage0_s: 0.0000, stage0_m: 0.0784, stage0_l: 0.2874, stage0_h: 0.4583, stage1_loss_instance_mil: 0.2719, stage1_bag_acc: 98.0013, stage1_neg_loss: 0.0749, stage1_mean_ious: 0.4379, stage1_s: 0.0000, stage1_m: 0.0928, stage1_l: 0.3092, stage1_h: 0.4419, loss: 0.3842, grad_norm: 15.9139
2024-04-19 07:28:38,040 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:41:46, time: 1.679, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0452, stage0_bag_acc: 97.2986, stage0_mean_ious: 0.4468, stage0_s: 0.0000, stage0_m: 0.0880, stage0_l: 0.2982, stage0_h: 0.4645, stage1_loss_instance_mil: 0.2217, stage1_bag_acc: 98.2030, stage1_neg_loss: 0.0907, stage1_mean_ious: 0.4280, stage1_s: 0.0000, stage1_m: 0.1025, stage1_l: 0.2989, stage1_h: 0.4399, loss: 0.3575, grad_norm: 20.2656
2024-04-19 07:30:01,310 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:03, time: 1.665, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0276, stage0_bag_acc: 98.3066, stage0_mean_ious: 0.5112, stage0_s: 0.0000, stage0_m: 0.0668, stage0_l: 0.3522, stage0_h: 0.5235, stage1_loss_instance_mil: 0.2147, stage1_bag_acc: 98.6013, stage1_neg_loss: 0.0644, stage1_mean_ious: 0.5090, stage1_s: 0.0000, stage1_m: 0.0774, stage1_l: 0.3679, stage1_h: 0.5163, loss: 0.3066, grad_norm: 14.6874
2024-04-19 07:30:52,432 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 07:32:22,158 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:37, time: 1.734, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0345, stage0_bag_acc: 98.2588, stage0_mean_ious: 0.5482, stage0_s: 0.0000, stage0_m: 0.1095, stage0_l: 0.3167, stage0_h: 0.5754, stage1_loss_instance_mil: 0.1611, stage1_bag_acc: 98.5566, stage1_neg_loss: 0.0617, stage1_mean_ious: 0.5268, stage1_s: 0.0000, stage1_m: 0.1219, stage1_l: 0.3549, stage1_h: 0.5436, loss: 0.2573, grad_norm: 14.8898
2024-04-19 07:33:44,950 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:36:51, time: 1.656, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0204, stage0_bag_acc: 98.8106, stage0_mean_ious: 0.5478, stage0_s: 0.0000, stage0_m: 0.0771, stage0_l: 0.3161, stage0_h: 0.5630, stage1_loss_instance_mil: 0.1536, stage1_bag_acc: 99.2857, stage1_neg_loss: 0.0546, stage1_mean_ious: 0.5308, stage1_s: 0.0000, stage1_m: 0.0912, stage1_l: 0.3499, stage1_h: 0.5376, loss: 0.2286, grad_norm: 13.0163
2024-04-19 07:35:11,583 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:08, time: 1.733, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0198, stage0_bag_acc: 98.6837, stage0_mean_ious: 0.5207, stage0_s: 0.0000, stage0_m: 0.0433, stage0_l: 0.3393, stage0_h: 0.5472, stage1_loss_instance_mil: 0.1474, stage1_bag_acc: 99.4130, stage1_neg_loss: 0.0704, stage1_mean_ious: 0.5019, stage1_s: 0.0000, stage1_m: 0.0510, stage1_l: 0.3727, stage1_h: 0.5194, loss: 0.2375, grad_norm: 16.6835
2024-04-19 07:36:02,676 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 07:37:32,559 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:13, time: 1.737, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0138, stage0_bag_acc: 98.9296, stage0_mean_ious: 0.5135, stage0_s: 0.0000, stage0_m: 0.0812, stage0_l: 0.4178, stage0_h: 0.5214, stage1_loss_instance_mil: 0.1561, stage1_bag_acc: 99.4312, stage1_neg_loss: 0.0519, stage1_mean_ious: 0.5007, stage1_s: 0.0000, stage1_m: 0.0922, stage1_l: 0.4448, stage1_h: 0.5020, loss: 0.2219, grad_norm: 10.2962
2024-04-19 07:38:56,876 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:22, time: 1.686, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0171, stage0_bag_acc: 99.3725, stage0_mean_ious: 0.5320, stage0_s: 0.0000, stage0_m: 0.0989, stage0_l: 0.3476, stage0_h: 0.5510, stage1_loss_instance_mil: 0.1469, stage1_bag_acc: 99.3113, stage1_neg_loss: 0.0511, stage1_mean_ious: 0.5131, stage1_s: 0.0000, stage1_m: 0.1065, stage1_l: 0.3591, stage1_h: 0.5264, loss: 0.2151, grad_norm: 11.8811
2024-04-19 07:40:20,297 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:26, time: 1.668, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0163, stage0_bag_acc: 98.9715, stage0_mean_ious: 0.5001, stage0_s: 0.0000, stage0_m: 0.0694, stage0_l: 0.3815, stage0_h: 0.5026, stage1_loss_instance_mil: 0.1342, stage1_bag_acc: 99.3294, stage1_neg_loss: 0.0512, stage1_mean_ious: 0.4868, stage1_s: 0.0000, stage1_m: 0.0811, stage1_l: 0.3922, stage1_h: 0.4835, loss: 0.2018, grad_norm: 8.7198
2024-04-19 07:41:10,411 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 07:42:41,328 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:52, time: 1.758, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0067, stage0_bag_acc: 99.6254, stage0_mean_ious: 0.5362, stage0_s: 0.0000, stage0_m: 0.0775, stage0_l: 0.3956, stage0_h: 0.5409, stage1_loss_instance_mil: 0.1256, stage1_bag_acc: 99.5937, stage1_neg_loss: 0.0462, stage1_mean_ious: 0.5173, stage1_s: 0.0000, stage1_m: 0.0876, stage1_l: 0.4060, stage1_h: 0.5186, loss: 0.1786, grad_norm: 9.6536
2024-04-19 07:44:06,619 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 07:44:06,620 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:27:56, time: 1.706, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0117, stage0_bag_acc: 99.2364, stage0_mean_ious: 0.4870, stage0_s: 0.0000, stage0_m: 0.0996, stage0_l: 0.4273, stage0_h: 0.4889, stage1_loss_instance_mil: 0.1263, stage1_bag_acc: 99.6298, stage1_neg_loss: 0.0511, stage1_mean_ious: 0.4750, stage1_s: 0.0000, stage1_m: 0.1078, stage1_l: 0.4548, stage1_h: 0.4708, loss: 0.1891, grad_norm: 11.1575
2024-04-19 07:45:30,188 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:26:56, time: 1.671, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0386, stage0_bag_acc: 97.7970, stage0_mean_ious: 0.5224, stage0_s: 0.0000, stage0_m: 0.0944, stage0_l: 0.3174, stage0_h: 0.5320, stage1_loss_instance_mil: 0.1262, stage1_bag_acc: 98.7127, stage1_neg_loss: 0.0489, stage1_mean_ious: 0.4952, stage1_s: 0.0000, stage1_m: 0.1106, stage1_l: 0.3375, stage1_h: 0.4969, loss: 0.2137, grad_norm: 11.1966
2024-04-19 07:46:22,174 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 07:48:23,262 - mmdet - INFO - Evaluating bbox...
2024-04-19 07:48:25,223 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1198
2024-04-19 07:48:25,223 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3253
2024-04-19 07:48:25,223 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2119
2024-04-19 07:48:25,223 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1134
2024-04-19 07:48:25,224 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0683
2024-04-19 07:48:25,224 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0327
2024-04-19 07:48:25,224 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0040
2024-04-19 07:48:25,224 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1438
2024-04-19 07:48:25,224 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1363
2024-04-19 07:48:25,225 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0964
2024-04-19 07:48:25,225 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1901
2024-04-19 07:48:25,225 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1901
2024-04-19 07:48:25,225 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1901
2024-04-19 07:48:25,225 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2179
2024-04-19 07:48:25,225 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2074
2024-04-19 07:48:25,225 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1156
2024-04-19 07:48:25,269 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 07:48:25,270 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.1200, bbox_mAP_50: 0.3250, bbox_mAP_75: 0.2120, bbox_mAP_s: 0.1130, bbox_mAP_m: 0.0680, bbox_mAP_l: 0.0330, bbox_mAP_copypaste: 0.120 0.325 0.212 0.113 0.068 0.033
2024-04-19 07:49:51,602 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:32, time: 1.726, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0213, stage0_bag_acc: 99.2311, stage0_mean_ious: 0.4890, stage0_s: 0.0000, stage0_m: 0.1070, stage0_l: 0.3949, stage0_h: 0.4958, stage1_loss_instance_mil: 0.1302, stage1_bag_acc: 98.3088, stage1_neg_loss: 0.0478, stage1_mean_ious: 0.4706, stage1_s: 0.0000, stage1_m: 0.1228, stage1_l: 0.4114, stage1_h: 0.4693, loss: 0.1993, grad_norm: 7.8370
2024-04-19 07:51:17,148 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:32, time: 1.711, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0099, stage0_bag_acc: 99.6702, stage0_mean_ious: 0.5161, stage0_s: 0.0000, stage0_m: 0.0829, stage0_l: 0.3843, stage0_h: 0.5276, stage1_loss_instance_mil: 0.1220, stage1_bag_acc: 99.4019, stage1_neg_loss: 0.0472, stage1_mean_ious: 0.4959, stage1_s: 0.0000, stage1_m: 0.0916, stage1_l: 0.3928, stage1_h: 0.5010, loss: 0.1791, grad_norm: 8.3619
2024-04-19 07:52:41,806 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:30, time: 1.693, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0058, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.5224, stage0_s: 0.0000, stage0_m: 0.0714, stage0_l: 0.3521, stage0_h: 0.5304, stage1_loss_instance_mil: 0.1155, stage1_bag_acc: 99.7322, stage1_neg_loss: 0.0569, stage1_mean_ious: 0.5003, stage1_s: 0.0000, stage1_m: 0.0700, stage1_l: 0.3533, stage1_h: 0.5048, loss: 0.1782, grad_norm: 9.5633
2024-04-19 07:53:32,668 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 07:55:02,474 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:14, time: 1.736, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0126, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.5016, stage0_s: 0.0000, stage0_m: 0.0908, stage0_l: 0.3326, stage0_h: 0.5090, stage1_loss_instance_mil: 0.1098, stage1_bag_acc: 99.2588, stage1_neg_loss: 0.0439, stage1_mean_ious: 0.4796, stage1_s: 0.0000, stage1_m: 0.0959, stage1_l: 0.3459, stage1_h: 0.4829, loss: 0.1663, grad_norm: 9.5954
2024-04-19 07:56:27,042 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:11, time: 1.691, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0058, stage0_bag_acc: 99.7048, stage0_mean_ious: 0.5331, stage0_s: 0.0016, stage0_m: 0.0610, stage0_l: 0.3765, stage0_h: 0.5449, stage1_loss_instance_mil: 0.1052, stage1_bag_acc: 99.6095, stage1_neg_loss: 0.0469, stage1_mean_ious: 0.5105, stage1_s: 0.0015, stage1_m: 0.0610, stage1_l: 0.4092, stage1_h: 0.5142, loss: 0.1579, grad_norm: 8.9072
2024-04-19 07:57:51,888 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:06, time: 1.697, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0074, stage0_bag_acc: 99.6938, stage0_mean_ious: 0.5448, stage0_s: 0.0000, stage0_m: 0.0957, stage0_l: 0.3772, stage0_h: 0.5589, stage1_loss_instance_mil: 0.0781, stage1_bag_acc: 99.6154, stage1_neg_loss: 0.0386, stage1_mean_ious: 0.5290, stage1_s: 0.0000, stage1_m: 0.1064, stage1_l: 0.4008, stage1_h: 0.5350, loss: 0.1241, grad_norm: 6.4189
2024-04-19 07:58:41,899 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 08:00:13,145 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:57, time: 1.767, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0085, stage0_bag_acc: 99.2519, stage0_mean_ious: 0.5606, stage0_s: 0.0000, stage0_m: 0.0492, stage0_l: 0.4098, stage0_h: 0.5722, stage1_loss_instance_mil: 0.0759, stage1_bag_acc: 99.3547, stage1_neg_loss: 0.0473, stage1_mean_ious: 0.5396, stage1_s: 0.0000, stage1_m: 0.0520, stage1_l: 0.4503, stage1_h: 0.5411, loss: 0.1317, grad_norm: 9.2817
2024-04-19 08:01:36,941 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:51, time: 1.676, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.5636, stage0_s: 0.0000, stage0_m: 0.1073, stage0_l: 0.4125, stage0_h: 0.5738, stage1_loss_instance_mil: 0.0657, stage1_bag_acc: 99.7995, stage1_neg_loss: 0.0362, stage1_mean_ious: 0.5386, stage1_s: 0.0000, stage1_m: 0.1195, stage1_l: 0.4315, stage1_h: 0.5420, loss: 0.1077, grad_norm: 5.6892
2024-04-19 08:03:00,995 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:43, time: 1.681, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0057, stage0_bag_acc: 99.5349, stage0_mean_ious: 0.5572, stage0_s: 0.0000, stage0_m: 0.0625, stage0_l: 0.4469, stage0_h: 0.5640, stage1_loss_instance_mil: 0.0719, stage1_bag_acc: 99.2998, stage1_neg_loss: 0.0356, stage1_mean_ious: 0.5334, stage1_s: 0.0000, stage1_m: 0.0651, stage1_l: 0.4478, stage1_h: 0.5355, loss: 0.1132, grad_norm: 5.7740
2024-04-19 08:03:52,011 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 08:05:20,942 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:39, time: 1.718, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0080, stage0_bag_acc: 99.7139, stage0_mean_ious: 0.5397, stage0_s: 0.0000, stage0_m: 0.1417, stage0_l: 0.3989, stage0_h: 0.5562, stage1_loss_instance_mil: 0.0627, stage1_bag_acc: 99.6937, stage1_neg_loss: 0.0330, stage1_mean_ious: 0.5147, stage1_s: 0.0000, stage1_m: 0.1515, stage1_l: 0.4122, stage1_h: 0.5247, loss: 0.1037, grad_norm: 4.5693
2024-04-19 08:06:46,242 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:31, time: 1.706, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0020, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5451, stage0_s: 0.0000, stage0_m: 0.0716, stage0_l: 0.3763, stage0_h: 0.5550, stage1_loss_instance_mil: 0.0620, stage1_bag_acc: 99.6000, stage1_neg_loss: 0.0393, stage1_mean_ious: 0.5239, stage1_s: 0.0000, stage1_m: 0.0712, stage1_l: 0.4027, stage1_h: 0.5270, loss: 0.1034, grad_norm: 6.3227
2024-04-19 08:08:11,932 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:22, time: 1.714, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 99.8667, stage0_mean_ious: 0.5480, stage0_s: 0.0000, stage0_m: 0.0553, stage0_l: 0.3474, stage0_h: 0.5569, stage1_loss_instance_mil: 0.0738, stage1_bag_acc: 99.5503, stage1_neg_loss: 0.0318, stage1_mean_ious: 0.5306, stage1_s: 0.0000, stage1_m: 0.0673, stage1_l: 0.3643, stage1_h: 0.5329, loss: 0.1084, grad_norm: 5.7344
2024-04-19 08:09:00,489 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 08:10:32,022 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:22, time: 1.768, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0078, stage0_bag_acc: 99.8114, stage0_mean_ious: 0.5398, stage0_s: 0.0016, stage0_m: 0.1668, stage0_l: 0.3811, stage0_h: 0.5498, stage1_loss_instance_mil: 0.0701, stage1_bag_acc: 99.7947, stage1_neg_loss: 0.0318, stage1_mean_ious: 0.5197, stage1_s: 0.0016, stage1_m: 0.1892, stage1_l: 0.3940, stage1_h: 0.5229, loss: 0.1097, grad_norm: 5.1096
2024-04-19 08:11:54,585 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:13, time: 1.651, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0027, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.5393, stage0_s: 0.0000, stage0_m: 0.1286, stage0_l: 0.3890, stage0_h: 0.5491, stage1_loss_instance_mil: 0.0710, stage1_bag_acc: 99.7871, stage1_neg_loss: 0.0338, stage1_mean_ious: 0.5263, stage1_s: 0.0000, stage1_m: 0.1390, stage1_l: 0.4148, stage1_h: 0.5287, loss: 0.1076, grad_norm: 5.2553
2024-04-19 08:13:19,355 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:02, time: 1.695, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0082, stage0_bag_acc: 99.3223, stage0_mean_ious: 0.5344, stage0_s: 0.0000, stage0_m: 0.0547, stage0_l: 0.3541, stage0_h: 0.5406, stage1_loss_instance_mil: 0.0627, stage1_bag_acc: 99.7350, stage1_neg_loss: 0.0335, stage1_mean_ious: 0.5165, stage1_s: 0.0000, stage1_m: 0.0609, stage1_l: 0.3585, stage1_h: 0.5203, loss: 0.1044, grad_norm: 5.7775
2024-04-19 08:14:10,954 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 08:15:41,353 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:05, time: 1.755, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.5340, stage0_s: 0.0000, stage0_m: 0.1175, stage0_l: 0.3899, stage0_h: 0.5480, stage1_loss_instance_mil: 0.0617, stage1_bag_acc: 99.7880, stage1_neg_loss: 0.0366, stage1_mean_ious: 0.5164, stage1_s: 0.0000, stage1_m: 0.1309, stage1_l: 0.4201, stage1_h: 0.5227, loss: 0.1043, grad_norm: 6.0429
2024-04-19 08:17:06,024 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:54, time: 1.693, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0034, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.5456, stage0_s: 0.0000, stage0_m: 0.0862, stage0_l: 0.3862, stage0_h: 0.5532, stage1_loss_instance_mil: 0.0711, stage1_bag_acc: 99.8667, stage1_neg_loss: 0.0309, stage1_mean_ious: 0.5246, stage1_s: 0.0000, stage1_m: 0.0912, stage1_l: 0.3936, stage1_h: 0.5266, loss: 0.1053, grad_norm: 5.8775
2024-04-19 08:18:31,500 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:43, time: 1.709, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0019, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5430, stage0_s: 0.0000, stage0_m: 0.0781, stage0_l: 0.3731, stage0_h: 0.5525, stage1_loss_instance_mil: 0.0672, stage1_bag_acc: 99.8824, stage1_neg_loss: 0.0345, stage1_mean_ious: 0.5201, stage1_s: 0.0000, stage1_m: 0.0916, stage1_l: 0.3910, stage1_h: 0.5240, loss: 0.1036, grad_norm: 5.4881
2024-04-19 08:19:22,203 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 08:21:25,672 - mmdet - INFO - Evaluating bbox...
2024-04-19 08:21:27,473 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1669
2024-04-19 08:21:27,473 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4390
2024-04-19 08:21:27,473 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3013
2024-04-19 08:21:27,474 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1674
2024-04-19 08:21:27,474 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0915
2024-04-19 08:21:27,474 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0415
2024-04-19 08:21:27,474 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0024
2024-04-19 08:21:27,475 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1687
2024-04-19 08:21:27,475 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1821
2024-04-19 08:21:27,475 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1896
2024-04-19 08:21:27,475 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2453
2024-04-19 08:21:27,475 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2453
2024-04-19 08:21:27,475 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2453
2024-04-19 08:21:27,476 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2600
2024-04-19 08:21:27,476 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2633
2024-04-19 08:21:27,476 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2221
2024-04-19 08:21:27,528 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 08:21:27,528 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.1670, bbox_mAP_50: 0.4390, bbox_mAP_75: 0.3010, bbox_mAP_s: 0.1670, bbox_mAP_m: 0.0920, bbox_mAP_l: 0.0410, bbox_mAP_copypaste: 0.167 0.439 0.301 0.167 0.092 0.041
2024-04-19 08:23:25,461 - mmdet - INFO - Evaluating bbox...
2024-04-19 08:23:27,441 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1669
2024-04-19 08:23:27,441 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4390
2024-04-19 08:23:27,441 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3013
2024-04-19 08:23:27,442 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1674
2024-04-19 08:23:27,442 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0915
2024-04-19 08:23:27,442 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0415
2024-04-19 08:23:27,442 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0024
2024-04-19 08:23:27,443 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1687
2024-04-19 08:23:27,443 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1821
2024-04-19 08:23:27,443 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1896
2024-04-19 08:23:27,443 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2453
2024-04-19 08:23:27,443 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2453
2024-04-19 08:23:27,443 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2453
2024-04-19 08:23:27,444 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2600
2024-04-19 08:23:27,444 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2633
2024-04-19 08:23:27,444 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2221
2024-04-19 08:23:30,159 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 08:23:32,354 - mmdet - INFO - Distributed training: False
2024-04-19 08:23:34,491 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 08:23:37,098 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 08:23:37,098 - mmdet - INFO - Use load_from_local loader
2024-04-19 08:23:37,480 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 08:23:37,507 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 08:23:37,507 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 08:25:04,909 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:01:27, time: 1.748, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.7100, stage0_bag_acc: 21.3017, stage0_mean_ious: 0.3090, stage0_s: 0.0000, stage0_m: 0.0230, stage0_l: 0.1490, stage0_h: 0.3303, stage1_loss_instance_mil: 0.1764, stage1_bag_acc: 12.8014, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.2858, stage1_s: 0.0000, stage1_m: 0.0217, stage1_l: 0.1485, stage1_h: 0.3037, loss: 0.8880, grad_norm: 3.1236
2024-04-19 08:26:29,414 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:01, time: 1.690, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.5835, stage0_bag_acc: 49.2217, stage0_mean_ious: 0.3293, stage0_s: 0.0000, stage0_m: 0.0642, stage0_l: 0.2307, stage0_h: 0.3418, stage1_loss_instance_mil: 0.2487, stage1_bag_acc: 17.3382, stage1_neg_loss: 0.0045, stage1_mean_ious: 0.3105, stage1_s: 0.0000, stage1_m: 0.0784, stage1_l: 0.2262, stage1_h: 0.3189, loss: 0.8367, grad_norm: 4.1413
2024-04-19 08:27:54,620 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:57:25, time: 1.704, data_time: 0.048, memory: 17809, stage0_loss_instance_mil: 0.2385, stage0_bag_acc: 89.3695, stage0_mean_ious: 0.3330, stage0_s: 0.0000, stage0_m: 0.0537, stage0_l: 0.2008, stage0_h: 0.3445, stage1_loss_instance_mil: 0.3675, stage1_bag_acc: 84.2129, stage1_neg_loss: 0.0756, stage1_mean_ious: 0.3281, stage1_s: 0.0000, stage1_m: 0.0476, stage1_l: 0.2092, stage1_h: 0.3362, loss: 0.6817, grad_norm: 12.3251
2024-04-19 08:28:45,640 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 08:30:16,225 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:11, time: 1.751, data_time: 0.101, memory: 17809, stage0_loss_instance_mil: 0.0787, stage0_bag_acc: 96.1136, stage0_mean_ious: 0.3677, stage0_s: 0.0000, stage0_m: 0.0525, stage0_l: 0.1641, stage0_h: 0.3820, stage1_loss_instance_mil: 0.3454, stage1_bag_acc: 97.1993, stage1_neg_loss: 0.0908, stage1_mean_ious: 0.3356, stage1_s: 0.0000, stage1_m: 0.0558, stage1_l: 0.1556, stage1_h: 0.3476, loss: 0.5148, grad_norm: 13.4374
2024-04-19 08:31:42,501 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:13, time: 1.726, data_time: 0.047, memory: 17809, stage0_loss_instance_mil: 0.0550, stage0_bag_acc: 96.4452, stage0_mean_ious: 0.3453, stage0_s: 0.0016, stage0_m: 0.0502, stage0_l: 0.1543, stage0_h: 0.3643, stage1_loss_instance_mil: 0.3133, stage1_bag_acc: 98.2764, stage1_neg_loss: 0.0886, stage1_mean_ious: 0.3182, stage1_s: 0.0012, stage1_m: 0.0472, stage1_l: 0.1512, stage1_h: 0.3341, loss: 0.4569, grad_norm: 14.3292
2024-04-19 08:33:07,316 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:39, time: 1.696, data_time: 0.046, memory: 17809, stage0_loss_instance_mil: 0.0521, stage0_bag_acc: 97.0515, stage0_mean_ious: 0.3678, stage0_s: 0.0000, stage0_m: 0.0450, stage0_l: 0.1602, stage0_h: 0.3941, stage1_loss_instance_mil: 0.2892, stage1_bag_acc: 97.9614, stage1_neg_loss: 0.0837, stage1_mean_ious: 0.3447, stage1_s: 0.0000, stage1_m: 0.0473, stage1_l: 0.1683, stage1_h: 0.3669, loss: 0.4250, grad_norm: 12.7886
2024-04-19 08:33:57,647 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 08:35:27,666 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:52, time: 1.740, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0455, stage0_bag_acc: 97.8403, stage0_mean_ious: 0.3714, stage0_s: 0.0000, stage0_m: 0.0308, stage0_l: 0.1459, stage0_h: 0.4029, stage1_loss_instance_mil: 0.2757, stage1_bag_acc: 98.5246, stage1_neg_loss: 0.0928, stage1_mean_ious: 0.3331, stage1_s: 0.0000, stage1_m: 0.0284, stage1_l: 0.1376, stage1_h: 0.3593, loss: 0.4141, grad_norm: 16.4961
2024-04-19 08:36:51,271 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:16, time: 1.672, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0377, stage0_bag_acc: 98.2330, stage0_mean_ious: 0.3271, stage0_s: 0.0000, stage0_m: 0.0401, stage0_l: 0.1412, stage0_h: 0.3543, stage1_loss_instance_mil: 0.2441, stage1_bag_acc: 97.9108, stage1_neg_loss: 0.0821, stage1_mean_ious: 0.2995, stage1_s: 0.0000, stage1_m: 0.0334, stage1_l: 0.1442, stage1_h: 0.3221, loss: 0.3638, grad_norm: 14.0820
2024-04-19 08:38:15,743 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:33, time: 1.689, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0441, stage0_bag_acc: 96.9370, stage0_mean_ious: 0.3681, stage0_s: 0.0017, stage0_m: 0.0384, stage0_l: 0.1310, stage0_h: 0.3903, stage1_loss_instance_mil: 0.2457, stage1_bag_acc: 97.8036, stage1_neg_loss: 0.0799, stage1_mean_ious: 0.3351, stage1_s: 0.0016, stage1_m: 0.0405, stage1_l: 0.1318, stage1_h: 0.3535, loss: 0.3697, grad_norm: 14.6395
2024-04-19 08:39:06,483 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 08:40:36,065 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:02, time: 1.738, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0291, stage0_bag_acc: 98.3001, stage0_mean_ious: 0.4281, stage0_s: 0.0014, stage0_m: 0.0225, stage0_l: 0.1408, stage0_h: 0.4561, stage1_loss_instance_mil: 0.1992, stage1_bag_acc: 99.0184, stage1_neg_loss: 0.0689, stage1_mean_ious: 0.3840, stage1_s: 0.0015, stage1_m: 0.0229, stage1_l: 0.1507, stage1_h: 0.4051, loss: 0.2972, grad_norm: 12.3588
2024-04-19 08:41:59,688 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:15, time: 1.672, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0297, stage0_bag_acc: 98.0690, stage0_mean_ious: 0.4146, stage0_s: 0.0000, stage0_m: 0.0449, stage0_l: 0.1559, stage0_h: 0.4504, stage1_loss_instance_mil: 0.1955, stage1_bag_acc: 98.4051, stage1_neg_loss: 0.0821, stage1_mean_ious: 0.3759, stage1_s: 0.0000, stage1_m: 0.0511, stage1_l: 0.1600, stage1_h: 0.4040, loss: 0.3073, grad_norm: 17.7850
2024-04-19 08:43:23,674 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:24, time: 1.680, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0149, stage0_bag_acc: 99.3021, stage0_mean_ious: 0.3965, stage0_s: 0.0000, stage0_m: 0.0410, stage0_l: 0.1606, stage0_h: 0.4335, stage1_loss_instance_mil: 0.1676, stage1_bag_acc: 99.0612, stage1_neg_loss: 0.0620, stage1_mean_ious: 0.3627, stage1_s: 0.0000, stage1_m: 0.0434, stage1_l: 0.1638, stage1_h: 0.3919, loss: 0.2445, grad_norm: 11.2511
2024-04-19 08:44:13,477 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 08:45:41,117 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:23, time: 1.692, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0097, stage0_bag_acc: 99.7702, stage0_mean_ious: 0.4593, stage0_s: 0.0000, stage0_m: 0.0648, stage0_l: 0.1886, stage0_h: 0.4922, stage1_loss_instance_mil: 0.1506, stage1_bag_acc: 99.3378, stage1_neg_loss: 0.0604, stage1_mean_ious: 0.4272, stage1_s: 0.0000, stage1_m: 0.0725, stage1_l: 0.1951, stage1_h: 0.4531, loss: 0.2207, grad_norm: 11.8723
2024-04-19 08:47:06,478 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:33, time: 1.707, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0127, stage0_bag_acc: 99.3497, stage0_mean_ious: 0.4487, stage0_s: 0.0000, stage0_m: 0.0317, stage0_l: 0.1631, stage0_h: 0.4836, stage1_loss_instance_mil: 0.1654, stage1_bag_acc: 98.9181, stage1_neg_loss: 0.0680, stage1_mean_ious: 0.4085, stage1_s: 0.0000, stage1_m: 0.0319, stage1_l: 0.1708, stage1_h: 0.4364, loss: 0.2461, grad_norm: 14.1932
2024-04-19 08:48:30,832 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:37, time: 1.687, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0205, stage0_bag_acc: 98.9159, stage0_mean_ious: 0.4533, stage0_s: 0.0000, stage0_m: 0.0520, stage0_l: 0.1630, stage0_h: 0.4956, stage1_loss_instance_mil: 0.1472, stage1_bag_acc: 98.9794, stage1_neg_loss: 0.0618, stage1_mean_ious: 0.4104, stage1_s: 0.0000, stage1_m: 0.0510, stage1_l: 0.1628, stage1_h: 0.4460, loss: 0.2295, grad_norm: 11.4596
2024-04-19 08:49:22,068 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 08:50:50,967 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:59, time: 1.726, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0192, stage0_bag_acc: 99.1294, stage0_mean_ious: 0.4851, stage0_s: 0.0000, stage0_m: 0.0385, stage0_l: 0.1793, stage0_h: 0.5228, stage1_loss_instance_mil: 0.1363, stage1_bag_acc: 98.6814, stage1_neg_loss: 0.0557, stage1_mean_ious: 0.4453, stage1_s: 0.0000, stage1_m: 0.0407, stage1_l: 0.1810, stage1_h: 0.4758, loss: 0.2112, grad_norm: 10.7666
2024-04-19 08:52:14,650 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 08:52:14,651 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:01, time: 1.674, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0159, stage0_bag_acc: 99.1056, stage0_mean_ious: 0.5003, stage0_s: 0.0000, stage0_m: 0.0467, stage0_l: 0.1349, stage0_h: 0.5412, stage1_loss_instance_mil: 0.1147, stage1_bag_acc: 99.2367, stage1_neg_loss: 0.0532, stage1_mean_ious: 0.4613, stage1_s: 0.0000, stage1_m: 0.0451, stage1_l: 0.1433, stage1_h: 0.4957, loss: 0.1838, grad_norm: 9.1314
2024-04-19 08:53:39,150 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:01, time: 1.690, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0233, stage0_bag_acc: 98.9642, stage0_mean_ious: 0.4899, stage0_s: 0.0000, stage0_m: 0.0253, stage0_l: 0.2066, stage0_h: 0.5330, stage1_loss_instance_mil: 0.1125, stage1_bag_acc: 99.3072, stage1_neg_loss: 0.0484, stage1_mean_ious: 0.4569, stage1_s: 0.0000, stage1_m: 0.0271, stage1_l: 0.1990, stage1_h: 0.4960, loss: 0.1841, grad_norm: 9.4748
2024-04-19 08:54:29,948 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 08:56:30,293 - mmdet - INFO - Evaluating bbox...
2024-04-19 08:56:32,246 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1598
2024-04-19 08:56:32,246 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3605
2024-04-19 08:56:32,246 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2496
2024-04-19 08:56:32,247 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1672
2024-04-19 08:56:32,247 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1370
2024-04-19 08:56:32,247 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1085
2024-04-19 08:56:32,247 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0173
2024-04-19 08:56:32,248 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1561
2024-04-19 08:56:32,248 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1304
2024-04-19 08:56:32,248 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2542
2024-04-19 08:56:32,248 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2383
2024-04-19 08:56:32,248 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2383
2024-04-19 08:56:32,248 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2383
2024-04-19 08:56:32,249 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1705
2024-04-19 08:56:32,249 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1933
2024-04-19 08:56:32,249 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3033
2024-04-19 08:56:32,293 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 08:56:32,293 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.1600, bbox_mAP_50: 0.3600, bbox_mAP_75: 0.2500, bbox_mAP_s: 0.1670, bbox_mAP_m: 0.1370, bbox_mAP_l: 0.1090, bbox_mAP_copypaste: 0.160 0.360 0.250 0.167 0.137 0.109
2024-04-19 08:57:59,618 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:37, time: 1.746, data_time: 0.099, memory: 17809, stage0_loss_instance_mil: 0.0125, stage0_bag_acc: 99.1714, stage0_mean_ious: 0.4832, stage0_s: 0.0000, stage0_m: 0.0555, stage0_l: 0.1744, stage0_h: 0.5280, stage1_loss_instance_mil: 0.1098, stage1_bag_acc: 99.4014, stage1_neg_loss: 0.0438, stage1_mean_ious: 0.4509, stage1_s: 0.0000, stage1_m: 0.0590, stage1_l: 0.1823, stage1_h: 0.4880, loss: 0.1662, grad_norm: 8.5851
2024-04-19 08:59:24,579 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:37, time: 1.699, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0188, stage0_bag_acc: 98.9435, stage0_mean_ious: 0.4828, stage0_s: 0.0000, stage0_m: 0.0596, stage0_l: 0.1968, stage0_h: 0.5226, stage1_loss_instance_mil: 0.0996, stage1_bag_acc: 99.4071, stage1_neg_loss: 0.0490, stage1_mean_ious: 0.4476, stage1_s: 0.0000, stage1_m: 0.0675, stage1_l: 0.2111, stage1_h: 0.4793, loss: 0.1674, grad_norm: 9.0362
2024-04-19 09:00:47,884 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:33, time: 1.666, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0064, stage0_bag_acc: 99.6639, stage0_mean_ious: 0.4657, stage0_s: 0.0000, stage0_m: 0.0387, stage0_l: 0.1891, stage0_h: 0.5231, stage1_loss_instance_mil: 0.1024, stage1_bag_acc: 99.7056, stage1_neg_loss: 0.0473, stage1_mean_ious: 0.4310, stage1_s: 0.0000, stage1_m: 0.0389, stage1_l: 0.1810, stage1_h: 0.4820, loss: 0.1561, grad_norm: 8.2855
2024-04-19 09:01:37,897 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 09:03:06,465 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:16, time: 1.712, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0104, stage0_bag_acc: 99.3269, stage0_mean_ious: 0.5012, stage0_s: 0.0000, stage0_m: 0.0308, stage0_l: 0.1986, stage0_h: 0.5431, stage1_loss_instance_mil: 0.0907, stage1_bag_acc: 99.6321, stage1_neg_loss: 0.0404, stage1_mean_ious: 0.4591, stage1_s: 0.0000, stage1_m: 0.0345, stage1_l: 0.1996, stage1_h: 0.4939, loss: 0.1415, grad_norm: 6.9141
2024-04-19 09:04:31,851 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:13, time: 1.708, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0104, stage0_bag_acc: 99.3477, stage0_mean_ious: 0.4875, stage0_s: 0.0000, stage0_m: 0.0320, stage0_l: 0.1778, stage0_h: 0.5360, stage1_loss_instance_mil: 0.0902, stage1_bag_acc: 99.6110, stage1_neg_loss: 0.0485, stage1_mean_ious: 0.4472, stage1_s: 0.0000, stage1_m: 0.0354, stage1_l: 0.1833, stage1_h: 0.4873, loss: 0.1491, grad_norm: 9.9695
2024-04-19 09:05:54,171 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:06, time: 1.646, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0100, stage0_bag_acc: 99.6845, stage0_mean_ious: 0.4992, stage0_s: 0.0000, stage0_m: 0.0429, stage0_l: 0.1573, stage0_h: 0.5462, stage1_loss_instance_mil: 0.0859, stage1_bag_acc: 99.5753, stage1_neg_loss: 0.0399, stage1_mean_ious: 0.4580, stage1_s: 0.0000, stage1_m: 0.0432, stage1_l: 0.1560, stage1_h: 0.4982, loss: 0.1357, grad_norm: 7.2728
2024-04-19 09:06:43,356 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 09:08:12,830 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:57, time: 1.730, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0036, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.4728, stage0_s: 0.0000, stage0_m: 0.0409, stage0_l: 0.1819, stage0_h: 0.5159, stage1_loss_instance_mil: 0.0675, stage1_bag_acc: 99.7178, stage1_neg_loss: 0.0363, stage1_mean_ious: 0.4407, stage1_s: 0.0000, stage1_m: 0.0460, stage1_l: 0.1825, stage1_h: 0.4786, loss: 0.1074, grad_norm: 6.2609
2024-04-19 09:09:35,154 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:50, time: 1.646, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0112, stage0_bag_acc: 99.3993, stage0_mean_ious: 0.5158, stage0_s: 0.0000, stage0_m: 0.0472, stage0_l: 0.1797, stage0_h: 0.5591, stage1_loss_instance_mil: 0.0606, stage1_bag_acc: 99.3993, stage1_neg_loss: 0.0330, stage1_mean_ious: 0.4877, stage1_s: 0.0000, stage1_m: 0.0536, stage1_l: 0.1783, stage1_h: 0.5253, loss: 0.1049, grad_norm: 5.7660
2024-04-19 09:10:58,934 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:42, time: 1.676, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4767, stage0_s: 0.0000, stage0_m: 0.0433, stage0_l: 0.1566, stage0_h: 0.5215, stage1_loss_instance_mil: 0.0760, stage1_bag_acc: 99.6884, stage1_neg_loss: 0.0383, stage1_mean_ious: 0.4407, stage1_s: 0.0000, stage1_m: 0.0442, stage1_l: 0.1573, stage1_h: 0.4787, loss: 0.1171, grad_norm: 6.2952
2024-04-19 09:11:48,424 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 09:13:16,536 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:38, time: 1.703, data_time: 0.092, memory: 17809, stage0_loss_instance_mil: 0.0063, stage0_bag_acc: 99.8091, stage0_mean_ious: 0.5059, stage0_s: 0.0000, stage0_m: 0.0594, stage0_l: 0.2007, stage0_h: 0.5535, stage1_loss_instance_mil: 0.0633, stage1_bag_acc: 99.9091, stage1_neg_loss: 0.0295, stage1_mean_ious: 0.4720, stage1_s: 0.0000, stage1_m: 0.0560, stage1_l: 0.1944, stage1_h: 0.5136, loss: 0.0990, grad_norm: 4.9377
2024-04-19 09:14:39,050 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:30, time: 1.650, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0084, stage0_bag_acc: 99.4717, stage0_mean_ious: 0.4817, stage0_s: 0.0000, stage0_m: 0.0300, stage0_l: 0.2075, stage0_h: 0.5331, stage1_loss_instance_mil: 0.0578, stage1_bag_acc: 99.7880, stage1_neg_loss: 0.0336, stage1_mean_ious: 0.4488, stage1_s: 0.0000, stage1_m: 0.0338, stage1_l: 0.1953, stage1_h: 0.4945, loss: 0.0999, grad_norm: 4.9450
2024-04-19 09:16:03,424 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:21, time: 1.687, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0015, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4942, stage0_s: 0.0014, stage0_m: 0.0273, stage0_l: 0.1935, stage0_h: 0.5411, stage1_loss_instance_mil: 0.0563, stage1_bag_acc: 99.8824, stage1_neg_loss: 0.0268, stage1_mean_ious: 0.4601, stage1_s: 0.0022, stage1_m: 0.0272, stage1_l: 0.1962, stage1_h: 0.5017, loss: 0.0846, grad_norm: 4.7249
2024-04-19 09:16:54,364 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 09:18:23,323 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:21, time: 1.720, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0043, stage0_bag_acc: 99.7460, stage0_mean_ious: 0.5177, stage0_s: 0.0000, stage0_m: 0.0342, stage0_l: 0.1884, stage0_h: 0.5558, stage1_loss_instance_mil: 0.0587, stage1_bag_acc: 99.7697, stage1_neg_loss: 0.0281, stage1_mean_ious: 0.4783, stage1_s: 0.0000, stage1_m: 0.0383, stage1_l: 0.1793, stage1_h: 0.5120, loss: 0.0911, grad_norm: 4.8243
2024-04-19 09:19:47,840 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:11, time: 1.690, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0057, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.5082, stage0_s: 0.0014, stage0_m: 0.0433, stage0_l: 0.1775, stage0_h: 0.5578, stage1_loss_instance_mil: 0.0599, stage1_bag_acc: 99.8083, stage1_neg_loss: 0.0279, stage1_mean_ious: 0.4691, stage1_s: 0.0023, stage1_m: 0.0475, stage1_l: 0.1868, stage1_h: 0.5106, loss: 0.0934, grad_norm: 4.7491
2024-04-19 09:21:11,857 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:01, time: 1.680, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0026, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.4922, stage0_s: 0.0000, stage0_m: 0.0436, stage0_l: 0.1920, stage0_h: 0.5287, stage1_loss_instance_mil: 0.0539, stage1_bag_acc: 99.8095, stage1_neg_loss: 0.0314, stage1_mean_ious: 0.4586, stage1_s: 0.0000, stage1_m: 0.0426, stage1_l: 0.1891, stage1_h: 0.4901, loss: 0.0878, grad_norm: 4.6194
2024-04-19 09:22:00,824 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 09:23:32,013 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:05, time: 1.763, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0021, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5198, stage0_s: 0.0000, stage0_m: 0.0405, stage0_l: 0.2148, stage0_h: 0.5652, stage1_loss_instance_mil: 0.0531, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0302, stage1_mean_ious: 0.4798, stage1_s: 0.0000, stage1_m: 0.0464, stage1_l: 0.2112, stage1_h: 0.5197, loss: 0.0853, grad_norm: 5.2932
2024-04-19 09:24:56,702 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:54, time: 1.694, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0066, stage0_bag_acc: 99.7083, stage0_mean_ious: 0.4756, stage0_s: 0.0000, stage0_m: 0.0364, stage0_l: 0.1818, stage0_h: 0.5221, stage1_loss_instance_mil: 0.0508, stage1_bag_acc: 99.7697, stage1_neg_loss: 0.0309, stage1_mean_ious: 0.4434, stage1_s: 0.0000, stage1_m: 0.0368, stage1_l: 0.1829, stage1_h: 0.4830, loss: 0.0883, grad_norm: 4.2801
2024-04-19 09:26:21,176 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:43, time: 1.689, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 99.9231, stage0_mean_ious: 0.5188, stage0_s: 0.0000, stage0_m: 0.0243, stage0_l: 0.1762, stage0_h: 0.5609, stage1_loss_instance_mil: 0.0537, stage1_bag_acc: 99.8361, stage1_neg_loss: 0.0328, stage1_mean_ious: 0.4820, stage1_s: 0.0000, stage1_m: 0.0226, stage1_l: 0.1714, stage1_h: 0.5203, loss: 0.0892, grad_norm: 4.6857
2024-04-19 09:27:10,455 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 09:29:07,978 - mmdet - INFO - Evaluating bbox...
2024-04-19 09:29:09,952 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1871
2024-04-19 09:29:09,952 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4212
2024-04-19 09:29:09,953 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3098
2024-04-19 09:29:09,953 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1892
2024-04-19 09:29:09,953 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1425
2024-04-19 09:29:09,953 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0970
2024-04-19 09:29:09,953 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0302
2024-04-19 09:29:09,954 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1574
2024-04-19 09:29:09,954 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1736
2024-04-19 09:29:09,954 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2985
2024-04-19 09:29:09,954 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2702
2024-04-19 09:29:09,954 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2702
2024-04-19 09:29:09,955 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2702
2024-04-19 09:29:09,955 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1956
2024-04-19 09:29:09,955 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2362
2024-04-19 09:29:09,955 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3567
2024-04-19 09:29:09,999 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 09:29:10,000 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.1870, bbox_mAP_50: 0.4210, bbox_mAP_75: 0.3100, bbox_mAP_s: 0.1890, bbox_mAP_m: 0.1430, bbox_mAP_l: 0.0970, bbox_mAP_copypaste: 0.187 0.421 0.310 0.189 0.143 0.097
2024-04-19 09:31:10,458 - mmdet - INFO - Evaluating bbox...
2024-04-19 09:31:12,225 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1871
2024-04-19 09:31:12,225 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4212
2024-04-19 09:31:12,225 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3098
2024-04-19 09:31:12,226 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1892
2024-04-19 09:31:12,226 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1425
2024-04-19 09:31:12,226 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0970
2024-04-19 09:31:12,226 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0302
2024-04-19 09:31:12,226 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1574
2024-04-19 09:31:12,227 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1736
2024-04-19 09:31:12,227 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2985
2024-04-19 09:31:12,227 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2702
2024-04-19 09:31:12,227 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2702
2024-04-19 09:31:12,227 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2702
2024-04-19 09:31:12,228 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1956
2024-04-19 09:31:12,228 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2362
2024-04-19 09:31:12,228 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3567
2024-04-19 09:31:15,010 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 09:31:17,144 - mmdet - INFO - Distributed training: False
2024-04-19 09:31:19,253 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 09:31:21,718 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 09:31:21,718 - mmdet - INFO - Use load_from_local loader
2024-04-19 09:31:22,127 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 09:31:22,151 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 09:31:22,152 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 09:32:50,007 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:01:47, time: 1.757, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.7288, stage0_bag_acc: 23.7213, stage0_mean_ious: 0.4310, stage0_s: 0.0000, stage0_m: 0.0563, stage0_l: 0.2381, stage0_h: 0.4517, stage1_loss_instance_mil: 0.1576, stage1_bag_acc: 11.9534, stage1_neg_loss: 0.0012, stage1_mean_ious: 0.4081, stage1_s: 0.0000, stage1_m: 0.0576, stage1_l: 0.2300, stage1_h: 0.4264, loss: 0.8876, grad_norm: 3.2621
2024-04-19 09:34:11,341 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:58:05, time: 1.627, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.5773, stage0_bag_acc: 59.3183, stage0_mean_ious: 0.3685, stage0_s: 0.0000, stage0_m: 0.0524, stage0_l: 0.2346, stage0_h: 0.3852, stage1_loss_instance_mil: 0.2484, stage1_bag_acc: 27.2818, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.3488, stage1_s: 0.0000, stage1_m: 0.0555, stage1_l: 0.2282, stage1_h: 0.3638, loss: 0.8297, grad_norm: 4.4175
2024-04-19 09:35:35,669 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:56:36, time: 1.687, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.2692, stage0_bag_acc: 84.7894, stage0_mean_ious: 0.3315, stage0_s: 0.0000, stage0_m: 0.0331, stage0_l: 0.2268, stage0_h: 0.3407, stage1_loss_instance_mil: 0.3374, stage1_bag_acc: 81.8355, stage1_neg_loss: 0.0678, stage1_mean_ious: 0.3166, stage1_s: 0.0000, stage1_m: 0.0304, stage1_l: 0.2361, stage1_h: 0.3210, loss: 0.6744, grad_norm: 12.3225
2024-04-19 09:36:26,107 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 09:37:56,589 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:47:41, time: 1.749, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0850, stage0_bag_acc: 96.0830, stage0_mean_ious: 0.3148, stage0_s: 0.0017, stage0_m: 0.0445, stage0_l: 0.1676, stage0_h: 0.3356, stage1_loss_instance_mil: 0.4051, stage1_bag_acc: 96.7869, stage1_neg_loss: 0.0905, stage1_mean_ious: 0.2902, stage1_s: 0.0019, stage1_m: 0.0501, stage1_l: 0.1728, stage1_h: 0.3063, loss: 0.5805, grad_norm: 12.3697
2024-04-19 09:39:21,075 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:36, time: 1.690, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0762, stage0_bag_acc: 95.6417, stage0_mean_ious: 0.3300, stage0_s: 0.0000, stage0_m: 0.0587, stage0_l: 0.1355, stage0_h: 0.3568, stage1_loss_instance_mil: 0.3506, stage1_bag_acc: 96.5710, stage1_neg_loss: 0.0930, stage1_mean_ious: 0.3049, stage1_s: 0.0000, stage1_m: 0.0544, stage1_l: 0.1350, stage1_h: 0.3275, loss: 0.5198, grad_norm: 13.5680
2024-04-19 09:40:45,081 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:05, time: 1.680, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0593, stage0_bag_acc: 96.4716, stage0_mean_ious: 0.3317, stage0_s: 0.0000, stage0_m: 0.0646, stage0_l: 0.1300, stage0_h: 0.3511, stage1_loss_instance_mil: 0.3181, stage1_bag_acc: 97.6231, stage1_neg_loss: 0.0974, stage1_mean_ious: 0.3010, stage1_s: 0.0000, stage1_m: 0.0546, stage1_l: 0.1157, stage1_h: 0.3184, loss: 0.4747, grad_norm: 16.8873
2024-04-19 09:41:35,918 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 09:43:06,562 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:28, time: 1.751, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0381, stage0_bag_acc: 97.4384, stage0_mean_ious: 0.3890, stage0_s: 0.0000, stage0_m: 0.0388, stage0_l: 0.1267, stage0_h: 0.4219, stage1_loss_instance_mil: 0.2749, stage1_bag_acc: 98.8597, stage1_neg_loss: 0.0916, stage1_mean_ious: 0.3456, stage1_s: 0.0000, stage1_m: 0.0293, stage1_l: 0.1149, stage1_h: 0.3759, loss: 0.4046, grad_norm: 16.7525
2024-04-19 09:44:29,969 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:41:54, time: 1.668, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0303, stage0_bag_acc: 98.3973, stage0_mean_ious: 0.3757, stage0_s: 0.0000, stage0_m: 0.0595, stage0_l: 0.1378, stage0_h: 0.4201, stage1_loss_instance_mil: 0.2829, stage1_bag_acc: 99.5416, stage1_neg_loss: 0.0862, stage1_mean_ious: 0.3333, stage1_s: 0.0000, stage1_m: 0.0570, stage1_l: 0.1296, stage1_h: 0.3717, loss: 0.3994, grad_norm: 18.6518
2024-04-19 09:45:55,753 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:18, time: 1.716, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0220, stage0_bag_acc: 98.7526, stage0_mean_ious: 0.3330, stage0_s: 0.0000, stage0_m: 0.0381, stage0_l: 0.1167, stage0_h: 0.3627, stage1_loss_instance_mil: 0.2711, stage1_bag_acc: 99.1323, stage1_neg_loss: 0.0823, stage1_mean_ious: 0.2943, stage1_s: 0.0000, stage1_m: 0.0373, stage1_l: 0.1073, stage1_h: 0.3211, loss: 0.3755, grad_norm: 15.2069
2024-04-19 09:46:47,046 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 09:48:17,188 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:50, time: 1.743, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0457, stage0_bag_acc: 96.7584, stage0_mean_ious: 0.3197, stage0_s: 0.0000, stage0_m: 0.0447, stage0_l: 0.1145, stage0_h: 0.3565, stage1_loss_instance_mil: 0.2270, stage1_bag_acc: 97.8339, stage1_neg_loss: 0.0763, stage1_mean_ious: 0.2774, stage1_s: 0.0000, stage1_m: 0.0346, stage1_l: 0.0899, stage1_h: 0.3124, loss: 0.3490, grad_norm: 14.9464
2024-04-19 09:49:42,237 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:08, time: 1.701, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0396, stage0_bag_acc: 97.5780, stage0_mean_ious: 0.3238, stage0_s: 0.0000, stage0_m: 0.0199, stage0_l: 0.0965, stage0_h: 0.3479, stage1_loss_instance_mil: 0.2945, stage1_bag_acc: 98.3208, stage1_neg_loss: 0.0876, stage1_mean_ious: 0.2843, stage1_s: 0.0000, stage1_m: 0.0153, stage1_l: 0.0828, stage1_h: 0.3062, loss: 0.4217, grad_norm: 19.9161
2024-04-19 09:51:05,534 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:16, time: 1.666, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0328, stage0_bag_acc: 98.0111, stage0_mean_ious: 0.2563, stage0_s: 0.0011, stage0_m: 0.0579, stage0_l: 0.1117, stage0_h: 0.2772, stage1_loss_instance_mil: 0.2564, stage1_bag_acc: 99.0852, stage1_neg_loss: 0.0760, stage1_mean_ious: 0.2281, stage1_s: 0.0016, stage1_m: 0.0519, stage1_l: 0.1013, stage1_h: 0.2468, loss: 0.3653, grad_norm: 14.6542
2024-04-19 09:51:56,238 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 09:53:26,457 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:21, time: 1.745, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0310, stage0_bag_acc: 97.9207, stage0_mean_ious: 0.2651, stage0_s: 0.0000, stage0_m: 0.0257, stage0_l: 0.1052, stage0_h: 0.2851, stage1_loss_instance_mil: 0.2145, stage1_bag_acc: 98.8538, stage1_neg_loss: 0.0707, stage1_mean_ious: 0.2376, stage1_s: 0.0000, stage1_m: 0.0176, stage1_l: 0.0900, stage1_h: 0.2571, loss: 0.3161, grad_norm: 11.4541
2024-04-19 09:54:51,596 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:31, time: 1.703, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0131, stage0_bag_acc: 99.5768, stage0_mean_ious: 0.2489, stage0_s: 0.0020, stage0_m: 0.0228, stage0_l: 0.1010, stage0_h: 0.2622, stage1_loss_instance_mil: 0.2033, stage1_bag_acc: 99.9167, stage1_neg_loss: 0.0679, stage1_mean_ious: 0.2233, stage1_s: 0.0016, stage1_m: 0.0238, stage1_l: 0.0981, stage1_h: 0.2336, loss: 0.2843, grad_norm: 10.6710
2024-04-19 09:56:15,121 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:34, time: 1.670, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0163, stage0_bag_acc: 99.1611, stage0_mean_ious: 0.2183, stage0_s: 0.0000, stage0_m: 0.0250, stage0_l: 0.0925, stage0_h: 0.2374, stage1_loss_instance_mil: 0.1805, stage1_bag_acc: 98.8327, stage1_neg_loss: 0.0709, stage1_mean_ious: 0.1979, stage1_s: 0.0000, stage1_m: 0.0228, stage1_l: 0.0896, stage1_h: 0.2142, loss: 0.2677, grad_norm: 11.4692
2024-04-19 09:57:06,080 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 09:58:34,949 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:56, time: 1.716, data_time: 0.091, memory: 17809, stage0_loss_instance_mil: 0.0108, stage0_bag_acc: 99.3455, stage0_mean_ious: 0.2036, stage0_s: 0.0015, stage0_m: 0.0204, stage0_l: 0.0914, stage0_h: 0.2151, stage1_loss_instance_mil: 0.1833, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0669, stage1_mean_ious: 0.1847, stage1_s: 0.0016, stage1_m: 0.0206, stage1_l: 0.0840, stage1_h: 0.1945, loss: 0.2609, grad_norm: 9.6036
2024-04-19 09:59:57,776 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 09:59:57,777 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:27:57, time: 1.657, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0192, stage0_bag_acc: 99.2804, stage0_mean_ious: 0.2036, stage0_s: 0.0000, stage0_m: 0.0186, stage0_l: 0.0882, stage0_h: 0.2185, stage1_loss_instance_mil: 0.1762, stage1_bag_acc: 99.1362, stage1_neg_loss: 0.0627, stage1_mean_ious: 0.1882, stage1_s: 0.0000, stage1_m: 0.0156, stage1_l: 0.0825, stage1_h: 0.2023, loss: 0.2582, grad_norm: 11.5246
2024-04-19 10:01:21,287 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:26:57, time: 1.670, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0252, stage0_bag_acc: 98.9230, stage0_mean_ious: 0.1754, stage0_s: 0.0000, stage0_m: 0.0386, stage0_l: 0.0955, stage0_h: 0.1820, stage1_loss_instance_mil: 0.1716, stage1_bag_acc: 98.4710, stage1_neg_loss: 0.0703, stage1_mean_ious: 0.1666, stage1_s: 0.0000, stage1_m: 0.0339, stage1_l: 0.0964, stage1_h: 0.1732, loss: 0.2671, grad_norm: 10.5038
2024-04-19 10:02:11,104 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 10:04:09,003 - mmdet - INFO - Evaluating bbox...
2024-04-19 10:04:10,851 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0029
2024-04-19 10:04:10,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0163
2024-04-19 10:04:10,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0032
2024-04-19 10:04:10,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0002
2024-04-19 10:04:10,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0001
2024-04-19 10:04:10,852 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 10:04:10,853 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 10:04:10,853 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-04-19 10:04:10,853 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0028
2024-04-19 10:04:10,853 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0039
2024-04-19 10:04:10,854 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0181
2024-04-19 10:04:10,854 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0181
2024-04-19 10:04:10,854 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0181
2024-04-19 10:04:10,854 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0010
2024-04-19 10:04:10,854 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0237
2024-04-19 10:04:10,854 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0106
2024-04-19 10:04:10,897 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 10:04:10,898 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0030, bbox_mAP_50: 0.0160, bbox_mAP_75: 0.0030, bbox_mAP_s: 0.0000, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.003 0.016 0.003 0.000 0.000 0.000
2024-04-19 10:05:38,595 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:34, time: 1.754, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0148, stage0_bag_acc: 99.1583, stage0_mean_ious: 0.1800, stage0_s: 0.0000, stage0_m: 0.0177, stage0_l: 0.0960, stage0_h: 0.1873, stage1_loss_instance_mil: 0.1559, stage1_bag_acc: 99.3162, stage1_neg_loss: 0.0670, stage1_mean_ious: 0.1648, stage1_s: 0.0000, stage1_m: 0.0190, stage1_l: 0.0944, stage1_h: 0.1705, loss: 0.2378, grad_norm: 9.3650
2024-04-19 10:07:00,712 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:31, time: 1.642, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0129, stage0_bag_acc: 99.3435, stage0_mean_ious: 0.1688, stage0_s: 0.0002, stage0_m: 0.0478, stage0_l: 0.1000, stage0_h: 0.1743, stage1_loss_instance_mil: 0.1604, stage1_bag_acc: 99.2299, stage1_neg_loss: 0.0588, stage1_mean_ious: 0.1553, stage1_s: 0.0013, stage1_m: 0.0469, stage1_l: 0.0931, stage1_h: 0.1595, loss: 0.2321, grad_norm: 9.6673
2024-04-19 10:08:25,970 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:29, time: 1.705, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0521, stage0_bag_acc: 96.9096, stage0_mean_ious: 0.1876, stage0_s: 0.0000, stage0_m: 0.0261, stage0_l: 0.0905, stage0_h: 0.1974, stage1_loss_instance_mil: 0.1505, stage1_bag_acc: 97.1793, stage1_neg_loss: 0.0580, stage1_mean_ious: 0.1736, stage1_s: 0.0000, stage1_m: 0.0323, stage1_l: 0.0849, stage1_h: 0.1822, loss: 0.2605, grad_norm: 9.2836
2024-04-19 10:09:14,452 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 10:10:45,362 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:15, time: 1.759, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0134, stage0_bag_acc: 99.2736, stage0_mean_ious: 0.1947, stage0_s: 0.0000, stage0_m: 0.0423, stage0_l: 0.0875, stage0_h: 0.2043, stage1_loss_instance_mil: 0.1463, stage1_bag_acc: 99.6654, stage1_neg_loss: 0.0624, stage1_mean_ious: 0.1805, stage1_s: 0.0000, stage1_m: 0.0410, stage1_l: 0.0852, stage1_h: 0.1889, loss: 0.2221, grad_norm: 9.8547
2024-04-19 10:12:07,593 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:09, time: 1.645, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0137, stage0_bag_acc: 99.4554, stage0_mean_ious: 0.2053, stage0_s: 0.0000, stage0_m: 0.0339, stage0_l: 0.1135, stage0_h: 0.2168, stage1_loss_instance_mil: 0.1290, stage1_bag_acc: 99.4299, stage1_neg_loss: 0.0563, stage1_mean_ious: 0.1912, stage1_s: 0.0000, stage1_m: 0.0377, stage1_l: 0.1060, stage1_h: 0.2006, loss: 0.1991, grad_norm: 7.8306
2024-04-19 10:13:31,386 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:04, time: 1.676, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0108, stage0_bag_acc: 99.3884, stage0_mean_ious: 0.2358, stage0_s: 0.0000, stage0_m: 0.0195, stage0_l: 0.1021, stage0_h: 0.2507, stage1_loss_instance_mil: 0.1363, stage1_bag_acc: 98.8783, stage1_neg_loss: 0.0582, stage1_mean_ious: 0.2127, stage1_s: 0.0000, stage1_m: 0.0178, stage1_l: 0.0979, stage1_h: 0.2256, loss: 0.2052, grad_norm: 10.2297
2024-04-19 10:14:20,735 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 10:15:49,598 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:55, time: 1.718, data_time: 0.093, memory: 17809, stage0_loss_instance_mil: 0.0063, stage0_bag_acc: 99.7388, stage0_mean_ious: 0.2180, stage0_s: 0.0000, stage0_m: 0.0371, stage0_l: 0.0892, stage0_h: 0.2310, stage1_loss_instance_mil: 0.1050, stage1_bag_acc: 99.7381, stage1_neg_loss: 0.0511, stage1_mean_ious: 0.2026, stage1_s: 0.0000, stage1_m: 0.0359, stage1_l: 0.0863, stage1_h: 0.2141, loss: 0.1624, grad_norm: 6.2634
2024-04-19 10:17:12,549 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:48, time: 1.659, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0040, stage0_bag_acc: 99.7889, stage0_mean_ious: 0.2273, stage0_s: 0.0001, stage0_m: 0.0240, stage0_l: 0.0861, stage0_h: 0.2434, stage1_loss_instance_mil: 0.1065, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0527, stage1_mean_ious: 0.2127, stage1_s: 0.0009, stage1_m: 0.0253, stage1_l: 0.0811, stage1_h: 0.2265, loss: 0.1633, grad_norm: 6.2059
2024-04-19 10:18:37,172 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:41, time: 1.692, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.2425, stage0_s: 0.0000, stage0_m: 0.0382, stage0_l: 0.0859, stage0_h: 0.2596, stage1_loss_instance_mil: 0.1044, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0525, stage1_mean_ious: 0.2187, stage1_s: 0.0000, stage1_m: 0.0406, stage1_l: 0.0771, stage1_h: 0.2337, loss: 0.1630, grad_norm: 6.4701
2024-04-19 10:19:28,476 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 10:20:57,301 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:37, time: 1.716, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.7258, stage0_mean_ious: 0.2417, stage0_s: 0.0000, stage0_m: 0.0372, stage0_l: 0.0933, stage0_h: 0.2615, stage1_loss_instance_mil: 0.1041, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0486, stage1_mean_ious: 0.2201, stage1_s: 0.0000, stage1_m: 0.0415, stage1_l: 0.0873, stage1_h: 0.2370, loss: 0.1562, grad_norm: 5.3654
2024-04-19 10:22:21,240 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:29, time: 1.679, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0087, stage0_bag_acc: 99.6833, stage0_mean_ious: 0.2407, stage0_s: 0.0000, stage0_m: 0.0219, stage0_l: 0.0822, stage0_h: 0.2570, stage1_loss_instance_mil: 0.1056, stage1_bag_acc: 99.8048, stage1_neg_loss: 0.0485, stage1_mean_ious: 0.2191, stage1_s: 0.0000, stage1_m: 0.0210, stage1_l: 0.0817, stage1_h: 0.2328, loss: 0.1628, grad_norm: 5.5760
2024-04-19 10:23:43,084 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:20, time: 1.637, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0036, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.2258, stage0_s: 0.0000, stage0_m: 0.0235, stage0_l: 0.1045, stage0_h: 0.2419, stage1_loss_instance_mil: 0.0935, stage1_bag_acc: 99.7824, stage1_neg_loss: 0.0500, stage1_mean_ious: 0.2103, stage1_s: 0.0000, stage1_m: 0.0267, stage1_l: 0.0999, stage1_h: 0.2247, loss: 0.1471, grad_norm: 5.9773
2024-04-19 10:24:33,116 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 10:26:01,043 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:20, time: 1.707, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0071, stage0_bag_acc: 99.8048, stage0_mean_ious: 0.2330, stage0_s: 0.0000, stage0_m: 0.0287, stage0_l: 0.0898, stage0_h: 0.2490, stage1_loss_instance_mil: 0.0974, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0468, stage1_mean_ious: 0.2126, stage1_s: 0.0000, stage1_m: 0.0290, stage1_l: 0.0886, stage1_h: 0.2258, loss: 0.1514, grad_norm: 5.6283
2024-04-19 10:27:25,219 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:11, time: 1.683, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0026, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.2518, stage0_s: 0.0000, stage0_m: 0.0185, stage0_l: 0.0928, stage0_h: 0.2724, stage1_loss_instance_mil: 0.0952, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0494, stage1_mean_ious: 0.2295, stage1_s: 0.0000, stage1_m: 0.0217, stage1_l: 0.0867, stage1_h: 0.2477, loss: 0.1472, grad_norm: 6.0505
2024-04-19 10:28:49,394 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:01, time: 1.683, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0070, stage0_bag_acc: 99.6603, stage0_mean_ious: 0.2388, stage0_s: 0.0000, stage0_m: 0.0222, stage0_l: 0.0782, stage0_h: 0.2552, stage1_loss_instance_mil: 0.0979, stage1_bag_acc: 99.6176, stage1_neg_loss: 0.0482, stage1_mean_ious: 0.2205, stage1_s: 0.0000, stage1_m: 0.0254, stage1_l: 0.0765, stage1_h: 0.2344, loss: 0.1531, grad_norm: 6.1537
2024-04-19 10:29:39,573 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 10:31:07,520 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:04, time: 1.698, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0079, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.2347, stage0_s: 0.0000, stage0_m: 0.0201, stage0_l: 0.0937, stage0_h: 0.2487, stage1_loss_instance_mil: 0.0881, stage1_bag_acc: 99.6667, stage1_neg_loss: 0.0494, stage1_mean_ious: 0.2138, stage1_s: 0.0000, stage1_m: 0.0240, stage1_l: 0.0859, stage1_h: 0.2258, loss: 0.1454, grad_norm: 5.7311
2024-04-19 10:32:32,520 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:54, time: 1.700, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.9286, stage0_mean_ious: 0.2304, stage0_s: 0.0000, stage0_m: 0.0366, stage0_l: 0.0894, stage0_h: 0.2458, stage1_loss_instance_mil: 0.1099, stage1_bag_acc: 99.9286, stage1_neg_loss: 0.0455, stage1_mean_ious: 0.2136, stage1_s: 0.0004, stage1_m: 0.0390, stage1_l: 0.0919, stage1_h: 0.2258, loss: 0.1588, grad_norm: 5.3191
2024-04-19 10:33:54,810 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:42, time: 1.646, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0025, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.2363, stage0_s: 0.0000, stage0_m: 0.0609, stage0_l: 0.1231, stage0_h: 0.2559, stage1_loss_instance_mil: 0.0941, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0421, stage1_mean_ious: 0.2193, stage1_s: 0.0000, stage1_m: 0.0580, stage1_l: 0.1281, stage1_h: 0.2351, loss: 0.1386, grad_norm: 5.6068
2024-04-19 10:34:45,297 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 10:36:43,144 - mmdet - INFO - Evaluating bbox...
2024-04-19 10:36:45,206 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0405
2024-04-19 10:36:45,207 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1254
2024-04-19 10:36:45,207 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0818
2024-04-19 10:36:45,207 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0279
2024-04-19 10:36:45,208 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0074
2024-04-19 10:36:45,208 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0005
2024-04-19 10:36:45,208 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 10:36:45,208 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-04-19 10:36:45,209 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0102
2024-04-19 10:36:45,209 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0518
2024-04-19 10:36:45,209 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0672
2024-04-19 10:36:45,209 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0672
2024-04-19 10:36:45,209 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0672
2024-04-19 10:36:45,209 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0012
2024-04-19 10:36:45,210 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0431
2024-04-19 10:36:45,210 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0608
2024-04-19 10:36:45,255 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 10:36:45,255 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0400, bbox_mAP_50: 0.1250, bbox_mAP_75: 0.0820, bbox_mAP_s: 0.0280, bbox_mAP_m: 0.0070, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.040 0.125 0.082 0.028 0.007 0.000
2024-04-19 10:38:42,899 - mmdet - INFO - Evaluating bbox...
2024-04-19 10:38:44,772 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0405
2024-04-19 10:38:44,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.1254
2024-04-19 10:38:44,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0818
2024-04-19 10:38:44,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0279
2024-04-19 10:38:44,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0074
2024-04-19 10:38:44,773 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0005
2024-04-19 10:38:44,774 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 10:38:44,774 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-04-19 10:38:44,774 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0102
2024-04-19 10:38:44,774 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0518
2024-04-19 10:38:44,775 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0672
2024-04-19 10:38:44,775 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0672
2024-04-19 10:38:44,775 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0672
2024-04-19 10:38:44,775 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0012
2024-04-19 10:38:44,775 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0431
2024-04-19 10:38:44,775 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0608
2024-04-19 10:38:47,487 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 10:38:49,616 - mmdet - INFO - Distributed training: False
2024-04-19 10:38:51,754 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 10:38:54,268 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 10:38:54,269 - mmdet - INFO - Use load_from_local loader
2024-04-19 10:38:54,672 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 10:38:54,698 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 10:38:54,699 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 10:40:19,916 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 0:59:55, time: 1.704, data_time: 0.093, memory: 17809, stage0_loss_instance_mil: 0.7381, stage0_bag_acc: 5.0731, stage0_mean_ious: 0.3713, stage0_s: 0.0000, stage0_m: 0.0737, stage0_l: 0.2329, stage0_h: 0.3886, stage1_loss_instance_mil: 0.1503, stage1_bag_acc: 24.8860, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.3647, stage1_s: 0.0000, stage1_m: 0.0658, stage1_l: 0.2360, stage1_h: 0.3823, loss: 0.8894, grad_norm: 3.3246
2024-04-19 10:41:41,575 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:57:17, time: 1.633, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.6255, stage0_bag_acc: 46.0975, stage0_mean_ious: 0.3702, stage0_s: 0.0000, stage0_m: 0.0374, stage0_l: 0.2570, stage0_h: 0.3850, stage1_loss_instance_mil: 0.2119, stage1_bag_acc: 24.6096, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.3551, stage1_s: 0.0000, stage1_m: 0.0302, stage1_l: 0.2402, stage1_h: 0.3704, loss: 0.8405, grad_norm: 3.0948
2024-04-19 10:43:06,439 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:56:13, time: 1.697, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.2806, stage0_bag_acc: 84.8047, stage0_mean_ious: 0.4046, stage0_s: 0.0000, stage0_m: 0.0358, stage0_l: 0.2169, stage0_h: 0.4215, stage1_loss_instance_mil: 0.3395, stage1_bag_acc: 71.0524, stage1_neg_loss: 0.0587, stage1_mean_ious: 0.3715, stage1_s: 0.0000, stage1_m: 0.0319, stage1_l: 0.2137, stage1_h: 0.3860, loss: 0.6789, grad_norm: 10.1097
2024-04-19 10:43:57,289 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 10:45:26,286 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:47:13, time: 1.719, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0780, stage0_bag_acc: 96.4295, stage0_mean_ious: 0.3669, stage0_s: 0.0017, stage0_m: 0.0409, stage0_l: 0.1610, stage0_h: 0.3882, stage1_loss_instance_mil: 0.3475, stage1_bag_acc: 97.3701, stage1_neg_loss: 0.0927, stage1_mean_ious: 0.3230, stage1_s: 0.0016, stage1_m: 0.0344, stage1_l: 0.1339, stage1_h: 0.3434, loss: 0.5182, grad_norm: 14.3176
2024-04-19 10:46:51,028 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:16, time: 1.695, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0774, stage0_bag_acc: 95.2471, stage0_mean_ious: 0.3453, stage0_s: 0.0000, stage0_m: 0.0489, stage0_l: 0.1346, stage0_h: 0.3758, stage1_loss_instance_mil: 0.3045, stage1_bag_acc: 96.1964, stage1_neg_loss: 0.0974, stage1_mean_ious: 0.3055, stage1_s: 0.0000, stage1_m: 0.0378, stage1_l: 0.1228, stage1_h: 0.3327, loss: 0.4793, grad_norm: 15.6228
2024-04-19 10:48:14,923 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:46:47, time: 1.678, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0567, stage0_bag_acc: 96.7524, stage0_mean_ious: 0.3271, stage0_s: 0.0000, stage0_m: 0.0427, stage0_l: 0.1334, stage0_h: 0.3456, stage1_loss_instance_mil: 0.2942, stage1_bag_acc: 97.8567, stage1_neg_loss: 0.0868, stage1_mean_ious: 0.2882, stage1_s: 0.0000, stage1_m: 0.0333, stage1_l: 0.1115, stage1_h: 0.3069, loss: 0.4378, grad_norm: 13.6422
2024-04-19 10:49:06,328 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 10:50:35,581 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:09, time: 1.724, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0515, stage0_bag_acc: 96.9598, stage0_mean_ious: 0.3217, stage0_s: 0.0000, stage0_m: 0.0538, stage0_l: 0.1294, stage0_h: 0.3515, stage1_loss_instance_mil: 0.2822, stage1_bag_acc: 98.0301, stage1_neg_loss: 0.0933, stage1_mean_ious: 0.2841, stage1_s: 0.0000, stage1_m: 0.0374, stage1_l: 0.1048, stage1_h: 0.3137, loss: 0.4271, grad_norm: 15.7877
2024-04-19 10:52:00,314 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:41:43, time: 1.695, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0312, stage0_bag_acc: 98.2603, stage0_mean_ious: 0.3148, stage0_s: 0.0000, stage0_m: 0.0415, stage0_l: 0.1216, stage0_h: 0.3376, stage1_loss_instance_mil: 0.2901, stage1_bag_acc: 98.9456, stage1_neg_loss: 0.0870, stage1_mean_ious: 0.2703, stage1_s: 0.0000, stage1_m: 0.0296, stage1_l: 0.0935, stage1_h: 0.2924, loss: 0.4084, grad_norm: 15.1972
2024-04-19 10:53:25,846 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:07, time: 1.711, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0222, stage0_bag_acc: 98.9795, stage0_mean_ious: 0.3000, stage0_s: 0.0000, stage0_m: 0.0310, stage0_l: 0.1108, stage0_h: 0.3207, stage1_loss_instance_mil: 0.2637, stage1_bag_acc: 99.2555, stage1_neg_loss: 0.0793, stage1_mean_ious: 0.2641, stage1_s: 0.0000, stage1_m: 0.0207, stage1_l: 0.0900, stage1_h: 0.2841, loss: 0.3652, grad_norm: 12.8296
2024-04-19 10:54:15,880 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 10:55:46,824 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:45, time: 1.769, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0353, stage0_bag_acc: 97.8987, stage0_mean_ious: 0.3384, stage0_s: 0.0012, stage0_m: 0.0228, stage0_l: 0.1005, stage0_h: 0.3652, stage1_loss_instance_mil: 0.2241, stage1_bag_acc: 99.1952, stage1_neg_loss: 0.0750, stage1_mean_ious: 0.2976, stage1_s: 0.0017, stage1_m: 0.0144, stage1_l: 0.0794, stage1_h: 0.3239, loss: 0.3344, grad_norm: 11.6137
2024-04-19 10:57:11,148 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:01, time: 1.686, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0223, stage0_bag_acc: 98.4610, stage0_mean_ious: 0.3280, stage0_s: 0.0000, stage0_m: 0.0383, stage0_l: 0.1005, stage0_h: 0.3561, stage1_loss_instance_mil: 0.2105, stage1_bag_acc: 98.7050, stage1_neg_loss: 0.0718, stage1_mean_ious: 0.2948, stage1_s: 0.0000, stage1_m: 0.0277, stage1_l: 0.0784, stage1_h: 0.3227, loss: 0.3046, grad_norm: 11.1864
2024-04-19 10:58:35,023 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:11, time: 1.677, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0257, stage0_bag_acc: 98.4431, stage0_mean_ious: 0.3147, stage0_s: 0.0000, stage0_m: 0.0321, stage0_l: 0.0993, stage0_h: 0.3371, stage1_loss_instance_mil: 0.1881, stage1_bag_acc: 99.1329, stage1_neg_loss: 0.0692, stage1_mean_ious: 0.2808, stage1_s: 0.0000, stage1_m: 0.0210, stage1_l: 0.0733, stage1_h: 0.3034, loss: 0.2831, grad_norm: 10.0385
2024-04-19 10:59:25,105 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 11:00:53,822 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:14, time: 1.714, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0133, stage0_bag_acc: 99.3351, stage0_mean_ious: 0.3416, stage0_s: 0.0000, stage0_m: 0.0340, stage0_l: 0.1127, stage0_h: 0.3756, stage1_loss_instance_mil: 0.1752, stage1_bag_acc: 99.3278, stage1_neg_loss: 0.0651, stage1_mean_ious: 0.3040, stage1_s: 0.0000, stage1_m: 0.0204, stage1_l: 0.0941, stage1_h: 0.3365, loss: 0.2536, grad_norm: 11.0842
2024-04-19 11:02:17,032 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:21, time: 1.664, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0214, stage0_bag_acc: 98.9386, stage0_mean_ious: 0.3172, stage0_s: 0.0000, stage0_m: 0.0383, stage0_l: 0.1248, stage0_h: 0.3454, stage1_loss_instance_mil: 0.1726, stage1_bag_acc: 99.1781, stage1_neg_loss: 0.0741, stage1_mean_ious: 0.2868, stage1_s: 0.0000, stage1_m: 0.0254, stage1_l: 0.1066, stage1_h: 0.3136, loss: 0.2681, grad_norm: 12.1879
2024-04-19 11:03:40,999 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:26, time: 1.679, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0124, stage0_bag_acc: 99.4578, stage0_mean_ious: 0.3478, stage0_s: 0.0013, stage0_m: 0.0413, stage0_l: 0.0984, stage0_h: 0.3823, stage1_loss_instance_mil: 0.1461, stage1_bag_acc: 99.8139, stage1_neg_loss: 0.0552, stage1_mean_ious: 0.3072, stage1_s: 0.0011, stage1_m: 0.0272, stage1_l: 0.0786, stage1_h: 0.3396, loss: 0.2137, grad_norm: 8.9185
2024-04-19 11:04:29,905 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 11:05:58,054 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:49, time: 1.704, data_time: 0.090, memory: 17809, stage0_loss_instance_mil: 0.0179, stage0_bag_acc: 98.8972, stage0_mean_ious: 0.3267, stage0_s: 0.0004, stage0_m: 0.0133, stage0_l: 0.1050, stage0_h: 0.3567, stage1_loss_instance_mil: 0.1539, stage1_bag_acc: 98.8872, stage1_neg_loss: 0.0648, stage1_mean_ious: 0.2921, stage1_s: 0.0014, stage1_m: 0.0082, stage1_l: 0.0778, stage1_h: 0.3223, loss: 0.2366, grad_norm: 11.9010
2024-04-19 11:07:20,914 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 11:07:20,915 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:27:50, time: 1.657, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0145, stage0_bag_acc: 99.2796, stage0_mean_ious: 0.2942, stage0_s: 0.0000, stage0_m: 0.0453, stage0_l: 0.1161, stage0_h: 0.3225, stage1_loss_instance_mil: 0.1506, stage1_bag_acc: 99.1240, stage1_neg_loss: 0.0596, stage1_mean_ious: 0.2648, stage1_s: 0.0000, stage1_m: 0.0318, stage1_l: 0.0992, stage1_h: 0.2916, loss: 0.2246, grad_norm: 9.2312
2024-04-19 11:08:43,934 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:26:50, time: 1.660, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0151, stage0_bag_acc: 99.1124, stage0_mean_ious: 0.3244, stage0_s: 0.0000, stage0_m: 0.0206, stage0_l: 0.0817, stage0_h: 0.3551, stage1_loss_instance_mil: 0.1354, stage1_bag_acc: 99.3163, stage1_neg_loss: 0.0577, stage1_mean_ious: 0.2887, stage1_s: 0.0000, stage1_m: 0.0143, stage1_l: 0.0684, stage1_h: 0.3173, loss: 0.2082, grad_norm: 10.0472
2024-04-19 11:09:34,687 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 11:11:33,447 - mmdet - INFO - Evaluating bbox...
2024-04-19 11:11:35,336 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0782
2024-04-19 11:11:35,336 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2252
2024-04-19 11:11:35,337 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1403
2024-04-19 11:11:35,337 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0712
2024-04-19 11:11:35,337 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0389
2024-04-19 11:11:35,337 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0145
2024-04-19 11:11:35,337 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0002
2024-04-19 11:11:35,338 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0094
2024-04-19 11:11:35,338 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0745
2024-04-19 11:11:35,338 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1083
2024-04-19 11:11:35,338 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1243
2024-04-19 11:11:35,339 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1243
2024-04-19 11:11:35,339 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1243
2024-04-19 11:11:35,339 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0735
2024-04-19 11:11:35,339 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1188
2024-04-19 11:11:35,339 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1680
2024-04-19 11:11:35,382 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 11:11:35,383 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0780, bbox_mAP_50: 0.2250, bbox_mAP_75: 0.1400, bbox_mAP_s: 0.0710, bbox_mAP_m: 0.0390, bbox_mAP_l: 0.0140, bbox_mAP_copypaste: 0.078 0.225 0.140 0.071 0.039 0.014
2024-04-19 11:13:01,436 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:26, time: 1.720, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0072, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.3214, stage0_s: 0.0003, stage0_m: 0.0394, stage0_l: 0.0886, stage0_h: 0.3563, stage1_loss_instance_mil: 0.1211, stage1_bag_acc: 99.3759, stage1_neg_loss: 0.0501, stage1_mean_ious: 0.2823, stage1_s: 0.0013, stage1_m: 0.0247, stage1_l: 0.0735, stage1_h: 0.3148, loss: 0.1785, grad_norm: 7.9514
2024-04-19 11:14:26,493 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:27, time: 1.701, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0214, stage0_bag_acc: 98.7913, stage0_mean_ious: 0.3299, stage0_s: 0.0000, stage0_m: 0.0178, stage0_l: 0.1169, stage0_h: 0.3602, stage1_loss_instance_mil: 0.1269, stage1_bag_acc: 99.0599, stage1_neg_loss: 0.0510, stage1_mean_ious: 0.2931, stage1_s: 0.0000, stage1_m: 0.0118, stage1_l: 0.1002, stage1_h: 0.3216, loss: 0.1992, grad_norm: 8.7053
2024-04-19 11:15:48,530 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:23, time: 1.641, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0104, stage0_bag_acc: 99.3026, stage0_mean_ious: 0.3228, stage0_s: 0.0000, stage0_m: 0.0265, stage0_l: 0.0890, stage0_h: 0.3498, stage1_loss_instance_mil: 0.1043, stage1_bag_acc: 99.3774, stage1_neg_loss: 0.0493, stage1_mean_ious: 0.2862, stage1_s: 0.0000, stage1_m: 0.0166, stage1_l: 0.0686, stage1_h: 0.3131, loss: 0.1640, grad_norm: 7.6559
2024-04-19 11:16:38,247 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 11:18:06,279 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:08, time: 1.708, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0070, stage0_bag_acc: 99.7528, stage0_mean_ious: 0.3572, stage0_s: 0.0000, stage0_m: 0.0306, stage0_l: 0.1113, stage0_h: 0.3900, stage1_loss_instance_mil: 0.0998, stage1_bag_acc: 99.8258, stage1_neg_loss: 0.0522, stage1_mean_ious: 0.3143, stage1_s: 0.0000, stage1_m: 0.0195, stage1_l: 0.0907, stage1_h: 0.3443, loss: 0.1590, grad_norm: 7.5833
2024-04-19 11:19:29,274 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:04, time: 1.660, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0123, stage0_bag_acc: 99.5538, stage0_mean_ious: 0.3370, stage0_s: 0.0000, stage0_m: 0.0341, stage0_l: 0.0973, stage0_h: 0.3695, stage1_loss_instance_mil: 0.1077, stage1_bag_acc: 99.5075, stage1_neg_loss: 0.0513, stage1_mean_ious: 0.2939, stage1_s: 0.0000, stage1_m: 0.0234, stage1_l: 0.0765, stage1_h: 0.3232, loss: 0.1713, grad_norm: 8.1170
2024-04-19 11:20:50,782 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:17:57, time: 1.630, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0083, stage0_bag_acc: 99.6350, stage0_mean_ious: 0.3604, stage0_s: 0.0000, stage0_m: 0.0340, stage0_l: 0.0947, stage0_h: 0.3965, stage1_loss_instance_mil: 0.1122, stage1_bag_acc: 99.7350, stage1_neg_loss: 0.0472, stage1_mean_ious: 0.3105, stage1_s: 0.0000, stage1_m: 0.0234, stage1_l: 0.0819, stage1_h: 0.3417, loss: 0.1677, grad_norm: 7.5093
2024-04-19 11:21:42,235 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 11:23:12,673 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:50, time: 1.748, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0072, stage0_bag_acc: 99.8019, stage0_mean_ious: 0.3639, stage0_s: 0.0000, stage0_m: 0.0321, stage0_l: 0.0958, stage0_h: 0.3970, stage1_loss_instance_mil: 0.0996, stage1_bag_acc: 99.6769, stage1_neg_loss: 0.0394, stage1_mean_ious: 0.3172, stage1_s: 0.0000, stage1_m: 0.0236, stage1_l: 0.0820, stage1_h: 0.3474, loss: 0.1462, grad_norm: 6.8652
2024-04-19 11:24:37,335 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:45, time: 1.693, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0079, stage0_bag_acc: 99.3462, stage0_mean_ious: 0.3898, stage0_s: 0.0000, stage0_m: 0.0236, stage0_l: 0.0941, stage0_h: 0.4200, stage1_loss_instance_mil: 0.0798, stage1_bag_acc: 99.6697, stage1_neg_loss: 0.0407, stage1_mean_ious: 0.3390, stage1_s: 0.0000, stage1_m: 0.0140, stage1_l: 0.0797, stage1_h: 0.3658, loss: 0.1284, grad_norm: 5.6473
2024-04-19 11:26:01,590 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:38, time: 1.685, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0055, stage0_bag_acc: 99.5623, stage0_mean_ious: 0.3728, stage0_s: 0.0000, stage0_m: 0.0426, stage0_l: 0.1079, stage0_h: 0.4137, stage1_loss_instance_mil: 0.0859, stage1_bag_acc: 99.8114, stage1_neg_loss: 0.0379, stage1_mean_ious: 0.3258, stage1_s: 0.0000, stage1_m: 0.0313, stage1_l: 0.0904, stage1_h: 0.3619, loss: 0.1293, grad_norm: 5.1209
2024-04-19 11:26:52,026 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 11:28:21,373 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:35, time: 1.728, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.4749, stage0_mean_ious: 0.3802, stage0_s: 0.0000, stage0_m: 0.0427, stage0_l: 0.0988, stage0_h: 0.4274, stage1_loss_instance_mil: 0.0746, stage1_bag_acc: 99.6921, stage1_neg_loss: 0.0372, stage1_mean_ious: 0.3384, stage1_s: 0.0000, stage1_m: 0.0275, stage1_l: 0.0786, stage1_h: 0.3821, loss: 0.1178, grad_norm: 4.8388
2024-04-19 11:29:45,969 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:27, time: 1.692, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0140, stage0_bag_acc: 99.6508, stage0_mean_ious: 0.3871, stage0_s: 0.0000, stage0_m: 0.0308, stage0_l: 0.1167, stage0_h: 0.4213, stage1_loss_instance_mil: 0.0726, stage1_bag_acc: 99.7619, stage1_neg_loss: 0.0417, stage1_mean_ious: 0.3336, stage1_s: 0.0000, stage1_m: 0.0220, stage1_l: 0.1117, stage1_h: 0.3635, loss: 0.1284, grad_norm: 5.8216
2024-04-19 11:31:08,788 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:18, time: 1.656, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0034, stage0_bag_acc: 99.8130, stage0_mean_ious: 0.3671, stage0_s: 0.0000, stage0_m: 0.0315, stage0_l: 0.1110, stage0_h: 0.4040, stage1_loss_instance_mil: 0.0820, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0400, stage1_mean_ious: 0.3211, stage1_s: 0.0000, stage1_m: 0.0215, stage1_l: 0.0949, stage1_h: 0.3543, loss: 0.1255, grad_norm: 5.5646
2024-04-19 11:31:59,621 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 11:33:27,175 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:19, time: 1.691, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0040, stage0_bag_acc: 99.6923, stage0_mean_ious: 0.3920, stage0_s: 0.0000, stage0_m: 0.0243, stage0_l: 0.1044, stage0_h: 0.4305, stage1_loss_instance_mil: 0.0758, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0391, stage1_mean_ious: 0.3472, stage1_s: 0.0000, stage1_m: 0.0171, stage1_l: 0.0879, stage1_h: 0.3830, loss: 0.1189, grad_norm: 5.5471
2024-04-19 11:34:50,345 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:10, time: 1.663, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0032, stage0_bag_acc: 99.7758, stage0_mean_ious: 0.3878, stage0_s: 0.0000, stage0_m: 0.0317, stage0_l: 0.0952, stage0_h: 0.4242, stage1_loss_instance_mil: 0.0733, stage1_bag_acc: 99.5805, stage1_neg_loss: 0.0394, stage1_mean_ious: 0.3405, stage1_s: 0.0000, stage1_m: 0.0244, stage1_l: 0.0795, stage1_h: 0.3738, loss: 0.1159, grad_norm: 5.2754
2024-04-19 11:36:13,694 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:00, time: 1.667, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0033, stage0_bag_acc: 99.6784, stage0_mean_ious: 0.3953, stage0_s: 0.0000, stage0_m: 0.0453, stage0_l: 0.1033, stage0_h: 0.4400, stage1_loss_instance_mil: 0.0721, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0367, stage1_mean_ious: 0.3438, stage1_s: 0.0000, stage1_m: 0.0317, stage1_l: 0.0854, stage1_h: 0.3843, loss: 0.1121, grad_norm: 5.2040
2024-04-19 11:37:03,269 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 11:38:31,507 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:04, time: 1.714, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.6471, stage0_mean_ious: 0.3935, stage0_s: 0.0000, stage0_m: 0.0221, stage0_l: 0.1142, stage0_h: 0.4321, stage1_loss_instance_mil: 0.0652, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0419, stage1_mean_ious: 0.3452, stage1_s: 0.0000, stage1_m: 0.0129, stage1_l: 0.0931, stage1_h: 0.3811, loss: 0.1107, grad_norm: 5.1525
2024-04-19 11:39:56,143 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:53, time: 1.693, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0062, stage0_bag_acc: 99.8130, stage0_mean_ious: 0.4172, stage0_s: 0.0000, stage0_m: 0.0353, stage0_l: 0.1058, stage0_h: 0.4588, stage1_loss_instance_mil: 0.0694, stage1_bag_acc: 99.7889, stage1_neg_loss: 0.0387, stage1_mean_ious: 0.3691, stage1_s: 0.0000, stage1_m: 0.0250, stage1_l: 0.0875, stage1_h: 0.4073, loss: 0.1143, grad_norm: 5.3777
2024-04-19 11:41:20,274 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:42, time: 1.683, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0021, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.3583, stage0_s: 0.0000, stage0_m: 0.0394, stage0_l: 0.1020, stage0_h: 0.3972, stage1_loss_instance_mil: 0.0705, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0340, stage1_mean_ious: 0.3065, stage1_s: 0.0000, stage1_m: 0.0282, stage1_l: 0.0855, stage1_h: 0.3415, loss: 0.1066, grad_norm: 4.8315
2024-04-19 11:42:10,941 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 11:44:09,407 - mmdet - INFO - Evaluating bbox...
2024-04-19 11:44:11,260 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0768
2024-04-19 11:44:11,260 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2279
2024-04-19 11:44:11,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1473
2024-04-19 11:44:11,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0607
2024-04-19 11:44:11,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0314
2024-04-19 11:44:11,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0101
2024-04-19 11:44:11,261 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-04-19 11:44:11,262 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0169
2024-04-19 11:44:11,262 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0751
2024-04-19 11:44:11,262 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0956
2024-04-19 11:44:11,262 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1238
2024-04-19 11:44:11,262 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1238
2024-04-19 11:44:11,263 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1238
2024-04-19 11:44:11,263 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0383
2024-04-19 11:44:11,263 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1170
2024-04-19 11:44:11,263 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1557
2024-04-19 11:44:11,307 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 11:44:11,307 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0770, bbox_mAP_50: 0.2280, bbox_mAP_75: 0.1470, bbox_mAP_s: 0.0610, bbox_mAP_m: 0.0310, bbox_mAP_l: 0.0100, bbox_mAP_copypaste: 0.077 0.228 0.147 0.061 0.031 0.010
2024-04-19 11:46:09,160 - mmdet - INFO - Evaluating bbox...
2024-04-19 11:46:11,105 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0768
2024-04-19 11:46:11,105 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2279
2024-04-19 11:46:11,105 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1473
2024-04-19 11:46:11,106 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0607
2024-04-19 11:46:11,106 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0314
2024-04-19 11:46:11,106 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0101
2024-04-19 11:46:11,106 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0001
2024-04-19 11:46:11,107 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0169
2024-04-19 11:46:11,107 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0751
2024-04-19 11:46:11,107 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0956
2024-04-19 11:46:11,107 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1238
2024-04-19 11:46:11,107 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1238
2024-04-19 11:46:11,108 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1238
2024-04-19 11:46:11,108 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0383
2024-04-19 11:46:11,108 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1170
2024-04-19 11:46:11,108 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1557
2024-04-19 11:46:13,763 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 11:46:15,886 - mmdet - INFO - Distributed training: False
2024-04-19 11:46:17,838 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 11:46:20,463 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 11:46:20,463 - mmdet - INFO - Use load_from_local loader
2024-04-19 11:46:20,824 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 11:46:20,844 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 11:46:20,845 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 11:47:46,227 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:00:02, time: 1.707, data_time: 0.093, memory: 17809, stage0_loss_instance_mil: 0.7396, stage0_bag_acc: 3.9995, stage0_mean_ious: 0.3812, stage0_s: 0.0000, stage0_m: 0.0699, stage0_l: 0.1840, stage0_h: 0.4072, stage1_loss_instance_mil: 0.1537, stage1_bag_acc: 22.1387, stage1_neg_loss: 0.0011, stage1_mean_ious: 0.3874, stage1_s: 0.0000, stage1_m: 0.0665, stage1_l: 0.2014, stage1_h: 0.4110, loss: 0.8944, grad_norm: 3.2673
2024-04-19 11:49:12,124 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:58:48, time: 1.718, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.6014, stage0_bag_acc: 60.1477, stage0_mean_ious: 0.4261, stage0_s: 0.0000, stage0_m: 0.0425, stage0_l: 0.2623, stage0_h: 0.4363, stage1_loss_instance_mil: 0.2315, stage1_bag_acc: 34.7680, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.4447, stage1_s: 0.0000, stage1_m: 0.0433, stage1_l: 0.2711, stage1_h: 0.4568, loss: 0.8360, grad_norm: 3.3063
2024-04-19 11:50:35,739 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:56:55, time: 1.672, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.2721, stage0_bag_acc: 90.9616, stage0_mean_ious: 0.4253, stage0_s: 0.0000, stage0_m: 0.0581, stage0_l: 0.2743, stage0_h: 0.4448, stage1_loss_instance_mil: 0.3096, stage1_bag_acc: 83.1609, stage1_neg_loss: 0.0647, stage1_mean_ious: 0.4333, stage1_s: 0.0000, stage1_m: 0.0590, stage1_l: 0.3128, stage1_h: 0.4498, loss: 0.6463, grad_norm: 9.0779
2024-04-19 11:51:26,950 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 11:52:56,947 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:47:47, time: 1.738, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0693, stage0_bag_acc: 96.8424, stage0_mean_ious: 0.3965, stage0_s: 0.0000, stage0_m: 0.0603, stage0_l: 0.1709, stage0_h: 0.4214, stage1_loss_instance_mil: 0.3437, stage1_bag_acc: 97.8339, stage1_neg_loss: 0.0879, stage1_mean_ious: 0.3784, stage1_s: 0.0000, stage1_m: 0.0611, stage1_l: 0.1657, stage1_h: 0.4020, loss: 0.5008, grad_norm: 11.6392
2024-04-19 11:54:20,660 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:36, time: 1.674, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0646, stage0_bag_acc: 96.5294, stage0_mean_ious: 0.3181, stage0_s: 0.0000, stage0_m: 0.0524, stage0_l: 0.1577, stage0_h: 0.3392, stage1_loss_instance_mil: 0.3385, stage1_bag_acc: 97.8972, stage1_neg_loss: 0.1025, stage1_mean_ious: 0.3053, stage1_s: 0.0000, stage1_m: 0.0482, stage1_l: 0.1441, stage1_h: 0.3266, loss: 0.5055, grad_norm: 16.0742
2024-04-19 11:55:46,256 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:14, time: 1.712, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0544, stage0_bag_acc: 96.5980, stage0_mean_ious: 0.2510, stage0_s: 0.0000, stage0_m: 0.0529, stage0_l: 0.1509, stage0_h: 0.2661, stage1_loss_instance_mil: 0.3168, stage1_bag_acc: 97.4897, stage1_neg_loss: 0.0871, stage1_mean_ious: 0.2325, stage1_s: 0.0000, stage1_m: 0.0468, stage1_l: 0.1488, stage1_h: 0.2451, loss: 0.4583, grad_norm: 9.4203
2024-04-19 11:56:35,239 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 11:58:04,319 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:28, time: 1.721, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0346, stage0_bag_acc: 97.7895, stage0_mean_ious: 0.2805, stage0_s: 0.0000, stage0_m: 0.0292, stage0_l: 0.1162, stage0_h: 0.2958, stage1_loss_instance_mil: 0.2673, stage1_bag_acc: 98.7625, stage1_neg_loss: 0.0801, stage1_mean_ious: 0.2478, stage1_s: 0.0000, stage1_m: 0.0283, stage1_l: 0.1056, stage1_h: 0.2608, loss: 0.3820, grad_norm: 9.2642
2024-04-19 11:59:25,714 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:41:47, time: 1.628, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0422, stage0_bag_acc: 97.2160, stage0_mean_ious: 0.3074, stage0_s: 0.0000, stage0_m: 0.0485, stage0_l: 0.1138, stage0_h: 0.3295, stage1_loss_instance_mil: 0.3032, stage1_bag_acc: 98.8494, stage1_neg_loss: 0.0832, stage1_mean_ious: 0.2760, stage1_s: 0.0000, stage1_m: 0.0495, stage1_l: 0.1073, stage1_h: 0.2948, loss: 0.4286, grad_norm: 14.1128
2024-04-19 12:00:49,132 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:05, time: 1.668, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0382, stage0_bag_acc: 97.7449, stage0_mean_ious: 0.2996, stage0_s: 0.0000, stage0_m: 0.0580, stage0_l: 0.1462, stage0_h: 0.3224, stage1_loss_instance_mil: 0.2688, stage1_bag_acc: 98.4593, stage1_neg_loss: 0.0825, stage1_mean_ious: 0.2666, stage1_s: 0.0000, stage1_m: 0.0578, stage1_l: 0.1362, stage1_h: 0.2852, loss: 0.3896, grad_norm: 12.0768
2024-04-19 12:01:39,216 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 12:03:06,551 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:33, time: 1.697, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0419, stage0_bag_acc: 97.8274, stage0_mean_ious: 0.2986, stage0_s: 0.0000, stage0_m: 0.0307, stage0_l: 0.1298, stage0_h: 0.3177, stage1_loss_instance_mil: 0.2235, stage1_bag_acc: 97.5999, stage1_neg_loss: 0.0673, stage1_mean_ious: 0.2650, stage1_s: 0.0000, stage1_m: 0.0295, stage1_l: 0.1267, stage1_h: 0.2799, loss: 0.3326, grad_norm: 10.2182
2024-04-19 12:04:30,328 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:36:50, time: 1.676, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0565, stage0_bag_acc: 96.1585, stage0_mean_ious: 0.2919, stage0_s: 0.0000, stage0_m: 0.0307, stage0_l: 0.1360, stage0_h: 0.3092, stage1_loss_instance_mil: 0.2188, stage1_bag_acc: 96.6344, stage1_neg_loss: 0.0846, stage1_mean_ious: 0.2651, stage1_s: 0.0000, stage1_m: 0.0311, stage1_l: 0.1367, stage1_h: 0.2788, loss: 0.3599, grad_norm: 12.6144
2024-04-19 12:05:51,601 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:35:55, time: 1.625, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0241, stage0_bag_acc: 98.9904, stage0_mean_ious: 0.3333, stage0_s: 0.0000, stage0_m: 0.0542, stage0_l: 0.1362, stage0_h: 0.3633, stage1_loss_instance_mil: 0.1721, stage1_bag_acc: 98.6559, stage1_neg_loss: 0.0652, stage1_mean_ious: 0.2990, stage1_s: 0.0000, stage1_m: 0.0569, stage1_l: 0.1381, stage1_h: 0.3215, loss: 0.2614, grad_norm: 7.9961
2024-04-19 12:06:41,765 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 12:08:09,124 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:32:59, time: 1.697, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0183, stage0_bag_acc: 99.0687, stage0_mean_ious: 0.3081, stage0_s: 0.0018, stage0_m: 0.0445, stage0_l: 0.1537, stage0_h: 0.3285, stage1_loss_instance_mil: 0.1862, stage1_bag_acc: 99.2382, stage1_neg_loss: 0.0671, stage1_mean_ious: 0.2727, stage1_s: 0.0020, stage1_m: 0.0477, stage1_l: 0.1519, stage1_h: 0.2874, loss: 0.2716, grad_norm: 9.3169
2024-04-19 12:09:32,157 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:07, time: 1.661, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0181, stage0_bag_acc: 98.9633, stage0_mean_ious: 0.3325, stage0_s: 0.0000, stage0_m: 0.0599, stage0_l: 0.1596, stage0_h: 0.3524, stage1_loss_instance_mil: 0.1705, stage1_bag_acc: 98.8335, stage1_neg_loss: 0.0695, stage1_mean_ious: 0.2994, stage1_s: 0.0000, stage1_m: 0.0571, stage1_l: 0.1619, stage1_h: 0.3144, loss: 0.2582, grad_norm: 10.0715
2024-04-19 12:10:57,303 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:15, time: 1.703, data_time: 0.046, memory: 17809, stage0_loss_instance_mil: 0.0136, stage0_bag_acc: 99.1460, stage0_mean_ious: 0.3684, stage0_s: 0.0000, stage0_m: 0.0272, stage0_l: 0.1403, stage0_h: 0.4011, stage1_loss_instance_mil: 0.1425, stage1_bag_acc: 99.3188, stage1_neg_loss: 0.0582, stage1_mean_ious: 0.3299, stage1_s: 0.0000, stage1_m: 0.0272, stage1_l: 0.1344, stage1_h: 0.3569, loss: 0.2143, grad_norm: 6.7797
2024-04-19 12:11:46,429 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 12:13:16,874 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:42, time: 1.749, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.7462, stage0_mean_ious: 0.4171, stage0_s: 0.0000, stage0_m: 0.0381, stage0_l: 0.1590, stage0_h: 0.4481, stage1_loss_instance_mil: 0.1171, stage1_bag_acc: 99.5479, stage1_neg_loss: 0.0500, stage1_mean_ious: 0.3907, stage1_s: 0.0000, stage1_m: 0.0397, stage1_l: 0.1678, stage1_h: 0.4173, loss: 0.1732, grad_norm: 6.0522
2024-04-19 12:14:38,993 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 12:14:38,993 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:27:43, time: 1.642, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0186, stage0_bag_acc: 99.0017, stage0_mean_ious: 0.4272, stage0_s: 0.0000, stage0_m: 0.0644, stage0_l: 0.1662, stage0_h: 0.4725, stage1_loss_instance_mil: 0.1300, stage1_bag_acc: 99.1911, stage1_neg_loss: 0.0570, stage1_mean_ious: 0.4020, stage1_s: 0.0000, stage1_m: 0.0685, stage1_l: 0.1704, stage1_h: 0.4408, loss: 0.2055, grad_norm: 8.5571
2024-04-19 12:16:03,128 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:26:45, time: 1.683, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0325, stage0_bag_acc: 98.1349, stage0_mean_ious: 0.4263, stage0_s: 0.0000, stage0_m: 0.0405, stage0_l: 0.1664, stage0_h: 0.4589, stage1_loss_instance_mil: 0.1295, stage1_bag_acc: 98.9769, stage1_neg_loss: 0.0551, stage1_mean_ious: 0.4025, stage1_s: 0.0000, stage1_m: 0.0366, stage1_l: 0.1642, stage1_h: 0.4320, loss: 0.2171, grad_norm: 8.1869
2024-04-19 12:16:51,582 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 12:18:53,683 - mmdet - INFO - Evaluating bbox...
2024-04-19 12:18:55,638 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0643
2024-04-19 12:18:55,638 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2025
2024-04-19 12:18:55,639 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1195
2024-04-19 12:18:55,639 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0487
2024-04-19 12:18:55,639 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0246
2024-04-19 12:18:55,639 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0088
2024-04-19 12:18:55,640 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0002
2024-04-19 12:18:55,640 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0087
2024-04-19 12:18:55,640 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0786
2024-04-19 12:18:55,640 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0915
2024-04-19 12:18:55,640 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1351
2024-04-19 12:18:55,641 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1351
2024-04-19 12:18:55,641 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1351
2024-04-19 12:18:55,641 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0968
2024-04-19 12:18:55,641 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1367
2024-04-19 12:18:55,641 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1403
2024-04-19 12:18:55,687 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 12:18:55,687 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0640, bbox_mAP_50: 0.2030, bbox_mAP_75: 0.1200, bbox_mAP_s: 0.0490, bbox_mAP_m: 0.0250, bbox_mAP_l: 0.0090, bbox_mAP_copypaste: 0.064 0.203 0.120 0.049 0.025 0.009
2024-04-19 12:20:22,814 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:23, time: 1.742, data_time: 0.099, memory: 17809, stage0_loss_instance_mil: 0.0142, stage0_bag_acc: 99.4952, stage0_mean_ious: 0.3801, stage0_s: 0.0014, stage0_m: 0.0596, stage0_l: 0.1634, stage0_h: 0.4042, stage1_loss_instance_mil: 0.1155, stage1_bag_acc: 99.1716, stage1_neg_loss: 0.0581, stage1_mean_ious: 0.3579, stage1_s: 0.0010, stage1_m: 0.0624, stage1_l: 0.1783, stage1_h: 0.3772, loss: 0.1879, grad_norm: 7.7058
2024-04-19 12:21:45,574 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:22, time: 1.655, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0092, stage0_bag_acc: 99.6067, stage0_mean_ious: 0.3986, stage0_s: 0.0000, stage0_m: 0.0466, stage0_l: 0.1641, stage0_h: 0.4327, stage1_loss_instance_mil: 0.1151, stage1_bag_acc: 99.2597, stage1_neg_loss: 0.0517, stage1_mean_ious: 0.3657, stage1_s: 0.0000, stage1_m: 0.0529, stage1_l: 0.1622, stage1_h: 0.3944, loss: 0.1760, grad_norm: 6.6854
2024-04-19 12:23:08,058 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:18, time: 1.650, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0164, stage0_bag_acc: 98.8225, stage0_mean_ious: 0.4125, stage0_s: 0.0000, stage0_m: 0.0439, stage0_l: 0.1327, stage0_h: 0.4515, stage1_loss_instance_mil: 0.1101, stage1_bag_acc: 99.1977, stage1_neg_loss: 0.0459, stage1_mean_ious: 0.3903, stage1_s: 0.0000, stage1_m: 0.0458, stage1_l: 0.1363, stage1_h: 0.4246, loss: 0.1725, grad_norm: 6.1883
2024-04-19 12:24:00,675 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 12:25:29,211 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:04, time: 1.709, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0119, stage0_bag_acc: 99.2517, stage0_mean_ious: 0.3703, stage0_s: 0.0010, stage0_m: 0.0668, stage0_l: 0.1452, stage0_h: 0.4070, stage1_loss_instance_mil: 0.0891, stage1_bag_acc: 99.6574, stage1_neg_loss: 0.0463, stage1_mean_ious: 0.3416, stage1_s: 0.0020, stage1_m: 0.0691, stage1_l: 0.1424, stage1_h: 0.3728, loss: 0.1473, grad_norm: 5.3477
2024-04-19 12:26:54,146 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:01, time: 1.699, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0053, stage0_bag_acc: 99.6479, stage0_mean_ious: 0.3929, stage0_s: 0.0000, stage0_m: 0.0685, stage0_l: 0.1398, stage0_h: 0.4180, stage1_loss_instance_mil: 0.0931, stage1_bag_acc: 99.4799, stage1_neg_loss: 0.0416, stage1_mean_ious: 0.3637, stage1_s: 0.0000, stage1_m: 0.0706, stage1_l: 0.1570, stage1_h: 0.3840, loss: 0.1401, grad_norm: 5.3224
2024-04-19 12:28:18,452 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:17:57, time: 1.686, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0164, stage0_bag_acc: 98.9612, stage0_mean_ious: 0.3767, stage0_s: 0.0000, stage0_m: 0.0279, stage0_l: 0.1560, stage0_h: 0.3995, stage1_loss_instance_mil: 0.0817, stage1_bag_acc: 98.7669, stage1_neg_loss: 0.0416, stage1_mean_ious: 0.3547, stage1_s: 0.0000, stage1_m: 0.0265, stage1_l: 0.1578, stage1_h: 0.3742, loss: 0.1398, grad_norm: 4.9003
2024-04-19 12:29:08,512 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 12:30:37,185 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:49, time: 1.717, data_time: 0.093, memory: 17809, stage0_loss_instance_mil: 0.0104, stage0_bag_acc: 99.5890, stage0_mean_ious: 0.4239, stage0_s: 0.0000, stage0_m: 0.0423, stage0_l: 0.1488, stage0_h: 0.4623, stage1_loss_instance_mil: 0.0627, stage1_bag_acc: 99.5766, stage1_neg_loss: 0.0358, stage1_mean_ious: 0.3888, stage1_s: 0.0000, stage1_m: 0.0390, stage1_l: 0.1488, stage1_h: 0.4207, loss: 0.1088, grad_norm: 4.2783
2024-04-19 12:32:00,975 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:43, time: 1.676, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0042, stage0_bag_acc: 99.7592, stage0_mean_ious: 0.4101, stage0_s: 0.0000, stage0_m: 0.0371, stage0_l: 0.1370, stage0_h: 0.4475, stage1_loss_instance_mil: 0.0622, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0349, stage1_mean_ious: 0.3796, stage1_s: 0.0000, stage1_m: 0.0396, stage1_l: 0.1376, stage1_h: 0.4115, loss: 0.1012, grad_norm: 3.9768
2024-04-19 12:33:24,641 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:36, time: 1.673, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0038, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.4305, stage0_s: 0.0000, stage0_m: 0.0370, stage0_l: 0.1686, stage0_h: 0.4654, stage1_loss_instance_mil: 0.0604, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0314, stage1_mean_ious: 0.3915, stage1_s: 0.0000, stage1_m: 0.0389, stage1_l: 0.1566, stage1_h: 0.4207, loss: 0.0957, grad_norm: 3.5914
2024-04-19 12:34:14,558 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 12:35:42,597 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:33, time: 1.702, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0081, stage0_bag_acc: 99.6636, stage0_mean_ious: 0.4026, stage0_s: 0.0000, stage0_m: 0.0540, stage0_l: 0.1330, stage0_h: 0.4288, stage1_loss_instance_mil: 0.0742, stage1_bag_acc: 99.8091, stage1_neg_loss: 0.0340, stage1_mean_ious: 0.3745, stage1_s: 0.0000, stage1_m: 0.0544, stage1_l: 0.1283, stage1_h: 0.3981, loss: 0.1163, grad_norm: 4.2022
2024-04-19 12:37:05,676 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:25, time: 1.662, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0043, stage0_bag_acc: 99.7509, stage0_mean_ious: 0.4064, stage0_s: 0.0000, stage0_m: 0.0178, stage0_l: 0.1400, stage0_h: 0.4352, stage1_loss_instance_mil: 0.0648, stage1_bag_acc: 99.8178, stage1_neg_loss: 0.0337, stage1_mean_ious: 0.3714, stage1_s: 0.0000, stage1_m: 0.0189, stage1_l: 0.1419, stage1_h: 0.3945, loss: 0.1027, grad_norm: 3.7247
2024-04-19 12:38:31,246 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:18, time: 1.711, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0025, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4085, stage0_s: 0.0000, stage0_m: 0.0619, stage0_l: 0.1790, stage0_h: 0.4433, stage1_loss_instance_mil: 0.0582, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0377, stage1_mean_ious: 0.3853, stage1_s: 0.0000, stage1_m: 0.0576, stage1_l: 0.1835, stage1_h: 0.4160, loss: 0.0983, grad_norm: 3.7439
2024-04-19 12:39:20,813 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 12:40:51,521 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:19, time: 1.754, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0064, stage0_bag_acc: 99.8048, stage0_mean_ious: 0.4020, stage0_s: 0.0000, stage0_m: 0.0560, stage0_l: 0.1525, stage0_h: 0.4327, stage1_loss_instance_mil: 0.0628, stage1_bag_acc: 99.6980, stage1_neg_loss: 0.0375, stage1_mean_ious: 0.3731, stage1_s: 0.0000, stage1_m: 0.0631, stage1_l: 0.1627, stage1_h: 0.3983, loss: 0.1066, grad_norm: 4.2551
2024-04-19 12:42:15,235 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:10, time: 1.674, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0022, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.4006, stage0_s: 0.0012, stage0_m: 0.0346, stage0_l: 0.1844, stage0_h: 0.4363, stage1_loss_instance_mil: 0.0692, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0357, stage1_mean_ious: 0.3696, stage1_s: 0.0019, stage1_m: 0.0379, stage1_l: 0.1885, stage1_h: 0.3985, loss: 0.1070, grad_norm: 3.8984
2024-04-19 12:43:38,098 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:00, time: 1.657, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0036, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.4024, stage0_s: 0.0000, stage0_m: 0.0239, stage0_l: 0.1584, stage0_h: 0.4386, stage1_loss_instance_mil: 0.0625, stage1_bag_acc: 99.7917, stage1_neg_loss: 0.0339, stage1_mean_ious: 0.3755, stage1_s: 0.0000, stage1_m: 0.0237, stage1_l: 0.1599, stage1_h: 0.4070, loss: 0.1000, grad_norm: 3.9665
2024-04-19 12:44:28,539 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 12:45:57,495 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:03, time: 1.718, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0034, stage0_bag_acc: 99.7556, stage0_mean_ious: 0.4136, stage0_s: 0.0000, stage0_m: 0.0353, stage0_l: 0.1400, stage0_h: 0.4445, stage1_loss_instance_mil: 0.0551, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0291, stage1_mean_ious: 0.3871, stage1_s: 0.0000, stage1_m: 0.0420, stage1_l: 0.1465, stage1_h: 0.4133, loss: 0.0876, grad_norm: 3.4407
2024-04-19 12:47:21,699 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:53, time: 1.684, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.4067, stage0_s: 0.0000, stage0_m: 0.0299, stage0_l: 0.1559, stage0_h: 0.4424, stage1_loss_instance_mil: 0.0534, stage1_bag_acc: 99.7712, stage1_neg_loss: 0.0332, stage1_mean_ious: 0.3709, stage1_s: 0.0000, stage1_m: 0.0331, stage1_l: 0.1526, stage1_h: 0.4015, loss: 0.0927, grad_norm: 3.7639
2024-04-19 12:48:45,758 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:42, time: 1.681, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0015, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4150, stage0_s: 0.0000, stage0_m: 0.0459, stage0_l: 0.1424, stage0_h: 0.4419, stage1_loss_instance_mil: 0.0611, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0341, stage1_mean_ious: 0.3781, stage1_s: 0.0000, stage1_m: 0.0456, stage1_l: 0.1383, stage1_h: 0.4012, loss: 0.0967, grad_norm: 3.7909
2024-04-19 12:49:36,254 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 12:51:38,143 - mmdet - INFO - Evaluating bbox...
2024-04-19 12:51:40,045 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0854
2024-04-19 12:51:40,046 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2664
2024-04-19 12:51:40,046 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1593
2024-04-19 12:51:40,046 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0638
2024-04-19 12:51:40,047 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0334
2024-04-19 12:51:40,047 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0089
2024-04-19 12:51:40,047 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-04-19 12:51:40,047 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0259
2024-04-19 12:51:40,048 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0997
2024-04-19 12:51:40,048 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1013
2024-04-19 12:51:40,048 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1634
2024-04-19 12:51:40,048 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1634
2024-04-19 12:51:40,048 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1634
2024-04-19 12:51:40,048 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1010
2024-04-19 12:51:40,048 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1657
2024-04-19 12:51:40,048 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1738
2024-04-19 12:51:40,093 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 12:51:40,094 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0850, bbox_mAP_50: 0.2660, bbox_mAP_75: 0.1590, bbox_mAP_s: 0.0640, bbox_mAP_m: 0.0330, bbox_mAP_l: 0.0090, bbox_mAP_copypaste: 0.085 0.266 0.159 0.064 0.033 0.009
2024-04-19 12:53:43,438 - mmdet - INFO - Evaluating bbox...
2024-04-19 12:53:45,312 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0854
2024-04-19 12:53:45,312 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2664
2024-04-19 12:53:45,312 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1593
2024-04-19 12:53:45,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0638
2024-04-19 12:53:45,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0334
2024-04-19 12:53:45,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0089
2024-04-19 12:53:45,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-04-19 12:53:45,313 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0259
2024-04-19 12:53:45,314 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0997
2024-04-19 12:53:45,314 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1013
2024-04-19 12:53:45,314 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1634
2024-04-19 12:53:45,314 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1634
2024-04-19 12:53:45,314 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1634
2024-04-19 12:53:45,314 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1010
2024-04-19 12:53:45,315 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1657
2024-04-19 12:53:45,315 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1738
2024-04-19 12:53:48,064 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 12:53:50,177 - mmdet - INFO - Distributed training: False
2024-04-19 12:53:52,301 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 12:53:54,812 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 12:53:54,812 - mmdet - INFO - Use load_from_local loader
2024-04-19 12:53:55,189 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 12:53:55,216 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 12:53:55,217 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 12:55:21,905 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:00:57, time: 1.734, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.7164, stage0_bag_acc: 22.0694, stage0_mean_ious: 0.3292, stage0_s: 0.0000, stage0_m: 0.0280, stage0_l: 0.1444, stage0_h: 0.3478, stage1_loss_instance_mil: 0.1669, stage1_bag_acc: 19.7361, stage1_neg_loss: 0.0007, stage1_mean_ious: 0.3276, stage1_s: 0.0000, stage1_m: 0.0310, stage1_l: 0.1491, stage1_h: 0.3448, loss: 0.8840, grad_norm: 3.3680
2024-04-19 12:56:48,198 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:23, time: 1.726, data_time: 0.046, memory: 17809, stage0_loss_instance_mil: 0.5737, stage0_bag_acc: 64.1038, stage0_mean_ious: 0.3749, stage0_s: 0.0000, stage0_m: 0.0079, stage0_l: 0.2027, stage0_h: 0.3987, stage1_loss_instance_mil: 0.2598, stage1_bag_acc: 23.1485, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.3689, stage1_s: 0.0000, stage1_m: 0.0087, stage1_l: 0.2058, stage1_h: 0.3910, loss: 0.8365, grad_norm: 3.9032
2024-04-19 12:58:13,972 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:57:47, time: 1.715, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.2224, stage0_bag_acc: 92.7205, stage0_mean_ious: 0.3688, stage0_s: 0.0000, stage0_m: 0.0545, stage0_l: 0.1946, stage0_h: 0.3969, stage1_loss_instance_mil: 0.3819, stage1_bag_acc: 76.5945, stage1_neg_loss: 0.0707, stage1_mean_ious: 0.3405, stage1_s: 0.0000, stage1_m: 0.0474, stage1_l: 0.1800, stage1_h: 0.3650, loss: 0.6750, grad_norm: 12.0827
2024-04-19 12:59:05,076 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 13:00:36,152 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:29, time: 1.759, data_time: 0.099, memory: 17809, stage0_loss_instance_mil: 0.0992, stage0_bag_acc: 95.2181, stage0_mean_ious: 0.3274, stage0_s: 0.0000, stage0_m: 0.0568, stage0_l: 0.2014, stage0_h: 0.3433, stage1_loss_instance_mil: 0.3691, stage1_bag_acc: 95.3032, stage1_neg_loss: 0.0995, stage1_mean_ious: 0.3025, stage1_s: 0.0000, stage1_m: 0.0561, stage1_l: 0.1835, stage1_h: 0.3181, loss: 0.5678, grad_norm: 17.2053
2024-04-19 13:01:59,883 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:48:10, time: 1.675, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0703, stage0_bag_acc: 96.1174, stage0_mean_ious: 0.3073, stage0_s: 0.0000, stage0_m: 0.0341, stage0_l: 0.1212, stage0_h: 0.3296, stage1_loss_instance_mil: 0.3161, stage1_bag_acc: 96.8326, stage1_neg_loss: 0.0878, stage1_mean_ious: 0.2743, stage1_s: 0.0000, stage1_m: 0.0298, stage1_l: 0.1049, stage1_h: 0.2950, loss: 0.4742, grad_norm: 12.7219
2024-04-19 13:03:25,110 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:39, time: 1.705, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0550, stage0_bag_acc: 96.8346, stage0_mean_ious: 0.3479, stage0_s: 0.0000, stage0_m: 0.0230, stage0_l: 0.1211, stage0_h: 0.3764, stage1_loss_instance_mil: 0.3122, stage1_bag_acc: 98.2872, stage1_neg_loss: 0.0878, stage1_mean_ious: 0.3009, stage1_s: 0.0000, stage1_m: 0.0172, stage1_l: 0.1061, stage1_h: 0.3256, loss: 0.4549, grad_norm: 13.0947
2024-04-19 13:04:15,689 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 13:05:46,126 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:54, time: 1.748, data_time: 0.099, memory: 17809, stage0_loss_instance_mil: 0.0337, stage0_bag_acc: 98.0575, stage0_mean_ious: 0.3634, stage0_s: 0.0014, stage0_m: 0.0505, stage0_l: 0.1132, stage0_h: 0.3976, stage1_loss_instance_mil: 0.2759, stage1_bag_acc: 99.1755, stage1_neg_loss: 0.0844, stage1_mean_ious: 0.3140, stage1_s: 0.0015, stage1_m: 0.0453, stage1_l: 0.0942, stage1_h: 0.3448, loss: 0.3940, grad_norm: 12.3696
2024-04-19 13:07:08,913 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:14, time: 1.656, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0691, stage0_bag_acc: 96.2822, stage0_mean_ious: 0.3712, stage0_s: 0.0000, stage0_m: 0.0302, stage0_l: 0.1381, stage0_h: 0.3995, stage1_loss_instance_mil: 0.2645, stage1_bag_acc: 96.8732, stage1_neg_loss: 0.0769, stage1_mean_ious: 0.3310, stage1_s: 0.0000, stage1_m: 0.0256, stage1_l: 0.1241, stage1_h: 0.3563, loss: 0.4105, grad_norm: 13.0987
2024-04-19 13:08:33,634 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:33, time: 1.694, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0540, stage0_bag_acc: 96.7044, stage0_mean_ious: 0.3709, stage0_s: 0.0000, stage0_m: 0.0338, stage0_l: 0.1406, stage0_h: 0.4036, stage1_loss_instance_mil: 0.2360, stage1_bag_acc: 97.7781, stage1_neg_loss: 0.0801, stage1_mean_ious: 0.3269, stage1_s: 0.0000, stage1_m: 0.0323, stage1_l: 0.1211, stage1_h: 0.3559, loss: 0.3701, grad_norm: 12.1122
2024-04-19 13:09:24,950 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 13:10:53,490 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:58, time: 1.710, data_time: 0.090, memory: 17809, stage0_loss_instance_mil: 0.0245, stage0_bag_acc: 98.5267, stage0_mean_ious: 0.3967, stage0_s: 0.0000, stage0_m: 0.0297, stage0_l: 0.1478, stage0_h: 0.4305, stage1_loss_instance_mil: 0.1966, stage1_bag_acc: 98.4937, stage1_neg_loss: 0.0729, stage1_mean_ious: 0.3637, stage1_s: 0.0000, stage1_m: 0.0258, stage1_l: 0.1291, stage1_h: 0.3953, loss: 0.2939, grad_norm: 10.2237
2024-04-19 13:12:17,467 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:12, time: 1.680, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0219, stage0_bag_acc: 98.8400, stage0_mean_ious: 0.4192, stage0_s: 0.0000, stage0_m: 0.0499, stage0_l: 0.1293, stage0_h: 0.4516, stage1_loss_instance_mil: 0.1828, stage1_bag_acc: 98.9945, stage1_neg_loss: 0.0653, stage1_mean_ious: 0.3871, stage1_s: 0.0000, stage1_m: 0.0392, stage1_l: 0.1094, stage1_h: 0.4201, loss: 0.2700, grad_norm: 9.0693
2024-04-19 13:13:40,462 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:19, time: 1.660, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0214, stage0_bag_acc: 98.4174, stage0_mean_ious: 0.4256, stage0_s: 0.0000, stage0_m: 0.0419, stage0_l: 0.1421, stage0_h: 0.4573, stage1_loss_instance_mil: 0.1715, stage1_bag_acc: 99.2442, stage1_neg_loss: 0.0604, stage1_mean_ious: 0.4101, stage1_s: 0.0000, stage1_m: 0.0466, stage1_l: 0.1348, stage1_h: 0.4406, loss: 0.2533, grad_norm: 9.2271
2024-04-19 13:14:31,115 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 13:15:58,911 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:19, time: 1.696, data_time: 0.092, memory: 17809, stage0_loss_instance_mil: 0.0189, stage0_bag_acc: 99.0536, stage0_mean_ious: 0.4666, stage0_s: 0.0000, stage0_m: 0.0466, stage0_l: 0.1498, stage0_h: 0.5086, stage1_loss_instance_mil: 0.1255, stage1_bag_acc: 99.6781, stage1_neg_loss: 0.0563, stage1_mean_ious: 0.4479, stage1_s: 0.0000, stage1_m: 0.0533, stage1_l: 0.1581, stage1_h: 0.4855, loss: 0.2007, grad_norm: 7.6880
2024-04-19 13:17:22,569 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:27, time: 1.673, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0155, stage0_bag_acc: 99.0297, stage0_mean_ious: 0.4743, stage0_s: 0.0015, stage0_m: 0.0373, stage0_l: 0.1741, stage0_h: 0.5236, stage1_loss_instance_mil: 0.1226, stage1_bag_acc: 99.3228, stage1_neg_loss: 0.0506, stage1_mean_ious: 0.4547, stage1_s: 0.0015, stage1_m: 0.0401, stage1_l: 0.1715, stage1_h: 0.5007, loss: 0.1888, grad_norm: 6.4858
2024-04-19 13:18:44,432 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:28, time: 1.637, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0198, stage0_bag_acc: 98.8759, stage0_mean_ious: 0.5285, stage0_s: 0.0000, stage0_m: 0.0399, stage0_l: 0.2286, stage0_h: 0.5708, stage1_loss_instance_mil: 0.0990, stage1_bag_acc: 99.1076, stage1_neg_loss: 0.0441, stage1_mean_ious: 0.5114, stage1_s: 0.0000, stage1_m: 0.0375, stage1_l: 0.2407, stage1_h: 0.5497, loss: 0.1629, grad_norm: 6.5613
2024-04-19 13:19:35,417 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 13:21:03,623 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:50, time: 1.706, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0079, stage0_bag_acc: 99.7719, stage0_mean_ious: 0.5085, stage0_s: 0.0000, stage0_m: 0.0460, stage0_l: 0.2213, stage0_h: 0.5496, stage1_loss_instance_mil: 0.0948, stage1_bag_acc: 99.6548, stage1_neg_loss: 0.0334, stage1_mean_ious: 0.4888, stage1_s: 0.0000, stage1_m: 0.0486, stage1_l: 0.2315, stage1_h: 0.5252, loss: 0.1361, grad_norm: 5.5571
2024-04-19 13:22:28,987 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 13:22:28,988 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:27:55, time: 1.707, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0304, stage0_bag_acc: 97.8900, stage0_mean_ious: 0.5386, stage0_s: 0.0000, stage0_m: 0.0373, stage0_l: 0.2507, stage0_h: 0.5817, stage1_loss_instance_mil: 0.1259, stage1_bag_acc: 97.9872, stage1_neg_loss: 0.0472, stage1_mean_ious: 0.5273, stage1_s: 0.0000, stage1_m: 0.0399, stage1_l: 0.2542, stage1_h: 0.5672, loss: 0.2035, grad_norm: 8.1141
2024-04-19 13:23:53,340 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:26:55, time: 1.687, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0100, stage0_bag_acc: 99.5082, stage0_mean_ious: 0.5251, stage0_s: 0.0000, stage0_m: 0.0545, stage0_l: 0.2412, stage0_h: 0.5530, stage1_loss_instance_mil: 0.0774, stage1_bag_acc: 99.6721, stage1_neg_loss: 0.0403, stage1_mean_ious: 0.5144, stage1_s: 0.0000, stage1_m: 0.0620, stage1_l: 0.2494, stage1_h: 0.5386, loss: 0.1277, grad_norm: 4.9446
2024-04-19 13:24:43,891 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 13:26:42,332 - mmdet - INFO - Evaluating bbox...
2024-04-19 13:26:44,301 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2422
2024-04-19 13:26:44,302 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4972
2024-04-19 13:26:44,302 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3999
2024-04-19 13:26:44,302 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2753
2024-04-19 13:26:44,302 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2104
2024-04-19 13:26:44,302 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1365
2024-04-19 13:26:44,303 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0362
2024-04-19 13:26:44,303 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2360
2024-04-19 13:26:44,303 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2326
2024-04-19 13:26:44,303 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3248
2024-04-19 13:26:44,303 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3344
2024-04-19 13:26:44,304 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3344
2024-04-19 13:26:44,304 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3344
2024-04-19 13:26:44,304 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2725
2024-04-19 13:26:44,304 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2970
2024-04-19 13:26:44,304 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4421
2024-04-19 13:26:44,346 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 13:26:44,347 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.2420, bbox_mAP_50: 0.4970, bbox_mAP_75: 0.4000, bbox_mAP_s: 0.2750, bbox_mAP_m: 0.2100, bbox_mAP_l: 0.1360, bbox_mAP_copypaste: 0.242 0.497 0.400 0.275 0.210 0.136
2024-04-19 13:28:11,566 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:32, time: 1.744, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0056, stage0_bag_acc: 99.6686, stage0_mean_ious: 0.5642, stage0_s: 0.0000, stage0_m: 0.0569, stage0_l: 0.2232, stage0_h: 0.6047, stage1_loss_instance_mil: 0.0814, stage1_bag_acc: 99.8175, stage1_neg_loss: 0.0369, stage1_mean_ious: 0.5500, stage1_s: 0.0000, stage1_m: 0.0652, stage1_l: 0.2463, stage1_h: 0.5835, loss: 0.1240, grad_norm: 5.7292
2024-04-19 13:29:34,762 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:30, time: 1.664, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0079, stage0_bag_acc: 99.7110, stage0_mean_ious: 0.5118, stage0_s: 0.0000, stage0_m: 0.0848, stage0_l: 0.2428, stage0_h: 0.5567, stage1_loss_instance_mil: 0.0821, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0407, stage1_mean_ious: 0.5008, stage1_s: 0.0000, stage1_m: 0.0890, stage1_l: 0.2527, stage1_h: 0.5410, loss: 0.1307, grad_norm: 5.7736
2024-04-19 13:30:57,926 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:27, time: 1.663, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0197, stage0_bag_acc: 98.9356, stage0_mean_ious: 0.5052, stage0_s: 0.0000, stage0_m: 0.0362, stage0_l: 0.2120, stage0_h: 0.5391, stage1_loss_instance_mil: 0.0847, stage1_bag_acc: 99.3633, stage1_neg_loss: 0.0368, stage1_mean_ious: 0.4888, stage1_s: 0.0000, stage1_m: 0.0387, stage1_l: 0.2116, stage1_h: 0.5205, loss: 0.1413, grad_norm: 6.1681
2024-04-19 13:31:49,246 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 13:33:19,198 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:12, time: 1.744, data_time: 0.101, memory: 17809, stage0_loss_instance_mil: 0.0129, stage0_bag_acc: 99.1777, stage0_mean_ious: 0.5560, stage0_s: 0.0000, stage0_m: 0.0645, stage0_l: 0.2118, stage0_h: 0.5832, stage1_loss_instance_mil: 0.0734, stage1_bag_acc: 99.6490, stage1_neg_loss: 0.0365, stage1_mean_ious: 0.5416, stage1_s: 0.0000, stage1_m: 0.0615, stage1_l: 0.2190, stage1_h: 0.5660, loss: 0.1228, grad_norm: 6.0925
2024-04-19 13:34:44,828 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:09, time: 1.713, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0157, stage0_bag_acc: 98.9445, stage0_mean_ious: 0.5494, stage0_s: 0.0015, stage0_m: 0.0579, stage0_l: 0.2620, stage0_h: 0.5791, stage1_loss_instance_mil: 0.0671, stage1_bag_acc: 99.2131, stage1_neg_loss: 0.0317, stage1_mean_ious: 0.5402, stage1_s: 0.0019, stage1_m: 0.0653, stage1_l: 0.2797, stage1_h: 0.5655, loss: 0.1145, grad_norm: 5.0894
2024-04-19 13:36:08,853 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:04, time: 1.680, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0069, stage0_bag_acc: 99.4302, stage0_mean_ious: 0.5137, stage0_s: 0.0000, stage0_m: 0.0389, stage0_l: 0.2825, stage0_h: 0.5394, stage1_loss_instance_mil: 0.0654, stage1_bag_acc: 99.6093, stage1_neg_loss: 0.0392, stage1_mean_ious: 0.5001, stage1_s: 0.0000, stage1_m: 0.0456, stage1_l: 0.3103, stage1_h: 0.5191, loss: 0.1115, grad_norm: 5.5750
2024-04-19 13:37:00,962 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 13:38:31,002 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:55, time: 1.739, data_time: 0.102, memory: 17809, stage0_loss_instance_mil: 0.0102, stage0_bag_acc: 99.5433, stage0_mean_ious: 0.5278, stage0_s: 0.0018, stage0_m: 0.0668, stage0_l: 0.2251, stage0_h: 0.5620, stage1_loss_instance_mil: 0.0600, stage1_bag_acc: 99.5862, stage1_neg_loss: 0.0336, stage1_mean_ious: 0.5222, stage1_s: 0.0016, stage1_m: 0.0703, stage1_l: 0.2357, stage1_h: 0.5539, loss: 0.1038, grad_norm: 4.1376
2024-04-19 13:39:58,174 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:50, time: 1.743, data_time: 0.050, memory: 17809, stage0_loss_instance_mil: 0.0058, stage0_bag_acc: 99.7110, stage0_mean_ious: 0.5225, stage0_s: 0.0000, stage0_m: 0.0544, stage0_l: 0.2978, stage0_h: 0.5501, stage1_loss_instance_mil: 0.0519, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0270, stage1_mean_ious: 0.5113, stage1_s: 0.0000, stage1_m: 0.0534, stage1_l: 0.3018, stage1_h: 0.5371, loss: 0.0848, grad_norm: 3.1069
2024-04-19 13:41:22,465 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:43, time: 1.686, data_time: 0.048, memory: 17809, stage0_loss_instance_mil: 0.0053, stage0_bag_acc: 99.5705, stage0_mean_ious: 0.5359, stage0_s: 0.0000, stage0_m: 0.0348, stage0_l: 0.2613, stage0_h: 0.5682, stage1_loss_instance_mil: 0.0489, stage1_bag_acc: 99.7667, stage1_neg_loss: 0.0245, stage1_mean_ious: 0.5192, stage1_s: 0.0000, stage1_m: 0.0368, stage1_l: 0.2659, stage1_h: 0.5487, loss: 0.0787, grad_norm: 3.0935
2024-04-19 13:42:12,488 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 13:43:43,449 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:39, time: 1.759, data_time: 0.100, memory: 17809, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.8571, stage0_mean_ious: 0.5420, stage0_s: 0.0000, stage0_m: 0.0533, stage0_l: 0.2363, stage0_h: 0.5761, stage1_loss_instance_mil: 0.0457, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0277, stage1_mean_ious: 0.5328, stage1_s: 0.0000, stage1_m: 0.0629, stage1_l: 0.2524, stage1_h: 0.5633, loss: 0.0769, grad_norm: 2.9952
2024-04-19 13:45:08,480 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:31, time: 1.701, data_time: 0.046, memory: 17809, stage0_loss_instance_mil: 0.0074, stage0_bag_acc: 99.7002, stage0_mean_ious: 0.5401, stage0_s: 0.0000, stage0_m: 0.0356, stage0_l: 0.2105, stage0_h: 0.5663, stage1_loss_instance_mil: 0.0480, stage1_bag_acc: 99.7045, stage1_neg_loss: 0.0257, stage1_mean_ious: 0.5230, stage1_s: 0.0000, stage1_m: 0.0376, stage1_l: 0.2100, stage1_h: 0.5464, loss: 0.0811, grad_norm: 3.2811
2024-04-19 13:46:33,680 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:23, time: 1.704, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0028, stage0_bag_acc: 99.9259, stage0_mean_ious: 0.5413, stage0_s: 0.0000, stage0_m: 0.1134, stage0_l: 0.2684, stage0_h: 0.5822, stage1_loss_instance_mil: 0.0445, stage1_bag_acc: 99.8824, stage1_neg_loss: 0.0301, stage1_mean_ious: 0.5201, stage1_s: 0.0000, stage1_m: 0.1165, stage1_l: 0.2772, stage1_h: 0.5558, loss: 0.0773, grad_norm: 3.3699
2024-04-19 13:47:23,585 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 13:48:54,354 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:22, time: 1.755, data_time: 0.101, memory: 17809, stage0_loss_instance_mil: 0.0020, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5133, stage0_s: 0.0000, stage0_m: 0.0617, stage0_l: 0.2752, stage0_h: 0.5482, stage1_loss_instance_mil: 0.0472, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0222, stage1_mean_ious: 0.5043, stage1_s: 0.0000, stage1_m: 0.0660, stage1_l: 0.2835, stage1_h: 0.5361, loss: 0.0714, grad_norm: 2.8430
2024-04-19 13:50:19,795 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:13, time: 1.709, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0027, stage0_bag_acc: 99.7667, stage0_mean_ious: 0.5307, stage0_s: 0.0000, stage0_m: 0.0599, stage0_l: 0.2675, stage0_h: 0.5700, stage1_loss_instance_mil: 0.0453, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0299, stage1_mean_ious: 0.5219, stage1_s: 0.0000, stage1_m: 0.0598, stage1_l: 0.2714, stage1_h: 0.5583, loss: 0.0778, grad_norm: 3.6186
2024-04-19 13:51:44,033 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:02, time: 1.685, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0063, stage0_bag_acc: 99.8048, stage0_mean_ious: 0.5577, stage0_s: 0.0000, stage0_m: 0.0344, stage0_l: 0.2369, stage0_h: 0.5942, stage1_loss_instance_mil: 0.0371, stage1_bag_acc: 99.8214, stage1_neg_loss: 0.0204, stage1_mean_ious: 0.5375, stage1_s: 0.0000, stage1_m: 0.0389, stage1_l: 0.2498, stage1_h: 0.5686, loss: 0.0638, grad_norm: 2.6816
2024-04-19 13:52:34,074 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 13:54:03,902 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:05, time: 1.739, data_time: 0.099, memory: 17809, stage0_loss_instance_mil: 0.0030, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.5121, stage0_s: 0.0000, stage0_m: 0.0954, stage0_l: 0.2794, stage0_h: 0.5520, stage1_loss_instance_mil: 0.0438, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0256, stage1_mean_ious: 0.4933, stage1_s: 0.0000, stage1_m: 0.0917, stage1_l: 0.2807, stage1_h: 0.5299, loss: 0.0724, grad_norm: 3.0253
2024-04-19 13:55:27,499 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:54, time: 1.672, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0022, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.5455, stage0_s: 0.0000, stage0_m: 0.0470, stage0_l: 0.2608, stage0_h: 0.5798, stage1_loss_instance_mil: 0.0411, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0215, stage1_mean_ious: 0.5331, stage1_s: 0.0000, stage1_m: 0.0515, stage1_l: 0.2711, stage1_h: 0.5629, loss: 0.0648, grad_norm: 2.8326
2024-04-19 13:56:51,979 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:43, time: 1.690, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0029, stage0_bag_acc: 99.7662, stage0_mean_ious: 0.5439, stage0_s: 0.0000, stage0_m: 0.0780, stage0_l: 0.2430, stage0_h: 0.5788, stage1_loss_instance_mil: 0.0428, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0236, stage1_mean_ious: 0.5262, stage1_s: 0.0000, stage1_m: 0.0792, stage1_l: 0.2411, stage1_h: 0.5596, loss: 0.0694, grad_norm: 3.0038
2024-04-19 13:57:41,497 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 13:59:40,348 - mmdet - INFO - Evaluating bbox...
2024-04-19 13:59:42,369 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2582
2024-04-19 13:59:42,369 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5293
2024-04-19 13:59:42,370 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4348
2024-04-19 13:59:42,370 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.3043
2024-04-19 13:59:42,370 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2240
2024-04-19 13:59:42,370 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1327
2024-04-19 13:59:42,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0336
2024-04-19 13:59:42,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1600
2024-04-19 13:59:42,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2564
2024-04-19 13:59:42,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3370
2024-04-19 13:59:42,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3493
2024-04-19 13:59:42,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3493
2024-04-19 13:59:42,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3493
2024-04-19 13:59:42,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2198
2024-04-19 13:59:42,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3131
2024-04-19 13:59:42,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4494
2024-04-19 13:59:42,419 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 13:59:42,420 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.2580, bbox_mAP_50: 0.5290, bbox_mAP_75: 0.4350, bbox_mAP_s: 0.3040, bbox_mAP_m: 0.2240, bbox_mAP_l: 0.1330, bbox_mAP_copypaste: 0.258 0.529 0.435 0.304 0.224 0.133
2024-04-19 14:01:44,988 - mmdet - INFO - Evaluating bbox...
2024-04-19 14:01:46,955 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2582
2024-04-19 14:01:46,956 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5293
2024-04-19 14:01:46,956 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4348
2024-04-19 14:01:46,956 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.3043
2024-04-19 14:01:46,956 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2240
2024-04-19 14:01:46,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1327
2024-04-19 14:01:46,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0336
2024-04-19 14:01:46,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1600
2024-04-19 14:01:46,957 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2564
2024-04-19 14:01:46,958 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3370
2024-04-19 14:01:46,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3493
2024-04-19 14:01:46,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3493
2024-04-19 14:01:46,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3493
2024-04-19 14:01:46,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2198
2024-04-19 14:01:46,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3131
2024-04-19 14:01:46,958 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4494
2024-04-19 14:01:49,616 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 14:01:51,734 - mmdet - INFO - Distributed training: False
2024-04-19 14:01:53,836 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 14:01:56,220 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 14:01:56,220 - mmdet - INFO - Use load_from_local loader
2024-04-19 14:01:56,611 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 14:01:56,624 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 14:01:56,625 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 14:03:24,864 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:02:03, time: 1.765, data_time: 0.099, memory: 17809, stage0_loss_instance_mil: 0.7306, stage0_bag_acc: 13.4091, stage0_mean_ious: 0.2809, stage0_s: 0.0000, stage0_m: 0.0396, stage0_l: 0.2148, stage0_h: 0.2858, stage1_loss_instance_mil: 0.1563, stage1_bag_acc: 20.2196, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.2637, stage1_s: 0.0000, stage1_m: 0.0388, stage1_l: 0.2151, stage1_h: 0.2658, loss: 0.8896, grad_norm: 3.4758
2024-04-19 14:04:48,497 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:00, time: 1.673, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.5830, stage0_bag_acc: 64.2453, stage0_mean_ious: 0.3604, stage0_s: 0.0000, stage0_m: 0.0561, stage0_l: 0.2612, stage0_h: 0.3703, stage1_loss_instance_mil: 0.2387, stage1_bag_acc: 31.2936, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.3323, stage1_s: 0.0000, stage1_m: 0.0509, stage1_l: 0.2547, stage1_h: 0.3380, loss: 0.8260, grad_norm: 3.8661
2024-04-19 14:06:11,608 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:56:56, time: 1.662, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.2279, stage0_bag_acc: 94.2936, stage0_mean_ious: 0.4232, stage0_s: 0.0000, stage0_m: 0.0495, stage0_l: 0.2776, stage0_h: 0.4374, stage1_loss_instance_mil: 0.3155, stage1_bag_acc: 76.6933, stage1_neg_loss: 0.0679, stage1_mean_ious: 0.4018, stage1_s: 0.0000, stage1_m: 0.0494, stage1_l: 0.2831, stage1_h: 0.4134, loss: 0.6113, grad_norm: 10.2392
2024-04-19 14:07:02,010 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 14:08:31,667 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:47:46, time: 1.732, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0795, stage0_bag_acc: 96.2286, stage0_mean_ious: 0.4386, stage0_s: 0.0000, stage0_m: 0.0320, stage0_l: 0.2049, stage0_h: 0.4652, stage1_loss_instance_mil: 0.2928, stage1_bag_acc: 96.8523, stage1_neg_loss: 0.0817, stage1_mean_ious: 0.4264, stage1_s: 0.0000, stage1_m: 0.0260, stage1_l: 0.2037, stage1_h: 0.4516, loss: 0.4539, grad_norm: 12.8175
2024-04-19 14:09:55,275 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:34, time: 1.672, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0710, stage0_bag_acc: 95.7908, stage0_mean_ious: 0.4325, stage0_s: 0.0000, stage0_m: 0.0485, stage0_l: 0.2056, stage0_h: 0.4637, stage1_loss_instance_mil: 0.2944, stage1_bag_acc: 96.7483, stage1_neg_loss: 0.0894, stage1_mean_ious: 0.4131, stage1_s: 0.0000, stage1_m: 0.0495, stage1_l: 0.2042, stage1_h: 0.4424, loss: 0.4548, grad_norm: 14.2520
2024-04-19 14:11:18,563 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:46:59, time: 1.666, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0707, stage0_bag_acc: 95.8014, stage0_mean_ious: 0.4219, stage0_s: 0.0000, stage0_m: 0.0404, stage0_l: 0.1912, stage0_h: 0.4558, stage1_loss_instance_mil: 0.2612, stage1_bag_acc: 97.2841, stage1_neg_loss: 0.0749, stage1_mean_ious: 0.3967, stage1_s: 0.0000, stage1_m: 0.0372, stage1_l: 0.1817, stage1_h: 0.4286, loss: 0.4069, grad_norm: 11.0156
2024-04-19 14:12:08,442 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 14:13:37,876 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:20, time: 1.737, data_time: 0.100, memory: 17809, stage0_loss_instance_mil: 0.0283, stage0_bag_acc: 98.7209, stage0_mean_ious: 0.4576, stage0_s: 0.0000, stage0_m: 0.0308, stage0_l: 0.1723, stage0_h: 0.4828, stage1_loss_instance_mil: 0.2459, stage1_bag_acc: 98.9424, stage1_neg_loss: 0.0785, stage1_mean_ious: 0.4203, stage1_s: 0.0000, stage1_m: 0.0226, stage1_l: 0.1713, stage1_h: 0.4426, loss: 0.3527, grad_norm: 14.1470
2024-04-19 14:15:01,319 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:41:48, time: 1.669, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0320, stage0_bag_acc: 98.3101, stage0_mean_ious: 0.4148, stage0_s: 0.0014, stage0_m: 0.0249, stage0_l: 0.2096, stage0_h: 0.4471, stage1_loss_instance_mil: 0.2741, stage1_bag_acc: 98.0930, stage1_neg_loss: 0.0753, stage1_mean_ious: 0.3887, stage1_s: 0.0014, stage1_m: 0.0204, stage1_l: 0.2311, stage1_h: 0.4139, loss: 0.3814, grad_norm: 15.4356
2024-04-19 14:16:25,616 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:08, time: 1.686, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0662, stage0_bag_acc: 95.6181, stage0_mean_ious: 0.3992, stage0_s: 0.0000, stage0_m: 0.0609, stage0_l: 0.1875, stage0_h: 0.4236, stage1_loss_instance_mil: 0.2564, stage1_bag_acc: 97.1896, stage1_neg_loss: 0.0786, stage1_mean_ious: 0.3712, stage1_s: 0.0000, stage1_m: 0.0609, stage1_l: 0.1972, stage1_h: 0.3898, loss: 0.4012, grad_norm: 14.1802
2024-04-19 14:17:17,215 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 14:18:47,811 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:43, time: 1.752, data_time: 0.100, memory: 17809, stage0_loss_instance_mil: 0.0254, stage0_bag_acc: 98.6490, stage0_mean_ious: 0.3954, stage0_s: 0.0000, stage0_m: 0.0366, stage0_l: 0.1882, stage0_h: 0.4183, stage1_loss_instance_mil: 0.2398, stage1_bag_acc: 98.9847, stage1_neg_loss: 0.0730, stage1_mean_ious: 0.3689, stage1_s: 0.0000, stage1_m: 0.0388, stage1_l: 0.1986, stage1_h: 0.3865, loss: 0.3382, grad_norm: 12.6640
2024-04-19 14:20:12,924 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:02, time: 1.702, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0369, stage0_bag_acc: 97.5182, stage0_mean_ious: 0.4087, stage0_s: 0.0000, stage0_m: 0.0354, stage0_l: 0.2098, stage0_h: 0.4361, stage1_loss_instance_mil: 0.2588, stage1_bag_acc: 97.8464, stage1_neg_loss: 0.0753, stage1_mean_ious: 0.3750, stage1_s: 0.0000, stage1_m: 0.0409, stage1_l: 0.2232, stage1_h: 0.3943, loss: 0.3710, grad_norm: 15.3387
2024-04-19 14:21:35,911 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:10, time: 1.660, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0297, stage0_bag_acc: 98.5463, stage0_mean_ious: 0.4541, stage0_s: 0.0000, stage0_m: 0.0587, stage0_l: 0.1775, stage0_h: 0.4854, stage1_loss_instance_mil: 0.1827, stage1_bag_acc: 98.6002, stage1_neg_loss: 0.0628, stage1_mean_ious: 0.4176, stage1_s: 0.0000, stage1_m: 0.0676, stage1_l: 0.2037, stage1_h: 0.4396, loss: 0.2752, grad_norm: 10.7005
2024-04-19 14:22:26,526 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 14:23:54,638 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:12, time: 1.702, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0221, stage0_bag_acc: 98.8671, stage0_mean_ious: 0.4440, stage0_s: 0.0000, stage0_m: 0.0608, stage0_l: 0.2196, stage0_h: 0.4774, stage1_loss_instance_mil: 0.1976, stage1_bag_acc: 99.1741, stage1_neg_loss: 0.0667, stage1_mean_ious: 0.4179, stage1_s: 0.0000, stage1_m: 0.0719, stage1_l: 0.2440, stage1_h: 0.4396, loss: 0.2864, grad_norm: 12.0897
2024-04-19 14:25:17,567 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:19, time: 1.659, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0146, stage0_bag_acc: 99.2445, stage0_mean_ious: 0.4669, stage0_s: 0.0000, stage0_m: 0.0417, stage0_l: 0.1707, stage0_h: 0.4913, stage1_loss_instance_mil: 0.1719, stage1_bag_acc: 99.0660, stage1_neg_loss: 0.0595, stage1_mean_ious: 0.4313, stage1_s: 0.0000, stage1_m: 0.0492, stage1_l: 0.1909, stage1_h: 0.4473, loss: 0.2460, grad_norm: 10.8131
2024-04-19 14:26:43,482 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:27, time: 1.718, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0186, stage0_bag_acc: 98.5479, stage0_mean_ious: 0.4573, stage0_s: 0.0015, stage0_m: 0.0495, stage0_l: 0.2229, stage0_h: 0.4893, stage1_loss_instance_mil: 0.1748, stage1_bag_acc: 98.6933, stage1_neg_loss: 0.0612, stage1_mean_ious: 0.4209, stage1_s: 0.0022, stage1_m: 0.0610, stage1_l: 0.2465, stage1_h: 0.4399, loss: 0.2546, grad_norm: 10.1514
2024-04-19 14:27:33,721 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 14:29:04,252 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:52, time: 1.751, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0182, stage0_bag_acc: 99.2549, stage0_mean_ious: 0.4631, stage0_s: 0.0000, stage0_m: 0.0591, stage0_l: 0.2504, stage0_h: 0.4939, stage1_loss_instance_mil: 0.1527, stage1_bag_acc: 98.8509, stage1_neg_loss: 0.0497, stage1_mean_ious: 0.4377, stage1_s: 0.0000, stage1_m: 0.0650, stage1_l: 0.2695, stage1_h: 0.4592, loss: 0.2206, grad_norm: 7.3914
2024-04-19 14:30:26,780 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 14:30:26,780 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:27:53, time: 1.651, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0202, stage0_bag_acc: 98.5407, stage0_mean_ious: 0.4753, stage0_s: 0.0000, stage0_m: 0.0203, stage0_l: 0.2523, stage0_h: 0.5088, stage1_loss_instance_mil: 0.1806, stage1_bag_acc: 98.8642, stage1_neg_loss: 0.0646, stage1_mean_ious: 0.4492, stage1_s: 0.0000, stage1_m: 0.0212, stage1_l: 0.2700, stage1_h: 0.4728, loss: 0.2654, grad_norm: 11.6320
2024-04-19 14:31:51,541 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:26:54, time: 1.695, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0125, stage0_bag_acc: 99.2788, stage0_mean_ious: 0.4790, stage0_s: 0.0000, stage0_m: 0.0342, stage0_l: 0.2324, stage0_h: 0.5062, stage1_loss_instance_mil: 0.1478, stage1_bag_acc: 99.4277, stage1_neg_loss: 0.0555, stage1_mean_ious: 0.4510, stage1_s: 0.0000, stage1_m: 0.0327, stage1_l: 0.2574, stage1_h: 0.4701, loss: 0.2158, grad_norm: 9.0110
2024-04-19 14:32:42,317 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 14:34:40,608 - mmdet - INFO - Evaluating bbox...
2024-04-19 14:34:42,565 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0790
2024-04-19 14:34:42,565 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2807
2024-04-19 14:34:42,565 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1381
2024-04-19 14:34:42,566 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0487
2024-04-19 14:34:42,566 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0207
2024-04-19 14:34:42,566 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0073
2024-04-19 14:34:42,566 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-04-19 14:34:42,566 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0349
2024-04-19 14:34:42,567 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0937
2024-04-19 14:34:42,567 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0966
2024-04-19 14:34:42,567 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1563
2024-04-19 14:34:42,567 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1563
2024-04-19 14:34:42,567 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1563
2024-04-19 14:34:42,567 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0625
2024-04-19 14:34:42,568 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1806
2024-04-19 14:34:42,568 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1114
2024-04-19 14:34:42,615 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 14:34:42,616 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0790, bbox_mAP_50: 0.2810, bbox_mAP_75: 0.1380, bbox_mAP_s: 0.0490, bbox_mAP_m: 0.0210, bbox_mAP_l: 0.0070, bbox_mAP_copypaste: 0.079 0.281 0.138 0.049 0.021 0.007
2024-04-19 14:36:07,795 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:29, time: 1.703, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0097, stage0_bag_acc: 99.4034, stage0_mean_ious: 0.4689, stage0_s: 0.0000, stage0_m: 0.0336, stage0_l: 0.2186, stage0_h: 0.5048, stage1_loss_instance_mil: 0.1293, stage1_bag_acc: 99.5877, stage1_neg_loss: 0.0507, stage1_mean_ious: 0.4470, stage1_s: 0.0000, stage1_m: 0.0422, stage1_l: 0.2473, stage1_h: 0.4727, loss: 0.1896, grad_norm: 7.4773
2024-04-19 14:37:31,604 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:28, time: 1.676, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0149, stage0_bag_acc: 99.1415, stage0_mean_ious: 0.4633, stage0_s: 0.0000, stage0_m: 0.0262, stage0_l: 0.2655, stage0_h: 0.4833, stage1_loss_instance_mil: 0.1359, stage1_bag_acc: 99.2980, stage1_neg_loss: 0.0462, stage1_mean_ious: 0.4477, stage1_s: 0.0000, stage1_m: 0.0250, stage1_l: 0.2819, stage1_h: 0.4628, loss: 0.1970, grad_norm: 6.8322
2024-04-19 14:38:54,546 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:25, time: 1.659, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0203, stage0_bag_acc: 98.7731, stage0_mean_ious: 0.4113, stage0_s: 0.0015, stage0_m: 0.0479, stage0_l: 0.1920, stage0_h: 0.4361, stage1_loss_instance_mil: 0.1526, stage1_bag_acc: 98.4121, stage1_neg_loss: 0.0498, stage1_mean_ious: 0.3919, stage1_s: 0.0020, stage1_m: 0.0545, stage1_l: 0.1995, stage1_h: 0.4108, loss: 0.2227, grad_norm: 6.7936
2024-04-19 14:39:44,766 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 14:41:13,006 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:09, time: 1.704, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0131, stage0_bag_acc: 99.2177, stage0_mean_ious: 0.4130, stage0_s: 0.0000, stage0_m: 0.0530, stage0_l: 0.2311, stage0_h: 0.4395, stage1_loss_instance_mil: 0.1169, stage1_bag_acc: 99.6077, stage1_neg_loss: 0.0420, stage1_mean_ious: 0.4006, stage1_s: 0.0000, stage1_m: 0.0627, stage1_l: 0.2483, stage1_h: 0.4219, loss: 0.1719, grad_norm: 6.6302
2024-04-19 14:42:35,808 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:05, time: 1.656, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0113, stage0_bag_acc: 99.2518, stage0_mean_ious: 0.3885, stage0_s: 0.0000, stage0_m: 0.0622, stage0_l: 0.2225, stage0_h: 0.4050, stage1_loss_instance_mil: 0.1291, stage1_bag_acc: 99.5975, stage1_neg_loss: 0.0518, stage1_mean_ious: 0.3762, stage1_s: 0.0000, stage1_m: 0.0684, stage1_l: 0.2395, stage1_h: 0.3873, loss: 0.1922, grad_norm: 7.6152
2024-04-19 14:43:59,137 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:00, time: 1.667, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0115, stage0_bag_acc: 99.0214, stage0_mean_ious: 0.3695, stage0_s: 0.0000, stage0_m: 0.0519, stage0_l: 0.2556, stage0_h: 0.3950, stage1_loss_instance_mil: 0.1299, stage1_bag_acc: 99.2955, stage1_neg_loss: 0.0497, stage1_mean_ious: 0.3548, stage1_s: 0.0000, stage1_m: 0.0591, stage1_l: 0.2795, stage1_h: 0.3723, loss: 0.1910, grad_norm: 6.9262
2024-04-19 14:44:49,421 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 14:46:17,470 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:51, time: 1.706, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0083, stage0_bag_acc: 99.4470, stage0_mean_ious: 0.3841, stage0_s: 0.0016, stage0_m: 0.0410, stage0_l: 0.2561, stage0_h: 0.4011, stage1_loss_instance_mil: 0.1261, stage1_bag_acc: 99.3319, stage1_neg_loss: 0.0500, stage1_mean_ious: 0.3637, stage1_s: 0.0017, stage1_m: 0.0400, stage1_l: 0.2802, stage1_h: 0.3745, loss: 0.1844, grad_norm: 4.5896
2024-04-19 14:47:42,610 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:46, time: 1.703, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0031, stage0_bag_acc: 99.8130, stage0_mean_ious: 0.4020, stage0_s: 0.0000, stage0_m: 0.0590, stage0_l: 0.2330, stage0_h: 0.4147, stage1_loss_instance_mil: 0.1010, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0422, stage1_mean_ious: 0.3857, stage1_s: 0.0000, stage1_m: 0.0685, stage1_l: 0.2436, stage1_h: 0.3945, loss: 0.1462, grad_norm: 3.8861
2024-04-19 14:49:06,888 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:39, time: 1.686, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0094, stage0_bag_acc: 99.6660, stage0_mean_ious: 0.4061, stage0_s: 0.0000, stage0_m: 0.0414, stage0_l: 0.2021, stage0_h: 0.4236, stage1_loss_instance_mil: 0.0991, stage1_bag_acc: 99.4799, stage1_neg_loss: 0.0468, stage1_mean_ious: 0.3898, stage1_s: 0.0000, stage1_m: 0.0495, stage1_l: 0.2145, stage1_h: 0.4015, loss: 0.1553, grad_norm: 4.5957
2024-04-19 14:49:57,633 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 14:51:26,655 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:35, time: 1.729, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0095, stage0_bag_acc: 99.5386, stage0_mean_ious: 0.4027, stage0_s: 0.0000, stage0_m: 0.0306, stage0_l: 0.2400, stage0_h: 0.4157, stage1_loss_instance_mil: 0.0998, stage1_bag_acc: 99.6076, stage1_neg_loss: 0.0436, stage1_mean_ious: 0.3826, stage1_s: 0.0000, stage1_m: 0.0362, stage1_l: 0.2451, stage1_h: 0.3919, loss: 0.1529, grad_norm: 4.0451
2024-04-19 14:52:51,119 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:28, time: 1.689, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0042, stage0_bag_acc: 99.7880, stage0_mean_ious: 0.3833, stage0_s: 0.0000, stage0_m: 0.0501, stage0_l: 0.2130, stage0_h: 0.4014, stage1_loss_instance_mil: 0.1001, stage1_bag_acc: 99.8261, stage1_neg_loss: 0.0434, stage1_mean_ious: 0.3635, stage1_s: 0.0000, stage1_m: 0.0515, stage1_l: 0.2444, stage1_h: 0.3737, loss: 0.1476, grad_norm: 4.3285
2024-04-19 14:54:15,841 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:19, time: 1.694, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0036, stage0_bag_acc: 99.8397, stage0_mean_ious: 0.3900, stage0_s: 0.0000, stage0_m: 0.0270, stage0_l: 0.2279, stage0_h: 0.4105, stage1_loss_instance_mil: 0.0981, stage1_bag_acc: 99.9167, stage1_neg_loss: 0.0434, stage1_mean_ious: 0.3779, stage1_s: 0.0000, stage1_m: 0.0271, stage1_l: 0.2399, stage1_h: 0.3936, loss: 0.1451, grad_norm: 4.5520
2024-04-19 14:55:04,999 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 14:56:36,309 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:20, time: 1.766, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0063, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.3821, stage0_s: 0.0000, stage0_m: 0.1059, stage0_l: 0.2052, stage0_h: 0.3977, stage1_loss_instance_mil: 0.0930, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0448, stage1_mean_ious: 0.3655, stage1_s: 0.0000, stage1_m: 0.1164, stage1_l: 0.2248, stage1_h: 0.3734, loss: 0.1441, grad_norm: 4.3918
2024-04-19 14:58:00,220 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:11, time: 1.678, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0037, stage0_bag_acc: 99.7036, stage0_mean_ious: 0.3878, stage0_s: 0.0000, stage0_m: 0.0374, stage0_l: 0.2015, stage0_h: 0.4070, stage1_loss_instance_mil: 0.0964, stage1_bag_acc: 99.7137, stage1_neg_loss: 0.0425, stage1_mean_ious: 0.3699, stage1_s: 0.0000, stage1_m: 0.0388, stage1_l: 0.2047, stage1_h: 0.3844, loss: 0.1426, grad_norm: 4.0923
2024-04-19 14:59:22,194 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:01, time: 1.639, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0025, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4020, stage0_s: 0.0000, stage0_m: 0.0322, stage0_l: 0.2395, stage0_h: 0.4181, stage1_loss_instance_mil: 0.0841, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0364, stage1_mean_ious: 0.3798, stage1_s: 0.0000, stage1_m: 0.0360, stage1_l: 0.2578, stage1_h: 0.3907, loss: 0.1230, grad_norm: 3.7726
2024-04-19 15:00:11,154 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 15:01:38,465 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:04, time: 1.686, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0037, stage0_bag_acc: 99.7571, stage0_mean_ious: 0.3831, stage0_s: 0.0014, stage0_m: 0.0669, stage0_l: 0.2054, stage0_h: 0.4135, stage1_loss_instance_mil: 0.0876, stage1_bag_acc: 99.7238, stage1_neg_loss: 0.0416, stage1_mean_ious: 0.3686, stage1_s: 0.0023, stage1_m: 0.0752, stage1_l: 0.2163, stage1_h: 0.3927, loss: 0.1329, grad_norm: 4.1436
2024-04-19 15:03:02,490 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:53, time: 1.680, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0044, stage0_bag_acc: 99.6937, stage0_mean_ious: 0.3937, stage0_s: 0.0000, stage0_m: 0.0493, stage0_l: 0.2311, stage0_h: 0.4214, stage1_loss_instance_mil: 0.0879, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0382, stage1_mean_ious: 0.3793, stage1_s: 0.0000, stage1_m: 0.0531, stage1_l: 0.2454, stage1_h: 0.4016, loss: 0.1305, grad_norm: 4.0666
2024-04-19 15:04:24,583 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:42, time: 1.642, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0052, stage0_bag_acc: 99.8330, stage0_mean_ious: 0.3765, stage0_s: 0.0000, stage0_m: 0.0593, stage0_l: 0.2365, stage0_h: 0.3900, stage1_loss_instance_mil: 0.0911, stage1_bag_acc: 99.9200, stage1_neg_loss: 0.0446, stage1_mean_ious: 0.3589, stage1_s: 0.0000, stage1_m: 0.0662, stage1_l: 0.2502, stage1_h: 0.3677, loss: 0.1409, grad_norm: 4.2741
2024-04-19 15:05:16,463 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 15:07:15,934 - mmdet - INFO - Evaluating bbox...
2024-04-19 15:07:18,075 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1132
2024-04-19 15:07:18,076 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3356
2024-04-19 15:07:18,076 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2083
2024-04-19 15:07:18,076 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0880
2024-04-19 15:07:18,076 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0431
2024-04-19 15:07:18,077 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0154
2024-04-19 15:07:18,077 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0023
2024-04-19 15:07:18,077 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0417
2024-04-19 15:07:18,077 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1266
2024-04-19 15:07:18,078 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1979
2024-04-19 15:07:18,078 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1859
2024-04-19 15:07:18,078 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1859
2024-04-19 15:07:18,078 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1859
2024-04-19 15:07:18,078 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0878
2024-04-19 15:07:18,078 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1951
2024-04-19 15:07:18,079 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2161
2024-04-19 15:07:18,122 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 15:07:18,123 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.1130, bbox_mAP_50: 0.3360, bbox_mAP_75: 0.2080, bbox_mAP_s: 0.0880, bbox_mAP_m: 0.0430, bbox_mAP_l: 0.0150, bbox_mAP_copypaste: 0.113 0.336 0.208 0.088 0.043 0.015
2024-04-19 15:09:15,071 - mmdet - INFO - Evaluating bbox...
2024-04-19 15:09:16,983 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1132
2024-04-19 15:09:16,983 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3356
2024-04-19 15:09:16,984 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2083
2024-04-19 15:09:16,984 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0880
2024-04-19 15:09:16,984 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0431
2024-04-19 15:09:16,984 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0154
2024-04-19 15:09:16,984 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0023
2024-04-19 15:09:16,985 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0417
2024-04-19 15:09:16,985 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1266
2024-04-19 15:09:16,985 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1979
2024-04-19 15:09:16,985 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1859
2024-04-19 15:09:16,985 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1859
2024-04-19 15:09:16,986 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1859
2024-04-19 15:09:16,986 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0878
2024-04-19 15:09:16,986 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1951
2024-04-19 15:09:16,986 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2161
2024-04-19 15:09:19,613 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 15:09:21,744 - mmdet - INFO - Distributed training: False
2024-04-19 15:09:23,829 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 15:09:26,255 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 15:09:26,256 - mmdet - INFO - Use load_from_local loader
2024-04-19 15:09:26,642 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 15:09:26,669 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 15:09:26,669 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 15:10:52,260 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:00:11, time: 1.712, data_time: 0.100, memory: 17809, stage0_loss_instance_mil: 0.7278, stage0_bag_acc: 8.1925, stage0_mean_ious: 0.3308, stage0_s: 0.0000, stage0_m: 0.0243, stage0_l: 0.1774, stage0_h: 0.3460, stage1_loss_instance_mil: 0.1611, stage1_bag_acc: 15.8391, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.3427, stage1_s: 0.0000, stage1_m: 0.0241, stage1_l: 0.2073, stage1_h: 0.3552, loss: 0.8905, grad_norm: 3.2732
2024-04-19 15:12:16,929 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:58:27, time: 1.693, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.6231, stage0_bag_acc: 54.7934, stage0_mean_ious: 0.3557, stage0_s: 0.0010, stage0_m: 0.0140, stage0_l: 0.2073, stage0_h: 0.3726, stage1_loss_instance_mil: 0.2155, stage1_bag_acc: 19.1750, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.3631, stage1_s: 0.0012, stage1_m: 0.0165, stage1_l: 0.2252, stage1_h: 0.3777, loss: 0.8420, grad_norm: 3.6494
2024-04-19 15:13:42,342 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:57:05, time: 1.708, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.2699, stage0_bag_acc: 85.9880, stage0_mean_ious: 0.4298, stage0_s: 0.0000, stage0_m: 0.0281, stage0_l: 0.2402, stage0_h: 0.4529, stage1_loss_instance_mil: 0.3079, stage1_bag_acc: 77.8257, stage1_neg_loss: 0.0601, stage1_mean_ious: 0.4304, stage1_s: 0.0000, stage1_m: 0.0277, stage1_l: 0.2491, stage1_h: 0.4522, loss: 0.6380, grad_norm: 9.6216
2024-04-19 15:14:31,738 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 15:16:04,040 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:14, time: 1.786, data_time: 0.102, memory: 17809, stage0_loss_instance_mil: 0.0716, stage0_bag_acc: 96.6687, stage0_mean_ious: 0.4070, stage0_s: 0.0000, stage0_m: 0.0542, stage0_l: 0.1674, stage0_h: 0.4337, stage1_loss_instance_mil: 0.3090, stage1_bag_acc: 96.9786, stage1_neg_loss: 0.0862, stage1_mean_ious: 0.4085, stage1_s: 0.0000, stage1_m: 0.0457, stage1_l: 0.1622, stage1_h: 0.4365, loss: 0.4669, grad_norm: 13.8219
2024-04-19 15:17:26,867 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:52, time: 1.657, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0860, stage0_bag_acc: 94.9706, stage0_mean_ious: 0.4098, stage0_s: 0.0000, stage0_m: 0.0576, stage0_l: 0.1699, stage0_h: 0.4420, stage1_loss_instance_mil: 0.2833, stage1_bag_acc: 96.3850, stage1_neg_loss: 0.0824, stage1_mean_ious: 0.3966, stage1_s: 0.0000, stage1_m: 0.0496, stage1_l: 0.1607, stage1_h: 0.4297, loss: 0.4517, grad_norm: 15.0394
2024-04-19 15:18:51,652 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:22, time: 1.696, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0701, stage0_bag_acc: 96.2215, stage0_mean_ious: 0.4454, stage0_s: 0.0000, stage0_m: 0.0317, stage0_l: 0.1694, stage0_h: 0.4694, stage1_loss_instance_mil: 0.2671, stage1_bag_acc: 97.1374, stage1_neg_loss: 0.0869, stage1_mean_ious: 0.4262, stage1_s: 0.0000, stage1_m: 0.0268, stage1_l: 0.1625, stage1_h: 0.4487, loss: 0.4241, grad_norm: 15.5406
2024-04-19 15:19:42,601 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 15:21:12,253 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:36, time: 1.729, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0442, stage0_bag_acc: 97.3960, stage0_mean_ious: 0.4202, stage0_s: 0.0000, stage0_m: 0.0447, stage0_l: 0.1585, stage0_h: 0.4568, stage1_loss_instance_mil: 0.2535, stage1_bag_acc: 97.9982, stage1_neg_loss: 0.0784, stage1_mean_ious: 0.3966, stage1_s: 0.0000, stage1_m: 0.0318, stage1_l: 0.1644, stage1_h: 0.4284, loss: 0.3761, grad_norm: 15.7146
2024-04-19 15:22:37,252 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:07, time: 1.700, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0493, stage0_bag_acc: 96.5031, stage0_mean_ious: 0.4114, stage0_s: 0.0000, stage0_m: 0.0514, stage0_l: 0.1751, stage0_h: 0.4426, stage1_loss_instance_mil: 0.2384, stage1_bag_acc: 97.8985, stage1_neg_loss: 0.0765, stage1_mean_ious: 0.3868, stage1_s: 0.0000, stage1_m: 0.0430, stage1_l: 0.1651, stage1_h: 0.4172, loss: 0.3642, grad_norm: 14.3582
2024-04-19 15:24:02,559 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:28, time: 1.706, data_time: 0.046, memory: 17809, stage0_loss_instance_mil: 0.0340, stage0_bag_acc: 97.9032, stage0_mean_ious: 0.4082, stage0_s: 0.0000, stage0_m: 0.0283, stage0_l: 0.1759, stage0_h: 0.4296, stage1_loss_instance_mil: 0.2610, stage1_bag_acc: 98.4107, stage1_neg_loss: 0.0759, stage1_mean_ious: 0.3882, stage1_s: 0.0000, stage1_m: 0.0204, stage1_l: 0.1663, stage1_h: 0.4092, loss: 0.3709, grad_norm: 13.5654
2024-04-19 15:24:53,640 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 15:26:24,498 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:00, time: 1.754, data_time: 0.102, memory: 17809, stage0_loss_instance_mil: 0.0327, stage0_bag_acc: 97.4393, stage0_mean_ious: 0.4769, stage0_s: 0.0000, stage0_m: 0.0414, stage0_l: 0.1902, stage0_h: 0.5109, stage1_loss_instance_mil: 0.2094, stage1_bag_acc: 98.5607, stage1_neg_loss: 0.0768, stage1_mean_ious: 0.4452, stage1_s: 0.0000, stage1_m: 0.0350, stage1_l: 0.1772, stage1_h: 0.4776, loss: 0.3189, grad_norm: 15.3024
2024-04-19 15:27:49,928 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:18, time: 1.709, data_time: 0.046, memory: 17809, stage0_loss_instance_mil: 0.0275, stage0_bag_acc: 98.5454, stage0_mean_ious: 0.4127, stage0_s: 0.0000, stage0_m: 0.0309, stage0_l: 0.1684, stage0_h: 0.4462, stage1_loss_instance_mil: 0.2050, stage1_bag_acc: 99.3717, stage1_neg_loss: 0.0719, stage1_mean_ious: 0.3875, stage1_s: 0.0000, stage1_m: 0.0241, stage1_l: 0.1664, stage1_h: 0.4192, loss: 0.3045, grad_norm: 14.1446
2024-04-19 15:29:13,821 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:26, time: 1.678, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0248, stage0_bag_acc: 98.5901, stage0_mean_ious: 0.4156, stage0_s: 0.0000, stage0_m: 0.0393, stage0_l: 0.1419, stage0_h: 0.4581, stage1_loss_instance_mil: 0.2142, stage1_bag_acc: 99.3721, stage1_neg_loss: 0.0831, stage1_mean_ious: 0.3879, stage1_s: 0.0000, stage1_m: 0.0317, stage1_l: 0.1332, stage1_h: 0.4290, loss: 0.3221, grad_norm: 14.6521
2024-04-19 15:30:04,406 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 15:31:33,630 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:29, time: 1.732, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0246, stage0_bag_acc: 98.3786, stage0_mean_ious: 0.4108, stage0_s: 0.0019, stage0_m: 0.0462, stage0_l: 0.1362, stage0_h: 0.4495, stage1_loss_instance_mil: 0.1864, stage1_bag_acc: 98.8113, stage1_neg_loss: 0.0672, stage1_mean_ious: 0.3823, stage1_s: 0.0016, stage1_m: 0.0408, stage1_l: 0.1309, stage1_h: 0.4182, loss: 0.2781, grad_norm: 11.8192
2024-04-19 15:32:57,979 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:36, time: 1.687, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0157, stage0_bag_acc: 99.0548, stage0_mean_ious: 0.4296, stage0_s: 0.0000, stage0_m: 0.0365, stage0_l: 0.1637, stage0_h: 0.4623, stage1_loss_instance_mil: 0.1553, stage1_bag_acc: 99.3942, stage1_neg_loss: 0.0607, stage1_mean_ious: 0.3977, stage1_s: 0.0000, stage1_m: 0.0276, stage1_l: 0.1603, stage1_h: 0.4277, loss: 0.2318, grad_norm: 10.2225
2024-04-19 15:34:22,849 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:41, time: 1.697, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0155, stage0_bag_acc: 98.8473, stage0_mean_ious: 0.3553, stage0_s: 0.0000, stage0_m: 0.0314, stage0_l: 0.1404, stage0_h: 0.3952, stage1_loss_instance_mil: 0.1721, stage1_bag_acc: 99.4428, stage1_neg_loss: 0.0672, stage1_mean_ious: 0.3340, stage1_s: 0.0000, stage1_m: 0.0223, stage1_l: 0.1326, stage1_h: 0.3725, loss: 0.2548, grad_norm: 11.2665
2024-04-19 15:35:12,484 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 15:36:40,763 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:02, time: 1.715, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0226, stage0_bag_acc: 98.9762, stage0_mean_ious: 0.3248, stage0_s: 0.0000, stage0_m: 0.0525, stage0_l: 0.1035, stage0_h: 0.3574, stage1_loss_instance_mil: 0.1641, stage1_bag_acc: 99.0315, stage1_neg_loss: 0.0594, stage1_mean_ious: 0.3040, stage1_s: 0.0000, stage1_m: 0.0397, stage1_l: 0.0929, stage1_h: 0.3368, loss: 0.2461, grad_norm: 9.6685
2024-04-19 15:38:04,736 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 15:38:04,737 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:04, time: 1.679, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0252, stage0_bag_acc: 98.0036, stage0_mean_ious: 0.3826, stage0_s: 0.0000, stage0_m: 0.0249, stage0_l: 0.1248, stage0_h: 0.4094, stage1_loss_instance_mil: 0.1610, stage1_bag_acc: 98.9713, stage1_neg_loss: 0.0689, stage1_mean_ious: 0.3592, stage1_s: 0.0000, stage1_m: 0.0222, stage1_l: 0.1120, stage1_h: 0.3848, loss: 0.2552, grad_norm: 11.0500
2024-04-19 15:39:28,056 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:02, time: 1.666, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0139, stage0_bag_acc: 99.2387, stage0_mean_ious: 0.4107, stage0_s: 0.0000, stage0_m: 0.0364, stage0_l: 0.1481, stage0_h: 0.4489, stage1_loss_instance_mil: 0.1464, stage1_bag_acc: 99.4369, stage1_neg_loss: 0.0635, stage1_mean_ious: 0.3848, stage1_s: 0.0000, stage1_m: 0.0270, stage1_l: 0.1350, stage1_h: 0.4225, loss: 0.2237, grad_norm: 11.3217
2024-04-19 15:40:18,262 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 15:42:18,289 - mmdet - INFO - Evaluating bbox...
2024-04-19 15:42:20,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0691
2024-04-19 15:42:20,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2390
2024-04-19 15:42:20,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1291
2024-04-19 15:42:20,201 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0409
2024-04-19 15:42:20,201 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0182
2024-04-19 15:42:20,201 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0067
2024-04-19 15:42:20,201 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-04-19 15:42:20,201 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0282
2024-04-19 15:42:20,202 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0696
2024-04-19 15:42:20,202 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1134
2024-04-19 15:42:20,202 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1245
2024-04-19 15:42:20,202 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1245
2024-04-19 15:42:20,202 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1245
2024-04-19 15:42:20,202 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0448
2024-04-19 15:42:20,203 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1313
2024-04-19 15:42:20,203 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1320
2024-04-19 15:42:20,245 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 15:42:20,245 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0690, bbox_mAP_50: 0.2390, bbox_mAP_75: 0.1290, bbox_mAP_s: 0.0410, bbox_mAP_m: 0.0180, bbox_mAP_l: 0.0070, bbox_mAP_copypaste: 0.069 0.239 0.129 0.041 0.018 0.007
2024-04-19 15:43:45,647 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:37, time: 1.707, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0131, stage0_bag_acc: 99.5805, stage0_mean_ious: 0.3595, stage0_s: 0.0000, stage0_m: 0.0287, stage0_l: 0.1456, stage0_h: 0.3850, stage1_loss_instance_mil: 0.1327, stage1_bag_acc: 99.7667, stage1_neg_loss: 0.0544, stage1_mean_ious: 0.3449, stage1_s: 0.0000, stage1_m: 0.0208, stage1_l: 0.1358, stage1_h: 0.3703, loss: 0.2002, grad_norm: 8.2510
2024-04-19 15:45:09,340 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:35, time: 1.674, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0079, stage0_bag_acc: 99.6150, stage0_mean_ious: 0.3542, stage0_s: 0.0000, stage0_m: 0.0433, stage0_l: 0.1525, stage0_h: 0.3983, stage1_loss_instance_mil: 0.1355, stage1_bag_acc: 99.6102, stage1_neg_loss: 0.0557, stage1_mean_ious: 0.3366, stage1_s: 0.0000, stage1_m: 0.0367, stage1_l: 0.1420, stage1_h: 0.3800, loss: 0.1992, grad_norm: 8.5638
2024-04-19 15:46:33,171 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:31, time: 1.677, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0177, stage0_bag_acc: 98.6340, stage0_mean_ious: 0.3699, stage0_s: 0.0000, stage0_m: 0.0226, stage0_l: 0.1494, stage0_h: 0.3940, stage1_loss_instance_mil: 0.1417, stage1_bag_acc: 98.7384, stage1_neg_loss: 0.0589, stage1_mean_ious: 0.3505, stage1_s: 0.0000, stage1_m: 0.0145, stage1_l: 0.1350, stage1_h: 0.3748, loss: 0.2182, grad_norm: 9.0863
2024-04-19 15:47:23,911 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 15:48:53,206 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:16, time: 1.725, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0128, stage0_bag_acc: 98.9832, stage0_mean_ious: 0.3844, stage0_s: 0.0000, stage0_m: 0.0357, stage0_l: 0.1272, stage0_h: 0.4180, stage1_loss_instance_mil: 0.1260, stage1_bag_acc: 99.7091, stage1_neg_loss: 0.0643, stage1_mean_ious: 0.3597, stage1_s: 0.0000, stage1_m: 0.0291, stage1_l: 0.1132, stage1_h: 0.3923, loss: 0.2031, grad_norm: 10.8755
2024-04-19 15:50:17,366 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:12, time: 1.683, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0202, stage0_bag_acc: 98.8347, stage0_mean_ious: 0.3870, stage0_s: 0.0000, stage0_m: 0.0467, stage0_l: 0.1533, stage0_h: 0.4305, stage1_loss_instance_mil: 0.1404, stage1_bag_acc: 99.3976, stage1_neg_loss: 0.0526, stage1_mean_ious: 0.3580, stage1_s: 0.0000, stage1_m: 0.0304, stage1_l: 0.1439, stage1_h: 0.3989, loss: 0.2132, grad_norm: 9.1258
2024-04-19 15:51:40,321 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:05, time: 1.659, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0144, stage0_bag_acc: 99.3015, stage0_mean_ious: 0.4058, stage0_s: 0.0000, stage0_m: 0.0224, stage0_l: 0.1370, stage0_h: 0.4322, stage1_loss_instance_mil: 0.1061, stage1_bag_acc: 99.0431, stage1_neg_loss: 0.0461, stage1_mean_ious: 0.3805, stage1_s: 0.0000, stage1_m: 0.0138, stage1_l: 0.1238, stage1_h: 0.4066, loss: 0.1666, grad_norm: 7.1714
2024-04-19 15:52:30,797 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 15:54:00,728 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:57, time: 1.738, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0132, stage0_bag_acc: 98.7253, stage0_mean_ious: 0.3839, stage0_s: 0.0000, stage0_m: 0.0215, stage0_l: 0.1453, stage0_h: 0.4139, stage1_loss_instance_mil: 0.0881, stage1_bag_acc: 99.3896, stage1_neg_loss: 0.0377, stage1_mean_ious: 0.3588, stage1_s: 0.0000, stage1_m: 0.0150, stage1_l: 0.1375, stage1_h: 0.3871, loss: 0.1389, grad_norm: 5.0254
2024-04-19 15:55:22,893 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:49, time: 1.643, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0072, stage0_bag_acc: 99.7046, stage0_mean_ious: 0.3754, stage0_s: 0.0019, stage0_m: 0.0407, stage0_l: 0.1448, stage0_h: 0.4129, stage1_loss_instance_mil: 0.0874, stage1_bag_acc: 99.7836, stage1_neg_loss: 0.0433, stage1_mean_ious: 0.3509, stage1_s: 0.0022, stage1_m: 0.0325, stage1_l: 0.1281, stage1_h: 0.3868, loss: 0.1379, grad_norm: 4.8311
2024-04-19 15:56:48,927 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:43, time: 1.721, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0041, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.3805, stage0_s: 0.0000, stage0_m: 0.0424, stage0_l: 0.1565, stage0_h: 0.4115, stage1_loss_instance_mil: 0.0862, stage1_bag_acc: 99.7841, stage1_neg_loss: 0.0433, stage1_mean_ious: 0.3555, stage1_s: 0.0000, stage1_m: 0.0329, stage1_l: 0.1419, stage1_h: 0.3873, loss: 0.1336, grad_norm: 5.5184
2024-04-19 15:57:40,250 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 15:59:09,461 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:39, time: 1.722, data_time: 0.099, memory: 17809, stage0_loss_instance_mil: 0.0046, stage0_bag_acc: 99.7836, stage0_mean_ious: 0.3916, stage0_s: 0.0000, stage0_m: 0.0311, stage0_l: 0.1292, stage0_h: 0.4266, stage1_loss_instance_mil: 0.0833, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0385, stage1_mean_ious: 0.3652, stage1_s: 0.0000, stage1_m: 0.0202, stage1_l: 0.1200, stage1_h: 0.3998, loss: 0.1265, grad_norm: 4.8386
2024-04-19 16:00:34,202 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:31, time: 1.695, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0074, stage0_bag_acc: 99.7889, stage0_mean_ious: 0.3637, stage0_s: 0.0000, stage0_m: 0.0270, stage0_l: 0.1378, stage0_h: 0.3938, stage1_loss_instance_mil: 0.0829, stage1_bag_acc: 99.6980, stage1_neg_loss: 0.0418, stage1_mean_ious: 0.3389, stage1_s: 0.0000, stage1_m: 0.0193, stage1_l: 0.1262, stage1_h: 0.3679, loss: 0.1321, grad_norm: 5.4259
2024-04-19 16:01:59,072 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:22, time: 1.697, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0064, stage0_bag_acc: 99.4769, stage0_mean_ious: 0.3688, stage0_s: 0.0000, stage0_m: 0.0175, stage0_l: 0.1381, stage0_h: 0.4009, stage1_loss_instance_mil: 0.0782, stage1_bag_acc: 99.5434, stage1_neg_loss: 0.0432, stage1_mean_ious: 0.3435, stage1_s: 0.0000, stage1_m: 0.0123, stage1_l: 0.1275, stage1_h: 0.3732, loss: 0.1278, grad_norm: 6.1397
2024-04-19 16:02:50,990 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 16:04:21,271 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:22, time: 1.745, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0050, stage0_bag_acc: 99.7871, stage0_mean_ious: 0.3551, stage0_s: 0.0000, stage0_m: 0.0343, stage0_l: 0.1173, stage0_h: 0.3866, stage1_loss_instance_mil: 0.0911, stage1_bag_acc: 99.7081, stage1_neg_loss: 0.0513, stage1_mean_ious: 0.3326, stage1_s: 0.0000, stage1_m: 0.0233, stage1_l: 0.1071, stage1_h: 0.3623, loss: 0.1474, grad_norm: 7.0680
2024-04-19 16:05:46,241 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:12, time: 1.699, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0047, stage0_bag_acc: 99.7880, stage0_mean_ious: 0.3798, stage0_s: 0.0000, stage0_m: 0.0269, stage0_l: 0.1079, stage0_h: 0.4094, stage1_loss_instance_mil: 0.0885, stage1_bag_acc: 99.7002, stage1_neg_loss: 0.0395, stage1_mean_ious: 0.3529, stage1_s: 0.0000, stage1_m: 0.0191, stage1_l: 0.1002, stage1_h: 0.3803, loss: 0.1327, grad_norm: 5.4649
2024-04-19 16:07:08,424 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:02, time: 1.644, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0072, stage0_bag_acc: 99.6843, stage0_mean_ious: 0.3803, stage0_s: 0.0000, stage0_m: 0.0287, stage0_l: 0.1437, stage0_h: 0.4139, stage1_loss_instance_mil: 0.0806, stage1_bag_acc: 99.5568, stage1_neg_loss: 0.0377, stage1_mean_ious: 0.3589, stage1_s: 0.0000, stage1_m: 0.0211, stage1_l: 0.1331, stage1_h: 0.3917, loss: 0.1255, grad_norm: 5.2280
2024-04-19 16:07:59,880 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 16:09:28,732 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:05, time: 1.717, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0026, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3518, stage0_s: 0.0000, stage0_m: 0.0205, stage0_l: 0.1302, stage0_h: 0.3910, stage1_loss_instance_mil: 0.0843, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0343, stage1_mean_ious: 0.3340, stage1_s: 0.0000, stage1_m: 0.0173, stage1_l: 0.1191, stage1_h: 0.3720, loss: 0.1211, grad_norm: 4.4405
2024-04-19 16:10:54,694 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:54, time: 1.719, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0082, stage0_bag_acc: 99.6250, stage0_mean_ious: 0.3822, stage0_s: 0.0000, stage0_m: 0.0085, stage0_l: 0.1226, stage0_h: 0.4113, stage1_loss_instance_mil: 0.0823, stage1_bag_acc: 99.6250, stage1_neg_loss: 0.0356, stage1_mean_ious: 0.3569, stage1_s: 0.0000, stage1_m: 0.0052, stage1_l: 0.1123, stage1_h: 0.3837, loss: 0.1261, grad_norm: 4.4574
2024-04-19 16:12:19,768 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:43, time: 1.701, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0036, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.3737, stage0_s: 0.0019, stage0_m: 0.0298, stage0_l: 0.1438, stage0_h: 0.4045, stage1_loss_instance_mil: 0.0816, stage1_bag_acc: 99.8019, stage1_neg_loss: 0.0374, stage1_mean_ious: 0.3506, stage1_s: 0.0021, stage1_m: 0.0199, stage1_l: 0.1298, stage1_h: 0.3807, loss: 0.1226, grad_norm: 5.1900
2024-04-19 16:13:10,242 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 16:15:09,900 - mmdet - INFO - Evaluating bbox...
2024-04-19 16:15:11,784 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0754
2024-04-19 16:15:11,784 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2532
2024-04-19 16:15:11,784 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1365
2024-04-19 16:15:11,785 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0457
2024-04-19 16:15:11,785 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0243
2024-04-19 16:15:11,785 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0073
2024-04-19 16:15:11,785 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-04-19 16:15:11,785 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0262
2024-04-19 16:15:11,786 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0729
2024-04-19 16:15:11,786 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1368
2024-04-19 16:15:11,786 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1365
2024-04-19 16:15:11,786 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1365
2024-04-19 16:15:11,786 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1365
2024-04-19 16:15:11,786 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0557
2024-04-19 16:15:11,787 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1349
2024-04-19 16:15:11,787 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1785
2024-04-19 16:15:11,829 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 16:15:11,829 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0750, bbox_mAP_50: 0.2530, bbox_mAP_75: 0.1370, bbox_mAP_s: 0.0460, bbox_mAP_m: 0.0240, bbox_mAP_l: 0.0070, bbox_mAP_copypaste: 0.075 0.253 0.137 0.046 0.024 0.007
2024-04-19 16:17:10,141 - mmdet - INFO - Evaluating bbox...
2024-04-19 16:17:12,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0754
2024-04-19 16:17:12,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2532
2024-04-19 16:17:12,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1365
2024-04-19 16:17:12,298 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0457
2024-04-19 16:17:12,298 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0243
2024-04-19 16:17:12,298 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0073
2024-04-19 16:17:12,298 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-04-19 16:17:12,299 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0262
2024-04-19 16:17:12,299 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0729
2024-04-19 16:17:12,299 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1368
2024-04-19 16:17:12,299 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1365
2024-04-19 16:17:12,299 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1365
2024-04-19 16:17:12,300 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1365
2024-04-19 16:17:12,300 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0557
2024-04-19 16:17:12,300 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1349
2024-04-19 16:17:12,300 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1785
2024-04-19 16:17:14,971 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 16:17:17,130 - mmdet - INFO - Distributed training: False
2024-04-19 16:17:19,104 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 16:17:21,751 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 16:17:21,751 - mmdet - INFO - Use load_from_local loader
2024-04-19 16:17:22,127 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 16:17:22,153 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 16:17:22,153 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 16:18:49,849 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:01:40, time: 1.754, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.7167, stage0_bag_acc: 15.1104, stage0_mean_ious: 0.3139, stage0_s: 0.0000, stage0_m: 0.0230, stage0_l: 0.2539, stage0_h: 0.3136, stage1_loss_instance_mil: 0.1671, stage1_bag_acc: 19.3314, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.3092, stage1_s: 0.0000, stage1_m: 0.0220, stage1_l: 0.2583, stage1_h: 0.3083, loss: 0.8861, grad_norm: 3.2110
2024-04-19 16:20:14,598 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:12, time: 1.695, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.5744, stage0_bag_acc: 57.8957, stage0_mean_ious: 0.3319, stage0_s: 0.0000, stage0_m: 0.0382, stage0_l: 0.2100, stage0_h: 0.3428, stage1_loss_instance_mil: 0.2367, stage1_bag_acc: 28.4628, stage1_neg_loss: 0.0071, stage1_mean_ious: 0.3292, stage1_s: 0.0000, stage1_m: 0.0449, stage1_l: 0.2150, stage1_h: 0.3383, loss: 0.8182, grad_norm: 3.9704
2024-04-19 16:21:38,911 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:57:20, time: 1.686, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.2513, stage0_bag_acc: 87.4609, stage0_mean_ious: 0.2761, stage0_s: 0.0000, stage0_m: 0.0468, stage0_l: 0.1645, stage0_h: 0.2873, stage1_loss_instance_mil: 0.3465, stage1_bag_acc: 77.0188, stage1_neg_loss: 0.0668, stage1_mean_ious: 0.2699, stage1_s: 0.0000, stage1_m: 0.0482, stage1_l: 0.1637, stage1_h: 0.2802, loss: 0.6646, grad_norm: 11.0196
2024-04-19 16:22:28,504 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 16:23:58,146 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:01, time: 1.732, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0709, stage0_bag_acc: 96.4611, stage0_mean_ious: 0.2800, stage0_s: 0.0000, stage0_m: 0.0237, stage0_l: 0.1427, stage0_h: 0.2973, stage1_loss_instance_mil: 0.3671, stage1_bag_acc: 97.2736, stage1_neg_loss: 0.0905, stage1_mean_ious: 0.2530, stage1_s: 0.0000, stage1_m: 0.0213, stage1_l: 0.1384, stage1_h: 0.2671, loss: 0.5286, grad_norm: 11.4636
2024-04-19 16:25:21,578 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:45, time: 1.669, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0611, stage0_bag_acc: 96.9840, stage0_mean_ious: 0.2945, stage0_s: 0.0000, stage0_m: 0.0355, stage0_l: 0.1191, stage0_h: 0.3156, stage1_loss_instance_mil: 0.3346, stage1_bag_acc: 97.2021, stage1_neg_loss: 0.1052, stage1_mean_ious: 0.2583, stage1_s: 0.0000, stage1_m: 0.0307, stage1_l: 0.0997, stage1_h: 0.2776, loss: 0.5009, grad_norm: 16.0015
2024-04-19 16:26:44,504 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:06, time: 1.658, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0625, stage0_bag_acc: 95.6839, stage0_mean_ious: 0.3193, stage0_s: 0.0000, stage0_m: 0.0381, stage0_l: 0.1353, stage0_h: 0.3445, stage1_loss_instance_mil: 0.3028, stage1_bag_acc: 96.7316, stage1_neg_loss: 0.0836, stage1_mean_ious: 0.2785, stage1_s: 0.0000, stage1_m: 0.0304, stage1_l: 0.1112, stage1_h: 0.3019, loss: 0.4488, grad_norm: 12.7071
2024-04-19 16:27:34,986 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 16:29:04,969 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:26, time: 1.740, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0421, stage0_bag_acc: 97.5434, stage0_mean_ious: 0.3157, stage0_s: 0.0000, stage0_m: 0.0317, stage0_l: 0.1244, stage0_h: 0.3400, stage1_loss_instance_mil: 0.2996, stage1_bag_acc: 98.2974, stage1_neg_loss: 0.0871, stage1_mean_ious: 0.2731, stage1_s: 0.0000, stage1_m: 0.0225, stage1_l: 0.1004, stage1_h: 0.2955, loss: 0.4289, grad_norm: 13.5335
2024-04-19 16:30:28,668 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:41:54, time: 1.674, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0230, stage0_bag_acc: 98.7928, stage0_mean_ious: 0.3030, stage0_s: 0.0000, stage0_m: 0.0281, stage0_l: 0.0919, stage0_h: 0.3258, stage1_loss_instance_mil: 0.2581, stage1_bag_acc: 99.3243, stage1_neg_loss: 0.0898, stage1_mean_ious: 0.2593, stage1_s: 0.0000, stage1_m: 0.0194, stage1_l: 0.0690, stage1_h: 0.2807, loss: 0.3709, grad_norm: 14.6047
2024-04-19 16:31:53,682 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:16, time: 1.700, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0445, stage0_bag_acc: 96.9940, stage0_mean_ious: 0.2783, stage0_s: 0.0000, stage0_m: 0.0367, stage0_l: 0.1063, stage0_h: 0.2991, stage1_loss_instance_mil: 0.2640, stage1_bag_acc: 97.9313, stage1_neg_loss: 0.0861, stage1_mean_ious: 0.2390, stage1_s: 0.0000, stage1_m: 0.0328, stage1_l: 0.0870, stage1_h: 0.2579, loss: 0.3946, grad_norm: 13.5550
2024-04-19 16:32:44,354 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 16:34:15,376 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:51, time: 1.761, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0198, stage0_bag_acc: 98.7496, stage0_mean_ious: 0.2174, stage0_s: 0.0000, stage0_m: 0.0405, stage0_l: 0.0867, stage0_h: 0.2314, stage1_loss_instance_mil: 0.2599, stage1_bag_acc: 99.2745, stage1_neg_loss: 0.0806, stage1_mean_ious: 0.1821, stage1_s: 0.0000, stage1_m: 0.0248, stage1_l: 0.0715, stage1_h: 0.1949, loss: 0.3602, grad_norm: 13.0368
2024-04-19 16:35:39,179 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:06, time: 1.676, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0304, stage0_bag_acc: 98.1887, stage0_mean_ious: 0.2159, stage0_s: 0.0000, stage0_m: 0.0202, stage0_l: 0.1052, stage0_h: 0.2303, stage1_loss_instance_mil: 0.2277, stage1_bag_acc: 98.6783, stage1_neg_loss: 0.0734, stage1_mean_ious: 0.1860, stage1_s: 0.0000, stage1_m: 0.0141, stage1_l: 0.0891, stage1_h: 0.1991, loss: 0.3315, grad_norm: 10.1674
2024-04-19 16:37:01,822 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:12, time: 1.653, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0347, stage0_bag_acc: 97.6341, stage0_mean_ious: 0.2153, stage0_s: 0.0000, stage0_m: 0.0359, stage0_l: 0.0908, stage0_h: 0.2295, stage1_loss_instance_mil: 0.2191, stage1_bag_acc: 98.2393, stage1_neg_loss: 0.0732, stage1_mean_ious: 0.1819, stage1_s: 0.0000, stage1_m: 0.0242, stage1_l: 0.0692, stage1_h: 0.1960, loss: 0.3270, grad_norm: 11.6012
2024-04-19 16:37:51,876 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 16:39:19,664 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:14, time: 1.695, data_time: 0.093, memory: 17809, stage0_loss_instance_mil: 0.0227, stage0_bag_acc: 98.9262, stage0_mean_ious: 0.1997, stage0_s: 0.0000, stage0_m: 0.0315, stage0_l: 0.0700, stage0_h: 0.2108, stage1_loss_instance_mil: 0.2095, stage1_bag_acc: 98.8232, stage1_neg_loss: 0.0725, stage1_mean_ious: 0.1715, stage1_s: 0.0000, stage1_m: 0.0235, stage1_l: 0.0561, stage1_h: 0.1819, loss: 0.3046, grad_norm: 11.0108
2024-04-19 16:40:42,330 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:20, time: 1.653, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0139, stage0_bag_acc: 99.3021, stage0_mean_ious: 0.1713, stage0_s: 0.0000, stage0_m: 0.0297, stage0_l: 0.0996, stage0_h: 0.1766, stage1_loss_instance_mil: 0.2287, stage1_bag_acc: 99.2781, stage1_neg_loss: 0.0754, stage1_mean_ious: 0.1520, stage1_s: 0.0000, stage1_m: 0.0197, stage1_l: 0.0802, stage1_h: 0.1586, loss: 0.3180, grad_norm: 12.0116
2024-04-19 16:42:06,366 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:25, time: 1.681, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0170, stage0_bag_acc: 99.2034, stage0_mean_ious: 0.1591, stage0_s: 0.0012, stage0_m: 0.0487, stage0_l: 0.0881, stage0_h: 0.1656, stage1_loss_instance_mil: 0.2008, stage1_bag_acc: 99.6561, stage1_neg_loss: 0.0735, stage1_mean_ious: 0.1416, stage1_s: 0.0017, stage1_m: 0.0311, stage1_l: 0.0705, stage1_h: 0.1501, loss: 0.2914, grad_norm: 12.1101
2024-04-19 16:42:57,509 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 16:44:26,821 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:49, time: 1.727, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0192, stage0_bag_acc: 99.0120, stage0_mean_ious: 0.1331, stage0_s: 0.0013, stage0_m: 0.0281, stage0_l: 0.0818, stage0_h: 0.1372, stage1_loss_instance_mil: 0.1897, stage1_bag_acc: 99.5342, stage1_neg_loss: 0.0691, stage1_mean_ious: 0.1192, stage1_s: 0.0015, stage1_m: 0.0194, stage1_l: 0.0665, stage1_h: 0.1243, loss: 0.2780, grad_norm: 10.2646
2024-04-19 16:45:51,168 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 16:45:51,168 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:27:52, time: 1.687, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0270, stage0_bag_acc: 98.8388, stage0_mean_ious: 0.1178, stage0_s: 0.0000, stage0_m: 0.0315, stage0_l: 0.0849, stage0_h: 0.1199, stage1_loss_instance_mil: 0.1773, stage1_bag_acc: 98.7002, stage1_neg_loss: 0.0663, stage1_mean_ious: 0.1078, stage1_s: 0.0000, stage1_m: 0.0214, stage1_l: 0.0695, stage1_h: 0.1120, loss: 0.2706, grad_norm: 8.9215
2024-04-19 16:47:14,290 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:26:52, time: 1.662, data_time: 0.037, memory: 17809, stage0_loss_instance_mil: 0.0173, stage0_bag_acc: 98.7232, stage0_mean_ious: 0.1153, stage0_s: 0.0000, stage0_m: 0.0383, stage0_l: 0.1034, stage0_h: 0.1145, stage1_loss_instance_mil: 0.1760, stage1_bag_acc: 99.0194, stage1_neg_loss: 0.0704, stage1_mean_ious: 0.1052, stage1_s: 0.0000, stage1_m: 0.0264, stage1_l: 0.0899, stage1_h: 0.1060, loss: 0.2638, grad_norm: 9.6671
2024-04-19 16:48:05,521 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 16:50:03,711 - mmdet - INFO - Evaluating bbox...
2024-04-19 16:50:05,554 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0006
2024-04-19 16:50:05,554 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0032
2024-04-19 16:50:05,554 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0003
2024-04-19 16:50:05,555 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0002
2024-04-19 16:50:05,555 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0002
2024-04-19 16:50:05,555 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 16:50:05,555 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 16:50:05,555 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-04-19 16:50:05,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0006
2024-04-19 16:50:05,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0012
2024-04-19 16:50:05,556 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0043
2024-04-19 16:50:05,556 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0043
2024-04-19 16:50:05,556 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0043
2024-04-19 16:50:05,556 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0005
2024-04-19 16:50:05,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0092
2024-04-19 16:50:05,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0024
2024-04-19 16:50:05,599 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 16:50:05,599 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0010, bbox_mAP_50: 0.0030, bbox_mAP_75: 0.0000, bbox_mAP_s: 0.0000, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.001 0.003 0.000 0.000 0.000 0.000
2024-04-19 16:51:29,695 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:26, time: 1.681, data_time: 0.091, memory: 17809, stage0_loss_instance_mil: 0.0118, stage0_bag_acc: 99.1427, stage0_mean_ious: 0.0989, stage0_s: 0.0000, stage0_m: 0.0306, stage0_l: 0.0850, stage0_h: 0.0969, stage1_loss_instance_mil: 0.1552, stage1_bag_acc: 99.4892, stage1_neg_loss: 0.0642, stage1_mean_ious: 0.0911, stage1_s: 0.0000, stage1_m: 0.0179, stage1_l: 0.0703, stage1_h: 0.0917, loss: 0.2313, grad_norm: 8.2604
2024-04-19 16:52:54,705 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:27, time: 1.700, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0162, stage0_bag_acc: 99.0491, stage0_mean_ious: 0.1143, stage0_s: 0.0000, stage0_m: 0.0300, stage0_l: 0.1041, stage0_h: 0.1112, stage1_loss_instance_mil: 0.1403, stage1_bag_acc: 99.2318, stage1_neg_loss: 0.0616, stage1_mean_ious: 0.1032, stage1_s: 0.0000, stage1_m: 0.0237, stage1_l: 0.0830, stage1_h: 0.1030, loss: 0.2181, grad_norm: 8.1394
2024-04-19 16:54:20,384 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:25, time: 1.714, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0118, stage0_bag_acc: 99.2808, stage0_mean_ious: 0.1257, stage0_s: 0.0000, stage0_m: 0.0320, stage0_l: 0.0892, stage0_h: 0.1248, stage1_loss_instance_mil: 0.1408, stage1_bag_acc: 99.3816, stage1_neg_loss: 0.0590, stage1_mean_ious: 0.1138, stage1_s: 0.0000, stage1_m: 0.0283, stage1_l: 0.0734, stage1_h: 0.1139, loss: 0.2116, grad_norm: 8.7870
2024-04-19 16:55:10,798 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 16:56:42,278 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:12, time: 1.769, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0156, stage0_bag_acc: 99.3398, stage0_mean_ious: 0.1118, stage0_s: 0.0000, stage0_m: 0.0397, stage0_l: 0.1014, stage0_h: 0.1083, stage1_loss_instance_mil: 0.1418, stage1_bag_acc: 99.3223, stage1_neg_loss: 0.0571, stage1_mean_ious: 0.1022, stage1_s: 0.0000, stage1_m: 0.0303, stage1_l: 0.0877, stage1_h: 0.1001, loss: 0.2146, grad_norm: 7.3982
2024-04-19 16:58:06,361 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:08, time: 1.682, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0116, stage0_bag_acc: 99.3924, stage0_mean_ious: 0.1053, stage0_s: 0.0000, stage0_m: 0.0382, stage0_l: 0.0836, stage0_h: 0.1050, stage1_loss_instance_mil: 0.1279, stage1_bag_acc: 99.5200, stage1_neg_loss: 0.0603, stage1_mean_ious: 0.0998, stage1_s: 0.0000, stage1_m: 0.0330, stage1_l: 0.0741, stage1_h: 0.1005, loss: 0.1997, grad_norm: 7.9760
2024-04-19 16:59:29,263 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:02, time: 1.658, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0113, stage0_bag_acc: 99.3795, stage0_mean_ious: 0.0911, stage0_s: 0.0000, stage0_m: 0.0392, stage0_l: 0.0985, stage0_h: 0.0851, stage1_loss_instance_mil: 0.1322, stage1_bag_acc: 99.6186, stage1_neg_loss: 0.0599, stage1_mean_ious: 0.0856, stage1_s: 0.0000, stage1_m: 0.0314, stage1_l: 0.0850, stage1_h: 0.0820, loss: 0.2033, grad_norm: 7.9505
2024-04-19 17:00:20,296 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 17:01:48,284 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:53, time: 1.700, data_time: 0.092, memory: 17809, stage0_loss_instance_mil: 0.0067, stage0_bag_acc: 99.4778, stage0_mean_ious: 0.1153, stage0_s: 0.0000, stage0_m: 0.0365, stage0_l: 0.1020, stage0_h: 0.1143, stage1_loss_instance_mil: 0.1196, stage1_bag_acc: 99.7388, stage1_neg_loss: 0.0520, stage1_mean_ious: 0.1063, stage1_s: 0.0000, stage1_m: 0.0322, stage1_l: 0.0972, stage1_h: 0.1054, loss: 0.1783, grad_norm: 5.8105
2024-04-19 17:03:12,199 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:47, time: 1.678, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0082, stage0_bag_acc: 99.5657, stage0_mean_ious: 0.1099, stage0_s: 0.0000, stage0_m: 0.0474, stage0_l: 0.0851, stage0_h: 0.1084, stage1_loss_instance_mil: 0.1024, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0540, stage1_mean_ious: 0.1032, stage1_s: 0.0000, stage1_m: 0.0416, stage1_l: 0.0849, stage1_h: 0.1009, loss: 0.1646, grad_norm: 5.5389
2024-04-19 17:04:35,975 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:40, time: 1.675, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0048, stage0_bag_acc: 99.6591, stage0_mean_ious: 0.1094, stage0_s: 0.0000, stage0_m: 0.0296, stage0_l: 0.0914, stage0_h: 0.1082, stage1_loss_instance_mil: 0.0981, stage1_bag_acc: 99.9091, stage1_neg_loss: 0.0506, stage1_mean_ious: 0.0996, stage1_s: 0.0000, stage1_m: 0.0257, stage1_l: 0.0765, stage1_h: 0.0999, loss: 0.1536, grad_norm: 5.0931
2024-04-19 17:05:24,439 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 17:06:53,768 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:36, time: 1.726, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0045, stage0_bag_acc: 99.9000, stage0_mean_ious: 0.1183, stage0_s: 0.0000, stage0_m: 0.0289, stage0_l: 0.0893, stage0_h: 0.1186, stage1_loss_instance_mil: 0.1033, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0537, stage1_mean_ious: 0.1093, stage1_s: 0.0000, stage1_m: 0.0259, stage1_l: 0.0788, stage1_h: 0.1109, loss: 0.1614, grad_norm: 5.0198
2024-04-19 17:08:16,160 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:28, time: 1.648, data_time: 0.040, memory: 17809, stage0_loss_instance_mil: 0.0075, stage0_bag_acc: 99.7056, stage0_mean_ious: 0.1106, stage0_s: 0.0000, stage0_m: 0.0308, stage0_l: 0.0944, stage0_h: 0.1076, stage1_loss_instance_mil: 0.1107, stage1_bag_acc: 99.8167, stage1_neg_loss: 0.0507, stage1_mean_ious: 0.1015, stage1_s: 0.0000, stage1_m: 0.0265, stage1_l: 0.0857, stage1_h: 0.0986, loss: 0.1689, grad_norm: 4.9676
2024-04-19 17:09:39,948 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:19, time: 1.676, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0057, stage0_bag_acc: 99.6819, stage0_mean_ious: 0.1154, stage0_s: 0.0000, stage0_m: 0.0216, stage0_l: 0.0932, stage0_h: 0.1159, stage1_loss_instance_mil: 0.1097, stage1_bag_acc: 99.6971, stage1_neg_loss: 0.0522, stage1_mean_ious: 0.1065, stage1_s: 0.0000, stage1_m: 0.0173, stage1_l: 0.0876, stage1_h: 0.1067, loss: 0.1677, grad_norm: 5.7290
2024-04-19 17:10:29,974 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 17:11:59,108 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:20, time: 1.723, data_time: 0.095, memory: 17809, stage0_loss_instance_mil: 0.0056, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.1135, stage0_s: 0.0000, stage0_m: 0.0381, stage0_l: 0.0977, stage0_h: 0.1119, stage1_loss_instance_mil: 0.1047, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0503, stage1_mean_ious: 0.1037, stage1_s: 0.0000, stage1_m: 0.0319, stage1_l: 0.0995, stage1_h: 0.1010, loss: 0.1606, grad_norm: 5.0284
2024-04-19 17:13:21,447 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:10, time: 1.647, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0046, stage0_bag_acc: 99.8261, stage0_mean_ious: 0.1076, stage0_s: 0.0000, stage0_m: 0.0332, stage0_l: 0.0988, stage0_h: 0.1044, stage1_loss_instance_mil: 0.0983, stage1_bag_acc: 99.7592, stage1_neg_loss: 0.0483, stage1_mean_ious: 0.0999, stage1_s: 0.0000, stage1_m: 0.0304, stage1_l: 0.0882, stage1_h: 0.0979, loss: 0.1512, grad_norm: 4.7818
2024-04-19 17:14:44,653 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:00, time: 1.664, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0053, stage0_bag_acc: 99.7043, stage0_mean_ious: 0.1011, stage0_s: 0.0000, stage0_m: 0.0211, stage0_l: 0.0893, stage0_h: 0.0994, stage1_loss_instance_mil: 0.0961, stage1_bag_acc: 99.7758, stage1_neg_loss: 0.0484, stage1_mean_ious: 0.0919, stage1_s: 0.0000, stage1_m: 0.0173, stage1_l: 0.0777, stage1_h: 0.0906, loss: 0.1499, grad_norm: 4.9672
2024-04-19 17:15:34,191 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 17:17:01,724 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:04, time: 1.689, data_time: 0.094, memory: 17809, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.5817, stage0_mean_ious: 0.1093, stage0_s: 0.0000, stage0_m: 0.0422, stage0_l: 0.1046, stage0_h: 0.1081, stage1_loss_instance_mil: 0.0923, stage1_bag_acc: 99.9231, stage1_neg_loss: 0.0457, stage1_mean_ious: 0.0988, stage1_s: 0.0000, stage1_m: 0.0350, stage1_l: 0.1010, stage1_h: 0.0970, loss: 0.1440, grad_norm: 4.9451
2024-04-19 17:18:24,575 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:53, time: 1.657, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0051, stage0_bag_acc: 99.8361, stage0_mean_ious: 0.1070, stage0_s: 0.0000, stage0_m: 0.0221, stage0_l: 0.0834, stage0_h: 0.1065, stage1_loss_instance_mil: 0.0971, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0497, stage1_mean_ious: 0.0992, stage1_s: 0.0000, stage1_m: 0.0187, stage1_l: 0.0770, stage1_h: 0.0993, loss: 0.1519, grad_norm: 5.1144
2024-04-19 17:19:49,974 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:42, time: 1.708, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.0022, stage0_bag_acc: 99.9259, stage0_mean_ious: 0.1110, stage0_s: 0.0000, stage0_m: 0.0276, stage0_l: 0.0853, stage0_h: 0.1104, stage1_loss_instance_mil: 0.0999, stage1_bag_acc: 99.9259, stage1_neg_loss: 0.0478, stage1_mean_ious: 0.1012, stage1_s: 0.0000, stage1_m: 0.0211, stage1_l: 0.0807, stage1_h: 0.1007, loss: 0.1498, grad_norm: 4.8279
2024-04-19 17:20:41,308 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 17:22:39,046 - mmdet - INFO - Evaluating bbox...
2024-04-19 17:22:40,721 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0004
2024-04-19 17:22:40,722 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0018
2024-04-19 17:22:40,722 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0009
2024-04-19 17:22:40,722 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0002
2024-04-19 17:22:40,722 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 17:22:40,723 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 17:22:40,723 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 17:22:40,723 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0006
2024-04-19 17:22:40,723 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0006
2024-04-19 17:22:40,724 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0009
2024-04-19 17:22:40,724 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0049
2024-04-19 17:22:40,724 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0049
2024-04-19 17:22:40,724 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0049
2024-04-19 17:22:40,724 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0340
2024-04-19 17:22:40,724 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0096
2024-04-19 17:22:40,725 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0019
2024-04-19 17:22:40,770 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 17:22:40,770 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0000, bbox_mAP_50: 0.0020, bbox_mAP_75: 0.0010, bbox_mAP_s: 0.0000, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.000 0.002 0.001 0.000 0.000 0.000
2024-04-19 17:24:40,063 - mmdet - INFO - Evaluating bbox...
2024-04-19 17:24:41,906 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0004
2024-04-19 17:24:41,906 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0018
2024-04-19 17:24:41,907 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0009
2024-04-19 17:24:41,907 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0002
2024-04-19 17:24:41,907 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 17:24:41,907 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 17:24:41,907 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-19 17:24:41,908 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0006
2024-04-19 17:24:41,908 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0006
2024-04-19 17:24:41,908 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0009
2024-04-19 17:24:41,908 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0049
2024-04-19 17:24:41,909 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0049
2024-04-19 17:24:41,909 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0049
2024-04-19 17:24:41,909 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0340
2024-04-19 17:24:41,909 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0096
2024-04-19 17:24:41,909 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0019
2024-04-19 17:24:44,588 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 17:24:46,760 - mmdet - INFO - Distributed training: False
2024-04-19 17:24:48,893 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 17:24:51,370 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 17:24:51,370 - mmdet - INFO - Use load_from_local loader
2024-04-19 17:24:51,739 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 17:24:51,747 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 17:24:51,747 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 17:26:19,897 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:01:59, time: 1.763, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.6990, stage0_bag_acc: 22.7747, stage0_mean_ious: 0.3258, stage0_s: 0.0000, stage0_m: 0.0289, stage0_l: 0.2227, stage0_h: 0.3381, stage1_loss_instance_mil: 0.1724, stage1_bag_acc: 15.4603, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.3246, stage1_s: 0.0000, stage1_m: 0.0270, stage1_l: 0.2225, stage1_h: 0.3360, loss: 0.8747, grad_norm: 3.4326
2024-04-19 17:27:45,028 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:59:29, time: 1.703, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.5745, stage0_bag_acc: 48.6453, stage0_mean_ious: 0.4043, stage0_s: 0.0000, stage0_m: 0.0269, stage0_l: 0.2548, stage0_h: 0.4206, stage1_loss_instance_mil: 0.2409, stage1_bag_acc: 36.6596, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.3922, stage1_s: 0.0000, stage1_m: 0.0323, stage1_l: 0.2481, stage1_h: 0.4077, loss: 0.8219, grad_norm: 3.8671
2024-04-19 17:29:09,328 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:57:31, time: 1.686, data_time: 0.042, memory: 17809, stage0_loss_instance_mil: 0.2628, stage0_bag_acc: 88.4526, stage0_mean_ious: 0.4950, stage0_s: 0.0012, stage0_m: 0.0489, stage0_l: 0.2868, stage0_h: 0.5168, stage1_loss_instance_mil: 0.3222, stage1_bag_acc: 82.7273, stage1_neg_loss: 0.0622, stage1_mean_ious: 0.4649, stage1_s: 0.0012, stage1_m: 0.0457, stage1_l: 0.2745, stage1_h: 0.4848, loss: 0.6472, grad_norm: 9.3186
2024-04-19 17:29:59,775 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 17:31:30,180 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:48:14, time: 1.747, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0809, stage0_bag_acc: 95.9588, stage0_mean_ious: 0.4853, stage0_s: 0.0000, stage0_m: 0.0716, stage0_l: 0.1871, stage0_h: 0.5173, stage1_loss_instance_mil: 0.3061, stage1_bag_acc: 97.4695, stage1_neg_loss: 0.0855, stage1_mean_ious: 0.4564, stage1_s: 0.0000, stage1_m: 0.0799, stage1_l: 0.1900, stage1_h: 0.4827, loss: 0.4726, grad_norm: 11.8895
2024-04-19 17:32:53,879 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:57, time: 1.674, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0586, stage0_bag_acc: 96.7135, stage0_mean_ious: 0.4662, stage0_s: 0.0017, stage0_m: 0.0942, stage0_l: 0.2342, stage0_h: 0.5098, stage1_loss_instance_mil: 0.2951, stage1_bag_acc: 96.9535, stage1_neg_loss: 0.0798, stage1_mean_ious: 0.4450, stage1_s: 0.0014, stage1_m: 0.1003, stage1_l: 0.2466, stage1_h: 0.4820, loss: 0.4335, grad_norm: 13.0078
2024-04-19 17:34:18,145 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:47:24, time: 1.685, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0634, stage0_bag_acc: 96.3398, stage0_mean_ious: 0.4923, stage0_s: 0.0000, stage0_m: 0.0513, stage0_l: 0.2243, stage0_h: 0.5255, stage1_loss_instance_mil: 0.2900, stage1_bag_acc: 98.0829, stage1_neg_loss: 0.0913, stage1_mean_ious: 0.4616, stage1_s: 0.0000, stage1_m: 0.0558, stage1_l: 0.2369, stage1_h: 0.4902, loss: 0.4447, grad_norm: 17.3860
2024-04-19 17:35:08,944 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 17:36:39,273 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:42:41, time: 1.747, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0367, stage0_bag_acc: 98.1092, stage0_mean_ious: 0.4722, stage0_s: 0.0000, stage0_m: 0.0582, stage0_l: 0.1838, stage0_h: 0.5110, stage1_loss_instance_mil: 0.2527, stage1_bag_acc: 99.1406, stage1_neg_loss: 0.0725, stage1_mean_ious: 0.4463, stage1_s: 0.0000, stage1_m: 0.0581, stage1_l: 0.1976, stage1_h: 0.4768, loss: 0.3619, grad_norm: 13.3534
2024-04-19 17:38:03,979 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:42:11, time: 1.694, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0335, stage0_bag_acc: 97.8452, stage0_mean_ious: 0.4662, stage0_s: 0.0000, stage0_m: 0.0382, stage0_l: 0.2013, stage0_h: 0.5022, stage1_loss_instance_mil: 0.2181, stage1_bag_acc: 98.1422, stage1_neg_loss: 0.0746, stage1_mean_ious: 0.4405, stage1_s: 0.0000, stage1_m: 0.0376, stage1_l: 0.2255, stage1_h: 0.4674, loss: 0.3262, grad_norm: 12.1653
2024-04-19 17:39:28,651 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:41:29, time: 1.693, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0282, stage0_bag_acc: 98.3587, stage0_mean_ious: 0.4996, stage0_s: 0.0000, stage0_m: 0.0416, stage0_l: 0.2038, stage0_h: 0.5325, stage1_loss_instance_mil: 0.2161, stage1_bag_acc: 98.8403, stage1_neg_loss: 0.0669, stage1_mean_ious: 0.4716, stage1_s: 0.0000, stage1_m: 0.0415, stage1_l: 0.2279, stage1_h: 0.4967, loss: 0.3112, grad_norm: 13.6031
2024-04-19 17:40:20,112 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 17:41:51,532 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:38:03, time: 1.768, data_time: 0.099, memory: 17809, stage0_loss_instance_mil: 0.0427, stage0_bag_acc: 97.5240, stage0_mean_ious: 0.5104, stage0_s: 0.0000, stage0_m: 0.0191, stage0_l: 0.1773, stage0_h: 0.5330, stage1_loss_instance_mil: 0.1856, stage1_bag_acc: 98.0180, stage1_neg_loss: 0.0643, stage1_mean_ious: 0.4818, stage1_s: 0.0000, stage1_m: 0.0218, stage1_l: 0.1880, stage1_h: 0.4999, loss: 0.2927, grad_norm: 12.1077
2024-04-19 17:43:16,913 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:37:20, time: 1.708, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0142, stage0_bag_acc: 99.4638, stage0_mean_ious: 0.5326, stage0_s: 0.0000, stage0_m: 0.0594, stage0_l: 0.2014, stage0_h: 0.5735, stage1_loss_instance_mil: 0.1508, stage1_bag_acc: 99.3510, stage1_neg_loss: 0.0577, stage1_mean_ious: 0.5152, stage1_s: 0.0000, stage1_m: 0.0695, stage1_l: 0.2161, stage1_h: 0.5493, loss: 0.2227, grad_norm: 10.3902
2024-04-19 17:44:40,278 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:36:27, time: 1.667, data_time: 0.041, memory: 17809, stage0_loss_instance_mil: 0.0164, stage0_bag_acc: 98.7964, stage0_mean_ious: 0.5204, stage0_s: 0.0000, stage0_m: 0.0799, stage0_l: 0.2136, stage0_h: 0.5615, stage1_loss_instance_mil: 0.1449, stage1_bag_acc: 99.4538, stage1_neg_loss: 0.0528, stage1_mean_ious: 0.5096, stage1_s: 0.0000, stage1_m: 0.0896, stage1_l: 0.2330, stage1_h: 0.5440, loss: 0.2140, grad_norm: 9.8379
2024-04-19 17:45:31,912 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 17:47:00,503 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:28, time: 1.713, data_time: 0.092, memory: 17809, stage0_loss_instance_mil: 0.0100, stage0_bag_acc: 99.4791, stage0_mean_ious: 0.5316, stage0_s: 0.0000, stage0_m: 0.0775, stage0_l: 0.2705, stage0_h: 0.5767, stage1_loss_instance_mil: 0.1142, stage1_bag_acc: 99.6661, stage1_neg_loss: 0.0497, stage1_mean_ious: 0.5192, stage1_s: 0.0000, stage1_m: 0.0898, stage1_l: 0.2932, stage1_h: 0.5569, loss: 0.1739, grad_norm: 9.5395
2024-04-19 17:48:26,389 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:38, time: 1.718, data_time: 0.047, memory: 17809, stage0_loss_instance_mil: 0.0172, stage0_bag_acc: 98.9008, stage0_mean_ious: 0.5945, stage0_s: 0.0000, stage0_m: 0.0494, stage0_l: 0.2485, stage0_h: 0.6299, stage1_loss_instance_mil: 0.1117, stage1_bag_acc: 99.4544, stage1_neg_loss: 0.0461, stage1_mean_ious: 0.5859, stage1_s: 0.0000, stage1_m: 0.0528, stage1_l: 0.2658, stage1_h: 0.6175, loss: 0.1750, grad_norm: 9.9539
2024-04-19 17:49:52,367 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:44, time: 1.720, data_time: 0.048, memory: 17809, stage0_loss_instance_mil: 0.0240, stage0_bag_acc: 98.9114, stage0_mean_ious: 0.5743, stage0_s: 0.0000, stage0_m: 0.0578, stage0_l: 0.2444, stage0_h: 0.6140, stage1_loss_instance_mil: 0.1082, stage1_bag_acc: 98.4893, stage1_neg_loss: 0.0380, stage1_mean_ious: 0.5615, stage1_s: 0.0000, stage1_m: 0.0657, stage1_l: 0.2580, stage1_h: 0.5969, loss: 0.1702, grad_norm: 8.5264
2024-04-19 17:50:43,609 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 17:52:14,812 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:29:08, time: 1.772, data_time: 0.100, memory: 17809, stage0_loss_instance_mil: 0.0055, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.6120, stage0_s: 0.0000, stage0_m: 0.0437, stage0_l: 0.3117, stage0_h: 0.6444, stage1_loss_instance_mil: 0.0744, stage1_bag_acc: 99.7697, stage1_neg_loss: 0.0315, stage1_mean_ious: 0.5945, stage1_s: 0.0000, stage1_m: 0.0501, stage1_l: 0.3379, stage1_h: 0.6210, loss: 0.1114, grad_norm: 5.9499
2024-04-19 17:53:39,770 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 17:53:39,771 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:28:11, time: 1.699, data_time: 0.046, memory: 17809, stage0_loss_instance_mil: 0.0074, stage0_bag_acc: 99.6508, stage0_mean_ious: 0.5749, stage0_s: 0.0000, stage0_m: 0.0387, stage0_l: 0.3230, stage0_h: 0.6123, stage1_loss_instance_mil: 0.0717, stage1_bag_acc: 99.7281, stage1_neg_loss: 0.0307, stage1_mean_ious: 0.5605, stage1_s: 0.0000, stage1_m: 0.0444, stage1_l: 0.3301, stage1_h: 0.5922, loss: 0.1097, grad_norm: 5.6452
2024-04-19 17:55:04,508 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:27:10, time: 1.695, data_time: 0.046, memory: 17809, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.3620, stage0_mean_ious: 0.6021, stage0_s: 0.0000, stage0_m: 0.0496, stage0_l: 0.3078, stage0_h: 0.6344, stage1_loss_instance_mil: 0.0697, stage1_bag_acc: 99.6157, stage1_neg_loss: 0.0323, stage1_mean_ious: 0.5897, stage1_s: 0.0000, stage1_m: 0.0538, stage1_l: 0.3298, stage1_h: 0.6163, loss: 0.1128, grad_norm: 5.7938
2024-04-19 17:55:55,010 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 17:58:03,390 - mmdet - INFO - Evaluating bbox...
2024-04-19 17:58:05,375 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3104
2024-04-19 17:58:05,375 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6391
2024-04-19 17:58:05,375 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.5273
2024-04-19 17:58:05,376 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.3599
2024-04-19 17:58:05,376 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2726
2024-04-19 17:58:05,376 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1648
2024-04-19 17:58:05,376 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0246
2024-04-19 17:58:05,376 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2837
2024-04-19 17:58:05,377 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3118
2024-04-19 17:58:05,377 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3255
2024-04-19 17:58:05,377 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.4202
2024-04-19 17:58:05,377 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.4202
2024-04-19 17:58:05,377 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.4202
2024-04-19 17:58:05,377 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3262
2024-04-19 17:58:05,378 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3991
2024-04-19 17:58:05,378 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4103
2024-04-19 17:58:05,423 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 17:58:05,423 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.3100, bbox_mAP_50: 0.6390, bbox_mAP_75: 0.5270, bbox_mAP_s: 0.3600, bbox_mAP_m: 0.2730, bbox_mAP_l: 0.1650, bbox_mAP_copypaste: 0.310 0.639 0.527 0.360 0.273 0.165
2024-04-19 17:59:30,977 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:44, time: 1.710, data_time: 0.097, memory: 17809, stage0_loss_instance_mil: 0.0114, stage0_bag_acc: 99.5288, stage0_mean_ious: 0.5994, stage0_s: 0.0000, stage0_m: 0.0536, stage0_l: 0.2998, stage0_h: 0.6420, stage1_loss_instance_mil: 0.0585, stage1_bag_acc: 99.6986, stage1_neg_loss: 0.0282, stage1_mean_ious: 0.5892, stage1_s: 0.0000, stage1_m: 0.0580, stage1_l: 0.3214, stage1_h: 0.6258, loss: 0.0980, grad_norm: 4.8181
2024-04-19 18:00:55,807 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:42, time: 1.697, data_time: 0.046, memory: 17809, stage0_loss_instance_mil: 0.0305, stage0_bag_acc: 98.2597, stage0_mean_ious: 0.6049, stage0_s: 0.0000, stage0_m: 0.0475, stage0_l: 0.3266, stage0_h: 0.6308, stage1_loss_instance_mil: 0.0802, stage1_bag_acc: 98.9895, stage1_neg_loss: 0.0330, stage1_mean_ious: 0.5926, stage1_s: 0.0000, stage1_m: 0.0555, stage1_l: 0.3412, stage1_h: 0.6131, loss: 0.1437, grad_norm: 6.3393
2024-04-19 18:02:17,994 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:37, time: 1.644, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0171, stage0_bag_acc: 99.3399, stage0_mean_ious: 0.5938, stage0_s: 0.0000, stage0_m: 0.0381, stage0_l: 0.2881, stage0_h: 0.6329, stage1_loss_instance_mil: 0.0718, stage1_bag_acc: 99.2288, stage1_neg_loss: 0.0373, stage1_mean_ious: 0.5860, stage1_s: 0.0000, stage1_m: 0.0420, stage1_l: 0.3109, stage1_h: 0.6216, loss: 0.1262, grad_norm: 5.3521
2024-04-19 18:03:09,269 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 18:04:39,076 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:21, time: 1.734, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0110, stage0_bag_acc: 99.4333, stage0_mean_ious: 0.5815, stage0_s: 0.0000, stage0_m: 0.0480, stage0_l: 0.2435, stage0_h: 0.6202, stage1_loss_instance_mil: 0.0741, stage1_bag_acc: 99.7490, stage1_neg_loss: 0.0331, stage1_mean_ious: 0.5679, stage1_s: 0.0000, stage1_m: 0.0576, stage1_l: 0.2617, stage1_h: 0.5998, loss: 0.1181, grad_norm: 5.5429
2024-04-19 18:06:04,042 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:16, time: 1.699, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0098, stage0_bag_acc: 99.3970, stage0_mean_ious: 0.6098, stage0_s: 0.0000, stage0_m: 0.0263, stage0_l: 0.2874, stage0_h: 0.6423, stage1_loss_instance_mil: 0.0584, stage1_bag_acc: 99.5408, stage1_neg_loss: 0.0285, stage1_mean_ious: 0.5977, stage1_s: 0.0000, stage1_m: 0.0300, stage1_l: 0.3204, stage1_h: 0.6242, loss: 0.0967, grad_norm: 4.4312
2024-04-19 18:07:29,800 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:18:11, time: 1.715, data_time: 0.043, memory: 17809, stage0_loss_instance_mil: 0.0117, stage0_bag_acc: 99.0637, stage0_mean_ious: 0.5925, stage0_s: 0.0000, stage0_m: 0.0771, stage0_l: 0.3375, stage0_h: 0.6363, stage1_loss_instance_mil: 0.0613, stage1_bag_acc: 99.3395, stage1_neg_loss: 0.0270, stage1_mean_ious: 0.5866, stage1_s: 0.0000, stage1_m: 0.0871, stage1_l: 0.3758, stage1_h: 0.6223, loss: 0.0999, grad_norm: 4.6499
2024-04-19 18:08:20,235 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 18:09:49,733 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:16:01, time: 1.729, data_time: 0.096, memory: 17809, stage0_loss_instance_mil: 0.0044, stage0_bag_acc: 99.7824, stage0_mean_ious: 0.5963, stage0_s: 0.0000, stage0_m: 0.0295, stage0_l: 0.3133, stage0_h: 0.6266, stage1_loss_instance_mil: 0.0454, stage1_bag_acc: 99.6862, stage1_neg_loss: 0.0197, stage1_mean_ious: 0.5808, stage1_s: 0.0000, stage1_m: 0.0392, stage1_l: 0.3241, stage1_h: 0.6052, loss: 0.0695, grad_norm: 3.4540
2024-04-19 18:11:13,490 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:54, time: 1.675, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0100, stage0_bag_acc: 99.5388, stage0_mean_ious: 0.6022, stage0_s: 0.0000, stage0_m: 0.0767, stage0_l: 0.3280, stage0_h: 0.6324, stage1_loss_instance_mil: 0.0377, stage1_bag_acc: 99.5388, stage1_neg_loss: 0.0293, stage1_mean_ious: 0.5989, stage1_s: 0.0000, stage1_m: 0.0809, stage1_l: 0.3434, stage1_h: 0.6264, loss: 0.0771, grad_norm: 4.0018
2024-04-19 18:12:38,507 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:47, time: 1.700, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.7778, stage0_mean_ious: 0.6050, stage0_s: 0.0000, stage0_m: 0.0870, stage0_l: 0.3002, stage0_h: 0.6399, stage1_loss_instance_mil: 0.0380, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0199, stage1_mean_ious: 0.5991, stage1_s: 0.0000, stage1_m: 0.0998, stage1_l: 0.3106, stage1_h: 0.6297, loss: 0.0614, grad_norm: 3.1459
2024-04-19 18:13:30,721 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 18:15:00,262 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:42, time: 1.737, data_time: 0.098, memory: 17809, stage0_loss_instance_mil: 0.0036, stage0_bag_acc: 99.6718, stage0_mean_ious: 0.6070, stage0_s: 0.0000, stage0_m: 0.0248, stage0_l: 0.3117, stage0_h: 0.6405, stage1_loss_instance_mil: 0.0338, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0196, stage1_mean_ious: 0.5973, stage1_s: 0.0000, stage1_m: 0.0296, stage1_l: 0.3253, stage1_h: 0.6262, loss: 0.0570, grad_norm: 2.7834
2024-04-19 18:16:25,900 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:34, time: 1.713, data_time: 0.045, memory: 17809, stage0_loss_instance_mil: 0.0094, stage0_bag_acc: 99.4558, stage0_mean_ious: 0.5812, stage0_s: 0.0000, stage0_m: 0.0729, stage0_l: 0.3331, stage0_h: 0.6150, stage1_loss_instance_mil: 0.0351, stage1_bag_acc: 99.7798, stage1_neg_loss: 0.0258, stage1_mean_ious: 0.5747, stage1_s: 0.0000, stage1_m: 0.0768, stage1_l: 0.3629, stage1_h: 0.6030, loss: 0.0703, grad_norm: 3.6902
2024-04-19 18:17:50,266 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:09:25, time: 1.687, data_time: 0.044, memory: 17809, stage0_loss_instance_mil: 0.0032, stage0_bag_acc: 99.7190, stage0_mean_ious: 0.6074, stage0_s: 0.0000, stage0_m: 0.0647, stage0_l: 0.3505, stage0_h: 0.6427, stage1_loss_instance_mil: 0.0373, stage1_bag_acc: 99.9200, stage1_neg_loss: 0.0192, stage1_mean_ious: 0.6019, stage1_s: 0.0000, stage1_m: 0.0740, stage1_l: 0.3698, stage1_h: 0.6325, loss: 0.0598, grad_norm: 3.1856
2024-04-19 18:18:42,091 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 18:20:11,344 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:07:24, time: 1.725, data_time: 0.096, memory: 17810, stage0_loss_instance_mil: 0.0031, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.5925, stage0_s: 0.0012, stage0_m: 0.0726, stage0_l: 0.2862, stage0_h: 0.6235, stage1_loss_instance_mil: 0.0304, stage1_bag_acc: 99.8261, stage1_neg_loss: 0.0182, stage1_mean_ious: 0.5861, stage1_s: 0.0012, stage1_m: 0.0723, stage1_l: 0.3065, stage1_h: 0.6112, loss: 0.0517, grad_norm: 2.7162
2024-04-19 18:21:36,278 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:06:14, time: 1.699, data_time: 0.045, memory: 17810, stage0_loss_instance_mil: 0.0083, stage0_bag_acc: 99.7000, stage0_mean_ious: 0.6057, stage0_s: 0.0000, stage0_m: 0.0861, stage0_l: 0.3476, stage0_h: 0.6350, stage1_loss_instance_mil: 0.0320, stage1_bag_acc: 99.6750, stage1_neg_loss: 0.0220, stage1_mean_ious: 0.5917, stage1_s: 0.0000, stage1_m: 0.0875, stage1_l: 0.3686, stage1_h: 0.6155, loss: 0.0623, grad_norm: 3.0174
2024-04-19 18:23:01,927 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:05:03, time: 1.713, data_time: 0.045, memory: 17810, stage0_loss_instance_mil: 0.0021, stage0_bag_acc: 99.8667, stage0_mean_ious: 0.6085, stage0_s: 0.0000, stage0_m: 0.0917, stage0_l: 0.3613, stage0_h: 0.6421, stage1_loss_instance_mil: 0.0353, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0252, stage1_mean_ious: 0.6021, stage1_s: 0.0000, stage1_m: 0.1106, stage1_l: 0.3733, stage1_h: 0.6298, loss: 0.0626, grad_norm: 3.4773
2024-04-19 18:23:53,096 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 18:25:23,796 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:03:06, time: 1.752, data_time: 0.101, memory: 17810, stage0_loss_instance_mil: 0.0023, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.5914, stage0_s: 0.0012, stage0_m: 0.0795, stage0_l: 0.3183, stage0_h: 0.6196, stage1_loss_instance_mil: 0.0333, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0168, stage1_mean_ious: 0.5888, stage1_s: 0.0012, stage1_m: 0.0894, stage1_l: 0.3266, stage1_h: 0.6122, loss: 0.0524, grad_norm: 2.9067
2024-04-19 18:26:49,441 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:01:55, time: 1.713, data_time: 0.045, memory: 17810, stage0_loss_instance_mil: 0.0044, stage0_bag_acc: 99.6980, stage0_mean_ious: 0.6096, stage0_s: 0.0000, stage0_m: 0.0375, stage0_l: 0.3021, stage0_h: 0.6471, stage1_loss_instance_mil: 0.0282, stage1_bag_acc: 99.9091, stage1_neg_loss: 0.0214, stage1_mean_ious: 0.5981, stage1_s: 0.0000, stage1_m: 0.0391, stage1_l: 0.3295, stage1_h: 0.6305, loss: 0.0540, grad_norm: 2.9802
2024-04-19 18:28:11,908 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:00:43, time: 1.649, data_time: 0.043, memory: 17810, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.8667, stage0_mean_ious: 0.6161, stage0_s: 0.0000, stage0_m: 0.0697, stage0_l: 0.3398, stage0_h: 0.6528, stage1_loss_instance_mil: 0.0339, stage1_bag_acc: 99.7667, stage1_neg_loss: 0.0213, stage1_mean_ious: 0.6030, stage1_s: 0.0000, stage1_m: 0.0726, stage1_l: 0.3631, stage1_h: 0.6313, loss: 0.0612, grad_norm: 3.2100
2024-04-19 18:29:00,145 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 18:30:58,503 - mmdet - INFO - Evaluating bbox...
2024-04-19 18:31:00,488 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3181
2024-04-19 18:31:00,488 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6910
2024-04-19 18:31:00,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.5401
2024-04-19 18:31:00,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.3530
2024-04-19 18:31:00,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2539
2024-04-19 18:31:00,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1575
2024-04-19 18:31:00,489 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0367
2024-04-19 18:31:00,490 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2934
2024-04-19 18:31:00,490 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3000
2024-04-19 18:31:00,490 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3688
2024-04-19 18:31:00,490 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.4294
2024-04-19 18:31:00,491 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.4294
2024-04-19 18:31:00,491 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.4294
2024-04-19 18:31:00,491 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3519
2024-04-19 18:31:00,491 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3870
2024-04-19 18:31:00,491 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.5014
2024-04-19 18:31:00,535 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 18:31:00,535 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.3180, bbox_mAP_50: 0.6910, bbox_mAP_75: 0.5400, bbox_mAP_s: 0.3530, bbox_mAP_m: 0.2540, bbox_mAP_l: 0.1570, bbox_mAP_copypaste: 0.318 0.691 0.540 0.353 0.254 0.157
2024-04-19 18:32:58,908 - mmdet - INFO - Evaluating bbox...
2024-04-19 18:33:00,906 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3181
2024-04-19 18:33:00,907 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6910
2024-04-19 18:33:00,907 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.5401
2024-04-19 18:33:00,907 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.3530
2024-04-19 18:33:00,907 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2539
2024-04-19 18:33:00,908 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1575
2024-04-19 18:33:00,908 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0367
2024-04-19 18:33:00,908 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2934
2024-04-19 18:33:00,908 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3000
2024-04-19 18:33:00,908 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3688
2024-04-19 18:33:00,909 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.4294
2024-04-19 18:33:00,909 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.4294
2024-04-19 18:33:00,909 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.4294
2024-04-19 18:33:00,909 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3519
2024-04-19 18:33:00,909 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3870
2024-04-19 18:33:00,909 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.5014
2024-04-19 18:33:03,573 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 18:33:05,746 - mmdet - INFO - Distributed training: False
2024-04-19 18:33:07,847 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 18:33:10,341 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 18:33:10,342 - mmdet - INFO - Use load_from_local loader
2024-04-19 18:33:10,723 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 18:33:10,749 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 18:33:10,749 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 18:34:34,387 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 0:58:49, time: 1.673, data_time: 0.097, memory: 17810, stage0_loss_instance_mil: 0.7053, stage0_bag_acc: 28.4068, stage0_mean_ious: 0.4042, stage0_s: 0.0000, stage0_m: 0.0321, stage0_l: 0.2676, stage0_h: 0.4303, stage1_loss_instance_mil: 0.1797, stage1_bag_acc: 12.0475, stage1_neg_loss: 0.0011, stage1_mean_ious: 0.3722, stage1_s: 0.0000, stage1_m: 0.0283, stage1_l: 0.2602, stage1_h: 0.3942, loss: 0.8862, grad_norm: 3.3744
2024-04-19 18:35:55,622 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 0:56:36, time: 1.625, data_time: 0.042, memory: 17810, stage0_loss_instance_mil: 0.5740, stage0_bag_acc: 57.0534, stage0_mean_ious: 0.3990, stage0_s: 0.0000, stage0_m: 0.0472, stage0_l: 0.3148, stage0_h: 0.4127, stage1_loss_instance_mil: 0.2765, stage1_bag_acc: 21.9206, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.3739, stage1_s: 0.0000, stage1_m: 0.0428, stage1_l: 0.2977, stage1_h: 0.3862, loss: 0.8538, grad_norm: 4.1353
2024-04-19 18:37:20,749 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 0:55:49, time: 1.703, data_time: 0.044, memory: 17810, stage0_loss_instance_mil: 0.2711, stage0_bag_acc: 86.5260, stage0_mean_ious: 0.3819, stage0_s: 0.0000, stage0_m: 0.0383, stage0_l: 0.2156, stage0_h: 0.3923, stage1_loss_instance_mil: 0.3575, stage1_bag_acc: 74.7087, stage1_neg_loss: 0.0624, stage1_mean_ious: 0.3750, stage1_s: 0.0000, stage1_m: 0.0307, stage1_l: 0.2264, stage1_h: 0.3856, loss: 0.6910, grad_norm: 10.6316
2024-04-19 18:38:10,688 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 18:39:39,575 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 0:46:58, time: 1.718, data_time: 0.092, memory: 17810, stage0_loss_instance_mil: 0.0960, stage0_bag_acc: 94.5188, stage0_mean_ious: 0.3126, stage0_s: 0.0000, stage0_m: 0.0597, stage0_l: 0.1745, stage0_h: 0.3228, stage1_loss_instance_mil: 0.3656, stage1_bag_acc: 95.4209, stage1_neg_loss: 0.0835, stage1_mean_ious: 0.3045, stage1_s: 0.0000, stage1_m: 0.0612, stage1_l: 0.1699, stage1_h: 0.3158, loss: 0.5451, grad_norm: 12.0571
2024-04-19 18:41:03,721 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 0:47:00, time: 1.683, data_time: 0.045, memory: 17810, stage0_loss_instance_mil: 0.0627, stage0_bag_acc: 96.4668, stage0_mean_ious: 0.3066, stage0_s: 0.0000, stage0_m: 0.0116, stage0_l: 0.1540, stage0_h: 0.3201, stage1_loss_instance_mil: 0.3286, stage1_bag_acc: 97.6183, stage1_neg_loss: 0.1029, stage1_mean_ious: 0.2992, stage1_s: 0.0000, stage1_m: 0.0137, stage1_l: 0.1576, stage1_h: 0.3113, loss: 0.4942, grad_norm: 16.7348
2024-04-19 18:42:26,717 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 0:46:29, time: 1.660, data_time: 0.045, memory: 17810, stage0_loss_instance_mil: 0.0390, stage0_bag_acc: 97.9658, stage0_mean_ious: 0.2943, stage0_s: 0.0000, stage0_m: 0.0566, stage0_l: 0.1337, stage0_h: 0.3172, stage1_loss_instance_mil: 0.2872, stage1_bag_acc: 98.6096, stage1_neg_loss: 0.0870, stage1_mean_ious: 0.2808, stage1_s: 0.0000, stage1_m: 0.0494, stage1_l: 0.1261, stage1_h: 0.3027, loss: 0.4132, grad_norm: 13.1691
2024-04-19 18:43:18,283 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 18:44:47,867 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 0:41:55, time: 1.729, data_time: 0.100, memory: 17810, stage0_loss_instance_mil: 0.0313, stage0_bag_acc: 98.2359, stage0_mean_ious: 0.3348, stage0_s: 0.0000, stage0_m: 0.0228, stage0_l: 0.1163, stage0_h: 0.3571, stage1_loss_instance_mil: 0.2554, stage1_bag_acc: 98.9291, stage1_neg_loss: 0.0827, stage1_mean_ious: 0.3112, stage1_s: 0.0000, stage1_m: 0.0260, stage1_l: 0.1132, stage1_h: 0.3301, loss: 0.3694, grad_norm: 13.9026
2024-04-19 18:46:10,936 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 0:41:25, time: 1.661, data_time: 0.045, memory: 17810, stage0_loss_instance_mil: 0.0306, stage0_bag_acc: 98.8555, stage0_mean_ious: 0.3407, stage0_s: 0.0000, stage0_m: 0.0383, stage0_l: 0.1143, stage0_h: 0.3691, stage1_loss_instance_mil: 0.2735, stage1_bag_acc: 98.7389, stage1_neg_loss: 0.0909, stage1_mean_ious: 0.3083, stage1_s: 0.0000, stage1_m: 0.0430, stage1_l: 0.1081, stage1_h: 0.3330, loss: 0.3950, grad_norm: 15.9157
2024-04-19 18:47:36,293 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 0:40:51, time: 1.707, data_time: 0.046, memory: 17810, stage0_loss_instance_mil: 0.0316, stage0_bag_acc: 98.5813, stage0_mean_ious: 0.3159, stage0_s: 0.0000, stage0_m: 0.0278, stage0_l: 0.1066, stage0_h: 0.3395, stage1_loss_instance_mil: 0.2483, stage1_bag_acc: 98.6931, stage1_neg_loss: 0.0790, stage1_mean_ious: 0.2913, stage1_s: 0.0000, stage1_m: 0.0206, stage1_l: 0.1016, stage1_h: 0.3118, loss: 0.3589, grad_norm: 14.4566
2024-04-19 18:48:27,008 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 18:49:55,649 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 0:37:24, time: 1.712, data_time: 0.102, memory: 17810, stage0_loss_instance_mil: 0.0456, stage0_bag_acc: 97.5568, stage0_mean_ious: 0.3640, stage0_s: 0.0000, stage0_m: 0.0289, stage0_l: 0.1193, stage0_h: 0.3916, stage1_loss_instance_mil: 0.2286, stage1_bag_acc: 97.9698, stage1_neg_loss: 0.0692, stage1_mean_ious: 0.3324, stage1_s: 0.0000, stage1_m: 0.0246, stage1_l: 0.1159, stage1_h: 0.3568, loss: 0.3433, grad_norm: 11.5905
2024-04-19 18:51:20,353 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 0:36:44, time: 1.694, data_time: 0.047, memory: 17810, stage0_loss_instance_mil: 0.0221, stage0_bag_acc: 98.7075, stage0_mean_ious: 0.4182, stage0_s: 0.0017, stage0_m: 0.0199, stage0_l: 0.1434, stage0_h: 0.4510, stage1_loss_instance_mil: 0.2010, stage1_bag_acc: 99.1060, stage1_neg_loss: 0.0784, stage1_mean_ious: 0.3808, stage1_s: 0.0014, stage1_m: 0.0162, stage1_l: 0.1475, stage1_h: 0.4095, loss: 0.3016, grad_norm: 13.3837
2024-04-19 18:52:43,562 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 0:35:54, time: 1.664, data_time: 0.046, memory: 17810, stage0_loss_instance_mil: 0.0240, stage0_bag_acc: 98.7745, stage0_mean_ious: 0.4611, stage0_s: 0.0000, stage0_m: 0.0418, stage0_l: 0.1985, stage0_h: 0.5030, stage1_loss_instance_mil: 0.1630, stage1_bag_acc: 99.2317, stage1_neg_loss: 0.0585, stage1_mean_ious: 0.4247, stage1_s: 0.0000, stage1_m: 0.0425, stage1_l: 0.1945, stage1_h: 0.4606, loss: 0.2456, grad_norm: 10.4838
2024-04-19 18:53:34,991 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 18:55:05,022 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 0:33:02, time: 1.739, data_time: 0.100, memory: 17810, stage0_loss_instance_mil: 0.0203, stage0_bag_acc: 99.1061, stage0_mean_ious: 0.4684, stage0_s: 0.0000, stage0_m: 0.0372, stage0_l: 0.1569, stage0_h: 0.4985, stage1_loss_instance_mil: 0.1533, stage1_bag_acc: 99.2488, stage1_neg_loss: 0.0617, stage1_mean_ious: 0.4283, stage1_s: 0.0000, stage1_m: 0.0340, stage1_l: 0.1562, stage1_h: 0.4532, loss: 0.2352, grad_norm: 9.3299
2024-04-19 18:56:29,462 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 0:32:12, time: 1.689, data_time: 0.047, memory: 17810, stage0_loss_instance_mil: 0.0264, stage0_bag_acc: 98.0723, stage0_mean_ious: 0.4538, stage0_s: 0.0000, stage0_m: 0.0537, stage0_l: 0.1717, stage0_h: 0.4912, stage1_loss_instance_mil: 0.1650, stage1_bag_acc: 98.4047, stage1_neg_loss: 0.0612, stage1_mean_ious: 0.4259, stage1_s: 0.0000, stage1_m: 0.0677, stage1_l: 0.1838, stage1_h: 0.4546, loss: 0.2527, grad_norm: 10.8915
2024-04-19 18:57:51,084 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 0:31:14, time: 1.632, data_time: 0.043, memory: 17810, stage0_loss_instance_mil: 0.0164, stage0_bag_acc: 99.1273, stage0_mean_ious: 0.4583, stage0_s: 0.0000, stage0_m: 0.0546, stage0_l: 0.1528, stage0_h: 0.5013, stage1_loss_instance_mil: 0.1223, stage1_bag_acc: 99.3618, stage1_neg_loss: 0.0558, stage1_mean_ious: 0.4328, stage1_s: 0.0000, stage1_m: 0.0596, stage1_l: 0.1713, stage1_h: 0.4679, loss: 0.1945, grad_norm: 7.6254
2024-04-19 18:58:43,381 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 19:00:12,528 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 0:28:40, time: 1.731, data_time: 0.100, memory: 17810, stage0_loss_instance_mil: 0.0095, stage0_bag_acc: 99.5784, stage0_mean_ious: 0.5206, stage0_s: 0.0000, stage0_m: 0.0363, stage0_l: 0.2546, stage0_h: 0.5632, stage1_loss_instance_mil: 0.1179, stage1_bag_acc: 99.5417, stage1_neg_loss: 0.0578, stage1_mean_ious: 0.4913, stage1_s: 0.0000, stage1_m: 0.0382, stage1_l: 0.2561, stage1_h: 0.5277, loss: 0.1851, grad_norm: 9.3150
2024-04-19 19:01:34,210 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 19:01:34,211 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 0:27:41, time: 1.634, data_time: 0.044, memory: 17810, stage0_loss_instance_mil: 0.0092, stage0_bag_acc: 99.5459, stage0_mean_ious: 0.4935, stage0_s: 0.0000, stage0_m: 0.0436, stage0_l: 0.1886, stage0_h: 0.5348, stage1_loss_instance_mil: 0.1091, stage1_bag_acc: 99.6848, stage1_neg_loss: 0.0458, stage1_mean_ious: 0.4780, stage1_s: 0.0000, stage1_m: 0.0508, stage1_l: 0.2128, stage1_h: 0.5132, loss: 0.1640, grad_norm: 7.2878
2024-04-19 19:02:59,241 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 0:26:44, time: 1.701, data_time: 0.046, memory: 17810, stage0_loss_instance_mil: 0.0125, stage0_bag_acc: 99.3341, stage0_mean_ious: 0.5235, stage0_s: 0.0000, stage0_m: 0.0465, stage0_l: 0.2206, stage0_h: 0.5641, stage1_loss_instance_mil: 0.1002, stage1_bag_acc: 99.5948, stage1_neg_loss: 0.0487, stage1_mean_ious: 0.4998, stage1_s: 0.0000, stage1_m: 0.0554, stage1_l: 0.2313, stage1_h: 0.5354, loss: 0.1614, grad_norm: 7.3852
2024-04-19 19:03:50,443 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 19:05:51,020 - mmdet - INFO - Evaluating bbox...
2024-04-19 19:05:53,018 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1894
2024-04-19 19:05:53,018 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4804
2024-04-19 19:05:53,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3455
2024-04-19 19:05:53,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1962
2024-04-19 19:05:53,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1133
2024-04-19 19:05:53,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0439
2024-04-19 19:05:53,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0029
2024-04-19 19:05:53,020 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0357
2024-04-19 19:05:53,020 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1707
2024-04-19 19:05:53,020 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2283
2024-04-19 19:05:53,020 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2761
2024-04-19 19:05:53,020 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2761
2024-04-19 19:05:53,021 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2761
2024-04-19 19:05:53,021 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0806
2024-04-19 19:05:53,021 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2440
2024-04-19 19:05:53,021 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2916
2024-04-19 19:05:53,071 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 19:05:53,071 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.1890, bbox_mAP_50: 0.4800, bbox_mAP_75: 0.3460, bbox_mAP_s: 0.1960, bbox_mAP_m: 0.1130, bbox_mAP_l: 0.0440, bbox_mAP_copypaste: 0.189 0.480 0.346 0.196 0.113 0.044
2024-04-19 19:07:18,131 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:24:20, time: 1.700, data_time: 0.098, memory: 17810, stage0_loss_instance_mil: 0.0090, stage0_bag_acc: 99.5129, stage0_mean_ious: 0.4844, stage0_s: 0.0000, stage0_m: 0.0431, stage0_l: 0.2021, stage0_h: 0.5227, stage1_loss_instance_mil: 0.0882, stage1_bag_acc: 99.5129, stage1_neg_loss: 0.0439, stage1_mean_ious: 0.4667, stage1_s: 0.0000, stage1_m: 0.0504, stage1_l: 0.2072, stage1_h: 0.5014, loss: 0.1410, grad_norm: 6.0098
2024-04-19 19:08:42,224 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:23:20, time: 1.682, data_time: 0.045, memory: 17810, stage0_loss_instance_mil: 0.0249, stage0_bag_acc: 98.2952, stage0_mean_ious: 0.5233, stage0_s: 0.0000, stage0_m: 0.0425, stage0_l: 0.1906, stage0_h: 0.5658, stage1_loss_instance_mil: 0.0806, stage1_bag_acc: 98.8650, stage1_neg_loss: 0.0367, stage1_mean_ious: 0.5099, stage1_s: 0.0000, stage1_m: 0.0403, stage1_l: 0.1945, stage1_h: 0.5507, loss: 0.1422, grad_norm: 6.4071
2024-04-19 19:10:06,939 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:22:19, time: 1.694, data_time: 0.045, memory: 17810, stage0_loss_instance_mil: 0.0108, stage0_bag_acc: 99.3214, stage0_mean_ious: 0.5417, stage0_s: 0.0018, stage0_m: 0.0466, stage0_l: 0.2069, stage0_h: 0.5951, stage1_loss_instance_mil: 0.0861, stage1_bag_acc: 99.4401, stage1_neg_loss: 0.0413, stage1_mean_ious: 0.5232, stage1_s: 0.0014, stage1_m: 0.0476, stage1_l: 0.2199, stage1_h: 0.5706, loss: 0.1382, grad_norm: 7.0259
2024-04-19 19:10:57,293 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 19:12:24,875 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:20:04, time: 1.698, data_time: 0.097, memory: 17810, stage0_loss_instance_mil: 0.0084, stage0_bag_acc: 99.7019, stage0_mean_ious: 0.5453, stage0_s: 0.0000, stage0_m: 0.0743, stage0_l: 0.2306, stage0_h: 0.5896, stage1_loss_instance_mil: 0.0789, stage1_bag_acc: 99.5444, stage1_neg_loss: 0.0409, stage1_mean_ious: 0.5234, stage1_s: 0.0000, stage1_m: 0.0856, stage1_l: 0.2378, stage1_h: 0.5614, loss: 0.1283, grad_norm: 6.5571
2024-04-19 19:13:47,446 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:19:00, time: 1.651, data_time: 0.043, memory: 17810, stage0_loss_instance_mil: 0.0104, stage0_bag_acc: 99.4716, stage0_mean_ious: 0.5577, stage0_s: 0.0000, stage0_m: 0.0474, stage0_l: 0.2358, stage0_h: 0.6043, stage1_loss_instance_mil: 0.0627, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0290, stage1_mean_ious: 0.5478, stage1_s: 0.0000, stage1_m: 0.0562, stage1_l: 0.2514, stage1_h: 0.5902, loss: 0.1021, grad_norm: 4.2332
2024-04-19 19:15:10,635 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:17:55, time: 1.664, data_time: 0.044, memory: 17810, stage0_loss_instance_mil: 0.0078, stage0_bag_acc: 99.5259, stage0_mean_ious: 0.5278, stage0_s: 0.0000, stage0_m: 0.0570, stage0_l: 0.2142, stage0_h: 0.5792, stage1_loss_instance_mil: 0.0737, stage1_bag_acc: 99.6212, stage1_neg_loss: 0.0348, stage1_mean_ious: 0.5112, stage1_s: 0.0000, stage1_m: 0.0588, stage1_l: 0.2231, stage1_h: 0.5568, loss: 0.1163, grad_norm: 4.8802
2024-04-19 19:16:00,757 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 19:17:29,399 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:15:47, time: 1.712, data_time: 0.097, memory: 17810, stage0_loss_instance_mil: 0.0047, stage0_bag_acc: 99.6447, stage0_mean_ious: 0.5462, stage0_s: 0.0015, stage0_m: 0.0542, stage0_l: 0.2110, stage0_h: 0.5910, stage1_loss_instance_mil: 0.0537, stage1_bag_acc: 99.7697, stage1_neg_loss: 0.0296, stage1_mean_ious: 0.5351, stage1_s: 0.0010, stage1_m: 0.0571, stage1_l: 0.2252, stage1_h: 0.5751, loss: 0.0881, grad_norm: 3.6436
2024-04-19 19:18:54,587 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:14:42, time: 1.704, data_time: 0.044, memory: 17810, stage0_loss_instance_mil: 0.0101, stage0_bag_acc: 99.5417, stage0_mean_ious: 0.5489, stage0_s: 0.0000, stage0_m: 0.0780, stage0_l: 0.2131, stage0_h: 0.5953, stage1_loss_instance_mil: 0.0501, stage1_bag_acc: 99.7917, stage1_neg_loss: 0.0275, stage1_mean_ious: 0.5364, stage1_s: 0.0000, stage1_m: 0.0792, stage1_l: 0.2255, stage1_h: 0.5795, loss: 0.0876, grad_norm: 3.6321
2024-04-19 19:20:18,853 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:13:36, time: 1.685, data_time: 0.045, memory: 17810, stage0_loss_instance_mil: 0.0025, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.5385, stage0_s: 0.0000, stage0_m: 0.0614, stage0_l: 0.2139, stage0_h: 0.5834, stage1_loss_instance_mil: 0.0483, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0259, stage1_mean_ious: 0.5261, stage1_s: 0.0000, stage1_m: 0.0667, stage1_l: 0.2258, stage1_h: 0.5661, loss: 0.0767, grad_norm: 3.5290
2024-04-19 19:21:11,306 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 19:22:40,971 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:11:33, time: 1.738, data_time: 0.099, memory: 17810, stage0_loss_instance_mil: 0.0047, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5478, stage0_s: 0.0000, stage0_m: 0.0383, stage0_l: 0.2515, stage0_h: 0.5901, stage1_loss_instance_mil: 0.0442, stage1_bag_acc: 99.8179, stage1_neg_loss: 0.0224, stage1_mean_ious: 0.5346, stage1_s: 0.0000, stage1_m: 0.0442, stage1_l: 0.2607, stage1_h: 0.5726, loss: 0.0713, grad_norm: 3.2872
2024-04-19 19:26:11,958 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:10:58, time: 4.219, data_time: 0.408, memory: 17810, stage0_loss_instance_mil: 0.0038, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.5588, stage0_s: 0.0000, stage0_m: 0.0436, stage0_l: 0.2279, stage0_h: 0.5989, stage1_loss_instance_mil: 0.0473, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0292, stage1_mean_ious: 0.5415, stage1_s: 0.0000, stage1_m: 0.0516, stage1_l: 0.2436, stage1_h: 0.5759, loss: 0.0804, grad_norm: 3.6763
2024-04-19 19:31:30,965 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:10:37, time: 6.377, data_time: 0.566, memory: 17810, stage0_loss_instance_mil: 0.0043, stage0_bag_acc: 99.9231, stage0_mean_ious: 0.5504, stage0_s: 0.0000, stage0_m: 0.0595, stage0_l: 0.2075, stage0_h: 0.5942, stage1_loss_instance_mil: 0.0458, stage1_bag_acc: 99.9231, stage1_neg_loss: 0.0272, stage1_mean_ious: 0.5419, stage1_s: 0.0000, stage1_m: 0.0693, stage1_l: 0.2173, stage1_h: 0.5817, loss: 0.0773, grad_norm: 3.6074
2024-04-19 19:35:14,755 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 19:40:47,310 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:08:56, time: 6.196, data_time: 0.709, memory: 17810, stage0_loss_instance_mil: 0.0041, stage0_bag_acc: 99.7712, stage0_mean_ious: 0.5615, stage0_s: 0.0000, stage0_m: 0.0449, stage0_l: 0.2389, stage0_h: 0.5979, stage1_loss_instance_mil: 0.0429, stage1_bag_acc: 99.8824, stage1_neg_loss: 0.0256, stage1_mean_ious: 0.5500, stage1_s: 0.0000, stage1_m: 0.0480, stage1_l: 0.2397, stage1_h: 0.5837, loss: 0.0726, grad_norm: 3.4056
2024-04-19 19:44:39,690 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:07:50, time: 4.648, data_time: 0.537, memory: 17810, stage0_loss_instance_mil: 0.0066, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.5631, stage0_s: 0.0000, stage0_m: 0.0669, stage0_l: 0.2423, stage0_h: 0.6109, stage1_loss_instance_mil: 0.0493, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0200, stage1_mean_ious: 0.5428, stage1_s: 0.0000, stage1_m: 0.0714, stage1_l: 0.2610, stage1_h: 0.5836, loss: 0.0758, grad_norm: 3.0507
2024-04-19 19:46:44,751 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:06:23, time: 2.501, data_time: 0.168, memory: 17810, stage0_loss_instance_mil: 0.0022, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.5526, stage0_s: 0.0000, stage0_m: 0.0546, stage0_l: 0.2351, stage0_h: 0.5919, stage1_loss_instance_mil: 0.0398, stage1_bag_acc: 99.7714, stage1_neg_loss: 0.0277, stage1_mean_ious: 0.5332, stage1_s: 0.0000, stage1_m: 0.0504, stage1_l: 0.2341, stage1_h: 0.5695, loss: 0.0698, grad_norm: 3.5032
2024-04-19 19:52:04,725 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 20:02:12,752 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:04:24, time: 11.251, data_time: 1.459, memory: 17810, stage0_loss_instance_mil: 0.0057, stage0_bag_acc: 99.7712, stage0_mean_ious: 0.5654, stage0_s: 0.0000, stage0_m: 0.0586, stage0_l: 0.2217, stage0_h: 0.6066, stage1_loss_instance_mil: 0.0425, stage1_bag_acc: 99.8824, stage1_neg_loss: 0.0207, stage1_mean_ious: 0.5442, stage1_s: 0.0000, stage1_m: 0.0615, stage1_l: 0.2213, stage1_h: 0.5813, loss: 0.0689, grad_norm: 3.0006
2024-04-19 20:07:32,826 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:02:50, time: 6.403, data_time: 0.586, memory: 17810, stage0_loss_instance_mil: 0.0018, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5430, stage0_s: 0.0000, stage0_m: 0.0643, stage0_l: 0.2210, stage0_h: 0.5924, stage1_loss_instance_mil: 0.0441, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0207, stage1_mean_ious: 0.5210, stage1_s: 0.0000, stage1_m: 0.0731, stage1_l: 0.2384, stage1_h: 0.5647, loss: 0.0666, grad_norm: 3.1644
2024-04-19 20:10:15,331 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:01:04, time: 3.247, data_time: 0.224, memory: 17810, stage0_loss_instance_mil: 0.0026, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.5579, stage0_s: 0.0000, stage0_m: 0.0338, stage0_l: 0.2497, stage0_h: 0.6018, stage1_loss_instance_mil: 0.0381, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0241, stage1_mean_ious: 0.5425, stage1_s: 0.0000, stage1_m: 0.0357, stage1_l: 0.2679, stage1_h: 0.5802, loss: 0.0648, grad_norm: 3.2409
2024-04-19 20:15:24,168 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-19 20:31:23,892 - mmdet - INFO - Evaluating bbox...
2024-04-19 20:31:54,355 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2509
2024-04-19 20:31:54,411 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5554
2024-04-19 20:31:54,423 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4280
2024-04-19 20:31:54,439 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2776
2024-04-19 20:31:54,459 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1985
2024-04-19 20:31:54,475 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1228
2024-04-19 20:31:54,531 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0252
2024-04-19 20:31:54,547 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0448
2024-04-19 20:31:54,555 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2281
2024-04-19 20:31:54,583 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3585
2024-04-19 20:31:54,599 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3603
2024-04-19 20:31:54,655 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3603
2024-04-19 20:31:54,667 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3603
2024-04-19 20:31:54,675 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1066
2024-04-19 20:31:54,691 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3061
2024-04-19 20:31:54,727 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4611
2024-04-19 20:31:55,957 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 20:31:56,051 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.2510, bbox_mAP_50: 0.5550, bbox_mAP_75: 0.4280, bbox_mAP_s: 0.2780, bbox_mAP_m: 0.1990, bbox_mAP_l: 0.1230, bbox_mAP_copypaste: 0.251 0.555 0.428 0.278 0.199 0.123
2024-04-19 20:53:22,394 - mmdet - INFO - Evaluating bbox...
2024-04-19 20:53:24,386 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2509
2024-04-19 20:53:24,386 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5554
2024-04-19 20:53:24,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4280
2024-04-19 20:53:24,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2776
2024-04-19 20:53:24,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1985
2024-04-19 20:53:24,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1228
2024-04-19 20:53:24,387 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0252
2024-04-19 20:53:24,388 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0448
2024-04-19 20:53:24,388 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2281
2024-04-19 20:53:24,388 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3585
2024-04-19 20:53:24,388 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3603
2024-04-19 20:53:24,389 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3603
2024-04-19 20:53:24,389 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3603
2024-04-19 20:53:24,389 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1066
2024-04-19 20:53:24,389 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3061
2024-04-19 20:53:24,389 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.4611
2024-04-19 20:53:27,047 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-19 20:53:29,225 - mmdet - INFO - Distributed training: False
2024-04-19 20:53:31,325 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-19 20:53:34,059 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-19 20:53:34,060 - mmdet - INFO - Use load_from_local loader
2024-04-19 20:53:34,441 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-19 20:53:34,463 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-19 20:53:34,464 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-19 21:02:18,165 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 6:08:15, time: 10.472, data_time: 1.053, memory: 17810, stage0_loss_instance_mil: 0.7126, stage0_bag_acc: 21.1547, stage0_mean_ious: 0.3390, stage0_s: 0.0000, stage0_m: 0.0167, stage0_l: 0.2413, stage0_h: 0.3455, stage1_loss_instance_mil: 0.1684, stage1_bag_acc: 14.0714, stage1_neg_loss: 0.0008, stage1_mean_ious: 0.3492, stage1_s: 0.0000, stage1_m: 0.0192, stage1_l: 0.2678, stage1_h: 0.3538, loss: 0.8818, grad_norm: 3.0485
2024-04-19 21:11:39,536 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 6:12:31, time: 11.229, data_time: 1.317, memory: 17810, stage0_loss_instance_mil: 0.5918, stage0_bag_acc: 52.7555, stage0_mean_ious: 0.3927, stage0_s: 0.0000, stage0_m: 0.0526, stage0_l: 0.3119, stage0_h: 0.4008, stage1_loss_instance_mil: 0.2441, stage1_bag_acc: 27.1483, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.3898, stage1_s: 0.0000, stage1_m: 0.0553, stage1_l: 0.3294, stage1_h: 0.3952, loss: 0.8385, grad_norm: 3.9431
2024-04-19 21:15:28,738 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 4:53:31, time: 4.585, data_time: 0.488, memory: 17810, stage0_loss_instance_mil: 0.2576, stage0_bag_acc: 83.9091, stage0_mean_ious: 0.4156, stage0_s: 0.0000, stage0_m: 0.1138, stage0_l: 0.2697, stage0_h: 0.4297, stage1_loss_instance_mil: 0.3193, stage1_bag_acc: 78.3672, stage1_neg_loss: 0.0615, stage1_mean_ious: 0.4014, stage1_s: 0.0000, stage1_m: 0.1000, stage1_l: 0.2594, stage1_h: 0.4154, loss: 0.6384, grad_norm: 9.7710
2024-04-19 21:16:18,879 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-19 21:24:27,335 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 4:08:10, time: 9.205, data_time: 0.913, memory: 17810, stage0_loss_instance_mil: 0.0930, stage0_bag_acc: 95.0021, stage0_mean_ious: 0.4204, stage0_s: 0.0000, stage0_m: 0.0511, stage0_l: 0.2258, stage0_h: 0.4420, stage1_loss_instance_mil: 0.2920, stage1_bag_acc: 96.7669, stage1_neg_loss: 0.0756, stage1_mean_ious: 0.4180, stage1_s: 0.0000, stage1_m: 0.0555, stage1_l: 0.2469, stage1_h: 0.4361, loss: 0.4606, grad_norm: 12.9093
2024-04-19 21:33:49,490 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 4:21:29, time: 11.245, data_time: 0.992, memory: 17810, stage0_loss_instance_mil: 0.0530, stage0_bag_acc: 96.8858, stage0_mean_ious: 0.4178, stage0_s: 0.0000, stage0_m: 0.0419, stage0_l: 0.1786, stage0_h: 0.4524, stage1_loss_instance_mil: 0.2585, stage1_bag_acc: 98.8556, stage1_neg_loss: 0.0813, stage1_mean_ious: 0.4045, stage1_s: 0.0000, stage1_m: 0.0435, stage1_l: 0.1899, stage1_h: 0.4354, loss: 0.3927, grad_norm: 13.1567
2024-04-19 21:38:12,034 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 4:00:13, time: 5.250, data_time: 0.551, memory: 17810, stage0_loss_instance_mil: 0.0518, stage0_bag_acc: 96.5732, stage0_mean_ious: 0.4415, stage0_s: 0.0000, stage0_m: 0.0468, stage0_l: 0.1821, stage0_h: 0.4763, stage1_loss_instance_mil: 0.2576, stage1_bag_acc: 98.0795, stage1_neg_loss: 0.0959, stage1_mean_ious: 0.4273, stage1_s: 0.0000, stage1_m: 0.0505, stage1_l: 0.1860, stage1_h: 0.4560, loss: 0.4054, grad_norm: 18.9407
2024-04-19 21:39:11,741 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-19 21:46:50,848 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 3:35:42, time: 8.662, data_time: 1.087, memory: 17810, stage0_loss_instance_mil: 0.0336, stage0_bag_acc: 98.4876, stage0_mean_ious: 0.4455, stage0_s: 0.0000, stage0_m: 0.0509, stage0_l: 0.1553, stage0_h: 0.4851, stage1_loss_instance_mil: 0.2243, stage1_bag_acc: 98.7098, stage1_neg_loss: 0.0774, stage1_mean_ious: 0.4188, stage1_s: 0.0000, stage1_m: 0.0572, stage1_l: 0.1631, stage1_h: 0.4526, loss: 0.3354, grad_norm: 15.3808
2024-04-19 21:53:00,761 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 3:29:33, time: 7.399, data_time: 0.830, memory: 17810, stage0_loss_instance_mil: 0.0307, stage0_bag_acc: 98.4602, stage0_mean_ious: 0.4504, stage0_s: 0.0000, stage0_m: 0.0555, stage0_l: 0.2046, stage0_h: 0.4908, stage1_loss_instance_mil: 0.1750, stage1_bag_acc: 99.1332, stage1_neg_loss: 0.0789, stage1_mean_ious: 0.4396, stage1_s: 0.0000, stage1_m: 0.0575, stage1_l: 0.2160, stage1_h: 0.4757, loss: 0.2845, grad_norm: 13.8629
2024-04-19 21:56:12,311 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 3:13:47, time: 3.831, data_time: 0.282, memory: 17810, stage0_loss_instance_mil: 0.0379, stage0_bag_acc: 97.5712, stage0_mean_ious: 0.4652, stage0_s: 0.0012, stage0_m: 0.0723, stage0_l: 0.2069, stage0_h: 0.5011, stage1_loss_instance_mil: 0.1645, stage1_bag_acc: 98.5402, stage1_neg_loss: 0.0573, stage1_mean_ious: 0.4539, stage1_s: 0.0013, stage1_m: 0.0761, stage1_l: 0.2275, stage1_h: 0.4863, loss: 0.2597, grad_norm: 10.8974
2024-04-19 21:57:52,153 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-19 22:00:31,326 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 2:46:18, time: 3.122, data_time: 0.257, memory: 17810, stage0_loss_instance_mil: 0.0244, stage0_bag_acc: 98.7594, stage0_mean_ious: 0.4513, stage0_s: 0.0000, stage0_m: 0.0432, stage0_l: 0.1948, stage0_h: 0.4836, stage1_loss_instance_mil: 0.1483, stage1_bag_acc: 98.9083, stage1_neg_loss: 0.0546, stage1_mean_ious: 0.4328, stage1_s: 0.0000, stage1_m: 0.0424, stage1_l: 0.2058, stage1_h: 0.4609, loss: 0.2273, grad_norm: 12.4066
2024-04-19 22:04:37,521 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 2:38:10, time: 4.923, data_time: 0.451, memory: 17810, stage0_loss_instance_mil: 0.0159, stage0_bag_acc: 99.3933, stage0_mean_ious: 0.5074, stage0_s: 0.0000, stage0_m: 0.0438, stage0_l: 0.2200, stage0_h: 0.5393, stage1_loss_instance_mil: 0.1326, stage1_bag_acc: 99.4685, stage1_neg_loss: 0.0596, stage1_mean_ious: 0.4881, stage1_s: 0.0000, stage1_m: 0.0424, stage1_l: 0.2281, stage1_h: 0.5153, loss: 0.2081, grad_norm: 10.5297
2024-04-19 22:08:10,573 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 2:29:27, time: 4.262, data_time: 0.316, memory: 17810, stage0_loss_instance_mil: 0.0296, stage0_bag_acc: 98.1277, stage0_mean_ious: 0.5117, stage0_s: 0.0000, stage0_m: 0.0595, stage0_l: 0.2510, stage0_h: 0.5597, stage1_loss_instance_mil: 0.1357, stage1_bag_acc: 98.5212, stage1_neg_loss: 0.0495, stage1_mean_ious: 0.4989, stage1_s: 0.0000, stage1_m: 0.0673, stage1_l: 0.2700, stage1_h: 0.5392, loss: 0.2149, grad_norm: 10.1018
2024-04-19 22:09:51,689 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-19 22:12:10,311 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 2:10:43, time: 2.711, data_time: 0.265, memory: 17810, stage0_loss_instance_mil: 0.0125, stage0_bag_acc: 98.9888, stage0_mean_ious: 0.5614, stage0_s: 0.0000, stage0_m: 0.0570, stage0_l: 0.1942, stage0_h: 0.6044, stage1_loss_instance_mil: 0.1034, stage1_bag_acc: 99.5208, stage1_neg_loss: 0.0421, stage1_mean_ious: 0.5223, stage1_s: 0.0000, stage1_m: 0.0621, stage1_l: 0.1972, stage1_h: 0.5576, loss: 0.1580, grad_norm: 7.8794
2024-04-19 22:17:05,933 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 2:06:22, time: 5.913, data_time: 0.490, memory: 17810, stage0_loss_instance_mil: 0.0302, stage0_bag_acc: 98.3623, stage0_mean_ious: 0.5411, stage0_s: 0.0000, stage0_m: 0.0617, stage0_l: 0.2381, stage0_h: 0.5880, stage1_loss_instance_mil: 0.1152, stage1_bag_acc: 98.5542, stage1_neg_loss: 0.0453, stage1_mean_ious: 0.5194, stage1_s: 0.0000, stage1_m: 0.0778, stage1_l: 0.2452, stage1_h: 0.5590, loss: 0.1908, grad_norm: 9.8654
2024-04-19 22:21:26,411 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 2:01:06, time: 5.210, data_time: 0.447, memory: 17810, stage0_loss_instance_mil: 0.0183, stage0_bag_acc: 99.2255, stage0_mean_ious: 0.5561, stage0_s: 0.0000, stage0_m: 0.0407, stage0_l: 0.2462, stage0_h: 0.5901, stage1_loss_instance_mil: 0.1032, stage1_bag_acc: 99.1644, stage1_neg_loss: 0.0382, stage1_mean_ious: 0.5375, stage1_s: 0.0000, stage1_m: 0.0469, stage1_l: 0.2735, stage1_h: 0.5647, loss: 0.1597, grad_norm: 7.5572
2024-04-19 22:22:32,439 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-19 22:25:58,898 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 1:48:21, time: 4.067, data_time: 0.379, memory: 17810, stage0_loss_instance_mil: 0.0105, stage0_bag_acc: 99.6836, stage0_mean_ious: 0.5539, stage0_s: 0.0000, stage0_m: 0.0602, stage0_l: 0.2323, stage0_h: 0.6009, stage1_loss_instance_mil: 0.0900, stage1_bag_acc: 99.4408, stage1_neg_loss: 0.0390, stage1_mean_ious: 0.5288, stage1_s: 0.0000, stage1_m: 0.0625, stage1_l: 0.2523, stage1_h: 0.5665, loss: 0.1395, grad_norm: 7.3047
2024-04-19 22:30:28,370 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 22:30:28,455 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 1:43:53, time: 5.389, data_time: 0.461, memory: 17810, stage0_loss_instance_mil: 0.0083, stage0_bag_acc: 99.6895, stage0_mean_ious: 0.5627, stage0_s: 0.0000, stage0_m: 0.0438, stage0_l: 0.2197, stage0_h: 0.5952, stage1_loss_instance_mil: 0.0878, stage1_bag_acc: 99.3718, stage1_neg_loss: 0.0371, stage1_mean_ious: 0.5408, stage1_s: 0.0000, stage1_m: 0.0548, stage1_l: 0.2586, stage1_h: 0.5654, loss: 0.1332, grad_norm: 8.5400
2024-04-19 22:33:58,877 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 1:38:23, time: 4.210, data_time: 0.373, memory: 17810, stage0_loss_instance_mil: 0.0202, stage0_bag_acc: 98.7427, stage0_mean_ious: 0.5549, stage0_s: 0.0000, stage0_m: 0.0791, stage0_l: 0.2261, stage0_h: 0.5890, stage1_loss_instance_mil: 0.1098, stage1_bag_acc: 98.8362, stage1_neg_loss: 0.0527, stage1_mean_ious: 0.5324, stage1_s: 0.0000, stage1_m: 0.0848, stage1_l: 0.2395, stage1_h: 0.5617, loss: 0.1827, grad_norm: 10.5435
2024-04-19 22:34:50,206 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-19 22:46:32,366 - mmdet - INFO - Evaluating bbox...
2024-04-19 22:46:34,316 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1934
2024-04-19 22:46:34,316 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4140
2024-04-19 22:46:34,316 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3145
2024-04-19 22:46:34,316 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2081
2024-04-19 22:46:34,317 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1646
2024-04-19 22:46:34,317 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1148
2024-04-19 22:46:34,317 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0261
2024-04-19 22:46:34,317 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2225
2024-04-19 22:46:34,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1778
2024-04-19 22:46:34,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2755
2024-04-19 22:46:34,318 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2867
2024-04-19 22:46:34,318 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2867
2024-04-19 22:46:34,318 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2867
2024-04-19 22:46:34,318 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2557
2024-04-19 22:46:34,318 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2493
2024-04-19 22:46:34,319 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3641
2024-04-19 22:46:34,360 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-19 22:46:34,360 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.1930, bbox_mAP_50: 0.4140, bbox_mAP_75: 0.3140, bbox_mAP_s: 0.2080, bbox_mAP_m: 0.1650, bbox_mAP_l: 0.1150, bbox_mAP_copypaste: 0.193 0.414 0.314 0.208 0.165 0.115
2024-04-19 22:49:43,797 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 1:27:42, time: 3.787, data_time: 0.318, memory: 17810, stage0_loss_instance_mil: 0.0104, stage0_bag_acc: 99.1129, stage0_mean_ious: 0.5125, stage0_s: 0.0000, stage0_m: 0.0883, stage0_l: 0.2186, stage0_h: 0.5637, stage1_loss_instance_mil: 0.1029, stage1_bag_acc: 99.3427, stage1_neg_loss: 0.0427, stage1_mean_ious: 0.4913, stage1_s: 0.0000, stage1_m: 0.0987, stage1_l: 0.2390, stage1_h: 0.5333, loss: 0.1559, grad_norm: 8.5546
2024-04-19 22:53:52,204 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 1:23:21, time: 4.968, data_time: 0.440, memory: 17810, stage0_loss_instance_mil: 0.0210, stage0_bag_acc: 98.7403, stage0_mean_ious: 0.5167, stage0_s: 0.0000, stage0_m: 0.0730, stage0_l: 0.2597, stage0_h: 0.5561, stage1_loss_instance_mil: 0.0951, stage1_bag_acc: 99.1242, stage1_neg_loss: 0.0425, stage1_mean_ious: 0.4964, stage1_s: 0.0000, stage1_m: 0.0801, stage1_l: 0.2822, stage1_h: 0.5278, loss: 0.1586, grad_norm: 8.3578
2024-04-19 22:57:52,013 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 1:18:54, time: 4.796, data_time: 0.388, memory: 17810, stage0_loss_instance_mil: 0.0097, stage0_bag_acc: 99.5745, stage0_mean_ious: 0.5576, stage0_s: 0.0000, stage0_m: 0.0646, stage0_l: 0.2428, stage0_h: 0.6023, stage1_loss_instance_mil: 0.0897, stage1_bag_acc: 99.7836, stage1_neg_loss: 0.0355, stage1_mean_ious: 0.5364, stage1_s: 0.0000, stage1_m: 0.0756, stage1_l: 0.2567, stage1_h: 0.5720, loss: 0.1348, grad_norm: 8.1029
2024-04-19 22:58:56,323 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-19 23:02:04,944 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 1:09:43, time: 3.717, data_time: 0.308, memory: 17810, stage0_loss_instance_mil: 0.0042, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5314, stage0_s: 0.0012, stage0_m: 0.0523, stage0_l: 0.2665, stage0_h: 0.5658, stage1_loss_instance_mil: 0.0833, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0360, stage1_mean_ious: 0.5118, stage1_s: 0.0016, stage1_m: 0.0561, stage1_l: 0.2846, stage1_h: 0.5415, loss: 0.1234, grad_norm: 6.6172
2024-04-19 23:06:09,350 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 1:05:36, time: 4.889, data_time: 0.492, memory: 17810, stage0_loss_instance_mil: 0.0090, stage0_bag_acc: 99.5936, stage0_mean_ious: 0.5522, stage0_s: 0.0000, stage0_m: 0.0519, stage0_l: 0.2206, stage0_h: 0.5859, stage1_loss_instance_mil: 0.0899, stage1_bag_acc: 99.5573, stage1_neg_loss: 0.0367, stage1_mean_ious: 0.5285, stage1_s: 0.0000, stage1_m: 0.0587, stage1_l: 0.2219, stage1_h: 0.5570, loss: 0.1356, grad_norm: 6.5767
2024-04-19 23:10:11,643 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 1:01:28, time: 4.846, data_time: 0.510, memory: 17810, stage0_loss_instance_mil: 0.0031, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5762, stage0_s: 0.0000, stage0_m: 0.0289, stage0_l: 0.2705, stage0_h: 0.6111, stage1_loss_instance_mil: 0.0844, stage1_bag_acc: 99.7273, stage1_neg_loss: 0.0388, stage1_mean_ious: 0.5537, stage1_s: 0.0000, stage1_m: 0.0324, stage1_l: 0.2899, stage1_h: 0.5814, loss: 0.1263, grad_norm: 7.6185
2024-04-19 23:11:57,713 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-19 23:14:36,595 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:53:08, time: 3.114, data_time: 0.268, memory: 17810, stage0_loss_instance_mil: 0.0096, stage0_bag_acc: 99.3805, stage0_mean_ious: 0.5695, stage0_s: 0.0000, stage0_m: 0.0357, stage0_l: 0.2882, stage0_h: 0.5981, stage1_loss_instance_mil: 0.0676, stage1_bag_acc: 99.4769, stage1_neg_loss: 0.0281, stage1_mean_ious: 0.5488, stage1_s: 0.0000, stage1_m: 0.0338, stage1_l: 0.3026, stage1_h: 0.5718, loss: 0.1053, grad_norm: 4.5834
2024-04-19 23:18:55,697 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:49:18, time: 5.183, data_time: 0.473, memory: 17810, stage0_loss_instance_mil: 0.0034, stage0_bag_acc: 99.9167, stage0_mean_ious: 0.5713, stage0_s: 0.0000, stage0_m: 0.0485, stage0_l: 0.2839, stage0_h: 0.6095, stage1_loss_instance_mil: 0.0551, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0326, stage1_mean_ious: 0.5459, stage1_s: 0.0000, stage1_m: 0.0454, stage1_l: 0.3092, stage1_h: 0.5761, loss: 0.0911, grad_norm: 5.4075
2024-04-19 23:22:44,568 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:45:16, time: 4.576, data_time: 0.354, memory: 17810, stage0_loss_instance_mil: 0.0056, stage0_bag_acc: 99.8000, stage0_mean_ious: 0.5679, stage0_s: 0.0000, stage0_m: 0.0609, stage0_l: 0.2596, stage0_h: 0.6023, stage1_loss_instance_mil: 0.0638, stage1_bag_acc: 99.9000, stage1_neg_loss: 0.0302, stage1_mean_ious: 0.5413, stage1_s: 0.0000, stage1_m: 0.0589, stage1_l: 0.2674, stage1_h: 0.5696, loss: 0.0996, grad_norm: 4.8398
2024-04-19 23:24:14,533 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-19 23:27:23,200 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:37:57, time: 3.712, data_time: 0.341, memory: 17810, stage0_loss_instance_mil: 0.0067, stage0_bag_acc: 99.6645, stage0_mean_ious: 0.5573, stage0_s: 0.0000, stage0_m: 0.0324, stage0_l: 0.3122, stage0_h: 0.5841, stage1_loss_instance_mil: 0.0577, stage1_bag_acc: 99.7895, stage1_neg_loss: 0.0306, stage1_mean_ious: 0.5406, stage1_s: 0.0000, stage1_m: 0.0392, stage1_l: 0.3509, stage1_h: 0.5594, loss: 0.0950, grad_norm: 5.3137
2024-04-19 23:31:15,897 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:34:05, time: 4.653, data_time: 0.413, memory: 17810, stage0_loss_instance_mil: 0.0050, stage0_bag_acc: 99.7747, stage0_mean_ious: 0.5773, stage0_s: 0.0000, stage0_m: 0.0675, stage0_l: 0.2860, stage0_h: 0.6133, stage1_loss_instance_mil: 0.0644, stage1_bag_acc: 99.9286, stage1_neg_loss: 0.0278, stage1_mean_ious: 0.5419, stage1_s: 0.0000, stage1_m: 0.0744, stage1_l: 0.3053, stage1_h: 0.5678, loss: 0.0971, grad_norm: 4.3521
2024-04-19 23:34:41,703 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:30:07, time: 4.115, data_time: 0.280, memory: 17810, stage0_loss_instance_mil: 0.0019, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5745, stage0_s: 0.0000, stage0_m: 0.0541, stage0_l: 0.3171, stage0_h: 0.6064, stage1_loss_instance_mil: 0.0502, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0281, stage1_mean_ious: 0.5448, stage1_s: 0.0000, stage1_m: 0.0532, stage1_l: 0.3343, stage1_h: 0.5701, loss: 0.0802, grad_norm: 3.9123
2024-04-19 23:36:03,014 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-19 23:38:43,893 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:23:20, time: 3.156, data_time: 0.282, memory: 17810, stage0_loss_instance_mil: 0.0027, stage0_bag_acc: 99.8024, stage0_mean_ious: 0.5676, stage0_s: 0.0000, stage0_m: 0.0564, stage0_l: 0.2982, stage0_h: 0.6103, stage1_loss_instance_mil: 0.0529, stage1_bag_acc: 99.8024, stage1_neg_loss: 0.0262, stage1_mean_ious: 0.5421, stage1_s: 0.0000, stage1_m: 0.0629, stage1_l: 0.3227, stage1_h: 0.5761, loss: 0.0817, grad_norm: 4.7787
2024-04-19 23:43:32,768 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:19:43, time: 5.778, data_time: 0.548, memory: 17810, stage0_loss_instance_mil: 0.0016, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5720, stage0_s: 0.0000, stage0_m: 0.0537, stage0_l: 0.2759, stage0_h: 0.6004, stage1_loss_instance_mil: 0.0554, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0271, stage1_mean_ious: 0.5470, stage1_s: 0.0000, stage1_m: 0.0581, stage1_l: 0.2839, stage1_h: 0.5696, loss: 0.0841, grad_norm: 4.8256
2024-04-19 23:47:43,601 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:15:58, time: 5.017, data_time: 0.392, memory: 17810, stage0_loss_instance_mil: 0.0021, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.5540, stage0_s: 0.0000, stage0_m: 0.1062, stage0_l: 0.2831, stage0_h: 0.5933, stage1_loss_instance_mil: 0.0485, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0250, stage1_mean_ious: 0.5246, stage1_s: 0.0000, stage1_m: 0.1147, stage1_l: 0.2879, stage1_h: 0.5571, loss: 0.0756, grad_norm: 3.9666
2024-04-19 23:48:37,467 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-19 23:52:19,706 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:09:43, time: 4.393, data_time: 0.543, memory: 17810, stage0_loss_instance_mil: 0.0014, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5716, stage0_s: 0.0000, stage0_m: 0.0616, stage0_l: 0.2753, stage0_h: 0.6076, stage1_loss_instance_mil: 0.0509, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0270, stage1_mean_ious: 0.5429, stage1_s: 0.0000, stage1_m: 0.0653, stage1_l: 0.2968, stage1_h: 0.5722, loss: 0.0793, grad_norm: 4.2059
2024-04-19 23:56:00,009 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:05:59, time: 4.405, data_time: 0.385, memory: 17810, stage0_loss_instance_mil: 0.0011, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5707, stage0_s: 0.0000, stage0_m: 0.0550, stage0_l: 0.2844, stage0_h: 0.6067, stage1_loss_instance_mil: 0.0531, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0253, stage1_mean_ious: 0.5475, stage1_s: 0.0000, stage1_m: 0.0690, stage1_l: 0.2990, stage1_h: 0.5770, loss: 0.0795, grad_norm: 4.2178
2024-04-19 23:59:41,975 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:02:14, time: 4.440, data_time: 0.350, memory: 17810, stage0_loss_instance_mil: 0.0044, stage0_bag_acc: 99.9130, stage0_mean_ious: 0.5630, stage0_s: 0.0000, stage0_m: 0.0810, stage0_l: 0.3005, stage0_h: 0.6046, stage1_loss_instance_mil: 0.0486, stage1_bag_acc: 99.9130, stage1_neg_loss: 0.0294, stage1_mean_ious: 0.5497, stage1_s: 0.0000, stage1_m: 0.0889, stage1_l: 0.3197, stage1_h: 0.5836, loss: 0.0823, grad_norm: 4.7816
2024-04-20 00:00:35,377 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-20 00:12:02,166 - mmdet - INFO - Evaluating bbox...
2024-04-20 00:12:04,011 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2299
2024-04-20 00:12:04,012 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4890
2024-04-20 00:12:04,012 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3884
2024-04-20 00:12:04,013 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2554
2024-04-20 00:12:04,013 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1834
2024-04-20 00:12:04,013 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1099
2024-04-20 00:12:04,013 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0320
2024-04-20 00:12:04,013 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2132
2024-04-20 00:12:04,014 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2195
2024-04-20 00:12:04,014 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3075
2024-04-20 00:12:04,014 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3251
2024-04-20 00:12:04,014 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3251
2024-04-20 00:12:04,014 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3251
2024-04-20 00:12:04,015 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2486
2024-04-20 00:12:04,015 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2944
2024-04-20 00:12:04,015 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3865
2024-04-20 00:12:04,059 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 00:12:04,060 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.2300, bbox_mAP_50: 0.4890, bbox_mAP_75: 0.3880, bbox_mAP_s: 0.2550, bbox_mAP_m: 0.1830, bbox_mAP_l: 0.1100, bbox_mAP_copypaste: 0.230 0.489 0.388 0.255 0.183 0.110
2024-04-20 00:23:19,941 - mmdet - INFO - Evaluating bbox...
2024-04-20 00:23:38,991 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2299
2024-04-20 00:23:38,992 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4890
2024-04-20 00:23:38,992 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3884
2024-04-20 00:23:38,993 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2554
2024-04-20 00:23:38,999 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.1834
2024-04-20 00:23:39,015 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1099
2024-04-20 00:23:39,016 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0320
2024-04-20 00:23:39,016 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2132
2024-04-20 00:23:39,016 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2195
2024-04-20 00:23:39,017 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3075
2024-04-20 00:23:39,017 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3251
2024-04-20 00:23:39,017 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3251
2024-04-20 00:23:39,018 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3251
2024-04-20 00:23:39,023 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2486
2024-04-20 00:23:39,023 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2944
2024-04-20 00:23:39,024 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3865
2024-04-20 00:23:48,055 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-20 00:23:52,237 - mmdet - INFO - Distributed training: False
2024-04-20 00:23:54,345 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-20 00:23:56,976 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-20 00:23:56,976 - mmdet - INFO - Use load_from_local loader
2024-04-20 00:23:57,364 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-20 00:23:57,395 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-20 00:23:57,395 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-20 00:26:20,366 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 1:40:33, time: 2.859, data_time: 0.224, memory: 17810, stage0_loss_instance_mil: 0.7206, stage0_bag_acc: 11.9129, stage0_mean_ious: 0.3806, stage0_s: 0.0000, stage0_m: 0.0382, stage0_l: 0.1996, stage0_h: 0.4022, stage1_loss_instance_mil: 0.1642, stage1_bag_acc: 16.8609, stage1_neg_loss: 0.0013, stage1_mean_ious: 0.3792, stage1_s: 0.0000, stage1_m: 0.0381, stage1_l: 0.2118, stage1_h: 0.3994, loss: 0.8862, grad_norm: 3.1880
2024-04-20 00:30:23,965 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 2:12:41, time: 4.871, data_time: 0.375, memory: 17810, stage0_loss_instance_mil: 0.5891, stage0_bag_acc: 67.3622, stage0_mean_ious: 0.3943, stage0_s: 0.0000, stage0_m: 0.0366, stage0_l: 0.1944, stage0_h: 0.4157, stage1_loss_instance_mil: 0.2446, stage1_bag_acc: 27.7259, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.3836, stage1_s: 0.0000, stage1_m: 0.0323, stage1_l: 0.1961, stage1_h: 0.4023, loss: 0.8373, grad_norm: 3.7348
2024-04-20 00:34:33,062 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 2:21:57, time: 4.983, data_time: 0.407, memory: 17810, stage0_loss_instance_mil: 0.2369, stage0_bag_acc: 92.4938, stage0_mean_ious: 0.3957, stage0_s: 0.0000, stage0_m: 0.0333, stage0_l: 0.1813, stage0_h: 0.4287, stage1_loss_instance_mil: 0.3669, stage1_bag_acc: 85.1615, stage1_neg_loss: 0.0662, stage1_mean_ious: 0.3879, stage1_s: 0.0000, stage1_m: 0.0269, stage1_l: 0.1804, stage1_h: 0.4204, loss: 0.6699, grad_norm: 10.4227
2024-04-20 00:36:07,947 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-20 00:39:10,117 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 1:53:56, time: 3.582, data_time: 0.293, memory: 17810, stage0_loss_instance_mil: 0.0852, stage0_bag_acc: 96.5196, stage0_mean_ious: 0.3657, stage0_s: 0.0000, stage0_m: 0.0405, stage0_l: 0.1601, stage0_h: 0.3886, stage1_loss_instance_mil: 0.3694, stage1_bag_acc: 96.9885, stage1_neg_loss: 0.0854, stage1_mean_ious: 0.3603, stage1_s: 0.0000, stage1_m: 0.0340, stage1_l: 0.1556, stage1_h: 0.3828, loss: 0.5400, grad_norm: 14.1675
2024-04-20 00:43:03,105 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 1:57:14, time: 4.660, data_time: 0.449, memory: 17810, stage0_loss_instance_mil: 0.0592, stage0_bag_acc: 96.7921, stage0_mean_ious: 0.3932, stage0_s: 0.0000, stage0_m: 0.0415, stage0_l: 0.1605, stage0_h: 0.4227, stage1_loss_instance_mil: 0.3453, stage1_bag_acc: 97.9610, stage1_neg_loss: 0.1060, stage1_mean_ious: 0.3706, stage1_s: 0.0000, stage1_m: 0.0365, stage1_l: 0.1543, stage1_h: 0.3991, loss: 0.5105, grad_norm: 16.9672
2024-04-20 00:46:42,668 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 1:57:07, time: 4.391, data_time: 0.357, memory: 17810, stage0_loss_instance_mil: 0.0854, stage0_bag_acc: 94.2914, stage0_mean_ious: 0.3573, stage0_s: 0.0000, stage0_m: 0.0494, stage0_l: 0.1481, stage0_h: 0.3834, stage1_loss_instance_mil: 0.3508, stage1_bag_acc: 95.7447, stage1_neg_loss: 0.0833, stage1_mean_ious: 0.3335, stage1_s: 0.0002, stage1_m: 0.0378, stage1_l: 0.1419, stage1_h: 0.3584, loss: 0.5195, grad_norm: 16.1926
2024-04-20 00:48:18,126 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-20 00:51:33,367 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 1:43:51, time: 3.852, data_time: 0.355, memory: 17810, stage0_loss_instance_mil: 0.0293, stage0_bag_acc: 98.3571, stage0_mean_ious: 0.3422, stage0_s: 0.0000, stage0_m: 0.0382, stage0_l: 0.1348, stage0_h: 0.3736, stage1_loss_instance_mil: 0.2836, stage1_bag_acc: 98.8209, stage1_neg_loss: 0.0868, stage1_mean_ious: 0.3092, stage1_s: 0.0000, stage1_m: 0.0300, stage1_l: 0.1152, stage1_h: 0.3394, loss: 0.3997, grad_norm: 12.8045
2024-04-20 00:55:31,527 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 1:44:35, time: 4.762, data_time: 0.398, memory: 17810, stage0_loss_instance_mil: 0.0338, stage0_bag_acc: 98.3697, stage0_mean_ious: 0.3351, stage0_s: 0.0000, stage0_m: 0.0365, stage0_l: 0.1041, stage0_h: 0.3570, stage1_loss_instance_mil: 0.2849, stage1_bag_acc: 98.7414, stage1_neg_loss: 0.0899, stage1_mean_ious: 0.2942, stage1_s: 0.0000, stage1_m: 0.0325, stage1_l: 0.0917, stage1_h: 0.3137, loss: 0.4086, grad_norm: 13.9559
2024-04-20 00:59:13,473 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 1:43:31, time: 4.439, data_time: 0.339, memory: 17810, stage0_loss_instance_mil: 0.0290, stage0_bag_acc: 98.4108, stage0_mean_ious: 0.3392, stage0_s: 0.0000, stage0_m: 0.0251, stage0_l: 0.1234, stage0_h: 0.3698, stage1_loss_instance_mil: 0.2751, stage1_bag_acc: 98.4375, stage1_neg_loss: 0.0857, stage1_mean_ious: 0.3013, stage1_s: 0.0000, stage1_m: 0.0216, stage1_l: 0.1115, stage1_h: 0.3297, loss: 0.3898, grad_norm: 13.5710
2024-04-20 01:00:15,863 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-20 01:03:36,487 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 1:33:56, time: 3.961, data_time: 0.302, memory: 17810, stage0_loss_instance_mil: 0.0177, stage0_bag_acc: 98.9348, stage0_mean_ious: 0.3513, stage0_s: 0.0014, stage0_m: 0.0178, stage0_l: 0.1038, stage0_h: 0.3839, stage1_loss_instance_mil: 0.2694, stage1_bag_acc: 99.2119, stage1_neg_loss: 0.0808, stage1_mean_ious: 0.3114, stage1_s: 0.0014, stage1_m: 0.0158, stage1_l: 0.0850, stage1_h: 0.3417, loss: 0.3679, grad_norm: 11.3942
2024-04-20 01:07:26,151 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 1:32:55, time: 4.592, data_time: 0.415, memory: 17810, stage0_loss_instance_mil: 0.0260, stage0_bag_acc: 98.6132, stage0_mean_ious: 0.3700, stage0_s: 0.0000, stage0_m: 0.0113, stage0_l: 0.1238, stage0_h: 0.3994, stage1_loss_instance_mil: 0.2441, stage1_bag_acc: 99.0187, stage1_neg_loss: 0.0907, stage1_mean_ious: 0.3315, stage1_s: 0.0000, stage1_m: 0.0080, stage1_l: 0.0935, stage1_h: 0.3605, loss: 0.3608, grad_norm: 15.6193
2024-04-20 01:11:15,208 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 1:31:29, time: 4.581, data_time: 0.408, memory: 17810, stage0_loss_instance_mil: 0.0413, stage0_bag_acc: 96.8736, stage0_mean_ious: 0.3502, stage0_s: 0.0000, stage0_m: 0.0453, stage0_l: 0.1169, stage0_h: 0.3823, stage1_loss_instance_mil: 0.2320, stage1_bag_acc: 98.2227, stage1_neg_loss: 0.0765, stage1_mean_ious: 0.3048, stage1_s: 0.0000, stage1_m: 0.0316, stage1_l: 0.0915, stage1_h: 0.3358, loss: 0.3498, grad_norm: 11.9406
2024-04-20 01:12:25,740 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-20 01:15:58,017 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 1:23:48, time: 4.182, data_time: 0.404, memory: 17810, stage0_loss_instance_mil: 0.0187, stage0_bag_acc: 98.9782, stage0_mean_ious: 0.3951, stage0_s: 0.0013, stage0_m: 0.0265, stage0_l: 0.1111, stage0_h: 0.4291, stage1_loss_instance_mil: 0.2130, stage1_bag_acc: 99.3648, stage1_neg_loss: 0.0746, stage1_mean_ious: 0.3500, stage1_s: 0.0016, stage1_m: 0.0153, stage1_l: 0.0867, stage1_h: 0.3830, loss: 0.3063, grad_norm: 12.6490
2024-04-20 01:19:54,299 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 1:22:18, time: 4.726, data_time: 0.368, memory: 17810, stage0_loss_instance_mil: 0.0198, stage0_bag_acc: 99.0669, stage0_mean_ious: 0.3808, stage0_s: 0.0000, stage0_m: 0.0306, stage0_l: 0.1042, stage0_h: 0.4237, stage1_loss_instance_mil: 0.2171, stage1_bag_acc: 98.5287, stage1_neg_loss: 0.0793, stage1_mean_ious: 0.3335, stage1_s: 0.0000, stage1_m: 0.0251, stage1_l: 0.0835, stage1_h: 0.3727, loss: 0.3161, grad_norm: 13.0148
2024-04-20 01:23:11,553 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 1:19:33, time: 3.944, data_time: 0.397, memory: 17810, stage0_loss_instance_mil: 0.0171, stage0_bag_acc: 99.1005, stage0_mean_ious: 0.3985, stage0_s: 0.0000, stage0_m: 0.0215, stage0_l: 0.1031, stage0_h: 0.4383, stage1_loss_instance_mil: 0.1885, stage1_bag_acc: 99.1993, stage1_neg_loss: 0.0741, stage1_mean_ious: 0.3560, stage1_s: 0.0000, stage1_m: 0.0133, stage1_l: 0.0862, stage1_h: 0.3946, loss: 0.2796, grad_norm: 11.0775
2024-04-20 01:24:24,293 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-20 01:27:44,530 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 1:12:31, time: 3.943, data_time: 0.355, memory: 17810, stage0_loss_instance_mil: 0.0153, stage0_bag_acc: 99.0246, stage0_mean_ious: 0.3657, stage0_s: 0.0000, stage0_m: 0.0272, stage0_l: 0.1201, stage0_h: 0.4043, stage1_loss_instance_mil: 0.1743, stage1_bag_acc: 99.5993, stage1_neg_loss: 0.0716, stage1_mean_ious: 0.3252, stage1_s: 0.0000, stage1_m: 0.0182, stage1_l: 0.0905, stage1_h: 0.3628, loss: 0.2613, grad_norm: 10.0513
2024-04-20 01:31:40,780 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 01:31:40,781 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 1:10:37, time: 4.725, data_time: 0.343, memory: 17810, stage0_loss_instance_mil: 0.0098, stage0_bag_acc: 99.5018, stage0_mean_ious: 0.3762, stage0_s: 0.0000, stage0_m: 0.0338, stage0_l: 0.1017, stage0_h: 0.4125, stage1_loss_instance_mil: 0.1600, stage1_bag_acc: 99.6313, stage1_neg_loss: 0.0586, stage1_mean_ious: 0.3392, stage1_s: 0.0000, stage1_m: 0.0261, stage1_l: 0.0825, stage1_h: 0.3738, loss: 0.2284, grad_norm: 8.3532
2024-04-20 01:35:08,635 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 1:08:01, time: 4.158, data_time: 0.335, memory: 17810, stage0_loss_instance_mil: 0.0103, stage0_bag_acc: 99.2433, stage0_mean_ious: 0.3852, stage0_s: 0.0000, stage0_m: 0.0377, stage0_l: 0.1114, stage0_h: 0.4262, stage1_loss_instance_mil: 0.1831, stage1_bag_acc: 99.3734, stage1_neg_loss: 0.0664, stage1_mean_ious: 0.3435, stage1_s: 0.0000, stage1_m: 0.0258, stage1_l: 0.0945, stage1_h: 0.3829, loss: 0.2598, grad_norm: 11.2948
2024-04-20 01:36:22,450 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-20 01:47:58,424 - mmdet - INFO - Evaluating bbox...
2024-04-20 01:48:00,341 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0679
2024-04-20 01:48:00,341 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2183
2024-04-20 01:48:00,342 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1284
2024-04-20 01:48:00,342 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0445
2024-04-20 01:48:00,342 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0222
2024-04-20 01:48:00,342 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0084
2024-04-20 01:48:00,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0018
2024-04-20 01:48:00,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0025
2024-04-20 01:48:00,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0727
2024-04-20 01:48:00,343 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1041
2024-04-20 01:48:00,343 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1224
2024-04-20 01:48:00,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1224
2024-04-20 01:48:00,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1224
2024-04-20 01:48:00,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0123
2024-04-20 01:48:00,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1504
2024-04-20 01:48:00,344 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1292
2024-04-20 01:48:00,387 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 01:48:00,387 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0680, bbox_mAP_50: 0.2180, bbox_mAP_75: 0.1280, bbox_mAP_s: 0.0450, bbox_mAP_m: 0.0220, bbox_mAP_l: 0.0080, bbox_mAP_copypaste: 0.068 0.218 0.128 0.045 0.022 0.008
2024-04-20 01:50:24,892 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 1:00:50, time: 2.889, data_time: 0.216, memory: 17810, stage0_loss_instance_mil: 0.0181, stage0_bag_acc: 99.2235, stage0_mean_ious: 0.3915, stage0_s: 0.0000, stage0_m: 0.0341, stage0_l: 0.0942, stage0_h: 0.4237, stage1_loss_instance_mil: 0.1515, stage1_bag_acc: 99.3015, stage1_neg_loss: 0.0605, stage1_mean_ious: 0.3479, stage1_s: 0.0000, stage1_m: 0.0266, stage1_l: 0.0764, stage1_h: 0.3778, loss: 0.2301, grad_norm: 8.3292
2024-04-20 01:54:10,854 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:58:33, time: 4.519, data_time: 0.381, memory: 17810, stage0_loss_instance_mil: 0.0177, stage0_bag_acc: 98.7251, stage0_mean_ious: 0.4280, stage0_s: 0.0000, stage0_m: 0.0345, stage0_l: 0.1197, stage0_h: 0.4755, stage1_loss_instance_mil: 0.1468, stage1_bag_acc: 98.6415, stage1_neg_loss: 0.0607, stage1_mean_ious: 0.3877, stage1_s: 0.0000, stage1_m: 0.0277, stage1_l: 0.1003, stage1_h: 0.4327, loss: 0.2252, grad_norm: 10.7108
2024-04-20 01:57:40,354 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:55:57, time: 4.190, data_time: 0.337, memory: 17810, stage0_loss_instance_mil: 0.0133, stage0_bag_acc: 99.0254, stage0_mean_ious: 0.4219, stage0_s: 0.0009, stage0_m: 0.0417, stage0_l: 0.1007, stage0_h: 0.4661, stage1_loss_instance_mil: 0.1431, stage1_bag_acc: 99.4731, stage1_neg_loss: 0.0553, stage1_mean_ious: 0.3859, stage1_s: 0.0004, stage1_m: 0.0324, stage1_l: 0.0881, stage1_h: 0.4284, loss: 0.2116, grad_norm: 8.6204
2024-04-20 01:59:47,749 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-20 02:02:13,893 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:49:34, time: 2.869, data_time: 0.221, memory: 17810, stage0_loss_instance_mil: 0.0156, stage0_bag_acc: 99.0849, stage0_mean_ious: 0.4534, stage0_s: 0.0000, stage0_m: 0.0434, stage0_l: 0.1241, stage0_h: 0.4927, stage1_loss_instance_mil: 0.1327, stage1_bag_acc: 99.2492, stage1_neg_loss: 0.0572, stage1_mean_ious: 0.4180, stage1_s: 0.0000, stage1_m: 0.0305, stage1_l: 0.1157, stage1_h: 0.4547, loss: 0.2055, grad_norm: 9.5154
2024-04-20 02:07:02,128 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:47:45, time: 5.765, data_time: 0.527, memory: 17810, stage0_loss_instance_mil: 0.0099, stage0_bag_acc: 99.4818, stage0_mean_ious: 0.4470, stage0_s: 0.0000, stage0_m: 0.0382, stage0_l: 0.1089, stage0_h: 0.4837, stage1_loss_instance_mil: 0.1315, stage1_bag_acc: 99.7061, stage1_neg_loss: 0.0568, stage1_mean_ious: 0.4097, stage1_s: 0.0000, stage1_m: 0.0257, stage1_l: 0.0914, stage1_h: 0.4458, loss: 0.1981, grad_norm: 8.7232
2024-04-20 02:10:46,513 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:45:10, time: 4.488, data_time: 0.389, memory: 17810, stage0_loss_instance_mil: 0.0212, stage0_bag_acc: 98.7764, stage0_mean_ious: 0.4275, stage0_s: 0.0008, stage0_m: 0.0370, stage0_l: 0.1436, stage0_h: 0.4684, stage1_loss_instance_mil: 0.1255, stage1_bag_acc: 99.1495, stage1_neg_loss: 0.0503, stage1_mean_ious: 0.4021, stage1_s: 0.0020, stage1_m: 0.0311, stage1_l: 0.1251, stage1_h: 0.4426, loss: 0.1969, grad_norm: 8.0906
2024-04-20 02:12:05,902 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-20 02:15:17,315 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:39:36, time: 3.777, data_time: 0.435, memory: 17810, stage0_loss_instance_mil: 0.0059, stage0_bag_acc: 99.6927, stage0_mean_ious: 0.4428, stage0_s: 0.0000, stage0_m: 0.0179, stage0_l: 0.1199, stage0_h: 0.4806, stage1_loss_instance_mil: 0.0979, stage1_bag_acc: 99.7889, stage1_neg_loss: 0.0428, stage1_mean_ious: 0.4064, stage1_s: 0.0000, stage1_m: 0.0166, stage1_l: 0.1069, stage1_h: 0.4415, loss: 0.1465, grad_norm: 5.2657
2024-04-20 02:19:55,113 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:37:19, time: 5.555, data_time: 0.492, memory: 17810, stage0_loss_instance_mil: 0.0105, stage0_bag_acc: 99.6897, stage0_mean_ious: 0.4163, stage0_s: 0.0000, stage0_m: 0.0208, stage0_l: 0.1108, stage0_h: 0.4584, stage1_loss_instance_mil: 0.0987, stage1_bag_acc: 99.6614, stage1_neg_loss: 0.0478, stage1_mean_ious: 0.3877, stage1_s: 0.0003, stage1_m: 0.0157, stage1_l: 0.0988, stage1_h: 0.4280, loss: 0.1570, grad_norm: 5.9556
2024-04-20 02:23:53,672 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:34:39, time: 4.772, data_time: 0.427, memory: 17810, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.8056, stage0_mean_ious: 0.4100, stage0_s: 0.0000, stage0_m: 0.0437, stage0_l: 0.1178, stage0_h: 0.4472, stage1_loss_instance_mil: 0.0905, stage1_bag_acc: 99.7400, stage1_neg_loss: 0.0429, stage1_mean_ious: 0.3798, stage1_s: 0.0000, stage1_m: 0.0355, stage1_l: 0.1108, stage1_h: 0.4156, loss: 0.1395, grad_norm: 5.1722
2024-04-20 02:24:44,439 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-20 02:28:59,127 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:29:36, time: 5.036, data_time: 0.689, memory: 17810, stage0_loss_instance_mil: 0.0043, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.4206, stage0_s: 0.0000, stage0_m: 0.0115, stage0_l: 0.0897, stage0_h: 0.4509, stage1_loss_instance_mil: 0.0831, stage1_bag_acc: 99.8824, stage1_neg_loss: 0.0479, stage1_mean_ious: 0.3877, stage1_s: 0.0000, stage1_m: 0.0105, stage1_l: 0.0803, stage1_h: 0.4169, loss: 0.1353, grad_norm: 5.5353
2024-04-20 02:33:17,905 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:26:54, time: 5.175, data_time: 0.923, memory: 17810, stage0_loss_instance_mil: 0.0033, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.4242, stage0_s: 0.0000, stage0_m: 0.0316, stage0_l: 0.1019, stage0_h: 0.4637, stage1_loss_instance_mil: 0.0904, stage1_bag_acc: 99.7614, stage1_neg_loss: 0.0448, stage1_mean_ious: 0.3936, stage1_s: 0.0000, stage1_m: 0.0239, stage1_l: 0.0825, stage1_h: 0.4325, loss: 0.1386, grad_norm: 5.3790
2024-04-20 02:36:12,584 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:23:49, time: 3.493, data_time: 0.413, memory: 17810, stage0_loss_instance_mil: 0.0101, stage0_bag_acc: 99.5455, stage0_mean_ious: 0.4113, stage0_s: 0.0000, stage0_m: 0.0533, stage0_l: 0.1156, stage0_h: 0.4648, stage1_loss_instance_mil: 0.0965, stage1_bag_acc: 99.7460, stage1_neg_loss: 0.0506, stage1_mean_ious: 0.3803, stage1_s: 0.0000, stage1_m: 0.0397, stage1_l: 0.1074, stage1_h: 0.4299, loss: 0.1572, grad_norm: 6.7318
2024-04-20 02:37:22,955 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-20 02:42:19,733 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:18:52, time: 5.482, data_time: 0.568, memory: 17810, stage0_loss_instance_mil: 0.0070, stage0_bag_acc: 99.4339, stage0_mean_ious: 0.4164, stage0_s: 0.0000, stage0_m: 0.0316, stage0_l: 0.1061, stage0_h: 0.4627, stage1_loss_instance_mil: 0.0945, stage1_bag_acc: 99.3228, stage1_neg_loss: 0.0424, stage1_mean_ious: 0.3841, stage1_s: 0.0000, stage1_m: 0.0228, stage1_l: 0.0939, stage1_h: 0.4281, loss: 0.1439, grad_norm: 6.0565
2024-04-20 02:46:40,216 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:16:00, time: 5.209, data_time: 0.509, memory: 17810, stage0_loss_instance_mil: 0.0047, stage0_bag_acc: 99.6804, stage0_mean_ious: 0.4094, stage0_s: 0.0000, stage0_m: 0.0257, stage0_l: 0.0980, stage0_h: 0.4541, stage1_loss_instance_mil: 0.0823, stage1_bag_acc: 99.7981, stage1_neg_loss: 0.0463, stage1_mean_ious: 0.3787, stage1_s: 0.0000, stage1_m: 0.0181, stage1_l: 0.0837, stage1_h: 0.4218, loss: 0.1333, grad_norm: 5.1298
2024-04-20 02:48:42,785 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:12:49, time: 2.451, data_time: 0.163, memory: 17810, stage0_loss_instance_mil: 0.0054, stage0_bag_acc: 99.8291, stage0_mean_ious: 0.4102, stage0_s: 0.0000, stage0_m: 0.0253, stage0_l: 0.1568, stage0_h: 0.4530, stage1_loss_instance_mil: 0.0844, stage1_bag_acc: 99.8139, stage1_neg_loss: 0.0412, stage1_mean_ious: 0.3751, stage1_s: 0.0000, stage1_m: 0.0205, stage1_l: 0.1404, stage1_h: 0.4163, loss: 0.1311, grad_norm: 5.2066
2024-04-20 02:50:51,726 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-20 02:55:22,941 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:07:53, time: 4.967, data_time: 0.510, memory: 17810, stage0_loss_instance_mil: 0.0037, stage0_bag_acc: 99.9130, stage0_mean_ious: 0.4180, stage0_s: 0.0000, stage0_m: 0.0327, stage0_l: 0.1234, stage0_h: 0.4661, stage1_loss_instance_mil: 0.0800, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0461, stage1_mean_ious: 0.3860, stage1_s: 0.0000, stage1_m: 0.0241, stage1_l: 0.1087, stage1_h: 0.4327, loss: 0.1299, grad_norm: 5.3734
2024-04-20 02:59:06,695 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:04:52, time: 4.475, data_time: 0.353, memory: 17810, stage0_loss_instance_mil: 0.0022, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.4278, stage0_s: 0.0000, stage0_m: 0.0219, stage0_l: 0.1169, stage0_h: 0.4660, stage1_loss_instance_mil: 0.0844, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0431, stage1_mean_ious: 0.3926, stage1_s: 0.0000, stage1_m: 0.0168, stage1_l: 0.1061, stage1_h: 0.4282, loss: 0.1297, grad_norm: 5.1570
2024-04-20 03:00:42,209 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:01:48, time: 1.911, data_time: 0.080, memory: 17810, stage0_loss_instance_mil: 0.0072, stage0_bag_acc: 99.7714, stage0_mean_ious: 0.4022, stage0_s: 0.0000, stage0_m: 0.0316, stage0_l: 0.1036, stage0_h: 0.4412, stage1_loss_instance_mil: 0.0815, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0391, stage1_mean_ious: 0.3707, stage1_s: 0.0000, stage1_m: 0.0261, stage1_l: 0.0857, stage1_h: 0.4086, loss: 0.1278, grad_norm: 4.5182
2024-04-20 03:03:03,938 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-20 03:12:15,351 - mmdet - INFO - Evaluating bbox...
2024-04-20 03:12:17,502 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0698
2024-04-20 03:12:17,502 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2286
2024-04-20 03:12:17,503 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1267
2024-04-20 03:12:17,503 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0439
2024-04-20 03:12:17,503 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0199
2024-04-20 03:12:17,503 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0072
2024-04-20 03:12:17,504 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-04-20 03:12:17,504 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0033
2024-04-20 03:12:17,504 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0753
2024-04-20 03:12:17,504 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1083
2024-04-20 03:12:17,505 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1313
2024-04-20 03:12:17,505 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1313
2024-04-20 03:12:17,505 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1313
2024-04-20 03:12:17,505 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0196
2024-04-20 03:12:17,505 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1566
2024-04-20 03:12:17,505 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1322
2024-04-20 03:12:17,552 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 03:12:17,552 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0700, bbox_mAP_50: 0.2290, bbox_mAP_75: 0.1270, bbox_mAP_s: 0.0440, bbox_mAP_m: 0.0200, bbox_mAP_l: 0.0070, bbox_mAP_copypaste: 0.070 0.229 0.127 0.044 0.020 0.007
2024-04-20 03:23:40,776 - mmdet - INFO - Evaluating bbox...
2024-04-20 03:23:42,727 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0698
2024-04-20 03:23:42,727 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2286
2024-04-20 03:23:42,728 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1267
2024-04-20 03:23:42,728 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0439
2024-04-20 03:23:42,728 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0199
2024-04-20 03:23:42,728 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0072
2024-04-20 03:23:42,728 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-04-20 03:23:42,729 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0033
2024-04-20 03:23:42,729 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0753
2024-04-20 03:23:42,729 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1083
2024-04-20 03:23:42,729 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1313
2024-04-20 03:23:42,729 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1313
2024-04-20 03:23:42,730 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1313
2024-04-20 03:23:42,730 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0196
2024-04-20 03:23:42,730 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1566
2024-04-20 03:23:42,730 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1322
2024-04-20 03:23:45,418 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-20 03:23:47,597 - mmdet - INFO - Distributed training: False
2024-04-20 03:23:49,710 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-20 03:23:52,408 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-20 03:23:52,408 - mmdet - INFO - Use load_from_local loader
2024-04-20 03:23:52,793 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-20 03:23:52,815 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-20 03:23:52,815 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-20 03:27:01,746 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 2:12:52, time: 3.778, data_time: 0.438, memory: 17810, stage0_loss_instance_mil: 0.7274, stage0_bag_acc: 12.8790, stage0_mean_ious: 0.2837, stage0_s: 0.0000, stage0_m: 0.0318, stage0_l: 0.1758, stage0_h: 0.2944, stage1_loss_instance_mil: 0.1568, stage1_bag_acc: 13.2695, stage1_neg_loss: 0.0012, stage1_mean_ious: 0.2623, stage1_s: 0.0000, stage1_m: 0.0332, stage1_l: 0.1833, stage1_h: 0.2684, loss: 0.8854, grad_norm: 3.3962
2024-04-20 03:31:18,032 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 2:32:50, time: 5.125, data_time: 0.799, memory: 17810, stage0_loss_instance_mil: 0.6090, stage0_bag_acc: 54.0109, stage0_mean_ious: 0.3443, stage0_s: 0.0000, stage0_m: 0.0504, stage0_l: 0.2558, stage0_h: 0.3506, stage1_loss_instance_mil: 0.2146, stage1_bag_acc: 32.1850, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.3113, stage1_s: 0.0000, stage1_m: 0.0429, stage1_l: 0.2215, stage1_h: 0.3182, loss: 0.8279, grad_norm: 3.9273
2024-04-20 03:35:28,041 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 2:35:15, time: 5.000, data_time: 0.957, memory: 17810, stage0_loss_instance_mil: 0.2806, stage0_bag_acc: 86.5218, stage0_mean_ious: 0.4281, stage0_s: 0.0000, stage0_m: 0.0603, stage0_l: 0.2127, stage0_h: 0.4509, stage1_loss_instance_mil: 0.2970, stage1_bag_acc: 75.0098, stage1_neg_loss: 0.0641, stage1_mean_ious: 0.4001, stage1_s: 0.0000, stage1_m: 0.0546, stage1_l: 0.1942, stage1_h: 0.4230, loss: 0.6417, grad_norm: 9.8805
2024-04-20 03:36:19,768 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-20 03:40:31,559 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 2:12:00, time: 4.975, data_time: 0.471, memory: 17810, stage0_loss_instance_mil: 0.0980, stage0_bag_acc: 95.0098, stage0_mean_ious: 0.4635, stage0_s: 0.0000, stage0_m: 0.0422, stage0_l: 0.1933, stage0_h: 0.4969, stage1_loss_instance_mil: 0.2968, stage1_bag_acc: 96.7761, stage1_neg_loss: 0.0781, stage1_mean_ious: 0.4085, stage1_s: 0.0000, stage1_m: 0.0305, stage1_l: 0.1743, stage1_h: 0.4387, loss: 0.4729, grad_norm: 12.4279
2024-04-20 03:44:28,617 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 2:12:09, time: 4.740, data_time: 0.416, memory: 17810, stage0_loss_instance_mil: 0.0428, stage0_bag_acc: 98.1108, stage0_mean_ious: 0.4813, stage0_s: 0.0000, stage0_m: 0.0447, stage0_l: 0.2183, stage0_h: 0.5112, stage1_loss_instance_mil: 0.2747, stage1_bag_acc: 99.0262, stage1_neg_loss: 0.0829, stage1_mean_ious: 0.4322, stage1_s: 0.0000, stage1_m: 0.0356, stage1_l: 0.2044, stage1_h: 0.4600, loss: 0.4004, grad_norm: 13.4299
2024-04-20 03:47:45,995 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 2:07:23, time: 3.948, data_time: 0.304, memory: 17810, stage0_loss_instance_mil: 0.0785, stage0_bag_acc: 95.2647, stage0_mean_ious: 0.4617, stage0_s: 0.0000, stage0_m: 0.0319, stage0_l: 0.1773, stage0_h: 0.4963, stage1_loss_instance_mil: 0.2764, stage1_bag_acc: 96.4998, stage1_neg_loss: 0.0768, stage1_mean_ious: 0.4161, stage1_s: 0.0000, stage1_m: 0.0287, stage1_l: 0.1605, stage1_h: 0.4465, loss: 0.4317, grad_norm: 16.6121
2024-04-20 03:48:43,068 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-20 03:52:50,423 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 1:54:17, time: 4.565, data_time: 0.629, memory: 17810, stage0_loss_instance_mil: 0.0360, stage0_bag_acc: 98.5965, stage0_mean_ious: 0.4891, stage0_s: 0.0016, stage0_m: 0.0310, stage0_l: 0.1950, stage0_h: 0.5258, stage1_loss_instance_mil: 0.2413, stage1_bag_acc: 98.2597, stage1_neg_loss: 0.0855, stage1_mean_ious: 0.4408, stage1_s: 0.0017, stage1_m: 0.0187, stage1_l: 0.1893, stage1_h: 0.4732, loss: 0.3628, grad_norm: 18.2254
2024-04-20 03:56:26,507 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 1:52:15, time: 4.322, data_time: 0.291, memory: 17810, stage0_loss_instance_mil: 0.0414, stage0_bag_acc: 97.5551, stage0_mean_ious: 0.4787, stage0_s: 0.0000, stage0_m: 0.0322, stage0_l: 0.1559, stage0_h: 0.5191, stage1_loss_instance_mil: 0.2290, stage1_bag_acc: 98.6276, stage1_neg_loss: 0.0764, stage1_mean_ious: 0.4320, stage1_s: 0.0000, stage1_m: 0.0325, stage1_l: 0.1352, stage1_h: 0.4688, loss: 0.3468, grad_norm: 16.4513
2024-04-20 03:59:25,020 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 1:47:54, time: 3.570, data_time: 0.257, memory: 17810, stage0_loss_instance_mil: 0.0475, stage0_bag_acc: 97.0810, stage0_mean_ious: 0.3801, stage0_s: 0.0000, stage0_m: 0.0359, stage0_l: 0.1220, stage0_h: 0.4204, stage1_loss_instance_mil: 0.2544, stage1_bag_acc: 97.7548, stage1_neg_loss: 0.0755, stage1_mean_ious: 0.3444, stage1_s: 0.0000, stage1_m: 0.0259, stage1_l: 0.1070, stage1_h: 0.3821, loss: 0.3774, grad_norm: 15.1784
2024-04-20 04:00:16,033 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-20 04:04:26,565 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 1:39:44, time: 4.956, data_time: 0.619, memory: 17810, stage0_loss_instance_mil: 0.0249, stage0_bag_acc: 98.4800, stage0_mean_ious: 0.4003, stage0_s: 0.0000, stage0_m: 0.0308, stage0_l: 0.1134, stage0_h: 0.4369, stage1_loss_instance_mil: 0.2358, stage1_bag_acc: 98.7999, stage1_neg_loss: 0.0765, stage1_mean_ious: 0.3584, stage1_s: 0.0000, stage1_m: 0.0234, stage1_l: 0.1010, stage1_h: 0.3910, loss: 0.3372, grad_norm: 15.4935
2024-04-20 04:08:31,116 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 1:38:42, time: 4.891, data_time: 0.397, memory: 17810, stage0_loss_instance_mil: 0.0268, stage0_bag_acc: 98.2463, stage0_mean_ious: 0.3738, stage0_s: 0.0016, stage0_m: 0.0363, stage0_l: 0.1180, stage0_h: 0.4155, stage1_loss_instance_mil: 0.2161, stage1_bag_acc: 98.5167, stage1_neg_loss: 0.0682, stage1_mean_ious: 0.3401, stage1_s: 0.0024, stage1_m: 0.0236, stage1_l: 0.1144, stage1_h: 0.3779, loss: 0.3111, grad_norm: 12.5735
2024-04-20 04:11:34,176 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 1:35:02, time: 3.662, data_time: 0.279, memory: 17810, stage0_loss_instance_mil: 0.0434, stage0_bag_acc: 97.5189, stage0_mean_ious: 0.2923, stage0_s: 0.0000, stage0_m: 0.0380, stage0_l: 0.1109, stage0_h: 0.3173, stage1_loss_instance_mil: 0.2522, stage1_bag_acc: 98.1839, stage1_neg_loss: 0.0629, stage1_mean_ious: 0.2691, stage1_s: 0.0000, stage1_m: 0.0295, stage1_l: 0.0968, stage1_h: 0.2941, loss: 0.3585, grad_norm: 11.8831
2024-04-20 04:12:25,551 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-20 04:17:26,161 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 1:29:09, time: 5.735, data_time: 0.553, memory: 17810, stage0_loss_instance_mil: 0.0144, stage0_bag_acc: 99.0649, stage0_mean_ious: 0.2964, stage0_s: 0.0000, stage0_m: 0.0395, stage0_l: 0.1488, stage0_h: 0.3175, stage1_loss_instance_mil: 0.2309, stage1_bag_acc: 99.4447, stage1_neg_loss: 0.0677, stage1_mean_ious: 0.2740, stage1_s: 0.0000, stage1_m: 0.0248, stage1_l: 0.1399, stage1_h: 0.2940, loss: 0.3130, grad_norm: 10.3099
2024-04-20 04:21:39,663 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 1:27:36, time: 5.070, data_time: 0.389, memory: 17810, stage0_loss_instance_mil: 0.0252, stage0_bag_acc: 98.3630, stage0_mean_ious: 0.2538, stage0_s: 0.0014, stage0_m: 0.0256, stage0_l: 0.1033, stage0_h: 0.2718, stage1_loss_instance_mil: 0.2217, stage1_bag_acc: 98.7497, stage1_neg_loss: 0.0669, stage1_mean_ious: 0.2346, stage1_s: 0.0013, stage1_m: 0.0210, stage1_l: 0.0965, stage1_h: 0.2509, loss: 0.3138, grad_norm: 10.2680
2024-04-20 04:23:51,599 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 1:22:45, time: 2.639, data_time: 0.201, memory: 17810, stage0_loss_instance_mil: 0.0295, stage0_bag_acc: 98.3748, stage0_mean_ious: 0.2728, stage0_s: 0.0000, stage0_m: 0.0198, stage0_l: 0.1423, stage0_h: 0.2927, stage1_loss_instance_mil: 0.2064, stage1_bag_acc: 98.6239, stage1_neg_loss: 0.0649, stage1_mean_ious: 0.2462, stage1_s: 0.0000, stage1_m: 0.0115, stage1_l: 0.1245, stage1_h: 0.2649, loss: 0.3008, grad_norm: 10.6843
2024-04-20 04:25:50,600 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-20 04:30:02,533 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 1:16:01, time: 4.643, data_time: 0.495, memory: 17810, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.4701, stage0_mean_ious: 0.2801, stage0_s: 0.0000, stage0_m: 0.0302, stage0_l: 0.1534, stage0_h: 0.2959, stage1_loss_instance_mil: 0.1826, stage1_bag_acc: 99.5514, stage1_neg_loss: 0.0624, stage1_mean_ious: 0.2514, stage1_s: 0.0000, stage1_m: 0.0229, stage1_l: 0.1384, stage1_h: 0.2664, loss: 0.2558, grad_norm: 9.1930
2024-04-20 04:34:18,037 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 04:34:18,037 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 1:14:10, time: 5.110, data_time: 0.458, memory: 17810, stage0_loss_instance_mil: 0.0115, stage0_bag_acc: 99.3905, stage0_mean_ious: 0.2471, stage0_s: 0.0000, stage0_m: 0.0228, stage0_l: 0.1060, stage0_h: 0.2690, stage1_loss_instance_mil: 0.1868, stage1_bag_acc: 99.3369, stage1_neg_loss: 0.0650, stage1_mean_ious: 0.2270, stage1_s: 0.0000, stage1_m: 0.0143, stage1_l: 0.0988, stage1_h: 0.2485, loss: 0.2634, grad_norm: 9.2625
2024-04-20 04:36:10,196 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 1:09:34, time: 2.244, data_time: 0.110, memory: 17810, stage0_loss_instance_mil: 0.0146, stage0_bag_acc: 99.5141, stage0_mean_ious: 0.2284, stage0_s: 0.0000, stage0_m: 0.0368, stage0_l: 0.1206, stage0_h: 0.2482, stage1_loss_instance_mil: 0.1747, stage1_bag_acc: 99.4603, stage1_neg_loss: 0.0604, stage1_mean_ious: 0.2095, stage1_s: 0.0000, stage1_m: 0.0243, stage1_l: 0.1126, stage1_h: 0.2279, loss: 0.2498, grad_norm: 9.0288
2024-04-20 04:38:52,550 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-20 04:48:02,612 - mmdet - INFO - Evaluating bbox...
2024-04-20 04:48:04,522 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0121
2024-04-20 04:48:04,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0605
2024-04-20 04:48:04,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0155
2024-04-20 04:48:04,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0042
2024-04-20 04:48:04,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0029
2024-04-20 04:48:04,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0021
2024-04-20 04:48:04,523 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-20 04:48:04,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0005
2024-04-20 04:48:04,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0166
2024-04-20 04:48:04,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0017
2024-04-20 04:48:04,524 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0339
2024-04-20 04:48:04,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0339
2024-04-20 04:48:04,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0339
2024-04-20 04:48:04,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0097
2024-04-20 04:48:04,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0421
2024-04-20 04:48:04,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0024
2024-04-20 04:48:04,571 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 04:48:04,572 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.0120, bbox_mAP_50: 0.0610, bbox_mAP_75: 0.0150, bbox_mAP_s: 0.0040, bbox_mAP_m: 0.0030, bbox_mAP_l: 0.0020, bbox_mAP_copypaste: 0.012 0.061 0.015 0.004 0.003 0.002
2024-04-20 04:52:15,519 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 1:03:47, time: 5.017, data_time: 0.428, memory: 17810, stage0_loss_instance_mil: 0.0616, stage0_bag_acc: 96.0214, stage0_mean_ious: 0.2410, stage0_s: 0.0000, stage0_m: 0.0362, stage0_l: 0.1184, stage0_h: 0.2576, stage1_loss_instance_mil: 0.1626, stage1_bag_acc: 96.6833, stage1_neg_loss: 0.0546, stage1_mean_ious: 0.2170, stage1_s: 0.0000, stage1_m: 0.0251, stage1_l: 0.1086, stage1_h: 0.2312, loss: 0.2788, grad_norm: 10.9558
2024-04-20 04:56:09,269 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 1:01:21, time: 4.675, data_time: 0.453, memory: 17810, stage0_loss_instance_mil: 0.0160, stage0_bag_acc: 99.0241, stage0_mean_ious: 0.2475, stage0_s: 0.0000, stage0_m: 0.0237, stage0_l: 0.0903, stage0_h: 0.2649, stage1_loss_instance_mil: 0.1729, stage1_bag_acc: 99.6687, stage1_neg_loss: 0.0658, stage1_mean_ious: 0.2297, stage1_s: 0.0000, stage1_m: 0.0185, stage1_l: 0.0896, stage1_h: 0.2451, loss: 0.2547, grad_norm: 9.7704
2024-04-20 04:59:09,621 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:58:08, time: 3.607, data_time: 0.283, memory: 17810, stage0_loss_instance_mil: 0.0186, stage0_bag_acc: 99.1594, stage0_mean_ious: 0.2319, stage0_s: 0.0000, stage0_m: 0.0341, stage0_l: 0.1401, stage0_h: 0.2472, stage1_loss_instance_mil: 0.1762, stage1_bag_acc: 99.1285, stage1_neg_loss: 0.0625, stage1_mean_ious: 0.2143, stage1_s: 0.0000, stage1_m: 0.0280, stage1_l: 0.1249, stage1_h: 0.2309, loss: 0.2572, grad_norm: 9.0076
2024-04-20 04:59:59,844 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-20 05:04:17,435 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:52:38, time: 5.086, data_time: 0.513, memory: 17810, stage0_loss_instance_mil: 0.0122, stage0_bag_acc: 99.4277, stage0_mean_ious: 0.2139, stage0_s: 0.0000, stage0_m: 0.0411, stage0_l: 0.1247, stage0_h: 0.2316, stage1_loss_instance_mil: 0.1519, stage1_bag_acc: 99.6713, stage1_neg_loss: 0.0631, stage1_mean_ious: 0.1982, stage1_s: 0.0000, stage1_m: 0.0330, stage1_l: 0.1114, stage1_h: 0.2165, loss: 0.2272, grad_norm: 8.0900
2024-04-20 05:08:42,017 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:50:19, time: 5.292, data_time: 0.677, memory: 17810, stage0_loss_instance_mil: 0.0086, stage0_bag_acc: 99.5323, stage0_mean_ious: 0.1752, stage0_s: 0.0000, stage0_m: 0.0172, stage0_l: 0.0876, stage0_h: 0.1811, stage1_loss_instance_mil: 0.1709, stage1_bag_acc: 99.7947, stage1_neg_loss: 0.0645, stage1_mean_ious: 0.1670, stage1_s: 0.0000, stage1_m: 0.0138, stage1_l: 0.0822, stage1_h: 0.1738, loss: 0.2439, grad_norm: 8.9067
2024-04-20 05:11:22,479 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:46:55, time: 3.210, data_time: 0.229, memory: 17810, stage0_loss_instance_mil: 0.0120, stage0_bag_acc: 99.0564, stage0_mean_ious: 0.1932, stage0_s: 0.0000, stage0_m: 0.0212, stage0_l: 0.1092, stage0_h: 0.2040, stage1_loss_instance_mil: 0.1593, stage1_bag_acc: 99.7771, stage1_neg_loss: 0.0597, stage1_mean_ious: 0.1797, stage1_s: 0.0000, stage1_m: 0.0127, stage1_l: 0.1016, stage1_h: 0.1910, loss: 0.2309, grad_norm: 8.0340
2024-04-20 05:12:12,542 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-20 05:16:37,102 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:41:37, time: 5.229, data_time: 0.684, memory: 17810, stage0_loss_instance_mil: 0.0098, stage0_bag_acc: 99.3813, stage0_mean_ious: 0.1615, stage0_s: 0.0000, stage0_m: 0.0349, stage0_l: 0.0921, stage0_h: 0.1673, stage1_loss_instance_mil: 0.1462, stage1_bag_acc: 99.7239, stage1_neg_loss: 0.0597, stage1_mean_ious: 0.1544, stage1_s: 0.0000, stage1_m: 0.0298, stage1_l: 0.0791, stage1_h: 0.1612, loss: 0.2156, grad_norm: 6.4934
2024-04-20 05:20:30,094 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:38:50, time: 4.660, data_time: 0.426, memory: 17810, stage0_loss_instance_mil: 0.0080, stage0_bag_acc: 99.4601, stage0_mean_ious: 0.1801, stage0_s: 0.0000, stage0_m: 0.0245, stage0_l: 0.1099, stage0_h: 0.1881, stage1_loss_instance_mil: 0.1363, stage1_bag_acc: 99.6601, stage1_neg_loss: 0.0563, stage1_mean_ious: 0.1677, stage1_s: 0.0000, stage1_m: 0.0171, stage1_l: 0.0956, stage1_h: 0.1767, loss: 0.2005, grad_norm: 5.4340
2024-04-20 05:23:14,877 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:35:33, time: 3.296, data_time: 0.230, memory: 17810, stage0_loss_instance_mil: 0.0066, stage0_bag_acc: 99.5220, stage0_mean_ious: 0.1865, stage0_s: 0.0000, stage0_m: 0.0240, stage0_l: 0.1121, stage0_h: 0.1922, stage1_loss_instance_mil: 0.1255, stage1_bag_acc: 99.6962, stage1_neg_loss: 0.0583, stage1_mean_ious: 0.1739, stage1_s: 0.0000, stage1_m: 0.0173, stage1_l: 0.1058, stage1_h: 0.1801, loss: 0.1904, grad_norm: 5.9641
2024-04-20 05:24:05,898 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-20 05:28:50,872 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:30:29, time: 5.645, data_time: 0.490, memory: 17810, stage0_loss_instance_mil: 0.0090, stage0_bag_acc: 99.5660, stage0_mean_ious: 0.1749, stage0_s: 0.0000, stage0_m: 0.0305, stage0_l: 0.1154, stage0_h: 0.1828, stage1_loss_instance_mil: 0.1273, stage1_bag_acc: 99.5836, stage1_neg_loss: 0.0535, stage1_mean_ious: 0.1634, stage1_s: 0.0000, stage1_m: 0.0256, stage1_l: 0.0998, stage1_h: 0.1730, loss: 0.1898, grad_norm: 4.9878
2024-04-20 05:32:36,084 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:27:32, time: 4.504, data_time: 0.399, memory: 17810, stage0_loss_instance_mil: 0.0067, stage0_bag_acc: 99.3599, stage0_mean_ious: 0.1921, stage0_s: 0.0000, stage0_m: 0.0332, stage0_l: 0.1134, stage0_h: 0.2010, stage1_loss_instance_mil: 0.1173, stage1_bag_acc: 99.6528, stage1_neg_loss: 0.0556, stage1_mean_ious: 0.1774, stage1_s: 0.0000, stage1_m: 0.0228, stage1_l: 0.1068, stage1_h: 0.1856, loss: 0.1796, grad_norm: 5.4511
2024-04-20 05:35:17,754 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:24:18, time: 3.233, data_time: 0.205, memory: 17810, stage0_loss_instance_mil: 0.0054, stage0_bag_acc: 99.6528, stage0_mean_ious: 0.1852, stage0_s: 0.0000, stage0_m: 0.0165, stage0_l: 0.0997, stage0_h: 0.1960, stage1_loss_instance_mil: 0.1263, stage1_bag_acc: 99.7639, stage1_neg_loss: 0.0510, stage1_mean_ious: 0.1697, stage1_s: 0.0000, stage1_m: 0.0116, stage1_l: 0.0903, stage1_h: 0.1808, loss: 0.1827, grad_norm: 5.6278
2024-04-20 05:36:08,679 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-20 05:40:35,609 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:19:12, time: 5.138, data_time: 0.494, memory: 17810, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.8750, stage0_mean_ious: 0.1767, stage0_s: 0.0000, stage0_m: 0.0096, stage0_l: 0.1110, stage0_h: 0.1814, stage1_loss_instance_mil: 0.1224, stage1_bag_acc: 99.8750, stage1_neg_loss: 0.0536, stage1_mean_ious: 0.1652, stage1_s: 0.0000, stage1_m: 0.0068, stage1_l: 0.1014, stage1_h: 0.1703, loss: 0.1821, grad_norm: 5.0483
2024-04-20 05:45:01,967 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:16:17, time: 5.328, data_time: 0.675, memory: 17810, stage0_loss_instance_mil: 0.0021, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.1731, stage0_s: 0.0000, stage0_m: 0.0148, stage0_l: 0.1010, stage0_h: 0.1853, stage1_loss_instance_mil: 0.1178, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0496, stage1_mean_ious: 0.1581, stage1_s: 0.0000, stage1_m: 0.0124, stage1_l: 0.0872, stage1_h: 0.1689, loss: 0.1694, grad_norm: 5.1798
2024-04-20 05:47:27,113 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:13:05, time: 2.903, data_time: 0.169, memory: 17810, stage0_loss_instance_mil: 0.0076, stage0_bag_acc: 99.8089, stage0_mean_ious: 0.1697, stage0_s: 0.0000, stage0_m: 0.0192, stage0_l: 0.1114, stage0_h: 0.1724, stage1_loss_instance_mil: 0.1263, stage1_bag_acc: 99.8889, stage1_neg_loss: 0.0544, stage1_mean_ious: 0.1549, stage1_s: 0.0000, stage1_m: 0.0128, stage1_l: 0.0892, stage1_h: 0.1601, loss: 0.1883, grad_norm: 6.0880
2024-04-20 05:48:48,106 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-20 05:52:37,989 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:07:59, time: 4.097, data_time: 0.587, memory: 17810, stage0_loss_instance_mil: 0.0074, stage0_bag_acc: 99.5862, stage0_mean_ious: 0.1760, stage0_s: 0.0000, stage0_m: 0.0212, stage0_l: 0.1101, stage0_h: 0.1828, stage1_loss_instance_mil: 0.1148, stage1_bag_acc: 99.6771, stage1_neg_loss: 0.0580, stage1_mean_ious: 0.1647, stage1_s: 0.0000, stage1_m: 0.0135, stage1_l: 0.1041, stage1_h: 0.1716, loss: 0.1802, grad_norm: 5.4374
2024-04-20 05:56:51,537 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:04:58, time: 5.071, data_time: 0.447, memory: 17810, stage0_loss_instance_mil: 0.0024, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.1884, stage0_s: 0.0000, stage0_m: 0.0405, stage0_l: 0.0988, stage0_h: 0.1984, stage1_loss_instance_mil: 0.1164, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0522, stage1_mean_ious: 0.1707, stage1_s: 0.0000, stage1_m: 0.0327, stage1_l: 0.0874, stage1_h: 0.1811, loss: 0.1710, grad_norm: 5.1952
2024-04-20 05:59:05,185 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:01:51, time: 2.673, data_time: 0.171, memory: 17810, stage0_loss_instance_mil: 0.0046, stage0_bag_acc: 99.8889, stage0_mean_ious: 0.1810, stage0_s: 0.0000, stage0_m: 0.0309, stage0_l: 0.0871, stage0_h: 0.1873, stage1_loss_instance_mil: 0.1260, stage1_bag_acc: 99.7490, stage1_neg_loss: 0.0544, stage1_mean_ious: 0.1653, stage1_s: 0.0000, stage1_m: 0.0231, stage1_l: 0.0764, stage1_h: 0.1720, loss: 0.1850, grad_norm: 5.7669
2024-04-20 06:00:42,039 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-20 06:11:00,322 - mmdet - INFO - Evaluating bbox...
2024-04-20 06:11:02,198 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0029
2024-04-20 06:11:02,198 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0207
2024-04-20 06:11:02,199 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0014
2024-04-20 06:11:02,199 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0002
2024-04-20 06:11:02,199 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0001
2024-04-20 06:11:02,199 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0001
2024-04-20 06:11:02,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-20 06:11:02,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-04-20 06:11:02,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0047
2024-04-20 06:11:02,200 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0012
2024-04-20 06:11:02,201 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0133
2024-04-20 06:11:02,201 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0133
2024-04-20 06:11:02,201 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0133
2024-04-20 06:11:02,201 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0010
2024-04-20 06:11:02,201 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0160
2024-04-20 06:11:02,201 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0012
2024-04-20 06:11:02,246 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 06:11:02,246 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0030, bbox_mAP_50: 0.0210, bbox_mAP_75: 0.0010, bbox_mAP_s: 0.0000, bbox_mAP_m: 0.0000, bbox_mAP_l: 0.0000, bbox_mAP_copypaste: 0.003 0.021 0.001 0.000 0.000 0.000
2024-04-20 06:22:37,946 - mmdet - INFO - Evaluating bbox...
2024-04-20 06:22:39,889 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0029
2024-04-20 06:22:39,889 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.0207
2024-04-20 06:22:39,889 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.0014
2024-04-20 06:22:39,890 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0002
2024-04-20 06:22:39,890 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0001
2024-04-20 06:22:39,890 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0001
2024-04-20 06:22:39,890 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0000
2024-04-20 06:22:39,891 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-04-20 06:22:39,891 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0047
2024-04-20 06:22:39,891 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0012
2024-04-20 06:22:39,891 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0133
2024-04-20 06:22:39,891 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.0133
2024-04-20 06:22:39,892 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.0133
2024-04-20 06:22:39,892 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0010
2024-04-20 06:22:39,892 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0160
2024-04-20 06:22:39,892 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0012
2024-04-20 06:22:42,661 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-20 06:22:44,783 - mmdet - INFO - Distributed training: False
2024-04-20 06:22:46,880 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-20 06:22:49,666 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-20 06:22:49,667 - mmdet - INFO - Use load_from_local loader
2024-04-20 06:22:50,058 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-20 06:22:50,082 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-20 06:22:50,088 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-20 06:26:26,711 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 2:32:21, time: 4.332, data_time: 0.382, memory: 17810, stage0_loss_instance_mil: 0.6987, stage0_bag_acc: 21.9446, stage0_mean_ious: 0.3015, stage0_s: 0.0000, stage0_m: 0.0181, stage0_l: 0.1897, stage0_h: 0.3086, stage1_loss_instance_mil: 0.1805, stage1_bag_acc: 11.4481, stage1_neg_loss: 0.0006, stage1_mean_ious: 0.2979, stage1_s: 0.0000, stage1_m: 0.0190, stage1_l: 0.1934, stage1_h: 0.3041, loss: 0.8798, grad_norm: 3.3670
2024-04-20 06:30:34,400 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 2:39:24, time: 4.954, data_time: 0.392, memory: 17810, stage0_loss_instance_mil: 0.5759, stage0_bag_acc: 50.3388, stage0_mean_ious: 0.3254, stage0_s: 0.0000, stage0_m: 0.0274, stage0_l: 0.1888, stage0_h: 0.3392, stage1_loss_instance_mil: 0.2598, stage1_bag_acc: 21.9787, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.3244, stage1_s: 0.0000, stage1_m: 0.0247, stage1_l: 0.1987, stage1_h: 0.3367, loss: 0.8378, grad_norm: 4.1926
2024-04-20 06:34:04,236 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 2:30:33, time: 4.196, data_time: 0.298, memory: 17810, stage0_loss_instance_mil: 0.2432, stage0_bag_acc: 89.9811, stage0_mean_ious: 0.3632, stage0_s: 0.0000, stage0_m: 0.0128, stage0_l: 0.1651, stage0_h: 0.3890, stage1_loss_instance_mil: 0.3550, stage1_bag_acc: 78.4314, stage1_neg_loss: 0.0642, stage1_mean_ious: 0.3673, stage1_s: 0.0000, stage1_m: 0.0148, stage1_l: 0.1803, stage1_h: 0.3915, loss: 0.6624, grad_norm: 9.8856
2024-04-20 06:34:58,240 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-20 06:38:42,501 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 2:05:12, time: 4.424, data_time: 0.423, memory: 17810, stage0_loss_instance_mil: 0.0860, stage0_bag_acc: 95.8504, stage0_mean_ious: 0.4352, stage0_s: 0.0000, stage0_m: 0.0511, stage0_l: 0.1815, stage0_h: 0.4706, stage1_loss_instance_mil: 0.3585, stage1_bag_acc: 96.3549, stage1_neg_loss: 0.0880, stage1_mean_ious: 0.4252, stage1_s: 0.0000, stage1_m: 0.0583, stage1_l: 0.1899, stage1_h: 0.4564, loss: 0.5325, grad_norm: 14.5248
2024-04-20 06:42:23,880 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 2:04:57, time: 4.428, data_time: 0.362, memory: 17810, stage0_loss_instance_mil: 0.0686, stage0_bag_acc: 96.6584, stage0_mean_ious: 0.4238, stage0_s: 0.0012, stage0_m: 0.0379, stage0_l: 0.1974, stage0_h: 0.4549, stage1_loss_instance_mil: 0.3396, stage1_bag_acc: 97.4629, stage1_neg_loss: 0.0940, stage1_mean_ious: 0.4141, stage1_s: 0.0010, stage1_m: 0.0288, stage1_l: 0.1927, stage1_h: 0.4455, loss: 0.5022, grad_norm: 16.1317
2024-04-20 06:46:00,047 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 2:03:11, time: 4.322, data_time: 0.378, memory: 17810, stage0_loss_instance_mil: 0.0465, stage0_bag_acc: 97.6208, stage0_mean_ious: 0.4525, stage0_s: 0.0000, stage0_m: 0.0301, stage0_l: 0.1751, stage0_h: 0.4858, stage1_loss_instance_mil: 0.2782, stage1_bag_acc: 98.9297, stage1_neg_loss: 0.0834, stage1_mean_ious: 0.4281, stage1_s: 0.0000, stage1_m: 0.0295, stage1_l: 0.1635, stage1_h: 0.4602, loss: 0.4082, grad_norm: 12.3562
2024-04-20 06:46:53,519 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-20 06:50:24,809 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 1:49:37, time: 4.162, data_time: 0.382, memory: 17810, stage0_loss_instance_mil: 0.0430, stage0_bag_acc: 97.2732, stage0_mean_ious: 0.4618, stage0_s: 0.0000, stage0_m: 0.0370, stage0_l: 0.1588, stage0_h: 0.4969, stage1_loss_instance_mil: 0.2194, stage1_bag_acc: 98.3516, stage1_neg_loss: 0.0783, stage1_mean_ious: 0.4337, stage1_s: 0.0000, stage1_m: 0.0354, stage1_l: 0.1467, stage1_h: 0.4661, loss: 0.3407, grad_norm: 12.6059
2024-04-20 06:54:01,061 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 1:48:13, time: 4.325, data_time: 0.316, memory: 17810, stage0_loss_instance_mil: 0.0253, stage0_bag_acc: 98.7992, stage0_mean_ious: 0.4808, stage0_s: 0.0000, stage0_m: 0.0427, stage0_l: 0.1776, stage0_h: 0.5273, stage1_loss_instance_mil: 0.2103, stage1_bag_acc: 99.1306, stage1_neg_loss: 0.0658, stage1_mean_ious: 0.4436, stage1_s: 0.0000, stage1_m: 0.0349, stage1_l: 0.1690, stage1_h: 0.4866, loss: 0.3014, grad_norm: 11.2141
2024-04-20 06:57:49,043 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 1:47:02, time: 4.560, data_time: 0.406, memory: 17810, stage0_loss_instance_mil: 0.0348, stage0_bag_acc: 98.0892, stage0_mean_ious: 0.5114, stage0_s: 0.0012, stage0_m: 0.0236, stage0_l: 0.2083, stage0_h: 0.5466, stage1_loss_instance_mil: 0.1608, stage1_bag_acc: 98.5855, stage1_neg_loss: 0.0586, stage1_mean_ious: 0.4936, stage1_s: 0.0009, stage1_m: 0.0223, stage1_l: 0.2087, stage1_h: 0.5249, loss: 0.2542, grad_norm: 11.2902
2024-04-20 06:58:46,711 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-20 07:02:37,501 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 1:38:08, time: 4.553, data_time: 0.433, memory: 17810, stage0_loss_instance_mil: 0.0316, stage0_bag_acc: 97.8991, stage0_mean_ious: 0.5308, stage0_s: 0.0000, stage0_m: 0.0667, stage0_l: 0.2254, stage0_h: 0.5737, stage1_loss_instance_mil: 0.1218, stage1_bag_acc: 97.9486, stage1_neg_loss: 0.0575, stage1_mean_ious: 0.5213, stage1_s: 0.0000, stage1_m: 0.0603, stage1_l: 0.2370, stage1_h: 0.5621, loss: 0.2110, grad_norm: 11.1363
2024-04-20 07:06:32,688 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 1:36:53, time: 4.703, data_time: 0.424, memory: 17810, stage0_loss_instance_mil: 0.0296, stage0_bag_acc: 98.0175, stage0_mean_ious: 0.5195, stage0_s: 0.0000, stage0_m: 0.0377, stage0_l: 0.1947, stage0_h: 0.5631, stage1_loss_instance_mil: 0.1096, stage1_bag_acc: 97.5826, stage1_neg_loss: 0.0515, stage1_mean_ious: 0.5149, stage1_s: 0.0000, stage1_m: 0.0420, stage1_l: 0.2081, stage1_h: 0.5549, loss: 0.1906, grad_norm: 9.0695
2024-04-20 07:09:56,605 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 1:34:09, time: 4.079, data_time: 0.321, memory: 17810, stage0_loss_instance_mil: 0.0272, stage0_bag_acc: 98.5549, stage0_mean_ious: 0.5274, stage0_s: 0.0000, stage0_m: 0.0356, stage0_l: 0.2375, stage0_h: 0.5624, stage1_loss_instance_mil: 0.0791, stage1_bag_acc: 98.6678, stage1_neg_loss: 0.0377, stage1_mean_ious: 0.5309, stage1_s: 0.0000, stage1_m: 0.0381, stage1_l: 0.2560, stage1_h: 0.5632, loss: 0.1439, grad_norm: 6.2137
2024-04-20 07:10:46,100 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-20 07:15:33,108 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 1:28:19, time: 5.675, data_time: 0.627, memory: 17810, stage0_loss_instance_mil: 0.0135, stage0_bag_acc: 99.4853, stage0_mean_ious: 0.5627, stage0_s: 0.0000, stage0_m: 0.0655, stage0_l: 0.2453, stage0_h: 0.5973, stage1_loss_instance_mil: 0.0694, stage1_bag_acc: 99.4710, stage1_neg_loss: 0.0339, stage1_mean_ious: 0.5608, stage1_s: 0.0000, stage1_m: 0.0757, stage1_l: 0.2756, stage1_h: 0.5907, loss: 0.1167, grad_norm: 5.6196
2024-04-20 07:20:05,738 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 1:27:22, time: 5.453, data_time: 0.487, memory: 17810, stage0_loss_instance_mil: 0.0320, stage0_bag_acc: 98.2149, stage0_mean_ious: 0.5574, stage0_s: 0.0000, stage0_m: 0.0356, stage0_l: 0.2751, stage0_h: 0.5918, stage1_loss_instance_mil: 0.0714, stage1_bag_acc: 98.5095, stage1_neg_loss: 0.0362, stage1_mean_ious: 0.5618, stage1_s: 0.0000, stage1_m: 0.0334, stage1_l: 0.3032, stage1_h: 0.5915, loss: 0.1396, grad_norm: 7.4838
2024-04-20 07:22:27,630 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 1:22:47, time: 2.838, data_time: 0.199, memory: 17810, stage0_loss_instance_mil: 0.0179, stage0_bag_acc: 98.7817, stage0_mean_ious: 0.5769, stage0_s: 0.0000, stage0_m: 0.0498, stage0_l: 0.3456, stage0_h: 0.6121, stage1_loss_instance_mil: 0.0573, stage1_bag_acc: 99.1461, stage1_neg_loss: 0.0330, stage1_mean_ious: 0.5757, stage1_s: 0.0000, stage1_m: 0.0649, stage1_l: 0.3714, stage1_h: 0.6054, loss: 0.1081, grad_norm: 4.8265
2024-04-20 07:24:21,530 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-20 07:29:28,302 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 1:17:15, time: 5.791, data_time: 0.780, memory: 17810, stage0_loss_instance_mil: 0.0092, stage0_bag_acc: 99.2866, stage0_mean_ious: 0.5733, stage0_s: 0.0000, stage0_m: 0.0543, stage0_l: 0.2859, stage0_h: 0.6087, stage1_loss_instance_mil: 0.0469, stage1_bag_acc: 99.5819, stage1_neg_loss: 0.0266, stage1_mean_ious: 0.5687, stage1_s: 0.0000, stage1_m: 0.0686, stage1_l: 0.3235, stage1_h: 0.5949, loss: 0.0826, grad_norm: 4.3104
2024-04-20 07:33:34,660 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 07:33:34,661 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 1:15:07, time: 4.927, data_time: 0.473, memory: 17810, stage0_loss_instance_mil: 0.0124, stage0_bag_acc: 99.4167, stage0_mean_ious: 0.5630, stage0_s: 0.0000, stage0_m: 0.0537, stage0_l: 0.2649, stage0_h: 0.6015, stage1_loss_instance_mil: 0.0663, stage1_bag_acc: 99.1666, stage1_neg_loss: 0.0298, stage1_mean_ious: 0.5582, stage1_s: 0.0000, stage1_m: 0.0652, stage1_l: 0.2761, stage1_h: 0.5918, loss: 0.1084, grad_norm: 5.8346
2024-04-20 07:36:02,047 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 1:11:03, time: 2.947, data_time: 0.214, memory: 17810, stage0_loss_instance_mil: 0.0139, stage0_bag_acc: 99.2085, stage0_mean_ious: 0.5676, stage0_s: 0.0000, stage0_m: 0.0631, stage0_l: 0.3225, stage0_h: 0.6037, stage1_loss_instance_mil: 0.0448, stage1_bag_acc: 99.6647, stage1_neg_loss: 0.0231, stage1_mean_ious: 0.5612, stage1_s: 0.0000, stage1_m: 0.0666, stage1_l: 0.3413, stage1_h: 0.5933, loss: 0.0818, grad_norm: 3.7158
2024-04-20 07:39:07,919 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-20 07:47:20,572 - mmdet - INFO - Evaluating bbox...
2024-04-20 07:47:34,163 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2791
2024-04-20 07:47:34,191 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6093
2024-04-20 07:47:34,192 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4660
2024-04-20 07:47:34,192 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.3102
2024-04-20 07:47:34,192 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2286
2024-04-20 07:47:34,199 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1426
2024-04-20 07:47:34,199 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0262
2024-04-20 07:47:34,211 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2933
2024-04-20 07:47:34,231 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2762
2024-04-20 07:47:34,251 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3654
2024-04-20 07:47:34,259 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3941
2024-04-20 07:47:34,259 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3941
2024-04-20 07:47:34,267 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3941
2024-04-20 07:47:34,267 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3379
2024-04-20 07:47:34,268 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3589
2024-04-20 07:47:34,287 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.5521
2024-04-20 07:47:34,867 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 07:47:34,871 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.2790, bbox_mAP_50: 0.6090, bbox_mAP_75: 0.4660, bbox_mAP_s: 0.3100, bbox_mAP_m: 0.2290, bbox_mAP_l: 0.1430, bbox_mAP_copypaste: 0.279 0.609 0.466 0.310 0.229 0.143
2024-04-20 07:52:28,423 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 1:05:43, time: 5.859, data_time: 0.969, memory: 17810, stage0_loss_instance_mil: 0.0071, stage0_bag_acc: 99.8824, stage0_mean_ious: 0.5839, stage0_s: 0.0000, stage0_m: 0.0572, stage0_l: 0.3122, stage0_h: 0.6202, stage1_loss_instance_mil: 0.0334, stage1_bag_acc: 99.7121, stage1_neg_loss: 0.0226, stage1_mean_ious: 0.5832, stage1_s: 0.0000, stage1_m: 0.0699, stage1_l: 0.3574, stage1_h: 0.6108, loss: 0.0631, grad_norm: 3.3546
2024-04-20 07:56:27,555 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 1:03:11, time: 4.783, data_time: 0.997, memory: 17810, stage0_loss_instance_mil: 0.0042, stage0_bag_acc: 99.8333, stage0_mean_ious: 0.5676, stage0_s: 0.0000, stage0_m: 0.0401, stage0_l: 0.3140, stage0_h: 0.6077, stage1_loss_instance_mil: 0.0474, stage1_bag_acc: 99.8947, stage1_neg_loss: 0.0248, stage1_mean_ious: 0.5637, stage1_s: 0.0000, stage1_m: 0.0480, stage1_l: 0.3476, stage1_h: 0.5971, loss: 0.0764, grad_norm: 4.2015
2024-04-20 07:58:05,713 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:58:46, time: 1.963, data_time: 0.093, memory: 17810, stage0_loss_instance_mil: 0.0178, stage0_bag_acc: 98.7934, stage0_mean_ious: 0.5729, stage0_s: 0.0012, stage0_m: 0.0692, stage0_l: 0.2945, stage0_h: 0.6017, stage1_loss_instance_mil: 0.0420, stage1_bag_acc: 99.2268, stage1_neg_loss: 0.0225, stage1_mean_ious: 0.5616, stage1_s: 0.0011, stage1_m: 0.0837, stage1_l: 0.3152, stage1_h: 0.5851, loss: 0.0823, grad_norm: 4.6490
2024-04-20 08:00:41,216 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-20 08:05:33,244 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:53:23, time: 5.454, data_time: 0.807, memory: 17810, stage0_loss_instance_mil: 0.0178, stage0_bag_acc: 98.8319, stage0_mean_ious: 0.5777, stage0_s: 0.0000, stage0_m: 0.0629, stage0_l: 0.3169, stage0_h: 0.6139, stage1_loss_instance_mil: 0.0487, stage1_bag_acc: 99.4216, stage1_neg_loss: 0.0292, stage1_mean_ious: 0.5722, stage1_s: 0.0000, stage1_m: 0.0652, stage1_l: 0.3542, stage1_h: 0.5995, loss: 0.0956, grad_norm: 4.7373
2024-04-20 08:08:55,392 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:50:22, time: 4.042, data_time: 0.463, memory: 17810, stage0_loss_instance_mil: 0.0128, stage0_bag_acc: 99.3614, stage0_mean_ious: 0.5866, stage0_s: 0.0000, stage0_m: 0.0382, stage0_l: 0.2715, stage0_h: 0.6091, stage1_loss_instance_mil: 0.0467, stage1_bag_acc: 99.5258, stage1_neg_loss: 0.0260, stage1_mean_ious: 0.5766, stage1_s: 0.0000, stage1_m: 0.0413, stage1_l: 0.2841, stage1_h: 0.5962, loss: 0.0855, grad_norm: 4.1824
2024-04-20 08:11:17,908 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:46:49, time: 2.849, data_time: 0.181, memory: 17810, stage0_loss_instance_mil: 0.0200, stage0_bag_acc: 98.5667, stage0_mean_ious: 0.6095, stage0_s: 0.0000, stage0_m: 0.0474, stage0_l: 0.2830, stage0_h: 0.6384, stage1_loss_instance_mil: 0.0544, stage1_bag_acc: 98.6371, stage1_neg_loss: 0.0273, stage1_mean_ious: 0.5970, stage1_s: 0.0000, stage1_m: 0.0585, stage1_l: 0.2996, stage1_h: 0.6216, loss: 0.1017, grad_norm: 5.1060
2024-04-20 08:14:17,942 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-20 08:19:30,076 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:41:47, time: 5.887, data_time: 0.943, memory: 17810, stage0_loss_instance_mil: 0.0078, stage0_bag_acc: 99.6762, stage0_mean_ious: 0.6285, stage0_s: 0.0000, stage0_m: 0.0531, stage0_l: 0.2897, stage0_h: 0.6590, stage1_loss_instance_mil: 0.0370, stage1_bag_acc: 99.8139, stage1_neg_loss: 0.0255, stage1_mean_ious: 0.6266, stage1_s: 0.0000, stage1_m: 0.0702, stage1_l: 0.3288, stage1_h: 0.6505, loss: 0.0704, grad_norm: 3.6152
2024-04-20 08:21:31,325 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:38:13, time: 2.425, data_time: 0.141, memory: 17810, stage0_loss_instance_mil: 0.0039, stage0_bag_acc: 99.9048, stage0_mean_ious: 0.6090, stage0_s: 0.0000, stage0_m: 0.0916, stage0_l: 0.3634, stage0_h: 0.6577, stage1_loss_instance_mil: 0.0383, stage1_bag_acc: 99.9048, stage1_neg_loss: 0.0177, stage1_mean_ious: 0.6038, stage1_s: 0.0000, stage1_m: 0.1145, stage1_l: 0.4081, stage1_h: 0.6422, loss: 0.0599, grad_norm: 2.9900
2024-04-20 08:25:42,908 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:35:32, time: 5.031, data_time: 0.462, memory: 17810, stage0_loss_instance_mil: 0.0057, stage0_bag_acc: 99.7895, stage0_mean_ious: 0.6053, stage0_s: 0.0012, stage0_m: 0.0292, stage0_l: 0.3208, stage0_h: 0.6405, stage1_loss_instance_mil: 0.0334, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0189, stage1_mean_ious: 0.6030, stage1_s: 0.0009, stage1_m: 0.0269, stage1_l: 0.3809, stage1_h: 0.6294, loss: 0.0580, grad_norm: 2.8619
2024-04-20 08:28:16,912 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-20 08:32:25,361 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:30:11, time: 4.502, data_time: 0.457, memory: 17810, stage0_loss_instance_mil: 0.0042, stage0_bag_acc: 99.7238, stage0_mean_ious: 0.6079, stage0_s: 0.0000, stage0_m: 0.0614, stage0_l: 0.3150, stage0_h: 0.6476, stage1_loss_instance_mil: 0.0313, stage1_bag_acc: 99.9200, stage1_neg_loss: 0.0200, stage1_mean_ious: 0.5958, stage1_s: 0.0000, stage1_m: 0.0659, stage1_l: 0.3456, stage1_h: 0.6278, loss: 0.0555, grad_norm: 3.0506
2024-04-20 08:34:27,525 - mmdet - INFO - Epoch [10][100/180]	lr: 5.000e-06, eta: 0:26:50, time: 2.442, data_time: 0.152, memory: 17810, stage0_loss_instance_mil: 0.0035, stage0_bag_acc: 99.7238, stage0_mean_ious: 0.6062, stage0_s: 0.0000, stage0_m: 0.0320, stage0_l: 0.3100, stage0_h: 0.6373, stage1_loss_instance_mil: 0.0340, stage1_bag_acc: 99.7738, stage1_neg_loss: 0.0166, stage1_mean_ious: 0.6015, stage1_s: 0.0000, stage1_m: 0.0420, stage1_l: 0.3528, stage1_h: 0.6237, loss: 0.0542, grad_norm: 2.7212
2024-04-20 08:39:12,411 - mmdet - INFO - Epoch [10][150/180]	lr: 5.000e-06, eta: 0:24:09, time: 5.699, data_time: 0.709, memory: 17810, stage0_loss_instance_mil: 0.0042, stage0_bag_acc: 99.6226, stage0_mean_ious: 0.5959, stage0_s: 0.0000, stage0_m: 0.0377, stage0_l: 0.2887, stage0_h: 0.6342, stage1_loss_instance_mil: 0.0306, stage1_bag_acc: 99.7226, stage1_neg_loss: 0.0148, stage1_mean_ious: 0.5881, stage1_s: 0.0000, stage1_m: 0.0460, stage1_l: 0.3062, stage1_h: 0.6196, loss: 0.0495, grad_norm: 2.5366
2024-04-20 08:41:50,582 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-04-20 08:44:46,642 - mmdet - INFO - Epoch [11][50/180]	lr: 5.000e-06, eta: 0:18:48, time: 3.136, data_time: 0.348, memory: 17810, stage0_loss_instance_mil: 0.0025, stage0_bag_acc: 99.8947, stage0_mean_ious: 0.5983, stage0_s: 0.0000, stage0_m: 0.0933, stage0_l: 0.3623, stage0_h: 0.6397, stage1_loss_instance_mil: 0.0310, stage1_bag_acc: 99.8947, stage1_neg_loss: 0.0217, stage1_mean_ious: 0.6031, stage1_s: 0.0000, stage1_m: 0.1112, stage1_l: 0.4167, stage1_h: 0.6352, loss: 0.0552, grad_norm: 2.9305
2024-04-20 08:47:58,695 - mmdet - INFO - Epoch [11][100/180]	lr: 5.000e-06, eta: 0:15:48, time: 3.841, data_time: 0.272, memory: 17810, stage0_loss_instance_mil: 0.0079, stage0_bag_acc: 99.6619, stage0_mean_ious: 0.6011, stage0_s: 0.0012, stage0_m: 0.0813, stage0_l: 0.3171, stage0_h: 0.6478, stage1_loss_instance_mil: 0.0285, stage1_bag_acc: 99.7619, stage1_neg_loss: 0.0189, stage1_mean_ious: 0.5906, stage1_s: 0.0009, stage1_m: 0.0949, stage1_l: 0.3521, stage1_h: 0.6271, loss: 0.0552, grad_norm: 2.8699
2024-04-20 08:51:34,162 - mmdet - INFO - Epoch [11][150/180]	lr: 5.000e-06, eta: 0:12:49, time: 4.310, data_time: 0.353, memory: 17810, stage0_loss_instance_mil: 0.0034, stage0_bag_acc: 99.9091, stage0_mean_ious: 0.6151, stage0_s: 0.0000, stage0_m: 0.0498, stage0_l: 0.3596, stage0_h: 0.6437, stage1_loss_instance_mil: 0.0261, stage1_bag_acc: 100.0000, stage1_neg_loss: 0.0147, stage1_mean_ious: 0.6118, stage1_s: 0.0000, stage1_m: 0.0678, stage1_l: 0.3956, stage1_h: 0.6327, loss: 0.0442, grad_norm: 2.4995
2024-04-20 08:53:36,292 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-04-20 08:56:33,442 - mmdet - INFO - Epoch [12][50/180]	lr: 5.000e-07, eta: 0:07:48, time: 3.311, data_time: 0.328, memory: 17810, stage0_loss_instance_mil: 0.0061, stage0_bag_acc: 99.8397, stage0_mean_ious: 0.6098, stage0_s: 0.0000, stage0_m: 0.0879, stage0_l: 0.2988, stage0_h: 0.6469, stage1_loss_instance_mil: 0.0307, stage1_bag_acc: 99.9231, stage1_neg_loss: 0.0188, stage1_mean_ious: 0.6046, stage1_s: 0.0000, stage1_m: 0.0997, stage1_l: 0.3379, stage1_h: 0.6337, loss: 0.0557, grad_norm: 2.8443
2024-04-20 09:00:01,726 - mmdet - INFO - Epoch [12][100/180]	lr: 5.000e-07, eta: 0:04:49, time: 4.165, data_time: 0.327, memory: 17810, stage0_loss_instance_mil: 0.0026, stage0_bag_acc: 99.8307, stage0_mean_ious: 0.6124, stage0_s: 0.0000, stage0_m: 0.0383, stage0_l: 0.3565, stage0_h: 0.6454, stage1_loss_instance_mil: 0.0295, stage1_bag_acc: 99.9259, stage1_neg_loss: 0.0162, stage1_mean_ious: 0.6073, stage1_s: 0.0000, stage1_m: 0.0440, stage1_l: 0.3935, stage1_h: 0.6339, loss: 0.0483, grad_norm: 2.6302
2024-04-20 09:04:25,481 - mmdet - INFO - Epoch [12][150/180]	lr: 5.000e-07, eta: 0:01:49, time: 5.275, data_time: 0.417, memory: 17810, stage0_loss_instance_mil: 0.0049, stage0_bag_acc: 99.6639, stage0_mean_ious: 0.6017, stage0_s: 0.0000, stage0_m: 0.0702, stage0_l: 0.3339, stage0_h: 0.6330, stage1_loss_instance_mil: 0.0367, stage1_bag_acc: 99.6639, stage1_neg_loss: 0.0155, stage1_mean_ious: 0.5921, stage1_s: 0.0000, stage1_m: 0.0863, stage1_l: 0.3738, stage1_h: 0.6143, loss: 0.0571, grad_norm: 2.7577
2024-04-20 09:06:48,763 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-04-20 09:14:43,844 - mmdet - INFO - Evaluating bbox...
2024-04-20 09:14:54,076 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3073
2024-04-20 09:14:54,083 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6829
2024-04-20 09:14:54,099 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.5361
2024-04-20 09:14:54,114 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.3323
2024-04-20 09:14:54,121 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2352
2024-04-20 09:14:54,127 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1324
2024-04-20 09:14:54,133 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0304
2024-04-20 09:14:54,135 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2992
2024-04-20 09:14:54,146 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3027
2024-04-20 09:14:54,161 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3636
2024-04-20 09:14:54,167 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.4227
2024-04-20 09:14:54,178 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.4227
2024-04-20 09:14:54,183 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.4227
2024-04-20 09:14:54,185 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3498
2024-04-20 09:14:54,195 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3909
2024-04-20 09:14:54,210 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.5290
2024-04-20 09:14:55,000 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 09:14:55,026 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.3070, bbox_mAP_50: 0.6830, bbox_mAP_75: 0.5360, bbox_mAP_s: 0.3320, bbox_mAP_m: 0.2350, bbox_mAP_l: 0.1320, bbox_mAP_copypaste: 0.307 0.683 0.536 0.332 0.235 0.132
2024-04-20 09:23:05,611 - mmdet - INFO - Evaluating bbox...
2024-04-20 09:23:21,110 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3073
2024-04-20 09:23:21,110 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6829
2024-04-20 09:23:21,111 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.5361
2024-04-20 09:23:21,111 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.3323
2024-04-20 09:23:21,111 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2352
2024-04-20 09:23:21,112 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1324
2024-04-20 09:23:21,112 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0304
2024-04-20 09:23:21,112 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2992
2024-04-20 09:23:21,113 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3027
2024-04-20 09:23:21,113 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3636
2024-04-20 09:23:21,113 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.4227
2024-04-20 09:23:21,114 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.4227
2024-04-20 09:23:21,114 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.4227
2024-04-20 09:23:21,114 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3498
2024-04-20 09:23:21,114 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3909
2024-04-20 09:23:21,114 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.5290
2024-04-20 09:23:48,244 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+c820f32
------------------------------------------------------------

2024-04-20 09:24:08,172 - mmdet - INFO - Distributed training: False
2024-04-20 09:24:29,532 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=6,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [3]

2024-04-20 09:24:58,266 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-04-20 09:24:58,266 - mmdet - INFO - Use load_from_local loader
2024-04-20 09:25:01,091 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-04-20 09:25:01,370 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-04-20 09:25:01,431 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-04-20 09:30:19,424 - mmdet - INFO - Epoch [1][50/180]	lr: 4.945e-06, eta: 3:43:34, time: 6.358, data_time: 0.720, memory: 17810, stage0_loss_instance_mil: 0.7552, stage0_bag_acc: 3.7157, stage0_mean_ious: 0.4407, stage0_s: 0.0000, stage0_m: 0.0558, stage0_l: 0.2181, stage0_h: 0.4600, stage1_loss_instance_mil: 0.1507, stage1_bag_acc: 29.2237, stage1_neg_loss: 0.0009, stage1_mean_ious: 0.4105, stage1_s: 0.0000, stage1_m: 0.0524, stage1_l: 0.2083, stage1_h: 0.4278, loss: 0.9068, grad_norm: 3.4967
2024-04-20 09:32:21,842 - mmdet - INFO - Epoch [1][100/180]	lr: 9.940e-06, eta: 2:31:11, time: 2.449, data_time: 0.138, memory: 17810, stage0_loss_instance_mil: 0.5967, stage0_bag_acc: 58.7092, stage0_mean_ious: 0.4591, stage0_s: 0.0000, stage0_m: 0.0395, stage0_l: 0.2769, stage0_h: 0.4802, stage1_loss_instance_mil: 0.2391, stage1_bag_acc: 23.8605, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.4347, stage1_s: 0.0000, stage1_m: 0.0382, stage1_l: 0.2653, stage1_h: 0.4559, loss: 0.8384, grad_norm: 3.4796
2024-04-20 09:36:34,943 - mmdet - INFO - Epoch [1][150/180]	lr: 1.494e-05, eta: 2:34:52, time: 5.062, data_time: 0.452, memory: 17810, stage0_loss_instance_mil: 0.2821, stage0_bag_acc: 83.1155, stage0_mean_ious: 0.4298, stage0_s: 0.0000, stage0_m: 0.0300, stage0_l: 0.2712, stage0_h: 0.4524, stage1_loss_instance_mil: 0.3071, stage1_bag_acc: 73.0372, stage1_neg_loss: 0.0581, stage1_mean_ious: 0.4062, stage1_s: 0.0000, stage1_m: 0.0287, stage1_l: 0.2459, stage1_h: 0.4290, loss: 0.6474, grad_norm: 8.7189
2024-04-20 09:39:12,935 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-04-20 09:42:58,864 - mmdet - INFO - Epoch [2][50/180]	lr: 2.293e-05, eta: 2:07:05, time: 4.305, data_time: 0.465, memory: 17810, stage0_loss_instance_mil: 0.0802, stage0_bag_acc: 96.4101, stage0_mean_ious: 0.4333, stage0_s: 0.0000, stage0_m: 0.0424, stage0_l: 0.2151, stage0_h: 0.4648, stage1_loss_instance_mil: 0.3018, stage1_bag_acc: 97.2544, stage1_neg_loss: 0.0891, stage1_mean_ious: 0.4007, stage1_s: 0.0000, stage1_m: 0.0340, stage1_l: 0.2161, stage1_h: 0.4267, loss: 0.4711, grad_norm: 12.3306
2024-04-20 09:44:37,246 - mmdet - INFO - Epoch [2][100/180]	lr: 2.792e-05, eta: 1:52:41, time: 1.968, data_time: 0.065, memory: 17810, stage0_loss_instance_mil: 0.0658, stage0_bag_acc: 96.8458, stage0_mean_ious: 0.4476, stage0_s: 0.0000, stage0_m: 0.0466, stage0_l: 0.1980, stage0_h: 0.4861, stage1_loss_instance_mil: 0.2618, stage1_bag_acc: 98.1235, stage1_neg_loss: 0.0681, stage1_mean_ious: 0.4151, stage1_s: 0.0000, stage1_m: 0.0350, stage1_l: 0.2071, stage1_h: 0.4479, loss: 0.3957, grad_norm: 9.8214
2024-04-20 09:49:05,799 - mmdet - INFO - Epoch [2][150/180]	lr: 3.292e-05, eta: 1:57:53, time: 5.370, data_time: 0.451, memory: 17810, stage0_loss_instance_mil: 0.0495, stage0_bag_acc: 97.8088, stage0_mean_ious: 0.4602, stage0_s: 0.0000, stage0_m: 0.0363, stage0_l: 0.1535, stage0_h: 0.4966, stage1_loss_instance_mil: 0.2814, stage1_bag_acc: 98.5337, stage1_neg_loss: 0.0917, stage1_mean_ious: 0.4257, stage1_s: 0.0000, stage1_m: 0.0260, stage1_l: 0.1452, stage1_h: 0.4589, loss: 0.4227, grad_norm: 15.0881
2024-04-20 09:51:37,435 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-04-20 09:55:20,092 - mmdet - INFO - Epoch [3][50/180]	lr: 4.091e-05, eta: 1:45:02, time: 4.020, data_time: 0.434, memory: 17810, stage0_loss_instance_mil: 0.0553, stage0_bag_acc: 96.6760, stage0_mean_ious: 0.4775, stage0_s: 0.0000, stage0_m: 0.0471, stage0_l: 0.2021, stage0_h: 0.5125, stage1_loss_instance_mil: 0.2229, stage1_bag_acc: 97.5338, stage1_neg_loss: 0.0744, stage1_mean_ious: 0.4402, stage1_s: 0.0000, stage1_m: 0.0371, stage1_l: 0.1974, stage1_h: 0.4725, loss: 0.3526, grad_norm: 10.9155
2024-04-20 09:58:03,985 - mmdet - INFO - Epoch [3][100/180]	lr: 4.590e-05, eta: 1:41:01, time: 3.272, data_time: 0.227, memory: 17810, stage0_loss_instance_mil: 0.0338, stage0_bag_acc: 97.6570, stage0_mean_ious: 0.4743, stage0_s: 0.0000, stage0_m: 0.0242, stage0_l: 0.2139, stage0_h: 0.5193, stage1_loss_instance_mil: 0.1882, stage1_bag_acc: 99.1851, stage1_neg_loss: 0.0736, stage1_mean_ious: 0.4474, stage1_s: 0.0000, stage1_m: 0.0226, stage1_l: 0.2090, stage1_h: 0.4885, loss: 0.2957, grad_norm: 13.0405
2024-04-20 10:02:33,095 - mmdet - INFO - Epoch [3][150/180]	lr: 5.000e-05, eta: 1:42:58, time: 5.388, data_time: 0.401, memory: 17810, stage0_loss_instance_mil: 0.0330, stage0_bag_acc: 98.0644, stage0_mean_ious: 0.5108, stage0_s: 0.0000, stage0_m: 0.0407, stage0_l: 0.2020, stage0_h: 0.5560, stage1_loss_instance_mil: 0.1888, stage1_bag_acc: 98.5550, stage1_neg_loss: 0.0602, stage1_mean_ious: 0.4839, stage1_s: 0.0000, stage1_m: 0.0257, stage1_l: 0.2023, stage1_h: 0.5274, loss: 0.2821, grad_norm: 13.5998
2024-04-20 10:05:05,612 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-04-20 10:07:44,440 - mmdet - INFO - Epoch [4][50/180]	lr: 5.000e-05, eta: 1:30:52, time: 2.787, data_time: 0.288, memory: 17810, stage0_loss_instance_mil: 0.0491, stage0_bag_acc: 97.3682, stage0_mean_ious: 0.5131, stage0_s: 0.0000, stage0_m: 0.0213, stage0_l: 0.2128, stage0_h: 0.5339, stage1_loss_instance_mil: 0.1490, stage1_bag_acc: 97.4840, stage1_neg_loss: 0.0557, stage1_mean_ious: 0.4925, stage1_s: 0.0000, stage1_m: 0.0156, stage1_l: 0.2133, stage1_h: 0.5109, loss: 0.2538, grad_norm: 11.2624
2024-04-20 10:11:43,431 - mmdet - INFO - Epoch [4][100/180]	lr: 5.000e-05, eta: 1:30:33, time: 4.779, data_time: 0.383, memory: 17810, stage0_loss_instance_mil: 0.0239, stage0_bag_acc: 98.7512, stage0_mean_ious: 0.5042, stage0_s: 0.0000, stage0_m: 0.0469, stage0_l: 0.1964, stage0_h: 0.5417, stage1_loss_instance_mil: 0.1489, stage1_bag_acc: 99.2820, stage1_neg_loss: 0.0625, stage1_mean_ious: 0.4812, stage1_s: 0.0000, stage1_m: 0.0348, stage1_l: 0.1945, stage1_h: 0.5162, loss: 0.2352, grad_norm: 11.8514
2024-04-20 10:16:10,111 - mmdet - INFO - Epoch [4][150/180]	lr: 5.000e-05, eta: 1:30:42, time: 5.333, data_time: 0.492, memory: 17810, stage0_loss_instance_mil: 0.0317, stage0_bag_acc: 98.0841, stage0_mean_ious: 0.4640, stage0_s: 0.0012, stage0_m: 0.0459, stage0_l: 0.2233, stage0_h: 0.5060, stage1_loss_instance_mil: 0.1319, stage1_bag_acc: 98.6544, stage1_neg_loss: 0.0582, stage1_mean_ious: 0.4432, stage1_s: 0.0011, stage1_m: 0.0409, stage1_l: 0.2184, stage1_h: 0.4836, loss: 0.2218, grad_norm: 9.8419
2024-04-20 10:18:23,417 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-04-20 10:20:29,912 - mmdet - INFO - Epoch [5][50/180]	lr: 5.000e-05, eta: 1:20:25, time: 2.376, data_time: 0.203, memory: 17810, stage0_loss_instance_mil: 0.0143, stage0_bag_acc: 99.3182, stage0_mean_ious: 0.4795, stage0_s: 0.0000, stage0_m: 0.0419, stage0_l: 0.1787, stage0_h: 0.5146, stage1_loss_instance_mil: 0.1112, stage1_bag_acc: 99.1125, stage1_neg_loss: 0.0493, stage1_mean_ious: 0.4535, stage1_s: 0.0000, stage1_m: 0.0308, stage1_l: 0.1683, stage1_h: 0.4884, loss: 0.1749, grad_norm: 10.0726
2024-04-20 10:24:32,042 - mmdet - INFO - Epoch [5][100/180]	lr: 5.000e-05, eta: 1:19:24, time: 4.843, data_time: 0.434, memory: 17810, stage0_loss_instance_mil: 0.0201, stage0_bag_acc: 98.9621, stage0_mean_ious: 0.5168, stage0_s: 0.0000, stage0_m: 0.0374, stage0_l: 0.2220, stage0_h: 0.5512, stage1_loss_instance_mil: 0.1227, stage1_bag_acc: 98.5413, stage1_neg_loss: 0.0512, stage1_mean_ious: 0.4927, stage1_s: 0.0000, stage1_m: 0.0363, stage1_l: 0.2203, stage1_h: 0.5249, loss: 0.1941, grad_norm: 8.7903
2024-04-20 10:27:54,819 - mmdet - INFO - Epoch [5][150/180]	lr: 5.000e-05, eta: 1:17:03, time: 4.055, data_time: 0.328, memory: 17810, stage0_loss_instance_mil: 0.0121, stage0_bag_acc: 99.3354, stage0_mean_ious: 0.4996, stage0_s: 0.0000, stage0_m: 0.0297, stage0_l: 0.2071, stage0_h: 0.5378, stage1_loss_instance_mil: 0.0995, stage1_bag_acc: 99.3751, stage1_neg_loss: 0.0411, stage1_mean_ious: 0.4791, stage1_s: 0.0000, stage1_m: 0.0200, stage1_l: 0.1929, stage1_h: 0.5177, loss: 0.1527, grad_norm: 7.5137
2024-04-20 10:29:57,638 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-04-20 10:31:44,025 - mmdet - INFO - Epoch [6][50/180]	lr: 5.000e-05, eta: 1:08:15, time: 1.952, data_time: 0.166, memory: 17810, stage0_loss_instance_mil: 0.0086, stage0_bag_acc: 99.5634, stage0_mean_ious: 0.5256, stage0_s: 0.0000, stage0_m: 0.0346, stage0_l: 0.2151, stage0_h: 0.5633, stage1_loss_instance_mil: 0.0837, stage1_bag_acc: 99.5786, stage1_neg_loss: 0.0451, stage1_mean_ious: 0.5064, stage1_s: 0.0000, stage1_m: 0.0234, stage1_l: 0.2113, stage1_h: 0.5448, loss: 0.1373, grad_norm: 8.9029
2024-04-20 10:35:51,895 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 10:35:51,896 - mmdet - INFO - Epoch [6][100/180]	lr: 5.000e-05, eta: 1:06:57, time: 4.958, data_time: 0.435, memory: 17810, stage0_loss_instance_mil: 0.0120, stage0_bag_acc: 99.4203, stage0_mean_ious: 0.5411, stage0_s: 0.0000, stage0_m: 0.0291, stage0_l: 0.2191, stage0_h: 0.5821, stage1_loss_instance_mil: 0.0977, stage1_bag_acc: 99.3570, stage1_neg_loss: 0.0422, stage1_mean_ious: 0.5111, stage1_s: 0.0000, stage1_m: 0.0201, stage1_l: 0.2133, stage1_h: 0.5499, loss: 0.1520, grad_norm: 8.5754
2024-04-20 10:40:19,114 - mmdet - INFO - Epoch [6][150/180]	lr: 5.000e-05, eta: 1:05:44, time: 5.344, data_time: 0.452, memory: 17810, stage0_loss_instance_mil: 0.0171, stage0_bag_acc: 98.7587, stage0_mean_ious: 0.5247, stage0_s: 0.0000, stage0_m: 0.0475, stage0_l: 0.1819, stage0_h: 0.5719, stage1_loss_instance_mil: 0.0904, stage1_bag_acc: 98.6104, stage1_neg_loss: 0.0432, stage1_mean_ious: 0.4914, stage1_s: 0.0000, stage1_m: 0.0450, stage1_l: 0.1727, stage1_h: 0.5349, loss: 0.1507, grad_norm: 8.2181
2024-04-20 10:42:23,511 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-04-20 10:50:29,046 - mmdet - INFO - Evaluating bbox...
2024-04-20 10:50:48,391 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2611
2024-04-20 10:50:48,392 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5635
2024-04-20 10:50:48,392 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4442
2024-04-20 10:50:48,393 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.2959
2024-04-20 10:50:48,393 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.2168
2024-04-20 10:50:48,393 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.1390
2024-04-20 10:50:48,393 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0198
2024-04-20 10:50:48,394 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2964
2024-04-20 10:50:48,394 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2272
2024-04-20 10:50:48,395 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2903
2024-04-20 10:50:48,395 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3511
2024-04-20 10:50:48,395 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3511
2024-04-20 10:50:48,395 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3511
2024-04-20 10:50:48,396 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3237
2024-04-20 10:50:48,396 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3093
2024-04-20 10:50:48,396 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.3715
2024-04-20 10:50:48,450 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-04-20 10:50:48,451 - mmdet - INFO - Epoch(val) [6][180]	eval_iter_num: 90, bbox_mAP: 0.2610, bbox_mAP_50: 0.5630, bbox_mAP_75: 0.4440, bbox_mAP_s: 0.2960, bbox_mAP_m: 0.2170, bbox_mAP_l: 0.1390, bbox_mAP_copypaste: 0.261 0.563 0.444 0.296 0.217 0.139
2024-04-20 10:54:12,445 - mmdet - INFO - Epoch [7][50/180]	lr: 5.000e-05, eta: 0:59:46, time: 4.079, data_time: 0.450, memory: 17810, stage0_loss_instance_mil: 0.0156, stage0_bag_acc: 98.9974, stage0_mean_ious: 0.5653, stage0_s: 0.0000, stage0_m: 0.0427, stage0_l: 0.2167, stage0_h: 0.6151, stage1_loss_instance_mil: 0.0867, stage1_bag_acc: 99.4412, stage1_neg_loss: 0.0433, stage1_mean_ious: 0.5212, stage1_s: 0.0000, stage1_m: 0.0356, stage1_l: 0.2060, stage1_h: 0.5654, loss: 0.1456, grad_norm: 7.5120
2024-04-20 10:56:16,200 - mmdet - INFO - Epoch [7][100/180]	lr: 5.000e-05, eta: 0:56:10, time: 2.474, data_time: 0.126, memory: 17810, stage0_loss_instance_mil: 0.0136, stage0_bag_acc: 99.2238, stage0_mean_ious: 0.5666, stage0_s: 0.0000, stage0_m: 0.0302, stage0_l: 0.2350, stage0_h: 0.6164, stage1_loss_instance_mil: 0.0700, stage1_bag_acc: 98.9641, stage1_neg_loss: 0.0338, stage1_mean_ious: 0.5281, stage1_s: 0.0000, stage1_m: 0.0223, stage1_l: 0.2305, stage1_h: 0.5730, loss: 0.1175, grad_norm: 6.7123
2024-04-20 11:01:17,050 - mmdet - INFO - Epoch [7][150/180]	lr: 5.000e-05, eta: 0:54:56, time: 6.018, data_time: 0.555, memory: 17810, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.6032, stage0_mean_ious: 0.5473, stage0_s: 0.0000, stage0_m: 0.0300, stage0_l: 0.1840, stage0_h: 0.5889, stage1_loss_instance_mil: 0.0736, stage1_bag_acc: 99.3143, stage1_neg_loss: 0.0335, stage1_mean_ious: 0.5303, stage1_s: 0.0000, stage1_m: 0.0197, stage1_l: 0.1867, stage1_h: 0.5715, loss: 0.1180, grad_norm: 7.0136
2024-04-20 11:03:40,652 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-04-20 11:06:31,646 - mmdet - INFO - Epoch [8][50/180]	lr: 5.000e-05, eta: 0:48:49, time: 3.108, data_time: 0.294, memory: 17810, stage0_loss_instance_mil: 0.0050, stage0_bag_acc: 99.7895, stage0_mean_ious: 0.5273, stage0_s: 0.0000, stage0_m: 0.0279, stage0_l: 0.2183, stage0_h: 0.5664, stage1_loss_instance_mil: 0.0700, stage1_bag_acc: 99.7547, stage1_neg_loss: 0.0335, stage1_mean_ious: 0.5066, stage1_s: 0.0000, stage1_m: 0.0229, stage1_l: 0.2181, stage1_h: 0.5428, loss: 0.1084, grad_norm: 5.7146
2024-04-20 11:09:51,132 - mmdet - INFO - Epoch [8][100/180]	lr: 5.000e-05, eta: 0:46:13, time: 3.988, data_time: 0.367, memory: 17810, stage0_loss_instance_mil: 0.0113, stage0_bag_acc: 99.5766, stage0_mean_ious: 0.4975, stage0_s: 0.0000, stage0_m: 0.0483, stage0_l: 0.1675, stage0_h: 0.5470, stage1_loss_instance_mil: 0.0817, stage1_bag_acc: 99.4657, stage1_neg_loss: 0.0397, stage1_mean_ious: 0.4711, stage1_s: 0.0000, stage1_m: 0.0325, stage1_l: 0.1663, stage1_h: 0.5176, loss: 0.1327, grad_norm: 7.8103
2024-04-20 11:14:47,462 - mmdet - INFO - Epoch [8][150/180]	lr: 5.000e-05, eta: 0:44:25, time: 5.927, data_time: 0.610, memory: 17810, stage0_loss_instance_mil: 0.0086, stage0_bag_acc: 99.5166, stage0_mean_ious: 0.5182, stage0_s: 0.0000, stage0_m: 0.0199, stage0_l: 0.1816, stage0_h: 0.5547, stage1_loss_instance_mil: 0.0700, stage1_bag_acc: 99.4164, stage1_neg_loss: 0.0384, stage1_mean_ious: 0.4879, stage1_s: 0.0000, stage1_m: 0.0132, stage1_l: 0.1885, stage1_h: 0.5218, loss: 0.1171, grad_norm: 6.9132
2024-04-20 11:17:16,822 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-04-20 11:18:59,977 - mmdet - INFO - Epoch [9][50/180]	lr: 5.000e-06, eta: 0:38:18, time: 2.002, data_time: 0.188, memory: 17810, stage0_loss_instance_mil: 0.0051, stage0_bag_acc: 99.7043, stage0_mean_ious: 0.5120, stage0_s: 0.0000, stage0_m: 0.0342, stage0_l: 0.2129, stage0_h: 0.5542, stage1_loss_instance_mil: 0.0640, stage1_bag_acc: 99.6234, stage1_neg_loss: 0.0368, stage1_mean_ious: 0.4778, stage1_s: 0.0000, stage1_m: 0.0269, stage1_l: 0.2027, stage1_h: 0.5171, loss: 0.1059, grad_norm: 5.8127
2024-04-20 11:23:27,054 - mmdet - INFO - Epoch [9][100/180]	lr: 5.000e-06, eta: 0:36:05, time: 5.342, data_time: 0.442, memory: 17810, stage0_loss_instance_mil: 0.0039, stage0_bag_acc: 99.6880, stage0_mean_ious: 0.5319, stage0_s: 0.0000, stage0_m: 0.0315, stage0_l: 0.1972, stage0_h: 0.5851, stage1_loss_instance_mil: 0.0651, stage1_bag_acc: 99.6238, stage1_neg_loss: 0.0333, stage1_mean_ious: 0.4938, stage1_s: 0.0000, stage1_m: 0.0237, stage1_l: 0.1926, stage1_h: 0.5421, loss: 0.1022, grad_norm: 5.0370
2024-04-20 11:27:55,913 - mmdet - INFO - Epoch [9][150/180]	lr: 5.000e-06, eta: 0:33:44, time: 5.376, data_time: 0.514, memory: 17810, stage0_loss_instance_mil: 0.0076, stage0_bag_acc: 99.6086, stage0_mean_ious: 0.5191, stage0_s: 0.0017, stage0_m: 0.0424, stage0_l: 0.2172, stage0_h: 0.5740, stage1_loss_instance_mil: 0.0579, stage1_bag_acc: 99.6216, stage1_neg_loss: 0.0289, stage1_mean_ious: 0.4899, stage1_s: 0.0019, stage1_m: 0.0332, stage1_l: 0.2167, stage1_h: 0.5409, loss: 0.0944, grad_norm: 4.6745
2024-04-20 11:29:47,966 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-04-20 11:32:16,210 - mmdet - INFO - Epoch [10][50/180]	lr: 5.000e-06, eta: 0:28:19, time: 2.906, data_time: 0.243, memory: 17810, stage0_loss_instance_mil: 0.0021, stage0_bag_acc: 100.0000, stage0_mean_ious: 0.5223, stage0_s: 0.0000, stage0_m: 0.0397, stage0_l: 0.2432, stage0_h: 0.5651, stage1_loss_instance_mil: 0.0493, stage1_bag_acc: 99.7381, stage1_neg_loss: 0.0305, stage1_mean_ious: 0.4843, stage1_s: 0.0000, stage1_m: 0.0293, stage1_l: 0.2378, stage1_h: 0.5226, loss: 0.0819, grad_norm: 4.6776
