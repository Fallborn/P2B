2024-10-07 22:45:50,576 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+963dd25
------------------------------------------------------------

2024-10-07 22:45:52,327 - mmdet - INFO - Distributed training: False
2024-10-07 22:45:53,980 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=18)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=12,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-07 22:45:58,364 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-07 22:45:58,365 - mmdet - INFO - Use load_from_local loader
2024-10-07 22:45:58,683 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-07 22:45:58,690 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-07 22:45:58,690 - mmdet - INFO - workflow: [('train', 1)], max: 18 epochs
2024-10-07 22:47:14,997 - mmdet - INFO - Epoch [1][50/180]	lr: 1.978e-03, eta: 1:21:08, time: 1.526, data_time: 0.079, memory: 16718, stage0_loss_instance_mil: 0.6187, stage0_bag_acc: 36.4395, stage0_mean_ious: 0.3332, stage0_s: 0.0000, stage0_m: 0.0432, stage0_l: 0.1929, stage0_h: 0.3443, stage1_loss_instance_mil: 0.1901, stage1_bag_acc: 25.3377, stage1_neg_loss: 0.0130, stage1_mean_ious: 0.3116, stage1_s: 0.0000, stage1_m: 0.0415, stage1_l: 0.1857, stage1_h: 0.3220, loss: 0.8218, grad_norm: 3.7881
2024-10-07 22:48:28,112 - mmdet - INFO - Epoch [1][100/180]	lr: 3.976e-03, eta: 1:18:11, time: 1.462, data_time: 0.030, memory: 16718, stage0_loss_instance_mil: 0.3957, stage0_bag_acc: 64.7141, stage0_mean_ious: 0.4275, stage0_s: 0.0000, stage0_m: 0.0441, stage0_l: 0.2800, stage0_h: 0.4421, stage1_loss_instance_mil: 0.3010, stage1_bag_acc: 55.3394, stage1_neg_loss: 0.0447, stage1_mean_ious: 0.4198, stage1_s: 0.0000, stage1_m: 0.0514, stage1_l: 0.2801, stage1_h: 0.4316, loss: 0.7414, grad_norm: 6.4338
2024-10-07 22:49:40,356 - mmdet - INFO - Epoch [1][150/180]	lr: 5.974e-03, eta: 1:16:06, time: 1.445, data_time: 0.032, memory: 16718, stage0_loss_instance_mil: 0.2558, stage0_bag_acc: 80.7689, stage0_mean_ious: 0.4136, stage0_s: 0.0000, stage0_m: 0.0438, stage0_l: 0.2889, stage0_h: 0.4233, stage1_loss_instance_mil: 0.3624, stage1_bag_acc: 70.3869, stage1_neg_loss: 0.0872, stage1_mean_ious: 0.4291, stage1_s: 0.0000, stage1_m: 0.0507, stage1_l: 0.3079, stage1_h: 0.4370, loss: 0.7054, grad_norm: 7.7989
2024-10-07 22:50:24,264 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-07 22:51:39,165 - mmdet - INFO - Epoch [2][50/180]	lr: 9.171e-03, eta: 1:04:20, time: 1.467, data_time: 0.081, memory: 16718, stage0_loss_instance_mil: 0.2994, stage0_bag_acc: 78.7270, stage0_mean_ious: 0.3211, stage0_s: 0.0014, stage0_m: 0.0720, stage0_l: 0.2776, stage0_h: 0.3180, stage1_loss_instance_mil: 0.3348, stage1_bag_acc: 67.9974, stage1_neg_loss: 0.0489, stage1_mean_ious: 0.3251, stage1_s: 0.0010, stage1_m: 0.0784, stage1_l: 0.3048, stage1_h: 0.3183, loss: 0.6831, grad_norm: 4.2209
2024-10-07 22:52:54,614 - mmdet - INFO - Epoch [2][100/180]	lr: 1.117e-02, eta: 1:05:16, time: 1.509, data_time: 0.029, memory: 16718, stage0_loss_instance_mil: 0.2821, stage0_bag_acc: 81.2733, stage0_mean_ious: 0.2895, stage0_s: 0.0000, stage0_m: 0.0530, stage0_l: 0.2529, stage0_h: 0.2890, stage1_loss_instance_mil: 0.3653, stage1_bag_acc: 66.6444, stage1_neg_loss: 0.0530, stage1_mean_ious: 0.2984, stage1_s: 0.0000, stage1_m: 0.0624, stage1_l: 0.2705, stage1_h: 0.2957, loss: 0.7004, grad_norm: 4.2620
2024-10-07 22:54:08,462 - mmdet - INFO - Epoch [2][150/180]	lr: 1.317e-02, eta: 1:05:17, time: 1.477, data_time: 0.030, memory: 16718, stage0_loss_instance_mil: 0.3096, stage0_bag_acc: 76.2023, stage0_mean_ious: 0.2566, stage0_s: 0.0000, stage0_m: 0.0432, stage0_l: 0.2633, stage0_h: 0.2502, stage1_loss_instance_mil: 0.3891, stage1_bag_acc: 58.8154, stage1_neg_loss: 0.0575, stage1_mean_ious: 0.2612, stage1_s: 0.0000, stage1_m: 0.0467, stage1_l: 0.2792, stage1_h: 0.2532, loss: 0.7562, grad_norm: 3.4374
2024-10-07 22:54:53,381 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-07 22:56:10,892 - mmdet - INFO - Epoch [3][50/180]	lr: 1.636e-02, eta: 0:59:51, time: 1.519, data_time: 0.078, memory: 16718, stage0_loss_instance_mil: 0.1776, stage0_bag_acc: 88.6985, stage0_mean_ious: 0.2399, stage0_s: 0.0000, stage0_m: 0.0579, stage0_l: 0.2164, stage0_h: 0.2307, stage1_loss_instance_mil: 0.3885, stage1_bag_acc: 68.1019, stage1_neg_loss: 0.0651, stage1_mean_ious: 0.2444, stage1_s: 0.0000, stage1_m: 0.0609, stage1_l: 0.2244, stage1_h: 0.2338, loss: 0.6313, grad_norm: 3.2304
2024-10-07 22:57:25,051 - mmdet - INFO - Epoch [3][100/180]	lr: 1.836e-02, eta: 0:59:52, time: 1.483, data_time: 0.033, memory: 16718, stage0_loss_instance_mil: 0.2478, stage0_bag_acc: 82.7008, stage0_mean_ious: 0.3251, stage0_s: 0.0000, stage0_m: 0.0586, stage0_l: 0.2422, stage0_h: 0.3286, stage1_loss_instance_mil: 0.3290, stage1_bag_acc: 69.5421, stage1_neg_loss: 0.0398, stage1_mean_ious: 0.3254, stage1_s: 0.0000, stage1_m: 0.0642, stage1_l: 0.2576, stage1_h: 0.3257, loss: 0.6166, grad_norm: 2.5574
2024-10-07 22:58:40,225 - mmdet - INFO - Epoch [3][150/180]	lr: 2.000e-02, eta: 0:59:44, time: 1.503, data_time: 0.030, memory: 16718, stage0_loss_instance_mil: 0.2066, stage0_bag_acc: 85.6348, stage0_mean_ious: 0.2703, stage0_s: 0.0000, stage0_m: 0.0423, stage0_l: 0.2215, stage0_h: 0.2741, stage1_loss_instance_mil: 0.3465, stage1_bag_acc: 78.5532, stage1_neg_loss: 0.0690, stage1_mean_ious: 0.2773, stage1_s: 0.0000, stage1_m: 0.0502, stage1_l: 0.2294, stage1_h: 0.2804, loss: 0.6221, grad_norm: 3.6763
2024-10-07 22:59:25,355 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-07 23:00:44,642 - mmdet - INFO - Epoch [4][50/180]	lr: 2.000e-02, eta: 0:55:56, time: 1.556, data_time: 0.085, memory: 16718, stage0_loss_instance_mil: 0.2431, stage0_bag_acc: 81.6258, stage0_mean_ious: 0.3547, stage0_s: 0.0000, stage0_m: 0.0276, stage0_l: 0.2042, stage0_h: 0.3659, stage1_loss_instance_mil: 0.3345, stage1_bag_acc: 69.0839, stage1_neg_loss: 0.0424, stage1_mean_ious: 0.3598, stage1_s: 0.0000, stage1_m: 0.0323, stage1_l: 0.2186, stage1_h: 0.3698, loss: 0.6200, grad_norm: 2.7456
2024-10-07 23:01:57,690 - mmdet - INFO - Epoch [4][100/180]	lr: 2.000e-02, eta: 0:55:33, time: 1.461, data_time: 0.027, memory: 16718, stage0_loss_instance_mil: 0.1345, stage0_bag_acc: 91.0599, stage0_mean_ious: 0.3751, stage0_s: 0.0000, stage0_m: 0.0316, stage0_l: 0.2520, stage0_h: 0.3911, stage1_loss_instance_mil: 0.2739, stage1_bag_acc: 82.8271, stage1_neg_loss: 0.0585, stage1_mean_ious: 0.3843, stage1_s: 0.0000, stage1_m: 0.0385, stage1_l: 0.2774, stage1_h: 0.3959, loss: 0.4669, grad_norm: 3.0254
2024-10-07 23:03:11,758 - mmdet - INFO - Epoch [4][150/180]	lr: 2.000e-02, eta: 0:55:05, time: 1.481, data_time: 0.032, memory: 16718, stage0_loss_instance_mil: 0.1846, stage0_bag_acc: 88.0751, stage0_mean_ious: 0.3810, stage0_s: 0.0000, stage0_m: 0.0542, stage0_l: 0.2765, stage0_h: 0.3943, stage1_loss_instance_mil: 0.2853, stage1_bag_acc: 78.8246, stage1_neg_loss: 0.0553, stage1_mean_ious: 0.3823, stage1_s: 0.0000, stage1_m: 0.0595, stage1_l: 0.2925, stage1_h: 0.3925, loss: 0.5252, grad_norm: 3.4566
2024-10-07 23:03:57,059 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-07 23:05:13,274 - mmdet - INFO - Epoch [5][50/180]	lr: 2.000e-02, eta: 0:51:48, time: 1.493, data_time: 0.075, memory: 16718, stage0_loss_instance_mil: 0.1661, stage0_bag_acc: 87.0247, stage0_mean_ious: 0.3282, stage0_s: 0.0000, stage0_m: 0.0663, stage0_l: 0.2532, stage0_h: 0.3330, stage1_loss_instance_mil: 0.2571, stage1_bag_acc: 81.7966, stage1_neg_loss: 0.0578, stage1_mean_ious: 0.3439, stage1_s: 0.0000, stage1_m: 0.0790, stage1_l: 0.2774, stage1_h: 0.3452, loss: 0.4809, grad_norm: 2.4734
2024-10-07 23:06:26,323 - mmdet - INFO - Epoch [5][100/180]	lr: 2.000e-02, eta: 0:51:15, time: 1.461, data_time: 0.034, memory: 16718, stage0_loss_instance_mil: 0.1606, stage0_bag_acc: 88.7267, stage0_mean_ious: 0.3209, stage0_s: 0.0000, stage0_m: 0.0678, stage0_l: 0.3089, stage0_h: 0.3159, stage1_loss_instance_mil: 0.2309, stage1_bag_acc: 86.4018, stage1_neg_loss: 0.0496, stage1_mean_ious: 0.3316, stage1_s: 0.0000, stage1_m: 0.0638, stage1_l: 0.3443, stage1_h: 0.3241, loss: 0.4410, grad_norm: 2.4388
2024-10-07 23:07:38,182 - mmdet - INFO - Epoch [5][150/180]	lr: 2.000e-02, eta: 0:50:34, time: 1.437, data_time: 0.028, memory: 16718, stage0_loss_instance_mil: 0.1542, stage0_bag_acc: 88.5505, stage0_mean_ious: 0.3694, stage0_s: 0.0000, stage0_m: 0.0550, stage0_l: 0.2470, stage0_h: 0.3830, stage1_loss_instance_mil: 0.3145, stage1_bag_acc: 76.0445, stage1_neg_loss: 0.0569, stage1_mean_ious: 0.3814, stage1_s: 0.0000, stage1_m: 0.0577, stage1_l: 0.2707, stage1_h: 0.3922, loss: 0.5255, grad_norm: 2.9084
2024-10-07 23:08:21,631 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-07 23:09:37,144 - mmdet - INFO - Epoch [6][50/180]	lr: 2.000e-02, eta: 0:47:43, time: 1.478, data_time: 0.084, memory: 16718, stage0_loss_instance_mil: 0.1753, stage0_bag_acc: 86.9762, stage0_mean_ious: 0.3780, stage0_s: 0.0018, stage0_m: 0.0241, stage0_l: 0.2609, stage0_h: 0.3944, stage1_loss_instance_mil: 0.2549, stage1_bag_acc: 78.6050, stage1_neg_loss: 0.0349, stage1_mean_ious: 0.4003, stage1_s: 0.0016, stage1_m: 0.0283, stage1_l: 0.2968, stage1_h: 0.4135, loss: 0.4651, grad_norm: 2.2717
2024-10-07 23:10:46,915 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-07 23:10:46,915 - mmdet - INFO - Epoch [6][100/180]	lr: 2.000e-02, eta: 0:46:57, time: 1.395, data_time: 0.027, memory: 16718, stage0_loss_instance_mil: 0.1291, stage0_bag_acc: 89.8490, stage0_mean_ious: 0.3938, stage0_s: 0.0000, stage0_m: 0.0224, stage0_l: 0.2600, stage0_h: 0.4092, stage1_loss_instance_mil: 0.2332, stage1_bag_acc: 83.7950, stage1_neg_loss: 0.0444, stage1_mean_ious: 0.4108, stage1_s: 0.0000, stage1_m: 0.0265, stage1_l: 0.2891, stage1_h: 0.4238, loss: 0.4067, grad_norm: 2.4663
2024-10-07 23:11:58,927 - mmdet - INFO - Epoch [6][150/180]	lr: 2.000e-02, eta: 0:46:13, time: 1.440, data_time: 0.032, memory: 16718, stage0_loss_instance_mil: 0.1203, stage0_bag_acc: 92.3730, stage0_mean_ious: 0.4057, stage0_s: 0.0000, stage0_m: 0.0769, stage0_l: 0.2816, stage0_h: 0.4187, stage1_loss_instance_mil: 0.1757, stage1_bag_acc: 92.0836, stage1_neg_loss: 0.0481, stage1_mean_ious: 0.4233, stage1_s: 0.0000, stage1_m: 0.0872, stage1_l: 0.3239, stage1_h: 0.4288, loss: 0.3440, grad_norm: 2.3121
2024-10-07 23:12:42,237 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-07 23:14:00,168 - mmdet - INFO - Epoch [7][50/180]	lr: 2.000e-02, eta: 0:43:45, time: 1.527, data_time: 0.078, memory: 16718, stage0_loss_instance_mil: 0.0714, stage0_bag_acc: 95.3357, stage0_mean_ious: 0.4024, stage0_s: 0.0000, stage0_m: 0.0374, stage0_l: 0.2619, stage0_h: 0.4172, stage1_loss_instance_mil: 0.1580, stage1_bag_acc: 95.7710, stage1_neg_loss: 0.0490, stage1_mean_ious: 0.4143, stage1_s: 0.0000, stage1_m: 0.0512, stage1_l: 0.3099, stage1_h: 0.4228, loss: 0.2784, grad_norm: 1.9121
2024-10-07 23:15:11,511 - mmdet - INFO - Epoch [7][100/180]	lr: 2.000e-02, eta: 0:42:59, time: 1.427, data_time: 0.033, memory: 16719, stage0_loss_instance_mil: 0.0576, stage0_bag_acc: 96.0601, stage0_mean_ious: 0.4676, stage0_s: 0.0000, stage0_m: 0.0277, stage0_l: 0.2749, stage0_h: 0.4982, stage1_loss_instance_mil: 0.1598, stage1_bag_acc: 94.8841, stage1_neg_loss: 0.0481, stage1_mean_ious: 0.4795, stage1_s: 0.0000, stage1_m: 0.0280, stage1_l: 0.3038, stage1_h: 0.5054, loss: 0.2655, grad_norm: 1.9605
2024-10-07 23:16:26,721 - mmdet - INFO - Epoch [7][150/180]	lr: 2.000e-02, eta: 0:42:17, time: 1.504, data_time: 0.031, memory: 16719, stage0_loss_instance_mil: 0.1456, stage0_bag_acc: 91.0280, stage0_mean_ious: 0.4306, stage0_s: 0.0000, stage0_m: 0.0281, stage0_l: 0.2464, stage0_h: 0.4566, stage1_loss_instance_mil: 0.1501, stage1_bag_acc: 84.9281, stage1_neg_loss: 0.0465, stage1_mean_ious: 0.4364, stage1_s: 0.0000, stage1_m: 0.0328, stage1_l: 0.2670, stage1_h: 0.4596, loss: 0.3422, grad_norm: 2.4038
2024-10-07 23:17:11,082 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-07 23:18:28,121 - mmdet - INFO - Epoch [8][50/180]	lr: 2.000e-02, eta: 0:39:58, time: 1.508, data_time: 0.081, memory: 16719, stage0_loss_instance_mil: 0.0601, stage0_bag_acc: 96.4211, stage0_mean_ious: 0.3855, stage0_s: 0.0000, stage0_m: 0.0313, stage0_l: 0.2629, stage0_h: 0.4023, stage1_loss_instance_mil: 0.1721, stage1_bag_acc: 93.0096, stage1_neg_loss: 0.0494, stage1_mean_ious: 0.3966, stage1_s: 0.0000, stage1_m: 0.0348, stage1_l: 0.2916, stage1_h: 0.4108, loss: 0.2816, grad_norm: 2.0696
2024-10-07 23:19:44,415 - mmdet - INFO - Epoch [8][100/180]	lr: 2.000e-02, eta: 0:39:16, time: 1.526, data_time: 0.031, memory: 16719, stage0_loss_instance_mil: 0.0956, stage0_bag_acc: 92.5574, stage0_mean_ious: 0.3505, stage0_s: 0.0000, stage0_m: 0.0416, stage0_l: 0.2901, stage0_h: 0.3620, stage1_loss_instance_mil: 0.1766, stage1_bag_acc: 86.7042, stage1_neg_loss: 0.0343, stage1_mean_ious: 0.3701, stage1_s: 0.0000, stage1_m: 0.0493, stage1_l: 0.3351, stage1_h: 0.3759, loss: 0.3064, grad_norm: 2.2721
2024-10-07 23:20:56,755 - mmdet - INFO - Epoch [8][150/180]	lr: 2.000e-02, eta: 0:38:25, time: 1.447, data_time: 0.033, memory: 16719, stage0_loss_instance_mil: 0.0876, stage0_bag_acc: 94.2366, stage0_mean_ious: 0.3365, stage0_s: 0.0000, stage0_m: 0.0333, stage0_l: 0.3119, stage0_h: 0.3339, stage1_loss_instance_mil: 0.1747, stage1_bag_acc: 92.0719, stage1_neg_loss: 0.0576, stage1_mean_ious: 0.3449, stage1_s: 0.0000, stage1_m: 0.0363, stage1_l: 0.3448, stage1_h: 0.3376, loss: 0.3199, grad_norm: 2.3890
2024-10-07 23:21:41,863 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-07 23:22:59,730 - mmdet - INFO - Epoch [9][50/180]	lr: 2.000e-03, eta: 0:36:16, time: 1.526, data_time: 0.078, memory: 16719, stage0_loss_instance_mil: 0.0393, stage0_bag_acc: 97.4107, stage0_mean_ious: 0.4714, stage0_s: 0.0000, stage0_m: 0.0635, stage0_l: 0.2790, stage0_h: 0.4956, stage1_loss_instance_mil: 0.0994, stage1_bag_acc: 96.4462, stage1_neg_loss: 0.0390, stage1_mean_ious: 0.4843, stage1_s: 0.0000, stage1_m: 0.0655, stage1_l: 0.3351, stage1_h: 0.5012, loss: 0.1777, grad_norm: 1.3747
2024-10-07 23:24:12,810 - mmdet - INFO - Epoch [9][100/180]	lr: 2.000e-03, eta: 0:35:26, time: 1.462, data_time: 0.033, memory: 16719, stage0_loss_instance_mil: 0.0345, stage0_bag_acc: 98.2583, stage0_mean_ious: 0.4771, stage0_s: 0.0000, stage0_m: 0.0604, stage0_l: 0.2511, stage0_h: 0.5072, stage1_loss_instance_mil: 0.0674, stage1_bag_acc: 96.9088, stage1_neg_loss: 0.0366, stage1_mean_ious: 0.4859, stage1_s: 0.0000, stage1_m: 0.0651, stage1_l: 0.2905, stage1_h: 0.5096, loss: 0.1386, grad_norm: 1.3191
2024-10-07 23:25:26,548 - mmdet - INFO - Epoch [9][150/180]	lr: 2.000e-03, eta: 0:34:35, time: 1.475, data_time: 0.028, memory: 16719, stage0_loss_instance_mil: 0.0253, stage0_bag_acc: 98.6297, stage0_mean_ious: 0.4816, stage0_s: 0.0000, stage0_m: 0.0216, stage0_l: 0.2602, stage0_h: 0.5064, stage1_loss_instance_mil: 0.0739, stage1_bag_acc: 98.2471, stage1_neg_loss: 0.0302, stage1_mean_ious: 0.5020, stage1_s: 0.0000, stage1_m: 0.0267, stage1_l: 0.3281, stage1_h: 0.5202, loss: 0.1295, grad_norm: 1.2304
2024-10-07 23:26:10,689 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-07 23:27:30,284 - mmdet - INFO - Epoch [10][50/180]	lr: 2.000e-03, eta: 0:32:33, time: 1.555, data_time: 0.081, memory: 16719, stage0_loss_instance_mil: 0.0245, stage0_bag_acc: 98.7814, stage0_mean_ious: 0.4862, stage0_s: 0.0000, stage0_m: 0.0189, stage0_l: 0.2266, stage0_h: 0.5080, stage1_loss_instance_mil: 0.0750, stage1_bag_acc: 97.7545, stage1_neg_loss: 0.0304, stage1_mean_ious: 0.4928, stage1_s: 0.0000, stage1_m: 0.0193, stage1_l: 0.2726, stage1_h: 0.5099, loss: 0.1299, grad_norm: 1.3367
2024-10-07 23:28:44,476 - mmdet - INFO - Epoch [10][100/180]	lr: 2.000e-03, eta: 0:31:41, time: 1.484, data_time: 0.031, memory: 16719, stage0_loss_instance_mil: 0.0235, stage0_bag_acc: 98.7157, stage0_mean_ious: 0.5008, stage0_s: 0.0015, stage0_m: 0.0358, stage0_l: 0.2556, stage0_h: 0.5359, stage1_loss_instance_mil: 0.0612, stage1_bag_acc: 98.4297, stage1_neg_loss: 0.0286, stage1_mean_ious: 0.5078, stage1_s: 0.0021, stage1_m: 0.0439, stage1_l: 0.2953, stage1_h: 0.5365, loss: 0.1133, grad_norm: 1.1830
2024-10-07 23:29:57,996 - mmdet - INFO - Epoch [10][150/180]	lr: 2.000e-03, eta: 0:30:48, time: 1.470, data_time: 0.031, memory: 16719, stage0_loss_instance_mil: 0.0186, stage0_bag_acc: 99.1910, stage0_mean_ious: 0.4777, stage0_s: 0.0000, stage0_m: 0.0491, stage0_l: 0.2125, stage0_h: 0.5106, stage1_loss_instance_mil: 0.0549, stage1_bag_acc: 98.3911, stage1_neg_loss: 0.0347, stage1_mean_ious: 0.4840, stage1_s: 0.0000, stage1_m: 0.0520, stage1_l: 0.2458, stage1_h: 0.5131, loss: 0.1082, grad_norm: 1.3075
2024-10-07 23:30:44,384 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-07 23:32:02,682 - mmdet - INFO - Epoch [11][50/180]	lr: 2.000e-03, eta: 0:28:49, time: 1.536, data_time: 0.080, memory: 16722, stage0_loss_instance_mil: 0.0208, stage0_bag_acc: 98.7467, stage0_mean_ious: 0.5014, stage0_s: 0.0000, stage0_m: 0.0250, stage0_l: 0.2657, stage0_h: 0.5293, stage1_loss_instance_mil: 0.0509, stage1_bag_acc: 98.3390, stage1_neg_loss: 0.0238, stage1_mean_ious: 0.5135, stage1_s: 0.0000, stage1_m: 0.0288, stage1_l: 0.3247, stage1_h: 0.5331, loss: 0.0955, grad_norm: 1.0092
2024-10-07 23:33:16,750 - mmdet - INFO - Epoch [11][100/180]	lr: 2.000e-03, eta: 0:27:55, time: 1.481, data_time: 0.032, memory: 16722, stage0_loss_instance_mil: 0.0289, stage0_bag_acc: 98.5221, stage0_mean_ious: 0.4868, stage0_s: 0.0000, stage0_m: 0.0398, stage0_l: 0.2602, stage0_h: 0.5216, stage1_loss_instance_mil: 0.0584, stage1_bag_acc: 98.1749, stage1_neg_loss: 0.0256, stage1_mean_ious: 0.4936, stage1_s: 0.0000, stage1_m: 0.0470, stage1_l: 0.3037, stage1_h: 0.5227, loss: 0.1128, grad_norm: 1.2557
2024-10-07 23:34:31,554 - mmdet - INFO - Epoch [11][150/180]	lr: 2.000e-03, eta: 0:27:01, time: 1.496, data_time: 0.028, memory: 16722, stage0_loss_instance_mil: 0.0211, stage0_bag_acc: 98.7373, stage0_mean_ious: 0.5092, stage0_s: 0.0000, stage0_m: 0.0227, stage0_l: 0.2246, stage0_h: 0.5364, stage1_loss_instance_mil: 0.0475, stage1_bag_acc: 98.4698, stage1_neg_loss: 0.0257, stage1_mean_ious: 0.5247, stage1_s: 0.0000, stage1_m: 0.0279, stage1_l: 0.2580, stage1_h: 0.5477, loss: 0.0943, grad_norm: 1.1078
2024-10-07 23:35:17,543 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-07 23:36:36,505 - mmdet - INFO - Epoch [12][50/180]	lr: 2.000e-04, eta: 0:25:06, time: 1.541, data_time: 0.082, memory: 16722, stage0_loss_instance_mil: 0.0157, stage0_bag_acc: 99.0010, stage0_mean_ious: 0.4905, stage0_s: 0.0000, stage0_m: 0.0153, stage0_l: 0.2528, stage0_h: 0.5238, stage1_loss_instance_mil: 0.0522, stage1_bag_acc: 98.8211, stage1_neg_loss: 0.0275, stage1_mean_ious: 0.4957, stage1_s: 0.0000, stage1_m: 0.0199, stage1_l: 0.2954, stage1_h: 0.5205, loss: 0.0954, grad_norm: 1.1293
2024-10-07 23:37:50,637 - mmdet - INFO - Epoch [12][100/180]	lr: 2.000e-04, eta: 0:24:11, time: 1.483, data_time: 0.030, memory: 16722, stage0_loss_instance_mil: 0.0132, stage0_bag_acc: 99.2725, stage0_mean_ious: 0.4956, stage0_s: 0.0000, stage0_m: 0.0238, stage0_l: 0.2486, stage0_h: 0.5313, stage1_loss_instance_mil: 0.0501, stage1_bag_acc: 99.1922, stage1_neg_loss: 0.0217, stage1_mean_ious: 0.5019, stage1_s: 0.0000, stage1_m: 0.0249, stage1_l: 0.2909, stage1_h: 0.5308, loss: 0.0850, grad_norm: 1.0172
2024-10-07 23:39:05,355 - mmdet - INFO - Epoch [12][150/180]	lr: 2.000e-04, eta: 0:23:14, time: 1.494, data_time: 0.034, memory: 16722, stage0_loss_instance_mil: 0.0168, stage0_bag_acc: 98.6203, stage0_mean_ious: 0.4950, stage0_s: 0.0014, stage0_m: 0.0529, stage0_l: 0.2289, stage0_h: 0.5233, stage1_loss_instance_mil: 0.0491, stage1_bag_acc: 98.2943, stage1_neg_loss: 0.0268, stage1_mean_ious: 0.5074, stage1_s: 0.0021, stage1_m: 0.0544, stage1_l: 0.2788, stage1_h: 0.5305, loss: 0.0927, grad_norm: 1.1417
2024-10-07 23:39:49,026 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-07 23:41:35,020 - mmdet - INFO - Evaluating bbox...
2024-10-07 23:41:35,942 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1268
2024-10-07 23:41:35,943 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3416
2024-10-07 23:41:35,943 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2340
2024-10-07 23:41:35,943 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1263
2024-10-07 23:41:35,943 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0711
2024-10-07 23:41:35,943 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0256
2024-10-07 23:41:35,943 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-07 23:41:35,944 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1347
2024-10-07 23:41:35,944 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1277
2024-10-07 23:41:35,944 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1579
2024-10-07 23:41:35,944 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2100
2024-10-07 23:41:35,944 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.4871
2024-10-07 23:41:35,944 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2100
2024-10-07 23:41:35,944 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2100
2024-10-07 23:41:35,945 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2044
2024-10-07 23:41:35,945 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2096
2024-10-07 23:41:35,945 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2470
2024-10-07 23:41:35,958 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-07 23:41:35,959 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.1270, bbox_mAP_50: 0.3420, bbox_mAP_75: 0.2340, bbox_mAP_s: 0.1260, bbox_mAP_m: 0.0710, bbox_mAP_l: 0.0260, bbox_mAP_copypaste: 0.127 0.342 0.234 0.126 0.071 0.026
2024-10-07 23:42:50,945 - mmdet - INFO - Epoch [13][50/180]	lr: 2.000e-04, eta: 0:21:22, time: 1.499, data_time: 0.078, memory: 16722, stage0_loss_instance_mil: 0.0136, stage0_bag_acc: 99.0473, stage0_mean_ious: 0.5035, stage0_s: 0.0000, stage0_m: 0.0408, stage0_l: 0.2445, stage0_h: 0.5334, stage1_loss_instance_mil: 0.0542, stage1_bag_acc: 98.9504, stage1_neg_loss: 0.0287, stage1_mean_ious: 0.5074, stage1_s: 0.0000, stage1_m: 0.0421, stage1_l: 0.2817, stage1_h: 0.5312, loss: 0.0965, grad_norm: 1.1256
2024-10-07 23:44:04,798 - mmdet - INFO - Epoch [13][100/180]	lr: 2.000e-04, eta: 0:20:25, time: 1.477, data_time: 0.035, memory: 16722, stage0_loss_instance_mil: 0.0166, stage0_bag_acc: 98.8246, stage0_mean_ious: 0.4823, stage0_s: 0.0015, stage0_m: 0.0242, stage0_l: 0.2642, stage0_h: 0.5215, stage1_loss_instance_mil: 0.0480, stage1_bag_acc: 98.8607, stage1_neg_loss: 0.0219, stage1_mean_ious: 0.4975, stage1_s: 0.0021, stage1_m: 0.0319, stage1_l: 0.3125, stage1_h: 0.5295, loss: 0.0865, grad_norm: 1.0283
2024-10-07 23:45:19,201 - mmdet - INFO - Epoch [13][150/180]	lr: 2.000e-04, eta: 0:19:27, time: 1.488, data_time: 0.030, memory: 16722, stage0_loss_instance_mil: 0.0213, stage0_bag_acc: 98.5840, stage0_mean_ious: 0.4986, stage0_s: 0.0000, stage0_m: 0.0258, stage0_l: 0.2404, stage0_h: 0.5315, stage1_loss_instance_mil: 0.0458, stage1_bag_acc: 98.6793, stage1_neg_loss: 0.0229, stage1_mean_ious: 0.5146, stage1_s: 0.0000, stage1_m: 0.0286, stage1_l: 0.2746, stage1_h: 0.5431, loss: 0.0900, grad_norm: 1.0374
2024-10-07 23:46:03,255 - mmdet - INFO - Saving checkpoint at 13 epochs
2024-10-07 23:47:18,087 - mmdet - INFO - Epoch [14][50/180]	lr: 2.000e-04, eta: 0:17:37, time: 1.481, data_time: 0.081, memory: 16722, stage0_loss_instance_mil: 0.0171, stage0_bag_acc: 98.6586, stage0_mean_ious: 0.4861, stage0_s: 0.0000, stage0_m: 0.0480, stage0_l: 0.2502, stage0_h: 0.5179, stage1_loss_instance_mil: 0.0461, stage1_bag_acc: 98.9083, stage1_neg_loss: 0.0311, stage1_mean_ious: 0.5035, stage1_s: 0.0000, stage1_m: 0.0576, stage1_l: 0.2962, stage1_h: 0.5304, loss: 0.0942, grad_norm: 1.1362
2024-10-07 23:48:32,345 - mmdet - INFO - Epoch [14][100/180]	lr: 2.000e-04, eta: 0:16:39, time: 1.485, data_time: 0.029, memory: 16722, stage0_loss_instance_mil: 0.0174, stage0_bag_acc: 98.9767, stage0_mean_ious: 0.5171, stage0_s: 0.0000, stage0_m: 0.0511, stage0_l: 0.2544, stage0_h: 0.5541, stage1_loss_instance_mil: 0.0482, stage1_bag_acc: 98.8712, stage1_neg_loss: 0.0287, stage1_mean_ious: 0.5191, stage1_s: 0.0000, stage1_m: 0.0533, stage1_l: 0.3064, stage1_h: 0.5473, loss: 0.0943, grad_norm: 1.1678
2024-10-07 23:49:46,353 - mmdet - INFO - Epoch [14][150/180]	lr: 2.000e-04, eta: 0:15:40, time: 1.480, data_time: 0.034, memory: 16722, stage0_loss_instance_mil: 0.0190, stage0_bag_acc: 98.5816, stage0_mean_ious: 0.5044, stage0_s: 0.0000, stage0_m: 0.0244, stage0_l: 0.2524, stage0_h: 0.5324, stage1_loss_instance_mil: 0.0502, stage1_bag_acc: 98.2045, stage1_neg_loss: 0.0232, stage1_mean_ious: 0.5092, stage1_s: 0.0000, stage1_m: 0.0264, stage1_l: 0.2814, stage1_h: 0.5327, loss: 0.0924, grad_norm: 1.1943
2024-10-07 23:50:32,000 - mmdet - INFO - Saving checkpoint at 14 epochs
2024-10-07 23:51:50,112 - mmdet - INFO - Epoch [15][50/180]	lr: 2.000e-04, eta: 0:13:54, time: 1.545, data_time: 0.076, memory: 16722, stage0_loss_instance_mil: 0.0201, stage0_bag_acc: 98.7190, stage0_mean_ious: 0.4892, stage0_s: 0.0000, stage0_m: 0.0298, stage0_l: 0.2596, stage0_h: 0.5211, stage1_loss_instance_mil: 0.0498, stage1_bag_acc: 98.4203, stage1_neg_loss: 0.0253, stage1_mean_ious: 0.4966, stage1_s: 0.0000, stage1_m: 0.0400, stage1_l: 0.3073, stage1_h: 0.5201, loss: 0.0952, grad_norm: 1.1746
2024-10-07 23:53:06,367 - mmdet - INFO - Epoch [15][100/180]	lr: 2.000e-04, eta: 0:12:55, time: 1.525, data_time: 0.039, memory: 16722, stage0_loss_instance_mil: 0.0120, stage0_bag_acc: 99.1768, stage0_mean_ious: 0.4984, stage0_s: 0.0000, stage0_m: 0.0349, stage0_l: 0.2102, stage0_h: 0.5297, stage1_loss_instance_mil: 0.0470, stage1_bag_acc: 98.7127, stage1_neg_loss: 0.0245, stage1_mean_ious: 0.5061, stage1_s: 0.0000, stage1_m: 0.0423, stage1_l: 0.2464, stage1_h: 0.5320, loss: 0.0835, grad_norm: 1.0368
2024-10-07 23:54:17,712 - mmdet - INFO - Epoch [15][150/180]	lr: 2.000e-04, eta: 0:11:54, time: 1.427, data_time: 0.027, memory: 16722, stage0_loss_instance_mil: 0.0122, stage0_bag_acc: 99.1268, stage0_mean_ious: 0.5100, stage0_s: 0.0000, stage0_m: 0.0373, stage0_l: 0.2812, stage0_h: 0.5365, stage1_loss_instance_mil: 0.0508, stage1_bag_acc: 98.8170, stage1_neg_loss: 0.0241, stage1_mean_ious: 0.5213, stage1_s: 0.0000, stage1_m: 0.0385, stage1_l: 0.3269, stage1_h: 0.5432, loss: 0.0871, grad_norm: 1.0629
2024-10-07 23:55:01,764 - mmdet - INFO - Saving checkpoint at 15 epochs
2024-10-07 23:56:17,410 - mmdet - INFO - Epoch [16][50/180]	lr: 2.000e-04, eta: 0:10:09, time: 1.497, data_time: 0.081, memory: 16722, stage0_loss_instance_mil: 0.0223, stage0_bag_acc: 98.8564, stage0_mean_ious: 0.5083, stage0_s: 0.0000, stage0_m: 0.0224, stage0_l: 0.2303, stage0_h: 0.5420, stage1_loss_instance_mil: 0.0494, stage1_bag_acc: 98.6991, stage1_neg_loss: 0.0242, stage1_mean_ious: 0.5158, stage1_s: 0.0000, stage1_m: 0.0235, stage1_l: 0.2678, stage1_h: 0.5436, loss: 0.0960, grad_norm: 1.1101
2024-10-07 23:57:29,530 - mmdet - INFO - Epoch [16][100/180]	lr: 2.000e-04, eta: 0:09:09, time: 1.442, data_time: 0.028, memory: 16722, stage0_loss_instance_mil: 0.0181, stage0_bag_acc: 98.9591, stage0_mean_ious: 0.5073, stage0_s: 0.0000, stage0_m: 0.0218, stage0_l: 0.2332, stage0_h: 0.5364, stage1_loss_instance_mil: 0.0471, stage1_bag_acc: 98.4796, stage1_neg_loss: 0.0246, stage1_mean_ious: 0.5068, stage1_s: 0.0000, stage1_m: 0.0260, stage1_l: 0.2820, stage1_h: 0.5279, loss: 0.0898, grad_norm: 1.1132
2024-10-07 23:58:41,840 - mmdet - INFO - Epoch [16][150/180]	lr: 2.000e-04, eta: 0:08:08, time: 1.446, data_time: 0.029, memory: 16722, stage0_loss_instance_mil: 0.0151, stage0_bag_acc: 99.1924, stage0_mean_ious: 0.4918, stage0_s: 0.0000, stage0_m: 0.0196, stage0_l: 0.2247, stage0_h: 0.5270, stage1_loss_instance_mil: 0.0426, stage1_bag_acc: 98.5342, stage1_neg_loss: 0.0257, stage1_mean_ious: 0.5027, stage1_s: 0.0000, stage1_m: 0.0308, stage1_l: 0.2646, stage1_h: 0.5311, loss: 0.0834, grad_norm: 1.1073
2024-10-07 23:59:25,659 - mmdet - INFO - Saving checkpoint at 16 epochs
2024-10-08 00:00:41,622 - mmdet - INFO - Epoch [17][50/180]	lr: 2.000e-04, eta: 0:06:25, time: 1.504, data_time: 0.075, memory: 16722, stage0_loss_instance_mil: 0.0261, stage0_bag_acc: 98.3886, stage0_mean_ious: 0.5099, stage0_s: 0.0000, stage0_m: 0.0352, stage0_l: 0.2261, stage0_h: 0.5396, stage1_loss_instance_mil: 0.0458, stage1_bag_acc: 98.3375, stage1_neg_loss: 0.0230, stage1_mean_ious: 0.5164, stage1_s: 0.0000, stage1_m: 0.0423, stage1_l: 0.2563, stage1_h: 0.5414, loss: 0.0949, grad_norm: 1.0815
2024-10-08 00:01:53,264 - mmdet - INFO - Epoch [17][100/180]	lr: 2.000e-04, eta: 0:05:23, time: 1.433, data_time: 0.033, memory: 16722, stage0_loss_instance_mil: 0.0105, stage0_bag_acc: 99.3882, stage0_mean_ious: 0.4894, stage0_s: 0.0000, stage0_m: 0.0335, stage0_l: 0.2552, stage0_h: 0.5248, stage1_loss_instance_mil: 0.0440, stage1_bag_acc: 99.1093, stage1_neg_loss: 0.0354, stage1_mean_ious: 0.5003, stage1_s: 0.0000, stage1_m: 0.0325, stage1_l: 0.2983, stage1_h: 0.5285, loss: 0.0898, grad_norm: 1.2895
2024-10-08 00:03:07,677 - mmdet - INFO - Epoch [17][150/180]	lr: 2.000e-04, eta: 0:04:22, time: 1.488, data_time: 0.029, memory: 16722, stage0_loss_instance_mil: 0.0141, stage0_bag_acc: 99.2326, stage0_mean_ious: 0.4866, stage0_s: 0.0016, stage0_m: 0.0306, stage0_l: 0.2229, stage0_h: 0.5179, stage1_loss_instance_mil: 0.0468, stage1_bag_acc: 99.0482, stage1_neg_loss: 0.0223, stage1_mean_ious: 0.4928, stage1_s: 0.0020, stage1_m: 0.0374, stage1_l: 0.2626, stage1_h: 0.5183, loss: 0.0832, grad_norm: 1.0006
2024-10-08 00:03:51,711 - mmdet - INFO - Saving checkpoint at 17 epochs
2024-10-08 00:05:06,985 - mmdet - INFO - Epoch [18][50/180]	lr: 2.000e-04, eta: 0:02:41, time: 1.487, data_time: 0.080, memory: 16722, stage0_loss_instance_mil: 0.0175, stage0_bag_acc: 98.8156, stage0_mean_ious: 0.4939, stage0_s: 0.0000, stage0_m: 0.0335, stage0_l: 0.2272, stage0_h: 0.5243, stage1_loss_instance_mil: 0.0471, stage1_bag_acc: 98.8359, stage1_neg_loss: 0.0228, stage1_mean_ious: 0.5089, stage1_s: 0.0000, stage1_m: 0.0364, stage1_l: 0.2639, stage1_h: 0.5336, loss: 0.0874, grad_norm: 1.0902
2024-10-08 00:06:20,657 - mmdet - INFO - Epoch [18][100/180]	lr: 2.000e-04, eta: 0:01:39, time: 1.473, data_time: 0.027, memory: 16722, stage0_loss_instance_mil: 0.0151, stage0_bag_acc: 99.3829, stage0_mean_ious: 0.5041, stage0_s: 0.0000, stage0_m: 0.0361, stage0_l: 0.2404, stage0_h: 0.5324, stage1_loss_instance_mil: 0.0518, stage1_bag_acc: 98.9365, stage1_neg_loss: 0.0281, stage1_mean_ious: 0.5074, stage1_s: 0.0000, stage1_m: 0.0424, stage1_l: 0.2731, stage1_h: 0.5292, loss: 0.0949, grad_norm: 1.1599
2024-10-08 00:07:36,440 - mmdet - INFO - Epoch [18][150/180]	lr: 2.000e-04, eta: 0:00:37, time: 1.516, data_time: 0.035, memory: 16722, stage0_loss_instance_mil: 0.0218, stage0_bag_acc: 98.8875, stage0_mean_ious: 0.5052, stage0_s: 0.0012, stage0_m: 0.0123, stage0_l: 0.2366, stage0_h: 0.5336, stage1_loss_instance_mil: 0.0445, stage1_bag_acc: 98.3125, stage1_neg_loss: 0.0288, stage1_mean_ious: 0.5062, stage1_s: 0.0015, stage1_m: 0.0177, stage1_l: 0.2700, stage1_h: 0.5291, loss: 0.0951, grad_norm: 1.1931
2024-10-08 00:08:19,490 - mmdet - INFO - Saving checkpoint at 18 epochs
2024-10-08 00:10:05,637 - mmdet - INFO - Evaluating bbox...
2024-10-08 00:10:06,606 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1320
2024-10-08 00:10:06,606 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.3612
2024-10-08 00:10:06,606 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2434
2024-10-08 00:10:06,606 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1252
2024-10-08 00:10:06,607 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0756
2024-10-08 00:10:06,607 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0285
2024-10-08 00:10:06,607 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-08 00:10:06,607 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1404
2024-10-08 00:10:06,607 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1310
2024-10-08 00:10:06,607 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1669
2024-10-08 00:10:06,607 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2199
2024-10-08 00:10:06,607 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.5077
2024-10-08 00:10:06,608 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2199
2024-10-08 00:10:06,608 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2199
2024-10-08 00:10:06,608 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1993
2024-10-08 00:10:06,608 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2156
2024-10-08 00:10:06,608 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2702
2024-10-08 00:10:07,986 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+963dd25
------------------------------------------------------------

2024-10-08 00:10:09,095 - mmdet - INFO - Distributed training: False
2024-10-08 00:10:10,049 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=18)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=12,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-08 00:10:11,047 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-08 00:10:11,047 - mmdet - INFO - Use load_from_local loader
2024-10-08 00:10:11,311 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-08 00:10:11,324 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-08 00:10:11,325 - mmdet - INFO - workflow: [('train', 1)], max: 18 epochs
2024-10-08 00:11:29,784 - mmdet - INFO - Epoch [1][50/180]	lr: 1.978e-03, eta: 1:23:25, time: 1.569, data_time: 0.081, memory: 16722, stage0_loss_instance_mil: 0.6693, stage0_bag_acc: 23.4845, stage0_mean_ious: 0.3102, stage0_s: 0.0000, stage0_m: 0.0430, stage0_l: 0.2396, stage0_h: 0.3144, stage1_loss_instance_mil: 0.1740, stage1_bag_acc: 17.6183, stage1_neg_loss: 0.0079, stage1_mean_ious: 0.2890, stage1_s: 0.0000, stage1_m: 0.0425, stage1_l: 0.2507, stage1_h: 0.2884, loss: 0.8512, grad_norm: 3.5909
2024-10-08 00:12:42,504 - mmdet - INFO - Epoch [1][100/180]	lr: 3.976e-03, eta: 1:19:06, time: 1.454, data_time: 0.035, memory: 16722, stage0_loss_instance_mil: 0.3298, stage0_bag_acc: 77.4032, stage0_mean_ious: 0.4251, stage0_s: 0.0000, stage0_m: 0.0534, stage0_l: 0.3251, stage0_h: 0.4362, stage1_loss_instance_mil: 0.3876, stage1_bag_acc: 54.4489, stage1_neg_loss: 0.0576, stage1_mean_ious: 0.4100, stage1_s: 0.0000, stage1_m: 0.0546, stage1_l: 0.3264, stage1_h: 0.4171, loss: 0.7749, grad_norm: 6.6648
2024-10-08 00:13:56,651 - mmdet - INFO - Epoch [1][150/180]	lr: 5.974e-03, eta: 1:17:21, time: 1.483, data_time: 0.029, memory: 16722, stage0_loss_instance_mil: 0.3224, stage0_bag_acc: 76.6315, stage0_mean_ious: 0.3152, stage0_s: 0.0000, stage0_m: 0.0566, stage0_l: 0.2130, stage0_h: 0.3209, stage1_loss_instance_mil: 0.3567, stage1_bag_acc: 59.1462, stage1_neg_loss: 0.0565, stage1_mean_ious: 0.3128, stage1_s: 0.0000, stage1_m: 0.0578, stage1_l: 0.2137, stage1_h: 0.3181, loss: 0.7357, grad_norm: 5.9948
2024-10-08 00:14:41,435 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-08 00:16:00,182 - mmdet - INFO - Epoch [2][50/180]	lr: 9.171e-03, eta: 1:05:55, time: 1.538, data_time: 0.085, memory: 16722, stage0_loss_instance_mil: 0.2663, stage0_bag_acc: 78.5272, stage0_mean_ious: 0.3305, stage0_s: 0.0013, stage0_m: 0.0558, stage0_l: 0.2086, stage0_h: 0.3406, stage1_loss_instance_mil: 0.3484, stage1_bag_acc: 63.4108, stage1_neg_loss: 0.0485, stage1_mean_ious: 0.3184, stage1_s: 0.0012, stage1_m: 0.0608, stage1_l: 0.2016, stage1_h: 0.3273, loss: 0.6631, grad_norm: 3.7654
2024-10-08 00:17:15,966 - mmdet - INFO - Epoch [2][100/180]	lr: 1.117e-02, eta: 1:06:36, time: 1.516, data_time: 0.030, memory: 16722, stage0_loss_instance_mil: 0.1984, stage0_bag_acc: 88.8528, stage0_mean_ious: 0.3029, stage0_s: 0.0000, stage0_m: 0.0449, stage0_l: 0.1719, stage0_h: 0.3146, stage1_loss_instance_mil: 0.3568, stage1_bag_acc: 74.6740, stage1_neg_loss: 0.0708, stage1_mean_ious: 0.2915, stage1_s: 0.0000, stage1_m: 0.0489, stage1_l: 0.1709, stage1_h: 0.3019, loss: 0.6260, grad_norm: 4.3141
2024-10-08 00:18:29,245 - mmdet - INFO - Epoch [2][150/180]	lr: 1.317e-02, eta: 1:06:19, time: 1.466, data_time: 0.036, memory: 16748, stage0_loss_instance_mil: 0.3299, stage0_bag_acc: 74.9454, stage0_mean_ious: 0.2991, stage0_s: 0.0000, stage0_m: 0.0555, stage0_l: 0.2244, stage0_h: 0.3082, stage1_loss_instance_mil: 0.4076, stage1_bag_acc: 59.8376, stage1_neg_loss: 0.0408, stage1_mean_ious: 0.3021, stage1_s: 0.0000, stage1_m: 0.0643, stage1_l: 0.2223, stage1_h: 0.3105, loss: 0.7784, grad_norm: 3.9368
2024-10-08 00:19:15,039 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-08 00:20:30,795 - mmdet - INFO - Epoch [3][50/180]	lr: 1.636e-02, eta: 1:00:27, time: 1.485, data_time: 0.082, memory: 16748, stage0_loss_instance_mil: 0.2444, stage0_bag_acc: 82.4488, stage0_mean_ious: 0.2754, stage0_s: 0.0012, stage0_m: 0.0446, stage0_l: 0.2055, stage0_h: 0.2784, stage1_loss_instance_mil: 0.3605, stage1_bag_acc: 73.6230, stage1_neg_loss: 0.0665, stage1_mean_ious: 0.2700, stage1_s: 0.0009, stage1_m: 0.0464, stage1_l: 0.2088, stage1_h: 0.2718, loss: 0.6714, grad_norm: 3.6236
2024-10-08 00:21:45,867 - mmdet - INFO - Epoch [3][100/180]	lr: 1.836e-02, eta: 1:00:29, time: 1.501, data_time: 0.033, memory: 16748, stage0_loss_instance_mil: 0.2890, stage0_bag_acc: 79.6881, stage0_mean_ious: 0.3638, stage0_s: 0.0000, stage0_m: 0.0630, stage0_l: 0.2081, stage0_h: 0.3806, stage1_loss_instance_mil: 0.3167, stage1_bag_acc: 66.9551, stage1_neg_loss: 0.0454, stage1_mean_ious: 0.3738, stage1_s: 0.0000, stage1_m: 0.0539, stage1_l: 0.2240, stage1_h: 0.3914, loss: 0.6511, grad_norm: 3.4374
2024-10-08 00:23:00,489 - mmdet - INFO - Epoch [3][150/180]	lr: 2.000e-02, eta: 1:00:14, time: 1.492, data_time: 0.028, memory: 16748, stage0_loss_instance_mil: 0.2706, stage0_bag_acc: 81.2835, stage0_mean_ious: 0.3084, stage0_s: 0.0000, stage0_m: 0.0429, stage0_l: 0.1940, stage0_h: 0.3127, stage1_loss_instance_mil: 0.3549, stage1_bag_acc: 66.1300, stage1_neg_loss: 0.0536, stage1_mean_ious: 0.3164, stage1_s: 0.0000, stage1_m: 0.0371, stage1_l: 0.1946, stage1_h: 0.3228, loss: 0.6790, grad_norm: 3.4013
2024-10-08 00:23:44,750 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-08 00:25:05,790 - mmdet - INFO - Epoch [4][50/180]	lr: 2.000e-02, eta: 0:56:28, time: 1.584, data_time: 0.085, memory: 16748, stage0_loss_instance_mil: 0.4291, stage0_bag_acc: 63.5197, stage0_mean_ious: 0.2515, stage0_s: 0.0000, stage0_m: 0.0258, stage0_l: 0.2078, stage0_h: 0.2474, stage1_loss_instance_mil: 0.3002, stage1_bag_acc: 54.1691, stage1_neg_loss: 0.0505, stage1_mean_ious: 0.2448, stage1_s: 0.0000, stage1_m: 0.0253, stage1_l: 0.1971, stage1_h: 0.2419, loss: 0.7799, grad_norm: 3.0297
2024-10-08 00:26:20,638 - mmdet - INFO - Epoch [4][100/180]	lr: 2.000e-02, eta: 0:56:09, time: 1.497, data_time: 0.033, memory: 16748, stage0_loss_instance_mil: 0.3727, stage0_bag_acc: 68.4855, stage0_mean_ious: 0.2454, stage0_s: 0.0000, stage0_m: 0.0784, stage0_l: 0.2104, stage0_h: 0.2447, stage1_loss_instance_mil: 0.2457, stage1_bag_acc: 60.5330, stage1_neg_loss: 0.0391, stage1_mean_ious: 0.2491, stage1_s: 0.0000, stage1_m: 0.0823, stage1_l: 0.2022, stage1_h: 0.2499, loss: 0.6575, grad_norm: 2.4509
2024-10-08 00:27:37,697 - mmdet - INFO - Epoch [4][150/180]	lr: 2.000e-02, eta: 0:55:49, time: 1.541, data_time: 0.035, memory: 16748, stage0_loss_instance_mil: 0.3550, stage0_bag_acc: 68.5394, stage0_mean_ious: 0.2439, stage0_s: 0.0000, stage0_m: 0.0574, stage0_l: 0.2010, stage0_h: 0.2421, stage1_loss_instance_mil: 0.2804, stage1_bag_acc: 60.4287, stage1_neg_loss: 0.0394, stage1_mean_ious: 0.2402, stage1_s: 0.0000, stage1_m: 0.0504, stage1_l: 0.1813, stage1_h: 0.2417, loss: 0.6748, grad_norm: 2.0328
2024-10-08 00:28:22,481 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-08 00:29:42,366 - mmdet - INFO - Epoch [5][50/180]	lr: 2.000e-02, eta: 0:52:38, time: 1.566, data_time: 0.085, memory: 16748, stage0_loss_instance_mil: 0.1873, stage0_bag_acc: 84.5828, stage0_mean_ious: 0.2632, stage0_s: 0.0000, stage0_m: 0.0398, stage0_l: 0.2115, stage0_h: 0.2653, stage1_loss_instance_mil: 0.2505, stage1_bag_acc: 83.7734, stage1_neg_loss: 0.0517, stage1_mean_ious: 0.2568, stage1_s: 0.0000, stage1_m: 0.0380, stage1_l: 0.2117, stage1_h: 0.2574, loss: 0.4894, grad_norm: 2.2189
