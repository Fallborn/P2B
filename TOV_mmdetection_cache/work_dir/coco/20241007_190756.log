2024-10-07 19:07:56,184 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+963dd25
------------------------------------------------------------

2024-10-07 19:07:57,224 - mmdet - INFO - Distributed training: False
2024-10-07 19:07:58,153 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=12,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-07 19:08:02,386 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-07 19:08:02,387 - mmdet - INFO - Use load_from_local loader
2024-10-07 19:08:02,704 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-07 19:08:02,712 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-07 19:08:02,712 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-07 19:09:18,843 - mmdet - INFO - Epoch [1][50/180]	lr: 1.978e-03, eta: 0:53:32, time: 1.523, data_time: 0.080, memory: 16687, stage0_loss_instance_mil: 0.6409, stage0_bag_acc: 31.4713, stage0_mean_ious: 0.2367, stage0_s: 0.0000, stage0_m: 0.0310, stage0_l: 0.2055, stage0_h: 0.2398, stage1_loss_instance_mil: 0.1819, stage1_bag_acc: 20.6865, stage1_neg_loss: 0.0121, stage1_mean_ious: 0.2223, stage1_s: 0.0000, stage1_m: 0.0300, stage1_l: 0.1891, stage1_h: 0.2258, loss: 0.8349, grad_norm: 4.0136
2024-10-07 19:10:21,543 - mmdet - INFO - Epoch [1][100/180]	lr: 3.976e-03, eta: 0:47:39, time: 1.254, data_time: 0.027, memory: 16687, stage0_loss_instance_mil: 0.3527, stage0_bag_acc: 69.4658, stage0_mean_ious: 0.4333, stage0_s: 0.0000, stage0_m: 0.0264, stage0_l: 0.1842, stage0_h: 0.4577, stage1_loss_instance_mil: 0.2852, stage1_bag_acc: 61.6639, stage1_neg_loss: 0.0440, stage1_mean_ious: 0.4145, stage1_s: 0.0000, stage1_m: 0.0331, stage1_l: 0.1863, stage1_h: 0.4361, loss: 0.6819, grad_norm: 5.4477
2024-10-07 19:11:31,141 - mmdet - INFO - Epoch [1][150/180]	lr: 5.974e-03, eta: 0:46:32, time: 1.392, data_time: 0.030, memory: 16734, stage0_loss_instance_mil: 0.1810, stage0_bag_acc: 87.9859, stage0_mean_ious: 0.4163, stage0_s: 0.0000, stage0_m: 0.0296, stage0_l: 0.2310, stage0_h: 0.4447, stage1_loss_instance_mil: 0.3108, stage1_bag_acc: 76.4919, stage1_neg_loss: 0.0625, stage1_mean_ious: 0.4143, stage1_s: 0.0000, stage1_m: 0.0338, stage1_l: 0.2313, stage1_h: 0.4417, loss: 0.5544, grad_norm: 6.1213
2024-10-07 19:12:15,589 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-07 19:13:32,625 - mmdet - INFO - Epoch [2][50/180]	lr: 9.171e-03, eta: 0:39:45, time: 1.517, data_time: 0.089, memory: 16734, stage0_loss_instance_mil: 0.1706, stage0_bag_acc: 87.7352, stage0_mean_ious: 0.4337, stage0_s: 0.0000, stage0_m: 0.0307, stage0_l: 0.1966, stage0_h: 0.4721, stage1_loss_instance_mil: 0.2284, stage1_bag_acc: 79.3549, stage1_neg_loss: 0.0601, stage1_mean_ious: 0.4360, stage1_s: 0.0000, stage1_m: 0.0305, stage1_l: 0.2039, stage1_h: 0.4736, loss: 0.4591, grad_norm: 5.2254
2024-10-07 19:14:37,594 - mmdet - INFO - Epoch [2][100/180]	lr: 1.117e-02, eta: 0:39:05, time: 1.299, data_time: 0.029, memory: 16734, stage0_loss_instance_mil: 0.1987, stage0_bag_acc: 88.5918, stage0_mean_ious: 0.3711, stage0_s: 0.0000, stage0_m: 0.0281, stage0_l: 0.1842, stage0_h: 0.4028, stage1_loss_instance_mil: 0.2584, stage1_bag_acc: 72.1421, stage1_neg_loss: 0.0378, stage1_mean_ious: 0.3738, stage1_s: 0.0000, stage1_m: 0.0274, stage1_l: 0.1764, stage1_h: 0.4074, loss: 0.4949, grad_norm: 3.7617
2024-10-07 19:15:40,097 - mmdet - INFO - Epoch [2][150/180]	lr: 1.317e-02, eta: 0:38:03, time: 1.250, data_time: 0.028, memory: 16734, stage0_loss_instance_mil: 0.2431, stage0_bag_acc: 83.8827, stage0_mean_ious: 0.3831, stage0_s: 0.0000, stage0_m: 0.0452, stage0_l: 0.2280, stage0_h: 0.4012, stage1_loss_instance_mil: 0.3254, stage1_bag_acc: 69.6951, stage1_neg_loss: 0.0499, stage1_mean_ious: 0.3950, stage1_s: 0.0000, stage1_m: 0.0557, stage1_l: 0.2535, stage1_h: 0.4109, loss: 0.6184, grad_norm: 4.9984
2024-10-07 19:16:16,673 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-07 19:17:26,695 - mmdet - INFO - Epoch [3][50/180]	lr: 1.636e-02, eta: 0:34:13, time: 1.386, data_time: 0.082, memory: 16734, stage0_loss_instance_mil: 0.4035, stage0_bag_acc: 65.5159, stage0_mean_ious: 0.3462, stage0_s: 0.0000, stage0_m: 0.0316, stage0_l: 0.2713, stage0_h: 0.3459, stage1_loss_instance_mil: 0.2254, stage1_bag_acc: 64.7920, stage1_neg_loss: 0.0376, stage1_mean_ious: 0.3450, stage1_s: 0.0000, stage1_m: 0.0302, stage1_l: 0.2721, stage1_h: 0.3447, loss: 0.6665, grad_norm: 4.0141
2024-10-07 19:18:27,622 - mmdet - INFO - Epoch [3][100/180]	lr: 1.836e-02, eta: 0:33:23, time: 1.219, data_time: 0.031, memory: 16734, stage0_loss_instance_mil: 0.2907, stage0_bag_acc: 77.5612, stage0_mean_ious: 0.3439, stage0_s: 0.0000, stage0_m: 0.0968, stage0_l: 0.2545, stage0_h: 0.3454, stage1_loss_instance_mil: 0.2757, stage1_bag_acc: 70.9139, stage1_neg_loss: 0.0538, stage1_mean_ious: 0.3463, stage1_s: 0.0000, stage1_m: 0.0859, stage1_l: 0.2626, stage1_h: 0.3481, loss: 0.6202, grad_norm: 3.0614
2024-10-07 19:19:29,856 - mmdet - INFO - Epoch [3][150/180]	lr: 2.000e-02, eta: 0:32:34, time: 1.245, data_time: 0.030, memory: 16734, stage0_loss_instance_mil: 0.2837, stage0_bag_acc: 78.1836, stage0_mean_ious: 0.3959, stage0_s: 0.0000, stage0_m: 0.0474, stage0_l: 0.2309, stage0_h: 0.4078, stage1_loss_instance_mil: 0.2300, stage1_bag_acc: 70.2845, stage1_neg_loss: 0.0426, stage1_mean_ious: 0.4062, stage1_s: 0.0000, stage1_m: 0.0496, stage1_l: 0.2467, stage1_h: 0.4166, loss: 0.5563, grad_norm: 2.7913
2024-10-07 19:20:06,791 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-07 19:21:20,143 - mmdet - INFO - Epoch [4][50/180]	lr: 2.000e-02, eta: 0:30:00, time: 1.449, data_time: 0.081, memory: 16734, stage0_loss_instance_mil: 0.2476, stage0_bag_acc: 80.7995, stage0_mean_ious: 0.4247, stage0_s: 0.0000, stage0_m: 0.0293, stage0_l: 0.2542, stage0_h: 0.4435, stage1_loss_instance_mil: 0.1822, stage1_bag_acc: 80.0133, stage1_neg_loss: 0.0388, stage1_mean_ious: 0.4308, stage1_s: 0.0000, stage1_m: 0.0287, stage1_l: 0.3015, stage1_h: 0.4438, loss: 0.4686, grad_norm: 2.6496
2024-10-07 19:22:34,234 - mmdet - INFO - Epoch [4][100/180]	lr: 2.000e-02, eta: 0:29:43, time: 1.482, data_time: 0.031, memory: 16734, stage0_loss_instance_mil: 0.3310, stage0_bag_acc: 72.1182, stage0_mean_ious: 0.3904, stage0_s: 0.0000, stage0_m: 0.0125, stage0_l: 0.2059, stage0_h: 0.4151, stage1_loss_instance_mil: 0.2361, stage1_bag_acc: 58.2477, stage1_neg_loss: 0.0608, stage1_mean_ious: 0.4030, stage1_s: 0.0000, stage1_m: 0.0119, stage1_l: 0.2225, stage1_h: 0.4259, loss: 0.6279, grad_norm: 4.1017
2024-10-07 19:23:47,631 - mmdet - INFO - Epoch [4][150/180]	lr: 2.000e-02, eta: 0:29:15, time: 1.468, data_time: 0.031, memory: 16734, stage0_loss_instance_mil: 0.2206, stage0_bag_acc: 84.2491, stage0_mean_ious: 0.4217, stage0_s: 0.0000, stage0_m: 0.0235, stage0_l: 0.1888, stage0_h: 0.4527, stage1_loss_instance_mil: 0.1723, stage1_bag_acc: 79.4466, stage1_neg_loss: 0.0388, stage1_mean_ious: 0.4212, stage1_s: 0.0000, stage1_m: 0.0256, stage1_l: 0.1996, stage1_h: 0.4487, loss: 0.4317, grad_norm: 2.8690
2024-10-07 19:24:31,173 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-07 19:25:49,953 - mmdet - INFO - Epoch [5][50/180]	lr: 2.000e-02, eta: 0:27:08, time: 1.558, data_time: 0.083, memory: 16734, stage0_loss_instance_mil: 0.1510, stage0_bag_acc: 91.3090, stage0_mean_ious: 0.4194, stage0_s: 0.0000, stage0_m: 0.0407, stage0_l: 0.2128, stage0_h: 0.4583, stage1_loss_instance_mil: 0.1831, stage1_bag_acc: 86.3941, stage1_neg_loss: 0.0514, stage1_mean_ious: 0.4176, stage1_s: 0.0000, stage1_m: 0.0404, stage1_l: 0.2189, stage1_h: 0.4545, loss: 0.3855, grad_norm: 2.9546
2024-10-07 19:27:01,997 - mmdet - INFO - Epoch [5][100/180]	lr: 2.000e-02, eta: 0:26:31, time: 1.441, data_time: 0.031, memory: 16734, stage0_loss_instance_mil: 0.1377, stage0_bag_acc: 91.0875, stage0_mean_ious: 0.4599, stage0_s: 0.0000, stage0_m: 0.0170, stage0_l: 0.2419, stage0_h: 0.4830, stage1_loss_instance_mil: 0.1613, stage1_bag_acc: 84.7621, stage1_neg_loss: 0.0443, stage1_mean_ious: 0.4673, stage1_s: 0.0000, stage1_m: 0.0176, stage1_l: 0.2625, stage1_h: 0.4885, loss: 0.3433, grad_norm: 2.7443
2024-10-07 19:28:17,091 - mmdet - INFO - Epoch [5][150/180]	lr: 2.000e-02, eta: 0:25:55, time: 1.502, data_time: 0.035, memory: 16734, stage0_loss_instance_mil: 0.1430, stage0_bag_acc: 89.6217, stage0_mean_ious: 0.4843, stage0_s: 0.0000, stage0_m: 0.0071, stage0_l: 0.2063, stage0_h: 0.5239, stage1_loss_instance_mil: 0.1482, stage1_bag_acc: 82.4309, stage1_neg_loss: 0.0380, stage1_mean_ious: 0.4913, stage1_s: 0.0000, stage1_m: 0.0074, stage1_l: 0.2212, stage1_h: 0.5284, loss: 0.3293, grad_norm: 2.4463
2024-10-07 19:29:02,245 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-07 19:30:19,791 - mmdet - INFO - Epoch [6][50/180]	lr: 2.000e-02, eta: 0:23:53, time: 1.530, data_time: 0.084, memory: 16734, stage0_loss_instance_mil: 0.1137, stage0_bag_acc: 92.2769, stage0_mean_ious: 0.4925, stage0_s: 0.0000, stage0_m: 0.0182, stage0_l: 0.2336, stage0_h: 0.5308, stage1_loss_instance_mil: 0.1078, stage1_bag_acc: 90.9692, stage1_neg_loss: 0.0418, stage1_mean_ious: 0.5019, stage1_s: 0.0000, stage1_m: 0.0215, stage1_l: 0.2557, stage1_h: 0.5380, loss: 0.2633, grad_norm: 2.3397
2024-10-07 19:31:33,255 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-07 19:31:33,255 - mmdet - INFO - Epoch [6][100/180]	lr: 2.000e-02, eta: 0:23:11, time: 1.469, data_time: 0.032, memory: 16734, stage0_loss_instance_mil: 0.1377, stage0_bag_acc: 90.0488, stage0_mean_ious: 0.4890, stage0_s: 0.0000, stage0_m: 0.0302, stage0_l: 0.2090, stage0_h: 0.5232, stage1_loss_instance_mil: 0.1078, stage1_bag_acc: 89.3629, stage1_neg_loss: 0.0548, stage1_mean_ious: 0.4917, stage1_s: 0.0000, stage1_m: 0.0319, stage1_l: 0.2198, stage1_h: 0.5236, loss: 0.3003, grad_norm: 2.8718
2024-10-07 19:32:47,613 - mmdet - INFO - Epoch [6][150/180]	lr: 2.000e-02, eta: 0:22:26, time: 1.487, data_time: 0.033, memory: 16734, stage0_loss_instance_mil: 0.1669, stage0_bag_acc: 87.8712, stage0_mean_ious: 0.5006, stage0_s: 0.0000, stage0_m: 0.0345, stage0_l: 0.2783, stage0_h: 0.5320, stage1_loss_instance_mil: 0.1840, stage1_bag_acc: 76.6940, stage1_neg_loss: 0.0293, stage1_mean_ious: 0.5184, stage1_s: 0.0000, stage1_m: 0.0414, stage1_l: 0.3107, stage1_h: 0.5459, loss: 0.3803, grad_norm: 1.9742
2024-10-07 19:33:31,487 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-07 19:34:50,131 - mmdet - INFO - Epoch [7][50/180]	lr: 2.000e-02, eta: 0:20:31, time: 1.552, data_time: 0.085, memory: 16734, stage0_loss_instance_mil: 0.1067, stage0_bag_acc: 92.5798, stage0_mean_ious: 0.4827, stage0_s: 0.0000, stage0_m: 0.0258, stage0_l: 0.2758, stage0_h: 0.5160, stage1_loss_instance_mil: 0.0905, stage1_bag_acc: 92.6395, stage1_neg_loss: 0.0408, stage1_mean_ious: 0.4994, stage1_s: 0.0000, stage1_m: 0.0322, stage1_l: 0.2962, stage1_h: 0.5297, loss: 0.2380, grad_norm: 2.1945
2024-10-07 19:36:04,730 - mmdet - INFO - Epoch [7][100/180]	lr: 2.000e-02, eta: 0:19:44, time: 1.492, data_time: 0.031, memory: 16734, stage0_loss_instance_mil: 0.0781, stage0_bag_acc: 94.7822, stage0_mean_ious: 0.4766, stage0_s: 0.0000, stage0_m: 0.0190, stage0_l: 0.2372, stage0_h: 0.5009, stage1_loss_instance_mil: 0.1102, stage1_bag_acc: 90.7670, stage1_neg_loss: 0.0359, stage1_mean_ious: 0.4921, stage1_s: 0.0000, stage1_m: 0.0229, stage1_l: 0.2497, stage1_h: 0.5159, loss: 0.2242, grad_norm: 1.8763
2024-10-07 19:37:19,686 - mmdet - INFO - Epoch [7][150/180]	lr: 2.000e-02, eta: 0:18:54, time: 1.499, data_time: 0.033, memory: 16734, stage0_loss_instance_mil: 0.0506, stage0_bag_acc: 97.1523, stage0_mean_ious: 0.4721, stage0_s: 0.0000, stage0_m: 0.0313, stage0_l: 0.2911, stage0_h: 0.4976, stage1_loss_instance_mil: 0.1100, stage1_bag_acc: 95.0657, stage1_neg_loss: 0.0383, stage1_mean_ious: 0.4853, stage1_s: 0.0000, stage1_m: 0.0385, stage1_l: 0.3279, stage1_h: 0.5059, loss: 0.1989, grad_norm: 1.8162
2024-10-07 19:38:03,848 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-07 19:39:21,421 - mmdet - INFO - Epoch [8][50/180]	lr: 2.000e-02, eta: 0:17:03, time: 1.533, data_time: 0.089, memory: 16734, stage0_loss_instance_mil: 0.0929, stage0_bag_acc: 93.5982, stage0_mean_ious: 0.4944, stage0_s: 0.0000, stage0_m: 0.0452, stage0_l: 0.2651, stage0_h: 0.5272, stage1_loss_instance_mil: 0.0658, stage1_bag_acc: 94.1625, stage1_neg_loss: 0.0385, stage1_mean_ious: 0.4996, stage1_s: 0.0000, stage1_m: 0.0539, stage1_l: 0.3017, stage1_h: 0.5261, loss: 0.1973, grad_norm: 2.1979
2024-10-07 19:40:36,004 - mmdet - INFO - Epoch [8][100/180]	lr: 2.000e-02, eta: 0:16:11, time: 1.492, data_time: 0.030, memory: 16734, stage0_loss_instance_mil: 0.1114, stage0_bag_acc: 93.2443, stage0_mean_ious: 0.4586, stage0_s: 0.0000, stage0_m: 0.0490, stage0_l: 0.2603, stage0_h: 0.4847, stage1_loss_instance_mil: 0.1165, stage1_bag_acc: 92.9063, stage1_neg_loss: 0.0508, stage1_mean_ious: 0.4668, stage1_s: 0.0000, stage1_m: 0.0607, stage1_l: 0.2913, stage1_h: 0.4891, loss: 0.2788, grad_norm: 2.6267
2024-10-07 19:41:48,683 - mmdet - INFO - Epoch [8][150/180]	lr: 2.000e-02, eta: 0:15:17, time: 1.454, data_time: 0.028, memory: 16734, stage0_loss_instance_mil: 0.1036, stage0_bag_acc: 93.2323, stage0_mean_ious: 0.4520, stage0_s: 0.0000, stage0_m: 0.0149, stage0_l: 0.2837, stage0_h: 0.4750, stage1_loss_instance_mil: 0.2342, stage1_bag_acc: 83.5231, stage1_neg_loss: 0.0369, stage1_mean_ious: 0.4624, stage1_s: 0.0000, stage1_m: 0.0164, stage1_l: 0.3293, stage1_h: 0.4781, loss: 0.3747, grad_norm: 2.1853
2024-10-07 19:42:33,554 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-07 19:43:52,618 - mmdet - INFO - Epoch [9][50/180]	lr: 2.000e-03, eta: 0:13:30, time: 1.555, data_time: 0.088, memory: 16742, stage0_loss_instance_mil: 0.0484, stage0_bag_acc: 96.5073, stage0_mean_ious: 0.4925, stage0_s: 0.0012, stage0_m: 0.0210, stage0_l: 0.2545, stage0_h: 0.5223, stage1_loss_instance_mil: 0.1458, stage1_bag_acc: 86.1194, stage1_neg_loss: 0.0407, stage1_mean_ious: 0.4980, stage1_s: 0.0013, stage1_m: 0.0268, stage1_l: 0.2970, stage1_h: 0.5205, loss: 0.2350, grad_norm: 1.8750
2024-10-07 19:45:07,156 - mmdet - INFO - Epoch [9][100/180]	lr: 2.000e-03, eta: 0:12:35, time: 1.491, data_time: 0.029, memory: 16742, stage0_loss_instance_mil: 0.0406, stage0_bag_acc: 97.0211, stage0_mean_ious: 0.4877, stage0_s: 0.0000, stage0_m: 0.0211, stage0_l: 0.2919, stage0_h: 0.5127, stage1_loss_instance_mil: 0.0772, stage1_bag_acc: 96.0910, stage1_neg_loss: 0.0348, stage1_mean_ious: 0.4972, stage1_s: 0.0000, stage1_m: 0.0250, stage1_l: 0.3201, stage1_h: 0.5184, loss: 0.1527, grad_norm: 1.4896
2024-10-07 19:46:18,082 - mmdet - INFO - Epoch [9][150/180]	lr: 2.000e-03, eta: 0:11:38, time: 1.419, data_time: 0.027, memory: 16742, stage0_loss_instance_mil: 0.0399, stage0_bag_acc: 97.0649, stage0_mean_ious: 0.4974, stage0_s: 0.0000, stage0_m: 0.0301, stage0_l: 0.2589, stage0_h: 0.5241, stage1_loss_instance_mil: 0.0722, stage1_bag_acc: 97.6525, stage1_neg_loss: 0.0407, stage1_mean_ious: 0.5067, stage1_s: 0.0000, stage1_m: 0.0391, stage1_l: 0.2762, stage1_h: 0.5312, loss: 0.1529, grad_norm: 1.5228
2024-10-07 19:47:00,800 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-07 19:48:17,552 - mmdet - INFO - Epoch [10][50/180]	lr: 2.000e-03, eta: 0:09:53, time: 1.519, data_time: 0.081, memory: 16742, stage0_loss_instance_mil: 0.0343, stage0_bag_acc: 97.2542, stage0_mean_ious: 0.4925, stage0_s: 0.0000, stage0_m: 0.0450, stage0_l: 0.2754, stage0_h: 0.5212, stage1_loss_instance_mil: 0.0622, stage1_bag_acc: 97.8924, stage1_neg_loss: 0.0300, stage1_mean_ious: 0.4944, stage1_s: 0.0000, stage1_m: 0.0528, stage1_l: 0.2938, stage1_h: 0.5187, loss: 0.1264, grad_norm: 1.2994
2024-10-07 19:49:28,458 - mmdet - INFO - Epoch [10][100/180]	lr: 2.000e-03, eta: 0:08:55, time: 1.418, data_time: 0.027, memory: 16742, stage0_loss_instance_mil: 0.0286, stage0_bag_acc: 98.1965, stage0_mean_ious: 0.4856, stage0_s: 0.0000, stage0_m: 0.0231, stage0_l: 0.2559, stage0_h: 0.5207, stage1_loss_instance_mil: 0.0578, stage1_bag_acc: 97.1355, stage1_neg_loss: 0.0317, stage1_mean_ious: 0.4942, stage1_s: 0.0000, stage1_m: 0.0196, stage1_l: 0.3080, stage1_h: 0.5221, loss: 0.1180, grad_norm: 1.3627
2024-10-07 19:50:42,794 - mmdet - INFO - Epoch [10][150/180]	lr: 2.000e-03, eta: 0:07:57, time: 1.487, data_time: 0.029, memory: 16742, stage0_loss_instance_mil: 0.0299, stage0_bag_acc: 97.9277, stage0_mean_ious: 0.5042, stage0_s: 0.0000, stage0_m: 0.0124, stage0_l: 0.2727, stage0_h: 0.5347, stage1_loss_instance_mil: 0.0554, stage1_bag_acc: 98.5149, stage1_neg_loss: 0.0281, stage1_mean_ious: 0.5081, stage1_s: 0.0000, stage1_m: 0.0167, stage1_l: 0.3079, stage1_h: 0.5329, loss: 0.1134, grad_norm: 1.1937
2024-10-07 19:51:23,864 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-07 19:52:27,994 - mmdet - INFO - Epoch [11][50/180]	lr: 2.000e-03, eta: 0:06:14, time: 1.267, data_time: 0.073, memory: 16742, stage0_loss_instance_mil: 0.0276, stage0_bag_acc: 98.1986, stage0_mean_ious: 0.4904, stage0_s: 0.0000, stage0_m: 0.0584, stage0_l: 0.2554, stage0_h: 0.5242, stage1_loss_instance_mil: 0.0521, stage1_bag_acc: 98.2151, stage1_neg_loss: 0.0261, stage1_mean_ious: 0.4968, stage1_s: 0.0000, stage1_m: 0.0546, stage1_l: 0.2986, stage1_h: 0.5255, loss: 0.1058, grad_norm: 1.2330
2024-10-07 19:53:28,455 - mmdet - INFO - Epoch [11][100/180]	lr: 2.000e-03, eta: 0:05:13, time: 1.209, data_time: 0.025, memory: 16742, stage0_loss_instance_mil: 0.0296, stage0_bag_acc: 98.0038, stage0_mean_ious: 0.4938, stage0_s: 0.0000, stage0_m: 0.0255, stage0_l: 0.2429, stage0_h: 0.5260, stage1_loss_instance_mil: 0.0486, stage1_bag_acc: 98.1008, stage1_neg_loss: 0.0327, stage1_mean_ious: 0.5015, stage1_s: 0.0000, stage1_m: 0.0296, stage1_l: 0.2751, stage1_h: 0.5293, loss: 0.1108, grad_norm: 1.2872
2024-10-07 19:54:29,477 - mmdet - INFO - Epoch [11][150/180]	lr: 2.000e-03, eta: 0:04:13, time: 1.220, data_time: 0.026, memory: 16742, stage0_loss_instance_mil: 0.0186, stage0_bag_acc: 98.8015, stage0_mean_ious: 0.5080, stage0_s: 0.0000, stage0_m: 0.0371, stage0_l: 0.2228, stage0_h: 0.5391, stage1_loss_instance_mil: 0.0508, stage1_bag_acc: 98.8668, stage1_neg_loss: 0.0274, stage1_mean_ious: 0.5137, stage1_s: 0.0000, stage1_m: 0.0348, stage1_l: 0.2464, stage1_h: 0.5417, loss: 0.0968, grad_norm: 1.1023
2024-10-07 19:55:04,680 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-07 19:56:12,193 - mmdet - INFO - Epoch [12][50/180]	lr: 2.000e-04, eta: 0:02:35, time: 1.335, data_time: 0.075, memory: 16742, stage0_loss_instance_mil: 0.0239, stage0_bag_acc: 98.0727, stage0_mean_ious: 0.5149, stage0_s: 0.0012, stage0_m: 0.0313, stage0_l: 0.2227, stage0_h: 0.5394, stage1_loss_instance_mil: 0.0454, stage1_bag_acc: 98.7085, stage1_neg_loss: 0.0336, stage1_mean_ious: 0.5210, stage1_s: 0.0013, stage1_m: 0.0284, stage1_l: 0.2542, stage1_h: 0.5421, loss: 0.1029, grad_norm: 1.2729
2024-10-07 19:57:24,470 - mmdet - INFO - Epoch [12][100/180]	lr: 2.000e-04, eta: 0:01:35, time: 1.446, data_time: 0.029, memory: 16742, stage0_loss_instance_mil: 0.0226, stage0_bag_acc: 98.6995, stage0_mean_ious: 0.4996, stage0_s: 0.0000, stage0_m: 0.0126, stage0_l: 0.2720, stage0_h: 0.5285, stage1_loss_instance_mil: 0.0427, stage1_bag_acc: 98.4665, stage1_neg_loss: 0.0308, stage1_mean_ious: 0.5063, stage1_s: 0.0000, stage1_m: 0.0120, stage1_l: 0.3039, stage1_h: 0.5311, loss: 0.0961, grad_norm: 1.2003
2024-10-07 19:58:37,414 - mmdet - INFO - Epoch [12][150/180]	lr: 2.000e-04, eta: 0:00:36, time: 1.459, data_time: 0.030, memory: 16742, stage0_loss_instance_mil: 0.0201, stage0_bag_acc: 98.6949, stage0_mean_ious: 0.5039, stage0_s: 0.0000, stage0_m: 0.0227, stage0_l: 0.2615, stage0_h: 0.5335, stage1_loss_instance_mil: 0.0448, stage1_bag_acc: 98.9595, stage1_neg_loss: 0.0291, stage1_mean_ious: 0.5129, stage1_s: 0.0000, stage1_m: 0.0279, stage1_l: 0.2974, stage1_h: 0.5378, loss: 0.0940, grad_norm: 1.1269
2024-10-07 19:59:22,308 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-07 20:01:09,522 - mmdet - INFO - Evaluating bbox...
2024-10-07 20:01:10,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1308
2024-10-07 20:01:10,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4249
2024-10-07 20:01:10,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2409
2024-10-07 20:01:10,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0892
2024-10-07 20:01:10,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0418
2024-10-07 20:01:10,526 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0168
2024-10-07 20:01:10,526 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-07 20:01:10,526 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1604
2024-10-07 20:01:10,526 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1254
2024-10-07 20:01:10,526 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1493
2024-10-07 20:01:10,526 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2339
2024-10-07 20:01:10,526 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.5780
2024-10-07 20:01:10,526 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2339
2024-10-07 20:01:10,526 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2339
2024-10-07 20:01:10,527 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3049
2024-10-07 20:01:10,527 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2403
2024-10-07 20:01:10,527 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2657
2024-10-07 20:01:10,542 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-07 20:01:10,543 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.1310, bbox_mAP_50: 0.4250, bbox_mAP_75: 0.2410, bbox_mAP_s: 0.0890, bbox_mAP_m: 0.0420, bbox_mAP_l: 0.0170, bbox_mAP_copypaste: 0.131 0.425 0.241 0.089 0.042 0.017
2024-10-07 20:02:57,154 - mmdet - INFO - Evaluating bbox...
2024-10-07 20:02:58,092 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1308
2024-10-07 20:02:58,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.4249
2024-10-07 20:02:58,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2409
2024-10-07 20:02:58,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0892
2024-10-07 20:02:58,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0418
2024-10-07 20:02:58,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0168
2024-10-07 20:02:58,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-07 20:02:58,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1604
2024-10-07 20:02:58,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1254
2024-10-07 20:02:58,094 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1493
2024-10-07 20:02:58,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2339
2024-10-07 20:02:58,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.5780
2024-10-07 20:02:58,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2339
2024-10-07 20:02:58,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2339
2024-10-07 20:02:58,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.3049
2024-10-07 20:02:58,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2403
2024-10-07 20:02:58,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.2657
2024-10-07 20:02:59,399 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+963dd25
------------------------------------------------------------

2024-10-07 20:03:00,290 - mmdet - INFO - Distributed training: False
2024-10-07 20:03:01,236 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=12,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-07 20:03:02,278 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-07 20:03:02,278 - mmdet - INFO - Use load_from_local loader
2024-10-07 20:03:02,550 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-07 20:03:02,560 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-07 20:03:02,561 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-07 20:04:17,991 - mmdet - INFO - Epoch [1][50/180]	lr: 1.978e-03, eta: 0:53:03, time: 1.509, data_time: 0.081, memory: 16742, stage0_loss_instance_mil: 0.6499, stage0_bag_acc: 31.3161, stage0_mean_ious: 0.3386, stage0_s: 0.0000, stage0_m: 0.0114, stage0_l: 0.1957, stage0_h: 0.3495, stage1_loss_instance_mil: 0.1800, stage1_bag_acc: 24.2020, stage1_neg_loss: 0.0087, stage1_mean_ious: 0.3155, stage1_s: 0.0000, stage1_m: 0.0112, stage1_l: 0.1710, stage1_h: 0.3270, loss: 0.8386, grad_norm: 3.6875
2024-10-07 20:05:33,156 - mmdet - INFO - Epoch [1][100/180]	lr: 3.976e-03, eta: 0:51:42, time: 1.503, data_time: 0.032, memory: 16742, stage0_loss_instance_mil: 0.3136, stage0_bag_acc: 73.6372, stage0_mean_ious: 0.4150, stage0_s: 0.0000, stage0_m: 0.0348, stage0_l: 0.2744, stage0_h: 0.4376, stage1_loss_instance_mil: 0.3564, stage1_bag_acc: 65.5852, stage1_neg_loss: 0.0599, stage1_mean_ious: 0.3921, stage1_s: 0.0000, stage1_m: 0.0337, stage1_l: 0.2726, stage1_h: 0.4110, loss: 0.7299, grad_norm: 7.6902
2024-10-07 20:06:45,296 - mmdet - INFO - Epoch [1][150/180]	lr: 5.974e-03, eta: 0:49:44, time: 1.443, data_time: 0.031, memory: 16742, stage0_loss_instance_mil: 0.3139, stage0_bag_acc: 75.3802, stage0_mean_ious: 0.2658, stage0_s: 0.0000, stage0_m: 0.0706, stage0_l: 0.2261, stage0_h: 0.2657, stage1_loss_instance_mil: 0.3416, stage1_bag_acc: 59.6388, stage1_neg_loss: 0.0747, stage1_mean_ious: 0.2648, stage1_s: 0.0000, stage1_m: 0.0749, stage1_l: 0.2150, stage1_h: 0.2662, loss: 0.7301, grad_norm: 6.6713
2024-10-07 20:07:28,295 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-07 20:08:45,801 - mmdet - INFO - Epoch [2][50/180]	lr: 9.171e-03, eta: 0:41:46, time: 1.519, data_time: 0.085, memory: 16742, stage0_loss_instance_mil: 0.2864, stage0_bag_acc: 80.6729, stage0_mean_ious: 0.2447, stage0_s: 0.0000, stage0_m: 0.0696, stage0_l: 0.1859, stage0_h: 0.2443, stage1_loss_instance_mil: 0.4333, stage1_bag_acc: 55.8727, stage1_neg_loss: 0.0560, stage1_mean_ious: 0.2321, stage1_s: 0.0000, stage1_m: 0.0657, stage1_l: 0.1763, stage1_h: 0.2320, loss: 0.7758, grad_norm: 4.5179
2024-10-07 20:09:58,599 - mmdet - INFO - Epoch [2][100/180]	lr: 1.117e-02, eta: 0:41:34, time: 1.456, data_time: 0.027, memory: 16742, stage0_loss_instance_mil: 0.2639, stage0_bag_acc: 85.0383, stage0_mean_ious: 0.2959, stage0_s: 0.0000, stage0_m: 0.0566, stage0_l: 0.2247, stage0_h: 0.2999, stage1_loss_instance_mil: 0.4897, stage1_bag_acc: 53.1060, stage1_neg_loss: 0.0830, stage1_mean_ious: 0.2999, stage1_s: 0.0000, stage1_m: 0.0526, stage1_l: 0.2397, stage1_h: 0.3024, loss: 0.8366, grad_norm: 4.4384
2024-10-07 20:11:11,786 - mmdet - INFO - Epoch [2][150/180]	lr: 1.317e-02, eta: 0:41:05, time: 1.464, data_time: 0.036, memory: 16742, stage0_loss_instance_mil: 0.4362, stage0_bag_acc: 60.9232, stage0_mean_ious: 0.3461, stage0_s: 0.0000, stage0_m: 0.0633, stage0_l: 0.2241, stage0_h: 0.3658, stage1_loss_instance_mil: 0.2677, stage1_bag_acc: 51.5403, stage1_neg_loss: 0.0376, stage1_mean_ious: 0.3323, stage1_s: 0.0000, stage1_m: 0.0486, stage1_l: 0.2228, stage1_h: 0.3509, loss: 0.7415, grad_norm: 2.7101
2024-10-07 20:11:55,717 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-07 20:13:11,250 - mmdet - INFO - Epoch [3][50/180]	lr: 1.636e-02, eta: 0:36:54, time: 1.482, data_time: 0.077, memory: 16742, stage0_loss_instance_mil: 0.3609, stage0_bag_acc: 72.0179, stage0_mean_ious: 0.3186, stage0_s: 0.0000, stage0_m: 0.0406, stage0_l: 0.1957, stage0_h: 0.3318, stage1_loss_instance_mil: 0.3241, stage1_bag_acc: 62.4062, stage1_neg_loss: 0.0441, stage1_mean_ious: 0.3037, stage1_s: 0.0000, stage1_m: 0.0339, stage1_l: 0.1826, stage1_h: 0.3182, loss: 0.7291, grad_norm: 4.0663
2024-10-07 20:14:24,350 - mmdet - INFO - Epoch [3][100/180]	lr: 1.836e-02, eta: 0:36:27, time: 1.462, data_time: 0.036, memory: 16742, stage0_loss_instance_mil: 0.3001, stage0_bag_acc: 76.3134, stage0_mean_ious: 0.2833, stage0_s: 0.0000, stage0_m: 0.0382, stage0_l: 0.2050, stage0_h: 0.2861, stage1_loss_instance_mil: 0.3635, stage1_bag_acc: 69.7981, stage1_neg_loss: 0.0711, stage1_mean_ious: 0.2747, stage1_s: 0.0000, stage1_m: 0.0259, stage1_l: 0.1943, stage1_h: 0.2786, loss: 0.7347, grad_norm: 3.7488
2024-10-07 20:15:37,740 - mmdet - INFO - Epoch [3][150/180]	lr: 2.000e-02, eta: 0:35:52, time: 1.468, data_time: 0.030, memory: 16742, stage0_loss_instance_mil: 0.2758, stage0_bag_acc: 82.2134, stage0_mean_ious: 0.2140, stage0_s: 0.0013, stage0_m: 0.0654, stage0_l: 0.2099, stage0_h: 0.2083, stage1_loss_instance_mil: 0.3615, stage1_bag_acc: 71.5305, stage1_neg_loss: 0.0613, stage1_mean_ious: 0.2041, stage1_s: 0.0024, stage1_m: 0.0495, stage1_l: 0.2102, stage1_h: 0.1995, loss: 0.6986, grad_norm: 2.7641
2024-10-07 20:16:21,654 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-07 20:17:40,752 - mmdet - INFO - Epoch [4][50/180]	lr: 2.000e-02, eta: 0:32:55, time: 1.545, data_time: 0.087, memory: 16742, stage0_loss_instance_mil: 0.4279, stage0_bag_acc: 61.1163, stage0_mean_ious: 0.2744, stage0_s: 0.0000, stage0_m: 0.0497, stage0_l: 0.2329, stage0_h: 0.2807, stage1_loss_instance_mil: 0.3073, stage1_bag_acc: 47.6534, stage1_neg_loss: 0.0337, stage1_mean_ious: 0.2684, stage1_s: 0.0000, stage1_m: 0.0462, stage1_l: 0.2394, stage1_h: 0.2726, loss: 0.7689, grad_norm: 2.1503
2024-10-07 20:18:54,136 - mmdet - INFO - Epoch [4][100/180]	lr: 2.000e-02, eta: 0:32:17, time: 1.468, data_time: 0.032, memory: 16742, stage0_loss_instance_mil: 0.3170, stage0_bag_acc: 73.5339, stage0_mean_ious: 0.2472, stage0_s: 0.0000, stage0_m: 0.0385, stage0_l: 0.2296, stage0_h: 0.2497, stage1_loss_instance_mil: 0.2462, stage1_bag_acc: 77.2832, stage1_neg_loss: 0.0645, stage1_mean_ious: 0.2417, stage1_s: 0.0000, stage1_m: 0.0302, stage1_l: 0.2220, stage1_h: 0.2453, loss: 0.6277, grad_norm: 2.9588
2024-10-07 20:20:06,802 - mmdet - INFO - Epoch [4][150/180]	lr: 2.000e-02, eta: 0:31:32, time: 1.453, data_time: 0.033, memory: 16742, stage0_loss_instance_mil: 0.2936, stage0_bag_acc: 79.0203, stage0_mean_ious: 0.2731, stage0_s: 0.0000, stage0_m: 0.0370, stage0_l: 0.1956, stage0_h: 0.2763, stage1_loss_instance_mil: 0.3627, stage1_bag_acc: 61.5190, stage1_neg_loss: 0.0526, stage1_mean_ious: 0.2669, stage1_s: 0.0000, stage1_m: 0.0299, stage1_l: 0.1961, stage1_h: 0.2716, loss: 0.7089, grad_norm: 2.3762
2024-10-07 20:20:51,439 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-07 20:22:08,891 - mmdet - INFO - Epoch [5][50/180]	lr: 2.000e-02, eta: 0:29:01, time: 1.518, data_time: 0.086, memory: 16742, stage0_loss_instance_mil: 0.3808, stage0_bag_acc: 67.2711, stage0_mean_ious: 0.3742, stage0_s: 0.0000, stage0_m: 0.0553, stage0_l: 0.2590, stage0_h: 0.3940, stage1_loss_instance_mil: 0.3049, stage1_bag_acc: 60.1491, stage1_neg_loss: 0.0489, stage1_mean_ious: 0.3587, stage1_s: 0.0000, stage1_m: 0.0550, stage1_l: 0.2566, stage1_h: 0.3760, loss: 0.7347, grad_norm: 2.0964
2024-10-07 20:23:22,654 - mmdet - INFO - Epoch [5][100/180]	lr: 2.000e-02, eta: 0:28:16, time: 1.475, data_time: 0.029, memory: 16742, stage0_loss_instance_mil: 0.2658, stage0_bag_acc: 80.2598, stage0_mean_ious: 0.3684, stage0_s: 0.0000, stage0_m: 0.0285, stage0_l: 0.2633, stage0_h: 0.3798, stage1_loss_instance_mil: 0.3644, stage1_bag_acc: 68.2082, stage1_neg_loss: 0.0565, stage1_mean_ious: 0.3634, stage1_s: 0.0000, stage1_m: 0.0278, stage1_l: 0.2732, stage1_h: 0.3710, loss: 0.6867, grad_norm: 2.1424
2024-10-07 20:24:36,023 - mmdet - INFO - Epoch [5][150/180]	lr: 2.000e-02, eta: 0:27:28, time: 1.467, data_time: 0.030, memory: 16742, stage0_loss_instance_mil: 0.2521, stage0_bag_acc: 83.4961, stage0_mean_ious: 0.3293, stage0_s: 0.0000, stage0_m: 0.0362, stage0_l: 0.1952, stage0_h: 0.3393, stage1_loss_instance_mil: 0.3524, stage1_bag_acc: 72.4131, stage1_neg_loss: 0.0607, stage1_mean_ious: 0.3264, stage1_s: 0.0000, stage1_m: 0.0394, stage1_l: 0.2287, stage1_h: 0.3291, loss: 0.6652, grad_norm: 2.5377
2024-10-07 20:25:19,729 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-07 20:26:37,838 - mmdet - INFO - Epoch [6][50/180]	lr: 2.000e-02, eta: 0:25:13, time: 1.529, data_time: 0.077, memory: 16742, stage0_loss_instance_mil: 0.2159, stage0_bag_acc: 87.1873, stage0_mean_ious: 0.3546, stage0_s: 0.0000, stage0_m: 0.0342, stage0_l: 0.1885, stage0_h: 0.3689, stage1_loss_instance_mil: 0.3502, stage1_bag_acc: 80.4464, stage1_neg_loss: 0.0658, stage1_mean_ious: 0.3324, stage1_s: 0.0000, stage1_m: 0.0283, stage1_l: 0.1848, stage1_h: 0.3444, loss: 0.6319, grad_norm: 2.5708
2024-10-07 20:27:49,300 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-07 20:27:49,300 - mmdet - INFO - Epoch [6][100/180]	lr: 2.000e-02, eta: 0:24:21, time: 1.429, data_time: 0.025, memory: 16742, stage0_loss_instance_mil: 0.1557, stage0_bag_acc: 88.7995, stage0_mean_ious: 0.3885, stage0_s: 0.0000, stage0_m: 0.0704, stage0_l: 0.2234, stage0_h: 0.4031, stage1_loss_instance_mil: 0.3001, stage1_bag_acc: 85.8675, stage1_neg_loss: 0.0764, stage1_mean_ious: 0.3840, stage1_s: 0.0000, stage1_m: 0.0738, stage1_l: 0.2151, stage1_h: 0.3989, loss: 0.5322, grad_norm: 2.7202
2024-10-07 20:29:01,917 - mmdet - INFO - Epoch [6][150/180]	lr: 2.000e-02, eta: 0:23:28, time: 1.452, data_time: 0.033, memory: 16742, stage0_loss_instance_mil: 0.2366, stage0_bag_acc: 83.8575, stage0_mean_ious: 0.3584, stage0_s: 0.0000, stage0_m: 0.0504, stage0_l: 0.2454, stage0_h: 0.3675, stage1_loss_instance_mil: 0.2680, stage1_bag_acc: 87.3175, stage1_neg_loss: 0.0644, stage1_mean_ious: 0.3544, stage1_s: 0.0000, stage1_m: 0.0513, stage1_l: 0.2490, stage1_h: 0.3624, loss: 0.5690, grad_norm: 2.4365
2024-10-07 20:29:45,876 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-07 20:31:05,565 - mmdet - INFO - Epoch [7][50/180]	lr: 2.000e-02, eta: 0:21:25, time: 1.563, data_time: 0.084, memory: 16742, stage0_loss_instance_mil: 0.1923, stage0_bag_acc: 86.4986, stage0_mean_ious: 0.3921, stage0_s: 0.0019, stage0_m: 0.0396, stage0_l: 0.1823, stage0_h: 0.4170, stage1_loss_instance_mil: 0.3131, stage1_bag_acc: 75.1923, stage1_neg_loss: 0.0543, stage1_mean_ious: 0.3948, stage1_s: 0.0021, stage1_m: 0.0348, stage1_l: 0.1870, stage1_h: 0.4177, loss: 0.5596, grad_norm: 2.0500
2024-10-07 20:32:18,878 - mmdet - INFO - Epoch [7][100/180]	lr: 2.000e-02, eta: 0:20:32, time: 1.466, data_time: 0.029, memory: 16742, stage0_loss_instance_mil: 0.1247, stage0_bag_acc: 91.9310, stage0_mean_ious: 0.4005, stage0_s: 0.0000, stage0_m: 0.0464, stage0_l: 0.2526, stage0_h: 0.4208, stage1_loss_instance_mil: 0.2695, stage1_bag_acc: 86.0359, stage1_neg_loss: 0.0620, stage1_mean_ious: 0.3951, stage1_s: 0.0000, stage1_m: 0.0435, stage1_l: 0.2565, stage1_h: 0.4161, loss: 0.4563, grad_norm: 2.1261
2024-10-07 20:33:33,382 - mmdet - INFO - Epoch [7][150/180]	lr: 2.000e-02, eta: 0:19:38, time: 1.490, data_time: 0.032, memory: 16742, stage0_loss_instance_mil: 0.0804, stage0_bag_acc: 94.2093, stage0_mean_ious: 0.4147, stage0_s: 0.0000, stage0_m: 0.0278, stage0_l: 0.2123, stage0_h: 0.4321, stage1_loss_instance_mil: 0.2783, stage1_bag_acc: 94.8374, stage1_neg_loss: 0.0729, stage1_mean_ious: 0.4053, stage1_s: 0.0000, stage1_m: 0.0265, stage1_l: 0.2218, stage1_h: 0.4212, loss: 0.4316, grad_norm: 2.0478
2024-10-07 20:34:15,604 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-07 20:35:32,741 - mmdet - INFO - Epoch [8][50/180]	lr: 2.000e-02, eta: 0:17:40, time: 1.514, data_time: 0.079, memory: 16742, stage0_loss_instance_mil: 0.1204, stage0_bag_acc: 93.0417, stage0_mean_ious: 0.4078, stage0_s: 0.0000, stage0_m: 0.0295, stage0_l: 0.2236, stage0_h: 0.4232, stage1_loss_instance_mil: 0.2928, stage1_bag_acc: 84.0248, stage1_neg_loss: 0.0586, stage1_mean_ious: 0.4029, stage1_s: 0.0000, stage1_m: 0.0289, stage1_l: 0.2385, stage1_h: 0.4139, loss: 0.4718, grad_norm: 2.0558
2024-10-07 20:36:46,183 - mmdet - INFO - Epoch [8][100/180]	lr: 2.000e-02, eta: 0:16:44, time: 1.469, data_time: 0.029, memory: 16742, stage0_loss_instance_mil: 0.1143, stage0_bag_acc: 92.8046, stage0_mean_ious: 0.4081, stage0_s: 0.0000, stage0_m: 0.0298, stage0_l: 0.2865, stage0_h: 0.4245, stage1_loss_instance_mil: 0.2403, stage1_bag_acc: 94.0997, stage1_neg_loss: 0.0686, stage1_mean_ious: 0.4064, stage1_s: 0.0000, stage1_m: 0.0281, stage1_l: 0.2947, stage1_h: 0.4208, loss: 0.4231, grad_norm: 1.9442
2024-10-07 20:37:59,558 - mmdet - INFO - Epoch [8][150/180]	lr: 2.000e-02, eta: 0:15:47, time: 1.467, data_time: 0.027, memory: 16742, stage0_loss_instance_mil: 0.0944, stage0_bag_acc: 94.9503, stage0_mean_ious: 0.4315, stage0_s: 0.0000, stage0_m: 0.0411, stage0_l: 0.2831, stage0_h: 0.4579, stage1_loss_instance_mil: 0.2180, stage1_bag_acc: 89.4075, stage1_neg_loss: 0.0645, stage1_mean_ious: 0.4279, stage1_s: 0.0000, stage1_m: 0.0433, stage1_l: 0.3049, stage1_h: 0.4495, loss: 0.3768, grad_norm: 1.7640
2024-10-07 20:38:43,430 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-07 20:40:00,979 - mmdet - INFO - Epoch [9][50/180]	lr: 2.000e-03, eta: 0:13:54, time: 1.522, data_time: 0.080, memory: 16742, stage0_loss_instance_mil: 0.1010, stage0_bag_acc: 93.9049, stage0_mean_ious: 0.4267, stage0_s: 0.0000, stage0_m: 0.0470, stage0_l: 0.2491, stage0_h: 0.4464, stage1_loss_instance_mil: 0.2378, stage1_bag_acc: 94.9948, stage1_neg_loss: 0.0444, stage1_mean_ious: 0.4182, stage1_s: 0.0000, stage1_m: 0.0546, stage1_l: 0.2968, stage1_h: 0.4315, loss: 0.3832, grad_norm: 1.5860
2024-10-07 20:41:13,829 - mmdet - INFO - Epoch [9][100/180]	lr: 2.000e-03, eta: 0:12:56, time: 1.457, data_time: 0.028, memory: 16742, stage0_loss_instance_mil: 0.0695, stage0_bag_acc: 95.9010, stage0_mean_ious: 0.4311, stage0_s: 0.0000, stage0_m: 0.0547, stage0_l: 0.2805, stage0_h: 0.4551, stage1_loss_instance_mil: 0.1506, stage1_bag_acc: 97.4360, stage1_neg_loss: 0.0611, stage1_mean_ious: 0.4232, stage1_s: 0.0000, stage1_m: 0.0606, stage1_l: 0.3028, stage1_h: 0.4416, loss: 0.2812, grad_norm: 1.2985
2024-10-07 20:42:27,062 - mmdet - INFO - Epoch [9][150/180]	lr: 2.000e-03, eta: 0:11:57, time: 1.465, data_time: 0.029, memory: 16742, stage0_loss_instance_mil: 0.0686, stage0_bag_acc: 96.1684, stage0_mean_ious: 0.4373, stage0_s: 0.0000, stage0_m: 0.0496, stage0_l: 0.2359, stage0_h: 0.4614, stage1_loss_instance_mil: 0.1598, stage1_bag_acc: 97.3296, stage1_neg_loss: 0.0555, stage1_mean_ious: 0.4307, stage1_s: 0.0000, stage1_m: 0.0547, stage1_l: 0.2557, stage1_h: 0.4502, loss: 0.2839, grad_norm: 1.3229
2024-10-07 20:43:10,561 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-07 20:44:27,970 - mmdet - INFO - Epoch [10][50/180]	lr: 2.000e-03, eta: 0:10:09, time: 1.519, data_time: 0.080, memory: 16742, stage0_loss_instance_mil: 0.0631, stage0_bag_acc: 96.2406, stage0_mean_ious: 0.4314, stage0_s: 0.0000, stage0_m: 0.0540, stage0_l: 0.2876, stage0_h: 0.4493, stage1_loss_instance_mil: 0.1476, stage1_bag_acc: 97.9449, stage1_neg_loss: 0.0578, stage1_mean_ious: 0.4293, stage1_s: 0.0000, stage1_m: 0.0548, stage1_l: 0.3181, stage1_h: 0.4405, loss: 0.2685, grad_norm: 1.3376
2024-10-07 20:45:40,602 - mmdet - INFO - Epoch [10][100/180]	lr: 2.000e-03, eta: 0:09:10, time: 1.453, data_time: 0.028, memory: 16742, stage0_loss_instance_mil: 0.0589, stage0_bag_acc: 95.9425, stage0_mean_ious: 0.4441, stage0_s: 0.0000, stage0_m: 0.0392, stage0_l: 0.2642, stage0_h: 0.4670, stage1_loss_instance_mil: 0.1388, stage1_bag_acc: 98.2527, stage1_neg_loss: 0.0498, stage1_mean_ious: 0.4362, stage1_s: 0.0000, stage1_m: 0.0432, stage1_l: 0.2863, stage1_h: 0.4531, loss: 0.2475, grad_norm: 1.1302
2024-10-07 20:46:53,799 - mmdet - INFO - Epoch [10][150/180]	lr: 2.000e-03, eta: 0:08:10, time: 1.464, data_time: 0.028, memory: 16742, stage0_loss_instance_mil: 0.0474, stage0_bag_acc: 97.2569, stage0_mean_ious: 0.4345, stage0_s: 0.0000, stage0_m: 0.0276, stage0_l: 0.2631, stage0_h: 0.4595, stage1_loss_instance_mil: 0.1393, stage1_bag_acc: 98.2679, stage1_neg_loss: 0.0543, stage1_mean_ious: 0.4324, stage1_s: 0.0000, stage1_m: 0.0309, stage1_l: 0.2870, stage1_h: 0.4534, loss: 0.2409, grad_norm: 1.2061
2024-10-07 20:47:38,687 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-07 20:48:55,683 - mmdet - INFO - Epoch [11][50/180]	lr: 2.000e-03, eta: 0:06:25, time: 1.506, data_time: 0.085, memory: 16742, stage0_loss_instance_mil: 0.0589, stage0_bag_acc: 96.1678, stage0_mean_ious: 0.4433, stage0_s: 0.0000, stage0_m: 0.0260, stage0_l: 0.2366, stage0_h: 0.4705, stage1_loss_instance_mil: 0.1337, stage1_bag_acc: 97.6860, stage1_neg_loss: 0.0555, stage1_mean_ious: 0.4354, stage1_s: 0.0000, stage1_m: 0.0331, stage1_l: 0.2727, stage1_h: 0.4553, loss: 0.2481, grad_norm: 1.3640
2024-10-07 20:50:10,102 - mmdet - INFO - Epoch [11][100/180]	lr: 2.000e-03, eta: 0:05:24, time: 1.488, data_time: 0.027, memory: 16742, stage0_loss_instance_mil: 0.0536, stage0_bag_acc: 96.2852, stage0_mean_ious: 0.4395, stage0_s: 0.0000, stage0_m: 0.0492, stage0_l: 0.2722, stage0_h: 0.4630, stage1_loss_instance_mil: 0.1478, stage1_bag_acc: 97.1891, stage1_neg_loss: 0.0505, stage1_mean_ious: 0.4331, stage1_s: 0.0000, stage1_m: 0.0537, stage1_l: 0.2932, stage1_h: 0.4495, loss: 0.2520, grad_norm: 1.3020
2024-10-07 20:51:23,899 - mmdet - INFO - Epoch [11][150/180]	lr: 2.000e-03, eta: 0:04:23, time: 1.476, data_time: 0.038, memory: 16742, stage0_loss_instance_mil: 0.0460, stage0_bag_acc: 96.9411, stage0_mean_ious: 0.4333, stage0_s: 0.0000, stage0_m: 0.0507, stage0_l: 0.2368, stage0_h: 0.4662, stage1_loss_instance_mil: 0.1337, stage1_bag_acc: 98.9157, stage1_neg_loss: 0.0496, stage1_mean_ious: 0.4252, stage1_s: 0.0000, stage1_m: 0.0594, stage1_l: 0.2688, stage1_h: 0.4494, loss: 0.2293, grad_norm: 1.2797
2024-10-07 20:52:07,058 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-07 20:53:24,215 - mmdet - INFO - Epoch [12][50/180]	lr: 2.000e-04, eta: 0:02:41, time: 1.513, data_time: 0.080, memory: 16742, stage0_loss_instance_mil: 0.0432, stage0_bag_acc: 97.0537, stage0_mean_ious: 0.4417, stage0_s: 0.0000, stage0_m: 0.0416, stage0_l: 0.2368, stage0_h: 0.4668, stage1_loss_instance_mil: 0.1423, stage1_bag_acc: 98.3377, stage1_neg_loss: 0.0513, stage1_mean_ious: 0.4325, stage1_s: 0.0000, stage1_m: 0.0442, stage1_l: 0.2624, stage1_h: 0.4518, loss: 0.2368, grad_norm: 1.3751
2024-10-07 20:54:37,494 - mmdet - INFO - Epoch [12][100/180]	lr: 2.000e-04, eta: 0:01:39, time: 1.466, data_time: 0.030, memory: 16742, stage0_loss_instance_mil: 0.0442, stage0_bag_acc: 96.9653, stage0_mean_ious: 0.4708, stage0_s: 0.0000, stage0_m: 0.0389, stage0_l: 0.2451, stage0_h: 0.4974, stage1_loss_instance_mil: 0.1326, stage1_bag_acc: 98.4367, stage1_neg_loss: 0.0520, stage1_mean_ious: 0.4518, stage1_s: 0.0000, stage1_m: 0.0404, stage1_l: 0.2841, stage1_h: 0.4702, loss: 0.2288, grad_norm: 1.3766
2024-10-07 20:55:51,014 - mmdet - INFO - Epoch [12][150/180]	lr: 2.000e-04, eta: 0:00:37, time: 1.470, data_time: 0.030, memory: 16742, stage0_loss_instance_mil: 0.0424, stage0_bag_acc: 97.3321, stage0_mean_ious: 0.4378, stage0_s: 0.0000, stage0_m: 0.0312, stage0_l: 0.2341, stage0_h: 0.4646, stage1_loss_instance_mil: 0.1260, stage1_bag_acc: 98.6291, stage1_neg_loss: 0.0621, stage1_mean_ious: 0.4375, stage1_s: 0.0000, stage1_m: 0.0351, stage1_l: 0.2760, stage1_h: 0.4580, loss: 0.2305, grad_norm: 1.4792
2024-10-07 20:56:36,128 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-07 20:58:21,735 - mmdet - INFO - Evaluating bbox...
2024-10-07 20:58:22,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0668
2024-10-07 20:58:22,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2495
2024-10-07 20:58:22,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1201
2024-10-07 20:58:22,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0332
2024-10-07 20:58:22,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0146
2024-10-07 20:58:22,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0036
2024-10-07 20:58:22,869 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-07 20:58:22,870 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0820
2024-10-07 20:58:22,870 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0716
2024-10-07 20:58:22,870 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0401
2024-10-07 20:58:22,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1384
2024-10-07 20:58:22,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3811
2024-10-07 20:58:22,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1384
2024-10-07 20:58:22,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1384
2024-10-07 20:58:22,870 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2193
2024-10-07 20:58:22,871 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1604
2024-10-07 20:58:22,871 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0715
2024-10-07 20:58:22,884 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-07 20:58:22,884 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0670, bbox_mAP_50: 0.2490, bbox_mAP_75: 0.1200, bbox_mAP_s: 0.0330, bbox_mAP_m: 0.0150, bbox_mAP_l: 0.0040, bbox_mAP_copypaste: 0.067 0.249 0.120 0.033 0.015 0.004
2024-10-07 21:00:07,329 - mmdet - INFO - Evaluating bbox...
2024-10-07 21:00:08,474 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0668
2024-10-07 21:00:08,475 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2495
2024-10-07 21:00:08,475 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1201
2024-10-07 21:00:08,475 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0332
2024-10-07 21:00:08,475 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0146
2024-10-07 21:00:08,475 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0036
2024-10-07 21:00:08,475 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-07 21:00:08,476 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0820
2024-10-07 21:00:08,476 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0716
2024-10-07 21:00:08,476 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0401
2024-10-07 21:00:08,476 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1384
2024-10-07 21:00:08,476 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3811
2024-10-07 21:00:08,476 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1384
2024-10-07 21:00:08,477 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1384
2024-10-07 21:00:08,477 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.2193
2024-10-07 21:00:08,477 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1604
2024-10-07 21:00:08,477 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0715
2024-10-07 21:00:09,957 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+963dd25
------------------------------------------------------------

2024-10-07 21:00:11,003 - mmdet - INFO - Distributed training: False
2024-10-07 21:00:11,950 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=12,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-07 21:00:13,008 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-07 21:00:13,008 - mmdet - INFO - Use load_from_local loader
2024-10-07 21:00:13,303 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-07 21:00:13,318 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-07 21:00:13,318 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-07 21:01:27,949 - mmdet - INFO - Epoch [1][50/180]	lr: 1.978e-03, eta: 0:52:29, time: 1.493, data_time: 0.076, memory: 16742, stage0_loss_instance_mil: 0.6475, stage0_bag_acc: 31.7256, stage0_mean_ious: 0.3105, stage0_s: 0.0000, stage0_m: 0.0250, stage0_l: 0.2298, stage0_h: 0.3159, stage1_loss_instance_mil: 0.1837, stage1_bag_acc: 20.3807, stage1_neg_loss: 0.0102, stage1_mean_ious: 0.2887, stage1_s: 0.0000, stage1_m: 0.0292, stage1_l: 0.2190, stage1_h: 0.2928, loss: 0.8414, grad_norm: 3.7460
2024-10-07 21:02:42,979 - mmdet - INFO - Epoch [1][100/180]	lr: 3.976e-03, eta: 0:51:22, time: 1.501, data_time: 0.029, memory: 16742, stage0_loss_instance_mil: 0.2898, stage0_bag_acc: 78.6962, stage0_mean_ious: 0.4605, stage0_s: 0.0000, stage0_m: 0.0230, stage0_l: 0.2298, stage0_h: 0.4876, stage1_loss_instance_mil: 0.3614, stage1_bag_acc: 59.6868, stage1_neg_loss: 0.0698, stage1_mean_ious: 0.4377, stage1_s: 0.0000, stage1_m: 0.0235, stage1_l: 0.2464, stage1_h: 0.4588, loss: 0.7209, grad_norm: 7.5951
2024-10-07 21:03:56,109 - mmdet - INFO - Epoch [1][150/180]	lr: 5.974e-03, eta: 0:49:45, time: 1.463, data_time: 0.033, memory: 16742, stage0_loss_instance_mil: 0.2069, stage0_bag_acc: 87.1430, stage0_mean_ious: 0.4548, stage0_s: 0.0000, stage0_m: 0.1005, stage0_l: 0.2419, stage0_h: 0.4746, stage1_loss_instance_mil: 0.3140, stage1_bag_acc: 82.6881, stage1_neg_loss: 0.0562, stage1_mean_ious: 0.4464, stage1_s: 0.0000, stage1_m: 0.0998, stage1_l: 0.2593, stage1_h: 0.4624, loss: 0.5770, grad_norm: 5.3431
2024-10-07 21:04:41,952 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-07 21:06:00,419 - mmdet - INFO - Epoch [2][50/180]	lr: 9.171e-03, eta: 0:41:55, time: 1.541, data_time: 0.088, memory: 16742, stage0_loss_instance_mil: 0.2087, stage0_bag_acc: 89.4826, stage0_mean_ious: 0.4391, stage0_s: 0.0000, stage0_m: 0.0783, stage0_l: 0.2588, stage0_h: 0.4553, stage1_loss_instance_mil: 0.3751, stage1_bag_acc: 66.3207, stage1_neg_loss: 0.0465, stage1_mean_ious: 0.4500, stage1_s: 0.0000, stage1_m: 0.0753, stage1_l: 0.2625, stage1_h: 0.4677, loss: 0.6303, grad_norm: 4.1340
2024-10-07 21:07:14,357 - mmdet - INFO - Epoch [2][100/180]	lr: 1.117e-02, eta: 0:41:49, time: 1.479, data_time: 0.032, memory: 16742, stage0_loss_instance_mil: 0.1838, stage0_bag_acc: 88.9674, stage0_mean_ious: 0.4531, stage0_s: 0.0000, stage0_m: 0.0204, stage0_l: 0.2364, stage0_h: 0.4650, stage1_loss_instance_mil: 0.3868, stage1_bag_acc: 70.2175, stage1_neg_loss: 0.0485, stage1_mean_ious: 0.4597, stage1_s: 0.0000, stage1_m: 0.0217, stage1_l: 0.2553, stage1_h: 0.4691, loss: 0.6191, grad_norm: 3.9860
2024-10-07 21:08:28,606 - mmdet - INFO - Epoch [2][150/180]	lr: 1.317e-02, eta: 0:41:24, time: 1.485, data_time: 0.032, memory: 16742, stage0_loss_instance_mil: 0.3140, stage0_bag_acc: 77.9830, stage0_mean_ious: 0.4018, stage0_s: 0.0000, stage0_m: 0.0161, stage0_l: 0.1849, stage0_h: 0.4204, stage1_loss_instance_mil: 0.2930, stage1_bag_acc: 62.4877, stage1_neg_loss: 0.0569, stage1_mean_ious: 0.4094, stage1_s: 0.0000, stage1_m: 0.0186, stage1_l: 0.1981, stage1_h: 0.4269, loss: 0.6640, grad_norm: 4.1373
2024-10-07 21:09:12,935 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-07 21:10:31,253 - mmdet - INFO - Epoch [3][50/180]	lr: 1.636e-02, eta: 0:37:20, time: 1.537, data_time: 0.080, memory: 16742, stage0_loss_instance_mil: 0.1799, stage0_bag_acc: 88.2356, stage0_mean_ious: 0.4286, stage0_s: 0.0000, stage0_m: 0.0150, stage0_l: 0.1961, stage0_h: 0.4501, stage1_loss_instance_mil: 0.2452, stage1_bag_acc: 83.0509, stage1_neg_loss: 0.0593, stage1_mean_ious: 0.4398, stage1_s: 0.0000, stage1_m: 0.0166, stage1_l: 0.2095, stage1_h: 0.4613, loss: 0.4844, grad_norm: 3.4981
2024-10-07 21:11:45,556 - mmdet - INFO - Epoch [3][100/180]	lr: 1.836e-02, eta: 0:36:54, time: 1.486, data_time: 0.030, memory: 16742, stage0_loss_instance_mil: 0.2926, stage0_bag_acc: 76.5932, stage0_mean_ious: 0.3765, stage0_s: 0.0000, stage0_m: 0.0337, stage0_l: 0.2291, stage0_h: 0.3948, stage1_loss_instance_mil: 0.2674, stage1_bag_acc: 66.8677, stage1_neg_loss: 0.0493, stage1_mean_ious: 0.3833, stage1_s: 0.0000, stage1_m: 0.0380, stage1_l: 0.2460, stage1_h: 0.4002, loss: 0.6093, grad_norm: 3.8624
2024-10-07 21:12:59,691 - mmdet - INFO - Epoch [3][150/180]	lr: 2.000e-02, eta: 0:36:18, time: 1.483, data_time: 0.035, memory: 16742, stage0_loss_instance_mil: 0.4323, stage0_bag_acc: 62.7435, stage0_mean_ious: 0.3685, stage0_s: 0.0000, stage0_m: 0.0387, stage0_l: 0.2518, stage0_h: 0.3843, stage1_loss_instance_mil: 0.2671, stage1_bag_acc: 54.2555, stage1_neg_loss: 0.0357, stage1_mean_ious: 0.3773, stage1_s: 0.0000, stage1_m: 0.0388, stage1_l: 0.2643, stage1_h: 0.3921, loss: 0.7352, grad_norm: 3.4109
2024-10-07 21:13:43,963 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-07 21:15:02,378 - mmdet - INFO - Epoch [4][50/180]	lr: 2.000e-02, eta: 0:33:17, time: 1.546, data_time: 0.082, memory: 16742, stage0_loss_instance_mil: 0.2726, stage0_bag_acc: 79.4471, stage0_mean_ious: 0.3555, stage0_s: 0.0000, stage0_m: 0.0300, stage0_l: 0.2652, stage0_h: 0.3664, stage1_loss_instance_mil: 0.3146, stage1_bag_acc: 74.1339, stage1_neg_loss: 0.0596, stage1_mean_ious: 0.3670, stage1_s: 0.0000, stage1_m: 0.0327, stage1_l: 0.2954, stage1_h: 0.3748, loss: 0.6467, grad_norm: 3.6702
2024-10-07 21:16:15,688 - mmdet - INFO - Epoch [4][100/180]	lr: 2.000e-02, eta: 0:32:36, time: 1.466, data_time: 0.037, memory: 16742, stage0_loss_instance_mil: 0.3783, stage0_bag_acc: 68.1631, stage0_mean_ious: 0.3106, stage0_s: 0.0000, stage0_m: 0.0521, stage0_l: 0.2674, stage0_h: 0.3142, stage1_loss_instance_mil: 0.2691, stage1_bag_acc: 58.2784, stage1_neg_loss: 0.0329, stage1_mean_ious: 0.3131, stage1_s: 0.0000, stage1_m: 0.0529, stage1_l: 0.2806, stage1_h: 0.3149, loss: 0.6803, grad_norm: 2.4952
2024-10-07 21:17:29,089 - mmdet - INFO - Epoch [4][150/180]	lr: 2.000e-02, eta: 0:31:51, time: 1.468, data_time: 0.027, memory: 16742, stage0_loss_instance_mil: 0.2885, stage0_bag_acc: 80.1008, stage0_mean_ious: 0.3027, stage0_s: 0.0000, stage0_m: 0.0569, stage0_l: 0.2635, stage0_h: 0.2975, stage1_loss_instance_mil: 0.3807, stage1_bag_acc: 54.0218, stage1_neg_loss: 0.0381, stage1_mean_ious: 0.3080, stage1_s: 0.0000, stage1_m: 0.0545, stage1_l: 0.2723, stage1_h: 0.3024, loss: 0.7073, grad_norm: 1.9934
2024-10-07 21:18:13,373 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-07 21:19:31,777 - mmdet - INFO - Epoch [5][50/180]	lr: 2.000e-02, eta: 0:29:17, time: 1.531, data_time: 0.085, memory: 16742, stage0_loss_instance_mil: 0.1195, stage0_bag_acc: 92.3828, stage0_mean_ious: 0.3074, stage0_s: 0.0000, stage0_m: 0.0170, stage0_l: 0.2358, stage0_h: 0.3092, stage1_loss_instance_mil: 0.3100, stage1_bag_acc: 83.4283, stage1_neg_loss: 0.0521, stage1_mean_ious: 0.3071, stage1_s: 0.0000, stage1_m: 0.0148, stage1_l: 0.2381, stage1_h: 0.3093, loss: 0.4816, grad_norm: 2.2155
2024-10-07 21:20:43,448 - mmdet - INFO - Epoch [5][100/180]	lr: 2.000e-02, eta: 0:28:28, time: 1.433, data_time: 0.026, memory: 16742, stage0_loss_instance_mil: 0.1527, stage0_bag_acc: 90.9185, stage0_mean_ious: 0.3629, stage0_s: 0.0000, stage0_m: 0.0433, stage0_l: 0.2112, stage0_h: 0.3800, stage1_loss_instance_mil: 0.2706, stage1_bag_acc: 91.3324, stage1_neg_loss: 0.0597, stage1_mean_ious: 0.3565, stage1_s: 0.0000, stage1_m: 0.0352, stage1_l: 0.2030, stage1_h: 0.3733, loss: 0.4830, grad_norm: 2.6750
2024-10-07 21:21:56,649 - mmdet - INFO - Epoch [5][150/180]	lr: 2.000e-02, eta: 0:27:38, time: 1.464, data_time: 0.037, memory: 16742, stage0_loss_instance_mil: 0.1456, stage0_bag_acc: 90.3221, stage0_mean_ious: 0.3215, stage0_s: 0.0000, stage0_m: 0.0477, stage0_l: 0.2218, stage0_h: 0.3291, stage1_loss_instance_mil: 0.2810, stage1_bag_acc: 81.2044, stage1_neg_loss: 0.0652, stage1_mean_ious: 0.3251, stage1_s: 0.0000, stage1_m: 0.0377, stage1_l: 0.2260, stage1_h: 0.3342, loss: 0.4919, grad_norm: 2.4680
2024-10-07 21:22:40,910 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-07 21:23:58,015 - mmdet - INFO - Epoch [6][50/180]	lr: 2.000e-02, eta: 0:25:21, time: 1.512, data_time: 0.079, memory: 16742, stage0_loss_instance_mil: 0.0929, stage0_bag_acc: 94.2409, stage0_mean_ious: 0.2821, stage0_s: 0.0000, stage0_m: 0.0461, stage0_l: 0.2643, stage0_h: 0.2819, stage1_loss_instance_mil: 0.2504, stage1_bag_acc: 88.9537, stage1_neg_loss: 0.0539, stage1_mean_ious: 0.2814, stage1_s: 0.0000, stage1_m: 0.0417, stage1_l: 0.2663, stage1_h: 0.2823, loss: 0.3972, grad_norm: 1.8447
2024-10-07 21:25:12,557 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-07 21:25:12,558 - mmdet - INFO - Epoch [6][100/180]	lr: 2.000e-02, eta: 0:24:31, time: 1.491, data_time: 0.035, memory: 16742, stage0_loss_instance_mil: 0.0965, stage0_bag_acc: 93.5811, stage0_mean_ious: 0.2999, stage0_s: 0.0000, stage0_m: 0.0437, stage0_l: 0.2320, stage0_h: 0.2999, stage1_loss_instance_mil: 0.2107, stage1_bag_acc: 92.8479, stage1_neg_loss: 0.0626, stage1_mean_ious: 0.2978, stage1_s: 0.0000, stage1_m: 0.0408, stage1_l: 0.2391, stage1_h: 0.2977, loss: 0.3698, grad_norm: 1.9886
2024-10-07 21:26:24,706 - mmdet - INFO - Epoch [6][150/180]	lr: 2.000e-02, eta: 0:23:37, time: 1.443, data_time: 0.029, memory: 16742, stage0_loss_instance_mil: 0.1314, stage0_bag_acc: 90.7952, stage0_mean_ious: 0.2564, stage0_s: 0.0000, stage0_m: 0.0390, stage0_l: 0.2589, stage0_h: 0.2523, stage1_loss_instance_mil: 0.2531, stage1_bag_acc: 90.1486, stage1_neg_loss: 0.0597, stage1_mean_ious: 0.2579, stage1_s: 0.0000, stage1_m: 0.0401, stage1_l: 0.2612, stage1_h: 0.2539, loss: 0.4442, grad_norm: 2.4522
2024-10-07 21:27:07,577 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-07 21:28:24,368 - mmdet - INFO - Epoch [7][50/180]	lr: 2.000e-02, eta: 0:21:30, time: 1.501, data_time: 0.085, memory: 16742, stage0_loss_instance_mil: 0.0918, stage0_bag_acc: 95.0258, stage0_mean_ious: 0.2671, stage0_s: 0.0000, stage0_m: 0.0597, stage0_l: 0.2375, stage0_h: 0.2652, stage1_loss_instance_mil: 0.2053, stage1_bag_acc: 93.9512, stage1_neg_loss: 0.0651, stage1_mean_ious: 0.2665, stage1_s: 0.0000, stage1_m: 0.0548, stage1_l: 0.2301, stage1_h: 0.2674, loss: 0.3622, grad_norm: 1.9168
2024-10-07 21:29:36,507 - mmdet - INFO - Epoch [7][100/180]	lr: 2.000e-02, eta: 0:20:35, time: 1.443, data_time: 0.028, memory: 16742, stage0_loss_instance_mil: 0.1009, stage0_bag_acc: 93.3337, stage0_mean_ious: 0.2949, stage0_s: 0.0000, stage0_m: 0.0448, stage0_l: 0.2039, stage0_h: 0.2952, stage1_loss_instance_mil: 0.1943, stage1_bag_acc: 94.7347, stage1_neg_loss: 0.0555, stage1_mean_ious: 0.3006, stage1_s: 0.0000, stage1_m: 0.0389, stage1_l: 0.2113, stage1_h: 0.3012, loss: 0.3507, grad_norm: 2.0784
2024-10-07 21:30:46,553 - mmdet - INFO - Epoch [7][150/180]	lr: 2.000e-02, eta: 0:19:38, time: 1.401, data_time: 0.030, memory: 16742, stage0_loss_instance_mil: 0.0643, stage0_bag_acc: 95.2578, stage0_mean_ious: 0.2778, stage0_s: 0.0000, stage0_m: 0.0576, stage0_l: 0.2835, stage0_h: 0.2807, stage1_loss_instance_mil: 0.1808, stage1_bag_acc: 96.0911, stage1_neg_loss: 0.0563, stage1_mean_ious: 0.2836, stage1_s: 0.0000, stage1_m: 0.0519, stage1_l: 0.2924, stage1_h: 0.2868, loss: 0.3014, grad_norm: 1.8274
2024-10-07 21:31:30,948 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-07 21:32:47,430 - mmdet - INFO - Epoch [8][50/180]	lr: 2.000e-02, eta: 0:17:39, time: 1.499, data_time: 0.077, memory: 16742, stage0_loss_instance_mil: 0.0575, stage0_bag_acc: 95.6734, stage0_mean_ious: 0.2451, stage0_s: 0.0000, stage0_m: 0.0296, stage0_l: 0.2628, stage0_h: 0.2370, stage1_loss_instance_mil: 0.1603, stage1_bag_acc: 97.7138, stage1_neg_loss: 0.0580, stage1_mean_ious: 0.2484, stage1_s: 0.0000, stage1_m: 0.0252, stage1_l: 0.2692, stage1_h: 0.2407, loss: 0.2759, grad_norm: 1.7412
2024-10-07 21:34:00,047 - mmdet - INFO - Epoch [8][100/180]	lr: 2.000e-02, eta: 0:16:43, time: 1.452, data_time: 0.033, memory: 16742, stage0_loss_instance_mil: 0.0539, stage0_bag_acc: 96.4587, stage0_mean_ious: 0.2656, stage0_s: 0.0000, stage0_m: 0.0349, stage0_l: 0.2179, stage0_h: 0.2677, stage1_loss_instance_mil: 0.1505, stage1_bag_acc: 97.3258, stage1_neg_loss: 0.0550, stage1_mean_ious: 0.2745, stage1_s: 0.0000, stage1_m: 0.0330, stage1_l: 0.2321, stage1_h: 0.2762, loss: 0.2594, grad_norm: 1.6302
2024-10-07 21:35:12,651 - mmdet - INFO - Epoch [8][150/180]	lr: 2.000e-02, eta: 0:15:45, time: 1.452, data_time: 0.028, memory: 16742, stage0_loss_instance_mil: 0.0376, stage0_bag_acc: 97.2050, stage0_mean_ious: 0.3064, stage0_s: 0.0000, stage0_m: 0.0546, stage0_l: 0.3070, stage0_h: 0.3026, stage1_loss_instance_mil: 0.1298, stage1_bag_acc: 98.1224, stage1_neg_loss: 0.0483, stage1_mean_ious: 0.3187, stage1_s: 0.0000, stage1_m: 0.0529, stage1_l: 0.3207, stage1_h: 0.3159, loss: 0.2158, grad_norm: 1.6425
2024-10-07 21:35:57,278 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-07 21:37:13,293 - mmdet - INFO - Epoch [9][50/180]	lr: 2.000e-03, eta: 0:13:53, time: 1.483, data_time: 0.081, memory: 16742, stage0_loss_instance_mil: 0.0699, stage0_bag_acc: 95.2117, stage0_mean_ious: 0.3048, stage0_s: 0.0000, stage0_m: 0.0576, stage0_l: 0.2709, stage0_h: 0.3053, stage1_loss_instance_mil: 0.0895, stage1_bag_acc: 95.1712, stage1_neg_loss: 0.0573, stage1_mean_ious: 0.3170, stage1_s: 0.0000, stage1_m: 0.0534, stage1_l: 0.2854, stage1_h: 0.3180, loss: 0.2167, grad_norm: 1.7069
2024-10-07 21:38:28,758 - mmdet - INFO - Epoch [9][100/180]	lr: 2.000e-03, eta: 0:12:56, time: 1.509, data_time: 0.030, memory: 16742, stage0_loss_instance_mil: 0.0227, stage0_bag_acc: 98.8484, stage0_mean_ious: 0.2872, stage0_s: 0.0012, stage0_m: 0.0543, stage0_l: 0.2474, stage0_h: 0.2826, stage1_loss_instance_mil: 0.0762, stage1_bag_acc: 98.5371, stage1_neg_loss: 0.0352, stage1_mean_ious: 0.2987, stage1_s: 0.0018, stage1_m: 0.0542, stage1_l: 0.2557, stage1_h: 0.2964, loss: 0.1340, grad_norm: 1.0849
2024-10-07 21:39:40,183 - mmdet - INFO - Epoch [9][150/180]	lr: 2.000e-03, eta: 0:11:56, time: 1.428, data_time: 0.034, memory: 16742, stage0_loss_instance_mil: 0.0232, stage0_bag_acc: 98.5616, stage0_mean_ious: 0.3102, stage0_s: 0.0000, stage0_m: 0.0523, stage0_l: 0.2554, stage0_h: 0.3109, stage1_loss_instance_mil: 0.0742, stage1_bag_acc: 98.0713, stage1_neg_loss: 0.0444, stage1_mean_ious: 0.3196, stage1_s: 0.0000, stage1_m: 0.0531, stage1_l: 0.2604, stage1_h: 0.3211, loss: 0.1419, grad_norm: 1.2164
2024-10-07 21:40:22,624 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-07 21:41:38,401 - mmdet - INFO - Epoch [10][50/180]	lr: 2.000e-03, eta: 0:10:08, time: 1.489, data_time: 0.077, memory: 16742, stage0_loss_instance_mil: 0.0178, stage0_bag_acc: 98.9486, stage0_mean_ious: 0.3108, stage0_s: 0.0000, stage0_m: 0.0572, stage0_l: 0.2785, stage0_h: 0.3018, stage1_loss_instance_mil: 0.0597, stage1_bag_acc: 99.0669, stage1_neg_loss: 0.0335, stage1_mean_ious: 0.3215, stage1_s: 0.0000, stage1_m: 0.0559, stage1_l: 0.2911, stage1_h: 0.3123, loss: 0.1110, grad_norm: 1.1023
2024-10-07 21:42:49,996 - mmdet - INFO - Epoch [10][100/180]	lr: 2.000e-03, eta: 0:09:08, time: 1.432, data_time: 0.032, memory: 16742, stage0_loss_instance_mil: 0.0222, stage0_bag_acc: 98.6161, stage0_mean_ious: 0.2833, stage0_s: 0.0000, stage0_m: 0.0755, stage0_l: 0.2769, stage0_h: 0.2812, stage1_loss_instance_mil: 0.0590, stage1_bag_acc: 98.5234, stage1_neg_loss: 0.0364, stage1_mean_ious: 0.2929, stage1_s: 0.0000, stage1_m: 0.0727, stage1_l: 0.2848, stage1_h: 0.2914, loss: 0.1177, grad_norm: 1.1224
2024-10-07 21:44:02,775 - mmdet - INFO - Epoch [10][150/180]	lr: 2.000e-03, eta: 0:08:08, time: 1.456, data_time: 0.028, memory: 16742, stage0_loss_instance_mil: 0.0182, stage0_bag_acc: 98.8714, stage0_mean_ious: 0.3007, stage0_s: 0.0000, stage0_m: 0.0767, stage0_l: 0.2748, stage0_h: 0.2975, stage1_loss_instance_mil: 0.0662, stage1_bag_acc: 99.1386, stage1_neg_loss: 0.0288, stage1_mean_ious: 0.3119, stage1_s: 0.0000, stage1_m: 0.0817, stage1_l: 0.2717, stage1_h: 0.3101, loss: 0.1133, grad_norm: 1.1105
2024-10-07 21:44:46,391 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-07 21:46:02,982 - mmdet - INFO - Epoch [11][50/180]	lr: 2.000e-03, eta: 0:06:24, time: 1.499, data_time: 0.084, memory: 16742, stage0_loss_instance_mil: 0.0152, stage0_bag_acc: 99.3854, stage0_mean_ious: 0.2990, stage0_s: 0.0000, stage0_m: 0.0837, stage0_l: 0.2859, stage0_h: 0.2937, stage1_loss_instance_mil: 0.0568, stage1_bag_acc: 99.0751, stage1_neg_loss: 0.0302, stage1_mean_ious: 0.3117, stage1_s: 0.0000, stage1_m: 0.0833, stage1_l: 0.2893, stage1_h: 0.3080, loss: 0.1021, grad_norm: 1.0589
2024-10-07 21:47:16,008 - mmdet - INFO - Epoch [11][100/180]	lr: 2.000e-03, eta: 0:05:23, time: 1.461, data_time: 0.029, memory: 16742, stage0_loss_instance_mil: 0.0194, stage0_bag_acc: 99.0964, stage0_mean_ious: 0.2838, stage0_s: 0.0000, stage0_m: 0.0526, stage0_l: 0.2304, stage0_h: 0.2873, stage1_loss_instance_mil: 0.0617, stage1_bag_acc: 99.1122, stage1_neg_loss: 0.0398, stage1_mean_ious: 0.2965, stage1_s: 0.0000, stage1_m: 0.0543, stage1_l: 0.2475, stage1_h: 0.2983, loss: 0.1209, grad_norm: 1.2334
2024-10-07 21:48:27,501 - mmdet - INFO - Epoch [11][150/180]	lr: 2.000e-03, eta: 0:04:22, time: 1.430, data_time: 0.032, memory: 16742, stage0_loss_instance_mil: 0.0207, stage0_bag_acc: 98.8596, stage0_mean_ious: 0.2935, stage0_s: 0.0000, stage0_m: 0.0522, stage0_l: 0.3141, stage0_h: 0.2889, stage1_loss_instance_mil: 0.0594, stage1_bag_acc: 98.9197, stage1_neg_loss: 0.0348, stage1_mean_ious: 0.3091, stage1_s: 0.0000, stage1_m: 0.0548, stage1_l: 0.3207, stage1_h: 0.3041, loss: 0.1148, grad_norm: 1.3058
2024-10-07 21:49:12,043 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-07 21:50:27,258 - mmdet - INFO - Epoch [12][50/180]	lr: 2.000e-04, eta: 0:02:40, time: 1.474, data_time: 0.078, memory: 16742, stage0_loss_instance_mil: 0.0171, stage0_bag_acc: 99.0061, stage0_mean_ious: 0.3012, stage0_s: 0.0012, stage0_m: 0.0507, stage0_l: 0.3096, stage0_h: 0.2923, stage1_loss_instance_mil: 0.0523, stage1_bag_acc: 98.6756, stage1_neg_loss: 0.0329, stage1_mean_ious: 0.3153, stage1_s: 0.0018, stage1_m: 0.0506, stage1_l: 0.3274, stage1_h: 0.3064, loss: 0.1023, grad_norm: 1.0424
2024-10-07 21:51:38,946 - mmdet - INFO - Epoch [12][100/180]	lr: 2.000e-04, eta: 0:01:39, time: 1.434, data_time: 0.032, memory: 16742, stage0_loss_instance_mil: 0.0255, stage0_bag_acc: 98.1034, stage0_mean_ious: 0.2645, stage0_s: 0.0000, stage0_m: 0.0423, stage0_l: 0.2367, stage0_h: 0.2616, stage1_loss_instance_mil: 0.0556, stage1_bag_acc: 99.0781, stage1_neg_loss: 0.0348, stage1_mean_ious: 0.2722, stage1_s: 0.0000, stage1_m: 0.0404, stage1_l: 0.2407, stage1_h: 0.2692, loss: 0.1159, grad_norm: 1.1873
2024-10-07 21:52:53,720 - mmdet - INFO - Epoch [12][150/180]	lr: 2.000e-04, eta: 0:00:37, time: 1.495, data_time: 0.031, memory: 16742, stage0_loss_instance_mil: 0.0101, stage0_bag_acc: 99.4281, stage0_mean_ious: 0.3105, stage0_s: 0.0000, stage0_m: 0.0523, stage0_l: 0.2924, stage0_h: 0.3094, stage1_loss_instance_mil: 0.0514, stage1_bag_acc: 99.4938, stage1_neg_loss: 0.0284, stage1_mean_ious: 0.3202, stage1_s: 0.0000, stage1_m: 0.0565, stage1_l: 0.3045, stage1_h: 0.3189, loss: 0.0899, grad_norm: 1.0095
2024-10-07 21:53:37,342 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-07 21:55:24,918 - mmdet - INFO - Evaluating bbox...
2024-10-07 21:55:25,822 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0838
2024-10-07 21:55:25,823 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2487
2024-10-07 21:55:25,823 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1563
2024-10-07 21:55:25,823 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0696
2024-10-07 21:55:25,823 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0334
2024-10-07 21:55:25,823 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0136
2024-10-07 21:55:25,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0019
2024-10-07 21:55:25,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0958
2024-10-07 21:55:25,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0878
2024-10-07 21:55:25,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1266
2024-10-07 21:55:25,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1398
2024-10-07 21:55:25,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3154
2024-10-07 21:55:25,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1398
2024-10-07 21:55:25,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1398
2024-10-07 21:55:25,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1434
2024-10-07 21:55:25,826 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1366
2024-10-07 21:55:25,826 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1753
2024-10-07 21:55:25,848 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-07 21:55:25,849 - mmdet - INFO - Epoch(val) [12][180]	eval_iter_num: 90, bbox_mAP: 0.0840, bbox_mAP_50: 0.2490, bbox_mAP_75: 0.1560, bbox_mAP_s: 0.0700, bbox_mAP_m: 0.0330, bbox_mAP_l: 0.0140, bbox_mAP_copypaste: 0.084 0.249 0.156 0.070 0.033 0.014
2024-10-07 21:57:06,380 - mmdet - INFO - Evaluating bbox...
2024-10-07 21:57:07,253 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.0838
2024-10-07 21:57:07,253 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.2487
2024-10-07 21:57:07,253 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.1563
2024-10-07 21:57:07,253 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0696
2024-10-07 21:57:07,253 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0334
2024-10-07 21:57:07,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0136
2024-10-07 21:57:07,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0019
2024-10-07 21:57:07,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0958
2024-10-07 21:57:07,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.0878
2024-10-07 21:57:07,254 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1266
2024-10-07 21:57:07,254 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1398
2024-10-07 21:57:07,254 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.3154
2024-10-07 21:57:07,254 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.1398
2024-10-07 21:57:07,254 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.1398
2024-10-07 21:57:07,254 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.1434
2024-10-07 21:57:07,254 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1366
2024-10-07 21:57:07,255 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1753
2024-10-07 21:57:08,523 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+963dd25
------------------------------------------------------------

2024-10-07 21:57:09,383 - mmdet - INFO - Distributed training: False
2024-10-07 21:57:10,247 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=8,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=16,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(type='SGD', lr=0.02, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=12,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-07 21:57:11,348 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-07 21:57:11,348 - mmdet - INFO - Use load_from_local loader
2024-10-07 21:57:11,615 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-07 21:57:11,625 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-07 21:57:11,625 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-07 21:58:26,791 - mmdet - INFO - Epoch [1][50/180]	lr: 1.978e-03, eta: 0:52:51, time: 1.503, data_time: 0.076, memory: 16742, stage0_loss_instance_mil: 0.6572, stage0_bag_acc: 32.3389, stage0_mean_ious: 0.3374, stage0_s: 0.0000, stage0_m: 0.0355, stage0_l: 0.1991, stage0_h: 0.3571, stage1_loss_instance_mil: 0.1845, stage1_bag_acc: 24.6569, stage1_neg_loss: 0.0091, stage1_mean_ious: 0.3217, stage1_s: 0.0000, stage1_m: 0.0369, stage1_l: 0.2035, stage1_h: 0.3385, loss: 0.8508, grad_norm: 3.6580
2024-10-07 21:59:40,726 - mmdet - INFO - Epoch [1][100/180]	lr: 3.976e-03, eta: 0:51:11, time: 1.479, data_time: 0.035, memory: 16742, stage0_loss_instance_mil: 0.3619, stage0_bag_acc: 67.8154, stage0_mean_ious: 0.4314, stage0_s: 0.0000, stage0_m: 0.0268, stage0_l: 0.2050, stage0_h: 0.4581, stage1_loss_instance_mil: 0.3032, stage1_bag_acc: 60.0211, stage1_neg_loss: 0.0544, stage1_mean_ious: 0.4229, stage1_s: 0.0000, stage1_m: 0.0298, stage1_l: 0.2198, stage1_h: 0.4450, loss: 0.7196, grad_norm: 6.5791
2024-10-07 22:00:54,187 - mmdet - INFO - Epoch [1][150/180]	lr: 5.974e-03, eta: 0:49:42, time: 1.469, data_time: 0.030, memory: 16742, stage0_loss_instance_mil: 0.2691, stage0_bag_acc: 83.4199, stage0_mean_ious: 0.3416, stage0_s: 0.0000, stage0_m: 0.0779, stage0_l: 0.2505, stage0_h: 0.3472, stage1_loss_instance_mil: 0.4366, stage1_bag_acc: 62.4375, stage1_neg_loss: 0.0619, stage1_mean_ious: 0.3499, stage1_s: 0.0000, stage1_m: 0.0819, stage1_l: 0.2644, stage1_h: 0.3545, loss: 0.7677, grad_norm: 6.5219
2024-10-07 22:01:38,636 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-07 22:02:51,976 - mmdet - INFO - Epoch [2][50/180]	lr: 9.171e-03, eta: 0:41:10, time: 1.436, data_time: 0.083, memory: 16742, stage0_loss_instance_mil: 0.2528, stage0_bag_acc: 81.7914, stage0_mean_ious: 0.4094, stage0_s: 0.0000, stage0_m: 0.0417, stage0_l: 0.2063, stage0_h: 0.4374, stage1_loss_instance_mil: 0.3488, stage1_bag_acc: 69.9300, stage1_neg_loss: 0.0514, stage1_mean_ious: 0.4229, stage1_s: 0.0000, stage1_m: 0.0449, stage1_l: 0.2290, stage1_h: 0.4496, loss: 0.6529, grad_norm: 4.4882
2024-10-07 22:04:03,090 - mmdet - INFO - Epoch [2][100/180]	lr: 1.117e-02, eta: 0:40:53, time: 1.422, data_time: 0.027, memory: 16742, stage0_loss_instance_mil: 0.2547, stage0_bag_acc: 78.0178, stage0_mean_ious: 0.3701, stage0_s: 0.0000, stage0_m: 0.0257, stage0_l: 0.2260, stage0_h: 0.3885, stage1_loss_instance_mil: 0.2984, stage1_bag_acc: 69.1360, stage1_neg_loss: 0.0559, stage1_mean_ious: 0.3793, stage1_s: 0.0000, stage1_m: 0.0277, stage1_l: 0.2288, stage1_h: 0.3977, loss: 0.6090, grad_norm: 4.3803
2024-10-07 22:05:17,109 - mmdet - INFO - Epoch [2][150/180]	lr: 1.317e-02, eta: 0:40:37, time: 1.480, data_time: 0.033, memory: 16742, stage0_loss_instance_mil: 0.2307, stage0_bag_acc: 83.1556, stage0_mean_ious: 0.3681, stage0_s: 0.0000, stage0_m: 0.0647, stage0_l: 0.2295, stage0_h: 0.3827, stage1_loss_instance_mil: 0.2923, stage1_bag_acc: 73.1661, stage1_neg_loss: 0.0585, stage1_mean_ious: 0.3806, stage1_s: 0.0000, stage1_m: 0.0653, stage1_l: 0.2513, stage1_h: 0.3936, loss: 0.5814, grad_norm: 3.7557
2024-10-07 22:06:02,438 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-07 22:07:20,311 - mmdet - INFO - Epoch [3][50/180]	lr: 1.636e-02, eta: 0:36:41, time: 1.524, data_time: 0.078, memory: 16742, stage0_loss_instance_mil: 0.2634, stage0_bag_acc: 81.4310, stage0_mean_ious: 0.3670, stage0_s: 0.0000, stage0_m: 0.0218, stage0_l: 0.2188, stage0_h: 0.3761, stage1_loss_instance_mil: 0.2817, stage1_bag_acc: 72.9043, stage1_neg_loss: 0.0437, stage1_mean_ious: 0.3677, stage1_s: 0.0000, stage1_m: 0.0173, stage1_l: 0.2340, stage1_h: 0.3757, loss: 0.5888, grad_norm: 3.4967
2024-10-07 22:08:34,262 - mmdet - INFO - Epoch [3][100/180]	lr: 1.836e-02, eta: 0:36:19, time: 1.479, data_time: 0.037, memory: 16742, stage0_loss_instance_mil: 0.2682, stage0_bag_acc: 78.8476, stage0_mean_ious: 0.3666, stage0_s: 0.0000, stage0_m: 0.0449, stage0_l: 0.1798, stage0_h: 0.3830, stage1_loss_instance_mil: 0.2316, stage1_bag_acc: 78.9188, stage1_neg_loss: 0.0573, stage1_mean_ious: 0.3691, stage1_s: 0.0000, stage1_m: 0.0465, stage1_l: 0.1809, stage1_h: 0.3838, loss: 0.5571, grad_norm: 4.1666
2024-10-07 22:09:47,213 - mmdet - INFO - Epoch [3][150/180]	lr: 2.000e-02, eta: 0:35:43, time: 1.459, data_time: 0.031, memory: 16742, stage0_loss_instance_mil: 0.3691, stage0_bag_acc: 70.2611, stage0_mean_ious: 0.3342, stage0_s: 0.0000, stage0_m: 0.0627, stage0_l: 0.2309, stage0_h: 0.3449, stage1_loss_instance_mil: 0.3143, stage1_bag_acc: 62.0080, stage1_neg_loss: 0.0437, stage1_mean_ious: 0.3399, stage1_s: 0.0000, stage1_m: 0.0541, stage1_l: 0.2464, stage1_h: 0.3501, loss: 0.7270, grad_norm: 3.1086
2024-10-07 22:10:32,286 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-07 22:11:50,237 - mmdet - INFO - Epoch [4][50/180]	lr: 2.000e-02, eta: 0:32:46, time: 1.525, data_time: 0.088, memory: 16742, stage0_loss_instance_mil: 0.2670, stage0_bag_acc: 80.9269, stage0_mean_ious: 0.3937, stage0_s: 0.0000, stage0_m: 0.0422, stage0_l: 0.2135, stage0_h: 0.4197, stage1_loss_instance_mil: 0.2989, stage1_bag_acc: 66.6284, stage1_neg_loss: 0.0451, stage1_mean_ious: 0.4067, stage1_s: 0.0000, stage1_m: 0.0432, stage1_l: 0.2255, stage1_h: 0.4328, loss: 0.6110, grad_norm: 2.8279
2024-10-07 22:13:02,577 - mmdet - INFO - Epoch [4][100/180]	lr: 2.000e-02, eta: 0:32:06, time: 1.447, data_time: 0.026, memory: 16742, stage0_loss_instance_mil: 0.1692, stage0_bag_acc: 88.2605, stage0_mean_ious: 0.3735, stage0_s: 0.0000, stage0_m: 0.0198, stage0_l: 0.2676, stage0_h: 0.3810, stage1_loss_instance_mil: 0.3155, stage1_bag_acc: 79.5397, stage1_neg_loss: 0.0512, stage1_mean_ious: 0.4039, stage1_s: 0.0000, stage1_m: 0.0227, stage1_l: 0.3014, stage1_h: 0.4096, loss: 0.5359, grad_norm: 2.6752
2024-10-07 22:14:15,626 - mmdet - INFO - Epoch [4][150/180]	lr: 2.000e-02, eta: 0:31:23, time: 1.461, data_time: 0.034, memory: 16742, stage0_loss_instance_mil: 0.2255, stage0_bag_acc: 83.5516, stage0_mean_ious: 0.3325, stage0_s: 0.0000, stage0_m: 0.0438, stage0_l: 0.2456, stage0_h: 0.3380, stage1_loss_instance_mil: 0.2992, stage1_bag_acc: 75.6355, stage1_neg_loss: 0.0465, stage1_mean_ious: 0.3516, stage1_s: 0.0000, stage1_m: 0.0455, stage1_l: 0.2746, stage1_h: 0.3556, loss: 0.5712, grad_norm: 2.6616
2024-10-07 22:15:00,110 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-07 22:16:15,943 - mmdet - INFO - Epoch [5][50/180]	lr: 2.000e-02, eta: 0:28:50, time: 1.487, data_time: 0.076, memory: 16742, stage0_loss_instance_mil: 0.1437, stage0_bag_acc: 90.8524, stage0_mean_ious: 0.3544, stage0_s: 0.0000, stage0_m: 0.0600, stage0_l: 0.2768, stage0_h: 0.3623, stage1_loss_instance_mil: 0.3157, stage1_bag_acc: 78.2138, stage1_neg_loss: 0.0385, stage1_mean_ious: 0.3793, stage1_s: 0.0000, stage1_m: 0.0691, stage1_l: 0.3125, stage1_h: 0.3831, loss: 0.4979, grad_norm: 2.1019
2024-10-07 22:17:31,804 - mmdet - INFO - Epoch [5][100/180]	lr: 2.000e-02, eta: 0:28:10, time: 1.517, data_time: 0.039, memory: 16742, stage0_loss_instance_mil: 0.1353, stage0_bag_acc: 91.4120, stage0_mean_ious: 0.3666, stage0_s: 0.0000, stage0_m: 0.0660, stage0_l: 0.2670, stage0_h: 0.3780, stage1_loss_instance_mil: 0.2110, stage1_bag_acc: 92.4637, stage1_neg_loss: 0.0549, stage1_mean_ious: 0.3882, stage1_s: 0.0000, stage1_m: 0.0715, stage1_l: 0.2962, stage1_h: 0.3973, loss: 0.4012, grad_norm: 2.5416
2024-10-07 22:18:43,769 - mmdet - INFO - Epoch [5][150/180]	lr: 2.000e-02, eta: 0:27:20, time: 1.439, data_time: 0.029, memory: 16742, stage0_loss_instance_mil: 0.1557, stage0_bag_acc: 88.3845, stage0_mean_ious: 0.3987, stage0_s: 0.0000, stage0_m: 0.0921, stage0_l: 0.2786, stage0_h: 0.4074, stage1_loss_instance_mil: 0.2304, stage1_bag_acc: 84.4255, stage1_neg_loss: 0.0460, stage1_mean_ious: 0.4263, stage1_s: 0.0000, stage1_m: 0.0956, stage1_l: 0.3338, stage1_h: 0.4309, loss: 0.4322, grad_norm: 2.7712
2024-10-07 22:19:27,526 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-07 22:20:46,232 - mmdet - INFO - Epoch [6][50/180]	lr: 2.000e-02, eta: 0:25:07, time: 1.537, data_time: 0.083, memory: 16742, stage0_loss_instance_mil: 0.0819, stage0_bag_acc: 94.8677, stage0_mean_ious: 0.3588, stage0_s: 0.0000, stage0_m: 0.0433, stage0_l: 0.2979, stage0_h: 0.3608, stage1_loss_instance_mil: 0.2130, stage1_bag_acc: 94.5104, stage1_neg_loss: 0.0563, stage1_mean_ious: 0.3772, stage1_s: 0.0000, stage1_m: 0.0499, stage1_l: 0.3551, stage1_h: 0.3722, loss: 0.3511, grad_norm: 1.9245
2024-10-07 22:21:59,620 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-07 22:21:59,621 - mmdet - INFO - Epoch [6][100/180]	lr: 2.000e-02, eta: 0:24:17, time: 1.468, data_time: 0.027, memory: 16742, stage0_loss_instance_mil: 0.0539, stage0_bag_acc: 96.6743, stage0_mean_ious: 0.3594, stage0_s: 0.0013, stage0_m: 0.0510, stage0_l: 0.2855, stage0_h: 0.3637, stage1_loss_instance_mil: 0.2233, stage1_bag_acc: 91.3699, stage1_neg_loss: 0.0474, stage1_mean_ious: 0.3763, stage1_s: 0.0019, stage1_m: 0.0604, stage1_l: 0.3271, stage1_h: 0.3740, loss: 0.3246, grad_norm: 1.7955
2024-10-07 22:23:14,377 - mmdet - INFO - Epoch [6][150/180]	lr: 2.000e-02, eta: 0:23:27, time: 1.495, data_time: 0.038, memory: 16742, stage0_loss_instance_mil: 0.0775, stage0_bag_acc: 95.1687, stage0_mean_ious: 0.3849, stage0_s: 0.0000, stage0_m: 0.0695, stage0_l: 0.2686, stage0_h: 0.3959, stage1_loss_instance_mil: 0.2809, stage1_bag_acc: 91.7182, stage1_neg_loss: 0.0488, stage1_mean_ious: 0.3952, stage1_s: 0.0000, stage1_m: 0.0727, stage1_l: 0.3196, stage1_h: 0.3992, loss: 0.4072, grad_norm: 2.0325
2024-10-07 22:23:58,330 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-07 22:25:16,428 - mmdet - INFO - Epoch [7][50/180]	lr: 2.000e-02, eta: 0:21:23, time: 1.532, data_time: 0.080, memory: 16742, stage0_loss_instance_mil: 0.0718, stage0_bag_acc: 96.5213, stage0_mean_ious: 0.4339, stage0_s: 0.0000, stage0_m: 0.0958, stage0_l: 0.3071, stage0_h: 0.4448, stage1_loss_instance_mil: 0.2570, stage1_bag_acc: 87.0757, stage1_neg_loss: 0.0440, stage1_mean_ious: 0.4385, stage1_s: 0.0000, stage1_m: 0.1072, stage1_l: 0.3365, stage1_h: 0.4464, loss: 0.3728, grad_norm: 1.7135
2024-10-07 22:26:28,841 - mmdet - INFO - Epoch [7][100/180]	lr: 2.000e-02, eta: 0:20:29, time: 1.448, data_time: 0.033, memory: 16742, stage0_loss_instance_mil: 0.0570, stage0_bag_acc: 97.1231, stage0_mean_ious: 0.4585, stage0_s: 0.0000, stage0_m: 0.0457, stage0_l: 0.2827, stage0_h: 0.4750, stage1_loss_instance_mil: 0.1992, stage1_bag_acc: 93.7406, stage1_neg_loss: 0.0479, stage1_mean_ious: 0.4858, stage1_s: 0.0000, stage1_m: 0.0546, stage1_l: 0.3198, stage1_h: 0.4995, loss: 0.3040, grad_norm: 1.9526
2024-10-07 22:27:43,089 - mmdet - INFO - Epoch [7][150/180]	lr: 2.000e-02, eta: 0:19:35, time: 1.485, data_time: 0.030, memory: 16742, stage0_loss_instance_mil: 0.0580, stage0_bag_acc: 96.4107, stage0_mean_ious: 0.4582, stage0_s: 0.0000, stage0_m: 0.0513, stage0_l: 0.2603, stage0_h: 0.4796, stage1_loss_instance_mil: 0.1481, stage1_bag_acc: 95.8449, stage1_neg_loss: 0.0458, stage1_mean_ious: 0.4850, stage1_s: 0.0000, stage1_m: 0.0563, stage1_l: 0.2814, stage1_h: 0.5065, loss: 0.2519, grad_norm: 1.8867
2024-10-07 22:28:26,406 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-07 22:29:43,599 - mmdet - INFO - Epoch [8][50/180]	lr: 2.000e-02, eta: 0:17:37, time: 1.513, data_time: 0.080, memory: 16742, stage0_loss_instance_mil: 0.0434, stage0_bag_acc: 97.0489, stage0_mean_ious: 0.4727, stage0_s: 0.0000, stage0_m: 0.0622, stage0_l: 0.3226, stage0_h: 0.5007, stage1_loss_instance_mil: 0.1246, stage1_bag_acc: 97.0305, stage1_neg_loss: 0.0438, stage1_mean_ious: 0.4964, stage1_s: 0.0000, stage1_m: 0.0755, stage1_l: 0.3506, stage1_h: 0.5221, loss: 0.2118, grad_norm: 1.6504
