2024-10-16 00:55:07,792 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+2fd3e4b
------------------------------------------------------------

2024-10-16 00:55:08,682 - mmdet - INFO - Distributed training: False
2024-10-16 00:55:09,566 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-16 00:55:13,405 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 00:55:13,406 - mmdet - INFO - Use load_from_local loader
2024-10-16 00:55:13,848 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 00:55:13,854 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 00:55:13,854 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 00:56:02,339 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:53:29, time: 0.970, data_time: 0.061, memory: 7789, stage0_loss_instance_mil: 0.7128, stage0_bag_acc: 17.4389, stage0_mean_ious: 0.0540, stage0_s: 0.0475, stage0_m: 0.0371, stage0_l: 0.0245, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1732, stage1_bag_acc: 14.0833, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.0599, stage1_s: 0.0520, stage1_m: 0.0402, stage1_l: 0.0301, stage1_h: 0.0000, loss: 0.8870, grad_norm: 5.8171
2024-10-16 00:56:45,524 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:49:48, time: 0.864, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.6949, stage0_bag_acc: 16.9697, stage0_mean_ious: 0.0681, stage0_s: 0.0638, stage0_m: 0.0511, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1752, stage1_bag_acc: 14.5591, stage1_neg_loss: 0.0013, stage1_mean_ious: 0.0729, stage1_s: 0.0688, stage1_m: 0.0527, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8714, grad_norm: 5.9440
2024-10-16 00:57:29,763 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:48:28, time: 0.885, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.6820, stage0_bag_acc: 26.0801, stage0_mean_ious: 0.1035, stage0_s: 0.0751, stage0_m: 0.0862, stage0_l: 0.0088, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1735, stage1_bag_acc: 22.4877, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.1092, stage1_s: 0.0787, stage1_m: 0.0899, stage1_l: 0.0101, stage1_h: 0.0000, loss: 0.8575, grad_norm: 6.9323
2024-10-16 00:58:14,028 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:47:26, time: 0.885, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.6397, stage0_bag_acc: 30.4439, stage0_mean_ious: 0.1395, stage0_s: 0.1104, stage0_m: 0.1291, stage0_l: 0.0056, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1649, stage1_bag_acc: 27.7576, stage1_neg_loss: 0.0130, stage1_mean_ious: 0.1481, stage1_s: 0.1216, stage1_m: 0.1314, stage1_l: 0.0065, stage1_h: 0.0000, loss: 0.8177, grad_norm: 9.1941
2024-10-16 00:58:58,719 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:46:37, time: 0.894, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.5887, stage0_bag_acc: 38.0889, stage0_mean_ious: 0.1796, stage0_s: 0.1320, stage0_m: 0.1852, stage0_l: 0.0122, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1372, stage1_bag_acc: 44.5000, stage1_neg_loss: 0.0235, stage1_mean_ious: 0.2061, stage1_s: 0.1556, stage1_m: 0.2002, stage1_l: 0.0113, stage1_h: 0.0000, loss: 0.7494, grad_norm: 9.4000
2024-10-16 00:59:26,487 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 01:00:13,721 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:41:18, time: 0.901, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.5049, stage0_bag_acc: 44.7566, stage0_mean_ious: 0.2544, stage0_s: 0.2215, stage0_m: 0.1822, stage0_l: 0.0138, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1181, stage1_bag_acc: 56.2162, stage1_neg_loss: 0.0209, stage1_mean_ious: 0.3168, stage1_s: 0.2897, stage1_m: 0.1996, stage1_l: 0.0131, stage1_h: 0.0000, loss: 0.6439, grad_norm: 10.1926
2024-10-16 01:00:58,883 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:41:10, time: 0.903, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.4103, stage0_bag_acc: 61.8470, stage0_mean_ious: 0.3840, stage0_s: 0.3046, stage0_m: 0.3805, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1013, stage1_bag_acc: 61.4106, stage1_neg_loss: 0.0260, stage1_mean_ious: 0.4380, stage1_s: 0.3885, stage1_m: 0.3936, stage1_l: 0.0059, stage1_h: 0.0000, loss: 0.5376, grad_norm: 10.5899
2024-10-16 01:01:43,854 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:40:53, time: 0.899, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.3393, stage0_bag_acc: 71.6682, stage0_mean_ious: 0.3802, stage0_s: 0.3063, stage0_m: 0.3545, stage0_l: 0.0511, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0959, stage1_bag_acc: 66.3955, stage1_neg_loss: 0.0239, stage1_mean_ious: 0.4402, stage1_s: 0.4011, stage1_m: 0.3596, stage1_l: 0.0351, stage1_h: 0.0000, loss: 0.4592, grad_norm: 10.6968
2024-10-16 01:02:27,685 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:40:23, time: 0.877, data_time: 0.011, memory: 7795, stage0_loss_instance_mil: 0.1878, stage0_bag_acc: 85.2444, stage0_mean_ious: 0.4405, stage0_s: 0.3749, stage0_m: 0.3833, stage0_l: 0.0133, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0641, stage1_bag_acc: 85.8643, stage1_neg_loss: 0.0197, stage1_mean_ious: 0.5253, stage1_s: 0.4687, stage1_m: 0.4203, stage1_l: 0.0182, stage1_h: 0.0000, loss: 0.2716, grad_norm: 8.8264
2024-10-16 01:03:11,312 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:39:49, time: 0.873, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.2015, stage0_bag_acc: 83.6357, stage0_mean_ious: 0.4107, stage0_s: 0.3807, stage0_m: 0.2902, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0612, stage1_bag_acc: 85.4579, stage1_neg_loss: 0.0183, stage1_mean_ious: 0.5132, stage1_s: 0.5037, stage1_m: 0.3065, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2810, grad_norm: 9.3199
2024-10-16 01:03:37,607 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 01:04:24,914 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:37:00, time: 0.902, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.1214, stage0_bag_acc: 91.6085, stage0_mean_ious: 0.4471, stage0_s: 0.3782, stage0_m: 0.3572, stage0_l: 0.0369, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0408, stage1_bag_acc: 90.7728, stage1_neg_loss: 0.0151, stage1_mean_ious: 0.5440, stage1_s: 0.5038, stage1_m: 0.3659, stage1_l: 0.0290, stage1_h: 0.0000, loss: 0.1774, grad_norm: 6.5504
2024-10-16 01:05:06,320 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:36:24, time: 0.828, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.1298, stage0_bag_acc: 89.8389, stage0_mean_ious: 0.4194, stage0_s: 0.3839, stage0_m: 0.2929, stage0_l: 0.0105, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0478, stage1_bag_acc: 90.2889, stage1_neg_loss: 0.0170, stage1_mean_ious: 0.5126, stage1_s: 0.5078, stage1_m: 0.3007, stage1_l: 0.0103, stage1_h: 0.0000, loss: 0.1946, grad_norm: 6.3982
2024-10-16 01:05:46,815 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:35:44, time: 0.810, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.1176, stage0_bag_acc: 91.1159, stage0_mean_ious: 0.4314, stage0_s: 0.3897, stage0_m: 0.2747, stage0_l: 0.0073, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0347, stage1_bag_acc: 92.1976, stage1_neg_loss: 0.0122, stage1_mean_ious: 0.5245, stage1_s: 0.5153, stage1_m: 0.2819, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.1645, grad_norm: 6.3142
2024-10-16 01:06:30,020 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:35:13, time: 0.864, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0826, stage0_bag_acc: 92.6500, stage0_mean_ious: 0.4792, stage0_s: 0.4212, stage0_m: 0.3641, stage0_l: 0.0300, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0319, stage1_bag_acc: 92.8000, stage1_neg_loss: 0.0124, stage1_mean_ious: 0.5732, stage1_s: 0.5459, stage1_m: 0.3810, stage1_l: 0.0209, stage1_h: 0.0000, loss: 0.1269, grad_norm: 5.9569
2024-10-16 01:07:13,037 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:34:39, time: 0.860, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0663, stage0_bag_acc: 95.4167, stage0_mean_ious: 0.4905, stage0_s: 0.4306, stage0_m: 0.4106, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0244, stage1_bag_acc: 95.4833, stage1_neg_loss: 0.0113, stage1_mean_ious: 0.5685, stage1_s: 0.5620, stage1_m: 0.3659, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1021, grad_norm: 5.2782
2024-10-16 01:07:37,870 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 01:08:55,543 - mmdet - INFO - Evaluating bbox...
2024-10-16 01:08:56,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1763
2024-10-16 01:08:56,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5922
2024-10-16 01:08:56,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3224
2024-10-16 01:08:56,093 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1152
2024-10-16 01:08:56,094 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0567
2024-10-16 01:08:56,094 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0184
2024-10-16 01:08:56,094 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-16 01:08:56,094 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 01:08:56,094 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1860
2024-10-16 01:08:56,094 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0372
2024-10-16 01:08:56,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2731
2024-10-16 01:08:56,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7171
2024-10-16 01:08:56,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2731
2024-10-16 01:08:56,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2731
2024-10-16 01:08:56,094 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 01:08:56,095 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2893
2024-10-16 01:08:56,095 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0639
2024-10-16 01:08:56,100 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 01:08:56,100 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.1760, bbox_mAP_50: 0.5920, bbox_mAP_75: 0.3220, bbox_mAP_s: 0.1150, bbox_mAP_m: 0.0570, bbox_mAP_l: 0.0180, bbox_mAP_copypaste: 0.176 0.592 0.322 0.115 0.057 0.018
2024-10-16 01:09:32,835 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:32:15, time: 0.735, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0876, stage0_bag_acc: 93.1348, stage0_mean_ious: 0.4689, stage0_s: 0.4281, stage0_m: 0.3646, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0367, stage1_bag_acc: 94.5515, stage1_neg_loss: 0.0119, stage1_mean_ious: 0.5671, stage1_s: 0.5591, stage1_m: 0.3644, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.1362, grad_norm: 5.3475
2024-10-16 01:10:06,927 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:31:23, time: 0.682, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0669, stage0_bag_acc: 96.7045, stage0_mean_ious: 0.4799, stage0_s: 0.4314, stage0_m: 0.3225, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0189, stage1_bag_acc: 97.1545, stage1_neg_loss: 0.0101, stage1_mean_ious: 0.5612, stage1_s: 0.5476, stage1_m: 0.3079, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0959, grad_norm: 4.4089
2024-10-16 01:10:40,794 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:30:32, time: 0.677, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0615, stage0_bag_acc: 94.9452, stage0_mean_ious: 0.4866, stage0_s: 0.4615, stage0_m: 0.2986, stage0_l: 0.0192, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0220, stage1_bag_acc: 96.0667, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.5778, stage1_s: 0.5747, stage1_m: 0.2824, stage1_l: 0.0151, stage1_h: 0.0000, loss: 0.0920, grad_norm: 4.5865
2024-10-16 01:11:15,358 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:29:44, time: 0.691, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0651, stage0_bag_acc: 94.5365, stage0_mean_ious: 0.4578, stage0_s: 0.4151, stage0_m: 0.3454, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0242, stage1_bag_acc: 94.0706, stage1_neg_loss: 0.0112, stage1_mean_ious: 0.5618, stage1_s: 0.5437, stage1_m: 0.3307, stage1_l: 0.0074, stage1_h: 0.0000, loss: 0.1004, grad_norm: 5.4505
2024-10-16 01:11:47,497 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:28:52, time: 0.643, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0934, stage0_bag_acc: 91.3667, stage0_mean_ious: 0.4691, stage0_s: 0.4245, stage0_m: 0.2837, stage0_l: 0.0159, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 92.8167, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.5392, stage1_s: 0.5182, stage1_m: 0.2628, stage1_l: 0.0114, stage1_h: 0.0000, loss: 0.1202, grad_norm: 4.9844
2024-10-16 01:12:06,423 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 01:12:46,475 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:27:08, time: 0.757, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0483, stage0_bag_acc: 95.8000, stage0_mean_ious: 0.4450, stage0_s: 0.4175, stage0_m: 0.2904, stage0_l: 0.0188, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0153, stage1_bag_acc: 96.7333, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5388, stage1_s: 0.5396, stage1_m: 0.2886, stage1_l: 0.0116, stage1_h: 0.0000, loss: 0.0693, grad_norm: 3.6297
2024-10-16 01:13:27,052 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:26:37, time: 0.812, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0437, stage0_bag_acc: 97.2602, stage0_mean_ious: 0.5039, stage0_s: 0.4748, stage0_m: 0.3337, stage0_l: 0.0114, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0204, stage1_bag_acc: 94.9276, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5590, stage1_s: 0.5597, stage1_m: 0.3172, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0708, grad_norm: 4.1972
2024-10-16 01:14:08,744 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:26:06, time: 0.834, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0744, stage0_bag_acc: 94.3944, stage0_mean_ious: 0.4943, stage0_s: 0.4609, stage0_m: 0.3206, stage0_l: 0.0253, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0167, stage1_bag_acc: 95.6500, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5749, stage1_s: 0.5600, stage1_m: 0.3301, stage1_l: 0.0238, stage1_h: 0.0000, loss: 0.0966, grad_norm: 4.4083
2024-10-16 01:14:50,970 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:25:36, time: 0.845, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0691, stage0_bag_acc: 95.3476, stage0_mean_ious: 0.4727, stage0_s: 0.4385, stage0_m: 0.2874, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0203, stage1_bag_acc: 94.9476, stage1_neg_loss: 0.0141, stage1_mean_ious: 0.5728, stage1_s: 0.5592, stage1_m: 0.2956, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1034, grad_norm: 4.6708
2024-10-16 01:15:31,674 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:25:03, time: 0.814, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0697, stage0_bag_acc: 95.1110, stage0_mean_ious: 0.4707, stage0_s: 0.4381, stage0_m: 0.3052, stage0_l: 0.0176, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0252, stage1_bag_acc: 94.2110, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.5438, stage1_s: 0.5437, stage1_m: 0.2864, stage1_l: 0.0115, stage1_h: 0.0000, loss: 0.1033, grad_norm: 4.7593
2024-10-16 01:15:57,772 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 01:16:42,971 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:23:40, time: 0.861, data_time: 0.058, memory: 7795, stage0_loss_instance_mil: 0.0362, stage0_bag_acc: 96.6412, stage0_mean_ious: 0.4793, stage0_s: 0.4279, stage0_m: 0.3670, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0091, stage1_bag_acc: 97.8921, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.5673, stage1_s: 0.5457, stage1_m: 0.3753, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.0537, grad_norm: 3.0159
2024-10-16 01:17:26,434 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:23:10, time: 0.869, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0538, stage0_bag_acc: 95.6682, stage0_mean_ious: 0.4970, stage0_s: 0.4467, stage0_m: 0.4473, stage0_l: 0.0235, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0136, stage1_bag_acc: 96.1864, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5601, stage1_s: 0.5541, stage1_m: 0.4110, stage1_l: 0.0164, stage1_h: 0.0000, loss: 0.0702, grad_norm: 3.4841
2024-10-16 01:18:10,111 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:40, time: 0.874, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0396, stage0_bag_acc: 97.0182, stage0_mean_ious: 0.4480, stage0_s: 0.4130, stage0_m: 0.3976, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0200, stage1_bag_acc: 97.7000, stage1_neg_loss: 0.0103, stage1_mean_ious: 0.5562, stage1_s: 0.5427, stage1_m: 0.4151, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0699, grad_norm: 4.0407
2024-10-16 01:18:53,996 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:22:10, time: 0.878, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0273, stage0_bag_acc: 98.0500, stage0_mean_ious: 0.4869, stage0_s: 0.4485, stage0_m: 0.4107, stage0_l: 0.0168, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0159, stage1_bag_acc: 98.5500, stage1_neg_loss: 0.0108, stage1_mean_ious: 0.5552, stage1_s: 0.5478, stage1_m: 0.3958, stage1_l: 0.0151, stage1_h: 0.0000, loss: 0.0540, grad_norm: 3.4498
2024-10-16 01:19:34,731 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:35, time: 0.815, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0432, stage0_bag_acc: 96.9500, stage0_mean_ious: 0.4766, stage0_s: 0.4423, stage0_m: 0.3493, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0172, stage1_bag_acc: 96.5500, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5628, stage1_s: 0.5539, stage1_m: 0.3310, stage1_l: 0.0045, stage1_h: 0.0000, loss: 0.0662, grad_norm: 3.3752
2024-10-16 01:19:58,913 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 01:21:17,818 - mmdet - INFO - Evaluating bbox...
2024-10-16 01:21:18,300 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1602
2024-10-16 01:21:18,301 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.5753
2024-10-16 01:21:18,301 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.2949
2024-10-16 01:21:18,301 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.0891
2024-10-16 01:21:18,301 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0388
2024-10-16 01:21:18,301 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0114
2024-10-16 01:21:18,302 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0002
2024-10-16 01:21:18,302 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 01:21:18,302 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1708
2024-10-16 01:21:18,302 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0319
2024-10-16 01:21:18,302 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2582
2024-10-16 01:21:18,302 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7084
2024-10-16 01:21:18,302 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2582
2024-10-16 01:21:18,302 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2582
2024-10-16 01:21:18,302 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 01:21:18,302 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2741
2024-10-16 01:21:18,302 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0648
2024-10-16 01:21:18,308 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 01:21:18,308 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.1600, bbox_mAP_50: 0.5750, bbox_mAP_75: 0.2950, bbox_mAP_s: 0.0890, bbox_mAP_m: 0.0390, bbox_mAP_l: 0.0110, bbox_mAP_copypaste: 0.160 0.575 0.295 0.089 0.039 0.011
2024-10-16 01:22:03,674 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:20:20, time: 0.907, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0730, stage0_bag_acc: 95.1833, stage0_mean_ious: 0.4865, stage0_s: 0.4285, stage0_m: 0.4248, stage0_l: 0.0098, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0149, stage1_bag_acc: 95.2667, stage1_neg_loss: 0.0076, stage1_mean_ious: 0.5607, stage1_s: 0.5319, stage1_m: 0.4101, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.0955, grad_norm: 5.0194
2024-10-16 01:22:42,909 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:19:44, time: 0.785, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0668, stage0_bag_acc: 95.6742, stage0_mean_ious: 0.4393, stage0_s: 0.3952, stage0_m: 0.2902, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0160, stage1_bag_acc: 95.9879, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5367, stage1_s: 0.5056, stage1_m: 0.2994, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0867, grad_norm: 3.8423
2024-10-16 01:23:26,613 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:19:12, time: 0.874, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0492, stage0_bag_acc: 95.9389, stage0_mean_ious: 0.4940, stage0_s: 0.4549, stage0_m: 0.4014, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0100, stage1_bag_acc: 96.7944, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5760, stage1_s: 0.5625, stage1_m: 0.4149, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0645, grad_norm: 3.4677
2024-10-16 01:24:08,673 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:38, time: 0.841, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0555, stage0_bag_acc: 96.6158, stage0_mean_ious: 0.4887, stage0_s: 0.4518, stage0_m: 0.3476, stage0_l: 0.0103, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0148, stage1_bag_acc: 96.7643, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5707, stage1_s: 0.5667, stage1_m: 0.3539, stage1_l: 0.0083, stage1_h: 0.0000, loss: 0.0776, grad_norm: 3.6776
2024-10-16 01:24:49,884 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:18:02, time: 0.824, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0408, stage0_bag_acc: 97.1667, stage0_mean_ious: 0.4690, stage0_s: 0.4250, stage0_m: 0.2603, stage0_l: 0.0092, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0148, stage1_bag_acc: 97.2167, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5472, stage1_s: 0.5303, stage1_m: 0.2456, stage1_l: 0.0047, stage1_h: 0.0000, loss: 0.0600, grad_norm: 2.7979
2024-10-16 01:25:15,667 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 01:26:02,598 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:51, time: 0.894, data_time: 0.061, memory: 7795, stage0_loss_instance_mil: 0.0296, stage0_bag_acc: 98.1468, stage0_mean_ious: 0.4796, stage0_s: 0.4484, stage0_m: 0.3223, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 97.4468, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5741, stage1_s: 0.5741, stage1_m: 0.2930, stage1_l: 0.0050, stage1_h: 0.0000, loss: 0.0405, grad_norm: 2.3123
2024-10-16 01:26:44,448 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:16:16, time: 0.837, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0446, stage0_bag_acc: 95.9500, stage0_mean_ious: 0.4950, stage0_s: 0.4603, stage0_m: 0.3251, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0203, stage1_bag_acc: 96.5000, stage1_neg_loss: 0.0147, stage1_mean_ious: 0.5615, stage1_s: 0.5507, stage1_m: 0.3271, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0796, grad_norm: 4.6222
2024-10-16 01:27:27,323 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:42, time: 0.857, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0269, stage0_bag_acc: 97.8643, stage0_mean_ious: 0.4811, stage0_s: 0.4290, stage0_m: 0.3041, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0163, stage1_bag_acc: 98.1421, stage1_neg_loss: 0.0103, stage1_mean_ious: 0.5404, stage1_s: 0.5089, stage1_m: 0.2865, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0535, grad_norm: 3.4585
2024-10-16 01:28:01,059 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:15:02, time: 0.675, data_time: 0.008, memory: 7795, stage0_loss_instance_mil: 0.0297, stage0_bag_acc: 97.4212, stage0_mean_ious: 0.4787, stage0_s: 0.4528, stage0_m: 0.2968, stage0_l: 0.0174, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0113, stage1_bag_acc: 98.2172, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5392, stage1_s: 0.5379, stage1_m: 0.2933, stage1_l: 0.0122, stage1_h: 0.0000, loss: 0.0472, grad_norm: 2.9353
2024-10-16 01:28:35,230 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:23, time: 0.683, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0405, stage0_bag_acc: 97.4348, stage0_mean_ious: 0.4735, stage0_s: 0.4253, stage0_m: 0.3726, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0175, stage1_bag_acc: 96.7491, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5474, stage1_s: 0.5363, stage1_m: 0.3598, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0628, grad_norm: 3.0100
2024-10-16 01:28:54,872 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 01:29:33,347 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:12, time: 0.726, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0386, stage0_bag_acc: 96.7506, stage0_mean_ious: 0.4734, stage0_s: 0.4355, stage0_m: 0.3623, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0098, stage1_bag_acc: 97.4643, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5563, stage1_s: 0.5653, stage1_m: 0.3421, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0574, grad_norm: 3.1472
2024-10-16 01:30:05,949 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:33, time: 0.652, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0170, stage0_bag_acc: 98.8833, stage0_mean_ious: 0.5298, stage0_s: 0.4974, stage0_m: 0.3774, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0095, stage1_bag_acc: 99.1333, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5833, stage1_s: 0.5708, stage1_m: 0.3583, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0314, grad_norm: 1.9454
2024-10-16 01:30:38,564 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:11:54, time: 0.652, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0373, stage0_bag_acc: 96.6310, stage0_mean_ious: 0.4809, stage0_s: 0.4591, stage0_m: 0.3144, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0098, stage1_bag_acc: 97.8167, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5617, stage1_s: 0.5484, stage1_m: 0.3278, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0515, grad_norm: 2.8932
2024-10-16 01:31:12,218 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:16, time: 0.673, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0141, stage0_bag_acc: 99.0500, stage0_mean_ious: 0.4865, stage0_s: 0.4557, stage0_m: 0.3694, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0053, stage1_bag_acc: 99.0278, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5597, stage1_s: 0.5593, stage1_m: 0.3672, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0220, grad_norm: 1.4077
2024-10-16 01:31:46,139 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:38, time: 0.678, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0181, stage0_bag_acc: 98.4778, stage0_mean_ious: 0.4818, stage0_s: 0.4412, stage0_m: 0.3122, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0078, stage1_bag_acc: 98.7000, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5446, stage1_s: 0.5315, stage1_m: 0.3061, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.0293, grad_norm: 1.7682
2024-10-16 01:32:11,039 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 01:33:29,269 - mmdet - INFO - Evaluating bbox...
2024-10-16 01:33:29,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1821
2024-10-16 01:33:29,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6110
2024-10-16 01:33:29,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3418
2024-10-16 01:33:29,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1118
2024-10-16 01:33:29,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0467
2024-10-16 01:33:29,838 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0138
2024-10-16 01:33:29,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-16 01:33:29,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 01:33:29,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1930
2024-10-16 01:33:29,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0447
2024-10-16 01:33:29,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2787
2024-10-16 01:33:29,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7350
2024-10-16 01:33:29,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2787
2024-10-16 01:33:29,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2787
2024-10-16 01:33:29,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 01:33:29,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2941
2024-10-16 01:33:29,839 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0811
2024-10-16 01:33:29,845 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 01:33:29,845 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.1820, bbox_mAP_50: 0.6110, bbox_mAP_75: 0.3420, bbox_mAP_s: 0.1120, bbox_mAP_m: 0.0470, bbox_mAP_l: 0.0140, bbox_mAP_copypaste: 0.182 0.611 0.342 0.112 0.047 0.014
2024-10-16 01:34:17,098 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:36, time: 0.945, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.0182, stage0_bag_acc: 98.9778, stage0_mean_ious: 0.5090, stage0_s: 0.4613, stage0_m: 0.3904, stage0_l: 0.0379, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0055, stage1_bag_acc: 98.9778, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5740, stage1_s: 0.5465, stage1_m: 0.3839, stage1_l: 0.0303, stage1_h: 0.0000, loss: 0.0267, grad_norm: 1.7998
2024-10-16 01:34:58,830 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:01, time: 0.835, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0163, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.5302, stage0_s: 0.4836, stage0_m: 0.3516, stage0_l: 0.0119, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0072, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5728, stage1_s: 0.5539, stage1_m: 0.3259, stage1_l: 0.0113, stage1_h: 0.0000, loss: 0.0263, grad_norm: 1.8661
2024-10-16 01:35:41,415 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:26, time: 0.852, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0173, stage0_bag_acc: 98.9000, stage0_mean_ious: 0.4622, stage0_s: 0.4031, stage0_m: 0.3630, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0081, stage1_bag_acc: 98.8643, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5475, stage1_s: 0.5123, stage1_m: 0.3652, stage1_l: 0.0069, stage1_h: 0.0000, loss: 0.0293, grad_norm: 1.7622
2024-10-16 01:36:23,171 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:50, time: 0.835, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0146, stage0_bag_acc: 99.0167, stage0_mean_ious: 0.4629, stage0_s: 0.4450, stage0_m: 0.2496, stage0_l: 0.0088, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0083, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0151, stage1_mean_ious: 0.5356, stage1_s: 0.5350, stage1_m: 0.2297, stage1_l: 0.0083, stage1_h: 0.0000, loss: 0.0380, grad_norm: 2.1175
2024-10-16 01:37:05,795 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:15, time: 0.852, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0106, stage0_bag_acc: 99.2500, stage0_mean_ious: 0.4761, stage0_s: 0.4397, stage0_m: 0.3070, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0099, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5462, stage1_s: 0.5274, stage1_m: 0.3014, stage1_l: 0.0064, stage1_h: 0.0000, loss: 0.0232, grad_norm: 1.5726
2024-10-16 01:37:31,186 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 01:38:18,277 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:13, time: 0.898, data_time: 0.060, memory: 7795, stage0_loss_instance_mil: 0.0102, stage0_bag_acc: 99.5000, stage0_mean_ious: 0.4981, stage0_s: 0.4502, stage0_m: 0.2908, stage0_l: 0.0387, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 99.2500, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5598, stage1_s: 0.5421, stage1_m: 0.2858, stage1_l: 0.0376, stage1_h: 0.0000, loss: 0.0193, grad_norm: 1.1738
2024-10-16 01:38:59,466 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:37, time: 0.824, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0160, stage0_bag_acc: 98.3500, stage0_mean_ious: 0.4747, stage0_s: 0.4354, stage0_m: 0.2753, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0041, stage1_bag_acc: 98.7500, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5655, stage1_s: 0.5562, stage1_m: 0.2804, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0240, grad_norm: 1.7851
2024-10-16 01:39:41,537 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:01, time: 0.841, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0136, stage0_bag_acc: 99.2667, stage0_mean_ious: 0.4693, stage0_s: 0.4201, stage0_m: 0.3026, stage0_l: 0.0358, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0060, stage1_bag_acc: 99.2667, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5556, stage1_s: 0.5109, stage1_m: 0.3168, stage1_l: 0.0247, stage1_h: 0.0000, loss: 0.0245, grad_norm: 1.7296
2024-10-16 01:40:24,021 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 01:40:24,021 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:25, time: 0.850, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0109, stage0_bag_acc: 99.0643, stage0_mean_ious: 0.4964, stage0_s: 0.4230, stage0_m: 0.3479, stage0_l: 0.0221, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0063, stage1_bag_acc: 99.0643, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5421, stage1_s: 0.4959, stage1_m: 0.3276, stage1_l: 0.0262, stage1_h: 0.0000, loss: 0.0201, grad_norm: 1.7222
2024-10-16 01:41:06,646 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:49, time: 0.853, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0185, stage0_bag_acc: 99.0667, stage0_mean_ious: 0.4960, stage0_s: 0.4114, stage0_m: 0.3955, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0058, stage1_bag_acc: 98.6848, stage1_neg_loss: 0.0015, stage1_mean_ious: 0.5674, stage1_s: 0.5180, stage1_m: 0.3855, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0258, grad_norm: 1.4775
2024-10-16 01:41:32,180 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 01:42:19,846 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:49, time: 0.908, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0134, stage0_bag_acc: 99.1000, stage0_mean_ious: 0.4766, stage0_s: 0.4308, stage0_m: 0.3805, stage0_l: 0.0280, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0054, stage1_bag_acc: 98.9000, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5633, stage1_s: 0.5445, stage1_m: 0.3819, stage1_l: 0.0260, stage1_h: 0.0000, loss: 0.0210, grad_norm: 1.3758
2024-10-16 01:43:03,519 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:12, time: 0.873, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0176, stage0_bag_acc: 98.9000, stage0_mean_ious: 0.4852, stage0_s: 0.4503, stage0_m: 0.3656, stage0_l: 0.0100, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0069, stage1_bag_acc: 98.2500, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5539, stage1_s: 0.5473, stage1_m: 0.3667, stage1_l: 0.0133, stage1_h: 0.0000, loss: 0.0261, grad_norm: 1.8391
2024-10-16 01:43:46,017 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:36, time: 0.850, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0178, stage0_bag_acc: 98.5754, stage0_mean_ious: 0.5000, stage0_s: 0.4445, stage0_m: 0.3938, stage0_l: 0.0118, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0059, stage1_bag_acc: 98.5397, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5672, stage1_s: 0.5392, stage1_m: 0.3931, stage1_l: 0.0101, stage1_h: 0.0000, loss: 0.0253, grad_norm: 1.5185
2024-10-16 01:44:28,863 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.857, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0101, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.4902, stage0_s: 0.4693, stage0_m: 0.2897, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0047, stage1_bag_acc: 99.1000, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5759, stage1_s: 0.5759, stage1_m: 0.3001, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0167, grad_norm: 1.2272
2024-10-16 01:45:11,410 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:22, time: 0.851, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0257, stage0_bag_acc: 97.2167, stage0_mean_ious: 0.4880, stage0_s: 0.4141, stage0_m: 0.3430, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 97.1810, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5433, stage1_s: 0.4870, stage1_m: 0.3383, stage1_l: 0.0095, stage1_h: 0.0000, loss: 0.0355, grad_norm: 2.1060
2024-10-16 01:45:35,959 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 01:46:54,346 - mmdet - INFO - Evaluating bbox...
2024-10-16 01:46:54,818 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1836
2024-10-16 01:46:54,818 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6116
2024-10-16 01:46:54,818 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3467
2024-10-16 01:46:54,818 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1129
2024-10-16 01:46:54,818 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0469
2024-10-16 01:46:54,818 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0137
2024-10-16 01:46:54,818 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-16 01:46:54,818 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 01:46:54,819 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1941
2024-10-16 01:46:54,819 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0472
2024-10-16 01:46:54,819 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2811
2024-10-16 01:46:54,819 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7364
2024-10-16 01:46:54,819 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2811
2024-10-16 01:46:54,819 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2811
2024-10-16 01:46:54,819 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 01:46:54,819 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2965
2024-10-16 01:46:54,819 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0841
2024-10-16 01:46:54,824 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 01:46:54,824 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.1840, bbox_mAP_50: 0.6120, bbox_mAP_75: 0.3470, bbox_mAP_s: 0.1130, bbox_mAP_m: 0.0470, bbox_mAP_l: 0.0140, bbox_mAP_copypaste: 0.184 0.612 0.347 0.113 0.047 0.014
2024-10-16 01:48:10,586 - mmdet - INFO - Evaluating bbox...
2024-10-16 01:48:11,060 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1836
2024-10-16 01:48:11,061 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6116
2024-10-16 01:48:11,061 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3467
2024-10-16 01:48:11,061 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1129
2024-10-16 01:48:11,061 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0469
2024-10-16 01:48:11,061 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0137
2024-10-16 01:48:11,061 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-16 01:48:11,061 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 01:48:11,061 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1941
2024-10-16 01:48:11,062 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0472
2024-10-16 01:48:11,062 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2811
2024-10-16 01:48:11,062 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7364
2024-10-16 01:48:11,062 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2811
2024-10-16 01:48:11,062 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2811
2024-10-16 01:48:11,062 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 01:48:11,062 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2965
2024-10-16 01:48:11,062 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0841
2024-10-16 01:48:12,395 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+2fd3e4b
------------------------------------------------------------

2024-10-16 01:48:13,298 - mmdet - INFO - Distributed training: False
2024-10-16 01:48:14,173 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-16 01:48:15,110 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 01:48:15,111 - mmdet - INFO - Use load_from_local loader
2024-10-16 01:48:15,391 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 01:48:15,410 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 01:48:15,411 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 01:48:51,017 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:39:16, time: 0.712, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.7455, stage0_bag_acc: 5.7056, stage0_mean_ious: 0.0348, stage0_s: 0.0336, stage0_m: 0.0127, stage0_l: 0.0006, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1486, stage1_bag_acc: 13.2944, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.0359, stage1_s: 0.0352, stage1_m: 0.0124, stage1_l: 0.0005, stage1_h: 0.0000, loss: 0.8966, grad_norm: 5.7251
2024-10-16 01:49:23,425 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:36:57, time: 0.648, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.7323, stage0_bag_acc: 12.5667, stage0_mean_ious: 0.0400, stage0_s: 0.0361, stage0_m: 0.0248, stage0_l: 0.0046, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1525, stage1_bag_acc: 12.1913, stage1_neg_loss: 0.0014, stage1_mean_ious: 0.0410, stage1_s: 0.0369, stage1_m: 0.0250, stage1_l: 0.0045, stage1_h: 0.0000, loss: 0.8862, grad_norm: 3.9893
2024-10-16 01:49:58,378 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:36:43, time: 0.699, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.6957, stage0_bag_acc: 22.7706, stage0_mean_ious: 0.0684, stage0_s: 0.0602, stage0_m: 0.0552, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1587, stage1_bag_acc: 23.3944, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.0729, stage1_s: 0.0657, stage1_m: 0.0582, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8573, grad_norm: 4.7971
2024-10-16 01:50:33,222 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:36:17, time: 0.697, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.6675, stage0_bag_acc: 21.6045, stage0_mean_ious: 0.0903, stage0_s: 0.0746, stage0_m: 0.0680, stage0_l: 0.0076, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1437, stage1_bag_acc: 34.0833, stage1_neg_loss: 0.0122, stage1_mean_ious: 0.0918, stage1_s: 0.0763, stage1_m: 0.0715, stage1_l: 0.0081, stage1_h: 0.0000, loss: 0.8233, grad_norm: 7.5314
2024-10-16 01:51:10,886 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:36:22, time: 0.753, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.6288, stage0_bag_acc: 31.6808, stage0_mean_ious: 0.1460, stage0_s: 0.1319, stage0_m: 0.1212, stage0_l: 0.0013, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1395, stage1_bag_acc: 44.6338, stage1_neg_loss: 0.0187, stage1_mean_ious: 0.1551, stage1_s: 0.1435, stage1_m: 0.1299, stage1_l: 0.0023, stage1_h: 0.0000, loss: 0.7870, grad_norm: 7.8233
2024-10-16 01:51:35,628 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 01:52:24,763 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:34:01, time: 0.939, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.5121, stage0_bag_acc: 40.2683, stage0_mean_ious: 0.2550, stage0_s: 0.2196, stage0_m: 0.2493, stage0_l: 0.0013, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0934, stage1_bag_acc: 47.1445, stage1_neg_loss: 0.0253, stage1_mean_ious: 0.3326, stage1_s: 0.2997, stage1_m: 0.2993, stage1_l: 0.0024, stage1_h: 0.0000, loss: 0.6307, grad_norm: 8.9364
2024-10-16 01:53:06,151 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:34:28, time: 0.828, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.4433, stage0_bag_acc: 56.9800, stage0_mean_ious: 0.3404, stage0_s: 0.2885, stage0_m: 0.2098, stage0_l: 0.0102, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0839, stage1_bag_acc: 61.0617, stage1_neg_loss: 0.0208, stage1_mean_ious: 0.4404, stage1_s: 0.4034, stage1_m: 0.2441, stage1_l: 0.0108, stage1_h: 0.0000, loss: 0.5481, grad_norm: 10.2449
2024-10-16 01:53:48,898 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:34:48, time: 0.855, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.3386, stage0_bag_acc: 69.7990, stage0_mean_ious: 0.4027, stage0_s: 0.3556, stage0_m: 0.3150, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0823, stage1_bag_acc: 63.9258, stage1_neg_loss: 0.0201, stage1_mean_ious: 0.5182, stage1_s: 0.5051, stage1_m: 0.3237, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.4410, grad_norm: 13.1344
2024-10-16 01:54:29,803 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:34:44, time: 0.818, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.2954, stage0_bag_acc: 74.1753, stage0_mean_ious: 0.4285, stage0_s: 0.3843, stage0_m: 0.2435, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0759, stage1_bag_acc: 76.2095, stage1_neg_loss: 0.0172, stage1_mean_ious: 0.5165, stage1_s: 0.4957, stage1_m: 0.2481, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.3885, grad_norm: 12.6853
2024-10-16 01:55:11,499 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:34:37, time: 0.834, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.1877, stage0_bag_acc: 84.6799, stage0_mean_ious: 0.4430, stage0_s: 0.3910, stage0_m: 0.3333, stage0_l: 0.0250, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0606, stage1_bag_acc: 84.2917, stage1_neg_loss: 0.0206, stage1_mean_ious: 0.5265, stage1_s: 0.5088, stage1_m: 0.3118, stage1_l: 0.0158, stage1_h: 0.0000, loss: 0.2689, grad_norm: 8.7507
2024-10-16 01:55:38,118 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 01:56:23,909 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:32:30, time: 0.872, data_time: 0.057, memory: 7795, stage0_loss_instance_mil: 0.1593, stage0_bag_acc: 87.4325, stage0_mean_ious: 0.4576, stage0_s: 0.3971, stage0_m: 0.3112, stage0_l: 0.0231, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0474, stage1_bag_acc: 89.0643, stage1_neg_loss: 0.0176, stage1_mean_ious: 0.5404, stage1_s: 0.5040, stage1_m: 0.2912, stage1_l: 0.0134, stage1_h: 0.0000, loss: 0.2242, grad_norm: 7.6065
2024-10-16 01:57:07,112 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:32:26, time: 0.864, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.1405, stage0_bag_acc: 88.5411, stage0_mean_ious: 0.4572, stage0_s: 0.4086, stage0_m: 0.3644, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0378, stage1_bag_acc: 89.5563, stage1_neg_loss: 0.0121, stage1_mean_ious: 0.5421, stage1_s: 0.5313, stage1_m: 0.3543, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.1904, grad_norm: 6.6687
2024-10-16 01:57:48,607 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:32:11, time: 0.830, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.1233, stage0_bag_acc: 89.3896, stage0_mean_ious: 0.4728, stage0_s: 0.4154, stage0_m: 0.3468, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0349, stage1_bag_acc: 90.8063, stage1_neg_loss: 0.0113, stage1_mean_ious: 0.5733, stage1_s: 0.5423, stage1_m: 0.3234, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1695, grad_norm: 6.7083
2024-10-16 01:58:30,935 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:31:54, time: 0.847, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.1090, stage0_bag_acc: 92.7515, stage0_mean_ious: 0.4722, stage0_s: 0.4259, stage0_m: 0.3637, stage0_l: 0.0450, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0312, stage1_bag_acc: 93.4015, stage1_neg_loss: 0.0128, stage1_mean_ious: 0.5580, stage1_s: 0.5564, stage1_m: 0.3346, stage1_l: 0.0347, stage1_h: 0.0000, loss: 0.1530, grad_norm: 6.0446
2024-10-16 01:59:14,085 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:31:37, time: 0.863, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.1275, stage0_bag_acc: 90.6522, stage0_mean_ious: 0.4465, stage0_s: 0.3753, stage0_m: 0.3224, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0367, stage1_bag_acc: 90.1522, stage1_neg_loss: 0.0143, stage1_mean_ious: 0.5600, stage1_s: 0.5296, stage1_m: 0.3279, stage1_l: 0.0068, stage1_h: 0.0000, loss: 0.1784, grad_norm: 6.0799
2024-10-16 01:59:38,959 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 02:00:56,134 - mmdet - INFO - Evaluating bbox...
2024-10-16 02:00:56,628 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2205
2024-10-16 02:00:56,629 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6884
2024-10-16 02:00:56,629 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4291
2024-10-16 02:00:56,629 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1484
2024-10-16 02:00:56,629 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0685
2024-10-16 02:00:56,629 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0239
2024-10-16 02:00:56,629 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0019
2024-10-16 02:00:56,630 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:00:56,630 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2315
2024-10-16 02:00:56,630 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0951
2024-10-16 02:00:56,630 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3278
2024-10-16 02:00:56,630 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7887
2024-10-16 02:00:56,630 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3278
2024-10-16 02:00:56,630 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3278
2024-10-16 02:00:56,630 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:00:56,630 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3474
2024-10-16 02:00:56,630 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1043
2024-10-16 02:00:56,636 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 02:00:56,636 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2200, bbox_mAP_50: 0.6880, bbox_mAP_75: 0.4290, bbox_mAP_s: 0.1480, bbox_mAP_m: 0.0690, bbox_mAP_l: 0.0240, bbox_mAP_copypaste: 0.220 0.688 0.429 0.148 0.069 0.024
2024-10-16 02:01:41,165 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:29:56, time: 0.890, data_time: 0.059, memory: 7795, stage0_loss_instance_mil: 0.0562, stage0_bag_acc: 95.4667, stage0_mean_ious: 0.4740, stage0_s: 0.4409, stage0_m: 0.3159, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0242, stage1_bag_acc: 94.8587, stage1_neg_loss: 0.0121, stage1_mean_ious: 0.5758, stage1_s: 0.5624, stage1_m: 0.3271, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0926, grad_norm: 4.2404
2024-10-16 02:02:23,944 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:29:36, time: 0.856, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0538, stage0_bag_acc: 95.4778, stage0_mean_ious: 0.4882, stage0_s: 0.4434, stage0_m: 0.3400, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0195, stage1_bag_acc: 97.5500, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.5914, stage1_s: 0.5737, stage1_m: 0.3630, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0809, grad_norm: 4.4438
2024-10-16 02:03:07,770 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:29:17, time: 0.876, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0640, stage0_bag_acc: 94.7626, stage0_mean_ious: 0.4924, stage0_s: 0.3899, stage0_m: 0.4084, stage0_l: 0.0198, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0316, stage1_bag_acc: 94.4293, stage1_neg_loss: 0.0264, stage1_mean_ious: 0.5588, stage1_s: 0.5303, stage1_m: 0.3698, stage1_l: 0.0148, stage1_h: 0.0000, loss: 0.1220, grad_norm: 6.4872
2024-10-16 02:03:47,858 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:28:46, time: 0.802, data_time: 0.009, memory: 7795, stage0_loss_instance_mil: 0.0999, stage0_bag_acc: 92.2897, stage0_mean_ious: 0.4679, stage0_s: 0.4200, stage0_m: 0.2848, stage0_l: 0.0114, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0221, stage1_bag_acc: 93.0254, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.5336, stage1_s: 0.5283, stage1_m: 0.2398, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.1287, grad_norm: 6.2703
2024-10-16 02:04:28,935 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:28:17, time: 0.822, data_time: 0.010, memory: 7795, stage0_loss_instance_mil: 0.0763, stage0_bag_acc: 94.3397, stage0_mean_ious: 0.4782, stage0_s: 0.4239, stage0_m: 0.3386, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0292, stage1_bag_acc: 94.0897, stage1_neg_loss: 0.0127, stage1_mean_ious: 0.5461, stage1_s: 0.5244, stage1_m: 0.3280, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1183, grad_norm: 5.2156
2024-10-16 02:04:56,356 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 02:05:42,545 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:26:48, time: 0.880, data_time: 0.059, memory: 7796, stage0_loss_instance_mil: 0.0718, stage0_bag_acc: 94.6786, stage0_mean_ious: 0.4646, stage0_s: 0.4086, stage0_m: 0.3006, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0205, stage1_bag_acc: 95.2976, stage1_neg_loss: 0.0112, stage1_mean_ious: 0.5569, stage1_s: 0.5244, stage1_m: 0.3016, stage1_l: 0.0065, stage1_h: 0.0000, loss: 0.1036, grad_norm: 5.0979
2024-10-16 02:06:16,064 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:26:05, time: 0.670, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0755, stage0_bag_acc: 93.1212, stage0_mean_ious: 0.4741, stage0_s: 0.4391, stage0_m: 0.3432, stage0_l: 0.0197, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0264, stage1_bag_acc: 93.8293, stage1_neg_loss: 0.0079, stage1_mean_ious: 0.5599, stage1_s: 0.5494, stage1_m: 0.3602, stage1_l: 0.0178, stage1_h: 0.0000, loss: 0.1098, grad_norm: 4.9159
2024-10-16 02:06:49,513 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:25:24, time: 0.669, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0640, stage0_bag_acc: 94.5833, stage0_mean_ious: 0.4703, stage0_s: 0.4418, stage0_m: 0.3164, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0215, stage1_bag_acc: 95.0833, stage1_neg_loss: 0.0071, stage1_mean_ious: 0.5612, stage1_s: 0.5543, stage1_m: 0.3238, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0926, grad_norm: 4.3494
2024-10-16 02:07:23,759 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:24:44, time: 0.685, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0361, stage0_bag_acc: 97.0976, stage0_mean_ious: 0.5172, stage0_s: 0.4834, stage0_m: 0.3902, stage0_l: 0.0268, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0147, stage1_bag_acc: 97.7643, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5981, stage1_s: 0.6056, stage1_m: 0.3756, stage1_l: 0.0197, stage1_h: 0.0000, loss: 0.0560, grad_norm: 3.3147
2024-10-16 02:07:56,723 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:24:02, time: 0.659, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0512, stage0_bag_acc: 95.8500, stage0_mean_ious: 0.5102, stage0_s: 0.4860, stage0_m: 0.3691, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0165, stage1_bag_acc: 96.2167, stage1_neg_loss: 0.0098, stage1_mean_ious: 0.5919, stage1_s: 0.5838, stage1_m: 0.3886, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0775, grad_norm: 4.4053
2024-10-16 02:08:17,757 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 02:08:55,926 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:22:35, time: 0.718, data_time: 0.060, memory: 7796, stage0_loss_instance_mil: 0.0407, stage0_bag_acc: 96.6500, stage0_mean_ious: 0.5187, stage0_s: 0.4560, stage0_m: 0.4234, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0139, stage1_bag_acc: 96.4500, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5932, stage1_s: 0.5556, stage1_m: 0.4001, stage1_l: 0.0048, stage1_h: 0.0000, loss: 0.0608, grad_norm: 3.1929
2024-10-16 02:09:29,995 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:21:58, time: 0.682, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0280, stage0_bag_acc: 97.7556, stage0_mean_ious: 0.4989, stage0_s: 0.4502, stage0_m: 0.3805, stage0_l: 0.0224, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0178, stage1_bag_acc: 98.4556, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5654, stage1_s: 0.5623, stage1_m: 0.3441, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.0508, grad_norm: 2.4877
2024-10-16 02:10:08,389 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:21:26, time: 0.768, data_time: 0.010, memory: 7796, stage0_loss_instance_mil: 0.0400, stage0_bag_acc: 97.0864, stage0_mean_ious: 0.4919, stage0_s: 0.4444, stage0_m: 0.3480, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0114, stage1_bag_acc: 97.4015, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5871, stage1_s: 0.5635, stage1_m: 0.3609, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0603, grad_norm: 4.0175
2024-10-16 02:10:49,703 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:20:57, time: 0.826, data_time: 0.008, memory: 7796, stage0_loss_instance_mil: 0.0540, stage0_bag_acc: 96.6167, stage0_mean_ious: 0.4646, stage0_s: 0.4381, stage0_m: 0.3069, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0144, stage1_bag_acc: 96.4348, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5624, stage1_s: 0.5507, stage1_m: 0.3133, stage1_l: 0.0050, stage1_h: 0.0000, loss: 0.0746, grad_norm: 3.7203
2024-10-16 02:11:31,775 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:20:28, time: 0.841, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0515, stage0_bag_acc: 95.4611, stage0_mean_ious: 0.4873, stage0_s: 0.4496, stage0_m: 0.2957, stage0_l: 0.0178, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0163, stage1_bag_acc: 95.8944, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.5667, stage1_s: 0.5587, stage1_m: 0.3003, stage1_l: 0.0147, stage1_h: 0.0000, loss: 0.0744, grad_norm: 3.8505
2024-10-16 02:11:55,430 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 02:13:13,926 - mmdet - INFO - Evaluating bbox...
2024-10-16 02:13:14,482 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2218
2024-10-16 02:13:14,482 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6780
2024-10-16 02:13:14,482 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4296
2024-10-16 02:13:14,482 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1540
2024-10-16 02:13:14,482 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0730
2024-10-16 02:13:14,482 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0239
2024-10-16 02:13:14,482 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-10-16 02:13:14,483 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:13:14,483 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2330
2024-10-16 02:13:14,483 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0718
2024-10-16 02:13:14,483 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3294
2024-10-16 02:13:14,483 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7843
2024-10-16 02:13:14,483 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3294
2024-10-16 02:13:14,483 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3294
2024-10-16 02:13:14,483 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:13:14,483 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3491
2024-10-16 02:13:14,484 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0907
2024-10-16 02:13:14,489 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 02:13:14,489 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2220, bbox_mAP_50: 0.6780, bbox_mAP_75: 0.4300, bbox_mAP_s: 0.1540, bbox_mAP_m: 0.0730, bbox_mAP_l: 0.0240, bbox_mAP_copypaste: 0.222 0.678 0.430 0.154 0.073 0.024
2024-10-16 02:14:00,456 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:19:19, time: 0.919, data_time: 0.058, memory: 7796, stage0_loss_instance_mil: 0.0393, stage0_bag_acc: 96.8563, stage0_mean_ious: 0.5049, stage0_s: 0.4361, stage0_m: 0.3825, stage0_l: 0.0308, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0154, stage1_bag_acc: 96.6563, stage1_neg_loss: 0.0111, stage1_mean_ious: 0.5655, stage1_s: 0.5482, stage1_m: 0.3444, stage1_l: 0.0230, stage1_h: 0.0000, loss: 0.0658, grad_norm: 3.8881
2024-10-16 02:14:41,217 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:18:48, time: 0.815, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0540, stage0_bag_acc: 96.4667, stage0_mean_ious: 0.5162, stage0_s: 0.4863, stage0_m: 0.2825, stage0_l: 0.0117, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0192, stage1_bag_acc: 96.1667, stage1_neg_loss: 0.0105, stage1_mean_ious: 0.6106, stage1_s: 0.6103, stage1_m: 0.2617, stage1_l: 0.0074, stage1_h: 0.0000, loss: 0.0837, grad_norm: 4.1581
2024-10-16 02:15:23,451 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:18:18, time: 0.845, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0375, stage0_bag_acc: 97.5643, stage0_mean_ious: 0.4578, stage0_s: 0.4209, stage0_m: 0.2870, stage0_l: 0.0115, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0139, stage1_bag_acc: 97.5643, stage1_neg_loss: 0.0064, stage1_mean_ious: 0.5576, stage1_s: 0.5446, stage1_m: 0.3012, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.0577, grad_norm: 3.4064
2024-10-16 02:16:08,544 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:17:49, time: 0.902, data_time: 0.010, memory: 7796, stage0_loss_instance_mil: 0.0338, stage0_bag_acc: 97.6167, stage0_mean_ious: 0.5245, stage0_s: 0.4672, stage0_m: 0.4406, stage0_l: 0.0053, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0107, stage1_bag_acc: 97.6167, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.6036, stage1_s: 0.5947, stage1_m: 0.4083, stage1_l: 0.0048, stage1_h: 0.0000, loss: 0.0501, grad_norm: 3.2857
2024-10-16 02:16:50,118 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:17:17, time: 0.831, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0701, stage0_bag_acc: 94.8833, stage0_mean_ious: 0.5064, stage0_s: 0.4668, stage0_m: 0.3087, stage0_l: 0.0351, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0198, stage1_bag_acc: 95.5500, stage1_neg_loss: 0.0121, stage1_mean_ious: 0.5871, stage1_s: 0.5901, stage1_m: 0.2792, stage1_l: 0.0256, stage1_h: 0.0000, loss: 0.1019, grad_norm: 5.5828
2024-10-16 02:17:15,366 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 02:18:01,427 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:10, time: 0.887, data_time: 0.056, memory: 7796, stage0_loss_instance_mil: 0.0238, stage0_bag_acc: 98.2667, stage0_mean_ious: 0.5148, stage0_s: 0.4778, stage0_m: 0.4089, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0071, stage1_bag_acc: 99.0000, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5874, stage1_s: 0.5794, stage1_m: 0.3846, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0350, grad_norm: 2.3542
2024-10-16 02:18:44,507 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:15:39, time: 0.862, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0204, stage0_bag_acc: 99.0921, stage0_mean_ious: 0.5102, stage0_s: 0.4569, stage0_m: 0.3611, stage0_l: 0.0180, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0102, stage1_bag_acc: 98.5087, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5914, stage1_s: 0.5748, stage1_m: 0.3374, stage1_l: 0.0131, stage1_h: 0.0000, loss: 0.0365, grad_norm: 2.4536
2024-10-16 02:19:27,286 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:06, time: 0.856, data_time: 0.010, memory: 7796, stage0_loss_instance_mil: 0.0629, stage0_bag_acc: 95.4167, stage0_mean_ious: 0.5072, stage0_s: 0.4433, stage0_m: 0.3847, stage0_l: 0.0109, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0153, stage1_bag_acc: 95.9500, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5815, stage1_s: 0.5540, stage1_m: 0.3674, stage1_l: 0.0059, stage1_h: 0.0000, loss: 0.0831, grad_norm: 3.3076
2024-10-16 02:20:09,656 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:14:34, time: 0.847, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0472, stage0_bag_acc: 96.6667, stage0_mean_ious: 0.5069, stage0_s: 0.4380, stage0_m: 0.3863, stage0_l: 0.0189, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0119, stage1_bag_acc: 97.0667, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.6035, stage1_s: 0.5704, stage1_m: 0.3890, stage1_l: 0.0140, stage1_h: 0.0000, loss: 0.0628, grad_norm: 2.8660
2024-10-16 02:20:53,467 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:01, time: 0.876, data_time: 0.010, memory: 7796, stage0_loss_instance_mil: 0.0621, stage0_bag_acc: 95.6030, stage0_mean_ious: 0.4709, stage0_s: 0.4494, stage0_m: 0.2665, stage0_l: 0.0071, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0116, stage1_bag_acc: 96.1864, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5696, stage1_s: 0.5656, stage1_m: 0.2919, stage1_l: 0.0051, stage1_h: 0.0000, loss: 0.0773, grad_norm: 3.5071
2024-10-16 02:21:20,463 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 02:22:09,656 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:12:57, time: 0.933, data_time: 0.060, memory: 7796, stage0_loss_instance_mil: 0.0313, stage0_bag_acc: 97.5030, stage0_mean_ious: 0.4927, stage0_s: 0.4266, stage0_m: 0.3208, stage0_l: 0.0250, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0119, stage1_bag_acc: 97.8641, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5826, stage1_s: 0.5510, stage1_m: 0.3193, stage1_l: 0.0175, stage1_h: 0.0000, loss: 0.0457, grad_norm: 2.8541
2024-10-16 02:22:52,581 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:23, time: 0.859, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0314, stage0_bag_acc: 96.4810, stage0_mean_ious: 0.4732, stage0_s: 0.4402, stage0_m: 0.3734, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0104, stage1_bag_acc: 96.8810, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5788, stage1_s: 0.5746, stage1_m: 0.3773, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0479, grad_norm: 2.8431
2024-10-16 02:23:36,166 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:11:50, time: 0.872, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0294, stage0_bag_acc: 98.3833, stage0_mean_ious: 0.5155, stage0_s: 0.4182, stage0_m: 0.3372, stage0_l: 0.0287, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0102, stage1_bag_acc: 97.7833, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5911, stage1_s: 0.5195, stage1_m: 0.3224, stage1_l: 0.0287, stage1_h: 0.0000, loss: 0.0455, grad_norm: 2.5598
2024-10-16 02:24:19,727 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:16, time: 0.871, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0308, stage0_bag_acc: 98.1506, stage0_mean_ious: 0.5058, stage0_s: 0.4563, stage0_m: 0.3629, stage0_l: 0.0191, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 97.4006, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.6022, stage1_s: 0.5953, stage1_m: 0.3546, stage1_l: 0.0168, stage1_h: 0.0000, loss: 0.0440, grad_norm: 2.7426
2024-10-16 02:24:54,142 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:38, time: 0.688, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0173, stage0_bag_acc: 98.6325, stage0_mean_ious: 0.5089, stage0_s: 0.4643, stage0_m: 0.3374, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0062, stage1_bag_acc: 99.0143, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.5946, stage1_s: 0.5828, stage1_m: 0.3296, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0254, grad_norm: 1.4936
2024-10-16 02:25:14,124 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 02:26:29,599 - mmdet - INFO - Evaluating bbox...
2024-10-16 02:26:30,071 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2223
2024-10-16 02:26:30,071 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6834
2024-10-16 02:26:30,071 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4309
2024-10-16 02:26:30,071 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1557
2024-10-16 02:26:30,072 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0715
2024-10-16 02:26:30,072 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0233
2024-10-16 02:26:30,072 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 02:26:30,072 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:26:30,072 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2337
2024-10-16 02:26:30,072 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0781
2024-10-16 02:26:30,072 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3276
2024-10-16 02:26:30,072 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7860
2024-10-16 02:26:30,072 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3276
2024-10-16 02:26:30,072 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3276
2024-10-16 02:26:30,073 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:26:30,073 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3467
2024-10-16 02:26:30,073 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0984
2024-10-16 02:26:30,077 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 02:26:30,077 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2220, bbox_mAP_50: 0.6830, bbox_mAP_75: 0.4310, bbox_mAP_s: 0.1560, bbox_mAP_m: 0.0720, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.222 0.683 0.431 0.156 0.072 0.023
2024-10-16 02:27:05,197 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:32, time: 0.702, data_time: 0.057, memory: 7796, stage0_loss_instance_mil: 0.0292, stage0_bag_acc: 97.2143, stage0_mean_ious: 0.4965, stage0_s: 0.4476, stage0_m: 0.2950, stage0_l: 0.0077, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0097, stage1_bag_acc: 97.6643, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5825, stage1_s: 0.5620, stage1_m: 0.2736, stage1_l: 0.0087, stage1_h: 0.0000, loss: 0.0432, grad_norm: 2.1943
2024-10-16 02:27:37,323 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:08:55, time: 0.642, data_time: 0.008, memory: 7796, stage0_loss_instance_mil: 0.0227, stage0_bag_acc: 98.7643, stage0_mean_ious: 0.4894, stage0_s: 0.4391, stage0_m: 0.2887, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0071, stage1_bag_acc: 98.5143, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5694, stage1_s: 0.5454, stage1_m: 0.2943, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0351, grad_norm: 2.0938
2024-10-16 02:28:10,789 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:18, time: 0.669, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0190, stage0_bag_acc: 98.3167, stage0_mean_ious: 0.5208, stage0_s: 0.4778, stage0_m: 0.4383, stage0_l: 0.0167, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 98.5667, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.6114, stage1_s: 0.6215, stage1_m: 0.4349, stage1_l: 0.0126, stage1_h: 0.0000, loss: 0.0352, grad_norm: 2.6016
2024-10-16 02:28:45,456 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:42, time: 0.693, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0194, stage0_bag_acc: 98.6500, stage0_mean_ious: 0.4934, stage0_s: 0.4619, stage0_m: 0.3019, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0100, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.5749, stage1_s: 0.5437, stage1_m: 0.3007, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0327, grad_norm: 2.0689
2024-10-16 02:29:25,508 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:06, time: 0.801, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0213, stage0_bag_acc: 98.0310, stage0_mean_ious: 0.4950, stage0_s: 0.4776, stage0_m: 0.3110, stage0_l: 0.0107, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0055, stage1_bag_acc: 98.8143, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5831, stage1_s: 0.5800, stage1_m: 0.3259, stage1_l: 0.0085, stage1_h: 0.0000, loss: 0.0320, grad_norm: 2.2226
2024-10-16 02:29:51,807 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 02:30:38,125 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:06, time: 0.887, data_time: 0.058, memory: 7796, stage0_loss_instance_mil: 0.0251, stage0_bag_acc: 97.9000, stage0_mean_ious: 0.4725, stage0_s: 0.4471, stage0_m: 0.2941, stage0_l: 0.0105, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0058, stage1_bag_acc: 98.4000, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5800, stage1_s: 0.5749, stage1_m: 0.3016, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.0366, grad_norm: 2.3945
2024-10-16 02:31:20,338 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:31, time: 0.844, data_time: 0.010, memory: 7796, stage0_loss_instance_mil: 0.0223, stage0_bag_acc: 98.3784, stage0_mean_ious: 0.5067, stage0_s: 0.4645, stage0_m: 0.3639, stage0_l: 0.0077, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0085, stage1_bag_acc: 98.6506, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5941, stage1_s: 0.5831, stage1_m: 0.3413, stage1_l: 0.0087, stage1_h: 0.0000, loss: 0.0340, grad_norm: 2.4568
2024-10-16 02:32:01,947 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:04:56, time: 0.832, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0162, stage0_bag_acc: 99.0167, stage0_mean_ious: 0.5134, stage0_s: 0.4711, stage0_m: 0.3199, stage0_l: 0.0207, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0055, stage1_bag_acc: 98.9667, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5914, stage1_s: 0.5812, stage1_m: 0.3139, stage1_l: 0.0118, stage1_h: 0.0000, loss: 0.0245, grad_norm: 1.7892
2024-10-16 02:32:46,653 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 02:32:46,653 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:21, time: 0.894, data_time: 0.009, memory: 7796, stage0_loss_instance_mil: 0.0232, stage0_bag_acc: 98.0500, stage0_mean_ious: 0.4837, stage0_s: 0.4227, stage0_m: 0.3771, stage0_l: 0.0131, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0116, stage1_bag_acc: 97.8000, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5770, stage1_s: 0.5425, stage1_m: 0.3890, stage1_l: 0.0156, stage1_h: 0.0000, loss: 0.0390, grad_norm: 2.3547
2024-10-16 02:33:29,737 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:45, time: 0.862, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0127, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.5086, stage0_s: 0.4416, stage0_m: 0.3393, stage0_l: 0.0162, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0038, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5850, stage1_s: 0.5531, stage1_m: 0.3326, stage1_l: 0.0155, stage1_h: 0.0000, loss: 0.0188, grad_norm: 1.5448
2024-10-16 02:33:57,069 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 02:34:47,303 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:46, time: 0.961, data_time: 0.059, memory: 7803, stage0_loss_instance_mil: 0.0067, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.5261, stage0_s: 0.4511, stage0_m: 0.4478, stage0_l: 0.0215, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0060, stage1_bag_acc: 99.7500, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5981, stage1_s: 0.5606, stage1_m: 0.4528, stage1_l: 0.0135, stage1_h: 0.0000, loss: 0.0149, grad_norm: 0.9947
2024-10-16 02:35:30,572 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:10, time: 0.865, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0096, stage0_bag_acc: 99.4000, stage0_mean_ious: 0.5017, stage0_s: 0.4747, stage0_m: 0.3443, stage0_l: 0.0127, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0087, stage1_bag_acc: 99.2000, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5901, stage1_s: 0.5992, stage1_m: 0.3377, stage1_l: 0.0121, stage1_h: 0.0000, loss: 0.0201, grad_norm: 1.3551
2024-10-16 02:36:12,733 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:34, time: 0.843, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0081, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.5000, stage0_s: 0.4437, stage0_m: 0.3740, stage0_l: 0.0223, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0053, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5916, stage1_s: 0.5678, stage1_m: 0.3653, stage1_l: 0.0145, stage1_h: 0.0000, loss: 0.0170, grad_norm: 1.4408
2024-10-16 02:36:54,351 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:58, time: 0.832, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0194, stage0_bag_acc: 98.4000, stage0_mean_ious: 0.4768, stage0_s: 0.4455, stage0_m: 0.2722, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0070, stage1_bag_acc: 98.8500, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5564, stage1_s: 0.5526, stage1_m: 0.2813, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0282, grad_norm: 1.5735
2024-10-16 02:37:34,371 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:21, time: 0.800, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0362, stage0_bag_acc: 96.6397, stage0_mean_ious: 0.5047, stage0_s: 0.4533, stage0_m: 0.3361, stage0_l: 0.0091, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0068, stage1_bag_acc: 97.6452, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5885, stage1_s: 0.5690, stage1_m: 0.3187, stage1_l: 0.0093, stage1_h: 0.0000, loss: 0.0454, grad_norm: 2.6326
2024-10-16 02:38:01,984 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 02:39:18,656 - mmdet - INFO - Evaluating bbox...
2024-10-16 02:39:19,215 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2238
2024-10-16 02:39:19,215 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6863
2024-10-16 02:39:19,215 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4374
2024-10-16 02:39:19,215 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1556
2024-10-16 02:39:19,215 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0713
2024-10-16 02:39:19,215 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0224
2024-10-16 02:39:19,215 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 02:39:19,215 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:39:19,216 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2350
2024-10-16 02:39:19,216 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0747
2024-10-16 02:39:19,216 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3298
2024-10-16 02:39:19,216 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7881
2024-10-16 02:39:19,216 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3298
2024-10-16 02:39:19,216 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3298
2024-10-16 02:39:19,216 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:39:19,216 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3491
2024-10-16 02:39:19,216 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0957
2024-10-16 02:39:19,221 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 02:39:19,221 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2240, bbox_mAP_50: 0.6860, bbox_mAP_75: 0.4370, bbox_mAP_s: 0.1560, bbox_mAP_m: 0.0710, bbox_mAP_l: 0.0220, bbox_mAP_copypaste: 0.224 0.686 0.437 0.156 0.071 0.022
2024-10-16 02:40:35,349 - mmdet - INFO - Evaluating bbox...
2024-10-16 02:40:35,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2238
2024-10-16 02:40:35,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6863
2024-10-16 02:40:35,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4374
2024-10-16 02:40:35,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1556
2024-10-16 02:40:35,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0713
2024-10-16 02:40:35,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0224
2024-10-16 02:40:35,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 02:40:35,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:40:35,839 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2350
2024-10-16 02:40:35,840 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0747
2024-10-16 02:40:35,840 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3298
2024-10-16 02:40:35,840 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7881
2024-10-16 02:40:35,840 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3298
2024-10-16 02:40:35,840 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3298
2024-10-16 02:40:35,840 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:40:35,840 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3491
2024-10-16 02:40:35,840 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0957
2024-10-16 02:40:37,069 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+2fd3e4b
------------------------------------------------------------

2024-10-16 02:40:37,933 - mmdet - INFO - Distributed training: False
2024-10-16 02:40:38,768 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-16 02:40:39,782 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 02:40:39,782 - mmdet - INFO - Use load_from_local loader
2024-10-16 02:40:40,048 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 02:40:40,061 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 02:40:40,062 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 02:41:26,222 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:50:55, time: 0.923, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.6995, stage0_bag_acc: 23.1262, stage0_mean_ious: 0.0497, stage0_s: 0.0455, stage0_m: 0.0286, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1727, stage1_bag_acc: 23.7690, stage1_neg_loss: 0.0013, stage1_mean_ious: 0.0548, stage1_s: 0.0512, stage1_m: 0.0287, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8735, grad_norm: 6.1448
2024-10-16 02:42:10,349 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:49:03, time: 0.883, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.7146, stage0_bag_acc: 20.4804, stage0_mean_ious: 0.0440, stage0_s: 0.0403, stage0_m: 0.0303, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1581, stage1_bag_acc: 26.8338, stage1_neg_loss: 0.0015, stage1_mean_ious: 0.0435, stage1_s: 0.0405, stage1_m: 0.0274, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8742, grad_norm: 6.0411
2024-10-16 02:42:55,826 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:48:25, time: 0.910, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.6998, stage0_bag_acc: 14.8952, stage0_mean_ious: 0.0706, stage0_s: 0.0522, stage0_m: 0.0619, stage0_l: 0.0061, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1610, stage1_bag_acc: 12.5000, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.0681, stage1_s: 0.0511, stage1_m: 0.0578, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.8647, grad_norm: 6.4882
2024-10-16 02:43:33,017 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:45:32, time: 0.744, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.6701, stage0_bag_acc: 21.5319, stage0_mean_ious: 0.1103, stage0_s: 0.0983, stage0_m: 0.0728, stage0_l: 0.0026, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1570, stage1_bag_acc: 20.9408, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.1043, stage1_s: 0.0923, stage1_m: 0.0660, stage1_l: 0.0026, stage1_h: 0.0000, loss: 0.8343, grad_norm: 7.7533
2024-10-16 02:44:06,186 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:42:44, time: 0.663, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.6324, stage0_bag_acc: 32.3419, stage0_mean_ious: 0.1655, stage0_s: 0.1435, stage0_m: 0.1128, stage0_l: 0.0010, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1380, stage1_bag_acc: 38.1384, stage1_neg_loss: 0.0176, stage1_mean_ious: 0.1658, stage1_s: 0.1525, stage1_m: 0.1033, stage1_l: 0.0007, stage1_h: 0.0000, loss: 0.7880, grad_norm: 9.2274
2024-10-16 02:44:25,698 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 02:45:02,550 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:36:50, time: 0.693, data_time: 0.058, memory: 7803, stage0_loss_instance_mil: 0.5368, stage0_bag_acc: 43.6136, stage0_mean_ious: 0.2497, stage0_s: 0.2257, stage0_m: 0.1477, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0966, stage1_bag_acc: 43.1581, stage1_neg_loss: 0.0239, stage1_mean_ious: 0.2948, stage1_s: 0.2753, stage1_m: 0.1646, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.6572, grad_norm: 10.4597
2024-10-16 02:45:35,955 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:35:50, time: 0.668, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.3199, stage0_bag_acc: 71.5452, stage0_mean_ious: 0.3855, stage0_s: 0.3355, stage0_m: 0.2634, stage0_l: 0.0145, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0766, stage1_bag_acc: 71.2119, stage1_neg_loss: 0.0183, stage1_mean_ious: 0.4919, stage1_s: 0.4648, stage1_m: 0.2847, stage1_l: 0.0088, stage1_h: 0.0000, loss: 0.4147, grad_norm: 10.9141
2024-10-16 02:46:07,658 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:34:44, time: 0.634, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.2771, stage0_bag_acc: 76.0790, stage0_mean_ious: 0.4383, stage0_s: 0.4126, stage0_m: 0.2624, stage0_l: 0.0143, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0793, stage1_bag_acc: 76.6386, stage1_neg_loss: 0.0206, stage1_mean_ious: 0.5163, stage1_s: 0.5082, stage1_m: 0.2781, stage1_l: 0.0138, stage1_h: 0.0000, loss: 0.3770, grad_norm: 11.8167
2024-10-16 02:46:41,815 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:34:00, time: 0.683, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.2426, stage0_bag_acc: 82.1658, stage0_mean_ious: 0.4505, stage0_s: 0.4026, stage0_m: 0.3821, stage0_l: 0.0116, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0553, stage1_bag_acc: 83.0870, stage1_neg_loss: 0.0138, stage1_mean_ious: 0.5533, stage1_s: 0.5322, stage1_m: 0.3825, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.3116, grad_norm: 11.3792
2024-10-16 02:47:14,631 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:33:10, time: 0.656, data_time: 0.008, memory: 7803, stage0_loss_instance_mil: 0.1406, stage0_bag_acc: 88.9727, stage0_mean_ious: 0.4753, stage0_s: 0.4528, stage0_m: 0.3214, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0450, stage1_bag_acc: 90.2727, stage1_neg_loss: 0.0169, stage1_mean_ious: 0.5649, stage1_s: 0.5723, stage1_m: 0.3071, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2025, grad_norm: 7.0027
2024-10-16 02:47:33,295 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 02:48:19,666 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:31:19, time: 0.883, data_time: 0.057, memory: 7803, stage0_loss_instance_mil: 0.1211, stage0_bag_acc: 88.4141, stage0_mean_ious: 0.5008, stage0_s: 0.4693, stage0_m: 0.3412, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0413, stage1_bag_acc: 90.7465, stage1_neg_loss: 0.0103, stage1_mean_ious: 0.5955, stage1_s: 0.5854, stage1_m: 0.3502, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1726, grad_norm: 7.8513
2024-10-16 02:49:00,374 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:31:12, time: 0.814, data_time: 0.009, memory: 7803, stage0_loss_instance_mil: 0.0926, stage0_bag_acc: 92.5939, stage0_mean_ious: 0.4802, stage0_s: 0.4385, stage0_m: 0.2984, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0279, stage1_bag_acc: 93.0621, stage1_neg_loss: 0.0134, stage1_mean_ious: 0.5811, stage1_s: 0.5707, stage1_m: 0.3017, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1339, grad_norm: 6.8575
2024-10-16 02:49:44,453 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:31:12, time: 0.881, data_time: 0.010, memory: 7803, stage0_loss_instance_mil: 0.0591, stage0_bag_acc: 95.2515, stage0_mean_ious: 0.4748, stage0_s: 0.4057, stage0_m: 0.3858, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0243, stage1_bag_acc: 95.8348, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.5877, stage1_s: 0.5681, stage1_m: 0.3942, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0916, grad_norm: 5.1927
2024-10-16 02:50:26,157 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:30:59, time: 0.834, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1066, stage0_bag_acc: 92.2920, stage0_mean_ious: 0.4713, stage0_s: 0.4250, stage0_m: 0.3123, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0333, stage1_bag_acc: 92.9896, stage1_neg_loss: 0.0126, stage1_mean_ious: 0.5732, stage1_s: 0.5582, stage1_m: 0.2996, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.1525, grad_norm: 6.6921
2024-10-16 02:51:10,561 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:30:50, time: 0.888, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0867, stage0_bag_acc: 94.1167, stage0_mean_ious: 0.4743, stage0_s: 0.4193, stage0_m: 0.3915, stage0_l: 0.0364, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0229, stage1_bag_acc: 94.1167, stage1_neg_loss: 0.0091, stage1_mean_ious: 0.5737, stage1_s: 0.5600, stage1_m: 0.3869, stage1_l: 0.0348, stage1_h: 0.0000, loss: 0.1187, grad_norm: 5.4969
2024-10-16 02:51:35,679 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 02:52:52,556 - mmdet - INFO - Evaluating bbox...
2024-10-16 02:52:53,102 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2071
2024-10-16 02:52:53,102 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6656
2024-10-16 02:52:53,102 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3899
2024-10-16 02:52:53,102 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1369
2024-10-16 02:52:53,103 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0648
2024-10-16 02:52:53,103 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0254
2024-10-16 02:52:53,103 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-16 02:52:53,103 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:52:53,103 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2157
2024-10-16 02:52:53,103 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0915
2024-10-16 02:52:53,103 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3107
2024-10-16 02:52:53,103 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7655
2024-10-16 02:52:53,103 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3107
2024-10-16 02:52:53,104 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3107
2024-10-16 02:52:53,104 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 02:52:53,104 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3268
2024-10-16 02:52:53,104 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1150
2024-10-16 02:52:53,109 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 02:52:53,109 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2070, bbox_mAP_50: 0.6660, bbox_mAP_75: 0.3900, bbox_mAP_s: 0.1370, bbox_mAP_m: 0.0650, bbox_mAP_l: 0.0250, bbox_mAP_copypaste: 0.207 0.666 0.390 0.137 0.065 0.025
2024-10-16 02:53:38,515 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:29:17, time: 0.908, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0760, stage0_bag_acc: 94.4921, stage0_mean_ious: 0.4785, stage0_s: 0.4429, stage0_m: 0.3626, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0258, stage1_bag_acc: 93.6897, stage1_neg_loss: 0.0098, stage1_mean_ious: 0.5665, stage1_s: 0.5684, stage1_m: 0.3435, stage1_l: 0.0064, stage1_h: 0.0000, loss: 0.1117, grad_norm: 5.3360
2024-10-16 02:54:21,086 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:29:00, time: 0.851, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0986, stage0_bag_acc: 92.2278, stage0_mean_ious: 0.4965, stage0_s: 0.4357, stage0_m: 0.3625, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0256, stage1_bag_acc: 93.0254, stage1_neg_loss: 0.0090, stage1_mean_ious: 0.5842, stage1_s: 0.5603, stage1_m: 0.3634, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1331, grad_norm: 6.1717
2024-10-16 02:55:02,345 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:28:36, time: 0.825, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0570, stage0_bag_acc: 95.1929, stage0_mean_ious: 0.4701, stage0_s: 0.4127, stage0_m: 0.3066, stage0_l: 0.0109, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0243, stage1_bag_acc: 95.5786, stage1_neg_loss: 0.0138, stage1_mean_ious: 0.5734, stage1_s: 0.5315, stage1_m: 0.3037, stage1_l: 0.0059, stage1_h: 0.0000, loss: 0.0952, grad_norm: 4.5006
2024-10-16 02:55:45,338 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:28:15, time: 0.860, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0661, stage0_bag_acc: 94.3476, stage0_mean_ious: 0.4938, stage0_s: 0.4448, stage0_m: 0.4332, stage0_l: 0.0093, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0260, stage1_bag_acc: 93.5341, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.5667, stage1_s: 0.5530, stage1_m: 0.4242, stage1_l: 0.0069, stage1_h: 0.0000, loss: 0.1001, grad_norm: 5.0936
2024-10-16 02:56:26,728 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:27:49, time: 0.828, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0789, stage0_bag_acc: 94.5101, stage0_mean_ious: 0.4729, stage0_s: 0.4320, stage0_m: 0.3052, stage0_l: 0.0162, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0259, stage1_bag_acc: 94.5768, stage1_neg_loss: 0.0115, stage1_mean_ious: 0.5750, stage1_s: 0.5700, stage1_m: 0.2845, stage1_l: 0.0110, stage1_h: 0.0000, loss: 0.1162, grad_norm: 5.6925
2024-10-16 02:56:52,233 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 02:57:36,042 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:26:18, time: 0.832, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0438, stage0_bag_acc: 97.0944, stage0_mean_ious: 0.4657, stage0_s: 0.4440, stage0_m: 0.2757, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0218, stage1_bag_acc: 96.3111, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.5688, stage1_s: 0.5664, stage1_m: 0.2557, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0741, grad_norm: 3.9762
2024-10-16 02:58:20,484 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:25:56, time: 0.889, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0371, stage0_bag_acc: 97.4682, stage0_mean_ious: 0.5222, stage0_s: 0.4927, stage0_m: 0.4103, stage0_l: 0.0091, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0162, stage1_bag_acc: 97.7182, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.6147, stage1_s: 0.6043, stage1_m: 0.4150, stage1_l: 0.0050, stage1_h: 0.0000, loss: 0.0589, grad_norm: 3.6047
2024-10-16 02:59:04,294 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:25:32, time: 0.876, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0495, stage0_bag_acc: 96.2056, stage0_mean_ious: 0.4740, stage0_s: 0.4342, stage0_m: 0.3056, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0151, stage1_bag_acc: 96.8500, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5938, stage1_s: 0.5846, stage1_m: 0.3072, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0698, grad_norm: 4.0656
2024-10-16 02:59:47,183 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:25:05, time: 0.858, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0558, stage0_bag_acc: 96.6237, stage0_mean_ious: 0.4859, stage0_s: 0.4491, stage0_m: 0.2949, stage0_l: 0.0192, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0152, stage1_bag_acc: 97.6737, stage1_neg_loss: 0.0078, stage1_mean_ious: 0.5681, stage1_s: 0.5518, stage1_m: 0.2860, stage1_l: 0.0168, stage1_h: 0.0000, loss: 0.0788, grad_norm: 4.4660
2024-10-16 03:00:27,774 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:24:34, time: 0.812, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0480, stage0_bag_acc: 96.1667, stage0_mean_ious: 0.5008, stage0_s: 0.4560, stage0_m: 0.2908, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0179, stage1_bag_acc: 96.6167, stage1_neg_loss: 0.0088, stage1_mean_ious: 0.5914, stage1_s: 0.5745, stage1_m: 0.2982, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0747, grad_norm: 4.0293
2024-10-16 03:00:53,201 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 03:01:40,688 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:23:16, time: 0.906, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0228, stage0_bag_acc: 99.1182, stage0_mean_ious: 0.5070, stage0_s: 0.4273, stage0_m: 0.4103, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0139, stage1_bag_acc: 98.4158, stage1_neg_loss: 0.0064, stage1_mean_ious: 0.5753, stage1_s: 0.5463, stage1_m: 0.3854, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0431, grad_norm: 2.9987
2024-10-16 03:02:20,815 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:22:44, time: 0.803, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0323, stage0_bag_acc: 98.0952, stage0_mean_ious: 0.5037, stage0_s: 0.4629, stage0_m: 0.2568, stage0_l: 0.0091, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0159, stage1_bag_acc: 97.4762, stage1_neg_loss: 0.0110, stage1_mean_ious: 0.6026, stage1_s: 0.5959, stage1_m: 0.2358, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.0592, grad_norm: 3.9480
2024-10-16 03:02:53,633 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:03, time: 0.656, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0434, stage0_bag_acc: 96.8340, stage0_mean_ious: 0.4991, stage0_s: 0.4588, stage0_m: 0.3523, stage0_l: 0.0181, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0195, stage1_bag_acc: 98.0562, stage1_neg_loss: 0.0065, stage1_mean_ious: 0.5948, stage1_s: 0.5855, stage1_m: 0.3477, stage1_l: 0.0120, stage1_h: 0.0000, loss: 0.0694, grad_norm: 4.1348
2024-10-16 03:03:25,876 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:21:21, time: 0.645, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0523, stage0_bag_acc: 96.2532, stage0_mean_ious: 0.4849, stage0_s: 0.4190, stage0_m: 0.3461, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0217, stage1_bag_acc: 97.1230, stage1_neg_loss: 0.0077, stage1_mean_ious: 0.5804, stage1_s: 0.5586, stage1_m: 0.3090, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0816, grad_norm: 4.2966
2024-10-16 03:03:59,645 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:20:42, time: 0.675, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0547, stage0_bag_acc: 96.7643, stage0_mean_ious: 0.4944, stage0_s: 0.4721, stage0_m: 0.3141, stage0_l: 0.0359, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0174, stage1_bag_acc: 96.4786, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.6018, stage1_s: 0.6088, stage1_m: 0.3312, stage1_l: 0.0274, stage1_h: 0.0000, loss: 0.0789, grad_norm: 4.4015
2024-10-16 03:04:19,590 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 03:05:35,405 - mmdet - INFO - Evaluating bbox...
2024-10-16 03:05:35,953 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2116
2024-10-16 03:05:35,953 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6768
2024-10-16 03:05:35,954 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3941
2024-10-16 03:05:35,954 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1424
2024-10-16 03:05:35,954 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0671
2024-10-16 03:05:35,954 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0219
2024-10-16 03:05:35,954 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-10-16 03:05:35,954 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:05:35,954 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2213
2024-10-16 03:05:35,954 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0731
2024-10-16 03:05:35,955 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3150
2024-10-16 03:05:35,955 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7799
2024-10-16 03:05:35,955 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3150
2024-10-16 03:05:35,955 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3150
2024-10-16 03:05:35,955 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:05:35,955 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3320
2024-10-16 03:05:35,955 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1020
2024-10-16 03:05:35,960 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 03:05:35,960 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2120, bbox_mAP_50: 0.6770, bbox_mAP_75: 0.3940, bbox_mAP_s: 0.1420, bbox_mAP_m: 0.0670, bbox_mAP_l: 0.0220, bbox_mAP_copypaste: 0.212 0.677 0.394 0.142 0.067 0.022
2024-10-16 03:06:12,314 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:19:24, time: 0.727, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0576, stage0_bag_acc: 97.0119, stage0_mean_ious: 0.5209, stage0_s: 0.4979, stage0_m: 0.3467, stage0_l: 0.0240, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0134, stage1_bag_acc: 96.7262, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5970, stage1_s: 0.6058, stage1_m: 0.3351, stage1_l: 0.0216, stage1_h: 0.0000, loss: 0.0765, grad_norm: 3.8171
2024-10-16 03:06:54,227 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:18:53, time: 0.838, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0413, stage0_bag_acc: 96.5833, stage0_mean_ious: 0.4983, stage0_s: 0.4457, stage0_m: 0.3687, stage0_l: 0.0176, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0118, stage1_bag_acc: 97.9667, stage1_neg_loss: 0.0162, stage1_mean_ious: 0.5993, stage1_s: 0.5857, stage1_m: 0.3745, stage1_l: 0.0100, stage1_h: 0.0000, loss: 0.0692, grad_norm: 4.1339
2024-10-16 03:07:36,612 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:18:23, time: 0.848, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0355, stage0_bag_acc: 96.8737, stage0_mean_ious: 0.4819, stage0_s: 0.4479, stage0_m: 0.3005, stage0_l: 0.0200, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0129, stage1_bag_acc: 97.6293, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5736, stage1_s: 0.5682, stage1_m: 0.2823, stage1_l: 0.0116, stage1_h: 0.0000, loss: 0.0533, grad_norm: 3.1885
2024-10-16 03:08:18,780 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:17:52, time: 0.843, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0575, stage0_bag_acc: 95.6697, stage0_mean_ious: 0.4693, stage0_s: 0.4133, stage0_m: 0.2962, stage0_l: 0.0219, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0149, stage1_bag_acc: 95.5333, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5665, stage1_s: 0.5435, stage1_m: 0.3056, stage1_l: 0.0164, stage1_h: 0.0000, loss: 0.0781, grad_norm: 4.4889
2024-10-16 03:09:00,421 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:17:19, time: 0.833, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0356, stage0_bag_acc: 96.9333, stage0_mean_ious: 0.4826, stage0_s: 0.4535, stage0_m: 0.2723, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0134, stage1_bag_acc: 97.3833, stage1_neg_loss: 0.0077, stage1_mean_ious: 0.5734, stage1_s: 0.5708, stage1_m: 0.2490, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0567, grad_norm: 3.0476
2024-10-16 03:09:26,567 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 03:10:13,314 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:12, time: 0.892, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0327, stage0_bag_acc: 98.0278, stage0_mean_ious: 0.4947, stage0_s: 0.4631, stage0_m: 0.2736, stage0_l: 0.0499, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0103, stage1_bag_acc: 97.7960, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5859, stage1_s: 0.5756, stage1_m: 0.2721, stage1_l: 0.0425, stage1_h: 0.0000, loss: 0.0468, grad_norm: 2.9808
2024-10-16 03:10:55,055 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:15:40, time: 0.835, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0307, stage0_bag_acc: 98.2000, stage0_mean_ious: 0.4995, stage0_s: 0.4492, stage0_m: 0.3318, stage0_l: 0.0189, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0150, stage1_bag_acc: 97.9667, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.5901, stage1_s: 0.5811, stage1_m: 0.3165, stage1_l: 0.0124, stage1_h: 0.0000, loss: 0.0532, grad_norm: 3.0057
2024-10-16 03:11:36,848 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:07, time: 0.836, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0601, stage0_bag_acc: 94.4515, stage0_mean_ious: 0.5086, stage0_s: 0.4694, stage0_m: 0.3508, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0129, stage1_bag_acc: 95.7682, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.6052, stage1_s: 0.6068, stage1_m: 0.3365, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0765, grad_norm: 4.3618
2024-10-16 03:12:18,272 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:14:33, time: 0.828, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0497, stage0_bag_acc: 96.5000, stage0_mean_ious: 0.4882, stage0_s: 0.4681, stage0_m: 0.3060, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0208, stage1_bag_acc: 96.6500, stage1_neg_loss: 0.0078, stage1_mean_ious: 0.5937, stage1_s: 0.5818, stage1_m: 0.3271, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0783, grad_norm: 3.8576
2024-10-16 03:13:01,107 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:00, time: 0.857, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0441, stage0_bag_acc: 97.3643, stage0_mean_ious: 0.4850, stage0_s: 0.4209, stage0_m: 0.3688, stage0_l: 0.0218, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0138, stage1_bag_acc: 96.9143, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5569, stage1_s: 0.5333, stage1_m: 0.3473, stage1_l: 0.0173, stage1_h: 0.0000, loss: 0.0639, grad_norm: 3.9054
2024-10-16 03:13:24,993 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 03:14:14,525 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:12:57, time: 0.947, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0261, stage0_bag_acc: 97.9833, stage0_mean_ious: 0.5186, stage0_s: 0.4787, stage0_m: 0.3540, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0087, stage1_bag_acc: 98.1833, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.6002, stage1_s: 0.5996, stage1_m: 0.3394, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0400, grad_norm: 2.7732
2024-10-16 03:14:55,103 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:22, time: 0.812, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0288, stage0_bag_acc: 98.1643, stage0_mean_ious: 0.4743, stage0_s: 0.4403, stage0_m: 0.2933, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0131, stage1_bag_acc: 98.1667, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5848, stage1_s: 0.5714, stage1_m: 0.2973, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0508, grad_norm: 3.1040
2024-10-16 03:15:36,180 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:11:48, time: 0.822, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0345, stage0_bag_acc: 97.1000, stage0_mean_ious: 0.4871, stage0_s: 0.4484, stage0_m: 0.2726, stage0_l: 0.0067, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 97.0500, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.6049, stage1_s: 0.5829, stage1_m: 0.2870, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0469, grad_norm: 2.7342
2024-10-16 03:16:18,716 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:13, time: 0.851, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0213, stage0_bag_acc: 98.8167, stage0_mean_ious: 0.5039, stage0_s: 0.4802, stage0_m: 0.3310, stage0_l: 0.0382, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0073, stage1_bag_acc: 99.2167, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5976, stage1_s: 0.6108, stage1_m: 0.3390, stage1_l: 0.0243, stage1_h: 0.0000, loss: 0.0318, grad_norm: 2.1302
2024-10-16 03:16:59,570 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:38, time: 0.817, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0247, stage0_bag_acc: 98.0667, stage0_mean_ious: 0.4868, stage0_s: 0.4379, stage0_m: 0.3177, stage0_l: 0.0172, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 97.6667, stage1_neg_loss: 0.0098, stage1_mean_ious: 0.5742, stage1_s: 0.5485, stage1_m: 0.3039, stage1_l: 0.0177, stage1_h: 0.0000, loss: 0.0434, grad_norm: 2.5789
2024-10-16 03:17:26,069 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 03:18:42,714 - mmdet - INFO - Evaluating bbox...
2024-10-16 03:18:43,190 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2172
2024-10-16 03:18:43,191 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6753
2024-10-16 03:18:43,191 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4147
2024-10-16 03:18:43,191 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1458
2024-10-16 03:18:43,191 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0705
2024-10-16 03:18:43,191 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0232
2024-10-16 03:18:43,191 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0011
2024-10-16 03:18:43,191 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:18:43,191 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2259
2024-10-16 03:18:43,192 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0793
2024-10-16 03:18:43,192 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3233
2024-10-16 03:18:43,192 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7813
2024-10-16 03:18:43,192 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3233
2024-10-16 03:18:43,192 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3233
2024-10-16 03:18:43,192 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:18:43,192 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3404
2024-10-16 03:18:43,192 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0952
2024-10-16 03:18:43,198 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 03:18:43,198 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2170, bbox_mAP_50: 0.6750, bbox_mAP_75: 0.4150, bbox_mAP_s: 0.1460, bbox_mAP_m: 0.0710, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.217 0.675 0.415 0.146 0.071 0.023
2024-10-16 03:19:28,405 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:35, time: 0.904, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0381, stage0_bag_acc: 96.0833, stage0_mean_ious: 0.4849, stage0_s: 0.4444, stage0_m: 0.3414, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0097, stage1_bag_acc: 96.2667, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5840, stage1_s: 0.5773, stage1_m: 0.3407, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.0501, grad_norm: 3.3773
2024-10-16 03:20:12,799 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:01, time: 0.888, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0224, stage0_bag_acc: 98.1500, stage0_mean_ious: 0.4962, stage0_s: 0.4333, stage0_m: 0.3485, stage0_l: 0.0273, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0063, stage1_bag_acc: 98.3500, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5908, stage1_s: 0.5791, stage1_m: 0.3222, stage1_l: 0.0246, stage1_h: 0.0000, loss: 0.0308, grad_norm: 2.3404
2024-10-16 03:20:56,810 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:27, time: 0.880, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0236, stage0_bag_acc: 98.1682, stage0_mean_ious: 0.4941, stage0_s: 0.4327, stage0_m: 0.3666, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0090, stage1_bag_acc: 97.9682, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5827, stage1_s: 0.5502, stage1_m: 0.3771, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0371, grad_norm: 2.3249
2024-10-16 03:21:30,998 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:49, time: 0.684, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0082, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.4971, stage0_s: 0.4715, stage0_m: 0.3370, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5928, stage1_s: 0.5912, stage1_m: 0.3374, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0215, grad_norm: 1.6285
2024-10-16 03:22:03,312 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:12, time: 0.646, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0183, stage0_bag_acc: 98.5667, stage0_mean_ious: 0.5118, stage0_s: 0.4646, stage0_m: 0.3401, stage0_l: 0.0087, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0091, stage1_bag_acc: 98.5667, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.6022, stage1_s: 0.5734, stage1_m: 0.3492, stage1_l: 0.0047, stage1_h: 0.0000, loss: 0.0297, grad_norm: 1.9248
2024-10-16 03:22:22,542 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 03:22:59,831 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:09, time: 0.702, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0186, stage0_bag_acc: 98.5667, stage0_mean_ious: 0.4909, stage0_s: 0.4724, stage0_m: 0.2525, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0107, stage1_bag_acc: 98.6667, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5890, stage1_s: 0.5839, stage1_m: 0.2816, stage1_l: 0.0048, stage1_h: 0.0000, loss: 0.0323, grad_norm: 2.3504
2024-10-16 03:23:32,377 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:32, time: 0.651, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0257, stage0_bag_acc: 98.5944, stage0_mean_ious: 0.5001, stage0_s: 0.4854, stage0_m: 0.3183, stage0_l: 0.0126, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0113, stage1_bag_acc: 98.3944, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5903, stage1_s: 0.6025, stage1_m: 0.3121, stage1_l: 0.0127, stage1_h: 0.0000, loss: 0.0433, grad_norm: 2.6448
2024-10-16 03:24:04,380 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:04:55, time: 0.640, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0139, stage0_bag_acc: 98.9182, stage0_mean_ious: 0.4884, stage0_s: 0.4398, stage0_m: 0.3439, stage0_l: 0.0313, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0072, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5954, stage1_s: 0.5848, stage1_m: 0.3252, stage1_l: 0.0336, stage1_h: 0.0000, loss: 0.0232, grad_norm: 1.7295
2024-10-16 03:24:37,827 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 03:24:37,827 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:19, time: 0.669, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0074, stage0_bag_acc: 99.7500, stage0_mean_ious: 0.4924, stage0_s: 0.4328, stage0_m: 0.3666, stage0_l: 0.0153, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0043, stage1_bag_acc: 99.7500, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5794, stage1_s: 0.5569, stage1_m: 0.3583, stage1_l: 0.0117, stage1_h: 0.0000, loss: 0.0180, grad_norm: 1.6650
2024-10-16 03:25:10,834 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:43, time: 0.660, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0218, stage0_bag_acc: 98.4778, stage0_mean_ious: 0.5137, stage0_s: 0.4659, stage0_m: 0.3878, stage0_l: 0.0396, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0079, stage1_bag_acc: 98.2778, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5965, stage1_s: 0.5778, stage1_m: 0.3867, stage1_l: 0.0257, stage1_h: 0.0000, loss: 0.0344, grad_norm: 2.5053
2024-10-16 03:25:35,026 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 03:26:22,174 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:44, time: 0.899, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0117, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.4832, stage0_s: 0.4441, stage0_m: 0.3409, stage0_l: 0.0106, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0068, stage1_bag_acc: 99.4000, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5883, stage1_s: 0.5908, stage1_m: 0.3411, stage1_l: 0.0055, stage1_h: 0.0000, loss: 0.0206, grad_norm: 1.4492
2024-10-16 03:27:02,215 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:09, time: 0.801, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0221, stage0_bag_acc: 98.6611, stage0_mean_ious: 0.4935, stage0_s: 0.4605, stage0_m: 0.3517, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 98.4611, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5865, stage1_s: 0.5876, stage1_m: 0.3417, stage1_l: 0.0043, stage1_h: 0.0000, loss: 0.0340, grad_norm: 2.3309
2024-10-16 03:27:44,849 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:33, time: 0.853, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0100, stage0_bag_acc: 99.2667, stage0_mean_ious: 0.5182, stage0_s: 0.4824, stage0_m: 0.4290, stage0_l: 0.0178, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0047, stage1_bag_acc: 99.2667, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.6105, stage1_s: 0.6186, stage1_m: 0.4003, stage1_l: 0.0180, stage1_h: 0.0000, loss: 0.0183, grad_norm: 1.7826
2024-10-16 03:28:29,750 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:57, time: 0.898, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0085, stage0_bag_acc: 99.5000, stage0_mean_ious: 0.5190, stage0_s: 0.4863, stage0_m: 0.3330, stage0_l: 0.0202, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0033, stage1_bag_acc: 99.3000, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.6113, stage1_s: 0.6021, stage1_m: 0.3219, stage1_l: 0.0126, stage1_h: 0.0000, loss: 0.0144, grad_norm: 1.4962
2024-10-16 03:29:12,639 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:21, time: 0.858, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0185, stage0_bag_acc: 97.8667, stage0_mean_ious: 0.4834, stage0_s: 0.4339, stage0_m: 0.3312, stage0_l: 0.0140, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0083, stage1_bag_acc: 98.1500, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5777, stage1_s: 0.5543, stage1_m: 0.3288, stage1_l: 0.0127, stage1_h: 0.0000, loss: 0.0303, grad_norm: 2.5784
2024-10-16 03:29:38,475 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 03:30:55,600 - mmdet - INFO - Evaluating bbox...
2024-10-16 03:30:56,078 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2182
2024-10-16 03:30:56,078 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6821
2024-10-16 03:30:56,078 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4178
2024-10-16 03:30:56,079 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1475
2024-10-16 03:30:56,079 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0697
2024-10-16 03:30:56,079 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0228
2024-10-16 03:30:56,079 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0012
2024-10-16 03:30:56,079 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:30:56,079 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2270
2024-10-16 03:30:56,079 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0796
2024-10-16 03:30:56,079 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3240
2024-10-16 03:30:56,079 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7859
2024-10-16 03:30:56,079 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3240
2024-10-16 03:30:56,080 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3240
2024-10-16 03:30:56,080 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:30:56,080 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3412
2024-10-16 03:30:56,080 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0927
2024-10-16 03:30:56,085 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 03:30:56,085 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2180, bbox_mAP_50: 0.6820, bbox_mAP_75: 0.4180, bbox_mAP_s: 0.1480, bbox_mAP_m: 0.0700, bbox_mAP_l: 0.0230, bbox_mAP_copypaste: 0.218 0.682 0.418 0.148 0.070 0.023
2024-10-16 03:32:13,069 - mmdet - INFO - Evaluating bbox...
2024-10-16 03:32:13,621 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2182
2024-10-16 03:32:13,621 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6821
2024-10-16 03:32:13,622 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4178
2024-10-16 03:32:13,622 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1475
2024-10-16 03:32:13,622 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0697
2024-10-16 03:32:13,622 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0228
2024-10-16 03:32:13,622 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0012
2024-10-16 03:32:13,622 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:32:13,622 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2270
2024-10-16 03:32:13,622 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0796
2024-10-16 03:32:13,622 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3240
2024-10-16 03:32:13,622 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7859
2024-10-16 03:32:13,622 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3240
2024-10-16 03:32:13,623 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3240
2024-10-16 03:32:13,623 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:32:13,623 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3412
2024-10-16 03:32:13,623 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0927
2024-10-16 03:32:14,862 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+2fd3e4b
------------------------------------------------------------

2024-10-16 03:32:15,717 - mmdet - INFO - Distributed training: False
2024-10-16 03:32:16,558 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-16 03:32:17,470 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 03:32:17,470 - mmdet - INFO - Use load_from_local loader
2024-10-16 03:32:17,852 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 03:32:17,865 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 03:32:17,865 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 03:33:05,254 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:52:16, time: 0.948, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.7301, stage0_bag_acc: 14.7429, stage0_mean_ious: 0.0641, stage0_s: 0.0448, stage0_m: 0.0738, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1542, stage1_bag_acc: 15.0434, stage1_neg_loss: 0.0006, stage1_mean_ious: 0.0676, stage1_s: 0.0499, stage1_m: 0.0754, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8849, grad_norm: 5.8733
2024-10-16 03:33:46,053 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:47:54, time: 0.816, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.7082, stage0_bag_acc: 17.7534, stage0_mean_ious: 0.0875, stage0_s: 0.0727, stage0_m: 0.0694, stage0_l: 0.0012, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1618, stage1_bag_acc: 22.2517, stage1_neg_loss: 0.0009, stage1_mean_ious: 0.0905, stage1_s: 0.0745, stage1_m: 0.0726, stage1_l: 0.0016, stage1_h: 0.0000, loss: 0.8709, grad_norm: 5.6807
2024-10-16 03:34:29,412 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:46:54, time: 0.867, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.6936, stage0_bag_acc: 18.3227, stage0_mean_ious: 0.1186, stage0_s: 0.0989, stage0_m: 0.1037, stage0_l: 0.0145, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1548, stage1_bag_acc: 25.4357, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.1236, stage1_s: 0.1015, stage1_m: 0.1086, stage1_l: 0.0090, stage1_h: 0.0000, loss: 0.8523, grad_norm: 6.6345
2024-10-16 03:35:12,900 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:46:05, time: 0.870, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.6451, stage0_bag_acc: 32.9325, stage0_mean_ious: 0.1613, stage0_s: 0.1294, stage0_m: 0.1302, stage0_l: 0.0133, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1476, stage1_bag_acc: 28.5571, stage1_neg_loss: 0.0163, stage1_mean_ious: 0.1739, stage1_s: 0.1384, stage1_m: 0.1379, stage1_l: 0.0102, stage1_h: 0.0000, loss: 0.8090, grad_norm: 8.1525
2024-10-16 03:35:55,670 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:45:09, time: 0.855, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.6055, stage0_bag_acc: 34.0141, stage0_mean_ious: 0.1761, stage0_s: 0.1410, stage0_m: 0.1475, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1241, stage1_bag_acc: 42.7646, stage1_neg_loss: 0.0200, stage1_mean_ious: 0.2038, stage1_s: 0.1620, stage1_m: 0.1643, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.7495, grad_norm: 10.9098
2024-10-16 03:36:21,163 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 03:37:08,220 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:40:11, time: 0.897, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.4817, stage0_bag_acc: 48.0876, stage0_mean_ious: 0.3401, stage0_s: 0.2584, stage0_m: 0.3053, stage0_l: 0.0412, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1035, stage1_bag_acc: 51.7751, stage1_neg_loss: 0.0167, stage1_mean_ious: 0.3948, stage1_s: 0.3223, stage1_m: 0.3009, stage1_l: 0.0366, stage1_h: 0.0000, loss: 0.6019, grad_norm: 12.9023
2024-10-16 03:37:51,898 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:40:02, time: 0.874, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.4217, stage0_bag_acc: 57.2069, stage0_mean_ious: 0.3736, stage0_s: 0.3309, stage0_m: 0.3243, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0912, stage1_bag_acc: 55.6299, stage1_neg_loss: 0.0120, stage1_mean_ious: 0.4670, stage1_s: 0.4328, stage1_m: 0.3833, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5249, grad_norm: 14.0762
2024-10-16 03:38:35,482 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:39:44, time: 0.872, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.2882, stage0_bag_acc: 76.0121, stage0_mean_ious: 0.4256, stage0_s: 0.3698, stage0_m: 0.3327, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0824, stage1_bag_acc: 74.1177, stage1_neg_loss: 0.0166, stage1_mean_ious: 0.5276, stage1_s: 0.4942, stage1_m: 0.3874, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.3872, grad_norm: 11.4209
2024-10-16 03:39:18,713 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:39:18, time: 0.865, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1977, stage0_bag_acc: 84.5333, stage0_mean_ious: 0.4472, stage0_s: 0.3845, stage0_m: 0.3102, stage0_l: 0.0314, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0543, stage1_bag_acc: 86.1848, stage1_neg_loss: 0.0156, stage1_mean_ious: 0.5398, stage1_s: 0.5075, stage1_m: 0.3090, stage1_l: 0.0251, stage1_h: 0.0000, loss: 0.2675, grad_norm: 9.9249
2024-10-16 03:39:59,180 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:38:35, time: 0.809, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1979, stage0_bag_acc: 83.1482, stage0_mean_ious: 0.4540, stage0_s: 0.4142, stage0_m: 0.2874, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0466, stage1_bag_acc: 85.0491, stage1_neg_loss: 0.0152, stage1_mean_ious: 0.5811, stage1_s: 0.5614, stage1_m: 0.3128, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2597, grad_norm: 9.3307
2024-10-16 03:40:20,162 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 03:40:56,810 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:35:10, time: 0.688, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.1757, stage0_bag_acc: 85.8897, stage0_mean_ious: 0.4295, stage0_s: 0.3689, stage0_m: 0.3078, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0473, stage1_bag_acc: 86.2341, stage1_neg_loss: 0.0103, stage1_mean_ious: 0.5340, stage1_s: 0.4998, stage1_m: 0.3227, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2333, grad_norm: 9.3876
2024-10-16 03:41:30,036 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:34:10, time: 0.665, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1301, stage0_bag_acc: 89.0491, stage0_mean_ious: 0.4683, stage0_s: 0.4140, stage0_m: 0.3879, stage0_l: 0.0185, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0342, stage1_bag_acc: 89.2134, stage1_neg_loss: 0.0107, stage1_mean_ious: 0.5572, stage1_s: 0.5308, stage1_m: 0.3914, stage1_l: 0.0192, stage1_h: 0.0000, loss: 0.1751, grad_norm: 6.9383
2024-10-16 03:42:04,813 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:33:20, time: 0.696, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0613, stage0_bag_acc: 95.6810, stage0_mean_ious: 0.5041, stage0_s: 0.4525, stage0_m: 0.4068, stage0_l: 0.0181, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0259, stage1_bag_acc: 96.2643, stage1_neg_loss: 0.0103, stage1_mean_ious: 0.5930, stage1_s: 0.5822, stage1_m: 0.3763, stage1_l: 0.0123, stage1_h: 0.0000, loss: 0.0976, grad_norm: 4.2923
2024-10-16 03:42:38,843 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:32:30, time: 0.681, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0920, stage0_bag_acc: 93.4936, stage0_mean_ious: 0.4759, stage0_s: 0.4181, stage0_m: 0.3113, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0281, stage1_bag_acc: 92.9284, stage1_neg_loss: 0.0079, stage1_mean_ious: 0.5864, stage1_s: 0.5435, stage1_m: 0.3385, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1280, grad_norm: 5.4347
2024-10-16 03:43:12,189 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:31:39, time: 0.667, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1097, stage0_bag_acc: 89.8523, stage0_mean_ious: 0.4744, stage0_s: 0.4410, stage0_m: 0.3041, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0275, stage1_bag_acc: 90.8538, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.5893, stage1_s: 0.5772, stage1_m: 0.3067, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1455, grad_norm: 6.7215
2024-10-16 03:43:31,819 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 03:44:49,489 - mmdet - INFO - Evaluating bbox...
2024-10-16 03:44:49,971 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2087
2024-10-16 03:44:49,971 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6881
2024-10-16 03:44:49,972 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3935
2024-10-16 03:44:49,972 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1333
2024-10-16 03:44:49,972 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0627
2024-10-16 03:44:49,972 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0215
2024-10-16 03:44:49,972 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0002
2024-10-16 03:44:49,972 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:44:49,972 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2199
2024-10-16 03:44:49,972 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0648
2024-10-16 03:44:49,972 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3093
2024-10-16 03:44:49,972 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7863
2024-10-16 03:44:49,973 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3093
2024-10-16 03:44:49,973 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3093
2024-10-16 03:44:49,973 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:44:49,973 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3267
2024-10-16 03:44:49,973 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1052
2024-10-16 03:44:49,978 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 03:44:49,978 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2090, bbox_mAP_50: 0.6880, bbox_mAP_75: 0.3940, bbox_mAP_s: 0.1330, bbox_mAP_m: 0.0630, bbox_mAP_l: 0.0210, bbox_mAP_copypaste: 0.209 0.688 0.394 0.133 0.063 0.021
2024-10-16 03:45:33,917 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:29:56, time: 0.879, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0887, stage0_bag_acc: 91.9848, stage0_mean_ious: 0.4842, stage0_s: 0.4511, stage0_m: 0.3251, stage0_l: 0.0052, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0260, stage1_bag_acc: 93.4848, stage1_neg_loss: 0.0100, stage1_mean_ious: 0.5776, stage1_s: 0.5748, stage1_m: 0.3268, stage1_l: 0.0031, stage1_h: 0.0000, loss: 0.1247, grad_norm: 5.6691
2024-10-16 03:46:16,962 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:29:37, time: 0.861, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0722, stage0_bag_acc: 93.0619, stage0_mean_ious: 0.4595, stage0_s: 0.4356, stage0_m: 0.2575, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0224, stage1_bag_acc: 93.1952, stage1_neg_loss: 0.0116, stage1_mean_ious: 0.5807, stage1_s: 0.5721, stage1_m: 0.2670, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1061, grad_norm: 5.7955
2024-10-16 03:46:59,610 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:29:14, time: 0.853, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0911, stage0_bag_acc: 92.5968, stage0_mean_ious: 0.4608, stage0_s: 0.4387, stage0_m: 0.2915, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0283, stage1_bag_acc: 92.8659, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5694, stage1_s: 0.5620, stage1_m: 0.3060, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1247, grad_norm: 5.8780
2024-10-16 03:47:43,134 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:28:52, time: 0.870, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0674, stage0_bag_acc: 94.9333, stage0_mean_ious: 0.4674, stage0_s: 0.4255, stage0_m: 0.3666, stage0_l: 0.0145, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0234, stage1_bag_acc: 94.5000, stage1_neg_loss: 0.0101, stage1_mean_ious: 0.5777, stage1_s: 0.5617, stage1_m: 0.3776, stage1_l: 0.0128, stage1_h: 0.0000, loss: 0.1008, grad_norm: 5.0791
2024-10-16 03:48:25,059 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:28:24, time: 0.838, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0402, stage0_bag_acc: 96.9712, stage0_mean_ious: 0.5154, stage0_s: 0.4592, stage0_m: 0.3886, stage0_l: 0.0253, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 97.1212, stage1_neg_loss: 0.0145, stage1_mean_ious: 0.6008, stage1_s: 0.5879, stage1_m: 0.3785, stage1_l: 0.0254, stage1_h: 0.0000, loss: 0.0748, grad_norm: 4.9677
2024-10-16 03:48:50,256 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 03:49:36,747 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:26:54, time: 0.884, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0562, stage0_bag_acc: 96.5045, stage0_mean_ious: 0.4819, stage0_s: 0.4373, stage0_m: 0.3953, stage0_l: 0.0097, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0220, stage1_bag_acc: 96.1227, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5785, stage1_s: 0.5539, stage1_m: 0.3957, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.0833, grad_norm: 4.3853
2024-10-16 03:50:18,860 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:26:27, time: 0.842, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0391, stage0_bag_acc: 97.3808, stage0_mean_ious: 0.4888, stage0_s: 0.4562, stage0_m: 0.3265, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0165, stage1_bag_acc: 98.1848, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5617, stage1_s: 0.5609, stage1_m: 0.3215, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.0615, grad_norm: 3.9155
2024-10-16 03:51:02,135 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:26:00, time: 0.866, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0646, stage0_bag_acc: 94.8672, stage0_mean_ious: 0.4655, stage0_s: 0.4218, stage0_m: 0.3234, stage0_l: 0.0372, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0231, stage1_bag_acc: 93.7815, stage1_neg_loss: 0.0091, stage1_mean_ious: 0.5664, stage1_s: 0.5594, stage1_m: 0.3312, stage1_l: 0.0307, stage1_h: 0.0000, loss: 0.0968, grad_norm: 4.8394
2024-10-16 03:51:44,565 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:25:30, time: 0.848, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0690, stage0_bag_acc: 94.6944, stage0_mean_ious: 0.4881, stage0_s: 0.4188, stage0_m: 0.3036, stage0_l: 0.0144, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0161, stage1_bag_acc: 94.5611, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5803, stage1_s: 0.5305, stage1_m: 0.3121, stage1_l: 0.0154, stage1_h: 0.0000, loss: 0.0886, grad_norm: 4.5158
2024-10-16 03:52:25,570 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:24:58, time: 0.820, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0492, stage0_bag_acc: 97.0879, stage0_mean_ious: 0.4542, stage0_s: 0.4203, stage0_m: 0.3300, stage0_l: 0.0108, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0121, stage1_bag_acc: 96.2379, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5765, stage1_s: 0.5714, stage1_m: 0.3620, stage1_l: 0.0146, stage1_h: 0.0000, loss: 0.0687, grad_norm: 4.3125
2024-10-16 03:52:51,249 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 03:53:38,333 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:23:37, time: 0.898, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0499, stage0_bag_acc: 95.7460, stage0_mean_ious: 0.4638, stage0_s: 0.4208, stage0_m: 0.3187, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0160, stage1_bag_acc: 95.3714, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5650, stage1_s: 0.5460, stage1_m: 0.3358, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0727, grad_norm: 4.4824
2024-10-16 03:54:18,689 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:23:04, time: 0.807, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0396, stage0_bag_acc: 96.1864, stage0_mean_ious: 0.4696, stage0_s: 0.4248, stage0_m: 0.2981, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0192, stage1_bag_acc: 96.8364, stage1_neg_loss: 0.0152, stage1_mean_ious: 0.5774, stage1_s: 0.5589, stage1_m: 0.2895, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0740, grad_norm: 4.5379
2024-10-16 03:54:59,751 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:31, time: 0.821, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0377, stage0_bag_acc: 97.8500, stage0_mean_ious: 0.4903, stage0_s: 0.4557, stage0_m: 0.3180, stage0_l: 0.0163, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0132, stage1_bag_acc: 98.1000, stage1_neg_loss: 0.0077, stage1_mean_ious: 0.5784, stage1_s: 0.5784, stage1_m: 0.3077, stage1_l: 0.0142, stage1_h: 0.0000, loss: 0.0586, grad_norm: 3.5997
2024-10-16 03:55:42,303 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:22:00, time: 0.851, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0314, stage0_bag_acc: 97.3310, stage0_mean_ious: 0.5028, stage0_s: 0.4383, stage0_m: 0.3760, stage0_l: 0.0060, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0105, stage1_bag_acc: 97.0833, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5876, stage1_s: 0.5681, stage1_m: 0.3621, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.0459, grad_norm: 3.3672
2024-10-16 03:56:25,562 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:28, time: 0.865, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0325, stage0_bag_acc: 98.2778, stage0_mean_ious: 0.4869, stage0_s: 0.4455, stage0_m: 0.3261, stage0_l: 0.0209, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0157, stage1_bag_acc: 97.9626, stage1_neg_loss: 0.0091, stage1_mean_ious: 0.5921, stage1_s: 0.5811, stage1_m: 0.3327, stage1_l: 0.0163, stage1_h: 0.0000, loss: 0.0574, grad_norm: 4.1097
2024-10-16 03:56:51,629 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 03:58:09,941 - mmdet - INFO - Evaluating bbox...
2024-10-16 03:58:10,530 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2136
2024-10-16 03:58:10,530 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6909
2024-10-16 03:58:10,530 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4186
2024-10-16 03:58:10,530 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1321
2024-10-16 03:58:10,530 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0574
2024-10-16 03:58:10,530 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0188
2024-10-16 03:58:10,530 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-16 03:58:10,530 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:58:10,531 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2235
2024-10-16 03:58:10,531 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0695
2024-10-16 03:58:10,531 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3185
2024-10-16 03:58:10,531 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7966
2024-10-16 03:58:10,531 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3185
2024-10-16 03:58:10,531 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3185
2024-10-16 03:58:10,531 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 03:58:10,531 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3352
2024-10-16 03:58:10,531 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1125
2024-10-16 03:58:10,537 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 03:58:10,537 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2140, bbox_mAP_50: 0.6910, bbox_mAP_75: 0.4190, bbox_mAP_s: 0.1320, bbox_mAP_m: 0.0570, bbox_mAP_l: 0.0190, bbox_mAP_copypaste: 0.214 0.691 0.419 0.132 0.057 0.019
2024-10-16 03:58:54,878 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:20:13, time: 0.887, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0558, stage0_bag_acc: 95.6516, stage0_mean_ious: 0.4759, stage0_s: 0.4512, stage0_m: 0.3055, stage0_l: 0.0314, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0151, stage1_bag_acc: 96.4952, stage1_neg_loss: 0.0078, stage1_mean_ious: 0.5601, stage1_s: 0.5588, stage1_m: 0.3082, stage1_l: 0.0201, stage1_h: 0.0000, loss: 0.0788, grad_norm: 4.1935
2024-10-16 03:59:28,600 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:19:33, time: 0.674, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0199, stage0_bag_acc: 98.5119, stage0_mean_ious: 0.4770, stage0_s: 0.4128, stage0_m: 0.3681, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0184, stage1_bag_acc: 98.9310, stage1_neg_loss: 0.0096, stage1_mean_ious: 0.5907, stage1_s: 0.5551, stage1_m: 0.3827, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0479, grad_norm: 3.4425
2024-10-16 04:00:01,547 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:18:52, time: 0.659, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0250, stage0_bag_acc: 98.9000, stage0_mean_ious: 0.4895, stage0_s: 0.4611, stage0_m: 0.3065, stage0_l: 0.0370, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0171, stage1_bag_acc: 97.5182, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5695, stage1_s: 0.5676, stage1_m: 0.3072, stage1_l: 0.0390, stage1_h: 0.0000, loss: 0.0476, grad_norm: 3.6115
2024-10-16 04:00:34,073 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:11, time: 0.651, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0550, stage0_bag_acc: 96.3944, stage0_mean_ious: 0.4815, stage0_s: 0.4297, stage0_m: 0.2924, stage0_l: 0.0077, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0277, stage1_bag_acc: 96.0944, stage1_neg_loss: 0.0144, stage1_mean_ious: 0.5774, stage1_s: 0.5480, stage1_m: 0.3169, stage1_l: 0.0075, stage1_h: 0.0000, loss: 0.0971, grad_norm: 5.1345
2024-10-16 04:01:07,879 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:17:32, time: 0.676, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0389, stage0_bag_acc: 96.5833, stage0_mean_ious: 0.4960, stage0_s: 0.4490, stage0_m: 0.3383, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0133, stage1_bag_acc: 95.9667, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5810, stage1_s: 0.5537, stage1_m: 0.3383, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0560, grad_norm: 3.0959
2024-10-16 04:01:26,375 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 04:02:05,639 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:19, time: 0.742, data_time: 0.056, memory: 7817, stage0_loss_instance_mil: 0.0302, stage0_bag_acc: 98.3500, stage0_mean_ious: 0.4786, stage0_s: 0.4104, stage0_m: 0.3289, stage0_l: 0.0235, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0094, stage1_bag_acc: 97.4864, stage1_neg_loss: 0.0024, stage1_mean_ious: 0.5799, stage1_s: 0.5427, stage1_m: 0.3325, stage1_l: 0.0184, stage1_h: 0.0000, loss: 0.0420, grad_norm: 2.2151
2024-10-16 04:02:37,774 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:15:40, time: 0.643, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0330, stage0_bag_acc: 97.5102, stage0_mean_ious: 0.4799, stage0_s: 0.4441, stage0_m: 0.3278, stage0_l: 0.0138, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0098, stage1_bag_acc: 97.7149, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5633, stage1_s: 0.5515, stage1_m: 0.3063, stage1_l: 0.0120, stage1_h: 0.0000, loss: 0.0460, grad_norm: 2.5270
2024-10-16 04:03:13,639 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:04, time: 0.717, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0409, stage0_bag_acc: 98.0500, stage0_mean_ious: 0.4662, stage0_s: 0.4375, stage0_m: 0.2753, stage0_l: 0.0254, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0107, stage1_bag_acc: 98.0278, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5669, stage1_s: 0.5681, stage1_m: 0.2794, stage1_l: 0.0229, stage1_h: 0.0000, loss: 0.0567, grad_norm: 3.0032
2024-10-16 04:03:56,534 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:14:31, time: 0.858, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0237, stage0_bag_acc: 98.5737, stage0_mean_ious: 0.4992, stage0_s: 0.4678, stage0_m: 0.3347, stage0_l: 0.0187, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0123, stage1_bag_acc: 97.7601, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5870, stage1_s: 0.5662, stage1_m: 0.3618, stage1_l: 0.0097, stage1_h: 0.0000, loss: 0.0397, grad_norm: 2.7945
2024-10-16 04:04:40,796 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:13:59, time: 0.885, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0414, stage0_bag_acc: 97.1810, stage0_mean_ious: 0.5083, stage0_s: 0.4654, stage0_m: 0.4155, stage0_l: 0.0091, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0108, stage1_bag_acc: 97.3810, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5871, stage1_s: 0.5766, stage1_m: 0.4051, stage1_l: 0.0047, stage1_h: 0.0000, loss: 0.0556, grad_norm: 3.1329
2024-10-16 04:05:04,884 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 04:05:51,464 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:12:54, time: 0.888, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0268, stage0_bag_acc: 97.5960, stage0_mean_ious: 0.4608, stage0_s: 0.4231, stage0_m: 0.2649, stage0_l: 0.0157, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0166, stage1_bag_acc: 97.8682, stage1_neg_loss: 0.0008, stage1_mean_ious: 0.5539, stage1_s: 0.5340, stage1_m: 0.2747, stage1_l: 0.0136, stage1_h: 0.0000, loss: 0.0442, grad_norm: 2.4646
2024-10-16 04:06:35,287 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:21, time: 0.876, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0144, stage0_bag_acc: 98.9167, stage0_mean_ious: 0.5003, stage0_s: 0.4583, stage0_m: 0.3400, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0069, stage1_bag_acc: 99.0500, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5925, stage1_s: 0.5861, stage1_m: 0.3292, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0238, grad_norm: 1.8492
2024-10-16 04:07:19,604 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:11:48, time: 0.886, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0197, stage0_bag_acc: 98.5500, stage0_mean_ious: 0.4911, stage0_s: 0.4007, stage0_m: 0.3430, stage0_l: 0.0240, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 98.1000, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5811, stage1_s: 0.5341, stage1_m: 0.3519, stage1_l: 0.0234, stage1_h: 0.0000, loss: 0.0312, grad_norm: 2.0560
2024-10-16 04:08:00,828 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:13, time: 0.824, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0182, stage0_bag_acc: 98.6545, stage0_mean_ious: 0.4582, stage0_s: 0.4323, stage0_m: 0.2761, stage0_l: 0.0165, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 98.5006, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5679, stage1_s: 0.5626, stage1_m: 0.2834, stage1_l: 0.0157, stage1_h: 0.0000, loss: 0.0288, grad_norm: 2.0461
2024-10-16 04:08:44,115 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:39, time: 0.866, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0227, stage0_bag_acc: 98.8500, stage0_mean_ious: 0.5042, stage0_s: 0.4813, stage0_m: 0.3246, stage0_l: 0.0178, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0063, stage1_bag_acc: 98.4500, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5819, stage1_s: 0.5839, stage1_m: 0.3214, stage1_l: 0.0202, stage1_h: 0.0000, loss: 0.0318, grad_norm: 2.1115
2024-10-16 04:09:09,348 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 04:10:27,399 - mmdet - INFO - Evaluating bbox...
2024-10-16 04:10:27,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2011
2024-10-16 04:10:27,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6713
2024-10-16 04:10:27,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3713
2024-10-16 04:10:27,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1177
2024-10-16 04:10:27,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0552
2024-10-16 04:10:27,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0166
2024-10-16 04:10:27,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-16 04:10:27,878 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 04:10:27,879 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2098
2024-10-16 04:10:27,879 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0631
2024-10-16 04:10:27,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3100
2024-10-16 04:10:27,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7861
2024-10-16 04:10:27,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3100
2024-10-16 04:10:27,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3100
2024-10-16 04:10:27,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 04:10:27,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3255
2024-10-16 04:10:27,879 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1059
2024-10-16 04:10:27,885 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 04:10:27,885 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2010, bbox_mAP_50: 0.6710, bbox_mAP_75: 0.3710, bbox_mAP_s: 0.1180, bbox_mAP_m: 0.0550, bbox_mAP_l: 0.0170, bbox_mAP_copypaste: 0.201 0.671 0.371 0.118 0.055 0.017
2024-10-16 04:11:12,757 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:36, time: 0.897, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0128, stage0_bag_acc: 99.3000, stage0_mean_ious: 0.5262, stage0_s: 0.4907, stage0_m: 0.4164, stage0_l: 0.0292, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0061, stage1_bag_acc: 99.3000, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.5919, stage1_s: 0.5944, stage1_m: 0.3843, stage1_l: 0.0317, stage1_h: 0.0000, loss: 0.0206, grad_norm: 1.5477
2024-10-16 04:11:52,064 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:00, time: 0.786, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0264, stage0_bag_acc: 98.1682, stage0_mean_ious: 0.4686, stage0_s: 0.4408, stage0_m: 0.2525, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 98.8000, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5635, stage1_s: 0.5537, stage1_m: 0.2497, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0397, grad_norm: 2.2514
2024-10-16 04:12:34,887 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:25, time: 0.856, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0215, stage0_bag_acc: 98.0500, stage0_mean_ious: 0.4844, stage0_s: 0.4442, stage0_m: 0.3070, stage0_l: 0.0262, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 98.2500, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5810, stage1_s: 0.5609, stage1_m: 0.3023, stage1_l: 0.0228, stage1_h: 0.0000, loss: 0.0309, grad_norm: 1.8812
2024-10-16 04:13:17,554 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:50, time: 0.853, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0195, stage0_bag_acc: 98.2182, stage0_mean_ious: 0.4656, stage0_s: 0.4338, stage0_m: 0.3549, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 98.7293, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5714, stage1_s: 0.5606, stage1_m: 0.3826, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0312, grad_norm: 1.9418
2024-10-16 04:14:02,138 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:15, time: 0.892, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0172, stage0_bag_acc: 98.2000, stage0_mean_ious: 0.4905, stage0_s: 0.4383, stage0_m: 0.3766, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.1500, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5964, stage1_s: 0.5675, stage1_m: 0.3973, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0261, grad_norm: 2.0942
2024-10-16 04:14:28,250 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 04:15:15,959 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:13, time: 0.910, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0189, stage0_bag_acc: 98.4643, stage0_mean_ious: 0.5007, stage0_s: 0.4591, stage0_m: 0.3689, stage0_l: 0.0304, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 97.7643, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5793, stage1_s: 0.5649, stage1_m: 0.3474, stage1_l: 0.0312, stage1_h: 0.0000, loss: 0.0289, grad_norm: 1.9736
2024-10-16 04:15:58,925 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:38, time: 0.859, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0130, stage0_bag_acc: 99.4000, stage0_mean_ious: 0.4965, stage0_s: 0.4535, stage0_m: 0.3909, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0051, stage1_bag_acc: 99.4182, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5870, stage1_s: 0.5685, stage1_m: 0.4250, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0219, grad_norm: 1.4565
2024-10-16 04:16:43,276 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:02, time: 0.887, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0338, stage0_bag_acc: 97.6682, stage0_mean_ious: 0.4538, stage0_s: 0.4359, stage0_m: 0.3006, stage0_l: 0.0167, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 97.3825, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5674, stage1_s: 0.5548, stage1_m: 0.3382, stage1_l: 0.0139, stage1_h: 0.0000, loss: 0.0476, grad_norm: 3.0055
2024-10-16 04:17:23,728 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 04:17:23,728 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:26, time: 0.809, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0142, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.4865, stage0_s: 0.4561, stage0_m: 0.2321, stage0_l: 0.0144, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0069, stage1_mean_ious: 0.5642, stage1_s: 0.5550, stage1_m: 0.2162, stage1_l: 0.0117, stage1_h: 0.0000, loss: 0.0292, grad_norm: 1.9689
2024-10-16 04:18:01,778 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:49, time: 0.761, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0165, stage0_bag_acc: 98.7278, stage0_mean_ious: 0.4969, stage0_s: 0.4621, stage0_m: 0.3523, stage0_l: 0.0072, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0056, stage1_bag_acc: 98.7000, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5863, stage1_s: 0.5780, stage1_m: 0.3694, stage1_l: 0.0073, stage1_h: 0.0000, loss: 0.0252, grad_norm: 1.7818
2024-10-16 04:18:22,436 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 04:19:00,160 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:48, time: 0.710, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0222, stage0_bag_acc: 98.6825, stage0_mean_ious: 0.5050, stage0_s: 0.4861, stage0_m: 0.3551, stage0_l: 0.0150, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 98.8167, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5801, stage1_s: 0.5770, stage1_m: 0.3430, stage1_l: 0.0162, stage1_h: 0.0000, loss: 0.0327, grad_norm: 1.8090
2024-10-16 04:19:32,097 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:11, time: 0.639, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0155, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.4935, stage0_s: 0.4573, stage0_m: 0.2637, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 99.2667, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5946, stage1_s: 0.5737, stage1_m: 0.2647, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0270, grad_norm: 1.8575
2024-10-16 04:20:05,326 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:34, time: 0.664, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0090, stage0_bag_acc: 99.6667, stage0_mean_ious: 0.4838, stage0_s: 0.4400, stage0_m: 0.3217, stage0_l: 0.0170, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0040, stage1_bag_acc: 99.7500, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5694, stage1_s: 0.5502, stage1_m: 0.3203, stage1_l: 0.0116, stage1_h: 0.0000, loss: 0.0167, grad_norm: 1.4819
2024-10-16 04:20:37,264 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:58, time: 0.639, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0117, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.4855, stage0_s: 0.4661, stage0_m: 0.3289, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0060, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5697, stage1_s: 0.5767, stage1_m: 0.3274, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0212, grad_norm: 1.8813
2024-10-16 04:21:10,779 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:21, time: 0.670, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0135, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.4781, stage0_s: 0.4552, stage0_m: 0.2771, stage0_l: 0.0072, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0058, stage1_bag_acc: 99.4000, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5822, stage1_s: 0.5734, stage1_m: 0.2952, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.0225, grad_norm: 1.7843
2024-10-16 04:21:29,891 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 04:22:47,976 - mmdet - INFO - Evaluating bbox...
2024-10-16 04:22:48,453 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1996
2024-10-16 04:22:48,453 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6651
2024-10-16 04:22:48,453 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3714
2024-10-16 04:22:48,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1180
2024-10-16 04:22:48,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0534
2024-10-16 04:22:48,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0170
2024-10-16 04:22:48,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-16 04:22:48,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 04:22:48,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2085
2024-10-16 04:22:48,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0604
2024-10-16 04:22:48,454 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3088
2024-10-16 04:22:48,454 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7799
2024-10-16 04:22:48,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3088
2024-10-16 04:22:48,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3088
2024-10-16 04:22:48,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 04:22:48,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3248
2024-10-16 04:22:48,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1000
2024-10-16 04:22:48,461 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 04:22:48,461 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2000, bbox_mAP_50: 0.6650, bbox_mAP_75: 0.3710, bbox_mAP_s: 0.1180, bbox_mAP_m: 0.0530, bbox_mAP_l: 0.0170, bbox_mAP_copypaste: 0.200 0.665 0.371 0.118 0.053 0.017
2024-10-16 04:24:05,768 - mmdet - INFO - Evaluating bbox...
2024-10-16 04:24:06,317 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1996
2024-10-16 04:24:06,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6651
2024-10-16 04:24:06,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3714
2024-10-16 04:24:06,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1180
2024-10-16 04:24:06,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0534
2024-10-16 04:24:06,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0170
2024-10-16 04:24:06,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-16 04:24:06,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 04:24:06,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2085
2024-10-16 04:24:06,318 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0604
2024-10-16 04:24:06,319 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3088
2024-10-16 04:24:06,319 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7799
2024-10-16 04:24:06,319 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3088
2024-10-16 04:24:06,319 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3088
2024-10-16 04:24:06,319 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 04:24:06,319 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3248
2024-10-16 04:24:06,319 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1000
2024-10-16 04:24:07,525 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+2fd3e4b
------------------------------------------------------------

2024-10-16 04:24:08,375 - mmdet - INFO - Distributed training: False
2024-10-16 04:24:09,221 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-16 04:24:10,142 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 04:24:10,143 - mmdet - INFO - Use load_from_local loader
2024-10-16 04:24:10,463 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 04:24:10,476 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 04:24:10,476 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 04:24:54,067 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:48:05, time: 0.872, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.7169, stage0_bag_acc: 12.6773, stage0_mean_ious: 0.0474, stage0_s: 0.0375, stage0_m: 0.0450, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1621, stage1_bag_acc: 20.6091, stage1_neg_loss: 0.0009, stage1_mean_ious: 0.0455, stage1_s: 0.0350, stage1_m: 0.0473, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8799, grad_norm: 5.6233
2024-10-16 04:25:37,078 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:47:02, time: 0.860, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.7154, stage0_bag_acc: 12.2374, stage0_mean_ious: 0.0520, stage0_s: 0.0412, stage0_m: 0.0414, stage0_l: 0.0008, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1586, stage1_bag_acc: 15.7532, stage1_neg_loss: 0.0011, stage1_mean_ious: 0.0530, stage1_s: 0.0421, stage1_m: 0.0453, stage1_l: 0.0009, stage1_h: 0.0000, loss: 0.8751, grad_norm: 6.0084
2024-10-16 04:26:19,859 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:46:08, time: 0.856, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.6932, stage0_bag_acc: 17.8457, stage0_mean_ious: 0.0697, stage0_s: 0.0666, stage0_m: 0.0595, stage0_l: 0.0131, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1560, stage1_bag_acc: 17.6512, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.0749, stage1_s: 0.0677, stage1_m: 0.0672, stage1_l: 0.0151, stage1_h: 0.0000, loss: 0.8521, grad_norm: 6.6478
2024-10-16 04:27:01,522 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:45:02, time: 0.833, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.6772, stage0_bag_acc: 16.2844, stage0_mean_ious: 0.0885, stage0_s: 0.0880, stage0_m: 0.0539, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1345, stage1_bag_acc: 30.0312, stage1_neg_loss: 0.0122, stage1_mean_ious: 0.0929, stage1_s: 0.0929, stage1_m: 0.0537, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8239, grad_norm: 9.6398
2024-10-16 04:27:42,574 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:43:58, time: 0.821, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.6533, stage0_bag_acc: 21.4071, stage0_mean_ious: 0.1281, stage0_s: 0.1212, stage0_m: 0.1147, stage0_l: 0.0097, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1332, stage1_bag_acc: 37.5619, stage1_neg_loss: 0.0174, stage1_mean_ious: 0.1232, stage1_s: 0.1166, stage1_m: 0.1100, stage1_l: 0.0075, stage1_h: 0.0000, loss: 0.8039, grad_norm: 9.5131
2024-10-16 04:28:07,702 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 04:28:54,616 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:39:17, time: 0.893, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.5477, stage0_bag_acc: 38.7278, stage0_mean_ious: 0.3062, stage0_s: 0.2276, stage0_m: 0.2397, stage0_l: 0.0341, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1001, stage1_bag_acc: 45.3542, stage1_neg_loss: 0.0222, stage1_mean_ious: 0.3358, stage1_s: 0.2714, stage1_m: 0.2543, stage1_l: 0.0316, stage1_h: 0.0000, loss: 0.6701, grad_norm: 10.7909
2024-10-16 04:29:37,035 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:39:06, time: 0.848, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.4639, stage0_bag_acc: 49.1396, stage0_mean_ious: 0.3300, stage0_s: 0.2652, stage0_m: 0.2666, stage0_l: 0.0300, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0945, stage1_bag_acc: 51.1872, stage1_neg_loss: 0.0202, stage1_mean_ious: 0.4086, stage1_s: 0.3635, stage1_m: 0.2783, stage1_l: 0.0212, stage1_h: 0.0000, loss: 0.5787, grad_norm: 12.0383
2024-10-16 04:30:19,808 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:38:49, time: 0.855, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.4369, stage0_bag_acc: 57.1365, stage0_mean_ious: 0.3494, stage0_s: 0.3001, stage0_m: 0.2734, stage0_l: 0.0101, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0983, stage1_bag_acc: 59.7152, stage1_neg_loss: 0.0204, stage1_mean_ious: 0.4266, stage1_s: 0.3893, stage1_m: 0.3034, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.5556, grad_norm: 13.5669
2024-10-16 04:31:00,111 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:38:13, time: 0.806, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.3321, stage0_bag_acc: 69.1786, stage0_mean_ious: 0.3927, stage0_s: 0.3461, stage0_m: 0.2865, stage0_l: 0.0230, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0828, stage1_bag_acc: 70.7698, stage1_neg_loss: 0.0254, stage1_mean_ious: 0.4658, stage1_s: 0.4416, stage1_m: 0.2887, stage1_l: 0.0127, stage1_h: 0.0000, loss: 0.4403, grad_norm: 12.1762
2024-10-16 04:31:40,994 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:37:39, time: 0.818, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.2577, stage0_bag_acc: 77.7162, stage0_mean_ious: 0.4278, stage0_s: 0.3714, stage0_m: 0.2907, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0704, stage1_bag_acc: 76.5273, stage1_neg_loss: 0.0153, stage1_mean_ious: 0.4995, stage1_s: 0.4700, stage1_m: 0.2739, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.3434, grad_norm: 11.9162
2024-10-16 04:32:06,179 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 04:32:51,789 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:35:02, time: 0.867, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.1308, stage0_bag_acc: 88.6008, stage0_mean_ious: 0.4824, stage0_s: 0.4328, stage0_m: 0.3103, stage0_l: 0.0241, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0503, stage1_bag_acc: 88.8675, stage1_neg_loss: 0.0176, stage1_mean_ious: 0.5420, stage1_s: 0.5288, stage1_m: 0.2766, stage1_l: 0.0148, stage1_h: 0.0000, loss: 0.1986, grad_norm: 7.4132
2024-10-16 04:33:33,820 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:34:40, time: 0.841, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1233, stage0_bag_acc: 89.3989, stage0_mean_ious: 0.4447, stage0_s: 0.4066, stage0_m: 0.2355, stage0_l: 0.0072, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0368, stage1_bag_acc: 89.3474, stage1_neg_loss: 0.0140, stage1_mean_ious: 0.5619, stage1_s: 0.5483, stage1_m: 0.2535, stage1_l: 0.0045, stage1_h: 0.0000, loss: 0.1741, grad_norm: 7.1043
2024-10-16 04:34:16,679 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:34:17, time: 0.857, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.1479, stage0_bag_acc: 89.8409, stage0_mean_ious: 0.4737, stage0_s: 0.4004, stage0_m: 0.3170, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0371, stage1_bag_acc: 90.0061, stage1_neg_loss: 0.0094, stage1_mean_ious: 0.5827, stage1_s: 0.5356, stage1_m: 0.3150, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1944, grad_norm: 7.7236
2024-10-16 04:35:00,049 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:33:54, time: 0.867, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.1057, stage0_bag_acc: 91.0921, stage0_mean_ious: 0.4622, stage0_s: 0.4180, stage0_m: 0.3503, stage0_l: 0.0124, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0370, stage1_bag_acc: 92.6754, stage1_neg_loss: 0.0133, stage1_mean_ious: 0.5545, stage1_s: 0.5318, stage1_m: 0.3706, stage1_l: 0.0082, stage1_h: 0.0000, loss: 0.1560, grad_norm: 6.1189
2024-10-16 04:35:42,243 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:33:25, time: 0.844, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0955, stage0_bag_acc: 91.5833, stage0_mean_ious: 0.4650, stage0_s: 0.4167, stage0_m: 0.3690, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0311, stage1_bag_acc: 92.3833, stage1_neg_loss: 0.0121, stage1_mean_ious: 0.5714, stage1_s: 0.5573, stage1_m: 0.3630, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.1388, grad_norm: 5.8493
2024-10-16 04:36:08,157 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 04:37:24,623 - mmdet - INFO - Evaluating bbox...
2024-10-16 04:37:25,170 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1936
2024-10-16 04:37:25,170 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6369
2024-10-16 04:37:25,170 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3529
2024-10-16 04:37:25,170 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1235
2024-10-16 04:37:25,170 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0592
2024-10-16 04:37:25,170 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0221
2024-10-16 04:37:25,171 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-16 04:37:25,171 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 04:37:25,171 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2036
2024-10-16 04:37:25,171 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0725
2024-10-16 04:37:25,171 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3024
2024-10-16 04:37:25,171 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7474
2024-10-16 04:37:25,171 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3024
2024-10-16 04:37:25,171 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3024
2024-10-16 04:37:25,171 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 04:37:25,171 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3208
2024-10-16 04:37:25,171 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0818
2024-10-16 04:37:25,177 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 04:37:25,177 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.1940, bbox_mAP_50: 0.6370, bbox_mAP_75: 0.3530, bbox_mAP_s: 0.1240, bbox_mAP_m: 0.0590, bbox_mAP_l: 0.0220, bbox_mAP_copypaste: 0.194 0.637 0.353 0.124 0.059 0.022
2024-10-16 04:38:01,918 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:31:09, time: 0.735, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.1080, stage0_bag_acc: 90.5315, stage0_mean_ious: 0.4938, stage0_s: 0.4600, stage0_m: 0.3788, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0285, stage1_bag_acc: 91.4038, stage1_neg_loss: 0.0127, stage1_mean_ious: 0.5966, stage1_s: 0.5847, stage1_m: 0.4002, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1492, grad_norm: 6.5838
2024-10-16 04:38:34,881 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:30:19, time: 0.659, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0816, stage0_bag_acc: 92.7063, stage0_mean_ious: 0.4706, stage0_s: 0.4297, stage0_m: 0.3120, stage0_l: 0.0099, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0219, stage1_bag_acc: 93.9063, stage1_neg_loss: 0.0069, stage1_mean_ious: 0.5603, stage1_s: 0.5567, stage1_m: 0.2851, stage1_l: 0.0108, stage1_h: 0.0000, loss: 0.1103, grad_norm: 4.7706
2024-10-16 04:39:07,985 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:29:30, time: 0.662, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0821, stage0_bag_acc: 91.6792, stage0_mean_ious: 0.4745, stage0_s: 0.4357, stage0_m: 0.2727, stage0_l: 0.0092, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0269, stage1_bag_acc: 93.7483, stage1_neg_loss: 0.0131, stage1_mean_ious: 0.5532, stage1_s: 0.5413, stage1_m: 0.2756, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.1222, grad_norm: 5.7841
2024-10-16 04:39:40,251 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:28:42, time: 0.645, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0673, stage0_bag_acc: 94.0879, stage0_mean_ious: 0.5112, stage0_s: 0.4754, stage0_m: 0.3415, stage0_l: 0.0098, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0282, stage1_bag_acc: 95.0045, stage1_neg_loss: 0.0111, stage1_mean_ious: 0.5810, stage1_s: 0.5852, stage1_m: 0.3181, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.1066, grad_norm: 5.8756
2024-10-16 04:40:11,979 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:27:53, time: 0.635, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0598, stage0_bag_acc: 94.6490, stage0_mean_ious: 0.4769, stage0_s: 0.4476, stage0_m: 0.2743, stage0_l: 0.0086, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0234, stage1_bag_acc: 94.9323, stage1_neg_loss: 0.0139, stage1_mean_ious: 0.5728, stage1_s: 0.5647, stage1_m: 0.2515, stage1_l: 0.0055, stage1_h: 0.0000, loss: 0.0970, grad_norm: 5.0909
2024-10-16 04:40:33,031 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 04:41:16,474 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:26:21, time: 0.824, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0700, stage0_bag_acc: 95.3976, stage0_mean_ious: 0.5025, stage0_s: 0.4592, stage0_m: 0.2984, stage0_l: 0.0106, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0186, stage1_bag_acc: 96.0333, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.5905, stage1_s: 0.5773, stage1_m: 0.2768, stage1_l: 0.0069, stage1_h: 0.0000, loss: 0.0971, grad_norm: 4.8949
2024-10-16 04:41:58,719 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:25:56, time: 0.845, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0537, stage0_bag_acc: 95.5047, stage0_mean_ious: 0.4786, stage0_s: 0.4553, stage0_m: 0.2959, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0184, stage1_bag_acc: 96.4380, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5873, stage1_s: 0.5891, stage1_m: 0.2943, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0794, grad_norm: 3.8118
2024-10-16 04:42:42,339 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:25:31, time: 0.872, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0774, stage0_bag_acc: 94.1333, stage0_mean_ious: 0.4929, stage0_s: 0.4323, stage0_m: 0.4040, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0233, stage1_bag_acc: 94.7500, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.5885, stage1_s: 0.5712, stage1_m: 0.3913, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1090, grad_norm: 4.6064
2024-10-16 04:43:26,891 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:25:07, time: 0.891, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0822, stage0_bag_acc: 94.3983, stage0_mean_ious: 0.5100, stage0_s: 0.4779, stage0_m: 0.3990, stage0_l: 0.0223, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0176, stage1_bag_acc: 95.4634, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.5973, stage1_s: 0.5932, stage1_m: 0.3992, stage1_l: 0.0164, stage1_h: 0.0000, loss: 0.1064, grad_norm: 4.4013
2024-10-16 04:44:11,313 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:24:41, time: 0.888, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0429, stage0_bag_acc: 97.3833, stage0_mean_ious: 0.4923, stage0_s: 0.4551, stage0_m: 0.3414, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0157, stage1_bag_acc: 96.8000, stage1_neg_loss: 0.0076, stage1_mean_ious: 0.5989, stage1_s: 0.6076, stage1_m: 0.3237, stage1_l: 0.0064, stage1_h: 0.0000, loss: 0.0663, grad_norm: 3.7227
2024-10-16 04:44:36,235 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 04:45:22,479 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:23:21, time: 0.882, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0398, stage0_bag_acc: 96.9500, stage0_mean_ious: 0.4987, stage0_s: 0.4548, stage0_m: 0.3166, stage0_l: 0.0058, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0221, stage1_bag_acc: 96.7278, stage1_neg_loss: 0.0131, stage1_mean_ious: 0.6098, stage1_s: 0.5950, stage1_m: 0.3161, stage1_l: 0.0040, stage1_h: 0.0000, loss: 0.0750, grad_norm: 4.4222
2024-10-16 04:46:05,037 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:22:51, time: 0.851, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0265, stage0_bag_acc: 98.2500, stage0_mean_ious: 0.5078, stage0_s: 0.4530, stage0_m: 0.3839, stage0_l: 0.0104, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0085, stage1_bag_acc: 98.0500, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.6119, stage1_s: 0.6028, stage1_m: 0.3898, stage1_l: 0.0055, stage1_h: 0.0000, loss: 0.0418, grad_norm: 2.9529
2024-10-16 04:46:48,006 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:22, time: 0.859, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0360, stage0_bag_acc: 97.0500, stage0_mean_ious: 0.5054, stage0_s: 0.4536, stage0_m: 0.3928, stage0_l: 0.0224, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0183, stage1_bag_acc: 97.0500, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.6016, stage1_s: 0.5980, stage1_m: 0.3818, stage1_l: 0.0204, stage1_h: 0.0000, loss: 0.0616, grad_norm: 3.5159
2024-10-16 04:47:31,912 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:21:52, time: 0.878, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0624, stage0_bag_acc: 95.6865, stage0_mean_ious: 0.4879, stage0_s: 0.4544, stage0_m: 0.3575, stage0_l: 0.0107, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0135, stage1_bag_acc: 96.3889, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5898, stage1_s: 0.5856, stage1_m: 0.3522, stage1_l: 0.0055, stage1_h: 0.0000, loss: 0.0819, grad_norm: 4.4134
2024-10-16 04:48:15,254 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:21, time: 0.867, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0475, stage0_bag_acc: 96.1111, stage0_mean_ious: 0.5109, stage0_s: 0.4485, stage0_m: 0.2966, stage0_l: 0.0344, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0164, stage1_bag_acc: 96.2444, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.6052, stage1_s: 0.5817, stage1_m: 0.2903, stage1_l: 0.0241, stage1_h: 0.0000, loss: 0.0707, grad_norm: 4.3735
2024-10-16 04:48:40,080 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 04:49:58,235 - mmdet - INFO - Evaluating bbox...
2024-10-16 04:49:58,708 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2248
2024-10-16 04:49:58,708 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6889
2024-10-16 04:49:58,708 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4170
2024-10-16 04:49:58,708 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1660
2024-10-16 04:49:58,708 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0838
2024-10-16 04:49:58,708 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0277
2024-10-16 04:49:58,708 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 04:49:58,709 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 04:49:58,709 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2370
2024-10-16 04:49:58,709 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0770
2024-10-16 04:49:58,709 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3312
2024-10-16 04:49:58,709 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7898
2024-10-16 04:49:58,709 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3312
2024-10-16 04:49:58,709 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3312
2024-10-16 04:49:58,709 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 04:49:58,709 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3519
2024-10-16 04:49:58,709 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0914
2024-10-16 04:49:58,714 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 04:49:58,714 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2250, bbox_mAP_50: 0.6890, bbox_mAP_75: 0.4170, bbox_mAP_s: 0.1660, bbox_mAP_m: 0.0840, bbox_mAP_l: 0.0280, bbox_mAP_copypaste: 0.225 0.689 0.417 0.166 0.084 0.028
2024-10-16 04:50:44,176 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:20:07, time: 0.909, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0288, stage0_bag_acc: 98.2778, stage0_mean_ious: 0.5003, stage0_s: 0.4438, stage0_m: 0.3615, stage0_l: 0.0068, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0177, stage1_bag_acc: 98.9000, stage1_neg_loss: 0.0069, stage1_mean_ious: 0.6033, stage1_s: 0.6016, stage1_m: 0.3502, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.0534, grad_norm: 3.0675
2024-10-16 04:51:27,080 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:19:36, time: 0.858, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0457, stage0_bag_acc: 96.3143, stage0_mean_ious: 0.4943, stage0_s: 0.4329, stage0_m: 0.3453, stage0_l: 0.0181, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0204, stage1_bag_acc: 95.6810, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5956, stage1_s: 0.5751, stage1_m: 0.3469, stage1_l: 0.0137, stage1_h: 0.0000, loss: 0.0734, grad_norm: 4.5116
2024-10-16 04:52:10,465 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:19:04, time: 0.868, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0606, stage0_bag_acc: 95.0333, stage0_mean_ious: 0.4925, stage0_s: 0.4219, stage0_m: 0.3557, stage0_l: 0.0201, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0161, stage1_bag_acc: 95.7000, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5858, stage1_s: 0.5413, stage1_m: 0.3674, stage1_l: 0.0140, stage1_h: 0.0000, loss: 0.0817, grad_norm: 4.0025
2024-10-16 04:52:52,835 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:30, time: 0.847, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0520, stage0_bag_acc: 97.2325, stage0_mean_ious: 0.4885, stage0_s: 0.4593, stage0_m: 0.2938, stage0_l: 0.0158, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0135, stage1_bag_acc: 97.7325, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5839, stage1_s: 0.5832, stage1_m: 0.2810, stage1_l: 0.0119, stage1_h: 0.0000, loss: 0.0684, grad_norm: 3.5541
2024-10-16 04:53:38,310 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:17:58, time: 0.909, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0656, stage0_bag_acc: 96.0864, stage0_mean_ious: 0.5279, stage0_s: 0.4817, stage0_m: 0.3976, stage0_l: 0.0207, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0118, stage1_bag_acc: 96.9182, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.5992, stage1_s: 0.6081, stage1_m: 0.3777, stage1_l: 0.0192, stage1_h: 0.0000, loss: 0.0848, grad_norm: 4.6687
2024-10-16 04:54:05,413 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 04:54:52,835 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:16:48, time: 0.904, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0374, stage0_bag_acc: 97.2333, stage0_mean_ious: 0.4633, stage0_s: 0.4342, stage0_m: 0.3216, stage0_l: 0.0053, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 96.9611, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5734, stage1_s: 0.5710, stage1_m: 0.3404, stage1_l: 0.0043, stage1_h: 0.0000, loss: 0.0509, grad_norm: 3.2029
2024-10-16 04:55:35,808 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:16:14, time: 0.859, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0280, stage0_bag_acc: 97.7643, stage0_mean_ious: 0.5114, stage0_s: 0.4709, stage0_m: 0.3531, stage0_l: 0.0168, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0107, stage1_bag_acc: 98.2143, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.6107, stage1_s: 0.6065, stage1_m: 0.3461, stage1_l: 0.0107, stage1_h: 0.0000, loss: 0.0455, grad_norm: 2.8633
2024-10-16 04:56:09,168 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:34, time: 0.667, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0505, stage0_bag_acc: 96.0348, stage0_mean_ious: 0.5003, stage0_s: 0.4581, stage0_m: 0.3747, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0114, stage1_bag_acc: 97.7000, stage1_neg_loss: 0.0045, stage1_mean_ious: 0.5899, stage1_s: 0.5851, stage1_m: 0.3690, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0665, grad_norm: 3.7600
2024-10-16 04:56:43,559 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:14:55, time: 0.688, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0239, stage0_bag_acc: 97.9015, stage0_mean_ious: 0.5361, stage0_s: 0.4494, stage0_m: 0.4240, stage0_l: 0.0227, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0125, stage1_bag_acc: 98.9182, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.6126, stage1_s: 0.5668, stage1_m: 0.4109, stage1_l: 0.0277, stage1_h: 0.0000, loss: 0.0445, grad_norm: 2.9427
2024-10-16 04:57:19,081 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:17, time: 0.710, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0475, stage0_bag_acc: 97.0173, stage0_mean_ious: 0.4793, stage0_s: 0.4332, stage0_m: 0.3587, stage0_l: 0.0077, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0180, stage1_bag_acc: 97.2197, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.6025, stage1_s: 0.5907, stage1_m: 0.3773, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.0739, grad_norm: 4.0790
2024-10-16 04:57:39,613 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 04:58:19,215 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:07, time: 0.748, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0452, stage0_bag_acc: 97.0833, stage0_mean_ious: 0.4881, stage0_s: 0.4303, stage0_m: 0.3610, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0127, stage1_bag_acc: 96.9976, stage1_neg_loss: 0.0110, stage1_mean_ious: 0.6046, stage1_s: 0.5700, stage1_m: 0.3995, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0689, grad_norm: 3.9382
2024-10-16 04:58:53,763 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:29, time: 0.691, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0253, stage0_bag_acc: 97.8308, stage0_mean_ious: 0.5208, stage0_s: 0.4971, stage0_m: 0.4116, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0116, stage1_bag_acc: 98.1697, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.6061, stage1_s: 0.6140, stage1_m: 0.4459, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.0412, grad_norm: 2.5349
2024-10-16 04:59:27,187 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:11:51, time: 0.668, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0261, stage0_bag_acc: 98.7000, stage0_mean_ious: 0.5091, stage0_s: 0.4708, stage0_m: 0.3236, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0103, stage1_bag_acc: 98.4778, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5864, stage1_s: 0.5688, stage1_m: 0.3167, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0402, grad_norm: 2.5982
2024-10-16 05:00:06,759 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:15, time: 0.791, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0218, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.4927, stage0_s: 0.4579, stage0_m: 0.3261, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0100, stage1_bag_acc: 98.4667, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5931, stage1_s: 0.5903, stage1_m: 0.3326, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0339, grad_norm: 1.9542
2024-10-16 05:00:48,002 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:40, time: 0.825, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0439, stage0_bag_acc: 97.7278, stage0_mean_ious: 0.4989, stage0_s: 0.4698, stage0_m: 0.2904, stage0_l: 0.0162, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 97.4500, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5783, stage1_s: 0.5742, stage1_m: 0.2950, stage1_l: 0.0166, stage1_h: 0.0000, loss: 0.0546, grad_norm: 2.6785
2024-10-16 05:01:14,068 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 05:02:32,264 - mmdet - INFO - Evaluating bbox...
2024-10-16 05:02:32,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2348
2024-10-16 05:02:32,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7217
2024-10-16 05:02:32,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4516
2024-10-16 05:02:32,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1717
2024-10-16 05:02:32,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0808
2024-10-16 05:02:32,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0264
2024-10-16 05:02:32,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-16 05:02:32,824 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:02:32,825 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2474
2024-10-16 05:02:32,825 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0733
2024-10-16 05:02:32,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3349
2024-10-16 05:02:32,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8057
2024-10-16 05:02:32,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3349
2024-10-16 05:02:32,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3349
2024-10-16 05:02:32,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:02:32,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3554
2024-10-16 05:02:32,825 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0859
2024-10-16 05:02:32,830 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 05:02:32,831 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2350, bbox_mAP_50: 0.7220, bbox_mAP_75: 0.4520, bbox_mAP_s: 0.1720, bbox_mAP_m: 0.0810, bbox_mAP_l: 0.0260, bbox_mAP_copypaste: 0.235 0.722 0.452 0.172 0.081 0.026
2024-10-16 05:03:16,783 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:37, time: 0.879, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0224, stage0_bag_acc: 99.0000, stage0_mean_ious: 0.4941, stage0_s: 0.4466, stage0_m: 0.2978, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0107, stage1_bag_acc: 98.1667, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5869, stage1_s: 0.5696, stage1_m: 0.2905, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0377, grad_norm: 2.4548
2024-10-16 05:03:58,440 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:02, time: 0.833, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0211, stage0_bag_acc: 98.7500, stage0_mean_ious: 0.5390, stage0_s: 0.4887, stage0_m: 0.4018, stage0_l: 0.0181, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0042, stage1_bag_acc: 98.7500, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5949, stage1_s: 0.5922, stage1_m: 0.3725, stage1_l: 0.0236, stage1_h: 0.0000, loss: 0.0289, grad_norm: 2.1649
2024-10-16 05:04:40,901 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:27, time: 0.849, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0317, stage0_bag_acc: 96.8126, stage0_mean_ious: 0.4812, stage0_s: 0.4378, stage0_m: 0.3378, stage0_l: 0.0118, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0084, stage1_bag_acc: 97.1460, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5928, stage1_s: 0.5725, stage1_m: 0.3648, stage1_l: 0.0129, stage1_h: 0.0000, loss: 0.0421, grad_norm: 2.2832
2024-10-16 05:05:25,305 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:07:52, time: 0.888, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0369, stage0_bag_acc: 97.8000, stage0_mean_ious: 0.5142, stage0_s: 0.4700, stage0_m: 0.3860, stage0_l: 0.0066, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0075, stage1_bag_acc: 97.6667, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5878, stage1_s: 0.5871, stage1_m: 0.3865, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.0460, grad_norm: 2.1090
2024-10-16 05:06:09,114 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:16, time: 0.876, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0199, stage0_bag_acc: 98.0197, stage0_mean_ious: 0.4845, stage0_s: 0.4308, stage0_m: 0.3456, stage0_l: 0.0358, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0087, stage1_bag_acc: 97.8197, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5940, stage1_s: 0.5737, stage1_m: 0.3526, stage1_l: 0.0397, stage1_h: 0.0000, loss: 0.0328, grad_norm: 1.8367
2024-10-16 05:06:34,729 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 05:07:24,835 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:15, time: 0.958, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0107, stage0_bag_acc: 99.1000, stage0_mean_ious: 0.4900, stage0_s: 0.4550, stage0_m: 0.3042, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0058, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5966, stage1_s: 0.5959, stage1_m: 0.3086, stage1_l: 0.0051, stage1_h: 0.0000, loss: 0.0209, grad_norm: 2.0731
2024-10-16 05:08:09,871 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:39, time: 0.901, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0429, stage0_bag_acc: 96.7667, stage0_mean_ious: 0.4886, stage0_s: 0.4298, stage0_m: 0.3643, stage0_l: 0.0065, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0113, stage1_bag_acc: 96.6667, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5760, stage1_s: 0.5428, stage1_m: 0.3714, stage1_l: 0.0071, stage1_h: 0.0000, loss: 0.0584, grad_norm: 3.1404
2024-10-16 05:08:54,454 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:04, time: 0.892, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0159, stage0_bag_acc: 98.6111, stage0_mean_ious: 0.4942, stage0_s: 0.4303, stage0_m: 0.3636, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 98.6111, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5918, stage1_s: 0.5539, stage1_m: 0.3838, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0282, grad_norm: 1.9079
2024-10-16 05:09:38,478 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 05:09:38,479 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:27, time: 0.880, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0179, stage0_bag_acc: 98.6348, stage0_mean_ious: 0.5050, stage0_s: 0.4562, stage0_m: 0.3353, stage0_l: 0.0293, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 98.4833, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5661, stage1_s: 0.5627, stage1_m: 0.3338, stage1_l: 0.0269, stage1_h: 0.0000, loss: 0.0320, grad_norm: 1.8742
2024-10-16 05:10:23,505 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:51, time: 0.901, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0320, stage0_bag_acc: 97.5333, stage0_mean_ious: 0.5237, stage0_s: 0.4592, stage0_m: 0.4251, stage0_l: 0.0450, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0073, stage1_bag_acc: 98.1167, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5989, stage1_s: 0.5900, stage1_m: 0.4202, stage1_l: 0.0409, stage1_h: 0.0000, loss: 0.0447, grad_norm: 2.6352
2024-10-16 05:10:49,697 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 05:11:38,352 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:50, time: 0.929, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0210, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.5214, stage0_s: 0.4681, stage0_m: 0.4368, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0057, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5790, stage1_s: 0.5637, stage1_m: 0.4266, stage1_l: 0.0084, stage1_h: 0.0000, loss: 0.0289, grad_norm: 1.7335
2024-10-16 05:12:23,911 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:14, time: 0.911, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0146, stage0_bag_acc: 99.0167, stage0_mean_ious: 0.4940, stage0_s: 0.4499, stage0_m: 0.3837, stage0_l: 0.0300, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0104, stage1_bag_acc: 99.0167, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5961, stage1_s: 0.5867, stage1_m: 0.3904, stage1_l: 0.0176, stage1_h: 0.0000, loss: 0.0297, grad_norm: 1.7552
2024-10-16 05:13:07,451 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:37, time: 0.871, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0259, stage0_bag_acc: 97.6823, stage0_mean_ious: 0.4786, stage0_s: 0.4461, stage0_m: 0.3100, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0098, stage1_bag_acc: 98.0823, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5904, stage1_s: 0.5781, stage1_m: 0.3264, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0391, grad_norm: 2.2404
2024-10-16 05:13:49,977 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:00:59, time: 0.850, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0266, stage0_bag_acc: 98.1682, stage0_mean_ious: 0.5145, stage0_s: 0.4775, stage0_m: 0.3574, stage0_l: 0.0146, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0116, stage1_bag_acc: 97.6864, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.6035, stage1_s: 0.6021, stage1_m: 0.3507, stage1_l: 0.0126, stage1_h: 0.0000, loss: 0.0423, grad_norm: 2.3916
2024-10-16 05:14:24,937 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:22, time: 0.699, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0154, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.5153, stage0_s: 0.4312, stage0_m: 0.3640, stage0_l: 0.0048, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0066, stage1_bag_acc: 98.9500, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5990, stage1_s: 0.5469, stage1_m: 0.3741, stage1_l: 0.0029, stage1_h: 0.0000, loss: 0.0246, grad_norm: 1.4491
2024-10-16 05:14:45,755 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 05:16:01,315 - mmdet - INFO - Evaluating bbox...
2024-10-16 05:16:01,859 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2359
2024-10-16 05:16:01,859 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7171
2024-10-16 05:16:01,859 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4516
2024-10-16 05:16:01,860 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1743
2024-10-16 05:16:01,860 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0829
2024-10-16 05:16:01,860 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0278
2024-10-16 05:16:01,860 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 05:16:01,860 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:16:01,860 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2482
2024-10-16 05:16:01,860 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0777
2024-10-16 05:16:01,860 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3370
2024-10-16 05:16:01,860 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8032
2024-10-16 05:16:01,860 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3370
2024-10-16 05:16:01,860 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3370
2024-10-16 05:16:01,861 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:16:01,861 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3576
2024-10-16 05:16:01,861 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0909
2024-10-16 05:16:01,865 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 05:16:01,865 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2360, bbox_mAP_50: 0.7170, bbox_mAP_75: 0.4520, bbox_mAP_s: 0.1740, bbox_mAP_m: 0.0830, bbox_mAP_l: 0.0280, bbox_mAP_copypaste: 0.236 0.717 0.452 0.174 0.083 0.028
2024-10-16 05:17:16,462 - mmdet - INFO - Evaluating bbox...
2024-10-16 05:17:16,950 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2359
2024-10-16 05:17:16,950 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7171
2024-10-16 05:17:16,950 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4516
2024-10-16 05:17:16,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1743
2024-10-16 05:17:16,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0829
2024-10-16 05:17:16,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0278
2024-10-16 05:17:16,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 05:17:16,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:17:16,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2482
2024-10-16 05:17:16,951 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0777
2024-10-16 05:17:16,951 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3370
2024-10-16 05:17:16,951 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8032
2024-10-16 05:17:16,951 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3370
2024-10-16 05:17:16,952 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3370
2024-10-16 05:17:16,952 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:17:16,952 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3576
2024-10-16 05:17:16,952 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0909
2024-10-16 05:17:18,194 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+2fd3e4b
------------------------------------------------------------

2024-10-16 05:17:19,106 - mmdet - INFO - Distributed training: False
2024-10-16 05:17:19,933 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-16 05:17:20,899 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 05:17:20,899 - mmdet - INFO - Use load_from_local loader
2024-10-16 05:17:21,220 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 05:17:21,224 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 05:17:21,224 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 05:18:02,323 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:45:20, time: 0.822, data_time: 0.060, memory: 7817, stage0_loss_instance_mil: 0.7291, stage0_bag_acc: 15.1623, stage0_mean_ious: 0.0582, stage0_s: 0.0453, stage0_m: 0.0521, stage0_l: 0.0148, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1572, stage1_bag_acc: 16.2732, stage1_neg_loss: 0.0008, stage1_mean_ious: 0.0613, stage1_s: 0.0474, stage1_m: 0.0549, stage1_l: 0.0161, stage1_h: 0.0000, loss: 0.8871, grad_norm: 5.5206
2024-10-16 05:18:48,478 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:47:24, time: 0.923, data_time: 0.011, memory: 7817, stage0_loss_instance_mil: 0.7031, stage0_bag_acc: 13.3690, stage0_mean_ious: 0.0667, stage0_s: 0.0551, stage0_m: 0.0628, stage0_l: 0.0121, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1629, stage1_bag_acc: 17.1817, stage1_neg_loss: 0.0012, stage1_mean_ious: 0.0701, stage1_s: 0.0572, stage1_m: 0.0662, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.8672, grad_norm: 5.6806
2024-10-16 05:19:31,246 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:46:22, time: 0.855, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.6756, stage0_bag_acc: 22.9621, stage0_mean_ious: 0.1310, stage0_s: 0.0941, stage0_m: 0.1307, stage0_l: 0.0298, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1648, stage1_bag_acc: 9.8424, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.1304, stage1_s: 0.0959, stage1_m: 0.1225, stage1_l: 0.0222, stage1_h: 0.0000, loss: 0.8458, grad_norm: 8.2379
2024-10-16 05:20:14,963 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:45:44, time: 0.874, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.6653, stage0_bag_acc: 23.5288, stage0_mean_ious: 0.1215, stage0_s: 0.1060, stage0_m: 0.0990, stage0_l: 0.0023, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1340, stage1_bag_acc: 36.4576, stage1_neg_loss: 0.0134, stage1_mean_ious: 0.1391, stage1_s: 0.1229, stage1_m: 0.1161, stage1_l: 0.0023, stage1_h: 0.0000, loss: 0.8127, grad_norm: 9.5569
2024-10-16 05:21:00,696 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:45:30, time: 0.915, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.5874, stage0_bag_acc: 33.8926, stage0_mean_ious: 0.1219, stage0_s: 0.1126, stage0_m: 0.0935, stage0_l: 0.0007, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1286, stage1_bag_acc: 49.7910, stage1_neg_loss: 0.0254, stage1_mean_ious: 0.1497, stage1_s: 0.1414, stage1_m: 0.0999, stage1_l: 0.0009, stage1_h: 0.0000, loss: 0.7415, grad_norm: 10.7820
2024-10-16 05:21:26,874 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 05:22:13,315 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:40:21, time: 0.885, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.5268, stage0_bag_acc: 39.7580, stage0_mean_ious: 0.2173, stage0_s: 0.1691, stage0_m: 0.1856, stage0_l: 0.0129, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1202, stage1_bag_acc: 57.3141, stage1_neg_loss: 0.0230, stage1_mean_ious: 0.2344, stage1_s: 0.1868, stage1_m: 0.1914, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.6700, grad_norm: 11.7596
2024-10-16 05:22:57,196 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:40:12, time: 0.878, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.4620, stage0_bag_acc: 52.1490, stage0_mean_ious: 0.3212, stage0_s: 0.2759, stage0_m: 0.2749, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1060, stage1_bag_acc: 56.4338, stage1_neg_loss: 0.0205, stage1_mean_ious: 0.3908, stage1_s: 0.3630, stage1_m: 0.2923, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5885, grad_norm: 13.0858
2024-10-16 05:23:41,232 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:39:55, time: 0.881, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.3554, stage0_bag_acc: 68.2061, stage0_mean_ious: 0.3893, stage0_s: 0.3331, stage0_m: 0.3010, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0899, stage1_bag_acc: 65.2601, stage1_neg_loss: 0.0204, stage1_mean_ious: 0.4885, stage1_s: 0.4477, stage1_m: 0.3200, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.4656, grad_norm: 13.6325
2024-10-16 05:24:23,433 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:39:22, time: 0.844, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.3382, stage0_bag_acc: 71.6959, stage0_mean_ious: 0.3864, stage0_s: 0.3471, stage0_m: 0.2052, stage0_l: 0.0288, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0725, stage1_bag_acc: 75.5444, stage1_neg_loss: 0.0142, stage1_mean_ious: 0.5022, stage1_s: 0.4825, stage1_m: 0.2237, stage1_l: 0.0250, stage1_h: 0.0000, loss: 0.4250, grad_norm: 12.8017
2024-10-16 05:25:08,154 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:39:01, time: 0.894, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.1564, stage0_bag_acc: 87.4310, stage0_mean_ious: 0.4552, stage0_s: 0.4255, stage0_m: 0.3618, stage0_l: 0.0119, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0618, stage1_bag_acc: 89.5000, stage1_neg_loss: 0.0213, stage1_mean_ious: 0.5454, stage1_s: 0.5453, stage1_m: 0.3651, stage1_l: 0.0083, stage1_h: 0.0000, loss: 0.2394, grad_norm: 9.1750
2024-10-16 05:25:33,196 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 05:26:20,731 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:36:21, time: 0.906, data_time: 0.060, memory: 7817, stage0_loss_instance_mil: 0.1691, stage0_bag_acc: 88.3242, stage0_mean_ious: 0.4502, stage0_s: 0.4265, stage0_m: 0.2861, stage0_l: 0.0090, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0391, stage1_bag_acc: 89.7323, stage1_neg_loss: 0.0133, stage1_mean_ious: 0.5558, stage1_s: 0.5593, stage1_m: 0.2923, stage1_l: 0.0074, stage1_h: 0.0000, loss: 0.2216, grad_norm: 9.3076
2024-10-16 05:27:03,622 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:35:54, time: 0.858, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.1325, stage0_bag_acc: 88.9611, stage0_mean_ious: 0.4853, stage0_s: 0.4292, stage0_m: 0.3295, stage0_l: 0.0325, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0463, stage1_bag_acc: 89.1722, stage1_neg_loss: 0.0183, stage1_mean_ious: 0.5724, stage1_s: 0.5449, stage1_m: 0.3387, stage1_l: 0.0280, stage1_h: 0.0000, loss: 0.1971, grad_norm: 7.8389
2024-10-16 05:27:48,370 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:35:33, time: 0.895, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.1192, stage0_bag_acc: 92.6909, stage0_mean_ious: 0.4641, stage0_s: 0.4147, stage0_m: 0.3853, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0295, stage1_bag_acc: 93.0727, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5718, stage1_s: 0.5602, stage1_m: 0.3787, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1556, grad_norm: 5.7556
2024-10-16 05:28:31,230 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:35:01, time: 0.857, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.1029, stage0_bag_acc: 93.0015, stage0_mean_ious: 0.4500, stage0_s: 0.3853, stage0_m: 0.2639, stage0_l: 0.0190, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0447, stage1_bag_acc: 93.4848, stage1_neg_loss: 0.0153, stage1_mean_ious: 0.5481, stage1_s: 0.5178, stage1_m: 0.2352, stage1_l: 0.0110, stage1_h: 0.0000, loss: 0.1629, grad_norm: 7.2786
2024-10-16 05:29:15,972 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:34:34, time: 0.895, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0863, stage0_bag_acc: 93.0460, stage0_mean_ious: 0.4711, stage0_s: 0.4281, stage0_m: 0.4251, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0287, stage1_bag_acc: 93.3293, stage1_neg_loss: 0.0096, stage1_mean_ious: 0.5609, stage1_s: 0.5497, stage1_m: 0.4273, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1245, grad_norm: 5.8933
2024-10-16 05:29:42,303 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 05:31:01,735 - mmdet - INFO - Evaluating bbox...
2024-10-16 05:31:02,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2022
2024-10-16 05:31:02,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6490
2024-10-16 05:31:02,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3786
2024-10-16 05:31:02,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1333
2024-10-16 05:31:02,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0695
2024-10-16 05:31:02,291 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0215
2024-10-16 05:31:02,292 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0018
2024-10-16 05:31:02,292 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:31:02,292 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2110
2024-10-16 05:31:02,292 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0684
2024-10-16 05:31:02,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2994
2024-10-16 05:31:02,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7593
2024-10-16 05:31:02,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2994
2024-10-16 05:31:02,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2994
2024-10-16 05:31:02,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:31:02,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3151
2024-10-16 05:31:02,292 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0918
2024-10-16 05:31:02,297 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 05:31:02,298 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2020, bbox_mAP_50: 0.6490, bbox_mAP_75: 0.3790, bbox_mAP_s: 0.1330, bbox_mAP_m: 0.0690, bbox_mAP_l: 0.0210, bbox_mAP_copypaste: 0.202 0.649 0.379 0.133 0.069 0.021
2024-10-16 05:31:42,363 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:32:20, time: 0.801, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0685, stage0_bag_acc: 94.1682, stage0_mean_ious: 0.4952, stage0_s: 0.4479, stage0_m: 0.3569, stage0_l: 0.0174, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0248, stage1_bag_acc: 95.7167, stage1_neg_loss: 0.0103, stage1_mean_ious: 0.5754, stage1_s: 0.5508, stage1_m: 0.3592, stage1_l: 0.0126, stage1_h: 0.0000, loss: 0.1036, grad_norm: 5.5283
2024-10-16 05:32:15,513 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:31:25, time: 0.663, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0853, stage0_bag_acc: 93.7268, stage0_mean_ious: 0.4663, stage0_s: 0.4219, stage0_m: 0.3616, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0273, stage1_bag_acc: 94.9180, stage1_neg_loss: 0.0130, stage1_mean_ious: 0.5697, stage1_s: 0.5531, stage1_m: 0.3501, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1255, grad_norm: 5.9482
2024-10-16 05:32:49,084 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:30:33, time: 0.671, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0912, stage0_bag_acc: 93.4389, stage0_mean_ious: 0.4825, stage0_s: 0.4336, stage0_m: 0.3394, stage0_l: 0.0167, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0236, stage1_bag_acc: 93.0833, stage1_neg_loss: 0.0069, stage1_mean_ious: 0.5670, stage1_s: 0.5648, stage1_m: 0.3110, stage1_l: 0.0172, stage1_h: 0.0000, loss: 0.1217, grad_norm: 5.3080
2024-10-16 05:33:20,633 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:29:38, time: 0.631, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0796, stage0_bag_acc: 94.1286, stage0_mean_ious: 0.4834, stage0_s: 0.4644, stage0_m: 0.2807, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0283, stage1_bag_acc: 94.1286, stage1_neg_loss: 0.0132, stage1_mean_ious: 0.5786, stage1_s: 0.5778, stage1_m: 0.2776, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1211, grad_norm: 5.8968
2024-10-16 05:33:55,787 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:28:53, time: 0.703, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0679, stage0_bag_acc: 94.7222, stage0_mean_ious: 0.4560, stage0_s: 0.3696, stage0_m: 0.3594, stage0_l: 0.0170, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0281, stage1_bag_acc: 94.2126, stage1_neg_loss: 0.0159, stage1_mean_ious: 0.5671, stage1_s: 0.5182, stage1_m: 0.3596, stage1_l: 0.0149, stage1_h: 0.0000, loss: 0.1119, grad_norm: 6.1990
2024-10-16 05:34:15,855 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 05:34:53,263 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:27:04, time: 0.705, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0849, stage0_bag_acc: 93.5167, stage0_mean_ious: 0.4957, stage0_s: 0.4506, stage0_m: 0.2829, stage0_l: 0.0314, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0273, stage1_bag_acc: 93.9167, stage1_neg_loss: 0.0146, stage1_mean_ious: 0.5797, stage1_s: 0.5717, stage1_m: 0.2699, stage1_l: 0.0301, stage1_h: 0.0000, loss: 0.1268, grad_norm: 6.4950
2024-10-16 05:35:32,998 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:26:31, time: 0.795, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0600, stage0_bag_acc: 95.8030, stage0_mean_ious: 0.4676, stage0_s: 0.4129, stage0_m: 0.3876, stage0_l: 0.0143, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0200, stage1_bag_acc: 95.4491, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5700, stage1_s: 0.5445, stage1_m: 0.4014, stage1_l: 0.0094, stage1_h: 0.0000, loss: 0.0868, grad_norm: 4.4311
2024-10-16 05:36:16,814 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:26:05, time: 0.876, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0619, stage0_bag_acc: 94.0595, stage0_mean_ious: 0.4782, stage0_s: 0.4224, stage0_m: 0.2971, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0191, stage1_bag_acc: 95.7595, stage1_neg_loss: 0.0079, stage1_mean_ious: 0.5733, stage1_s: 0.5507, stage1_m: 0.2807, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0890, grad_norm: 5.3315
2024-10-16 05:36:59,555 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:25:36, time: 0.855, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0553, stage0_bag_acc: 95.5587, stage0_mean_ious: 0.5148, stage0_s: 0.5050, stage0_m: 0.3050, stage0_l: 0.0065, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0226, stage1_bag_acc: 96.3421, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.6035, stage1_s: 0.6103, stage1_m: 0.2986, stage1_l: 0.0055, stage1_h: 0.0000, loss: 0.0854, grad_norm: 4.5036
2024-10-16 05:37:44,488 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:25:09, time: 0.899, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0590, stage0_bag_acc: 94.5619, stage0_mean_ious: 0.4540, stage0_s: 0.4307, stage0_m: 0.2994, stage0_l: 0.0186, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0188, stage1_bag_acc: 95.1643, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5635, stage1_s: 0.5595, stage1_m: 0.3016, stage1_l: 0.0123, stage1_h: 0.0000, loss: 0.0859, grad_norm: 4.9835
2024-10-16 05:38:10,622 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 05:38:58,671 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:23:49, time: 0.917, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0632, stage0_bag_acc: 95.1667, stage0_mean_ious: 0.4706, stage0_s: 0.4259, stage0_m: 0.3319, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0210, stage1_bag_acc: 95.9348, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.5618, stage1_s: 0.5440, stage1_m: 0.3369, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.0924, grad_norm: 5.1879
2024-10-16 05:39:43,015 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:23:20, time: 0.887, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0415, stage0_bag_acc: 97.2436, stage0_mean_ious: 0.4847, stage0_s: 0.4521, stage0_m: 0.2879, stage0_l: 0.0133, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0144, stage1_bag_acc: 97.6436, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5691, stage1_s: 0.5565, stage1_m: 0.3061, stage1_l: 0.0155, stage1_h: 0.0000, loss: 0.0628, grad_norm: 3.6828
2024-10-16 05:40:25,574 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:22:48, time: 0.851, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0447, stage0_bag_acc: 96.3506, stage0_mean_ious: 0.4892, stage0_s: 0.4693, stage0_m: 0.2913, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0128, stage1_bag_acc: 96.6825, stage1_neg_loss: 0.0064, stage1_mean_ious: 0.5915, stage1_s: 0.5925, stage1_m: 0.3000, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0638, grad_norm: 3.6607
2024-10-16 05:41:09,931 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:22:17, time: 0.887, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0548, stage0_bag_acc: 95.6212, stage0_mean_ious: 0.4903, stage0_s: 0.4534, stage0_m: 0.3728, stage0_l: 0.0166, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0216, stage1_bag_acc: 96.4394, stage1_neg_loss: 0.0093, stage1_mean_ious: 0.5680, stage1_s: 0.5683, stage1_m: 0.3540, stage1_l: 0.0124, stage1_h: 0.0000, loss: 0.0857, grad_norm: 4.8873
2024-10-16 05:41:54,737 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:21:46, time: 0.896, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0453, stage0_bag_acc: 96.7643, stage0_mean_ious: 0.4961, stage0_s: 0.4424, stage0_m: 0.4074, stage0_l: 0.0174, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0184, stage1_bag_acc: 96.6810, stage1_neg_loss: 0.0071, stage1_mean_ious: 0.5886, stage1_s: 0.5767, stage1_m: 0.3989, stage1_l: 0.0155, stage1_h: 0.0000, loss: 0.0708, grad_norm: 3.7222
2024-10-16 05:42:23,250 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 05:43:42,100 - mmdet - INFO - Evaluating bbox...
2024-10-16 05:43:42,673 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2159
2024-10-16 05:43:42,673 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6842
2024-10-16 05:43:42,673 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4074
2024-10-16 05:43:42,673 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1447
2024-10-16 05:43:42,673 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0746
2024-10-16 05:43:42,673 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0251
2024-10-16 05:43:42,673 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-16 05:43:42,674 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:43:42,674 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2255
2024-10-16 05:43:42,674 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0788
2024-10-16 05:43:42,674 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3147
2024-10-16 05:43:42,674 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7823
2024-10-16 05:43:42,674 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3147
2024-10-16 05:43:42,674 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3147
2024-10-16 05:43:42,674 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:43:42,674 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3317
2024-10-16 05:43:42,674 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1045
2024-10-16 05:43:42,679 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 05:43:42,680 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2160, bbox_mAP_50: 0.6840, bbox_mAP_75: 0.4070, bbox_mAP_s: 0.1450, bbox_mAP_m: 0.0750, bbox_mAP_l: 0.0250, bbox_mAP_copypaste: 0.216 0.684 0.407 0.145 0.075 0.025
2024-10-16 05:44:30,131 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:20:32, time: 0.949, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0194, stage0_bag_acc: 98.6476, stage0_mean_ious: 0.5150, stage0_s: 0.4389, stage0_m: 0.3742, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0139, stage1_bag_acc: 98.7310, stage1_neg_loss: 0.0087, stage1_mean_ious: 0.6017, stage1_s: 0.5683, stage1_m: 0.3732, stage1_l: 0.0091, stage1_h: 0.0000, loss: 0.0419, grad_norm: 3.3990
2024-10-16 05:45:15,861 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:20:01, time: 0.915, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0346, stage0_bag_acc: 97.6833, stage0_mean_ious: 0.4842, stage0_s: 0.4037, stage0_m: 0.3630, stage0_l: 0.0195, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0096, stage1_bag_acc: 98.3333, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5801, stage1_s: 0.5448, stage1_m: 0.3706, stage1_l: 0.0202, stage1_h: 0.0000, loss: 0.0505, grad_norm: 2.9093
2024-10-16 05:45:58,661 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:19:27, time: 0.856, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0432, stage0_bag_acc: 96.0667, stage0_mean_ious: 0.4746, stage0_s: 0.4268, stage0_m: 0.2758, stage0_l: 0.0110, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0147, stage1_bag_acc: 96.7667, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5790, stage1_s: 0.5530, stage1_m: 0.2759, stage1_l: 0.0093, stage1_h: 0.0000, loss: 0.0620, grad_norm: 3.5589
2024-10-16 05:46:40,979 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:18:52, time: 0.846, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0318, stage0_bag_acc: 97.4167, stage0_mean_ious: 0.4984, stage0_s: 0.4739, stage0_m: 0.3054, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0137, stage1_bag_acc: 97.2167, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.6039, stage1_s: 0.6091, stage1_m: 0.3161, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0512, grad_norm: 3.1830
2024-10-16 05:47:24,389 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:18:18, time: 0.868, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0440, stage0_bag_acc: 96.9045, stage0_mean_ious: 0.4644, stage0_s: 0.3954, stage0_m: 0.3151, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0201, stage1_bag_acc: 96.3212, stage1_neg_loss: 0.0070, stage1_mean_ious: 0.5558, stage1_s: 0.5237, stage1_m: 0.3107, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0711, grad_norm: 4.3880
2024-10-16 05:47:52,480 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 05:48:39,976 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:17:06, time: 0.907, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0139, stage0_bag_acc: 99.4000, stage0_mean_ious: 0.4940, stage0_s: 0.4533, stage0_m: 0.3139, stage0_l: 0.0093, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0096, stage1_bag_acc: 99.6000, stage1_neg_loss: 0.0065, stage1_mean_ious: 0.5787, stage1_s: 0.5717, stage1_m: 0.2972, stage1_l: 0.0048, stage1_h: 0.0000, loss: 0.0300, grad_norm: 2.3759
2024-10-16 05:49:16,650 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:16:27, time: 0.733, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0369, stage0_bag_acc: 97.1444, stage0_mean_ious: 0.4979, stage0_s: 0.4286, stage0_m: 0.3249, stage0_l: 0.0168, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0211, stage1_bag_acc: 97.0087, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5993, stage1_s: 0.5502, stage1_m: 0.3125, stage1_l: 0.0221, stage1_h: 0.0000, loss: 0.0669, grad_norm: 3.9778
2024-10-16 05:49:50,927 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:15:47, time: 0.686, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0531, stage0_bag_acc: 95.7278, stage0_mean_ious: 0.4774, stage0_s: 0.4272, stage0_m: 0.3317, stage0_l: 0.0178, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0188, stage1_bag_acc: 95.4556, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5729, stage1_s: 0.5472, stage1_m: 0.3426, stage1_l: 0.0120, stage1_h: 0.0000, loss: 0.0768, grad_norm: 4.4170
2024-10-16 05:50:24,784 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:15:07, time: 0.677, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0267, stage0_bag_acc: 98.0825, stage0_mean_ious: 0.4641, stage0_s: 0.4392, stage0_m: 0.3509, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0097, stage1_bag_acc: 98.2825, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5684, stage1_s: 0.5630, stage1_m: 0.3638, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0393, grad_norm: 2.5695
2024-10-16 05:50:58,757 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:14:27, time: 0.680, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0375, stage0_bag_acc: 97.3944, stage0_mean_ious: 0.5111, stage0_s: 0.4566, stage0_m: 0.3921, stage0_l: 0.0337, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0117, stage1_bag_acc: 98.0944, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5951, stage1_s: 0.5999, stage1_m: 0.3629, stage1_l: 0.0249, stage1_h: 0.0000, loss: 0.0546, grad_norm: 3.0870
2024-10-16 05:51:18,882 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 05:51:57,457 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:13:15, time: 0.728, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0312, stage0_bag_acc: 98.0500, stage0_mean_ious: 0.4715, stage0_s: 0.4378, stage0_m: 0.3421, stage0_l: 0.0233, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0138, stage1_bag_acc: 98.5500, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5655, stage1_s: 0.5518, stage1_m: 0.3437, stage1_l: 0.0251, stage1_h: 0.0000, loss: 0.0481, grad_norm: 3.1736
2024-10-16 05:52:32,176 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:12:37, time: 0.694, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0201, stage0_bag_acc: 98.7167, stage0_mean_ious: 0.4897, stage0_s: 0.4418, stage0_m: 0.3271, stage0_l: 0.0268, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 98.6000, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5866, stage1_s: 0.5651, stage1_m: 0.3256, stage1_l: 0.0157, stage1_h: 0.0000, loss: 0.0299, grad_norm: 2.4203
2024-10-16 05:53:10,507 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:12:00, time: 0.766, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0283, stage0_bag_acc: 98.3056, stage0_mean_ious: 0.5032, stage0_s: 0.4654, stage0_m: 0.3431, stage0_l: 0.0092, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0130, stage1_bag_acc: 97.7778, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5731, stage1_s: 0.5577, stage1_m: 0.3344, stage1_l: 0.0078, stage1_h: 0.0000, loss: 0.0438, grad_norm: 2.8386
2024-10-16 05:53:53,662 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:11:25, time: 0.863, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0144, stage0_bag_acc: 98.5167, stage0_mean_ious: 0.4957, stage0_s: 0.4619, stage0_m: 0.3415, stage0_l: 0.0144, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0056, stage1_bag_acc: 98.2667, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5831, stage1_s: 0.5795, stage1_m: 0.3139, stage1_l: 0.0164, stage1_h: 0.0000, loss: 0.0227, grad_norm: 1.8836
2024-10-16 05:54:37,555 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:10:51, time: 0.878, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0199, stage0_bag_acc: 98.9325, stage0_mean_ious: 0.4791, stage0_s: 0.4288, stage0_m: 0.2845, stage0_l: 0.0176, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 98.7143, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5838, stage1_s: 0.5600, stage1_m: 0.2918, stage1_l: 0.0119, stage1_h: 0.0000, loss: 0.0310, grad_norm: 3.0122
2024-10-16 05:55:04,757 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 05:56:24,393 - mmdet - INFO - Evaluating bbox...
2024-10-16 05:56:24,934 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2102
2024-10-16 05:56:24,934 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6756
2024-10-16 05:56:24,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3974
2024-10-16 05:56:24,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1479
2024-10-16 05:56:24,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0620
2024-10-16 05:56:24,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0193
2024-10-16 05:56:24,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0002
2024-10-16 05:56:24,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:56:24,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2192
2024-10-16 05:56:24,935 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0682
2024-10-16 05:56:24,935 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3142
2024-10-16 05:56:24,935 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7833
2024-10-16 05:56:24,936 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3142
2024-10-16 05:56:24,936 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3142
2024-10-16 05:56:24,936 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 05:56:24,936 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3312
2024-10-16 05:56:24,936 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0941
2024-10-16 05:56:24,940 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 05:56:24,941 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2100, bbox_mAP_50: 0.6760, bbox_mAP_75: 0.3970, bbox_mAP_s: 0.1480, bbox_mAP_m: 0.0620, bbox_mAP_l: 0.0190, bbox_mAP_copypaste: 0.210 0.676 0.397 0.148 0.062 0.019
2024-10-16 05:57:11,472 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:09:47, time: 0.930, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0205, stage0_bag_acc: 99.1682, stage0_mean_ious: 0.4927, stage0_s: 0.4630, stage0_m: 0.3226, stage0_l: 0.0063, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0114, stage1_bag_acc: 98.1960, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5880, stage1_s: 0.5820, stage1_m: 0.3298, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.0344, grad_norm: 2.6799
2024-10-16 05:57:56,052 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:11, time: 0.892, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0311, stage0_bag_acc: 96.8476, stage0_mean_ious: 0.4887, stage0_s: 0.4409, stage0_m: 0.3917, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0110, stage1_bag_acc: 96.3476, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5903, stage1_s: 0.5836, stage1_m: 0.3747, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0459, grad_norm: 3.0307
2024-10-16 05:58:41,369 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:08:36, time: 0.906, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0309, stage0_bag_acc: 97.9333, stage0_mean_ious: 0.4852, stage0_s: 0.4295, stage0_m: 0.3826, stage0_l: 0.0188, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 97.1500, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5917, stage1_s: 0.5650, stage1_m: 0.3686, stage1_l: 0.0098, stage1_h: 0.0000, loss: 0.0400, grad_norm: 2.5554
2024-10-16 05:59:25,386 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:08:00, time: 0.880, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0261, stage0_bag_acc: 97.8944, stage0_mean_ious: 0.4772, stage0_s: 0.4370, stage0_m: 0.3644, stage0_l: 0.0065, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0075, stage1_bag_acc: 97.6944, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.5749, stage1_s: 0.5719, stage1_m: 0.3610, stage1_l: 0.0077, stage1_h: 0.0000, loss: 0.0359, grad_norm: 2.4437
2024-10-16 06:00:07,834 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:24, time: 0.849, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0167, stage0_bag_acc: 99.0500, stage0_mean_ious: 0.5021, stage0_s: 0.4698, stage0_m: 0.4045, stage0_l: 0.0264, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0092, stage1_bag_acc: 99.0500, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5711, stage1_s: 0.5673, stage1_m: 0.3893, stage1_l: 0.0301, stage1_h: 0.0000, loss: 0.0290, grad_norm: 2.3018
2024-10-16 06:00:33,949 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 06:01:19,336 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:21, time: 0.864, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0154, stage0_bag_acc: 98.7667, stage0_mean_ious: 0.4697, stage0_s: 0.4389, stage0_m: 0.2953, stage0_l: 0.0163, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0039, stage1_bag_acc: 99.0167, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5608, stage1_s: 0.5569, stage1_m: 0.2772, stage1_l: 0.0171, stage1_h: 0.0000, loss: 0.0221, grad_norm: 1.7775
2024-10-16 06:02:03,707 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:05:44, time: 0.887, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0242, stage0_bag_acc: 98.5167, stage0_mean_ious: 0.4792, stage0_s: 0.4268, stage0_m: 0.3098, stage0_l: 0.0069, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0097, stage1_bag_acc: 97.8000, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5721, stage1_s: 0.5529, stage1_m: 0.3115, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.0361, grad_norm: 2.1551
2024-10-16 06:02:47,122 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:08, time: 0.868, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0196, stage0_bag_acc: 98.6000, stage0_mean_ious: 0.4810, stage0_s: 0.4556, stage0_m: 0.3205, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 98.6000, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5810, stage1_s: 0.5770, stage1_m: 0.3326, stage1_l: 0.0066, stage1_h: 0.0000, loss: 0.0307, grad_norm: 2.0883
2024-10-16 06:03:32,479 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 06:03:32,479 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:31, time: 0.907, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0246, stage0_bag_acc: 99.0500, stage0_mean_ious: 0.5027, stage0_s: 0.4653, stage0_m: 0.4234, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 98.8000, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5954, stage1_s: 0.5940, stage1_m: 0.4129, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0370, grad_norm: 2.0787
2024-10-16 06:04:16,811 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:03:54, time: 0.886, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0103, stage0_bag_acc: 99.2667, stage0_mean_ious: 0.4930, stage0_s: 0.4449, stage0_m: 0.3611, stage0_l: 0.0145, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0052, stage1_bag_acc: 99.6000, stage1_neg_loss: 0.0031, stage1_mean_ious: 0.5821, stage1_s: 0.5597, stage1_m: 0.3645, stage1_l: 0.0139, stage1_h: 0.0000, loss: 0.0186, grad_norm: 1.4742
2024-10-16 06:04:44,911 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 06:05:34,824 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:02:53, time: 0.953, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0135, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.4979, stage0_s: 0.4693, stage0_m: 0.3665, stage0_l: 0.0059, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0069, stage1_bag_acc: 98.4643, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.6045, stage1_s: 0.5995, stage1_m: 0.3837, stage1_l: 0.0051, stage1_h: 0.0000, loss: 0.0221, grad_norm: 1.4426
2024-10-16 06:06:20,058 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:15, time: 0.905, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0209, stage0_bag_acc: 97.9000, stage0_mean_ious: 0.5057, stage0_s: 0.4629, stage0_m: 0.3582, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0081, stage1_bag_acc: 98.1000, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5893, stage1_s: 0.5808, stage1_m: 0.3499, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0307, grad_norm: 1.8167
2024-10-16 06:06:54,916 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:37, time: 0.697, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0139, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.5017, stage0_s: 0.4677, stage0_m: 0.3374, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0087, stage1_bag_acc: 99.4000, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5915, stage1_s: 0.5849, stage1_m: 0.3583, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0247, grad_norm: 1.8093
2024-10-16 06:07:29,054 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:01:00, time: 0.683, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0153, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.4612, stage0_s: 0.4214, stage0_m: 0.2977, stage0_l: 0.0134, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0061, stage1_bag_acc: 99.3000, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5784, stage1_s: 0.5636, stage1_m: 0.3140, stage1_l: 0.0162, stage1_h: 0.0000, loss: 0.0252, grad_norm: 1.8511
2024-10-16 06:08:03,307 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:22, time: 0.685, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0210, stage0_bag_acc: 98.0167, stage0_mean_ious: 0.4888, stage0_s: 0.4292, stage0_m: 0.3694, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0078, stage1_bag_acc: 97.5667, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5928, stage1_s: 0.5766, stage1_m: 0.3729, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0337, grad_norm: 2.9546
2024-10-16 06:08:23,164 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 06:09:38,209 - mmdet - INFO - Evaluating bbox...
2024-10-16 06:09:38,667 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2117
2024-10-16 06:09:38,668 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6786
2024-10-16 06:09:38,668 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3935
2024-10-16 06:09:38,668 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1467
2024-10-16 06:09:38,668 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0620
2024-10-16 06:09:38,668 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0201
2024-10-16 06:09:38,668 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-16 06:09:38,668 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 06:09:38,668 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2210
2024-10-16 06:09:38,669 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0677
2024-10-16 06:09:38,669 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3148
2024-10-16 06:09:38,669 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7849
2024-10-16 06:09:38,669 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3148
2024-10-16 06:09:38,669 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3148
2024-10-16 06:09:38,669 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 06:09:38,669 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3319
2024-10-16 06:09:38,669 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0898
2024-10-16 06:09:38,674 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 06:09:38,674 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2120, bbox_mAP_50: 0.6790, bbox_mAP_75: 0.3940, bbox_mAP_s: 0.1470, bbox_mAP_m: 0.0620, bbox_mAP_l: 0.0200, bbox_mAP_copypaste: 0.212 0.679 0.394 0.147 0.062 0.020
2024-10-16 06:10:56,938 - mmdet - INFO - Evaluating bbox...
2024-10-16 06:10:57,472 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2117
2024-10-16 06:10:57,472 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6786
2024-10-16 06:10:57,472 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3935
2024-10-16 06:10:57,472 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1467
2024-10-16 06:10:57,473 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0620
2024-10-16 06:10:57,473 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0201
2024-10-16 06:10:57,473 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-16 06:10:57,473 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 06:10:57,473 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2210
2024-10-16 06:10:57,473 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0677
2024-10-16 06:10:57,473 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3148
2024-10-16 06:10:57,473 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7849
2024-10-16 06:10:57,473 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3148
2024-10-16 06:10:57,473 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3148
2024-10-16 06:10:57,473 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 06:10:57,474 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3319
2024-10-16 06:10:57,474 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0898
2024-10-16 06:10:58,707 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+2fd3e4b
------------------------------------------------------------

2024-10-16 06:10:59,542 - mmdet - INFO - Distributed training: False
2024-10-16 06:11:00,374 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-16 06:11:01,460 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 06:11:01,460 - mmdet - INFO - Use load_from_local loader
2024-10-16 06:11:01,834 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 06:11:01,847 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 06:11:01,847 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 06:11:52,261 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:55:37, time: 1.008, data_time: 0.060, memory: 7817, stage0_loss_instance_mil: 0.7218, stage0_bag_acc: 13.8167, stage0_mean_ious: 0.0538, stage0_s: 0.0427, stage0_m: 0.0464, stage0_l: 0.0057, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1560, stage1_bag_acc: 16.1000, stage1_neg_loss: 0.0009, stage1_mean_ious: 0.0588, stage1_s: 0.0457, stage1_m: 0.0524, stage1_l: 0.0048, stage1_h: 0.0000, loss: 0.8787, grad_norm: 5.6716
2024-10-16 06:12:38,028 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:52:15, time: 0.915, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.7156, stage0_bag_acc: 13.7913, stage0_mean_ious: 0.0716, stage0_s: 0.0579, stage0_m: 0.0683, stage0_l: 0.0022, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1550, stage1_bag_acc: 13.7020, stage1_neg_loss: 0.0014, stage1_mean_ious: 0.0756, stage1_s: 0.0637, stage1_m: 0.0624, stage1_l: 0.0039, stage1_h: 0.0000, loss: 0.8721, grad_norm: 6.2687
2024-10-16 06:13:26,443 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:51:34, time: 0.968, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.6865, stage0_bag_acc: 18.4177, stage0_mean_ious: 0.0950, stage0_s: 0.0845, stage0_m: 0.0781, stage0_l: 0.0008, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1592, stage1_bag_acc: 14.8802, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.0951, stage1_s: 0.0867, stage1_m: 0.0743, stage1_l: 0.0012, stage1_h: 0.0000, loss: 0.8495, grad_norm: 8.1895
2024-10-16 06:14:12,609 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:50:13, time: 0.923, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.6634, stage0_bag_acc: 27.1829, stage0_mean_ious: 0.1558, stage0_s: 0.1260, stage0_m: 0.1683, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1352, stage1_bag_acc: 39.7712, stage1_neg_loss: 0.0145, stage1_mean_ious: 0.1488, stage1_s: 0.1212, stage1_m: 0.1638, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8131, grad_norm: 11.4023
2024-10-16 06:15:00,701 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:49:31, time: 0.962, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.6139, stage0_bag_acc: 29.0825, stage0_mean_ious: 0.1841, stage0_s: 0.1437, stage0_m: 0.1761, stage0_l: 0.0076, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1299, stage1_bag_acc: 45.1794, stage1_neg_loss: 0.0230, stage1_mean_ious: 0.2027, stage1_s: 0.1576, stage1_m: 0.1892, stage1_l: 0.0116, stage1_h: 0.0000, loss: 0.7668, grad_norm: 11.1240
2024-10-16 06:15:29,651 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 06:16:20,259 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:43:57, time: 0.968, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.4909, stage0_bag_acc: 50.0332, stage0_mean_ious: 0.3295, stage0_s: 0.2623, stage0_m: 0.2201, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0972, stage1_bag_acc: 50.9387, stage1_neg_loss: 0.0185, stage1_mean_ious: 0.4125, stage1_s: 0.3470, stage1_m: 0.2513, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.6066, grad_norm: 11.8720
2024-10-16 06:17:06,655 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:43:36, time: 0.928, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.4113, stage0_bag_acc: 56.7989, stage0_mean_ious: 0.3693, stage0_s: 0.2646, stage0_m: 0.3593, stage0_l: 0.0265, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0811, stage1_bag_acc: 57.3338, stage1_neg_loss: 0.0168, stage1_mean_ious: 0.4470, stage1_s: 0.3601, stage1_m: 0.3786, stage1_l: 0.0255, stage1_h: 0.0000, loss: 0.5091, grad_norm: 12.7490
2024-10-16 06:17:54,521 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:43:19, time: 0.957, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.3335, stage0_bag_acc: 66.5387, stage0_mean_ious: 0.4052, stage0_s: 0.3481, stage0_m: 0.3373, stage0_l: 0.0309, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0732, stage1_bag_acc: 72.6481, stage1_neg_loss: 0.0148, stage1_mean_ious: 0.5016, stage1_s: 0.4763, stage1_m: 0.3536, stage1_l: 0.0272, stage1_h: 0.0000, loss: 0.4215, grad_norm: 13.0428
2024-10-16 06:18:40,510 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:42:44, time: 0.920, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.2918, stage0_bag_acc: 73.7833, stage0_mean_ious: 0.4026, stage0_s: 0.3599, stage0_m: 0.2838, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0741, stage1_bag_acc: 73.7365, stage1_neg_loss: 0.0166, stage1_mean_ious: 0.5073, stage1_s: 0.4701, stage1_m: 0.3196, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.3825, grad_norm: 12.3839
2024-10-16 06:19:28,923 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:42:21, time: 0.968, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1943, stage0_bag_acc: 83.0124, stage0_mean_ious: 0.4316, stage0_s: 0.3874, stage0_m: 0.3612, stage0_l: 0.0193, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0671, stage1_bag_acc: 85.0507, stage1_neg_loss: 0.0205, stage1_mean_ious: 0.5478, stage1_s: 0.5297, stage1_m: 0.4048, stage1_l: 0.0169, stage1_h: 0.0000, loss: 0.2819, grad_norm: 12.9581
2024-10-16 06:19:56,684 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 06:20:43,840 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:39:08, time: 0.899, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.1411, stage0_bag_acc: 87.8864, stage0_mean_ious: 0.4521, stage0_s: 0.3959, stage0_m: 0.2881, stage0_l: 0.0369, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0515, stage1_bag_acc: 87.5348, stage1_neg_loss: 0.0164, stage1_mean_ious: 0.5642, stage1_s: 0.5350, stage1_m: 0.3042, stage1_l: 0.0295, stage1_h: 0.0000, loss: 0.2090, grad_norm: 9.0094
2024-10-16 06:21:21,354 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:38:04, time: 0.750, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1278, stage0_bag_acc: 88.7436, stage0_mean_ious: 0.5000, stage0_s: 0.4656, stage0_m: 0.3713, stage0_l: 0.0091, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0300, stage1_bag_acc: 92.7881, stage1_neg_loss: 0.0074, stage1_mean_ious: 0.6005, stage1_s: 0.5965, stage1_m: 0.3885, stage1_l: 0.0090, stage1_h: 0.0000, loss: 0.1652, grad_norm: 8.5830
2024-10-16 06:21:56,838 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:36:56, time: 0.710, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1105, stage0_bag_acc: 90.6286, stage0_mean_ious: 0.4676, stage0_s: 0.4250, stage0_m: 0.3079, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0290, stage1_bag_acc: 92.8810, stage1_neg_loss: 0.0110, stage1_mean_ious: 0.5663, stage1_s: 0.5635, stage1_m: 0.2877, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1506, grad_norm: 6.7347
2024-10-16 06:22:32,345 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:35:53, time: 0.710, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0952, stage0_bag_acc: 90.9061, stage0_mean_ious: 0.4966, stage0_s: 0.4387, stage0_m: 0.3698, stage0_l: 0.0192, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0345, stage1_bag_acc: 92.9045, stage1_neg_loss: 0.0172, stage1_mean_ious: 0.5847, stage1_s: 0.5697, stage1_m: 0.3525, stage1_l: 0.0164, stage1_h: 0.0000, loss: 0.1469, grad_norm: 6.9982
2024-10-16 06:23:08,918 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:34:56, time: 0.731, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1230, stage0_bag_acc: 90.7490, stage0_mean_ious: 0.4805, stage0_s: 0.4291, stage0_m: 0.3890, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0325, stage1_bag_acc: 90.7990, stage1_neg_loss: 0.0177, stage1_mean_ious: 0.6041, stage1_s: 0.5871, stage1_m: 0.4020, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1732, grad_norm: 7.5254
2024-10-16 06:23:31,816 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 06:24:50,619 - mmdet - INFO - Evaluating bbox...
2024-10-16 06:24:51,079 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2352
2024-10-16 06:24:51,080 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7161
2024-10-16 06:24:51,080 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4351
2024-10-16 06:24:51,080 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1726
2024-10-16 06:24:51,080 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0905
2024-10-16 06:24:51,080 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0352
2024-10-16 06:24:51,080 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0004
2024-10-16 06:24:51,080 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 06:24:51,080 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2476
2024-10-16 06:24:51,080 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0877
2024-10-16 06:24:51,080 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3394
2024-10-16 06:24:51,081 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8052
2024-10-16 06:24:51,081 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3394
2024-10-16 06:24:51,081 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3394
2024-10-16 06:24:51,081 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 06:24:51,081 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3595
2024-10-16 06:24:51,081 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0956
2024-10-16 06:24:51,086 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 06:24:51,086 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2350, bbox_mAP_50: 0.7160, bbox_mAP_75: 0.4350, bbox_mAP_s: 0.1730, bbox_mAP_m: 0.0900, bbox_mAP_l: 0.0350, bbox_mAP_copypaste: 0.235 0.716 0.435 0.173 0.090 0.035
2024-10-16 06:25:40,427 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:33:05, time: 0.986, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0791, stage0_bag_acc: 93.5714, stage0_mean_ious: 0.4759, stage0_s: 0.4228, stage0_m: 0.3403, stage0_l: 0.0070, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0235, stage1_bag_acc: 94.1492, stage1_neg_loss: 0.0093, stage1_mean_ious: 0.5846, stage1_s: 0.5673, stage1_m: 0.3491, stage1_l: 0.0047, stage1_h: 0.0000, loss: 0.1119, grad_norm: 5.7814
2024-10-16 06:26:28,077 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:32:44, time: 0.953, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0640, stage0_bag_acc: 95.3626, stage0_mean_ious: 0.4973, stage0_s: 0.4264, stage0_m: 0.4657, stage0_l: 0.0164, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0199, stage1_bag_acc: 95.4960, stage1_neg_loss: 0.0098, stage1_mean_ious: 0.5878, stage1_s: 0.5687, stage1_m: 0.4707, stage1_l: 0.0132, stage1_h: 0.0000, loss: 0.0937, grad_norm: 5.3462
2024-10-16 06:27:14,252 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:32:16, time: 0.923, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0939, stage0_bag_acc: 93.0555, stage0_mean_ious: 0.4347, stage0_s: 0.3991, stage0_m: 0.2451, stage0_l: 0.0089, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0251, stage1_bag_acc: 92.8055, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.5677, stage1_s: 0.5631, stage1_m: 0.2681, stage1_l: 0.0060, stage1_h: 0.0000, loss: 0.1262, grad_norm: 5.7953
2024-10-16 06:28:00,978 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:31:49, time: 0.935, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0501, stage0_bag_acc: 95.9333, stage0_mean_ious: 0.4952, stage0_s: 0.4506, stage0_m: 0.3941, stage0_l: 0.0237, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0202, stage1_bag_acc: 96.0015, stage1_neg_loss: 0.0088, stage1_mean_ious: 0.6076, stage1_s: 0.6098, stage1_m: 0.3773, stage1_l: 0.0188, stage1_h: 0.0000, loss: 0.0791, grad_norm: 4.7560
2024-10-16 06:28:48,201 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:31:20, time: 0.944, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0697, stage0_bag_acc: 93.7444, stage0_mean_ious: 0.4911, stage0_s: 0.4432, stage0_m: 0.3212, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0238, stage1_bag_acc: 94.1643, stage1_neg_loss: 0.0067, stage1_mean_ious: 0.5952, stage1_s: 0.5690, stage1_m: 0.3352, stage1_l: 0.0087, stage1_h: 0.0000, loss: 0.1002, grad_norm: 5.6949
2024-10-16 06:29:16,335 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 06:30:06,361 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:29:39, time: 0.957, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0483, stage0_bag_acc: 96.8167, stage0_mean_ious: 0.4937, stage0_s: 0.4471, stage0_m: 0.3033, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0191, stage1_bag_acc: 96.4167, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5989, stage1_s: 0.5734, stage1_m: 0.3082, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0746, grad_norm: 4.4562
2024-10-16 06:30:55,835 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:29:14, time: 0.989, data_time: 0.012, memory: 7817, stage0_loss_instance_mil: 0.0388, stage0_bag_acc: 97.2952, stage0_mean_ious: 0.4787, stage0_s: 0.4358, stage0_m: 0.3310, stage0_l: 0.0081, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0131, stage1_bag_acc: 97.4452, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5999, stage1_s: 0.5872, stage1_m: 0.3282, stage1_l: 0.0047, stage1_h: 0.0000, loss: 0.0581, grad_norm: 3.6892
2024-10-16 06:31:41,050 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:28:40, time: 0.904, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0726, stage0_bag_acc: 94.1015, stage0_mean_ious: 0.4708, stage0_s: 0.4294, stage0_m: 0.2329, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0202, stage1_bag_acc: 94.1667, stage1_neg_loss: 0.0082, stage1_mean_ious: 0.5866, stage1_s: 0.5702, stage1_m: 0.2402, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1010, grad_norm: 5.6341
2024-10-16 06:32:27,966 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:28:08, time: 0.938, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0595, stage0_bag_acc: 96.7323, stage0_mean_ious: 0.5171, stage0_s: 0.4669, stage0_m: 0.3826, stage0_l: 0.0109, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0204, stage1_bag_acc: 96.2466, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5938, stage1_s: 0.5778, stage1_m: 0.3572, stage1_l: 0.0057, stage1_h: 0.0000, loss: 0.0857, grad_norm: 4.6387
2024-10-16 06:33:13,884 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:27:33, time: 0.919, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0826, stage0_bag_acc: 94.7976, stage0_mean_ious: 0.4907, stage0_s: 0.4449, stage0_m: 0.3593, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0210, stage1_bag_acc: 94.6310, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5826, stage1_s: 0.5908, stage1_m: 0.3330, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1099, grad_norm: 5.8088
2024-10-16 06:33:42,759 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 06:34:28,351 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:25:56, time: 0.868, data_time: 0.056, memory: 7817, stage0_loss_instance_mil: 0.0390, stage0_bag_acc: 96.8672, stage0_mean_ious: 0.5060, stage0_s: 0.4781, stage0_m: 0.3108, stage0_l: 0.0066, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0132, stage1_bag_acc: 97.2672, stage1_neg_loss: 0.0094, stage1_mean_ious: 0.6106, stage1_s: 0.5926, stage1_m: 0.3214, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.0616, grad_norm: 3.7516
2024-10-16 06:35:05,955 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:25:12, time: 0.752, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0482, stage0_bag_acc: 96.5221, stage0_mean_ious: 0.4793, stage0_s: 0.4328, stage0_m: 0.2914, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0229, stage1_bag_acc: 97.3412, stage1_neg_loss: 0.0088, stage1_mean_ious: 0.5834, stage1_s: 0.5575, stage1_m: 0.2915, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0799, grad_norm: 4.8239
2024-10-16 06:35:44,723 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:24:29, time: 0.775, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0449, stage0_bag_acc: 97.2500, stage0_mean_ious: 0.5052, stage0_s: 0.4739, stage0_m: 0.3800, stage0_l: 0.0183, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0191, stage1_bag_acc: 95.9500, stage1_neg_loss: 0.0086, stage1_mean_ious: 0.6036, stage1_s: 0.6087, stage1_m: 0.3447, stage1_l: 0.0172, stage1_h: 0.0000, loss: 0.0726, grad_norm: 4.8771
2024-10-16 06:36:23,388 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:23:46, time: 0.773, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0525, stage0_bag_acc: 95.1658, stage0_mean_ious: 0.4928, stage0_s: 0.4190, stage0_m: 0.3580, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0205, stage1_bag_acc: 96.0825, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5960, stage1_s: 0.5618, stage1_m: 0.3753, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0778, grad_norm: 4.5559
2024-10-16 06:36:58,883 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:23:00, time: 0.710, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0646, stage0_bag_acc: 94.1278, stage0_mean_ious: 0.4893, stage0_s: 0.4680, stage0_m: 0.3609, stage0_l: 0.0103, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0149, stage1_bag_acc: 94.7278, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5900, stage1_s: 0.5901, stage1_m: 0.3756, stage1_l: 0.0102, stage1_h: 0.0000, loss: 0.0845, grad_norm: 4.4435
2024-10-16 06:37:23,213 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 06:38:42,116 - mmdet - INFO - Evaluating bbox...
2024-10-16 06:38:42,648 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2283
2024-10-16 06:38:42,648 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.7049
2024-10-16 06:38:42,648 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4353
2024-10-16 06:38:42,648 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1665
2024-10-16 06:38:42,649 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0755
2024-10-16 06:38:42,649 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0309
2024-10-16 06:38:42,649 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-16 06:38:42,649 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 06:38:42,649 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2406
2024-10-16 06:38:42,649 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0752
2024-10-16 06:38:42,649 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3366
2024-10-16 06:38:42,649 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8052
2024-10-16 06:38:42,649 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3366
2024-10-16 06:38:42,649 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3366
2024-10-16 06:38:42,650 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 06:38:42,650 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3572
2024-10-16 06:38:42,650 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0952
2024-10-16 06:38:42,654 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 06:38:42,654 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2280, bbox_mAP_50: 0.7050, bbox_mAP_75: 0.4350, bbox_mAP_s: 0.1670, bbox_mAP_m: 0.0760, bbox_mAP_l: 0.0310, bbox_mAP_copypaste: 0.228 0.705 0.435 0.167 0.076 0.031
2024-10-16 06:39:32,864 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:21:42, time: 1.004, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0525, stage0_bag_acc: 95.4500, stage0_mean_ious: 0.5046, stage0_s: 0.4634, stage0_m: 0.3745, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0183, stage1_bag_acc: 95.6000, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5973, stage1_s: 0.5940, stage1_m: 0.3700, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0748, grad_norm: 4.2221
2024-10-16 06:40:18,829 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:21:08, time: 0.919, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0465, stage0_bag_acc: 96.8500, stage0_mean_ious: 0.4866, stage0_s: 0.4652, stage0_m: 0.3302, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0119, stage1_bag_acc: 97.0000, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.6008, stage1_s: 0.5995, stage1_m: 0.3508, stage1_l: 0.0139, stage1_h: 0.0000, loss: 0.0646, grad_norm: 3.5615
2024-10-16 06:41:08,246 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:20:35, time: 0.988, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0414, stage0_bag_acc: 97.5182, stage0_mean_ious: 0.4978, stage0_s: 0.4556, stage0_m: 0.4297, stage0_l: 0.0066, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 97.6286, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5942, stage1_s: 0.5931, stage1_m: 0.4258, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.0539, grad_norm: 3.0581
2024-10-16 06:41:54,888 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:20:00, time: 0.933, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0408, stage0_bag_acc: 97.3833, stage0_mean_ious: 0.4896, stage0_s: 0.4443, stage0_m: 0.3634, stage0_l: 0.0061, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0172, stage1_bag_acc: 96.8000, stage1_neg_loss: 0.0096, stage1_mean_ious: 0.5726, stage1_s: 0.5467, stage1_m: 0.3760, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.0675, grad_norm: 4.0121
2024-10-16 06:42:39,997 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:19:23, time: 0.902, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0695, stage0_bag_acc: 95.8909, stage0_mean_ious: 0.4836, stage0_s: 0.4510, stage0_m: 0.2866, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0189, stage1_bag_acc: 95.0227, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5666, stage1_s: 0.5635, stage1_m: 0.2907, stage1_l: 0.0077, stage1_h: 0.0000, loss: 0.0957, grad_norm: 4.4855
2024-10-16 06:43:08,641 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 06:43:57,745 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:18:05, time: 0.939, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0478, stage0_bag_acc: 95.8609, stage0_mean_ious: 0.5028, stage0_s: 0.4525, stage0_m: 0.3571, stage0_l: 0.0158, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0242, stage1_bag_acc: 95.8784, stage1_neg_loss: 0.0116, stage1_mean_ious: 0.5775, stage1_s: 0.5554, stage1_m: 0.3455, stage1_l: 0.0144, stage1_h: 0.0000, loss: 0.0836, grad_norm: 4.4871
2024-10-16 06:44:44,865 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:17:29, time: 0.942, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0328, stage0_bag_acc: 97.2643, stage0_mean_ious: 0.4950, stage0_s: 0.4527, stage0_m: 0.3168, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0130, stage1_bag_acc: 96.5143, stage1_neg_loss: 0.0087, stage1_mean_ious: 0.6006, stage1_s: 0.5742, stage1_m: 0.3388, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0545, grad_norm: 3.7332
2024-10-16 06:45:33,591 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:16:54, time: 0.975, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0358, stage0_bag_acc: 97.1500, stage0_mean_ious: 0.5242, stage0_s: 0.4500, stage0_m: 0.4194, stage0_l: 0.0214, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0112, stage1_bag_acc: 97.4278, stage1_neg_loss: 0.0071, stage1_mean_ious: 0.5970, stage1_s: 0.5754, stage1_m: 0.4140, stage1_l: 0.0214, stage1_h: 0.0000, loss: 0.0541, grad_norm: 3.4535
2024-10-16 06:46:19,126 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:16:16, time: 0.911, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0553, stage0_bag_acc: 95.0316, stage0_mean_ious: 0.4571, stage0_s: 0.4138, stage0_m: 0.3165, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0155, stage1_bag_acc: 95.6634, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5608, stage1_s: 0.5506, stage1_m: 0.3265, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0768, grad_norm: 4.1318
2024-10-16 06:47:06,100 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:15:39, time: 0.939, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0279, stage0_bag_acc: 98.1333, stage0_mean_ious: 0.4919, stage0_s: 0.4401, stage0_m: 0.3898, stage0_l: 0.0180, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0204, stage1_bag_acc: 98.8000, stage1_neg_loss: 0.0122, stage1_mean_ious: 0.5813, stage1_s: 0.5520, stage1_m: 0.3937, stage1_l: 0.0141, stage1_h: 0.0000, loss: 0.0604, grad_norm: 4.0797
2024-10-16 06:47:33,321 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 06:48:13,467 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:14:21, time: 0.760, data_time: 0.056, memory: 7817, stage0_loss_instance_mil: 0.0229, stage0_bag_acc: 98.4102, stage0_mean_ious: 0.4937, stage0_s: 0.4459, stage0_m: 0.3141, stage0_l: 0.0321, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 98.4284, stage1_neg_loss: 0.0064, stage1_mean_ious: 0.5616, stage1_s: 0.5434, stage1_m: 0.3023, stage1_l: 0.0279, stage1_h: 0.0000, loss: 0.0387, grad_norm: 2.9063
2024-10-16 06:48:50,693 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:13:39, time: 0.744, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0131, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.5041, stage0_s: 0.4563, stage0_m: 0.3342, stage0_l: 0.0093, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0107, stage1_bag_acc: 99.0000, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5944, stage1_s: 0.5790, stage1_m: 0.3204, stage1_l: 0.0048, stage1_h: 0.0000, loss: 0.0287, grad_norm: 1.8474
2024-10-16 06:49:26,412 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:12:57, time: 0.714, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0194, stage0_bag_acc: 98.6348, stage0_mean_ious: 0.4888, stage0_s: 0.4658, stage0_m: 0.2182, stage0_l: 0.0067, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0119, stage1_bag_acc: 98.6667, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5737, stage1_s: 0.5627, stage1_m: 0.2231, stage1_l: 0.0065, stage1_h: 0.0000, loss: 0.0354, grad_norm: 2.7320
2024-10-16 06:50:03,161 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:12:16, time: 0.735, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0186, stage0_bag_acc: 98.8500, stage0_mean_ious: 0.4843, stage0_s: 0.4288, stage0_m: 0.3965, stage0_l: 0.0086, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0060, stage1_bag_acc: 99.1000, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5786, stage1_s: 0.5488, stage1_m: 0.4179, stage1_l: 0.0091, stage1_h: 0.0000, loss: 0.0276, grad_norm: 2.0809
2024-10-16 06:50:38,719 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:11:34, time: 0.711, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0199, stage0_bag_acc: 98.5000, stage0_mean_ious: 0.4968, stage0_s: 0.4446, stage0_m: 0.2857, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0094, stage1_bag_acc: 98.5667, stage1_neg_loss: 0.0099, stage1_mean_ious: 0.5871, stage1_s: 0.5483, stage1_m: 0.2900, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0392, grad_norm: 2.3480
2024-10-16 06:51:02,339 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 06:52:22,839 - mmdet - INFO - Evaluating bbox...
2024-10-16 06:52:23,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2199
2024-10-16 06:52:23,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6907
2024-10-16 06:52:23,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4121
2024-10-16 06:52:23,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1480
2024-10-16 06:52:23,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0724
2024-10-16 06:52:23,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0248
2024-10-16 06:52:23,297 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0008
2024-10-16 06:52:23,298 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 06:52:23,298 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2316
2024-10-16 06:52:23,298 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0693
2024-10-16 06:52:23,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3257
2024-10-16 06:52:23,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7960
2024-10-16 06:52:23,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3257
2024-10-16 06:52:23,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3257
2024-10-16 06:52:23,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 06:52:23,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3449
2024-10-16 06:52:23,298 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0950
2024-10-16 06:52:23,303 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 06:52:23,303 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2200, bbox_mAP_50: 0.6910, bbox_mAP_75: 0.4120, bbox_mAP_s: 0.1480, bbox_mAP_m: 0.0720, bbox_mAP_l: 0.0250, bbox_mAP_copypaste: 0.220 0.691 0.412 0.148 0.072 0.025
2024-10-16 06:53:13,203 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:10:26, time: 0.998, data_time: 0.060, memory: 7817, stage0_loss_instance_mil: 0.0192, stage0_bag_acc: 98.8500, stage0_mean_ious: 0.4938, stage0_s: 0.4617, stage0_m: 0.3567, stage0_l: 0.0100, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0093, stage1_bag_acc: 98.4278, stage1_neg_loss: 0.0055, stage1_mean_ious: 0.5741, stage1_s: 0.5720, stage1_m: 0.3623, stage1_l: 0.0109, stage1_h: 0.0000, loss: 0.0339, grad_norm: 2.3239
2024-10-16 06:54:01,255 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:09:49, time: 0.961, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0207, stage0_bag_acc: 98.8000, stage0_mean_ious: 0.4738, stage0_s: 0.4331, stage0_m: 0.3489, stage0_l: 0.0070, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0071, stage1_bag_acc: 98.7500, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5708, stage1_s: 0.5589, stage1_m: 0.3365, stage1_l: 0.0062, stage1_h: 0.0000, loss: 0.0304, grad_norm: 2.0554
2024-10-16 06:54:46,496 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:09:10, time: 0.905, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0171, stage0_bag_acc: 98.4778, stage0_mean_ious: 0.4836, stage0_s: 0.4579, stage0_m: 0.3071, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0077, stage1_bag_acc: 98.6778, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5780, stage1_s: 0.5693, stage1_m: 0.3235, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0309, grad_norm: 2.3464
2024-10-16 06:55:34,139 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:08:32, time: 0.953, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0251, stage0_bag_acc: 97.8182, stage0_mean_ious: 0.4882, stage0_s: 0.4424, stage0_m: 0.2686, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0114, stage1_bag_acc: 97.2500, stage1_neg_loss: 0.0039, stage1_mean_ious: 0.5846, stage1_s: 0.5695, stage1_m: 0.2659, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0403, grad_norm: 2.7126
2024-10-16 06:56:21,749 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:54, time: 0.952, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0140, stage0_bag_acc: 99.0000, stage0_mean_ious: 0.5234, stage0_s: 0.4904, stage0_m: 0.4089, stage0_l: 0.0107, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0066, stage1_bag_acc: 99.4000, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5898, stage1_s: 0.5897, stage1_m: 0.4047, stage1_l: 0.0142, stage1_h: 0.0000, loss: 0.0261, grad_norm: 1.9519
2024-10-16 06:56:50,436 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 06:57:41,505 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:47, time: 0.978, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0105, stage0_bag_acc: 99.8000, stage0_mean_ious: 0.4856, stage0_s: 0.4516, stage0_m: 0.2779, stage0_l: 0.0107, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0054, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.5906, stage1_s: 0.5682, stage1_m: 0.3030, stage1_l: 0.0142, stage1_h: 0.0000, loss: 0.0181, grad_norm: 1.4363
2024-10-16 06:58:27,437 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:06:08, time: 0.919, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0276, stage0_bag_acc: 98.1626, stage0_mean_ious: 0.4867, stage0_s: 0.4524, stage0_m: 0.2961, stage0_l: 0.0175, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0135, stage1_bag_acc: 97.1944, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5622, stage1_s: 0.5448, stage1_m: 0.2895, stage1_l: 0.0154, stage1_h: 0.0000, loss: 0.0447, grad_norm: 3.2626
2024-10-16 06:59:12,820 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:28, time: 0.908, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0147, stage0_bag_acc: 98.8000, stage0_mean_ious: 0.4880, stage0_s: 0.4699, stage0_m: 0.2575, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0084, stage1_bag_acc: 98.8000, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5882, stage1_s: 0.5804, stage1_m: 0.2677, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0288, grad_norm: 2.3776
2024-10-16 06:59:59,748 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 06:59:59,748 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:49, time: 0.939, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0126, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.5184, stage0_s: 0.4653, stage0_m: 0.3666, stage0_l: 0.0163, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0079, stage1_bag_acc: 97.8500, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5861, stage1_s: 0.5667, stage1_m: 0.3689, stage1_l: 0.0169, stage1_h: 0.0000, loss: 0.0253, grad_norm: 2.0872
2024-10-16 07:00:45,917 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:04:10, time: 0.923, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0180, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.4869, stage0_s: 0.4544, stage0_m: 0.3420, stage0_l: 0.0059, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0085, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5767, stage1_s: 0.5685, stage1_m: 0.3411, stage1_l: 0.0043, stage1_h: 0.0000, loss: 0.0312, grad_norm: 1.9743
2024-10-16 07:01:12,927 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 07:01:54,639 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:03:03, time: 0.790, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0175, stage0_bag_acc: 98.6737, stage0_mean_ious: 0.5012, stage0_s: 0.4471, stage0_m: 0.3930, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0077, stage1_bag_acc: 99.0778, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.5563, stage1_s: 0.5421, stage1_m: 0.3722, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0275, grad_norm: 1.9850
2024-10-16 07:02:30,245 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:23, time: 0.712, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0360, stage0_bag_acc: 98.0778, stage0_mean_ious: 0.4868, stage0_s: 0.4566, stage0_m: 0.3253, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0078, stage1_bag_acc: 97.7000, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5772, stage1_s: 0.5697, stage1_m: 0.3246, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0468, grad_norm: 2.6451
2024-10-16 07:03:06,708 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:43, time: 0.729, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0176, stage0_bag_acc: 97.9167, stage0_mean_ious: 0.4818, stage0_s: 0.4567, stage0_m: 0.3242, stage0_l: 0.0180, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0077, stage1_bag_acc: 97.8667, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5709, stage1_s: 0.5722, stage1_m: 0.3330, stage1_l: 0.0180, stage1_h: 0.0000, loss: 0.0275, grad_norm: 2.0358
2024-10-16 07:03:43,527 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:01:03, time: 0.736, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0142, stage0_bag_acc: 99.1182, stage0_mean_ious: 0.4834, stage0_s: 0.4223, stage0_m: 0.3222, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0057, stage1_bag_acc: 98.8682, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.5832, stage1_s: 0.5498, stage1_m: 0.3442, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0272, grad_norm: 2.2121
2024-10-16 07:04:20,059 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:23, time: 0.731, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0091, stage0_bag_acc: 99.5500, stage0_mean_ious: 0.5239, stage0_s: 0.4598, stage0_m: 0.3578, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0058, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5930, stage1_s: 0.5608, stage1_m: 0.3510, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0180, grad_norm: 1.6292
2024-10-16 07:04:47,689 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 07:06:07,836 - mmdet - INFO - Evaluating bbox...
2024-10-16 07:06:08,376 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2201
2024-10-16 07:06:08,376 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6878
2024-10-16 07:06:08,377 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4176
2024-10-16 07:06:08,377 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1486
2024-10-16 07:06:08,377 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0738
2024-10-16 07:06:08,377 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0248
2024-10-16 07:06:08,377 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-16 07:06:08,377 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 07:06:08,377 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2320
2024-10-16 07:06:08,377 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0717
2024-10-16 07:06:08,377 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3244
2024-10-16 07:06:08,377 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7904
2024-10-16 07:06:08,378 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3244
2024-10-16 07:06:08,378 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3244
2024-10-16 07:06:08,378 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 07:06:08,378 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3434
2024-10-16 07:06:08,378 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0948
2024-10-16 07:06:08,382 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 07:06:08,382 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2200, bbox_mAP_50: 0.6880, bbox_mAP_75: 0.4180, bbox_mAP_s: 0.1490, bbox_mAP_m: 0.0740, bbox_mAP_l: 0.0250, bbox_mAP_copypaste: 0.220 0.688 0.418 0.149 0.074 0.025
2024-10-16 07:07:28,494 - mmdet - INFO - Evaluating bbox...
2024-10-16 07:07:28,961 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2201
2024-10-16 07:07:28,961 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6878
2024-10-16 07:07:28,961 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4176
2024-10-16 07:07:28,961 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1486
2024-10-16 07:07:28,961 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0738
2024-10-16 07:07:28,961 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0248
2024-10-16 07:07:28,961 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0007
2024-10-16 07:07:28,962 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 07:07:28,962 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2320
2024-10-16 07:07:28,962 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0717
2024-10-16 07:07:28,962 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3244
2024-10-16 07:07:28,962 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7904
2024-10-16 07:07:28,962 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3244
2024-10-16 07:07:28,962 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3244
2024-10-16 07:07:28,962 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 07:07:28,962 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3434
2024-10-16 07:07:28,962 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0948
2024-10-16 07:07:30,150 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+2fd3e4b
------------------------------------------------------------

2024-10-16 07:07:30,987 - mmdet - INFO - Distributed training: False
2024-10-16 07:07:31,884 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-16 07:07:32,970 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 07:07:32,970 - mmdet - INFO - Use load_from_local loader
2024-10-16 07:07:33,311 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 07:07:33,325 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 07:07:33,326 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 07:08:23,590 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:55:26, time: 1.005, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.7023, stage0_bag_acc: 16.5197, stage0_mean_ious: 0.0943, stage0_s: 0.0614, stage0_m: 0.1253, stage0_l: 0.0125, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1723, stage1_bag_acc: 25.2632, stage1_neg_loss: 0.0006, stage1_mean_ious: 0.1028, stage1_s: 0.0673, stage1_m: 0.1372, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.8752, grad_norm: 5.6533
2024-10-16 07:09:11,352 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:53:15, time: 0.955, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.6862, stage0_bag_acc: 16.8857, stage0_mean_ious: 0.0876, stage0_s: 0.0627, stage0_m: 0.0971, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1779, stage1_bag_acc: 21.3833, stage1_neg_loss: 0.0010, stage1_mean_ious: 0.0911, stage1_s: 0.0663, stage1_m: 0.0980, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8651, grad_norm: 6.7483
2024-10-16 07:09:57,798 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:51:31, time: 0.929, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.6833, stage0_bag_acc: 15.5405, stage0_mean_ious: 0.0915, stage0_s: 0.0768, stage0_m: 0.0921, stage0_l: 0.0002, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1687, stage1_bag_acc: 21.8175, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.0965, stage1_s: 0.0824, stage1_m: 0.0915, stage1_l: 0.0002, stage1_h: 0.0000, loss: 0.8541, grad_norm: 8.0982
2024-10-16 07:10:44,986 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:50:28, time: 0.944, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.6447, stage0_bag_acc: 23.7693, stage0_mean_ious: 0.1257, stage0_s: 0.1199, stage0_m: 0.0900, stage0_l: 0.0144, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1643, stage1_bag_acc: 26.1984, stage1_neg_loss: 0.0128, stage1_mean_ious: 0.1302, stage1_s: 0.1277, stage1_m: 0.0881, stage1_l: 0.0097, stage1_h: 0.0000, loss: 0.8218, grad_norm: 10.5989
2024-10-16 07:11:31,689 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:49:25, time: 0.934, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.5697, stage0_bag_acc: 39.1742, stage0_mean_ious: 0.1565, stage0_s: 0.1442, stage0_m: 0.0951, stage0_l: 0.0270, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1403, stage1_bag_acc: 42.2965, stage1_neg_loss: 0.0223, stage1_mean_ious: 0.1788, stage1_s: 0.1751, stage1_m: 0.0996, stage1_l: 0.0164, stage1_h: 0.0000, loss: 0.7323, grad_norm: 12.2191
2024-10-16 07:12:01,518 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 07:12:54,465 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:44:14, time: 1.015, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.4876, stage0_bag_acc: 52.2696, stage0_mean_ious: 0.2019, stage0_s: 0.1720, stage0_m: 0.1410, stage0_l: 0.0123, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1286, stage1_bag_acc: 43.4095, stage1_neg_loss: 0.0208, stage1_mean_ious: 0.2552, stage1_s: 0.2392, stage1_m: 0.1459, stage1_l: 0.0081, stage1_h: 0.0000, loss: 0.6370, grad_norm: 12.4504
2024-10-16 07:13:45,165 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:44:24, time: 1.014, data_time: 0.011, memory: 7817, stage0_loss_instance_mil: 0.4741, stage0_bag_acc: 49.3056, stage0_mean_ious: 0.2929, stage0_s: 0.2339, stage0_m: 0.2258, stage0_l: 0.0378, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0980, stage1_bag_acc: 54.4214, stage1_neg_loss: 0.0207, stage1_mean_ious: 0.3529, stage1_s: 0.3027, stage1_m: 0.2466, stage1_l: 0.0391, stage1_h: 0.0000, loss: 0.5928, grad_norm: 12.7294
2024-10-16 07:14:33,754 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:44:06, time: 0.972, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.4132, stage0_bag_acc: 61.0284, stage0_mean_ious: 0.3334, stage0_s: 0.2789, stage0_m: 0.3070, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0898, stage1_bag_acc: 69.7675, stage1_neg_loss: 0.0212, stage1_mean_ious: 0.3947, stage1_s: 0.3480, stage1_m: 0.3341, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5242, grad_norm: 13.0414
2024-10-16 07:15:15,309 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:42:59, time: 0.831, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.3122, stage0_bag_acc: 75.5864, stage0_mean_ious: 0.3955, stage0_s: 0.3445, stage0_m: 0.3033, stage0_l: 0.0291, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0777, stage1_bag_acc: 74.3682, stage1_neg_loss: 0.0242, stage1_mean_ious: 0.4693, stage1_s: 0.4456, stage1_m: 0.3014, stage1_l: 0.0258, stage1_h: 0.0000, loss: 0.4141, grad_norm: 11.4115
2024-10-16 07:15:51,586 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:41:29, time: 0.726, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.2246, stage0_bag_acc: 81.3131, stage0_mean_ious: 0.4237, stage0_s: 0.3625, stage0_m: 0.3020, stage0_l: 0.0207, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0921, stage1_bag_acc: 83.0444, stage1_neg_loss: 0.0304, stage1_mean_ious: 0.4889, stage1_s: 0.4548, stage1_m: 0.3156, stage1_l: 0.0147, stage1_h: 0.0000, loss: 0.3470, grad_norm: 12.3556
2024-10-16 07:16:15,164 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 07:16:56,543 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:37:58, time: 0.783, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.1440, stage0_bag_acc: 88.7293, stage0_mean_ious: 0.4695, stage0_s: 0.4369, stage0_m: 0.3296, stage0_l: 0.0254, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0456, stage1_bag_acc: 89.8032, stage1_neg_loss: 0.0114, stage1_mean_ious: 0.5451, stage1_s: 0.5446, stage1_m: 0.3327, stage1_l: 0.0184, stage1_h: 0.0000, loss: 0.2010, grad_norm: 8.0421
2024-10-16 07:17:35,082 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:37:05, time: 0.771, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.1304, stage0_bag_acc: 89.9278, stage0_mean_ious: 0.4506, stage0_s: 0.3564, stage0_m: 0.4195, stage0_l: 0.0159, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0378, stage1_bag_acc: 91.6611, stage1_neg_loss: 0.0125, stage1_mean_ious: 0.5216, stage1_s: 0.4576, stage1_m: 0.4194, stage1_l: 0.0120, stage1_h: 0.0000, loss: 0.1808, grad_norm: 7.0160
2024-10-16 07:18:13,604 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:36:13, time: 0.770, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0708, stage0_bag_acc: 93.8055, stage0_mean_ious: 0.4585, stage0_s: 0.3902, stage0_m: 0.4892, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0307, stage1_bag_acc: 95.6238, stage1_neg_loss: 0.0125, stage1_mean_ious: 0.5719, stage1_s: 0.5259, stage1_m: 0.5390, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1139, grad_norm: 5.8395
2024-10-16 07:18:59,786 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:35:50, time: 0.924, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1307, stage0_bag_acc: 90.3877, stage0_mean_ious: 0.4380, stage0_s: 0.4028, stage0_m: 0.2645, stage0_l: 0.0202, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0319, stage1_bag_acc: 90.5861, stage1_neg_loss: 0.0116, stage1_mean_ious: 0.5225, stage1_s: 0.5087, stage1_m: 0.2654, stage1_l: 0.0174, stage1_h: 0.0000, loss: 0.1742, grad_norm: 6.8185
2024-10-16 07:19:47,999 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:35:30, time: 0.964, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0968, stage0_bag_acc: 92.5333, stage0_mean_ious: 0.4799, stage0_s: 0.4450, stage0_m: 0.3580, stage0_l: 0.0158, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0360, stage1_bag_acc: 92.5341, stage1_neg_loss: 0.0176, stage1_mean_ious: 0.5504, stage1_s: 0.5253, stage1_m: 0.3775, stage1_l: 0.0158, stage1_h: 0.0000, loss: 0.1505, grad_norm: 6.4091
2024-10-16 07:20:16,620 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 07:21:37,213 - mmdet - INFO - Evaluating bbox...
2024-10-16 07:21:37,689 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2126
2024-10-16 07:21:37,689 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6811
2024-10-16 07:21:37,689 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4120
2024-10-16 07:21:37,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1335
2024-10-16 07:21:37,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0644
2024-10-16 07:21:37,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0223
2024-10-16 07:21:37,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0006
2024-10-16 07:21:37,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 07:21:37,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2233
2024-10-16 07:21:37,690 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0685
2024-10-16 07:21:37,690 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3129
2024-10-16 07:21:37,690 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7759
2024-10-16 07:21:37,690 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3129
2024-10-16 07:21:37,690 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3129
2024-10-16 07:21:37,691 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 07:21:37,691 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3309
2024-10-16 07:21:37,691 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0984
2024-10-16 07:21:37,696 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 07:21:37,696 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2130, bbox_mAP_50: 0.6810, bbox_mAP_75: 0.4120, bbox_mAP_s: 0.1340, bbox_mAP_m: 0.0640, bbox_mAP_l: 0.0220, bbox_mAP_copypaste: 0.213 0.681 0.412 0.134 0.064 0.022
2024-10-16 07:22:30,086 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:33:43, time: 1.048, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0800, stage0_bag_acc: 92.6547, stage0_mean_ious: 0.4718, stage0_s: 0.4074, stage0_m: 0.3500, stage0_l: 0.0287, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0336, stage1_bag_acc: 94.2944, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.5491, stage1_s: 0.5140, stage1_m: 0.3630, stage1_l: 0.0213, stage1_h: 0.0000, loss: 0.1220, grad_norm: 6.6911
2024-10-16 07:23:15,761 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:33:14, time: 0.914, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0795, stage0_bag_acc: 94.6006, stage0_mean_ious: 0.4692, stage0_s: 0.4347, stage0_m: 0.2861, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0298, stage1_bag_acc: 95.4325, stage1_neg_loss: 0.0123, stage1_mean_ious: 0.5636, stage1_s: 0.5383, stage1_m: 0.3213, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.1217, grad_norm: 5.8405
2024-10-16 07:24:04,198 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:32:50, time: 0.969, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1001, stage0_bag_acc: 92.5619, stage0_mean_ious: 0.4727, stage0_s: 0.4108, stage0_m: 0.3578, stage0_l: 0.0167, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0324, stage1_bag_acc: 93.0786, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5400, stage1_s: 0.5114, stage1_m: 0.3411, stage1_l: 0.0113, stage1_h: 0.0000, loss: 0.1405, grad_norm: 5.9864
2024-10-16 07:24:52,102 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:32:23, time: 0.958, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0644, stage0_bag_acc: 95.4045, stage0_mean_ious: 0.4828, stage0_s: 0.4362, stage0_m: 0.3251, stage0_l: 0.0187, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0240, stage1_bag_acc: 94.9894, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.5614, stage1_s: 0.5365, stage1_m: 0.3321, stage1_l: 0.0205, stage1_h: 0.0000, loss: 0.0968, grad_norm: 4.5910
2024-10-16 07:25:39,322 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:31:52, time: 0.944, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0740, stage0_bag_acc: 93.6682, stage0_mean_ious: 0.4602, stage0_s: 0.4278, stage0_m: 0.3065, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0208, stage1_bag_acc: 94.9182, stage1_neg_loss: 0.0075, stage1_mean_ious: 0.5643, stage1_s: 0.5531, stage1_m: 0.3241, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1023, grad_norm: 5.5995
2024-10-16 07:26:07,539 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 07:27:00,792 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:30:14, time: 1.021, data_time: 0.056, memory: 7817, stage0_loss_instance_mil: 0.0776, stage0_bag_acc: 94.4810, stage0_mean_ious: 0.4730, stage0_s: 0.4279, stage0_m: 0.3872, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0279, stage1_bag_acc: 94.8952, stage1_neg_loss: 0.0099, stage1_mean_ious: 0.5627, stage1_s: 0.5347, stage1_m: 0.3853, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1153, grad_norm: 5.1028
2024-10-16 07:27:48,094 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:29:43, time: 0.946, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0618, stage0_bag_acc: 96.2515, stage0_mean_ious: 0.4949, stage0_s: 0.4462, stage0_m: 0.3454, stage0_l: 0.0088, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0221, stage1_bag_acc: 96.0500, stage1_neg_loss: 0.0081, stage1_mean_ious: 0.5673, stage1_s: 0.5530, stage1_m: 0.3408, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.0920, grad_norm: 4.5257
2024-10-16 07:28:32,598 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:29:06, time: 0.890, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0713, stage0_bag_acc: 96.6167, stage0_mean_ious: 0.4987, stage0_s: 0.4574, stage0_m: 0.3302, stage0_l: 0.0118, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0153, stage1_bag_acc: 96.8167, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5694, stage1_s: 0.5623, stage1_m: 0.3374, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.0927, grad_norm: 4.5161
2024-10-16 07:29:08,345 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:28:15, time: 0.715, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0571, stage0_bag_acc: 96.4333, stage0_mean_ious: 0.4693, stage0_s: 0.4429, stage0_m: 0.2158, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0191, stage1_bag_acc: 96.2333, stage1_neg_loss: 0.0062, stage1_mean_ious: 0.5618, stage1_s: 0.5527, stage1_m: 0.2213, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0824, grad_norm: 4.4505
2024-10-16 07:29:44,804 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:27:26, time: 0.729, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0608, stage0_bag_acc: 95.2421, stage0_mean_ious: 0.4872, stage0_s: 0.4631, stage0_m: 0.3427, stage0_l: 0.0110, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0180, stage1_bag_acc: 95.5810, stage1_neg_loss: 0.0110, stage1_mean_ious: 0.5668, stage1_s: 0.5606, stage1_m: 0.3345, stage1_l: 0.0088, stage1_h: 0.0000, loss: 0.0899, grad_norm: 4.3713
2024-10-16 07:30:06,083 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 07:30:47,002 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:25:44, time: 0.773, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0615, stage0_bag_acc: 95.9810, stage0_mean_ious: 0.4640, stage0_s: 0.4275, stage0_m: 0.2940, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0175, stage1_bag_acc: 95.4810, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5542, stage1_s: 0.5387, stage1_m: 0.3097, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0851, grad_norm: 3.9188
2024-10-16 07:31:23,515 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:24:58, time: 0.730, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0395, stage0_bag_acc: 97.4000, stage0_mean_ious: 0.4790, stage0_s: 0.4421, stage0_m: 0.3077, stage0_l: 0.0067, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0153, stage1_bag_acc: 97.8500, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5686, stage1_s: 0.5569, stage1_m: 0.3194, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.0611, grad_norm: 3.0204
2024-10-16 07:32:06,951 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:24:22, time: 0.869, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0364, stage0_bag_acc: 97.0000, stage0_mean_ious: 0.4923, stage0_s: 0.4251, stage0_m: 0.2902, stage0_l: 0.0070, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0170, stage1_bag_acc: 97.8333, stage1_neg_loss: 0.0083, stage1_mean_ious: 0.5617, stage1_s: 0.5252, stage1_m: 0.2736, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.0616, grad_norm: 3.7366
2024-10-16 07:32:55,444 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:23:50, time: 0.970, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0795, stage0_bag_acc: 94.1722, stage0_mean_ious: 0.4796, stage0_s: 0.4363, stage0_m: 0.3823, stage0_l: 0.0317, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0172, stage1_bag_acc: 95.7222, stage1_neg_loss: 0.0070, stage1_mean_ious: 0.5723, stage1_s: 0.5686, stage1_m: 0.3774, stage1_l: 0.0331, stage1_h: 0.0000, loss: 0.1037, grad_norm: 5.2446
2024-10-16 07:33:42,009 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:23:16, time: 0.931, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0593, stage0_bag_acc: 95.5920, stage0_mean_ious: 0.4960, stage0_s: 0.4293, stage0_m: 0.3600, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0176, stage1_bag_acc: 96.1277, stage1_neg_loss: 0.0061, stage1_mean_ious: 0.5704, stage1_s: 0.5318, stage1_m: 0.3577, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0830, grad_norm: 4.4237
2024-10-16 07:34:10,427 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 07:35:30,889 - mmdet - INFO - Evaluating bbox...
2024-10-16 07:35:31,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2024
2024-10-16 07:35:31,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6770
2024-10-16 07:35:31,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3878
2024-10-16 07:35:31,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1152
2024-10-16 07:35:31,371 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0508
2024-10-16 07:35:31,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0181
2024-10-16 07:35:31,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 07:35:31,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 07:35:31,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2125
2024-10-16 07:35:31,372 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0677
2024-10-16 07:35:31,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3078
2024-10-16 07:35:31,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7888
2024-10-16 07:35:31,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3078
2024-10-16 07:35:31,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3078
2024-10-16 07:35:31,372 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 07:35:31,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3259
2024-10-16 07:35:31,373 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0843
2024-10-16 07:35:31,378 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 07:35:31,379 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2020, bbox_mAP_50: 0.6770, bbox_mAP_75: 0.3880, bbox_mAP_s: 0.1150, bbox_mAP_m: 0.0510, bbox_mAP_l: 0.0180, bbox_mAP_copypaste: 0.202 0.677 0.388 0.115 0.051 0.018
2024-10-16 07:36:22,484 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:21:57, time: 1.022, data_time: 0.062, memory: 7817, stage0_loss_instance_mil: 0.0270, stage0_bag_acc: 97.4929, stage0_mean_ious: 0.4615, stage0_s: 0.4134, stage0_m: 0.2932, stage0_l: 0.0077, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0119, stage1_bag_acc: 98.3143, stage1_neg_loss: 0.0089, stage1_mean_ious: 0.5690, stage1_s: 0.5404, stage1_m: 0.2938, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0479, grad_norm: 3.0726
2024-10-16 07:37:08,685 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:21:22, time: 0.924, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0476, stage0_bag_acc: 96.7000, stage0_mean_ious: 0.5210, stage0_s: 0.4700, stage0_m: 0.3880, stage0_l: 0.0145, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0124, stage1_bag_acc: 96.4143, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5855, stage1_s: 0.5610, stage1_m: 0.3707, stage1_l: 0.0115, stage1_h: 0.0000, loss: 0.0660, grad_norm: 4.0644
2024-10-16 07:37:52,985 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:20:44, time: 0.886, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0483, stage0_bag_acc: 96.4173, stage0_mean_ious: 0.4883, stage0_s: 0.4536, stage0_m: 0.2724, stage0_l: 0.0067, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0097, stage1_bag_acc: 96.8991, stage1_neg_loss: 0.0087, stage1_mean_ious: 0.5675, stage1_s: 0.5512, stage1_m: 0.2544, stage1_l: 0.0067, stage1_h: 0.0000, loss: 0.0667, grad_norm: 3.3616
2024-10-16 07:38:39,869 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:20:08, time: 0.938, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0675, stage0_bag_acc: 93.7379, stage0_mean_ious: 0.4785, stage0_s: 0.4363, stage0_m: 0.3135, stage0_l: 0.0219, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0167, stage1_bag_acc: 94.7561, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.5434, stage1_s: 0.5392, stage1_m: 0.3129, stage1_l: 0.0170, stage1_h: 0.0000, loss: 0.0876, grad_norm: 4.0467
2024-10-16 07:39:30,063 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:19:34, time: 1.004, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0317, stage0_bag_acc: 96.8143, stage0_mean_ious: 0.4985, stage0_s: 0.4159, stage0_m: 0.3847, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0126, stage1_bag_acc: 98.6000, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5805, stage1_s: 0.5367, stage1_m: 0.3873, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0494, grad_norm: 3.0505
2024-10-16 07:39:58,036 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 07:40:51,939 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:18:19, time: 1.034, data_time: 0.056, memory: 7817, stage0_loss_instance_mil: 0.0280, stage0_bag_acc: 98.5667, stage0_mean_ious: 0.4730, stage0_s: 0.4351, stage0_m: 0.3132, stage0_l: 0.0163, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0102, stage1_bag_acc: 98.1167, stage1_neg_loss: 0.0033, stage1_mean_ious: 0.5750, stage1_s: 0.5676, stage1_m: 0.3138, stage1_l: 0.0113, stage1_h: 0.0000, loss: 0.0415, grad_norm: 2.6635
2024-10-16 07:41:40,235 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:17:43, time: 0.966, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0330, stage0_bag_acc: 98.2500, stage0_mean_ious: 0.5197, stage0_s: 0.4843, stage0_m: 0.4280, stage0_l: 0.0087, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0130, stage1_bag_acc: 97.7500, stage1_neg_loss: 0.0057, stage1_mean_ious: 0.5793, stage1_s: 0.5820, stage1_m: 0.4173, stage1_l: 0.0059, stage1_h: 0.0000, loss: 0.0517, grad_norm: 3.5054
2024-10-16 07:42:19,600 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:17:02, time: 0.787, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0142, stage0_bag_acc: 99.1000, stage0_mean_ious: 0.4989, stage0_s: 0.4316, stage0_m: 0.3428, stage0_l: 0.0074, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0071, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5849, stage1_s: 0.5441, stage1_m: 0.3269, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0276, grad_norm: 2.4141
2024-10-16 07:42:58,815 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:16:20, time: 0.784, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0314, stage0_bag_acc: 97.9848, stage0_mean_ious: 0.4869, stage0_s: 0.4520, stage0_m: 0.3800, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0131, stage1_bag_acc: 98.2848, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5856, stage1_s: 0.5741, stage1_m: 0.4097, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0503, grad_norm: 3.6152
2024-10-16 07:43:38,973 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:15:39, time: 0.803, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0225, stage0_bag_acc: 98.3667, stage0_mean_ious: 0.4982, stage0_s: 0.4391, stage0_m: 0.4144, stage0_l: 0.0153, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0090, stage1_bag_acc: 98.9000, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5841, stage1_s: 0.5609, stage1_m: 0.4254, stage1_l: 0.0133, stage1_h: 0.0000, loss: 0.0371, grad_norm: 2.7101
2024-10-16 07:44:02,061 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 07:44:45,141 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:14:22, time: 0.817, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0260, stage0_bag_acc: 97.9500, stage0_mean_ious: 0.5043, stage0_s: 0.4345, stage0_m: 0.3722, stage0_l: 0.0147, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0060, stage1_bag_acc: 98.2500, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5863, stage1_s: 0.5453, stage1_m: 0.3856, stage1_l: 0.0112, stage1_h: 0.0000, loss: 0.0378, grad_norm: 2.7585
2024-10-16 07:45:27,830 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:13:43, time: 0.854, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0335, stage0_bag_acc: 98.1500, stage0_mean_ious: 0.5040, stage0_s: 0.4571, stage0_m: 0.3864, stage0_l: 0.0066, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0116, stage1_bag_acc: 97.8500, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5704, stage1_s: 0.5714, stage1_m: 0.3626, stage1_l: 0.0064, stage1_h: 0.0000, loss: 0.0489, grad_norm: 2.7501
2024-10-16 07:46:15,754 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:13:05, time: 0.958, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0253, stage0_bag_acc: 98.4333, stage0_mean_ious: 0.5019, stage0_s: 0.4449, stage0_m: 0.3919, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0085, stage1_bag_acc: 98.4333, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5589, stage1_s: 0.5327, stage1_m: 0.3666, stage1_l: 0.0054, stage1_h: 0.0000, loss: 0.0368, grad_norm: 2.3486
2024-10-16 07:47:00,752 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:12:26, time: 0.900, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0287, stage0_bag_acc: 97.9056, stage0_mean_ious: 0.4742, stage0_s: 0.4523, stage0_m: 0.2319, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 97.5778, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5597, stage1_s: 0.5462, stage1_m: 0.2326, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0415, grad_norm: 2.8304
2024-10-16 07:47:49,394 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:11:49, time: 0.973, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0312, stage0_bag_acc: 97.7595, stage0_mean_ious: 0.5041, stage0_s: 0.4610, stage0_m: 0.3780, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0094, stage1_bag_acc: 97.6762, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.5827, stage1_s: 0.5832, stage1_m: 0.3653, stage1_l: 0.0044, stage1_h: 0.0000, loss: 0.0431, grad_norm: 2.5558
2024-10-16 07:48:19,095 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 07:49:41,241 - mmdet - INFO - Evaluating bbox...
2024-10-16 07:49:41,814 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2069
2024-10-16 07:49:41,814 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6735
2024-10-16 07:49:41,814 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4046
2024-10-16 07:49:41,814 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1239
2024-10-16 07:49:41,814 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0554
2024-10-16 07:49:41,814 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0185
2024-10-16 07:49:41,815 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0009
2024-10-16 07:49:41,815 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 07:49:41,815 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2168
2024-10-16 07:49:41,815 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0773
2024-10-16 07:49:41,815 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3084
2024-10-16 07:49:41,815 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7747
2024-10-16 07:49:41,815 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3084
2024-10-16 07:49:41,815 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3084
2024-10-16 07:49:41,815 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 07:49:41,815 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3263
2024-10-16 07:49:41,815 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0995
2024-10-16 07:49:41,820 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 07:49:41,821 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2070, bbox_mAP_50: 0.6730, bbox_mAP_75: 0.4050, bbox_mAP_s: 0.1240, bbox_mAP_m: 0.0550, bbox_mAP_l: 0.0190, bbox_mAP_copypaste: 0.207 0.673 0.405 0.124 0.055 0.019
2024-10-16 07:50:32,366 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:10:39, time: 1.011, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0327, stage0_bag_acc: 96.5310, stage0_mean_ious: 0.4996, stage0_s: 0.4566, stage0_m: 0.3660, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0072, stage1_bag_acc: 97.6500, stage1_neg_loss: 0.0077, stage1_mean_ious: 0.5784, stage1_s: 0.5717, stage1_m: 0.3548, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0477, grad_norm: 3.1175
2024-10-16 07:51:22,857 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:10:01, time: 1.010, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0153, stage0_bag_acc: 98.8833, stage0_mean_ious: 0.4953, stage0_s: 0.4218, stage0_m: 0.4229, stage0_l: 0.0162, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0076, stage1_bag_acc: 98.6167, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5674, stage1_s: 0.5334, stage1_m: 0.4056, stage1_l: 0.0148, stage1_h: 0.0000, loss: 0.0251, grad_norm: 2.0742
2024-10-16 07:52:10,347 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:09:22, time: 0.950, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0281, stage0_bag_acc: 97.9364, stage0_mean_ious: 0.4950, stage0_s: 0.4432, stage0_m: 0.3202, stage0_l: 0.0147, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0107, stage1_bag_acc: 97.8649, stage1_neg_loss: 0.0046, stage1_mean_ious: 0.5485, stage1_s: 0.5313, stage1_m: 0.3017, stage1_l: 0.0118, stage1_h: 0.0000, loss: 0.0434, grad_norm: 2.5003
2024-10-16 07:52:56,809 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:08:43, time: 0.929, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0299, stage0_bag_acc: 98.0848, stage0_mean_ious: 0.4799, stage0_s: 0.4405, stage0_m: 0.2199, stage0_l: 0.0077, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0100, stage1_bag_acc: 98.0848, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5572, stage1_s: 0.5407, stage1_m: 0.2065, stage1_l: 0.0066, stage1_h: 0.0000, loss: 0.0436, grad_norm: 3.2324
2024-10-16 07:53:44,497 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:08:04, time: 0.954, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0142, stage0_bag_acc: 98.5667, stage0_mean_ious: 0.4847, stage0_s: 0.4693, stage0_m: 0.2544, stage0_l: 0.0160, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.7667, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5870, stage1_s: 0.5856, stage1_m: 0.2574, stage1_l: 0.0095, stage1_h: 0.0000, loss: 0.0276, grad_norm: 1.9468
2024-10-16 07:54:11,071 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 07:55:04,207 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:55, time: 1.019, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0233, stage0_bag_acc: 97.8500, stage0_mean_ious: 0.5015, stage0_s: 0.4674, stage0_m: 0.3367, stage0_l: 0.0078, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0085, stage1_bag_acc: 97.0643, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5755, stage1_s: 0.5664, stage1_m: 0.3226, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.0339, grad_norm: 2.3106
2024-10-16 07:55:41,120 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:06:14, time: 0.738, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0134, stage0_bag_acc: 98.7167, stage0_mean_ious: 0.5017, stage0_s: 0.4542, stage0_m: 0.2983, stage0_l: 0.0188, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0056, stage1_bag_acc: 98.1810, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5573, stage1_s: 0.5337, stage1_m: 0.2863, stage1_l: 0.0145, stage1_h: 0.0000, loss: 0.0220, grad_norm: 1.8567
2024-10-16 07:56:16,611 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:32, time: 0.710, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0122, stage0_bag_acc: 99.5278, stage0_mean_ious: 0.4565, stage0_s: 0.4087, stage0_m: 0.2512, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0104, stage1_bag_acc: 98.9563, stage1_neg_loss: 0.0047, stage1_mean_ious: 0.5612, stage1_s: 0.5292, stage1_m: 0.2740, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0273, grad_norm: 2.2305
2024-10-16 07:56:54,507 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 07:56:54,507 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:52, time: 0.758, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0331, stage0_bag_acc: 98.4056, stage0_mean_ious: 0.4831, stage0_s: 0.4286, stage0_m: 0.3763, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0067, stage1_bag_acc: 98.0222, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5727, stage1_s: 0.5572, stage1_m: 0.3590, stage1_l: 0.0085, stage1_h: 0.0000, loss: 0.0418, grad_norm: 2.4510
2024-10-16 07:57:30,000 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:04:10, time: 0.710, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0254, stage0_bag_acc: 97.7000, stage0_mean_ious: 0.5125, stage0_s: 0.4543, stage0_m: 0.3454, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0091, stage1_bag_acc: 97.7000, stage1_neg_loss: 0.0053, stage1_mean_ious: 0.5791, stage1_s: 0.5570, stage1_m: 0.3196, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0398, grad_norm: 2.4936
2024-10-16 07:57:51,947 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 07:58:35,935 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:03:04, time: 0.836, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0105, stage0_bag_acc: 99.5000, stage0_mean_ious: 0.5028, stage0_s: 0.4560, stage0_m: 0.4023, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0048, stage1_bag_acc: 99.5000, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5799, stage1_s: 0.5768, stage1_m: 0.3898, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0175, grad_norm: 1.3450
2024-10-16 07:59:23,514 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:24, time: 0.952, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0128, stage0_bag_acc: 98.7278, stage0_mean_ious: 0.5010, stage0_s: 0.4644, stage0_m: 0.3198, stage0_l: 0.0291, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0046, stage1_bag_acc: 98.5000, stage1_neg_loss: 0.0034, stage1_mean_ious: 0.5797, stage1_s: 0.5842, stage1_m: 0.3054, stage1_l: 0.0266, stage1_h: 0.0000, loss: 0.0207, grad_norm: 1.5892
2024-10-16 08:00:11,939 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:44, time: 0.969, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0159, stage0_bag_acc: 98.6667, stage0_mean_ious: 0.5035, stage0_s: 0.4657, stage0_m: 0.3113, stage0_l: 0.0159, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 98.8500, stage1_neg_loss: 0.0035, stage1_mean_ious: 0.5833, stage1_s: 0.5626, stage1_m: 0.3155, stage1_l: 0.0119, stage1_h: 0.0000, loss: 0.0267, grad_norm: 1.8967
2024-10-16 08:00:59,093 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:01:04, time: 0.943, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0332, stage0_bag_acc: 97.4556, stage0_mean_ious: 0.4791, stage0_s: 0.4172, stage0_m: 0.3339, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0080, stage1_bag_acc: 98.1278, stage1_neg_loss: 0.0020, stage1_mean_ious: 0.5476, stage1_s: 0.5212, stage1_m: 0.3215, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0432, grad_norm: 2.2209
2024-10-16 08:01:45,067 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:24, time: 0.919, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0206, stage0_bag_acc: 98.1667, stage0_mean_ious: 0.4992, stage0_s: 0.4649, stage0_m: 0.2999, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0121, stage1_bag_acc: 97.9167, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5739, stage1_s: 0.5670, stage1_m: 0.2819, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0391, grad_norm: 3.0534
2024-10-16 08:02:13,238 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 08:03:34,331 - mmdet - INFO - Evaluating bbox...
2024-10-16 08:03:34,894 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2096
2024-10-16 08:03:34,895 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6767
2024-10-16 08:03:34,895 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4065
2024-10-16 08:03:34,895 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1293
2024-10-16 08:03:34,895 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0565
2024-10-16 08:03:34,895 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0194
2024-10-16 08:03:34,895 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0017
2024-10-16 08:03:34,895 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 08:03:34,895 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2197
2024-10-16 08:03:34,896 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0796
2024-10-16 08:03:34,896 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3107
2024-10-16 08:03:34,896 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7794
2024-10-16 08:03:34,896 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3107
2024-10-16 08:03:34,896 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3107
2024-10-16 08:03:34,896 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 08:03:34,896 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3287
2024-10-16 08:03:34,896 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1020
2024-10-16 08:03:34,901 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 08:03:34,901 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2100, bbox_mAP_50: 0.6770, bbox_mAP_75: 0.4070, bbox_mAP_s: 0.1290, bbox_mAP_m: 0.0560, bbox_mAP_l: 0.0190, bbox_mAP_copypaste: 0.210 0.677 0.407 0.129 0.056 0.019
2024-10-16 08:04:55,530 - mmdet - INFO - Evaluating bbox...
2024-10-16 08:04:56,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2096
2024-10-16 08:04:56,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6767
2024-10-16 08:04:56,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4065
2024-10-16 08:04:56,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1293
2024-10-16 08:04:56,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0565
2024-10-16 08:04:56,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0194
2024-10-16 08:04:56,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0017
2024-10-16 08:04:56,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 08:04:56,019 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2197
2024-10-16 08:04:56,020 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0796
2024-10-16 08:04:56,020 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3107
2024-10-16 08:04:56,020 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7794
2024-10-16 08:04:56,020 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3107
2024-10-16 08:04:56,020 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3107
2024-10-16 08:04:56,020 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 08:04:56,020 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3287
2024-10-16 08:04:56,020 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1020
2024-10-16 08:04:57,243 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+2fd3e4b
------------------------------------------------------------

2024-10-16 08:04:58,183 - mmdet - INFO - Distributed training: False
2024-10-16 08:04:59,052 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-16 08:04:59,976 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 08:04:59,977 - mmdet - INFO - Use load_from_local loader
2024-10-16 08:05:00,258 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 08:05:00,268 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 08:05:00,269 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 08:05:51,362 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:56:22, time: 1.022, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.7068, stage0_bag_acc: 21.6675, stage0_mean_ious: 0.0566, stage0_s: 0.0380, stage0_m: 0.0634, stage0_l: 0.0179, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1737, stage1_bag_acc: 17.1457, stage1_neg_loss: 0.0008, stage1_mean_ious: 0.0555, stage1_s: 0.0385, stage1_m: 0.0595, stage1_l: 0.0156, stage1_h: 0.0000, loss: 0.8814, grad_norm: 6.2194
2024-10-16 08:06:37,328 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:52:43, time: 0.919, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.7073, stage0_bag_acc: 15.1167, stage0_mean_ious: 0.0554, stage0_s: 0.0508, stage0_m: 0.0438, stage0_l: 0.0058, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1637, stage1_bag_acc: 16.1955, stage1_neg_loss: 0.0009, stage1_mean_ious: 0.0527, stage1_s: 0.0484, stage1_m: 0.0399, stage1_l: 0.0043, stage1_h: 0.0000, loss: 0.8719, grad_norm: 5.8871
2024-10-16 08:07:26,399 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:52:07, time: 0.982, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.6934, stage0_bag_acc: 16.5922, stage0_mean_ious: 0.1051, stage0_s: 0.0865, stage0_m: 0.1029, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1578, stage1_bag_acc: 19.6418, stage1_neg_loss: 0.0025, stage1_mean_ious: 0.0994, stage1_s: 0.0843, stage1_m: 0.0930, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8536, grad_norm: 7.0876
2024-10-16 08:08:15,605 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:51:26, time: 0.984, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.6473, stage0_bag_acc: 33.1627, stage0_mean_ious: 0.1232, stage0_s: 0.1015, stage0_m: 0.0947, stage0_l: 0.0086, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1598, stage1_bag_acc: 28.5672, stage1_neg_loss: 0.0129, stage1_mean_ious: 0.1212, stage1_s: 0.1004, stage1_m: 0.0932, stage1_l: 0.0086, stage1_h: 0.0000, loss: 0.8200, grad_norm: 9.4317
2024-10-16 08:09:00,841 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:49:52, time: 0.905, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.5991, stage0_bag_acc: 33.1543, stage0_mean_ious: 0.1534, stage0_s: 0.1201, stage0_m: 0.1483, stage0_l: 0.0013, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1534, stage1_bag_acc: 45.6710, stage1_neg_loss: 0.0212, stage1_mean_ious: 0.1475, stage1_s: 0.1166, stage1_m: 0.1422, stage1_l: 0.0019, stage1_h: 0.0000, loss: 0.7737, grad_norm: 9.1446
2024-10-16 08:09:22,760 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 08:10:05,193 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:43:02, time: 0.814, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.5526, stage0_bag_acc: 38.9261, stage0_mean_ious: 0.2192, stage0_s: 0.1713, stage0_m: 0.2046, stage0_l: 0.0002, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1087, stage1_bag_acc: 39.1272, stage1_neg_loss: 0.0194, stage1_mean_ious: 0.2566, stage1_s: 0.2136, stage1_m: 0.2190, stage1_l: 0.0002, stage1_h: 0.0000, loss: 0.6808, grad_norm: 10.3335
2024-10-16 08:10:44,177 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:41:51, time: 0.780, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.4654, stage0_bag_acc: 58.2074, stage0_mean_ious: 0.3138, stage0_s: 0.2599, stage0_m: 0.2926, stage0_l: 0.0358, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1124, stage1_bag_acc: 50.8623, stage1_neg_loss: 0.0265, stage1_mean_ious: 0.3642, stage1_s: 0.3226, stage1_m: 0.2980, stage1_l: 0.0244, stage1_h: 0.0000, loss: 0.6042, grad_norm: 12.8611
2024-10-16 08:11:20,368 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:40:28, time: 0.724, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.3681, stage0_bag_acc: 65.0038, stage0_mean_ious: 0.3600, stage0_s: 0.3232, stage0_m: 0.2428, stage0_l: 0.0109, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0956, stage1_bag_acc: 62.7220, stage1_neg_loss: 0.0174, stage1_mean_ious: 0.4422, stage1_s: 0.4190, stage1_m: 0.2509, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.4811, grad_norm: 14.6223
2024-10-16 08:11:56,994 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:39:18, time: 0.733, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.2736, stage0_bag_acc: 76.4413, stage0_mean_ious: 0.4319, stage0_s: 0.3724, stage0_m: 0.3661, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0702, stage1_bag_acc: 72.7103, stage1_neg_loss: 0.0183, stage1_mean_ious: 0.5222, stage1_s: 0.4881, stage1_m: 0.3915, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.3621, grad_norm: 12.3949
2024-10-16 08:12:45,173 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:39:15, time: 0.964, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.1777, stage0_bag_acc: 85.6151, stage0_mean_ious: 0.4379, stage0_s: 0.3845, stage0_m: 0.3489, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0532, stage1_bag_acc: 85.8317, stage1_neg_loss: 0.0147, stage1_mean_ious: 0.5349, stage1_s: 0.5070, stage1_m: 0.3383, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2457, grad_norm: 9.1150
2024-10-16 08:13:15,840 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 08:14:10,819 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:37:06, time: 1.055, data_time: 0.060, memory: 7817, stage0_loss_instance_mil: 0.1271, stage0_bag_acc: 91.4379, stage0_mean_ious: 0.4510, stage0_s: 0.3830, stage0_m: 0.4004, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0422, stage1_bag_acc: 91.4658, stage1_neg_loss: 0.0107, stage1_mean_ious: 0.5628, stage1_s: 0.5222, stage1_m: 0.4368, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1799, grad_norm: 6.8918
2024-10-16 08:14:58,696 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:36:56, time: 0.958, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0897, stage0_bag_acc: 94.2667, stage0_mean_ious: 0.4730, stage0_s: 0.4125, stage0_m: 0.3422, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0379, stage1_bag_acc: 94.2333, stage1_neg_loss: 0.0182, stage1_mean_ious: 0.5733, stage1_s: 0.5431, stage1_m: 0.3334, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1459, grad_norm: 6.9700
2024-10-16 08:15:47,818 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:36:45, time: 0.982, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1568, stage0_bag_acc: 86.5937, stage0_mean_ious: 0.4631, stage0_s: 0.3866, stage0_m: 0.3989, stage0_l: 0.0208, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0412, stage1_bag_acc: 87.8270, stage1_neg_loss: 0.0124, stage1_mean_ious: 0.5459, stage1_s: 0.5037, stage1_m: 0.3999, stage1_l: 0.0137, stage1_h: 0.0000, loss: 0.2104, grad_norm: 9.5659
2024-10-16 08:16:35,123 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:36:23, time: 0.946, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1176, stage0_bag_acc: 91.0071, stage0_mean_ious: 0.4640, stage0_s: 0.3986, stage0_m: 0.4038, stage0_l: 0.0093, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0352, stage1_bag_acc: 92.5429, stage1_neg_loss: 0.0131, stage1_mean_ious: 0.5553, stage1_s: 0.5171, stage1_m: 0.4195, stage1_l: 0.0115, stage1_h: 0.0000, loss: 0.1658, grad_norm: 7.5506
2024-10-16 08:17:23,346 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:36:01, time: 0.964, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1118, stage0_bag_acc: 92.2833, stage0_mean_ious: 0.4701, stage0_s: 0.4357, stage0_m: 0.3224, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0260, stage1_bag_acc: 93.1000, stage1_neg_loss: 0.0119, stage1_mean_ious: 0.5507, stage1_s: 0.5476, stage1_m: 0.3158, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1497, grad_norm: 6.7121
2024-10-16 08:17:52,077 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 08:19:14,030 - mmdet - INFO - Evaluating bbox...
2024-10-16 08:19:14,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2013
2024-10-16 08:19:14,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6623
2024-10-16 08:19:14,524 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3627
2024-10-16 08:19:14,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1286
2024-10-16 08:19:14,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0660
2024-10-16 08:19:14,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0250
2024-10-16 08:19:14,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0024
2024-10-16 08:19:14,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 08:19:14,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2117
2024-10-16 08:19:14,525 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0648
2024-10-16 08:19:14,525 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3031
2024-10-16 08:19:14,526 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7721
2024-10-16 08:19:14,526 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3031
2024-10-16 08:19:14,526 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3031
2024-10-16 08:19:14,526 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 08:19:14,526 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3200
2024-10-16 08:19:14,526 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1057
2024-10-16 08:19:14,531 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 08:19:14,532 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.2010, bbox_mAP_50: 0.6620, bbox_mAP_75: 0.3630, bbox_mAP_s: 0.1290, bbox_mAP_m: 0.0660, bbox_mAP_l: 0.0250, bbox_mAP_copypaste: 0.201 0.662 0.363 0.129 0.066 0.025
2024-10-16 08:20:05,180 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:34:05, time: 1.013, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0611, stage0_bag_acc: 95.7444, stage0_mean_ious: 0.4669, stage0_s: 0.3957, stage0_m: 0.3131, stage0_l: 0.0077, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0328, stage1_bag_acc: 96.7778, stage1_neg_loss: 0.0121, stage1_mean_ious: 0.5514, stage1_s: 0.5046, stage1_m: 0.3150, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.1060, grad_norm: 5.6232
2024-10-16 08:20:54,393 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:33:44, time: 0.984, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0912, stage0_bag_acc: 92.8563, stage0_mean_ious: 0.4814, stage0_s: 0.4450, stage0_m: 0.3752, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0276, stage1_bag_acc: 94.7452, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5647, stage1_s: 0.5514, stage1_m: 0.3745, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1268, grad_norm: 6.6457
2024-10-16 08:21:43,333 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:33:19, time: 0.979, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0769, stage0_bag_acc: 93.6682, stage0_mean_ious: 0.4848, stage0_s: 0.4276, stage0_m: 0.3129, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0237, stage1_bag_acc: 94.2626, stage1_neg_loss: 0.0091, stage1_mean_ious: 0.5668, stage1_s: 0.5501, stage1_m: 0.3070, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1097, grad_norm: 5.3293
2024-10-16 08:22:24,564 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:32:35, time: 0.825, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0747, stage0_bag_acc: 93.6197, stage0_mean_ious: 0.4725, stage0_s: 0.4329, stage0_m: 0.3157, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0224, stage1_bag_acc: 93.9394, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.5627, stage1_s: 0.5439, stage1_m: 0.3390, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1037, grad_norm: 4.8478
2024-10-16 08:22:59,482 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:31:38, time: 0.698, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0697, stage0_bag_acc: 93.3825, stage0_mean_ious: 0.4690, stage0_s: 0.4371, stage0_m: 0.3021, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0171, stage1_bag_acc: 95.6476, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5572, stage1_s: 0.5444, stage1_m: 0.3110, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0916, grad_norm: 4.7869
2024-10-16 08:23:21,202 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 08:24:01,250 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:29:36, time: 0.757, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0717, stage0_bag_acc: 94.1500, stage0_mean_ious: 0.4778, stage0_s: 0.4367, stage0_m: 0.2889, stage0_l: 0.0163, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0205, stage1_bag_acc: 95.2722, stage1_neg_loss: 0.0133, stage1_mean_ious: 0.5603, stage1_s: 0.5440, stage1_m: 0.2725, stage1_l: 0.0168, stage1_h: 0.0000, loss: 0.1055, grad_norm: 5.1809
2024-10-16 08:24:36,331 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:28:46, time: 0.702, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0475, stage0_bag_acc: 97.0848, stage0_mean_ious: 0.4757, stage0_s: 0.4642, stage0_m: 0.2263, stage0_l: 0.0247, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0176, stage1_bag_acc: 97.4848, stage1_neg_loss: 0.0093, stage1_mean_ious: 0.5801, stage1_s: 0.5796, stage1_m: 0.2341, stage1_l: 0.0308, stage1_h: 0.0000, loss: 0.0744, grad_norm: 3.6505
2024-10-16 08:25:15,933 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:28:05, time: 0.792, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0472, stage0_bag_acc: 96.9825, stage0_mean_ious: 0.4670, stage0_s: 0.4215, stage0_m: 0.3434, stage0_l: 0.0088, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0229, stage1_bag_acc: 97.0325, stage1_neg_loss: 0.0131, stage1_mean_ious: 0.5694, stage1_s: 0.5541, stage1_m: 0.3680, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0832, grad_norm: 4.8175
2024-10-16 08:26:02,610 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:27:34, time: 0.934, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0471, stage0_bag_acc: 95.7984, stage0_mean_ious: 0.5284, stage0_s: 0.4576, stage0_m: 0.4165, stage0_l: 0.0607, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0158, stage1_bag_acc: 96.6421, stage1_neg_loss: 0.0045, stage1_mean_ious: 0.5842, stage1_s: 0.5576, stage1_m: 0.3982, stage1_l: 0.0454, stage1_h: 0.0000, loss: 0.0674, grad_norm: 3.9374
2024-10-16 08:26:50,398 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:27:04, time: 0.956, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0739, stage0_bag_acc: 93.8143, stage0_mean_ious: 0.4883, stage0_s: 0.4628, stage0_m: 0.2959, stage0_l: 0.0120, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0196, stage1_bag_acc: 94.6333, stage1_neg_loss: 0.0066, stage1_mean_ious: 0.5574, stage1_s: 0.5546, stage1_m: 0.3012, stage1_l: 0.0063, stage1_h: 0.0000, loss: 0.1001, grad_norm: 5.8800
2024-10-16 08:27:19,360 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 08:28:11,474 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:25:38, time: 0.998, data_time: 0.060, memory: 7817, stage0_loss_instance_mil: 0.0703, stage0_bag_acc: 95.3460, stage0_mean_ious: 0.4786, stage0_s: 0.4016, stage0_m: 0.3329, stage0_l: 0.0089, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0187, stage1_bag_acc: 96.0484, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5588, stage1_s: 0.4943, stage1_m: 0.3472, stage1_l: 0.0069, stage1_h: 0.0000, loss: 0.0971, grad_norm: 5.1187
2024-10-16 08:28:58,967 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:25:07, time: 0.950, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0466, stage0_bag_acc: 96.6990, stage0_mean_ious: 0.4786, stage0_s: 0.4365, stage0_m: 0.3526, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0141, stage1_bag_acc: 97.1753, stage1_neg_loss: 0.0085, stage1_mean_ious: 0.5449, stage1_s: 0.5268, stage1_m: 0.3506, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0692, grad_norm: 4.6483
2024-10-16 08:29:45,799 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:24:34, time: 0.937, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0367, stage0_bag_acc: 96.5452, stage0_mean_ious: 0.4930, stage0_s: 0.4466, stage0_m: 0.3049, stage0_l: 0.0239, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0167, stage1_bag_acc: 96.7952, stage1_neg_loss: 0.0041, stage1_mean_ious: 0.5706, stage1_s: 0.5435, stage1_m: 0.3050, stage1_l: 0.0209, stage1_h: 0.0000, loss: 0.0575, grad_norm: 3.8670
2024-10-16 08:30:34,608 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:24:02, time: 0.976, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0507, stage0_bag_acc: 95.9087, stage0_mean_ious: 0.5173, stage0_s: 0.4878, stage0_m: 0.3715, stage0_l: 0.0071, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0163, stage1_bag_acc: 95.6087, stage1_neg_loss: 0.0051, stage1_mean_ious: 0.5947, stage1_s: 0.5925, stage1_m: 0.3539, stage1_l: 0.0052, stage1_h: 0.0000, loss: 0.0720, grad_norm: 3.4196
2024-10-16 08:31:23,107 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:23:29, time: 0.970, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0574, stage0_bag_acc: 94.6500, stage0_mean_ious: 0.4960, stage0_s: 0.4484, stage0_m: 0.3713, stage0_l: 0.0214, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0158, stage1_bag_acc: 95.9587, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5767, stage1_s: 0.5577, stage1_m: 0.3578, stage1_l: 0.0182, stage1_h: 0.0000, loss: 0.0793, grad_norm: 4.0172
2024-10-16 08:31:52,645 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 08:33:13,894 - mmdet - INFO - Evaluating bbox...
2024-10-16 08:33:14,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2088
2024-10-16 08:33:14,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6716
2024-10-16 08:33:14,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3877
2024-10-16 08:33:14,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1408
2024-10-16 08:33:14,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0668
2024-10-16 08:33:14,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0266
2024-10-16 08:33:14,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-16 08:33:14,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 08:33:14,454 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2198
2024-10-16 08:33:14,455 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0784
2024-10-16 08:33:14,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3107
2024-10-16 08:33:14,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7785
2024-10-16 08:33:14,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3107
2024-10-16 08:33:14,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3107
2024-10-16 08:33:14,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 08:33:14,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3290
2024-10-16 08:33:14,455 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1136
2024-10-16 08:33:14,460 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 08:33:14,461 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.2090, bbox_mAP_50: 0.6720, bbox_mAP_75: 0.3880, bbox_mAP_s: 0.1410, bbox_mAP_m: 0.0670, bbox_mAP_l: 0.0270, bbox_mAP_copypaste: 0.209 0.672 0.388 0.141 0.067 0.027
2024-10-16 08:34:06,959 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:22:10, time: 1.050, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0265, stage0_bag_acc: 98.5167, stage0_mean_ious: 0.4740, stage0_s: 0.4355, stage0_m: 0.3855, stage0_l: 0.0086, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0121, stage1_bag_acc: 98.1667, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.5708, stage1_s: 0.5538, stage1_m: 0.3982, stage1_l: 0.0074, stage1_h: 0.0000, loss: 0.0458, grad_norm: 3.0479
2024-10-16 08:34:54,768 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:21:36, time: 0.956, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0385, stage0_bag_acc: 96.8149, stage0_mean_ious: 0.5004, stage0_s: 0.4319, stage0_m: 0.3746, stage0_l: 0.0073, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0165, stage1_bag_acc: 96.9316, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.5674, stage1_s: 0.5264, stage1_m: 0.3655, stage1_l: 0.0082, stage1_h: 0.0000, loss: 0.0622, grad_norm: 4.2829
2024-10-16 08:35:40,883 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:20:59, time: 0.922, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0671, stage0_bag_acc: 95.4032, stage0_mean_ious: 0.4860, stage0_s: 0.4385, stage0_m: 0.3569, stage0_l: 0.0096, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0174, stage1_bag_acc: 96.4722, stage1_neg_loss: 0.0068, stage1_mean_ious: 0.5766, stage1_s: 0.5449, stage1_m: 0.3618, stage1_l: 0.0093, stage1_h: 0.0000, loss: 0.0913, grad_norm: 5.3502
2024-10-16 08:36:18,040 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:20:15, time: 0.743, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0478, stage0_bag_acc: 96.9348, stage0_mean_ious: 0.4837, stage0_s: 0.4350, stage0_m: 0.4052, stage0_l: 0.0199, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0106, stage1_bag_acc: 97.3848, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5785, stage1_s: 0.5684, stage1_m: 0.3989, stage1_l: 0.0247, stage1_h: 0.0000, loss: 0.0620, grad_norm: 3.2537
2024-10-16 08:36:54,646 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:19:30, time: 0.732, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0472, stage0_bag_acc: 96.9182, stage0_mean_ious: 0.5169, stage0_s: 0.4741, stage0_m: 0.3508, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0120, stage1_bag_acc: 97.0000, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.6084, stage1_s: 0.5847, stage1_m: 0.3543, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0642, grad_norm: 2.8736
2024-10-16 08:37:17,734 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 08:37:59,597 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:18:07, time: 0.793, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0373, stage0_bag_acc: 96.6119, stage0_mean_ious: 0.5008, stage0_s: 0.4731, stage0_m: 0.3322, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0133, stage1_bag_acc: 97.5976, stage1_neg_loss: 0.0082, stage1_mean_ious: 0.5801, stage1_s: 0.5592, stage1_m: 0.3545, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0588, grad_norm: 3.4174
2024-10-16 08:38:37,380 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:17:26, time: 0.756, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0374, stage0_bag_acc: 97.6976, stage0_mean_ious: 0.4840, stage0_s: 0.4501, stage0_m: 0.3097, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0164, stage1_bag_acc: 97.1643, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5774, stage1_s: 0.5735, stage1_m: 0.2998, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0587, grad_norm: 3.8388
2024-10-16 08:39:24,610 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:16:49, time: 0.945, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0222, stage0_bag_acc: 98.6143, stage0_mean_ious: 0.5013, stage0_s: 0.4530, stage0_m: 0.4119, stage0_l: 0.0181, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0109, stage1_bag_acc: 97.8810, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5822, stage1_s: 0.5626, stage1_m: 0.4083, stage1_l: 0.0192, stage1_h: 0.0000, loss: 0.0389, grad_norm: 3.4939
2024-10-16 08:40:11,766 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:16:13, time: 0.943, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0215, stage0_bag_acc: 98.4556, stage0_mean_ious: 0.4823, stage0_s: 0.4466, stage0_m: 0.3396, stage0_l: 0.0282, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0139, stage1_bag_acc: 97.7056, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5823, stage1_s: 0.5651, stage1_m: 0.3527, stage1_l: 0.0200, stage1_h: 0.0000, loss: 0.0385, grad_norm: 2.8773
2024-10-16 08:40:59,832 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:15:36, time: 0.961, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0346, stage0_bag_acc: 96.8778, stage0_mean_ious: 0.5058, stage0_s: 0.4698, stage0_m: 0.3589, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0091, stage1_bag_acc: 96.7667, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5904, stage1_s: 0.5862, stage1_m: 0.3592, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0477, grad_norm: 3.4948
2024-10-16 08:41:27,645 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 08:42:21,315 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:14:25, time: 1.029, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0255, stage0_bag_acc: 98.4000, stage0_mean_ious: 0.4808, stage0_s: 0.4341, stage0_m: 0.3165, stage0_l: 0.0083, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0058, stage1_bag_acc: 98.2000, stage1_neg_loss: 0.0140, stage1_mean_ious: 0.5865, stage1_s: 0.5673, stage1_m: 0.3261, stage1_l: 0.0096, stage1_h: 0.0000, loss: 0.0453, grad_norm: 2.8746
2024-10-16 08:43:09,571 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:13:48, time: 0.965, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0166, stage0_bag_acc: 98.8182, stage0_mean_ious: 0.4869, stage0_s: 0.4730, stage0_m: 0.3013, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0081, stage1_bag_acc: 99.5000, stage1_neg_loss: 0.0079, stage1_mean_ious: 0.5968, stage1_s: 0.6018, stage1_m: 0.3067, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0326, grad_norm: 2.5428
2024-10-16 08:43:56,631 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:13:10, time: 0.941, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0239, stage0_bag_acc: 98.7000, stage0_mean_ious: 0.5037, stage0_s: 0.4673, stage0_m: 0.3660, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0110, stage1_bag_acc: 98.9000, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.5736, stage1_s: 0.5749, stage1_m: 0.3700, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0366, grad_norm: 2.3046
2024-10-16 08:44:43,886 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:12:31, time: 0.945, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0195, stage0_bag_acc: 98.0310, stage0_mean_ious: 0.5181, stage0_s: 0.4874, stage0_m: 0.3473, stage0_l: 0.0170, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0106, stage1_bag_acc: 97.8643, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5788, stage1_s: 0.5626, stage1_m: 0.3371, stage1_l: 0.0141, stage1_h: 0.0000, loss: 0.0358, grad_norm: 2.9835
2024-10-16 08:45:32,354 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:11:53, time: 0.969, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0115, stage0_bag_acc: 99.5000, stage0_mean_ious: 0.5322, stage0_s: 0.4728, stage0_m: 0.3569, stage0_l: 0.0342, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0060, stage1_bag_acc: 99.5000, stage1_neg_loss: 0.0054, stage1_mean_ious: 0.5910, stage1_s: 0.5668, stage1_m: 0.3494, stage1_l: 0.0240, stage1_h: 0.0000, loss: 0.0229, grad_norm: 2.2381
2024-10-16 08:46:02,521 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 08:47:23,779 - mmdet - INFO - Evaluating bbox...
2024-10-16 08:47:24,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2127
2024-10-16 08:47:24,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6836
2024-10-16 08:47:24,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4002
2024-10-16 08:47:24,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1397
2024-10-16 08:47:24,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0668
2024-10-16 08:47:24,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0245
2024-10-16 08:47:24,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 08:47:24,269 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 08:47:24,270 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2245
2024-10-16 08:47:24,270 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0578
2024-10-16 08:47:24,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3227
2024-10-16 08:47:24,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7919
2024-10-16 08:47:24,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3227
2024-10-16 08:47:24,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3227
2024-10-16 08:47:24,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 08:47:24,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3423
2024-10-16 08:47:24,270 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0809
2024-10-16 08:47:24,276 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 08:47:24,276 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.2130, bbox_mAP_50: 0.6840, bbox_mAP_75: 0.4000, bbox_mAP_s: 0.1400, bbox_mAP_m: 0.0670, bbox_mAP_l: 0.0240, bbox_mAP_copypaste: 0.213 0.684 0.400 0.140 0.067 0.024
2024-10-16 08:48:15,195 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:10:43, time: 1.018, data_time: 0.060, memory: 7817, stage0_loss_instance_mil: 0.0110, stage0_bag_acc: 99.2643, stage0_mean_ious: 0.5213, stage0_s: 0.4701, stage0_m: 0.3680, stage0_l: 0.0139, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 99.4643, stage1_neg_loss: 0.0059, stage1_mean_ious: 0.5973, stage1_s: 0.5797, stage1_m: 0.3635, stage1_l: 0.0165, stage1_h: 0.0000, loss: 0.0252, grad_norm: 2.1160
2024-10-16 08:49:03,007 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:10:04, time: 0.956, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0305, stage0_bag_acc: 97.7167, stage0_mean_ious: 0.4900, stage0_s: 0.4316, stage0_m: 0.3367, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0086, stage1_bag_acc: 97.8667, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5854, stage1_s: 0.5565, stage1_m: 0.3416, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0434, grad_norm: 2.7068
2024-10-16 08:49:39,307 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:09:22, time: 0.726, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0266, stage0_bag_acc: 98.0310, stage0_mean_ious: 0.4983, stage0_s: 0.4491, stage0_m: 0.3535, stage0_l: 0.0186, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0106, stage1_bag_acc: 97.5810, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5611, stage1_s: 0.5378, stage1_m: 0.3537, stage1_l: 0.0157, stage1_h: 0.0000, loss: 0.0408, grad_norm: 2.8637
2024-10-16 08:50:15,495 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:08:40, time: 0.724, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0164, stage0_bag_acc: 99.0500, stage0_mean_ious: 0.4854, stage0_s: 0.4488, stage0_m: 0.3171, stage0_l: 0.0094, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0050, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.5850, stage1_s: 0.5805, stage1_m: 0.3277, stage1_l: 0.0099, stage1_h: 0.0000, loss: 0.0232, grad_norm: 1.7519
2024-10-16 08:50:51,879 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:07:59, time: 0.728, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0161, stage0_bag_acc: 98.4810, stage0_mean_ious: 0.5170, stage0_s: 0.4931, stage0_m: 0.3666, stage0_l: 0.0136, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0085, stage1_bag_acc: 99.1310, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5835, stage1_s: 0.5812, stage1_m: 0.3578, stage1_l: 0.0136, stage1_h: 0.0000, loss: 0.0272, grad_norm: 2.1769
2024-10-16 08:51:14,301 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 08:51:56,712 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:49, time: 0.804, data_time: 0.060, memory: 7817, stage0_loss_instance_mil: 0.0190, stage0_bag_acc: 99.2667, stage0_mean_ious: 0.4843, stage0_s: 0.4245, stage0_m: 0.3133, stage0_l: 0.0099, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0113, stage1_bag_acc: 98.5976, stage1_neg_loss: 0.0079, stage1_mean_ious: 0.5690, stage1_s: 0.5365, stage1_m: 0.3215, stage1_l: 0.0053, stage1_h: 0.0000, loss: 0.0382, grad_norm: 2.4198
2024-10-16 08:52:38,993 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:06:09, time: 0.845, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0078, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.5020, stage0_s: 0.4787, stage0_m: 0.2793, stage0_l: 0.0079, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0070, stage1_bag_acc: 99.5500, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.5877, stage1_s: 0.5801, stage1_m: 0.2767, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.0167, grad_norm: 1.4834
2024-10-16 08:53:26,826 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:30, time: 0.957, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0101, stage0_bag_acc: 98.9278, stage0_mean_ious: 0.5180, stage0_s: 0.4690, stage0_m: 0.3982, stage0_l: 0.0105, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0046, stage1_bag_acc: 99.5682, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.6032, stage1_s: 0.5908, stage1_m: 0.3789, stage1_l: 0.0055, stage1_h: 0.0000, loss: 0.0176, grad_norm: 1.6105
2024-10-16 08:54:15,364 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 08:54:15,365 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:51, time: 0.971, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0171, stage0_bag_acc: 98.6000, stage0_mean_ious: 0.4953, stage0_s: 0.4673, stage0_m: 0.3404, stage0_l: 0.0109, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0094, stage1_bag_acc: 99.1333, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5877, stage1_s: 0.5796, stage1_m: 0.3472, stage1_l: 0.0079, stage1_h: 0.0000, loss: 0.0303, grad_norm: 2.2751
2024-10-16 08:55:04,995 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:04:11, time: 0.993, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0062, stage0_bag_acc: 99.8000, stage0_mean_ious: 0.4954, stage0_s: 0.4514, stage0_m: 0.3580, stage0_l: 0.0353, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0047, stage1_bag_acc: 99.6000, stage1_neg_loss: 0.0028, stage1_mean_ious: 0.5773, stage1_s: 0.5835, stage1_m: 0.3245, stage1_l: 0.0276, stage1_h: 0.0000, loss: 0.0137, grad_norm: 1.2766
2024-10-16 08:55:32,979 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 08:56:27,159 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:03:05, time: 1.039, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0142, stage0_bag_acc: 99.3500, stage0_mean_ious: 0.4856, stage0_s: 0.4376, stage0_m: 0.3289, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0060, stage1_bag_acc: 99.1500, stage1_neg_loss: 0.0023, stage1_mean_ious: 0.5865, stage1_s: 0.5720, stage1_m: 0.3275, stage1_l: 0.0125, stage1_h: 0.0000, loss: 0.0225, grad_norm: 1.5674
2024-10-16 08:57:14,530 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:25, time: 0.947, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0249, stage0_bag_acc: 98.3045, stage0_mean_ious: 0.5003, stage0_s: 0.4720, stage0_m: 0.2372, stage0_l: 0.0316, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0082, stage1_bag_acc: 98.3045, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.5685, stage1_s: 0.5705, stage1_m: 0.2263, stage1_l: 0.0257, stage1_h: 0.0000, loss: 0.0351, grad_norm: 2.4603
2024-10-16 08:58:02,502 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:45, time: 0.959, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0140, stage0_bag_acc: 99.1500, stage0_mean_ious: 0.5048, stage0_s: 0.4568, stage0_m: 0.4183, stage0_l: 0.0161, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0059, stage1_bag_acc: 99.3500, stage1_neg_loss: 0.0021, stage1_mean_ious: 0.5897, stage1_s: 0.5897, stage1_m: 0.3992, stage1_l: 0.0137, stage1_h: 0.0000, loss: 0.0220, grad_norm: 1.8203
2024-10-16 08:58:51,374 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:01:05, time: 0.978, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0135, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.5203, stage0_s: 0.4549, stage0_m: 0.3791, stage0_l: 0.0105, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0064, stage1_bag_acc: 98.7500, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.6054, stage1_s: 0.5662, stage1_m: 0.3938, stage1_l: 0.0055, stage1_h: 0.0000, loss: 0.0221, grad_norm: 1.5086
2024-10-16 08:59:40,889 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:24, time: 0.990, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0133, stage0_bag_acc: 99.2000, stage0_mean_ious: 0.4876, stage0_s: 0.4482, stage0_m: 0.3415, stage0_l: 0.0080, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0069, stage1_bag_acc: 99.2000, stage1_neg_loss: 0.0032, stage1_mean_ious: 0.5906, stage1_s: 0.5875, stage1_m: 0.3472, stage1_l: 0.0088, stage1_h: 0.0000, loss: 0.0234, grad_norm: 1.6918
2024-10-16 09:00:09,385 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 09:01:29,656 - mmdet - INFO - Evaluating bbox...
2024-10-16 09:01:30,139 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2174
2024-10-16 09:01:30,139 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6956
2024-10-16 09:01:30,139 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4066
2024-10-16 09:01:30,139 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1474
2024-10-16 09:01:30,139 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0682
2024-10-16 09:01:30,139 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0264
2024-10-16 09:01:30,139 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 09:01:30,139 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:01:30,140 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2287
2024-10-16 09:01:30,140 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0605
2024-10-16 09:01:30,141 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3262
2024-10-16 09:01:30,141 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8012
2024-10-16 09:01:30,142 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3262
2024-10-16 09:01:30,142 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3262
2024-10-16 09:01:30,142 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:01:30,142 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3451
2024-10-16 09:01:30,142 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0898
2024-10-16 09:01:30,148 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 09:01:30,148 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.2170, bbox_mAP_50: 0.6960, bbox_mAP_75: 0.4070, bbox_mAP_s: 0.1470, bbox_mAP_m: 0.0680, bbox_mAP_l: 0.0260, bbox_mAP_copypaste: 0.217 0.696 0.407 0.147 0.068 0.026
2024-10-16 09:02:48,937 - mmdet - INFO - Evaluating bbox...
2024-10-16 09:02:49,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2174
2024-10-16 09:02:49,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6956
2024-10-16 09:02:49,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.4066
2024-10-16 09:02:49,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1474
2024-10-16 09:02:49,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0682
2024-10-16 09:02:49,556 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0264
2024-10-16 09:02:49,557 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0010
2024-10-16 09:02:49,557 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:02:49,557 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2287
2024-10-16 09:02:49,557 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0605
2024-10-16 09:02:49,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.3262
2024-10-16 09:02:49,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.8012
2024-10-16 09:02:49,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.3262
2024-10-16 09:02:49,557 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.3262
2024-10-16 09:02:49,558 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:02:49,558 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3451
2024-10-16 09:02:49,558 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0898
2024-10-16 09:02:50,868 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+2fd3e4b
------------------------------------------------------------

2024-10-16 09:02:51,742 - mmdet - INFO - Distributed training: False
2024-10-16 09:02:52,605 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-16 09:02:53,608 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 09:02:53,608 - mmdet - INFO - Use load_from_local loader
2024-10-16 09:02:53,903 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 09:02:53,917 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 09:02:53,917 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 09:03:34,168 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:44:24, time: 0.805, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.7249, stage0_bag_acc: 16.8996, stage0_mean_ious: 0.0927, stage0_s: 0.0699, stage0_m: 0.0999, stage0_l: 0.0125, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1612, stage1_bag_acc: 15.9907, stage1_neg_loss: 0.0009, stage1_mean_ious: 0.0933, stage1_s: 0.0721, stage1_m: 0.0903, stage1_l: 0.0114, stage1_h: 0.0000, loss: 0.8869, grad_norm: 6.1050
2024-10-16 09:04:12,203 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:42:31, time: 0.761, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.7120, stage0_bag_acc: 13.1786, stage0_mean_ious: 0.1145, stage0_s: 0.1067, stage0_m: 0.0851, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1599, stage1_bag_acc: 20.1167, stage1_neg_loss: 0.0011, stage1_mean_ious: 0.1150, stage1_s: 0.1084, stage1_m: 0.0857, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8730, grad_norm: 5.5124
2024-10-16 09:04:50,174 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:41:27, time: 0.759, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.6779, stage0_bag_acc: 30.2790, stage0_mean_ious: 0.1451, stage0_s: 0.1194, stage0_m: 0.1293, stage0_l: 0.0026, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1638, stage1_bag_acc: 34.6019, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.1363, stage1_s: 0.1158, stage1_m: 0.1126, stage1_l: 0.0027, stage1_h: 0.0000, loss: 0.8446, grad_norm: 6.6829
2024-10-16 09:05:28,118 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:40:36, time: 0.759, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.6255, stage0_bag_acc: 34.0968, stage0_mean_ious: 0.2019, stage0_s: 0.1701, stage0_m: 0.2002, stage0_l: 0.0059, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1557, stage1_bag_acc: 27.8390, stage1_neg_loss: 0.0149, stage1_mean_ious: 0.2194, stage1_s: 0.1932, stage1_m: 0.2190, stage1_l: 0.0051, stage1_h: 0.0000, loss: 0.7961, grad_norm: 9.7658
2024-10-16 09:06:12,594 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:41:11, time: 0.890, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.5700, stage0_bag_acc: 35.5299, stage0_mean_ious: 0.1949, stage0_s: 0.1673, stage0_m: 0.1788, stage0_l: 0.0003, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1186, stage1_bag_acc: 39.0999, stage1_neg_loss: 0.0207, stage1_mean_ious: 0.2331, stage1_s: 0.2078, stage1_m: 0.2100, stage1_l: 0.0004, stage1_h: 0.0000, loss: 0.7093, grad_norm: 10.4249
2024-10-16 09:06:40,974 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 09:07:33,916 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:38:09, time: 1.014, data_time: 0.060, memory: 7817, stage0_loss_instance_mil: 0.4805, stage0_bag_acc: 46.9948, stage0_mean_ious: 0.3058, stage0_s: 0.2697, stage0_m: 0.3055, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0937, stage1_bag_acc: 53.7997, stage1_neg_loss: 0.0193, stage1_mean_ious: 0.3824, stage1_s: 0.3478, stage1_m: 0.3482, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5935, grad_norm: 10.6363
2024-10-16 09:08:21,424 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:38:48, time: 0.950, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.4455, stage0_bag_acc: 55.1871, stage0_mean_ious: 0.2850, stage0_s: 0.2599, stage0_m: 0.2073, stage0_l: 0.0086, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1195, stage1_bag_acc: 59.5110, stage1_neg_loss: 0.0204, stage1_mean_ious: 0.3669, stage1_s: 0.3567, stage1_m: 0.2271, stage1_l: 0.0070, stage1_h: 0.0000, loss: 0.5853, grad_norm: 11.5509
2024-10-16 09:09:10,191 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:39:15, time: 0.975, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.3279, stage0_bag_acc: 69.3698, stage0_mean_ious: 0.3804, stage0_s: 0.3262, stage0_m: 0.2676, stage0_l: 0.0129, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0940, stage1_bag_acc: 72.8850, stage1_neg_loss: 0.0228, stage1_mean_ious: 0.4731, stage1_s: 0.4481, stage1_m: 0.2675, stage1_l: 0.0096, stage1_h: 0.0000, loss: 0.4447, grad_norm: 11.1777
2024-10-16 09:09:57,126 - mmdet - INFO - Epoch [2][200/280]	lr: 4.790e-05, eta: 0:39:15, time: 0.939, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.2966, stage0_bag_acc: 72.0770, stage0_mean_ious: 0.4070, stage0_s: 0.3783, stage0_m: 0.2770, stage0_l: 0.0102, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0765, stage1_bag_acc: 72.8183, stage1_neg_loss: 0.0164, stage1_mean_ious: 0.5058, stage1_s: 0.4920, stage1_m: 0.2845, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.3895, grad_norm: 10.6207
2024-10-16 09:10:45,042 - mmdet - INFO - Epoch [2][250/280]	lr: 5.000e-05, eta: 0:39:12, time: 0.958, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1932, stage0_bag_acc: 82.6198, stage0_mean_ious: 0.4367, stage0_s: 0.3942, stage0_m: 0.3124, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0674, stage1_bag_acc: 83.3365, stage1_neg_loss: 0.0242, stage1_mean_ious: 0.5426, stage1_s: 0.5351, stage1_m: 0.3032, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.2848, grad_norm: 8.7936
2024-10-16 09:11:14,891 - mmdet - INFO - Saving checkpoint at 2 epochs
2024-10-16 09:12:04,997 - mmdet - INFO - Epoch [3][50/280]	lr: 5.000e-05, eta: 0:36:41, time: 0.958, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.1786, stage0_bag_acc: 85.5968, stage0_mean_ious: 0.4346, stage0_s: 0.4118, stage0_m: 0.2556, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0483, stage1_bag_acc: 84.1245, stage1_neg_loss: 0.0133, stage1_mean_ious: 0.5402, stage1_s: 0.5428, stage1_m: 0.2545, stage1_l: 0.0056, stage1_h: 0.0000, loss: 0.2402, grad_norm: 8.7733
2024-10-16 09:12:53,792 - mmdet - INFO - Epoch [3][100/280]	lr: 5.000e-05, eta: 0:36:37, time: 0.976, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1056, stage0_bag_acc: 91.2380, stage0_mean_ious: 0.4464, stage0_s: 0.3659, stage0_m: 0.3569, stage0_l: 0.0478, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0429, stage1_bag_acc: 91.4221, stage1_neg_loss: 0.0173, stage1_mean_ious: 0.5503, stage1_s: 0.4978, stage1_m: 0.3727, stage1_l: 0.0283, stage1_h: 0.0000, loss: 0.1658, grad_norm: 6.3074
2024-10-16 09:13:44,128 - mmdet - INFO - Epoch [3][150/280]	lr: 5.000e-05, eta: 0:36:32, time: 1.007, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0996, stage0_bag_acc: 92.0310, stage0_mean_ious: 0.4694, stage0_s: 0.4020, stage0_m: 0.3842, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0274, stage1_bag_acc: 91.2158, stage1_neg_loss: 0.0086, stage1_mean_ious: 0.5696, stage1_s: 0.5384, stage1_m: 0.3890, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1356, grad_norm: 6.4505
2024-10-16 09:14:30,833 - mmdet - INFO - Epoch [3][200/280]	lr: 5.000e-05, eta: 0:36:09, time: 0.934, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.1271, stage0_bag_acc: 89.9182, stage0_mean_ious: 0.4593, stage0_s: 0.4171, stage0_m: 0.3363, stage0_l: 0.0216, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0369, stage1_bag_acc: 90.9682, stage1_neg_loss: 0.0084, stage1_mean_ious: 0.5531, stage1_s: 0.5350, stage1_m: 0.3362, stage1_l: 0.0126, stage1_h: 0.0000, loss: 0.1724, grad_norm: 6.3933
2024-10-16 09:15:18,890 - mmdet - INFO - Epoch [3][250/280]	lr: 5.000e-05, eta: 0:35:47, time: 0.961, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0951, stage0_bag_acc: 92.3031, stage0_mean_ious: 0.4809, stage0_s: 0.4073, stage0_m: 0.4000, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0348, stage1_bag_acc: 93.2094, stage1_neg_loss: 0.0154, stage1_mean_ious: 0.5893, stage1_s: 0.5464, stage1_m: 0.4108, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1453, grad_norm: 6.1540
2024-10-16 09:15:46,752 - mmdet - INFO - Saving checkpoint at 3 epochs
2024-10-16 09:17:06,735 - mmdet - INFO - Evaluating bbox...
2024-10-16 09:17:07,221 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1838
2024-10-16 09:17:07,221 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6281
2024-10-16 09:17:07,221 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3401
2024-10-16 09:17:07,221 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1071
2024-10-16 09:17:07,221 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0530
2024-10-16 09:17:07,221 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0190
2024-10-16 09:17:07,221 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0005
2024-10-16 09:17:07,221 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:17:07,222 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1920
2024-10-16 09:17:07,222 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0676
2024-10-16 09:17:07,222 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2873
2024-10-16 09:17:07,222 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7476
2024-10-16 09:17:07,222 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2873
2024-10-16 09:17:07,222 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2873
2024-10-16 09:17:07,222 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:17:07,222 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3011
2024-10-16 09:17:07,222 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1154
2024-10-16 09:17:07,227 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 09:17:07,227 - mmdet - INFO - Epoch(val) [3][280]	eval_iter_num: 140, bbox_mAP: 0.1840, bbox_mAP_50: 0.6280, bbox_mAP_75: 0.3400, bbox_mAP_s: 0.1070, bbox_mAP_m: 0.0530, bbox_mAP_l: 0.0190, bbox_mAP_copypaste: 0.184 0.628 0.340 0.107 0.053 0.019
2024-10-16 09:17:46,220 - mmdet - INFO - Epoch [4][50/280]	lr: 5.000e-05, eta: 0:33:21, time: 0.780, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.1015, stage0_bag_acc: 91.4071, stage0_mean_ious: 0.4687, stage0_s: 0.4172, stage0_m: 0.3035, stage0_l: 0.0368, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0294, stage1_bag_acc: 91.2738, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5595, stage1_s: 0.5447, stage1_m: 0.2813, stage1_l: 0.0293, stage1_h: 0.0000, loss: 0.1369, grad_norm: 5.2313
2024-10-16 09:18:21,619 - mmdet - INFO - Epoch [4][100/280]	lr: 5.000e-05, eta: 0:32:28, time: 0.708, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0929, stage0_bag_acc: 92.6673, stage0_mean_ious: 0.4420, stage0_s: 0.4146, stage0_m: 0.2125, stage0_l: 0.0119, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0241, stage1_bag_acc: 91.2703, stage1_neg_loss: 0.0104, stage1_mean_ious: 0.5692, stage1_s: 0.5719, stage1_m: 0.2122, stage1_l: 0.0087, stage1_h: 0.0000, loss: 0.1274, grad_norm: 5.8303
2024-10-16 09:18:58,309 - mmdet - INFO - Epoch [4][150/280]	lr: 5.000e-05, eta: 0:31:39, time: 0.734, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0709, stage0_bag_acc: 93.4682, stage0_mean_ious: 0.4641, stage0_s: 0.4044, stage0_m: 0.3260, stage0_l: 0.0087, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0241, stage1_bag_acc: 94.6182, stage1_neg_loss: 0.0063, stage1_mean_ious: 0.5832, stage1_s: 0.5616, stage1_m: 0.3535, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.1013, grad_norm: 4.5032
2024-10-16 09:19:46,993 - mmdet - INFO - Epoch [4][200/280]	lr: 5.000e-05, eta: 0:31:18, time: 0.974, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0644, stage0_bag_acc: 97.1921, stage0_mean_ious: 0.4793, stage0_s: 0.4292, stage0_m: 0.3679, stage0_l: 0.0189, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0313, stage1_bag_acc: 96.8921, stage1_neg_loss: 0.0211, stage1_mean_ious: 0.5799, stage1_s: 0.5721, stage1_m: 0.3807, stage1_l: 0.0138, stage1_h: 0.0000, loss: 0.1168, grad_norm: 5.3359
2024-10-16 09:20:37,826 - mmdet - INFO - Epoch [4][250/280]	lr: 5.000e-05, eta: 0:30:59, time: 1.017, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0775, stage0_bag_acc: 94.4742, stage0_mean_ious: 0.4880, stage0_s: 0.4256, stage0_m: 0.4634, stage0_l: 0.0177, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0267, stage1_bag_acc: 94.2385, stage1_neg_loss: 0.0121, stage1_mean_ious: 0.5732, stage1_s: 0.5478, stage1_m: 0.4717, stage1_l: 0.0180, stage1_h: 0.0000, loss: 0.1163, grad_norm: 5.1423
2024-10-16 09:21:06,063 - mmdet - INFO - Saving checkpoint at 4 epochs
2024-10-16 09:21:59,793 - mmdet - INFO - Epoch [5][50/280]	lr: 5.000e-05, eta: 0:29:27, time: 1.029, data_time: 0.060, memory: 7817, stage0_loss_instance_mil: 0.0651, stage0_bag_acc: 94.9545, stage0_mean_ious: 0.4799, stage0_s: 0.4487, stage0_m: 0.3594, stage0_l: 0.0178, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0134, stage1_bag_acc: 94.6188, stage1_neg_loss: 0.0052, stage1_mean_ious: 0.5936, stage1_s: 0.5736, stage1_m: 0.4064, stage1_l: 0.0135, stage1_h: 0.0000, loss: 0.0837, grad_norm: 3.9467
2024-10-16 09:22:49,379 - mmdet - INFO - Epoch [5][100/280]	lr: 5.000e-05, eta: 0:29:03, time: 0.992, data_time: 0.013, memory: 7817, stage0_loss_instance_mil: 0.0382, stage0_bag_acc: 96.8500, stage0_mean_ious: 0.4900, stage0_s: 0.4289, stage0_m: 0.3448, stage0_l: 0.0189, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0209, stage1_bag_acc: 96.9167, stage1_neg_loss: 0.0090, stage1_mean_ious: 0.5768, stage1_s: 0.5504, stage1_m: 0.3552, stage1_l: 0.0162, stage1_h: 0.0000, loss: 0.0681, grad_norm: 3.6816
2024-10-16 09:23:37,757 - mmdet - INFO - Epoch [5][150/280]	lr: 5.000e-05, eta: 0:28:35, time: 0.968, data_time: 0.013, memory: 7817, stage0_loss_instance_mil: 0.0963, stage0_bag_acc: 92.7180, stage0_mean_ious: 0.4748, stage0_s: 0.4254, stage0_m: 0.3722, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0209, stage1_bag_acc: 94.0831, stage1_neg_loss: 0.0065, stage1_mean_ious: 0.5609, stage1_s: 0.5423, stage1_m: 0.3744, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.1237, grad_norm: 5.5188
2024-10-16 09:24:26,621 - mmdet - INFO - Epoch [5][200/280]	lr: 5.000e-05, eta: 0:28:06, time: 0.977, data_time: 0.011, memory: 7817, stage0_loss_instance_mil: 0.0458, stage0_bag_acc: 96.1848, stage0_mean_ious: 0.4931, stage0_s: 0.4597, stage0_m: 0.3521, stage0_l: 0.0092, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0154, stage1_bag_acc: 96.0182, stage1_neg_loss: 0.0060, stage1_mean_ious: 0.5856, stage1_s: 0.5811, stage1_m: 0.3426, stage1_l: 0.0049, stage1_h: 0.0000, loss: 0.0672, grad_norm: 3.8674
2024-10-16 09:25:15,027 - mmdet - INFO - Epoch [5][250/280]	lr: 5.000e-05, eta: 0:27:35, time: 0.968, data_time: 0.012, memory: 7817, stage0_loss_instance_mil: 0.0632, stage0_bag_acc: 95.5333, stage0_mean_ious: 0.4623, stage0_s: 0.4257, stage0_m: 0.3402, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0208, stage1_bag_acc: 95.8667, stage1_neg_loss: 0.0087, stage1_mean_ious: 0.5672, stage1_s: 0.5534, stage1_m: 0.3593, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0928, grad_norm: 5.0325
2024-10-16 09:25:43,694 - mmdet - INFO - Saving checkpoint at 5 epochs
2024-10-16 09:26:35,837 - mmdet - INFO - Epoch [6][50/280]	lr: 5.000e-05, eta: 0:26:06, time: 0.998, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0316, stage0_bag_acc: 98.0167, stage0_mean_ious: 0.4685, stage0_s: 0.4196, stage0_m: 0.3474, stage0_l: 0.0161, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0172, stage1_bag_acc: 97.4015, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5777, stage1_s: 0.5651, stage1_m: 0.3365, stage1_l: 0.0144, stage1_h: 0.0000, loss: 0.0567, grad_norm: 3.0650
2024-10-16 09:27:24,335 - mmdet - INFO - Epoch [6][100/280]	lr: 5.000e-05, eta: 0:25:35, time: 0.970, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0582, stage0_bag_acc: 95.1992, stage0_mean_ious: 0.4563, stage0_s: 0.4244, stage0_m: 0.3392, stage0_l: 0.0186, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0248, stage1_bag_acc: 95.6492, stage1_neg_loss: 0.0072, stage1_mean_ious: 0.5460, stage1_s: 0.5379, stage1_m: 0.3551, stage1_l: 0.0117, stage1_h: 0.0000, loss: 0.0902, grad_norm: 4.3723
2024-10-16 09:28:12,045 - mmdet - INFO - Epoch [6][150/280]	lr: 5.000e-05, eta: 0:25:01, time: 0.954, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0445, stage0_bag_acc: 96.6833, stage0_mean_ious: 0.4684, stage0_s: 0.4278, stage0_m: 0.2945, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0152, stage1_bag_acc: 97.7333, stage1_neg_loss: 0.0043, stage1_mean_ious: 0.5686, stage1_s: 0.5455, stage1_m: 0.3335, stage1_l: 0.0058, stage1_h: 0.0000, loss: 0.0640, grad_norm: 3.2693
2024-10-16 09:29:00,142 - mmdet - INFO - Epoch [6][200/280]	lr: 5.000e-05, eta: 0:24:27, time: 0.962, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0361, stage0_bag_acc: 97.2126, stage0_mean_ious: 0.5139, stage0_s: 0.4751, stage0_m: 0.3936, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0149, stage1_bag_acc: 97.3460, stage1_neg_loss: 0.0080, stage1_mean_ious: 0.5962, stage1_s: 0.5842, stage1_m: 0.3874, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0589, grad_norm: 3.7792
2024-10-16 09:29:37,130 - mmdet - INFO - Epoch [6][250/280]	lr: 5.000e-05, eta: 0:23:40, time: 0.740, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0302, stage0_bag_acc: 97.3500, stage0_mean_ious: 0.4950, stage0_s: 0.4428, stage0_m: 0.3586, stage0_l: 0.0158, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0142, stage1_bag_acc: 97.8500, stage1_neg_loss: 0.0049, stage1_mean_ious: 0.5894, stage1_s: 0.5591, stage1_m: 0.3611, stage1_l: 0.0104, stage1_h: 0.0000, loss: 0.0493, grad_norm: 2.8036
2024-10-16 09:30:00,577 - mmdet - INFO - Saving checkpoint at 6 epochs
2024-10-16 09:31:18,707 - mmdet - INFO - Evaluating bbox...
2024-10-16 09:31:19,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1878
2024-10-16 09:31:19,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6195
2024-10-16 09:31:19,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3476
2024-10-16 09:31:19,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1230
2024-10-16 09:31:19,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0599
2024-10-16 09:31:19,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0246
2024-10-16 09:31:19,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0003
2024-10-16 09:31:19,255 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:31:19,256 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.1977
2024-10-16 09:31:19,256 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0731
2024-10-16 09:31:19,256 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2866
2024-10-16 09:31:19,256 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7392
2024-10-16 09:31:19,256 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2866
2024-10-16 09:31:19,256 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2866
2024-10-16 09:31:19,256 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:31:19,256 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3012
2024-10-16 09:31:19,256 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1252
2024-10-16 09:31:19,262 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 09:31:19,262 - mmdet - INFO - Epoch(val) [6][280]	eval_iter_num: 140, bbox_mAP: 0.1880, bbox_mAP_50: 0.6200, bbox_mAP_75: 0.3480, bbox_mAP_s: 0.1230, bbox_mAP_m: 0.0600, bbox_mAP_l: 0.0250, bbox_mAP_copypaste: 0.188 0.620 0.348 0.123 0.060 0.025
2024-10-16 09:32:00,273 - mmdet - INFO - Epoch [7][50/280]	lr: 5.000e-05, eta: 0:22:10, time: 0.820, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0490, stage0_bag_acc: 96.7000, stage0_mean_ious: 0.4829, stage0_s: 0.4232, stage0_m: 0.3283, stage0_l: 0.0204, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0182, stage1_bag_acc: 96.2500, stage1_neg_loss: 0.0058, stage1_mean_ious: 0.5859, stage1_s: 0.5587, stage1_m: 0.3283, stage1_l: 0.0134, stage1_h: 0.0000, loss: 0.0730, grad_norm: 3.9414
2024-10-16 09:32:42,649 - mmdet - INFO - Epoch [7][100/280]	lr: 5.000e-05, eta: 0:21:30, time: 0.848, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0244, stage0_bag_acc: 98.1063, stage0_mean_ious: 0.5103, stage0_s: 0.4669, stage0_m: 0.3779, stage0_l: 0.0071, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0089, stage1_bag_acc: 98.6143, stage1_neg_loss: 0.0073, stage1_mean_ious: 0.5919, stage1_s: 0.5757, stage1_m: 0.3860, stage1_l: 0.0051, stage1_h: 0.0000, loss: 0.0406, grad_norm: 3.0100
2024-10-16 09:33:29,615 - mmdet - INFO - Epoch [7][150/280]	lr: 5.000e-05, eta: 0:20:55, time: 0.939, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0427, stage0_bag_acc: 96.2111, stage0_mean_ious: 0.4627, stage0_s: 0.4317, stage0_m: 0.2736, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0134, stage1_bag_acc: 96.6611, stage1_neg_loss: 0.0040, stage1_mean_ious: 0.5736, stage1_s: 0.5663, stage1_m: 0.2612, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0601, grad_norm: 3.5281
2024-10-16 09:34:16,907 - mmdet - INFO - Epoch [7][200/280]	lr: 5.000e-05, eta: 0:20:18, time: 0.946, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0668, stage0_bag_acc: 95.6667, stage0_mean_ious: 0.4827, stage0_s: 0.4563, stage0_m: 0.3503, stage0_l: 0.0165, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0142, stage1_bag_acc: 95.6167, stage1_neg_loss: 0.0076, stage1_mean_ious: 0.5722, stage1_s: 0.5652, stage1_m: 0.3553, stage1_l: 0.0153, stage1_h: 0.0000, loss: 0.0886, grad_norm: 4.2962
2024-10-16 09:35:04,093 - mmdet - INFO - Epoch [7][250/280]	lr: 5.000e-05, eta: 0:19:42, time: 0.944, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0339, stage0_bag_acc: 97.3045, stage0_mean_ious: 0.4895, stage0_s: 0.4370, stage0_m: 0.3873, stage0_l: 0.0334, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0128, stage1_bag_acc: 97.5545, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5791, stage1_s: 0.5569, stage1_m: 0.3784, stage1_l: 0.0298, stage1_h: 0.0000, loss: 0.0504, grad_norm: 2.9621
2024-10-16 09:35:33,528 - mmdet - INFO - Saving checkpoint at 7 epochs
2024-10-16 09:36:24,983 - mmdet - INFO - Epoch [8][50/280]	lr: 5.000e-05, eta: 0:18:24, time: 0.985, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.0395, stage0_bag_acc: 96.0323, stage0_mean_ious: 0.4982, stage0_s: 0.4579, stage0_m: 0.3421, stage0_l: 0.0110, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0126, stage1_bag_acc: 96.2680, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5718, stage1_s: 0.5549, stage1_m: 0.3396, stage1_l: 0.0096, stage1_h: 0.0000, loss: 0.0566, grad_norm: 3.5508
2024-10-16 09:37:13,550 - mmdet - INFO - Epoch [8][100/280]	lr: 5.000e-05, eta: 0:17:48, time: 0.971, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0406, stage0_bag_acc: 96.3563, stage0_mean_ious: 0.4842, stage0_s: 0.4505, stage0_m: 0.2683, stage0_l: 0.0226, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0130, stage1_bag_acc: 96.7825, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5746, stage1_s: 0.5709, stage1_m: 0.2530, stage1_l: 0.0235, stage1_h: 0.0000, loss: 0.0572, grad_norm: 3.2436
2024-10-16 09:38:01,862 - mmdet - INFO - Epoch [8][150/280]	lr: 5.000e-05, eta: 0:17:11, time: 0.966, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0264, stage0_bag_acc: 97.9278, stage0_mean_ious: 0.5000, stage0_s: 0.4333, stage0_m: 0.3836, stage0_l: 0.0071, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0072, stage1_bag_acc: 98.1500, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5986, stage1_s: 0.5645, stage1_m: 0.3783, stage1_l: 0.0079, stage1_h: 0.0000, loss: 0.0373, grad_norm: 2.4399
2024-10-16 09:38:50,678 - mmdet - INFO - Epoch [8][200/280]	lr: 5.000e-05, eta: 0:16:34, time: 0.976, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0429, stage0_bag_acc: 96.9841, stage0_mean_ious: 0.5008, stage0_s: 0.4598, stage0_m: 0.3016, stage0_l: 0.0248, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0109, stage1_bag_acc: 96.8984, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5814, stage1_s: 0.5773, stage1_m: 0.2953, stage1_l: 0.0201, stage1_h: 0.0000, loss: 0.0576, grad_norm: 3.3612
2024-10-16 09:39:39,032 - mmdet - INFO - Epoch [8][250/280]	lr: 5.000e-05, eta: 0:15:56, time: 0.967, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0482, stage0_bag_acc: 96.6380, stage0_mean_ious: 0.4941, stage0_s: 0.4459, stage0_m: 0.3425, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0107, stage1_bag_acc: 97.0880, stage1_neg_loss: 0.0048, stage1_mean_ious: 0.5713, stage1_s: 0.5602, stage1_m: 0.3274, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0637, grad_norm: 3.7917
2024-10-16 09:40:08,046 - mmdet - INFO - Saving checkpoint at 8 epochs
2024-10-16 09:41:00,916 - mmdet - INFO - Epoch [9][50/280]	lr: 5.000e-06, eta: 0:14:42, time: 1.012, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.0346, stage0_bag_acc: 97.0515, stage0_mean_ious: 0.4954, stage0_s: 0.4544, stage0_m: 0.3707, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0112, stage1_bag_acc: 96.8848, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5752, stage1_s: 0.5572, stage1_m: 0.3742, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0502, grad_norm: 2.8443
2024-10-16 09:41:47,641 - mmdet - INFO - Epoch [9][100/280]	lr: 5.000e-06, eta: 0:14:03, time: 0.935, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0191, stage0_bag_acc: 98.7000, stage0_mean_ious: 0.4756, stage0_s: 0.4340, stage0_m: 0.3171, stage0_l: 0.0104, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0081, stage1_bag_acc: 98.6960, stage1_neg_loss: 0.0022, stage1_mean_ious: 0.5524, stage1_s: 0.5360, stage1_m: 0.3170, stage1_l: 0.0065, stage1_h: 0.0000, loss: 0.0294, grad_norm: 2.2663
2024-10-16 09:42:32,901 - mmdet - INFO - Epoch [9][150/280]	lr: 5.000e-06, eta: 0:13:24, time: 0.905, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0216, stage0_bag_acc: 98.0476, stage0_mean_ious: 0.5290, stage0_s: 0.4785, stage0_m: 0.3990, stage0_l: 0.0084, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0050, stage1_bag_acc: 98.1333, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5845, stage1_s: 0.5681, stage1_m: 0.3830, stage1_l: 0.0044, stage1_h: 0.0000, loss: 0.0301, grad_norm: 2.2870
2024-10-16 09:43:10,972 - mmdet - INFO - Epoch [9][200/280]	lr: 5.000e-06, eta: 0:12:41, time: 0.761, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0163, stage0_bag_acc: 98.9000, stage0_mean_ious: 0.4880, stage0_s: 0.4396, stage0_m: 0.4175, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0044, stage1_bag_acc: 98.4500, stage1_neg_loss: 0.0012, stage1_mean_ious: 0.5841, stage1_s: 0.5694, stage1_m: 0.4215, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0220, grad_norm: 1.6333
2024-10-16 09:43:45,758 - mmdet - INFO - Epoch [9][250/280]	lr: 5.000e-06, eta: 0:11:57, time: 0.696, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0341, stage0_bag_acc: 97.9667, stage0_mean_ious: 0.4891, stage0_s: 0.4663, stage0_m: 0.2766, stage0_l: 0.0085, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0061, stage1_bag_acc: 97.5944, stage1_neg_loss: 0.0056, stage1_mean_ious: 0.5670, stage1_s: 0.5679, stage1_m: 0.2793, stage1_l: 0.0064, stage1_h: 0.0000, loss: 0.0458, grad_norm: 2.8240
2024-10-16 09:44:07,500 - mmdet - INFO - Saving checkpoint at 9 epochs
2024-10-16 09:45:25,105 - mmdet - INFO - Evaluating bbox...
2024-10-16 09:45:25,597 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1956
2024-10-16 09:45:25,597 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6463
2024-10-16 09:45:25,597 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3679
2024-10-16 09:45:25,597 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1217
2024-10-16 09:45:25,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0588
2024-10-16 09:45:25,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0207
2024-10-16 09:45:25,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0012
2024-10-16 09:45:25,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:45:25,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2032
2024-10-16 09:45:25,598 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.0982
2024-10-16 09:45:25,598 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2946
2024-10-16 09:45:25,598 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7602
2024-10-16 09:45:25,598 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2946
2024-10-16 09:45:25,598 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2946
2024-10-16 09:45:25,598 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:45:25,599 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3078
2024-10-16 09:45:25,599 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1438
2024-10-16 09:45:25,604 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 09:45:25,604 - mmdet - INFO - Epoch(val) [9][280]	eval_iter_num: 140, bbox_mAP: 0.1960, bbox_mAP_50: 0.6460, bbox_mAP_75: 0.3680, bbox_mAP_s: 0.1220, bbox_mAP_m: 0.0590, bbox_mAP_l: 0.0210, bbox_mAP_copypaste: 0.196 0.646 0.368 0.122 0.059 0.021
2024-10-16 09:46:11,819 - mmdet - INFO - Epoch [10][50/280]	lr: 5.000e-06, eta: 0:10:45, time: 0.924, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0328, stage0_bag_acc: 97.7778, stage0_mean_ious: 0.5024, stage0_s: 0.4667, stage0_m: 0.3284, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0061, stage1_bag_acc: 98.1778, stage1_neg_loss: 0.0014, stage1_mean_ious: 0.5794, stage1_s: 0.5676, stage1_m: 0.3186, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0403, grad_norm: 2.1291
2024-10-16 09:46:59,283 - mmdet - INFO - Epoch [10][100/280]	lr: 5.000e-06, eta: 0:10:06, time: 0.949, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0222, stage0_bag_acc: 98.6000, stage0_mean_ious: 0.5044, stage0_s: 0.4579, stage0_m: 0.3665, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0088, stage1_bag_acc: 98.8000, stage1_neg_loss: 0.0036, stage1_mean_ious: 0.5800, stage1_s: 0.5530, stage1_m: 0.3809, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0346, grad_norm: 2.1644
2024-10-16 09:47:45,201 - mmdet - INFO - Epoch [10][150/280]	lr: 5.000e-06, eta: 0:09:26, time: 0.918, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0225, stage0_bag_acc: 98.5000, stage0_mean_ious: 0.4701, stage0_s: 0.4413, stage0_m: 0.2509, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0073, stage1_bag_acc: 98.9682, stage1_neg_loss: 0.0029, stage1_mean_ious: 0.5498, stage1_s: 0.5422, stage1_m: 0.2704, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0328, grad_norm: 2.3923
2024-10-16 09:48:34,085 - mmdet - INFO - Epoch [10][200/280]	lr: 5.000e-06, eta: 0:08:47, time: 0.978, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0187, stage0_bag_acc: 98.4167, stage0_mean_ious: 0.5153, stage0_s: 0.4697, stage0_m: 0.3979, stage0_l: 0.0111, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0046, stage1_bag_acc: 98.4167, stage1_neg_loss: 0.0044, stage1_mean_ious: 0.5794, stage1_s: 0.5575, stage1_m: 0.3862, stage1_l: 0.0131, stage1_h: 0.0000, loss: 0.0277, grad_norm: 2.0065
2024-10-16 09:49:22,735 - mmdet - INFO - Epoch [10][250/280]	lr: 5.000e-06, eta: 0:08:08, time: 0.973, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0187, stage0_bag_acc: 98.9500, stage0_mean_ious: 0.4793, stage0_s: 0.4379, stage0_m: 0.3447, stage0_l: 0.0390, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0103, stage1_bag_acc: 98.8000, stage1_neg_loss: 0.0037, stage1_mean_ious: 0.5511, stage1_s: 0.5444, stage1_m: 0.3322, stage1_l: 0.0321, stage1_h: 0.0000, loss: 0.0328, grad_norm: 2.2591
2024-10-16 09:49:50,467 - mmdet - INFO - Saving checkpoint at 10 epochs
2024-10-16 09:50:47,048 - mmdet - INFO - Epoch [11][50/280]	lr: 5.000e-06, eta: 0:06:59, time: 1.087, data_time: 0.060, memory: 7817, stage0_loss_instance_mil: 0.0108, stage0_bag_acc: 99.5000, stage0_mean_ious: 0.4983, stage0_s: 0.4725, stage0_m: 0.3580, stage0_l: 0.0082, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0046, stage1_bag_acc: 99.7500, stage1_neg_loss: 0.0026, stage1_mean_ious: 0.5831, stage1_s: 0.5770, stage1_m: 0.3855, stage1_l: 0.0076, stage1_h: 0.0000, loss: 0.0180, grad_norm: 1.3750
2024-10-16 09:51:33,830 - mmdet - INFO - Epoch [11][100/280]	lr: 5.000e-06, eta: 0:06:19, time: 0.936, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0218, stage0_bag_acc: 98.3348, stage0_mean_ious: 0.4698, stage0_s: 0.4492, stage0_m: 0.2595, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0091, stage1_bag_acc: 97.9682, stage1_neg_loss: 0.0019, stage1_mean_ious: 0.5642, stage1_s: 0.5602, stage1_m: 0.2754, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0329, grad_norm: 2.5926
2024-10-16 09:52:19,803 - mmdet - INFO - Epoch [11][150/280]	lr: 5.000e-06, eta: 0:05:38, time: 0.919, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0271, stage0_bag_acc: 97.5301, stage0_mean_ious: 0.4830, stage0_s: 0.4519, stage0_m: 0.3063, stage0_l: 0.0195, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0071, stage1_bag_acc: 97.9801, stage1_neg_loss: 0.0027, stage1_mean_ious: 0.5662, stage1_s: 0.5591, stage1_m: 0.3084, stage1_l: 0.0167, stage1_h: 0.0000, loss: 0.0369, grad_norm: 2.1877
2024-10-16 09:53:06,013 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 09:53:06,014 - mmdet - INFO - Epoch [11][200/280]	lr: 5.000e-06, eta: 0:04:58, time: 0.924, data_time: 0.008, memory: 7817, stage0_loss_instance_mil: 0.0339, stage0_bag_acc: 97.4030, stage0_mean_ious: 0.4828, stage0_s: 0.4515, stage0_m: 0.3066, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0057, stage1_bag_acc: 96.9030, stage1_neg_loss: 0.0017, stage1_mean_ious: 0.5665, stage1_s: 0.5509, stage1_m: 0.3167, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0413, grad_norm: 2.3579
2024-10-16 09:53:52,998 - mmdet - INFO - Epoch [11][250/280]	lr: 5.000e-06, eta: 0:04:17, time: 0.940, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0234, stage0_bag_acc: 98.3848, stage0_mean_ious: 0.5122, stage0_s: 0.4763, stage0_m: 0.3300, stage0_l: 0.0216, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0045, stage1_bag_acc: 98.0515, stage1_neg_loss: 0.0050, stage1_mean_ious: 0.5711, stage1_s: 0.5733, stage1_m: 0.3021, stage1_l: 0.0172, stage1_h: 0.0000, loss: 0.0330, grad_norm: 2.5648
2024-10-16 09:54:20,023 - mmdet - INFO - Saving checkpoint at 11 epochs
2024-10-16 09:55:12,636 - mmdet - INFO - Epoch [12][50/280]	lr: 5.000e-07, eta: 0:03:09, time: 1.008, data_time: 0.057, memory: 7817, stage0_loss_instance_mil: 0.0166, stage0_bag_acc: 98.7000, stage0_mean_ious: 0.4931, stage0_s: 0.4513, stage0_m: 0.3341, stage0_l: 0.0294, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0083, stage1_bag_acc: 98.2500, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.5726, stage1_s: 0.5541, stage1_m: 0.3474, stage1_l: 0.0251, stage1_h: 0.0000, loss: 0.0267, grad_norm: 1.6946
2024-10-16 09:55:52,312 - mmdet - INFO - Epoch [12][100/280]	lr: 5.000e-07, eta: 0:02:28, time: 0.794, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0240, stage0_bag_acc: 98.0921, stage0_mean_ious: 0.4755, stage0_s: 0.4345, stage0_m: 0.2839, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0103, stage1_bag_acc: 98.7421, stage1_neg_loss: 0.0038, stage1_mean_ious: 0.5580, stage1_s: 0.5511, stage1_m: 0.2532, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.0381, grad_norm: 2.4951
2024-10-16 09:56:28,087 - mmdet - INFO - Epoch [12][150/280]	lr: 5.000e-07, eta: 0:01:46, time: 0.715, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0091, stage0_bag_acc: 99.6000, stage0_mean_ious: 0.4815, stage0_s: 0.4378, stage0_m: 0.2722, stage0_l: 0.0114, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0097, stage1_bag_acc: 99.6000, stage1_neg_loss: 0.0016, stage1_mean_ious: 0.5680, stage1_s: 0.5409, stage1_m: 0.2756, stage1_l: 0.0089, stage1_h: 0.0000, loss: 0.0204, grad_norm: 1.4254
2024-10-16 09:57:05,114 - mmdet - INFO - Epoch [12][200/280]	lr: 5.000e-07, eta: 0:01:05, time: 0.740, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.0209, stage0_bag_acc: 98.2000, stage0_mean_ious: 0.5087, stage0_s: 0.4511, stage0_m: 0.3938, stage0_l: 0.0215, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0080, stage1_bag_acc: 98.4500, stage1_neg_loss: 0.0145, stage1_mean_ious: 0.5639, stage1_s: 0.5355, stage1_m: 0.3875, stage1_l: 0.0141, stage1_h: 0.0000, loss: 0.0435, grad_norm: 3.0788
2024-10-16 09:57:41,716 - mmdet - INFO - Epoch [12][250/280]	lr: 5.000e-07, eta: 0:00:24, time: 0.732, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.0081, stage0_bag_acc: 99.7500, stage0_mean_ious: 0.4796, stage0_s: 0.4358, stage0_m: 0.3039, stage0_l: 0.0091, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0074, stage1_bag_acc: 99.5000, stage1_neg_loss: 0.0030, stage1_mean_ious: 0.5673, stage1_s: 0.5379, stage1_m: 0.3047, stage1_l: 0.0046, stage1_h: 0.0000, loss: 0.0185, grad_norm: 1.5948
2024-10-16 09:58:05,976 - mmdet - INFO - Saving checkpoint at 12 epochs
2024-10-16 09:59:26,799 - mmdet - INFO - Evaluating bbox...
2024-10-16 09:59:27,399 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1948
2024-10-16 09:59:27,400 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6482
2024-10-16 09:59:27,400 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3618
2024-10-16 09:59:27,400 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1215
2024-10-16 09:59:27,400 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0582
2024-10-16 09:59:27,400 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0211
2024-10-16 09:59:27,400 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0021
2024-10-16 09:59:27,400 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:59:27,401 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2024
2024-10-16 09:59:27,401 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1180
2024-10-16 09:59:27,401 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2941
2024-10-16 09:59:27,401 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7623
2024-10-16 09:59:27,401 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2941
2024-10-16 09:59:27,401 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2941
2024-10-16 09:59:27,401 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 09:59:27,401 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3073
2024-10-16 09:59:27,401 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1622
2024-10-16 09:59:27,409 - mmdet - INFO - Exp name: P2BNet_r50_fpn_1x_coco_ms.py
2024-10-16 09:59:27,409 - mmdet - INFO - Epoch(val) [12][280]	eval_iter_num: 140, bbox_mAP: 0.1950, bbox_mAP_50: 0.6480, bbox_mAP_75: 0.3620, bbox_mAP_s: 0.1220, bbox_mAP_m: 0.0580, bbox_mAP_l: 0.0210, bbox_mAP_copypaste: 0.195 0.648 0.362 0.122 0.058 0.021
2024-10-16 10:00:49,070 - mmdet - INFO - Evaluating bbox...
2024-10-16 10:00:49,563 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.1948
2024-10-16 10:00:49,563 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=1000 ] = 0.6482
2024-10-16 10:00:49,563 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.60      | area=   all | maxDets=1000 ] = 0.3618
2024-10-16 10:00:49,563 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.70      | area=   all | maxDets=1000 ] = 0.1215
2024-10-16 10:00:49,563 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=1000 ] = 0.0582
2024-10-16 10:00:49,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.80      | area=   all | maxDets=1000 ] = 0.0211
2024-10-16 10:00:49,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.90      | area=   all | maxDets=1000 ] = 0.0021
2024-10-16 10:00:49,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 10:00:49,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.2024
2024-10-16 10:00:49,564 - mmdet - INFO -  Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1180
2024-10-16 10:00:49,564 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.2941
2024-10-16 10:00:49,564 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.7623
2024-10-16 10:00:49,564 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=300 ] = 0.2941
2024-10-16 10:00:49,564 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=1000 ] = 0.2941
2024-10-16 10:00:49,564 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=1000 ] = 0.0000
2024-10-16 10:00:49,564 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=1000 ] = 0.3073
2024-10-16 10:00:49,565 - mmdet - INFO -  Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=1000 ] = 0.1622
2024-10-16 10:00:50,969 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.7.16 (default, Jan 17 2023, 22:20:44) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3,4,5,6,7: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda-12.0
NVCC: Build cuda_12.0.r12.0/compiler.31968024_0
GCC: gcc (Ubuntu 11.4.0-2ubuntu1~18.04) 11.4.0
PyTorch: 1.7.0
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.6.0 (Git Hash 5ef631a030a6f73131c77892041042805a06064f)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.0
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.0.3
  - Magma 2.5.2
  - Build settings: BLAS=MKL, BUILD_TYPE=Release, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DUSE_VULKAN_WRAPPER -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, USE_CUDA=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

TorchVision: 0.8.0
OpenCV: 4.8.1
MMCV: 1.3.3
MMCV Compiler: GCC 7.3
MMCV CUDA Compiler: 11.0
MMDetection: 2.13.0+e282583
------------------------------------------------------------

2024-10-16 10:00:51,970 - mmdet - INFO - Distributed training: False
2024-10-16 10:00:52,883 - mmdet - INFO - Config:
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = '../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth'
resume_from = None
workflow = [('train', 1)]
norm_cfg = dict(type='GN', num_groups=32, requires_grad=True)
debug = False
num_stages = 2
model = dict(
    type='P2BNet',
    pretrained='torchvision://resnet50',
    backbone=dict(
        type='ResNet',
        depth=50,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=0,
        add_extra_convs='on_input',
        num_outs=4,
        norm_cfg=dict(type='GN', num_groups=32, requires_grad=True)),
    roi_head=dict(
        type='P2BHead',
        num_stages=2,
        top_k=7,
        with_atten=False,
        bbox_roi_extractor=dict(
            type='SingleRoIExtractor',
            roi_layer=dict(type='RoIAlign', output_size=7),
            out_channels=256,
            featmap_strides=[4, 8, 16, 32]),
        bbox_head=dict(
            type='Shared2FCInstanceMILHead',
            num_stages=2,
            with_loss_pseudo=False,
            in_channels=256,
            fc_out_channels=1024,
            roi_feat_size=7,
            num_classes=6,
            num_ref_fcs=0,
            bbox_coder=dict(
                type='DeltaXYWHBBoxCoder',
                target_means=[0.0, 0.0, 0.0, 0.0],
                target_stds=[0.1, 0.1, 0.2, 0.2]),
            reg_class_agnostic=True,
            loss_type='MIL',
            loss_mil1=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='binary_cross_entropy'),
            loss_mil2=dict(
                type='MILLoss',
                binary_ins=False,
                loss_weight=0.25,
                loss_type='gfocal_loss'))),
    train_cfg=dict(
        base_proposal=dict(
            base_scales=[4, 8, 16, 32, 64, 128],
            base_ratios=[
                0.3333333333333333, 0.5, 0.6666666666666666, 1.0, 1.5, 2.0, 3.0
            ],
            shake_ratio=None,
            cut_mode='symmetry',
            gen_num_neg=0),
        fine_proposal=dict(
            gen_proposal_mode='fix_gen',
            cut_mode=None,
            shake_ratio=[0.1],
            base_ratios=[1, 1.2, 1.3, 0.8, 0.7],
            iou_thr=0.3,
            gen_num_neg=3500),
        rcnn=None),
    test_cfg=dict(rpn=None, rcnn=None))
dataset_type = 'CocoFmtDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='Resize',
        img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                   (2000, 1000), (2000, 1200)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(
        type='Collect',
        keys=[
            'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
            'gt_true_bboxes'
        ])
]
test_scale = 1200
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(2000, 1200),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_anns_id', 'gt_true_bboxes'
                ])
        ])
]
data = dict(
    samples_per_gpu=2,
    workers_per_gpu=1,
    shuffle=None,
    train=dict(
        type='CocoFmtDataset',
        ann_file='data/coco/annotations_qc_pt/instances_train2017_coarse.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='Resize',
                img_scale=[(2000, 480), (2000, 576), (2000, 688), (2000, 864),
                           (2000, 1000), (2000, 1200)],
                multiscale_mode='value',
                keep_ratio=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(
                type='Collect',
                keys=[
                    'img', 'gt_bboxes', 'gt_labels', 'gt_bboxes_ignore',
                    'gt_true_bboxes'
                ])
        ]),
    val=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False),
    test=dict(
        samples_per_gpu=4,
        type='CocoFmtDataset',
        ann_file=
        '/home/lxz/P2BNet/TOV_mmdetection/data/coco/annotations/instances_train.json',
        img_prefix='data/coco/images/train/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(2000, 1200),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='DefaultFormatBundle'),
                    dict(
                        type='Collect',
                        keys=[
                            'img', 'gt_bboxes', 'gt_labels',
                            'gt_bboxes_ignore', 'gt_anns_id', 'gt_true_bboxes'
                        ])
                ])
        ],
        test_mode=False))
check = dict(stop_while_nan=False)
optimizer = dict(
    type='AdamW',
    lr=5e-05,
    betas=(0.9, 0.999),
    weight_decay=0.05,
    paramwise_cfg=dict(
        custom_keys=dict(
            absolute_pos_embed=dict(decay_mult=0.0),
            relative_position_bias_table=dict(decay_mult=0.0),
            norm=dict(decay_mult=0.0))))
optimizer_config = dict(grad_clip=dict(max_norm=35, norm_type=2))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=12)
work_dir = '../TOV_mmdetection_cache/work_dir/coco/'
evaluation = dict(
    interval=3,
    metric='bbox',
    save_result_file=
    '../TOV_mmdetection_cache/work_dir/coco/_1200_latest_result.json',
    do_first_eval=False,
    do_final_eval=True)
gpu_ids = [0]

2024-10-16 10:00:54,085 - mmdet - INFO - load checkpoint from ../TOV_mmdetection_cache/work_dir/coco/pre_trained/P2B.pth
2024-10-16 10:00:54,085 - mmdet - INFO - Use load_from_local loader
2024-10-16 10:00:54,439 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_cls.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
size mismatch for roi_head.bbox_head.fc_ins.0.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([7, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.0.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([7]).
size mismatch for roi_head.bbox_head.fc_ins.1.weight: copying a param with shape torch.Size([80, 1024]) from checkpoint, the shape in current model is torch.Size([6, 1024]).
size mismatch for roi_head.bbox_head.fc_ins.1.bias: copying a param with shape torch.Size([80]) from checkpoint, the shape in current model is torch.Size([6]).
2024-10-16 10:00:54,453 - mmdet - INFO - Start running, host: lxz@user-SYS-4029GP-TRT2, work_dir: /home/lxz/P2BNet/TOV_mmdetection_cache/work_dir/coco
2024-10-16 10:00:54,453 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs
2024-10-16 10:01:47,516 - mmdet - INFO - Epoch [1][50/280]	lr: 4.945e-06, eta: 0:58:32, time: 1.061, data_time: 0.059, memory: 7817, stage0_loss_instance_mil: 0.7030, stage0_bag_acc: 15.1429, stage0_mean_ious: 0.0632, stage0_s: 0.0564, stage0_m: 0.0379, stage0_l: 0.0044, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1799, stage1_bag_acc: 17.0972, stage1_neg_loss: 0.0008, stage1_mean_ious: 0.0636, stage1_s: 0.0548, stage1_m: 0.0387, stage1_l: 0.0061, stage1_h: 0.0000, loss: 0.8836, grad_norm: 5.8147
2024-10-16 10:02:38,950 - mmdet - INFO - Epoch [1][100/280]	lr: 9.940e-06, eta: 0:56:46, time: 1.029, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.6863, stage0_bag_acc: 22.5000, stage0_mean_ious: 0.0866, stage0_s: 0.0561, stage0_m: 0.0635, stage0_l: 0.0266, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1868, stage1_bag_acc: 19.8100, stage1_neg_loss: 0.0009, stage1_mean_ious: 0.0823, stage1_s: 0.0548, stage1_m: 0.0578, stage1_l: 0.0257, stage1_h: 0.0000, loss: 0.8740, grad_norm: 6.2591
2024-10-16 10:03:28,573 - mmdet - INFO - Epoch [1][150/280]	lr: 1.494e-05, eta: 0:54:57, time: 0.992, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.6689, stage0_bag_acc: 32.0803, stage0_mean_ious: 0.1108, stage0_s: 0.0970, stage0_m: 0.0851, stage0_l: 0.0005, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1845, stage1_bag_acc: 20.8298, stage1_neg_loss: 0.0018, stage1_mean_ious: 0.1084, stage1_s: 0.0959, stage1_m: 0.0845, stage1_l: 0.0004, stage1_h: 0.0000, loss: 0.8553, grad_norm: 7.0013
2024-10-16 10:04:18,008 - mmdet - INFO - Epoch [1][200/280]	lr: 1.993e-05, eta: 0:53:36, time: 0.989, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.6341, stage0_bag_acc: 25.4641, stage0_mean_ious: 0.1020, stage0_s: 0.0854, stage0_m: 0.0856, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1674, stage1_bag_acc: 23.8348, stage1_neg_loss: 0.0108, stage1_mean_ious: 0.1052, stage1_s: 0.0928, stage1_m: 0.0815, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.8124, grad_norm: 10.4391
2024-10-16 10:05:09,929 - mmdet - INFO - Epoch [1][250/280]	lr: 2.493e-05, eta: 0:52:57, time: 1.038, data_time: 0.010, memory: 7817, stage0_loss_instance_mil: 0.5248, stage0_bag_acc: 42.0887, stage0_mean_ious: 0.2012, stage0_s: 0.1579, stage0_m: 0.1763, stage0_l: 0.0052, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1263, stage1_bag_acc: 46.5712, stage1_neg_loss: 0.0236, stage1_mean_ious: 0.2394, stage1_s: 0.1976, stage1_m: 0.1858, stage1_l: 0.0045, stage1_h: 0.0000, loss: 0.6747, grad_norm: 10.7074
2024-10-16 10:05:40,360 - mmdet - INFO - Saving checkpoint at 1 epochs
2024-10-16 10:06:33,072 - mmdet - INFO - Epoch [2][50/280]	lr: 3.292e-05, eta: 0:46:48, time: 1.008, data_time: 0.058, memory: 7817, stage0_loss_instance_mil: 0.5111, stage0_bag_acc: 46.1365, stage0_mean_ious: 0.2542, stage0_s: 0.2172, stage0_m: 0.2024, stage0_l: 0.0100, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1197, stage1_bag_acc: 53.0992, stage1_neg_loss: 0.0240, stage1_mean_ious: 0.3264, stage1_s: 0.2969, stage1_m: 0.2318, stage1_l: 0.0072, stage1_h: 0.0000, loss: 0.6548, grad_norm: 13.8589
2024-10-16 10:07:23,978 - mmdet - INFO - Epoch [2][100/280]	lr: 3.791e-05, eta: 0:46:37, time: 1.018, data_time: 0.011, memory: 7817, stage0_loss_instance_mil: 0.4448, stage0_bag_acc: 58.9881, stage0_mean_ious: 0.3117, stage0_s: 0.2573, stage0_m: 0.2307, stage0_l: 0.0000, stage0_h: 0.0000, stage1_loss_instance_mil: 0.1042, stage1_bag_acc: 57.6401, stage1_neg_loss: 0.0191, stage1_mean_ious: 0.4015, stage1_s: 0.3593, stage1_m: 0.2837, stage1_l: 0.0000, stage1_h: 0.0000, loss: 0.5681, grad_norm: 11.9624
2024-10-16 10:08:11,776 - mmdet - INFO - Epoch [2][150/280]	lr: 4.291e-05, eta: 0:45:56, time: 0.956, data_time: 0.009, memory: 7817, stage0_loss_instance_mil: 0.3768, stage0_bag_acc: 64.0079, stage0_mean_ious: 0.3869, stage0_s: 0.3386, stage0_m: 0.3328, stage0_l: 0.0095, stage0_h: 0.0000, stage1_loss_instance_mil: 0.0852, stage1_bag_acc: 65.0746, stage1_neg_loss: 0.0240, stage1_mean_ious: 0.4554, stage1_s: 0.4342, stage1_m: 0.3260, stage1_l: 0.0071, stage1_h: 0.0000, loss: 0.4861, grad_norm: 15.1923
